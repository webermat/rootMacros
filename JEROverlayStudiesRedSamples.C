#include "TFile.h"
#include "TTree.h"
#include "TROOT.h"
#include "TStyle.h"
#include "TMath.h"
#include "TH1F.h"
#include "TF1.h"
#include "TH3F.h"
#include "TH1D.h"
#include "TH1.h"
#include "TH2.h"
#include "TF1.h"
#include "TGraph.h"
#include "TCanvas.h"
#include "TLatex.h"
#include "TMath.h"
#include "THStack.h"
#include "TGraph.h"
#include "TLegend.h"
#include "TGraphErrors.h"
#include "TGaxis.h"
#include "TLorentzVector.h"
#include <TVirtualFitter.h>
#include "TProfile.h"
#include "TColor.h"
#include <vector>
#include "Math/Minimizer.h"
#include "Math/Factory.h"
//#include "RooNovosibirsk.h"

using namespace std;

float DeltaPhiDir(float Phi1,float Phi2){
  float deltaphi=Phi1-Phi2;
  if(deltaphi>M_PI){
    deltaphi=deltaphi-2*M_PI;
  }
  if(deltaphi<(-M_PI)){
    deltaphi=2*M_PI+deltaphi;
  }
  return deltaphi;
}

double fnc_dscb(double*xx,double*pp)
{
  double x   = xx[0];
  // gaussian core
  double N   = pp[0];//norm
  double mu  = pp[1];//mean
  double sig = pp[2];//variance
  // transition parameters
  double a1  = pp[3];
  double p1  = pp[4];
  double a2  = pp[5];
  double p2  = pp[6];
  
  double u   = (x-mu)/sig;
  double A1  = TMath::Power(p1/TMath::Abs(a1),p1)*TMath::Exp(-a1*a1/2);
  double A2  = TMath::Power(p2/TMath::Abs(a2),p2)*TMath::Exp(-a2*a2/2);
  double B1  = p1/TMath::Abs(a1) - TMath::Abs(a1);
  double B2  = p2/TMath::Abs(a2) - TMath::Abs(a2);

  double result(N);
  if      (u<-a1) result *= A1*TMath::Power(B1-u,-p1);
  else if (u<a2)  result *= TMath::Exp(-u*u/2);
  else            result *= A2*TMath::Power(B2+u,-p2);
  return result;
}

std::vector<float> sigmaGaussianFits(TH1F* hist){
  float sigma = 1.0;
  float sigmaError = 1.0;

  TF1* fit_raw_range_0_8_to_1_2 = new TF1("fit_sigma_range_0_8_to_1_2", "gaus",0.0,3.0);
  hist->Fit("fit_sigma_range_0_8_to_1_2","R");
  //sigma is the parameter 2, mean is parameter 1
  float sigma_temp=fit_raw_range_0_8_to_1_2->GetParameter(2);
  if((1.0-3.*sigma_temp)>1.10){
    sigma_temp=0.034;
  }
  TF1* fit_raw_range_two_sigma = new TF1("fit_sigma_range_two_sigma", "gaus",1.0-3.*sigma_temp,1.0+3.*sigma_temp);
  hist->Fit("fit_sigma_range_two_sigma","R");
  sigma=fit_raw_range_two_sigma->GetParameter(2);
  sigmaError=fit_raw_range_two_sigma->GetParError(2);

  std::vector<float> SigmaWError;
  SigmaWError.push_back(sigma);
  SigmaWError.push_back(sigmaError);
  float sigma_before=fit_raw_range_0_8_to_1_2->GetParameter(2);
  float sigma_beforeError=fit_raw_range_0_8_to_1_2->GetParError(2);

  for(unsigned int i=0;i<1000;i++){
    TF1* fit_raw_range_temp = new TF1("fit_sigma_range_temp", "gaus",1.0-3.*sigma_before,1.0+3.*sigma_before);
    hist->Fit("fit_sigma_range_temp","R");
    float sigma_after=fit_raw_range_temp->GetParameter(2);
    float sigma_afterError=fit_raw_range_temp->GetParError(2);
    if((sigma_after/sigma_before)<1.02 && (sigma_after/sigma_before)>0.98){
      sigma_before=sigma_after;
      sigma_beforeError=sigma_afterError;
      break;
    }
    sigma_before=sigma_after;
    sigma_beforeError=sigma_afterError;
 }
  SigmaWError.push_back(sigma_before);
  SigmaWError.push_back(sigma_beforeError);

  return SigmaWError;

}


std::vector<float> sigmaGaussianFits2Sigma(TH1F* hist){
  float sigma = 1.0;
  float sigmaError = 1.0;

  TF1* fit_raw_range_0_8_to_1_2 = new TF1("fit_sigma_range_0_8_to_1_2", "gaus",0.0,3.00);

  fit_raw_range_0_8_to_1_2->SetParameter(0,hist->GetBinContent(hist->GetMaximumBin()));
  std::cout<<"start with maximum "<<hist->GetMaximumBin()<<" value "<<hist->GetBinContent(hist->GetMaximumBin())<<std::endl;
  
  fit_raw_range_0_8_to_1_2->SetParLimits(0,0.50*hist->GetBinContent(hist->GetMaximumBin()),1.50*hist->GetBinContent(hist->GetMaximumBin()));
  //fit_raw_range_0_8_to_1_2->SetParameter(1,0); 
  //fit_raw_range_0_8_to_1_2->SetParLimits (1,0.75,1.25);
  //fit_raw_range_0_8_to_1_2->SetParLimits (2,0.02,0.20);

  hist->Fit("fit_sigma_range_0_8_to_1_2","R");
  //sigma is the parameter 2, mean is parameter 1
  float sigma_temp=fit_raw_range_0_8_to_1_2->GetParameter(2);
  //if((1.0-2.*sigma_temp)<1.10){
  //sigma_temp=0.05;
  //} 
  TF1* fit_raw_range_two_sigma = new TF1("fit_sigma_range_two_sigma", "gaus",1.0-2.*sigma_temp,1.0+2.*sigma_temp);
  fit_raw_range_0_8_to_1_2->SetParLimits(0,0.50*hist->GetBinContent(hist->GetMaximumBin()),1.50*hist->GetBinContent(hist->GetMaximumBin()));
  //fit_raw_range_0_8_to_1_2->SetParameter(1,1); 
  fit_raw_range_0_8_to_1_2->SetParLimits (1,1.0-2.*sigma_temp,1.0+2.*sigma_temp);
  hist->Fit("fit_sigma_range_two_sigma","R");
  sigma=fit_raw_range_two_sigma->GetParameter(2);
  sigmaError=fit_raw_range_two_sigma->GetParError(2);
  //gaussian mean
  //fit_raw_range_two_sigma->SetParLimits (1,0.75,1.25);

  std::vector<float> SigmaWError;
  SigmaWError.push_back(sigma);
  SigmaWError.push_back(sigmaError);
  float sigma_before=fit_raw_range_0_8_to_1_2->GetParameter(2);
  float sigma_beforeError=fit_raw_range_0_8_to_1_2->GetParError(2);

  for(unsigned int i=0;i<1000;i++){
    TF1* fit_raw_range_temp = new TF1("fit_sigma_range_temp", "gaus",1.0-2.*sigma_before,1.0+2.*sigma_before);
    hist->Fit("fit_sigma_range_temp","R");
    float sigma_after=fit_raw_range_temp->GetParameter(2);
    float sigma_afterError=fit_raw_range_temp->GetParError(2);
    if((sigma_after/sigma_before)<1.05 && (sigma_after/sigma_before)>0.95){
      sigma_before=sigma_after;
      sigma_beforeError=sigma_afterError;
      break;
    }
    sigma_before=sigma_after;
    sigma_beforeError=sigma_afterError;
 }
  SigmaWError.push_back(sigma_before);
  SigmaWError.push_back(sigma_beforeError);

  return SigmaWError;

}

float DeltaPhi(float Phi1,float Phi2){
  float deltaphi=fabs(Phi1-Phi2);
  if(deltaphi>M_PI){
    deltaphi=2*M_PI-deltaphi;
  }
  return deltaphi;
}

float calculate_over90(TH1F* hist){

  if(hist->GetEntries()==0){
    return 0;
  }

  float sum_events=0;
  for (int i=0;i<=(hist->GetNbinsX()+1);i++){
    if(hist->GetBinLowEdge(i)>0.90){
      sum_events+=hist->GetBinContent(i);
    }
  }
  return sum_events/(hist->GetBinContent(0)+hist->Integral()+hist->GetBinContent(hist->GetNbinsX()+1));
}

void CalculatePerformance(const TH1F *const pTH1F, float &resolution, float &resolutionError, float &mean, float &meanError)
{
  //expects an average of two quantities --> originally from total event energy, thus multiply by a factor of sqrt(2) later
  static const float FLOAT_MAX(std::numeric_limits<float>::max());
  
  if (NULL == pTH1F)
    return;
  
  if (5 > pTH1F->GetEntries())
    {
      std::cout << pTH1F->GetName() << " (" << pTH1F->GetEntries() << " entries) - skipped" << std::endl;
      return;
    }
  
  // Calculate raw properties of distribution
  float sum = 0., total = 0.;
  double sx = 0., sxx = 0.;
  const unsigned int nbins(pTH1F->GetNbinsX());
  
  for (unsigned int i = 0; i <= nbins; ++i)
    {
      const float binx(pTH1F->GetBinLowEdge(i) + (0.5 * pTH1F->GetBinWidth(i)));
      const float yi(pTH1F->GetBinContent(i));
      sx += yi * binx;
      sxx += yi * binx * binx;
      total += yi;
    }
  
  const float rawMean(sx / total);
  const float rawMeanSqua(sxx / total);
  const float rawRms(std::sqrt(rawMeanSqua - rawMean * rawMean));
  
  sum = 0.;
  unsigned int is0 = 0;
  
  for (unsigned int i = 0; (i <= nbins) && (sum < total / 10.); ++i)
    {
      sum += pTH1F->GetBinContent(i);
      is0 = i;
    }
  
  // Calculate truncated properties
  float rmsmin(FLOAT_MAX), sigma(FLOAT_MAX), sigmasigma(FLOAT_MAX), frac(FLOAT_MAX), efrac(FLOAT_MAX)/*, mean(FLOAT_MAX)*/, low(FLOAT_MAX), rms(FLOAT_MAX);
  float high(0.f);
  
  for (unsigned int istart = 0; istart <= is0; ++istart)
    {
      double sumn = 0.;
      double csum = 0.;
      double sumx = 0.;
      double sumxx = 0.;
      unsigned int iend = 0;
      
      for (unsigned int i = istart; (i <= nbins) && (csum < 0.9 * total); ++i)
        {
	  const float binx(pTH1F->GetBinLowEdge(i) + (0.5 * pTH1F->GetBinWidth(i)));
	  const float yi(pTH1F->GetBinContent(i));
	  csum += yi;
	  
	  if (sumn < 0.9 * total)
            {
	      sumn += yi;
	      sumx += yi * binx;
	      sumxx+= yi * binx * binx;
	      iend = i;
            }
        }
      
        const float localMean(sumx / sumn);
        const float localMeanSqua(sumxx / sumn);
        const float localRms(std::sqrt(localMeanSqua - localMean * localMean));
	
        if (localRms < rmsmin)
	  {
            mean = localMean;
            rms = localRms;
            low = pTH1F->GetBinLowEdge(istart);
            high = pTH1F->GetBinLowEdge(iend);
            rmsmin = localRms;
	    //mean=1.;
	    frac = rms / mean * std::sqrt(2) * 100.;
	    efrac = frac / std::sqrt(total);
	    meanError = mean / std::sqrt(total); 
	  }
	resolution = frac;
	resolutionError = efrac;
    }
  std::cout<<"resolution/error "<<resolution<<"/"<<resolutionError<<" mean "<<mean<<std::endl;
}


void CalculatePerformanceNoMean(const TH1F *const pTH1F, float &resolution, float &resolutionError, float &mean, float &meanError)
{
  static const float FLOAT_MAX(std::numeric_limits<float>::max());
  
  if (NULL == pTH1F)
    return;
  
  if (5 > pTH1F->GetEntries())
    {
      std::cout << pTH1F->GetName() << " (" << pTH1F->GetEntries() << " entries) - skipped" << std::endl;
      return;
    }
  
  // Calculate raw properties of distribution
  float sum = 0., total = 0.;
  double sx = 0., sxx = 0.;
  const unsigned int nbins(pTH1F->GetNbinsX());
  
  for (unsigned int i = 0; i <= nbins; ++i)
    {
      const float binx(pTH1F->GetBinLowEdge(i) + (0.5 * pTH1F->GetBinWidth(i)));
      const float yi(pTH1F->GetBinContent(i));
      sx += yi * binx;
      sxx += yi * binx * binx;
      total += yi;
    }
  
  const float rawMean(sx / total);
  const float rawMeanSqua(sxx / total);
  const float rawRms(std::sqrt(rawMeanSqua - rawMean * rawMean));

  sum = 0.;
  unsigned int is0 = 0;
  
  for (unsigned int i = 0; (i <= nbins) && (sum < total / 10.); ++i)
    {
      sum += pTH1F->GetBinContent(i);
      is0 = i;
    }
  
  // Calculate truncated properties
  float rmsmin(FLOAT_MAX), sigma(FLOAT_MAX), sigmasigma(FLOAT_MAX), frac(FLOAT_MAX), efrac(FLOAT_MAX)/*, mean(FLOAT_MAX)*/, low(FLOAT_MAX), rms(FLOAT_MAX);
  float high(0.f);
  
  for (unsigned int istart = 0; istart <= is0; ++istart)
    {
      double sumn = 0.;
      double csum = 0.;
      double sumx = 0.;
      double sumxx = 0.;
      unsigned int iend = 0;
      
      for (unsigned int i = istart; (i <= nbins) && (csum < 0.9 * total); ++i)
        {
	  const float binx(pTH1F->GetBinLowEdge(i) + (0.5 * pTH1F->GetBinWidth(i)));
	  const float yi(pTH1F->GetBinContent(i));
	  csum += yi;
	  
	  if (sumn < 0.9 * total)
            {
	      sumn += yi;
	      sumx += yi * binx;
	      sumxx+= yi * binx * binx;
	      iend = i;
            }
        }
      
        const float localMean(sumx / sumn);
        const float localMeanSqua(sumxx / sumn);
        const float localRms(std::sqrt(localMeanSqua - localMean * localMean));
	
        if (localRms < rmsmin)
	  {
            mean = localMean;
            rms = localRms;
            low = pTH1F->GetBinLowEdge(istart);
            high = pTH1F->GetBinLowEdge(iend);
            rmsmin = localRms;
	    frac = rms;
	    efrac = frac / std::sqrt(total);
	    meanError = mean / std::sqrt(total);
	  }
	resolution = frac;
	resolutionError = efrac;
    }

}



TCanvas* setUpperCanvas(const char* canvas_name) {
    TCanvas* c1= new TCanvas(canvas_name,canvas_name,10,50,600,500);
    c1->cd();
    gPad->SetTopMargin(0.06);
    return c1;
}



void fill_background_missingPT_histograms(TFile* file, std::vector<TH1F*> h_hist_vec, float cut_top_cosTheta){

  TTree* tree = (TTree*)file->Get("showerData");

  float E_totPFO=0;
  float px_totPFO=0;
  float py_totPFO=0;
  float pz_totPFO=0;

  float E_trueAll=0;
  float px_trueAll=0;
  float py_trueAll=0;
  float pz_trueAll=0;

  float E_trueInv=0;
  float px_trueInv=0;
  float py_trueInv=0;
  float pz_trueInv=0;


  float E_top1=0;
  float px_top1=0;
  float py_top1=0;
  float pz_top1=0;


  float E_top2=0;
  float px_top2=0;
  float py_top2=0;
  float pz_top2=0;

  int ttbarDecayMode=-1;

  tree->SetBranchAddress("ttbarDecayMode",&ttbarDecayMode);

  tree->SetBranchAddress("E_totPFO", &E_totPFO);
  tree->SetBranchAddress("Px_totPFO", &px_totPFO);
  tree->SetBranchAddress("Py_totPFO", &py_totPFO);
  tree->SetBranchAddress("Pz_totPFO", &pz_totPFO);

  tree->SetBranchAddress("E_trueAll", &E_trueAll);
  tree->SetBranchAddress("Px_trueAll", &px_trueAll);
  tree->SetBranchAddress("Py_trueAll", &py_trueAll);
  tree->SetBranchAddress("Pz_trueAll", &pz_trueAll);

  tree->SetBranchAddress("E_top1", &E_top1);
  tree->SetBranchAddress("Px_top1", &px_top1);
  tree->SetBranchAddress("Py_top1", &py_top1);
  tree->SetBranchAddress("Pz_top1", &pz_top1);

  tree->SetBranchAddress("E_top2", &E_top2);
  tree->SetBranchAddress("Px_top2", &px_top2);
  tree->SetBranchAddress("Py_top2", &py_top2);
  tree->SetBranchAddress("Pz_top2", &pz_top2);

  tree->SetBranchAddress("E_trueInv", &E_trueInv);
  tree->SetBranchAddress("Px_trueInv", &px_trueInv);
  tree->SetBranchAddress("Py_trueInv", &py_trueInv);
  tree->SetBranchAddress("Pz_trueInv", &pz_trueInv);



  for(unsigned int i_entry=0;i_entry<tree->GetEntries();i_entry++){
    tree->GetEntry(i_entry);
    bool forward_quarks=false;
    TLorentzVector top;
    top.SetPxPyPzE(px_top1,py_top1,pz_top1,E_top1);
    if(fabs(top.CosTheta())>cut_top_cosTheta){
      forward_quarks=true;
    }
    if(forward_quarks || ttbarDecayMode==0){
      //std::cout<<"fw quarks "<<std::endl;
      continue;
    }
    h_hist_vec[0]->Fill(-px_totPFO);
    h_hist_vec[1]->Fill(sqrt(px_totPFO*px_totPFO+py_totPFO*py_totPFO)  - sqrt(px_trueInv*px_trueInv+py_trueInv*py_trueInv));
    h_hist_vec[2]->Fill(sqrt(px_totPFO*px_totPFO+py_totPFO*py_totPFO));
    h_hist_vec[3]->Fill(E_totPFO);
    h_hist_vec[4]->Fill(TMath::RadToDeg()*atan2(-py_totPFO,-px_totPFO));
    h_hist_vec[5] ->Fill(sqrt(px_trueInv*px_trueInv+py_trueInv*py_trueInv));
    h_hist_vec[6]->Fill(TMath::RadToDeg()*atan2(py_trueInv,px_trueInv));
    h_hist_vec[7]->Fill(TMath::RadToDeg()*DeltaPhiDir(atan2(py_trueInv,px_trueInv),atan2(-py_totPFO,-px_totPFO)));
    //0,25,50,75,100,140,180,220,260,340,420,500,750,1500
    float trueMET=sqrt(px_trueInv*px_trueInv+py_trueInv*py_trueInv);
    //std::cout<<"delta MET/true/reco MET/ dphi "<<sqrt(px_totPFO*px_totPFO+py_totPFO*py_totPFO)  - sqrt(px_trueInv*px_trueInv+py_trueInv*py_trueInv)<<"/"<<sqrt(px_trueInv*px_trueInv+py_trueInv*py_trueInv)<<"/"<<sqrt(px_totPFO*px_totPFO+py_totPFO*py_totPFO)<<"/"<<TMath::RadToDeg()*DeltaPhiDir(atan2(py_trueInv,px_trueInv),atan2(-py_totPFO,-px_totPFO))<<std::endl;
    if(trueMET<25){
      h_hist_vec[8]->Fill((sqrt(px_totPFO*px_totPFO+py_totPFO*py_totPFO)  - sqrt(px_trueInv*px_trueInv+py_trueInv*py_trueInv))/trueMET);
      h_hist_vec[9]->Fill(TMath::RadToDeg()*DeltaPhiDir(atan2(py_trueInv,px_trueInv),atan2(-py_totPFO,-px_totPFO)));
    }else if(trueMET<50){
      h_hist_vec[10]->Fill((sqrt(px_totPFO*px_totPFO+py_totPFO*py_totPFO)  - sqrt(px_trueInv*px_trueInv+py_trueInv*py_trueInv))/trueMET);
      h_hist_vec[11]->Fill(TMath::RadToDeg()*DeltaPhiDir(atan2(py_trueInv,px_trueInv),atan2(-py_totPFO,-px_totPFO)));
    }else if(trueMET<75){
      h_hist_vec[12]->Fill((sqrt(px_totPFO*px_totPFO+py_totPFO*py_totPFO)  - sqrt(px_trueInv*px_trueInv+py_trueInv*py_trueInv))/trueMET);
      h_hist_vec[13]->Fill(TMath::RadToDeg()*DeltaPhiDir(atan2(py_trueInv,px_trueInv),atan2(-py_totPFO,-px_totPFO)));
    }else if(trueMET<100){
      h_hist_vec[14]->Fill((sqrt(px_totPFO*px_totPFO+py_totPFO*py_totPFO)  - sqrt(px_trueInv*px_trueInv+py_trueInv*py_trueInv))/trueMET);
      h_hist_vec[15]->Fill(TMath::RadToDeg()*DeltaPhiDir(atan2(py_trueInv,px_trueInv),atan2(-py_totPFO,-px_totPFO)));
    }else if(trueMET<140){
      h_hist_vec[16]->Fill((sqrt(px_totPFO*px_totPFO+py_totPFO*py_totPFO)  - sqrt(px_trueInv*px_trueInv+py_trueInv*py_trueInv))/trueMET);
      h_hist_vec[17]->Fill(TMath::RadToDeg()*DeltaPhiDir(atan2(py_trueInv,px_trueInv),atan2(-py_totPFO,-px_totPFO)));
    }else if(trueMET<180){
      h_hist_vec[18]->Fill((sqrt(px_totPFO*px_totPFO+py_totPFO*py_totPFO)  - sqrt(px_trueInv*px_trueInv+py_trueInv*py_trueInv))/trueMET);
      h_hist_vec[19]->Fill(TMath::RadToDeg()*DeltaPhiDir(atan2(py_trueInv,px_trueInv),atan2(-py_totPFO,-px_totPFO)));
    }else if(trueMET<220){
      h_hist_vec[20]->Fill((sqrt(px_totPFO*px_totPFO+py_totPFO*py_totPFO)  - sqrt(px_trueInv*px_trueInv+py_trueInv*py_trueInv))/trueMET);
      h_hist_vec[21]->Fill(TMath::RadToDeg()*DeltaPhiDir(atan2(py_trueInv,px_trueInv),atan2(-py_totPFO,-px_totPFO)));
    }else if(trueMET<260){
      h_hist_vec[22]->Fill((sqrt(px_totPFO*px_totPFO+py_totPFO*py_totPFO)  - sqrt(px_trueInv*px_trueInv+py_trueInv*py_trueInv))/trueMET);
      h_hist_vec[23]->Fill(TMath::RadToDeg()*DeltaPhiDir(atan2(py_trueInv,px_trueInv),atan2(-py_totPFO,-px_totPFO)));
    }else if(trueMET<340){
      h_hist_vec[24]->Fill((sqrt(px_totPFO*px_totPFO+py_totPFO*py_totPFO)  - sqrt(px_trueInv*px_trueInv+py_trueInv*py_trueInv))/trueMET);
      h_hist_vec[25]->Fill(TMath::RadToDeg()*DeltaPhiDir(atan2(py_trueInv,px_trueInv),atan2(-py_totPFO,-px_totPFO)));
    }else if(trueMET<420){
      h_hist_vec[26]->Fill((sqrt(px_totPFO*px_totPFO+py_totPFO*py_totPFO)  - sqrt(px_trueInv*px_trueInv+py_trueInv*py_trueInv))/trueMET);
      h_hist_vec[27]->Fill(TMath::RadToDeg()*DeltaPhiDir(atan2(py_trueInv,px_trueInv),atan2(-py_totPFO,-px_totPFO)));
    }else if(trueMET<500){
      h_hist_vec[28]->Fill((sqrt(px_totPFO*px_totPFO+py_totPFO*py_totPFO)  - sqrt(px_trueInv*px_trueInv+py_trueInv*py_trueInv))/trueMET);
      h_hist_vec[29]->Fill(TMath::RadToDeg()*DeltaPhiDir(atan2(py_trueInv,px_trueInv),atan2(-py_totPFO,-px_totPFO)));
    }else if(trueMET<750){
      h_hist_vec[30]->Fill((sqrt(px_totPFO*px_totPFO+py_totPFO*py_totPFO)  - sqrt(px_trueInv*px_trueInv+py_trueInv*py_trueInv))/trueMET);
      h_hist_vec[31]->Fill(TMath::RadToDeg()*DeltaPhiDir(atan2(py_trueInv,px_trueInv),atan2(-py_totPFO,-px_totPFO)));
    }else{
      h_hist_vec[32]->Fill((sqrt(px_totPFO*px_totPFO+py_totPFO*py_totPFO)  - sqrt(px_trueInv*px_trueInv+py_trueInv*py_trueInv))/trueMET);
      h_hist_vec[33]->Fill(TMath::RadToDeg()*DeltaPhiDir(atan2(py_trueInv,px_trueInv),atan2(-py_totPFO,-px_totPFO)));
    }
  }
  delete tree;
}



void CLICdpStyle()
{
  gROOT->SetStyle("Plain"); /*Default white background for all plots*/
  /* set bkg color of all to kWhite: white, but not 0*/
  gStyle->SetCanvasColor(kWhite);
  gStyle->SetFrameFillColor(kWhite);
  gStyle->SetStatColor(kWhite);
  gStyle->SetPadColor(kWhite);
  gStyle->SetFillColor(10);
  gStyle->SetTitleFillColor(kWhite);
  
  
   /* SetPaperSize wants width & height in cm: A4 is 20,26 & US is 20,24*/
   gStyle->SetPaperSize(20, 26); 
   /* No yellow border around histogram*/
   gStyle->SetDrawBorder(0);
   /* remove border of canvas*/
   gStyle->SetCanvasBorderMode(0);
   /* remove border of pads*/
   gStyle->SetPadBorderMode(0);
   gStyle->SetFrameBorderMode(0);
   gStyle->SetLegendBorderSize(0);
  
   /* default text size*/
   gStyle->SetTextSize(0.05);
   gStyle->SetTitleSize(0.06,"xyz");
   gStyle->SetLabelSize(0.06,"xyz");
   /* title offset: distance between given text and axis, here x,y,z*/
   gStyle->SetLabelOffset(0.015,"xyz");
   gStyle->SetTitleOffset(1.2,"yz"); //equivalent to: gStyle->SetTitleYOffset(1.2);
   gStyle->SetTitleOffset(1.17,"x");



   /* Use visible font for all text*/
   int font = 42; 
   gStyle->SetTitleFont(font);
   gStyle->SetTitleFontSize(0.06);
   gStyle->SetStatFont(font);
   gStyle->SetStatFontSize(0.07);
   gStyle->SetTextFont(font);
   gStyle->SetLabelFont(font,"xyz");
   gStyle->SetTitleFont(font,"xyz");
   gStyle->SetTitleBorderSize(0);
   gStyle->SetStatBorderSize(1);
   //ROSA
   //gStyle->SetLegendFont(font);

   /* big marker points*/
   gStyle->SetMarkerStyle(1);
   gStyle->SetLineWidth(2);  
   gStyle->SetMarkerSize(1.2);
   /*set palette in 2d histogram to nice and colorful one*/
   gStyle->SetPalette(1,0); 

   /*No title for histograms*/
   gStyle->SetOptTitle(0);
   /* show the errors on the stat box */
   gStyle->SetOptStat(0); 
   /* show errors on fitted parameters*/
   gStyle->SetOptFit(0); 
   /* number of decimals used for errors*/
   gStyle->SetEndErrorSize(5);   

   /* set line width to 2 by default so that histograms are visible when printed small
      idea: emphasize the data, not the frame around*/
   gStyle->SetHistLineWidth(2);
   gStyle->SetFrameLineWidth(2);
   gStyle->SetFuncWidth(2);
   gStyle->SetHistLineColor(kBlack);
   gStyle->SetFuncColor(kBlack);
   gStyle->SetLabelColor(kBlack,"xyz");

   //set the margins
   gStyle->SetPadBottomMargin(0.18);
   gStyle->SetPadTopMargin(0.11);
   gStyle->SetPadRightMargin(0.08);
   gStyle->SetPadLeftMargin(0.17);
   
   //set the number of divisions to show
   gStyle->SetNdivisions(506, "xy");
   
   //turn off xy grids
   gStyle->SetPadGridX(0);
   gStyle->SetPadGridY(0);
   
   //set the tick mark style
   gStyle->SetPadTickX(1);
   gStyle->SetPadTickY(1);

   gStyle->SetCanvasDefW(800);
   gStyle->SetCanvasDefH(700);

   gROOT->ForceStyle();
}


TCanvas* setRatioCanvas(const char* canvas_name) {
    TCanvas* c1= new TCanvas(canvas_name,canvas_name,0,50,800,300);
    c1->cd();
    gPad->SetTopMargin(0.06);
    return c1;
}


void fill_mass_histograms(TFile* file, std::vector<TH1F*> h_hist_vec){

  TTree* tree = (TTree*)file->Get("showerData");

  float Px_trueAll=0;
  float Py_trueAll=0;
  float Pz_trueAll=0;
  float E_trueAll=0;

  float Px_totPFO=0;
  float Py_totPFO=0;
  float Pz_totPFO=0;
  float E_totPFO=0;

  vector<float> *trueME_Px=0;
  vector<float> *trueME_Py=0;
  vector<float> *trueME_Pz=0;
  vector<float> *trueME_E=0;
  vector<int> *trueME_PDGID=0;

  vector<float> *genJetR07Px=0;
  vector<float> *genJetR07Py=0;
  vector<float> *genJetR07Pz=0;
  vector<float> *genJetR07E=0;


  vector<float> *recoJetR07Px=0;
  vector<float> *recoJetR07Py=0;
  vector<float> *recoJetR07Pz=0;
  vector<float> *recoJetR07E=0;


  tree->SetBranchAddress("E_trueAll", &E_trueAll);
  tree->SetBranchAddress("Px_trueAll", &Px_trueAll);
  tree->SetBranchAddress("Py_trueAll", &Py_trueAll);
  tree->SetBranchAddress("Pz_trueAll", &Pz_trueAll);
 
  tree->SetBranchAddress("E_totPFO", &E_totPFO);
  tree->SetBranchAddress("Px_totPFO", &Px_totPFO);
  tree->SetBranchAddress("Py_totPFO", &Py_totPFO);
  tree->SetBranchAddress("Pz_totPFO", &Pz_totPFO);
  
  tree->SetBranchAddress("trueME_E", &trueME_E);
  tree->SetBranchAddress("trueME_Px", &trueME_Px);
  tree->SetBranchAddress("trueME_Py", &trueME_Py);
  tree->SetBranchAddress("trueME_Pz", &trueME_Pz);
  tree->SetBranchAddress("trueME_PDGID", &trueME_PDGID);
  
  tree->SetBranchAddress("genJetR07E", &genJetR07E);
  tree->SetBranchAddress("genJetR07Px", &genJetR07Px);
  tree->SetBranchAddress("genJetR07Py", &genJetR07Py);
  tree->SetBranchAddress("genJetR07Pz", &genJetR07Pz);

  tree->SetBranchAddress("recoJetR07E", &recoJetR07E);
  tree->SetBranchAddress("recoJetR07Px", &recoJetR07Px);
  tree->SetBranchAddress("recoJetR07Py", &recoJetR07Py);
  tree->SetBranchAddress("recoJetR07Pz", &recoJetR07Pz);

  double m_costheta_max = 0.9;

  for(unsigned int i_entry=0;i_entry<tree->GetEntries();i_entry++){
    //fill jet energy resolution histograms
    tree->GetEntry(i_entry);
    if(i_entry%3000==0){
      std::cout<<"i_entry "<<i_entry<<std::endl;
    }
    TLorentzVector tempMEVecQuarks(0,0,0,0);
    
    for(unsigned int m=0;m<trueME_E->size();m++){
      if(abs((*trueME_PDGID)[m])<7){
	TLorentzVector temp(0,0,0,0);
	temp.SetPxPyPzE((*trueME_Px)[m],(*trueME_Py)[m],(*trueME_Pz)[m],(*trueME_E)[m]);
	tempMEVecQuarks+=temp;
      }
      if(abs((*trueME_PDGID)[m])==24 || (*trueME_PDGID)[m]==23){
	h_hist_vec[4]->Fill(sqrt((*trueME_E)[m]*(*trueME_E)[m]-(*trueME_Px)[m]*(*trueME_Px)[m]-(*trueME_Py)[m]*(*trueME_Py)[m]-(*trueME_Pz)[m]*(*trueME_Pz)[m]));
      }
    }
    h_hist_vec[5]->Fill(tempMEVecQuarks.M());
    

    TLorentzVector tempGenJet1(0,0,0,0);
    TLorentzVector tempGenJet2(0,0,0,0);
    if(genJetR07E->size()>1){
      tempGenJet1.SetPxPyPzE((*genJetR07Px)[0],(*genJetR07Py)[0],(*genJetR07Pz)[0],(*genJetR07E)[0]);
      tempGenJet2.SetPxPyPzE((*genJetR07Px)[1],(*genJetR07Py)[1],(*genJetR07Pz)[1],(*genJetR07E)[1]);
      if(fabs(tempGenJet1.CosTheta())<0.9 && fabs(tempGenJet2.CosTheta())<0.9){
	h_hist_vec[0]->Fill(tempGenJet1.E()+tempGenJet2.E());
	h_hist_vec[2]->Fill((tempGenJet1+tempGenJet2).M());
      }
    }

    TLorentzVector tempRecoJet1(0,0,0,0);
    TLorentzVector tempRecoJet2(0,0,0,0);

    if(recoJetR07E->size()>1){
      tempRecoJet1.SetPxPyPzE((*recoJetR07Px)[0],(*recoJetR07Py)[0],(*recoJetR07Pz)[0],(*recoJetR07E)[0]);
      tempRecoJet2.SetPxPyPzE((*recoJetR07Px)[1],(*recoJetR07Py)[1],(*recoJetR07Pz)[1],(*recoJetR07E)[1]);
      if(fabs(tempRecoJet1.CosTheta())<0.9 && fabs(tempRecoJet2.CosTheta())<0.9){
	h_hist_vec[1]->Fill(tempRecoJet1.E()+tempRecoJet2.E());
	h_hist_vec[3]->Fill((tempRecoJet1+tempRecoJet2).M());
      }//else{
	//	std::cout<<"have at least one forward jet "<<fabs(tempRecoJet1.CosTheta())<<"/"<<fabs(tempRecoJet2.CosTheta())<<std::endl;
      //}      
    }
  }
  delete tree;
}

  
void fill_SC_jet_histograms(TFile* file, std::vector<TH1F*> h_hist_vec){
  
  TTree* tree = (TTree*)file->Get("showerData");

  float d1_mcE=0;
  float d1_mcPx=0;
  float d1_mcPy=0;
  float d1_mcPz=0;

  vector<float> *genJetR07Px=0;
  vector<float> *genJetR07Py=0;
  vector<float> *genJetR07Pz=0;
  vector<float> *genJetR07E=0;

  vector<float> *recoJetR07Px=0;
  vector<float> *recoJetR07Py=0;
  vector<float> *recoJetR07Pz=0;
  vector<float> *recoJetR07E=0;

  tree->SetBranchAddress("d1_mcE",&d1_mcE);
  tree->SetBranchAddress("d1_mcPx",&d1_mcPx);
  tree->SetBranchAddress("d1_mcPy",&d1_mcPy);
  tree->SetBranchAddress("d1_mcPz",&d1_mcPz);

  tree->SetBranchAddress("genJetR07E", &genJetR07E);
  tree->SetBranchAddress("genJetR07Px", &genJetR07Px);
  tree->SetBranchAddress("genJetR07Py", &genJetR07Py);
  tree->SetBranchAddress("genJetR07Pz", &genJetR07Pz);

  tree->SetBranchAddress("recoJetR07E", &recoJetR07E);
  tree->SetBranchAddress("recoJetR07Px", &recoJetR07Px);
  tree->SetBranchAddress("recoJetR07Py", &recoJetR07Py);
  tree->SetBranchAddress("recoJetR07Pz", &recoJetR07Pz);

  double delta_phi_min = 2.8;

  double delta_phi_max_reco_gen = 10.0;

  for(unsigned int i_entry=0;i_entry<tree->GetEntries();i_entry++){
    //fill jet energy resolution histograms
    tree->GetEntry(i_entry);
    
    TLorentzVector tempQuark(0,0,0,0);
    tempQuark.SetPxPyPzE(d1_mcPx,d1_mcPy,d1_mcPz,d1_mcE);

    float d1_cosTheta=tempQuark.CosTheta();
    TLorentzVector tempGenJet1(0,0,0,0);
    TLorentzVector tempGenJet2(0,0,0,0);
    TLorentzVector tempRecoJet1(0,0,0,0);
    TLorentzVector tempRecoJet2(0,0,0,0);
    float deltaPhig1r=0;
    float deltaPhig2r=0;
    float reco1_over_gen=0;
    float reco2_over_gen=0;
    if(genJetR07E->size()==2){
      tempGenJet1.SetPxPyPzE((*genJetR07Px)[0],(*genJetR07Py)[0],(*genJetR07Pz)[0],(*genJetR07E)[0]);
      tempGenJet2.SetPxPyPzE((*genJetR07Px)[1],(*genJetR07Py)[1],(*genJetR07Pz)[1],(*genJetR07E)[1]);
      if(recoJetR07E->size()==2){
	tempRecoJet1.SetPxPyPzE((*recoJetR07Px)[0],(*recoJetR07Py)[0],(*recoJetR07Pz)[0],(*recoJetR07E)[0]);
	deltaPhig1r=tempGenJet1.Angle(tempRecoJet1.Vect());
	deltaPhig2r=tempGenJet2.Angle(tempRecoJet1.Vect());
	int indrj1_m=0;
	float ang_rj1_g=deltaPhig1r;
	if(deltaPhig1r<deltaPhig2r){
	  reco1_over_gen=tempRecoJet1.E()/tempGenJet1.E();
	}else{	 
	  indrj1_m=1;
	  reco1_over_gen=tempRecoJet1.E()/tempGenJet2.E();
	  ang_rj1_g=deltaPhig2r;
	}
	tempRecoJet2.SetPxPyPzE((*recoJetR07Px)[1],(*recoJetR07Py)[1],(*recoJetR07Pz)[1],(*recoJetR07E)[1]);
	deltaPhig1r=tempGenJet1.Angle(tempRecoJet2.Vect());
	deltaPhig2r=tempGenJet2.Angle(tempRecoJet2.Vect());
	int indrj2_m=0;
	float ang_rj2_g=deltaPhig2r;
	if(deltaPhig1r<deltaPhig2r){
	  reco2_over_gen=tempRecoJet2.E()/tempGenJet1.E();
	  ang_rj2_g=deltaPhig1r;
	}else{
	  indrj2_m=1;
	  reco2_over_gen=tempRecoJet2.E()/tempGenJet2.E();
	}
	if(indrj1_m!=indrj2_m){
	  if(fabs(d1_cosTheta)<0.65){
	    if((ang_rj1_g*TMath::RadToDeg())<delta_phi_max_reco_gen){
	      h_hist_vec[0]->Fill(reco1_over_gen);
	    }
	    if((ang_rj2_g*TMath::RadToDeg())<delta_phi_max_reco_gen){
	      h_hist_vec[0]->Fill(reco2_over_gen);
	    }
	  }else if(fabs(d1_cosTheta)<0.80){
	    if((ang_rj1_g*TMath::RadToDeg())<delta_phi_max_reco_gen){
	      h_hist_vec[1]->Fill(reco1_over_gen);
	    }
	    if((ang_rj2_g*TMath::RadToDeg())<delta_phi_max_reco_gen){
	      h_hist_vec[1]->Fill(reco2_over_gen);
	    }
	  }else if(fabs(d1_cosTheta)<0.925){
	    if((ang_rj1_g*TMath::RadToDeg())<delta_phi_max_reco_gen){
	      h_hist_vec[2]->Fill(reco1_over_gen);
	    }
	    if((ang_rj2_g*TMath::RadToDeg())<delta_phi_max_reco_gen){
	      h_hist_vec[2]->Fill(reco2_over_gen);
	    }
	  }else{
	    if((ang_rj1_g*TMath::RadToDeg())<delta_phi_max_reco_gen){
	      h_hist_vec[3]->Fill(reco1_over_gen);
	    }
	    if((ang_rj2_g*TMath::RadToDeg())<delta_phi_max_reco_gen){
	      h_hist_vec[3]->Fill(reco2_over_gen);
	    }
	  }
	}
      }
    }
  }
  delete tree;
}





 
void fill_jet_histograms(TFile* file, std::vector<TH1F*> h_hist_vec){

  TTree* tree = (TTree*)file->Get("showerData");

  float Px_trueAll=0;
  float Py_trueAll=0;
  float Pz_trueAll=0;
  float E_trueAll=0;

  float Px_totPFO=0;
  float Py_totPFO=0;
  float Pz_totPFO=0;
  float E_totPFO=0;

  float d1_mcE=0;
  float d1_mcPx=0;
  float d1_mcPy=0;
  float d1_mcPz=0;
  
  float m_d2_mcE=0;
  float m_d2_mcPx=0;
  float m_d2_mcPy=0;
  float m_d2_mcPz=0;

  vector<float> *genJetR03Px=0;
  vector<float> *genJetR03Py=0;
  vector<float> *genJetR03Pz=0;
  vector<float> *genJetR03E=0;

  vector<float> *genJetR04Px=0;
  vector<float> *genJetR04Py=0;
  vector<float> *genJetR04Pz=0;
  vector<float> *genJetR04E=0;

  vector<float> *genJetR05Px=0;
  vector<float> *genJetR05Py=0;
  vector<float> *genJetR05Pz=0;
  vector<float> *genJetR05E=0;

  vector<float> *genJetR06Px=0;
  vector<float> *genJetR06Py=0;
  vector<float> *genJetR06Pz=0;
  vector<float> *genJetR06E=0;

  vector<float> *genJetR07Px=0;
  vector<float> *genJetR07Py=0;
  vector<float> *genJetR07Pz=0;
  vector<float> *genJetR07E=0;

  vector<float> *genJetR08Px=0;
  vector<float> *genJetR08Py=0;
  vector<float> *genJetR08Pz=0;
  vector<float> *genJetR08E=0;

  vector<float> *genJetR09Px=0;
  vector<float> *genJetR09Py=0;
  vector<float> *genJetR09Pz=0;
  vector<float> *genJetR09E=0;

  vector<float> *genJetR10Px=0;
  vector<float> *genJetR10Py=0;
  vector<float> *genJetR10Pz=0;
  vector<float> *genJetR10E=0;


  vector<float> *recoJetR03Px=0;
  vector<float> *recoJetR03Py=0;
  vector<float> *recoJetR03Pz=0;
  vector<float> *recoJetR03E=0;

  vector<float> *recoJetR04Px=0;
  vector<float> *recoJetR04Py=0;
  vector<float> *recoJetR04Pz=0;
  vector<float> *recoJetR04E=0;

  vector<float> *recoJetR05Px=0;
  vector<float> *recoJetR05Py=0;
  vector<float> *recoJetR05Pz=0;
  vector<float> *recoJetR05E=0;

  vector<float> *recoJetR06Px=0;
  vector<float> *recoJetR06Py=0;
  vector<float> *recoJetR06Pz=0;
  vector<float> *recoJetR06E=0;

  vector<float> *recoJetR07Px=0;
  vector<float> *recoJetR07Py=0;
  vector<float> *recoJetR07Pz=0;
  vector<float> *recoJetR07E=0;

  vector<float> *recoJetR08Px=0;
  vector<float> *recoJetR08Py=0;
  vector<float> *recoJetR08Pz=0;
  vector<float> *recoJetR08E=0;

  vector<float> *recoJetR09Px=0;
  vector<float> *recoJetR09Py=0;
  vector<float> *recoJetR09Pz=0;
  vector<float> *recoJetR09E=0;

  vector<float> *recoJetR10Px=0;
  vector<float> *recoJetR10Py=0;
  vector<float> *recoJetR10Pz=0;
  vector<float> *recoJetR10E=0;

  tree->SetBranchAddress("d1_mcE",&d1_mcE);
  tree->SetBranchAddress("d1_mcPx",&d1_mcPx);
  tree->SetBranchAddress("d1_mcPy",&d1_mcPy);
  tree->SetBranchAddress("d1_mcPz",&d1_mcPz);

  tree->SetBranchAddress("E_trueAll", &E_trueAll);
  tree->SetBranchAddress("Px_trueAll", &Px_trueAll);
  tree->SetBranchAddress("Py_trueAll", &Py_trueAll);
  tree->SetBranchAddress("Pz_trueAll", &Pz_trueAll);
 
  tree->SetBranchAddress("E_totPFO", &E_totPFO);
  tree->SetBranchAddress("Px_totPFO", &Px_totPFO);
  tree->SetBranchAddress("Py_totPFO", &Py_totPFO);
  tree->SetBranchAddress("Pz_totPFO", &Pz_totPFO);
  
  tree->SetBranchAddress("genJetR03E", &genJetR03E);
  tree->SetBranchAddress("genJetR03Px", &genJetR03Px);
  tree->SetBranchAddress("genJetR03Py", &genJetR03Py);
  tree->SetBranchAddress("genJetR03Pz", &genJetR03Pz);

  tree->SetBranchAddress("genJetR04E", &genJetR04E);
  tree->SetBranchAddress("genJetR04Px", &genJetR04Px);
  tree->SetBranchAddress("genJetR04Py", &genJetR04Py);
  tree->SetBranchAddress("genJetR04Pz", &genJetR04Pz);

  tree->SetBranchAddress("genJetR05E", &genJetR05E);
  tree->SetBranchAddress("genJetR05Px", &genJetR05Px);
  tree->SetBranchAddress("genJetR05Py", &genJetR05Py);
  tree->SetBranchAddress("genJetR05Pz", &genJetR05Pz);

  tree->SetBranchAddress("genJetR06E", &genJetR06E);
  tree->SetBranchAddress("genJetR06Px", &genJetR06Px);
  tree->SetBranchAddress("genJetR06Py", &genJetR06Py);
  tree->SetBranchAddress("genJetR06Pz", &genJetR06Pz);

  tree->SetBranchAddress("genJetR07E", &genJetR07E);
  tree->SetBranchAddress("genJetR07Px", &genJetR07Px);
  tree->SetBranchAddress("genJetR07Py", &genJetR07Py);
  tree->SetBranchAddress("genJetR07Pz", &genJetR07Pz);

  tree->SetBranchAddress("genJetR08E", &genJetR08E);
  tree->SetBranchAddress("genJetR08Px", &genJetR08Px);
  tree->SetBranchAddress("genJetR08Py", &genJetR08Py);
  tree->SetBranchAddress("genJetR08Pz", &genJetR08Pz);

  tree->SetBranchAddress("genJetR09E", &genJetR09E);
  tree->SetBranchAddress("genJetR09Px", &genJetR09Px);
  tree->SetBranchAddress("genJetR09Py", &genJetR09Py);
  tree->SetBranchAddress("genJetR09Pz", &genJetR09Pz);

  tree->SetBranchAddress("genJetR10E", &genJetR10E);
  tree->SetBranchAddress("genJetR10Px", &genJetR10Px);
  tree->SetBranchAddress("genJetR10Py", &genJetR10Py);
  tree->SetBranchAddress("genJetR10Pz", &genJetR10Pz);

  tree->SetBranchAddress("recoJetR03E", &recoJetR03E);
  tree->SetBranchAddress("recoJetR03Px", &recoJetR03Px);
  tree->SetBranchAddress("recoJetR03Py", &recoJetR03Py);
  tree->SetBranchAddress("recoJetR03Pz", &recoJetR03Pz);

  tree->SetBranchAddress("recoJetR04E", &recoJetR04E);
  tree->SetBranchAddress("recoJetR04Px", &recoJetR04Px);
  tree->SetBranchAddress("recoJetR04Py", &recoJetR04Py);
  tree->SetBranchAddress("recoJetR04Pz", &recoJetR04Pz);

  tree->SetBranchAddress("recoJetR05E", &recoJetR05E);
  tree->SetBranchAddress("recoJetR05Px", &recoJetR05Px);
  tree->SetBranchAddress("recoJetR05Py", &recoJetR05Py);
  tree->SetBranchAddress("recoJetR05Pz", &recoJetR05Pz);

  tree->SetBranchAddress("recoJetR06E", &recoJetR06E);
  tree->SetBranchAddress("recoJetR06Px", &recoJetR06Px);
  tree->SetBranchAddress("recoJetR06Py", &recoJetR06Py);
  tree->SetBranchAddress("recoJetR06Pz", &recoJetR06Pz);

  tree->SetBranchAddress("recoJetR07E", &recoJetR07E);
  tree->SetBranchAddress("recoJetR07Px", &recoJetR07Px);
  tree->SetBranchAddress("recoJetR07Py", &recoJetR07Py);
  tree->SetBranchAddress("recoJetR07Pz", &recoJetR07Pz);

  tree->SetBranchAddress("recoJetR08E", &recoJetR08E);
  tree->SetBranchAddress("recoJetR08Px", &recoJetR08Px);
  tree->SetBranchAddress("recoJetR08Py", &recoJetR08Py);
  tree->SetBranchAddress("recoJetR08Pz", &recoJetR08Pz);

  tree->SetBranchAddress("recoJetR09E", &recoJetR09E);
  tree->SetBranchAddress("recoJetR09Px", &recoJetR09Px);
  tree->SetBranchAddress("recoJetR09Py", &recoJetR09Py);
  tree->SetBranchAddress("recoJetR09Pz", &recoJetR09Pz);

  tree->SetBranchAddress("recoJetR10E", &recoJetR10E);
  tree->SetBranchAddress("recoJetR10Px", &recoJetR10Px);
  tree->SetBranchAddress("recoJetR10Py", &recoJetR10Py);
  tree->SetBranchAddress("recoJetR10Pz", &recoJetR10Pz);

  double delta_phi_min = 2.8;

  double delta_phi_max_reco_gen = 180.0;

  for(unsigned int i_entry=0;i_entry<tree->GetEntries();i_entry++){
    //fill jet energy resolution histograms
    tree->GetEntry(i_entry);
    TLorentzVector tempQuark(0,0,0,0);
    tempQuark.SetPxPyPzE(d1_mcPx,d1_mcPy,d1_mcPz,d1_mcE);

    float d1_cosTheta=tempQuark.CosTheta();

    TLorentzVector tempGenJet1(0,0,0,0);
    TLorentzVector tempGenJet2(0,0,0,0);
    TLorentzVector tempRecoJet1(0,0,0,0);
    TLorentzVector tempRecoJet2(0,0,0,0);
    float deltaPhig1r=0;
    float deltaPhig2r=0;
    float reco1_over_gen=0;
    float reco2_over_gen=0;
    if(genJetR03E->size()==2){
      tempGenJet1.SetPxPyPzE((*genJetR03Px)[0],(*genJetR03Py)[0],(*genJetR03Pz)[0],(*genJetR03E)[0]);
      tempGenJet2.SetPxPyPzE((*genJetR03Px)[1],(*genJetR03Py)[1],(*genJetR03Pz)[1],(*genJetR03E)[1]);
      h_hist_vec[0]->Fill(DeltaPhi(tempGenJet1.Phi(),tempGenJet2.Phi()));
      if(DeltaPhi(tempGenJet1.Phi(),tempGenJet2.Phi())> delta_phi_min){
	//back to back jets to increase dijet content in sample
	h_hist_vec[1]->Fill((tempGenJet1.E()+tempGenJet2.E())/E_trueAll);
	if(i_entry%2 ==0 ){
	  h_hist_vec[2]->Fill((tempGenJet1.E()-tempGenJet2.E())/(tempGenJet1.E()+tempGenJet2.E()));
	}else{
	  h_hist_vec[2]->Fill((tempGenJet2.E()-tempGenJet1.E())/(tempGenJet1.E()+tempGenJet2.E()));
	}
      }
      if(recoJetR03E->size()==2){
	tempRecoJet1.SetPxPyPzE((*recoJetR03Px)[0],(*recoJetR03Py)[0],(*recoJetR03Pz)[0],(*recoJetR03E)[0]);
	deltaPhig1r=tempGenJet1.Angle(tempRecoJet1.Vect());
	deltaPhig2r=tempGenJet2.Angle(tempRecoJet1.Vect());
	if(deltaPhig1r<deltaPhig2r){
	  h_hist_vec[48]->Fill(tempRecoJet1.E()/tempGenJet1.E());
	}else{
	  h_hist_vec[48]->Fill(tempRecoJet1.E()/tempGenJet2.E());
	}
	tempRecoJet2.SetPxPyPzE((*recoJetR03Px)[1],(*recoJetR03Py)[1],(*recoJetR03Pz)[1],(*recoJetR03E)[1]);
	deltaPhig1r=tempGenJet1.Angle(tempRecoJet2.Vect());
	deltaPhig2r=tempGenJet2.Angle(tempRecoJet2.Vect());
	if(deltaPhig1r<deltaPhig2r){
	  h_hist_vec[48]->Fill(tempRecoJet2.E()/tempGenJet1.E());
	}else{
	  h_hist_vec[48]->Fill(tempRecoJet2.E()/tempGenJet2.E());
	}
      }
    }
    if(genJetR04E->size()==2){
      tempGenJet1.SetPxPyPzE((*genJetR04Px)[0],(*genJetR04Py)[0],(*genJetR04Pz)[0],(*genJetR04E)[0]);
      tempGenJet2.SetPxPyPzE((*genJetR04Px)[1],(*genJetR04Py)[1],(*genJetR04Pz)[1],(*genJetR04E)[1]);
      h_hist_vec[3]->Fill(DeltaPhi(tempGenJet1.Phi(),tempGenJet2.Phi()));
      if(DeltaPhi(tempGenJet1.Phi(),tempGenJet2.Phi())> delta_phi_min){
	//back to back jets to increase dijet content in sample
	h_hist_vec[4]->Fill((tempGenJet1.E()+tempGenJet2.E())/E_trueAll);
	if(i_entry%2 ==0 ){
	  h_hist_vec[5]->Fill((tempGenJet1.E()-tempGenJet2.E())/(tempGenJet1.E()+tempGenJet2.E()));
	}else{
	  h_hist_vec[5]->Fill((tempGenJet2.E()-tempGenJet1.E())/(tempGenJet1.E()+tempGenJet2.E()));
	}
      }
      if(recoJetR04E->size()==2){
	tempRecoJet1.SetPxPyPzE((*recoJetR04Px)[0],(*recoJetR04Py)[0],(*recoJetR04Pz)[0],(*recoJetR04E)[0]);
	deltaPhig1r=tempGenJet1.Angle(tempRecoJet1.Vect());
	deltaPhig2r=tempGenJet2.Angle(tempRecoJet1.Vect());
	if(deltaPhig1r<deltaPhig2r){
	  h_hist_vec[49]->Fill(tempRecoJet1.E()/tempGenJet1.E());
	}else{
	  h_hist_vec[49]->Fill(tempRecoJet1.E()/tempGenJet2.E());
	}
	tempRecoJet2.SetPxPyPzE((*recoJetR04Px)[1],(*recoJetR04Py)[1],(*recoJetR04Pz)[1],(*recoJetR04E)[1]);
	deltaPhig1r=tempGenJet1.Angle(tempRecoJet2.Vect());
	deltaPhig2r=tempGenJet2.Angle(tempRecoJet2.Vect());
	if(deltaPhig1r<deltaPhig2r){
	  h_hist_vec[49]->Fill(tempRecoJet2.E()/tempGenJet1.E());
	}else{
	  h_hist_vec[49]->Fill(tempRecoJet2.E()/tempGenJet2.E());
	}
      }
    }
    if(genJetR05E->size()==2){
      tempGenJet1.SetPxPyPzE((*genJetR05Px)[0],(*genJetR05Py)[0],(*genJetR05Pz)[0],(*genJetR05E)[0]);
      tempGenJet2.SetPxPyPzE((*genJetR05Px)[1],(*genJetR05Py)[1],(*genJetR05Pz)[1],(*genJetR05E)[1]);
      h_hist_vec[6]->Fill(DeltaPhi(tempGenJet1.Phi(),tempGenJet2.Phi()));
      if(DeltaPhi(tempGenJet1.Phi(),tempGenJet2.Phi())> delta_phi_min){
	//back to back jets to increase dijet content in sample
	h_hist_vec[7]->Fill((tempGenJet1.E()+tempGenJet2.E())/E_trueAll);
	if(i_entry%2 ==0 ){
	  h_hist_vec[8]->Fill((tempGenJet1.E()-tempGenJet2.E())/(tempGenJet1.E()+tempGenJet2.E()));
	}else{
	  h_hist_vec[8]->Fill((tempGenJet2.E()-tempGenJet1.E())/(tempGenJet1.E()+tempGenJet2.E()));
	}
      }
      if(recoJetR05E->size()==2){
	tempRecoJet1.SetPxPyPzE((*recoJetR05Px)[0],(*recoJetR05Py)[0],(*recoJetR05Pz)[0],(*recoJetR05E)[0]);
	deltaPhig1r=tempGenJet1.Angle(tempRecoJet1.Vect());
	deltaPhig2r=tempGenJet2.Angle(tempRecoJet1.Vect());
	int indrj1_m=0;
	float ang_rj1_g=deltaPhig1r;
	if(deltaPhig1r<deltaPhig2r){
	  reco1_over_gen=tempRecoJet1.E()/tempGenJet1.E();
	  h_hist_vec[50]->Fill(tempRecoJet1.E()/tempGenJet1.E());
	  h_hist_vec[56]->Fill(deltaPhig1r*TMath::RadToDeg());
	}else{
	  indrj1_m=1;
	  reco1_over_gen=tempRecoJet1.E()/tempGenJet2.E();
	  h_hist_vec[50]->Fill(tempRecoJet1.E()/tempGenJet2.E());
	  h_hist_vec[56]->Fill(deltaPhig1r*TMath::RadToDeg());
	  ang_rj1_g=deltaPhig2r;
	}
	tempRecoJet2.SetPxPyPzE((*recoJetR05Px)[1],(*recoJetR05Py)[1],(*recoJetR05Pz)[1],(*recoJetR05E)[1]);
	deltaPhig1r=tempGenJet1.Angle(tempRecoJet2.Vect());
	deltaPhig2r=tempGenJet2.Angle(tempRecoJet2.Vect());
	int indrj2_m=0;
	float ang_rj2_g=deltaPhig2r;
	if(deltaPhig1r<deltaPhig2r){
	  ang_rj2_g=deltaPhig1r;
	  reco2_over_gen=tempRecoJet2.E()/tempGenJet1.E();
	  h_hist_vec[50]->Fill(tempRecoJet2.E()/tempGenJet1.E());
	  h_hist_vec[56]->Fill(deltaPhig1r*TMath::RadToDeg());
	  float ang_rj2_g=deltaPhig1r;
	}else{
	  indrj2_m=1;
	  reco2_over_gen=tempRecoJet2.E()/tempGenJet2.E();
	  h_hist_vec[50]->Fill(tempRecoJet2.E()/tempGenJet2.E());
	  h_hist_vec[56]->Fill(deltaPhig1r*TMath::RadToDeg());
	}
	if(indrj1_m!=indrj2_m   && DeltaPhi(tempGenJet1.Phi(),tempGenJet2.Phi())> delta_phi_min){
	  if(fabs(d1_cosTheta)<0.65){
	    if(indrj1_m==0){
	      h_hist_vec[137]->Fill(TMath::RadToDeg()*DeltaPhiDir(tempRecoJet1.Phi(),tempGenJet1.Phi()));
	      h_hist_vec[137]->Fill(TMath::RadToDeg()*DeltaPhiDir(tempRecoJet2.Phi(),tempGenJet2.Phi()));
	      h_hist_vec[141]->Fill((tempRecoJet1.Theta()-tempGenJet1.Theta())*TMath::RadToDeg());
	      h_hist_vec[141]->Fill((tempRecoJet2.Theta()-tempGenJet2.Theta())*TMath::RadToDeg());
	    }else{
	      h_hist_vec[137]->Fill(TMath::RadToDeg()*DeltaPhiDir(tempRecoJet1.Phi(),tempGenJet2.Phi()));
	      h_hist_vec[137]->Fill(TMath::RadToDeg()*DeltaPhiDir(tempRecoJet2.Phi(),tempGenJet1.Phi()));
	      h_hist_vec[141]->Fill((tempRecoJet1.Theta()-tempGenJet2.Theta())*TMath::RadToDeg());
	      h_hist_vec[141]->Fill((tempRecoJet2.Theta()-tempGenJet1.Theta())*TMath::RadToDeg());
	    }
	  }else if(fabs(d1_cosTheta)<0.80){
	    if(indrj1_m==0){
	      h_hist_vec[138]->Fill(TMath::RadToDeg()*DeltaPhiDir(tempRecoJet1.Phi(),tempGenJet1.Phi()));
	      h_hist_vec[138]->Fill(TMath::RadToDeg()*DeltaPhiDir(tempRecoJet2.Phi(),tempGenJet2.Phi()));
	      h_hist_vec[142]->Fill((tempRecoJet1.Theta()-tempGenJet1.Theta())*TMath::RadToDeg());
	      h_hist_vec[142]->Fill((tempRecoJet2.Theta()-tempGenJet2.Theta())*TMath::RadToDeg());
	    }else{
	      h_hist_vec[138]->Fill(TMath::RadToDeg()*DeltaPhiDir(tempRecoJet1.Phi(),tempGenJet2.Phi()));
	      h_hist_vec[138]->Fill(TMath::RadToDeg()*DeltaPhiDir(tempRecoJet2.Phi(),tempGenJet1.Phi()));
	      h_hist_vec[142]->Fill((tempRecoJet1.Theta()-tempGenJet2.Theta())*TMath::RadToDeg());
	      h_hist_vec[142]->Fill((tempRecoJet2.Theta()-tempGenJet1.Theta())*TMath::RadToDeg());
	    }
	  }else if(fabs(d1_cosTheta)<0.925){
	    if(indrj1_m==0){
	      h_hist_vec[139]->Fill(TMath::RadToDeg()*DeltaPhiDir(tempRecoJet1.Phi(),tempGenJet1.Phi()));
	      h_hist_vec[139]->Fill(TMath::RadToDeg()*DeltaPhiDir(tempRecoJet2.Phi(),tempGenJet2.Phi()));
	      h_hist_vec[143]->Fill((tempRecoJet1.Theta()-tempGenJet1.Theta())*TMath::RadToDeg());
	      h_hist_vec[143]->Fill((tempRecoJet2.Theta()-tempGenJet2.Theta())*TMath::RadToDeg());
	    }else{
	      h_hist_vec[139]->Fill(TMath::RadToDeg()*DeltaPhiDir(tempRecoJet1.Phi(),tempGenJet2.Phi()));
	      h_hist_vec[139]->Fill(TMath::RadToDeg()*DeltaPhiDir(tempRecoJet2.Phi(),tempGenJet1.Phi()));
	      h_hist_vec[143]->Fill((tempRecoJet1.Theta()-tempGenJet2.Theta())*TMath::RadToDeg());
	      h_hist_vec[143]->Fill((tempRecoJet2.Theta()-tempGenJet1.Theta())*TMath::RadToDeg());
	    }
	  }else if(fabs(d1_cosTheta)<0.975){
	    if(indrj1_m==0){
	      h_hist_vec[140]->Fill(TMath::RadToDeg()*DeltaPhiDir(tempRecoJet1.Phi(),tempGenJet1.Phi()));
	      h_hist_vec[140]->Fill(TMath::RadToDeg()*DeltaPhiDir(tempRecoJet2.Phi(),tempGenJet2.Phi()));
	      h_hist_vec[144]->Fill((tempRecoJet1.Theta()-tempGenJet1.Theta())*TMath::RadToDeg());
	      h_hist_vec[144]->Fill((tempRecoJet2.Theta()-tempGenJet2.Theta())*TMath::RadToDeg());
	    }else{
	      h_hist_vec[140]->Fill(TMath::RadToDeg()*DeltaPhiDir(tempRecoJet1.Phi(),tempGenJet2.Phi()));
	      h_hist_vec[140]->Fill(TMath::RadToDeg()*DeltaPhiDir(tempRecoJet2.Phi(),tempGenJet1.Phi()));
	      h_hist_vec[144]->Fill((tempRecoJet1.Theta()-tempGenJet2.Theta())*TMath::RadToDeg());
	      h_hist_vec[144]->Fill((tempRecoJet2.Theta()-tempGenJet1.Theta())*TMath::RadToDeg());
	    }
	  }
	}
	if(indrj1_m!=indrj2_m){ 
	  if(fabs(d1_cosTheta)<0.1){
	    if((ang_rj1_g*TMath::RadToDeg())<delta_phi_max_reco_gen){
	      h_hist_vec[59]->Fill(reco1_over_gen);
	    }
	    if((ang_rj2_g*TMath::RadToDeg())<delta_phi_max_reco_gen){
	      h_hist_vec[59]->Fill(reco2_over_gen);
	    }
	  }else if(fabs(d1_cosTheta)<0.2){
	    if((ang_rj1_g*TMath::RadToDeg())<delta_phi_max_reco_gen){
	      h_hist_vec[60]->Fill(reco1_over_gen);
	    }
	    if((ang_rj2_g*TMath::RadToDeg())<delta_phi_max_reco_gen){
	      h_hist_vec[60]->Fill(reco2_over_gen);
	    }
	  }else if(fabs(d1_cosTheta)<0.3){
	    if((ang_rj1_g*TMath::RadToDeg())<delta_phi_max_reco_gen){
	      h_hist_vec[61]->Fill(reco1_over_gen);
	    }
	    if((ang_rj2_g*TMath::RadToDeg())<delta_phi_max_reco_gen){
	      h_hist_vec[61]->Fill(reco2_over_gen);
	    }
	  }else if(fabs(d1_cosTheta)<0.4){
	    if((ang_rj1_g*TMath::RadToDeg())<delta_phi_max_reco_gen){
	      h_hist_vec[62]->Fill(reco1_over_gen);
	    }
	    if((ang_rj2_g*TMath::RadToDeg())<delta_phi_max_reco_gen){
	      h_hist_vec[62]->Fill(reco2_over_gen);
	    }
	  }else if(fabs(d1_cosTheta)<0.5){
	    if((ang_rj1_g*TMath::RadToDeg())<delta_phi_max_reco_gen){
	      h_hist_vec[63]->Fill(reco1_over_gen);
	    }
	    if((ang_rj2_g*TMath::RadToDeg())<delta_phi_max_reco_gen){
	      h_hist_vec[63]->Fill(reco2_over_gen);
	    }
	  }else if(fabs(d1_cosTheta)<0.6){
	    if((ang_rj1_g*TMath::RadToDeg())<delta_phi_max_reco_gen){
	      h_hist_vec[64]->Fill(reco1_over_gen);
	    }
	    if((ang_rj2_g*TMath::RadToDeg())<delta_phi_max_reco_gen){
	      h_hist_vec[64]->Fill(reco2_over_gen);
	    }
	  }else if(fabs(d1_cosTheta)<0.7){
	    if((ang_rj1_g*TMath::RadToDeg())<delta_phi_max_reco_gen){
	      h_hist_vec[65]->Fill(reco1_over_gen);
	    }
	    if((ang_rj2_g*TMath::RadToDeg())<delta_phi_max_reco_gen){
	      h_hist_vec[65]->Fill(reco2_over_gen);
	    }
	  }else if(fabs(d1_cosTheta)<0.8){
	    if((ang_rj1_g*TMath::RadToDeg())<delta_phi_max_reco_gen){
	      h_hist_vec[66]->Fill(reco1_over_gen);
	    }
	    if((ang_rj2_g*TMath::RadToDeg())<delta_phi_max_reco_gen){
	      h_hist_vec[66]->Fill(reco2_over_gen);
	    }
	  }else if(fabs(d1_cosTheta)<0.9){
	    if((ang_rj1_g*TMath::RadToDeg())<delta_phi_max_reco_gen){
	      h_hist_vec[67]->Fill(reco1_over_gen);
	    }
	    if((ang_rj2_g*TMath::RadToDeg())<delta_phi_max_reco_gen){
	      h_hist_vec[67]->Fill(reco2_over_gen);
	    }
	  }else if(fabs(d1_cosTheta)<0.925){
	    if((ang_rj1_g*TMath::RadToDeg())<delta_phi_max_reco_gen){
	      h_hist_vec[68]->Fill(reco1_over_gen);
	    }
	    if((ang_rj2_g*TMath::RadToDeg())<delta_phi_max_reco_gen){
	      h_hist_vec[68]->Fill(reco2_over_gen);
	    }
	  }else if(fabs(d1_cosTheta)<0.950){
	    if((ang_rj1_g*TMath::RadToDeg())<delta_phi_max_reco_gen){
	      h_hist_vec[69]->Fill(reco1_over_gen);
	    }
	    if((ang_rj2_g*TMath::RadToDeg())<delta_phi_max_reco_gen){
	      h_hist_vec[69]->Fill(reco2_over_gen);
	    }
	  }else if(fabs(d1_cosTheta)<0.975){
	    if((ang_rj1_g*TMath::RadToDeg())<delta_phi_max_reco_gen){
	      h_hist_vec[70]->Fill(reco1_over_gen);
	    }
	    if((ang_rj2_g*TMath::RadToDeg())<delta_phi_max_reco_gen){
	      h_hist_vec[70]->Fill(reco2_over_gen);
	    }
	  }else{
	    if((ang_rj1_g*TMath::RadToDeg())<delta_phi_max_reco_gen){
	      h_hist_vec[71]->Fill(reco1_over_gen);
	    }
	    if((ang_rj2_g*TMath::RadToDeg())<delta_phi_max_reco_gen){
	      h_hist_vec[71]->Fill(reco2_over_gen);
	    }
	  }
	}
      }
    }
    if(genJetR06E->size()==2){
      tempGenJet1.SetPxPyPzE((*genJetR06Px)[0],(*genJetR06Py)[0],(*genJetR06Pz)[0],(*genJetR06E)[0]);
      tempGenJet2.SetPxPyPzE((*genJetR06Px)[1],(*genJetR06Py)[1],(*genJetR06Pz)[1],(*genJetR06E)[1]);
      h_hist_vec[9]->Fill(DeltaPhi(tempGenJet1.Phi(),tempGenJet2.Phi()));
      if(DeltaPhi(tempGenJet1.Phi(),tempGenJet2.Phi())> delta_phi_min){
	//back to back jets to increase dijet content in sample
	h_hist_vec[10]->Fill((tempGenJet1.E()+tempGenJet2.E())/E_trueAll);
	if(i_entry%2 ==0 ){
	  h_hist_vec[11]->Fill((tempGenJet1.E()-tempGenJet2.E())/(tempGenJet1.E()+tempGenJet2.E()));
	}else{
	  h_hist_vec[11]->Fill((tempGenJet2.E()-tempGenJet1.E())/(tempGenJet1.E()+tempGenJet2.E()));
	}
      }
      if(recoJetR06E->size()==2){
	tempRecoJet1.SetPxPyPzE((*recoJetR06Px)[0],(*recoJetR06Py)[0],(*recoJetR06Pz)[0],(*recoJetR06E)[0]);
	deltaPhig1r=tempGenJet1.Angle(tempRecoJet1.Vect());
	deltaPhig2r=tempGenJet2.Angle(tempRecoJet1.Vect());
	int indrj1_m=0;
	float ang_rj1_g=deltaPhig1r;
	if(deltaPhig1r<deltaPhig2r){
	  h_hist_vec[51]->Fill(tempRecoJet1.E()/tempGenJet1.E());
	  h_hist_vec[57]->Fill(deltaPhig1r*TMath::RadToDeg());
	  reco1_over_gen=tempRecoJet1.E()/tempGenJet1.E();
	}else{
	  indrj1_m=1;
	  h_hist_vec[51]->Fill(tempRecoJet1.E()/tempGenJet2.E());
	  h_hist_vec[57]->Fill(deltaPhig2r*TMath::RadToDeg());
	  reco1_over_gen=tempRecoJet1.E()/tempGenJet2.E();
	  ang_rj1_g=deltaPhig2r;
	}
	tempRecoJet2.SetPxPyPzE((*recoJetR06Px)[1],(*recoJetR06Py)[1],(*recoJetR06Pz)[1],(*recoJetR06E)[1]);
	deltaPhig1r=tempGenJet1.Angle(tempRecoJet2.Vect());
	deltaPhig2r=tempGenJet2.Angle(tempRecoJet2.Vect());
	int indrj2_m=0;
	float ang_rj2_g=deltaPhig2r;
	if(deltaPhig1r<deltaPhig2r){
	  h_hist_vec[51]->Fill(tempRecoJet2.E()/tempGenJet1.E());
	  h_hist_vec[57]->Fill(deltaPhig1r*TMath::RadToDeg());
	  reco2_over_gen=tempRecoJet2.E()/tempGenJet1.E();
	  ang_rj2_g=deltaPhig1r;
	}else{
	  indrj2_m=1;
	  h_hist_vec[51]->Fill(tempRecoJet2.E()/tempGenJet2.E());
	  h_hist_vec[57]->Fill(deltaPhig2r*TMath::RadToDeg());
	  reco2_over_gen=tempRecoJet2.E()/tempGenJet2.E();
	}
	if(indrj1_m!=indrj2_m){//  && DeltaPhi(tempGenJet1.Phi(),tempGenJet2.Phi())> delta_phi_min){
	  if(fabs(d1_cosTheta)<0.1){
	    if((ang_rj1_g*TMath::RadToDeg())<delta_phi_max_reco_gen){
	      h_hist_vec[72]->Fill(reco1_over_gen);
	    }
	    if((ang_rj2_g*TMath::RadToDeg())<delta_phi_max_reco_gen){
	      h_hist_vec[72]->Fill(reco2_over_gen);
	    }
	  }else if(fabs(d1_cosTheta)<0.2){
	    if((ang_rj1_g*TMath::RadToDeg())<delta_phi_max_reco_gen){
	      h_hist_vec[73]->Fill(reco1_over_gen);
	    }
	    if((ang_rj2_g*TMath::RadToDeg())<delta_phi_max_reco_gen){
	      h_hist_vec[73]->Fill(reco2_over_gen);
	    }
	  }else if(fabs(d1_cosTheta)<0.3){
	    if((ang_rj1_g*TMath::RadToDeg())<delta_phi_max_reco_gen){
	      h_hist_vec[74]->Fill(reco1_over_gen);
	    }
	    if((ang_rj2_g*TMath::RadToDeg())<delta_phi_max_reco_gen){
	      h_hist_vec[74]->Fill(reco2_over_gen);
	    }
	  }else if(fabs(d1_cosTheta)<0.4){
	    if((ang_rj1_g*TMath::RadToDeg())<delta_phi_max_reco_gen){
	      h_hist_vec[75]->Fill(reco1_over_gen);
	    }
	    if((ang_rj2_g*TMath::RadToDeg())<delta_phi_max_reco_gen){
	      h_hist_vec[75]->Fill(reco2_over_gen);
	    }
	  }else if(fabs(d1_cosTheta)<0.5){
	    if((ang_rj1_g*TMath::RadToDeg())<delta_phi_max_reco_gen){
	      h_hist_vec[76]->Fill(reco1_over_gen);
	    }
	    if((ang_rj2_g*TMath::RadToDeg())<delta_phi_max_reco_gen){
	      h_hist_vec[76]->Fill(reco2_over_gen);
	    }
	  }else if(fabs(d1_cosTheta)<0.6){
	    if((ang_rj1_g*TMath::RadToDeg())<delta_phi_max_reco_gen){
	      h_hist_vec[77]->Fill(reco1_over_gen);
	    }
	    if((ang_rj2_g*TMath::RadToDeg())<delta_phi_max_reco_gen){
	      h_hist_vec[77]->Fill(reco2_over_gen);
	    }
	  }else if(fabs(d1_cosTheta)<0.7){
	    if((ang_rj1_g*TMath::RadToDeg())<delta_phi_max_reco_gen){
	      h_hist_vec[78]->Fill(reco1_over_gen);
	    }
	    if((ang_rj2_g*TMath::RadToDeg())<delta_phi_max_reco_gen){
	      h_hist_vec[78]->Fill(reco2_over_gen);
	    }
	  }else if(fabs(d1_cosTheta)<0.8){
	    if((ang_rj1_g*TMath::RadToDeg())<delta_phi_max_reco_gen){
	      h_hist_vec[79]->Fill(reco1_over_gen);
	    }
	    if((ang_rj2_g*TMath::RadToDeg())<delta_phi_max_reco_gen){
	      h_hist_vec[79]->Fill(reco2_over_gen);
	    }
	  }else if(fabs(d1_cosTheta)<0.9){
	    if((ang_rj1_g*TMath::RadToDeg())<delta_phi_max_reco_gen){
	      h_hist_vec[80]->Fill(reco1_over_gen);
	    }
	    if((ang_rj2_g*TMath::RadToDeg())<delta_phi_max_reco_gen){
	      h_hist_vec[80]->Fill(reco2_over_gen);
	    }
	  }else if(fabs(d1_cosTheta)<0.925){
	    if((ang_rj1_g*TMath::RadToDeg())<delta_phi_max_reco_gen){
	      h_hist_vec[81]->Fill(reco1_over_gen);
	    }
	    if((ang_rj2_g*TMath::RadToDeg())<delta_phi_max_reco_gen){
	      h_hist_vec[81]->Fill(reco2_over_gen);
	    }
	  }else if(fabs(d1_cosTheta)<0.950){
	    if((ang_rj1_g*TMath::RadToDeg())<delta_phi_max_reco_gen){
	      h_hist_vec[82]->Fill(reco1_over_gen);
	    }
	    if((ang_rj2_g*TMath::RadToDeg())<delta_phi_max_reco_gen){
	      h_hist_vec[82]->Fill(reco2_over_gen);
	    }
	  }else if(fabs(d1_cosTheta)<0.975){
	    if((ang_rj1_g*TMath::RadToDeg())<delta_phi_max_reco_gen){
	      h_hist_vec[83]->Fill(reco1_over_gen);
	    }
	    if((ang_rj2_g*TMath::RadToDeg())<delta_phi_max_reco_gen){
	      h_hist_vec[83]->Fill(reco2_over_gen);
	    }
	  }else{
	    if((ang_rj1_g*TMath::RadToDeg())<delta_phi_max_reco_gen){
	      h_hist_vec[84]->Fill(reco1_over_gen);
	    }
	    if((ang_rj2_g*TMath::RadToDeg())<delta_phi_max_reco_gen){
	      h_hist_vec[84]->Fill(reco2_over_gen);
	    }
	  }
	}
      }
    }
    if(genJetR07E->size()==2){
      tempGenJet1.SetPxPyPzE((*genJetR07Px)[0],(*genJetR07Py)[0],(*genJetR07Pz)[0],(*genJetR07E)[0]);
      tempGenJet2.SetPxPyPzE((*genJetR07Px)[1],(*genJetR07Py)[1],(*genJetR07Pz)[1],(*genJetR07E)[1]);
      h_hist_vec[12]->Fill(DeltaPhi(tempGenJet1.Phi(),tempGenJet2.Phi()));
      if(DeltaPhi(tempGenJet1.Phi(),tempGenJet2.Phi())> delta_phi_min){
	//back to back jets to increase dijet content in sample
	h_hist_vec[13]->Fill((tempGenJet1.E()+tempGenJet2.E())/E_trueAll);
	if(i_entry%2 ==0 ){
	  h_hist_vec[14]->Fill((tempGenJet1.E()-tempGenJet2.E())/(tempGenJet1.E()+tempGenJet2.E()));
	}else{
	  h_hist_vec[14]->Fill((tempGenJet2.E()-tempGenJet1.E())/(tempGenJet1.E()+tempGenJet2.E()));
	}
      }
      if(recoJetR07E->size()==2){
	tempRecoJet1.SetPxPyPzE((*recoJetR07Px)[0],(*recoJetR07Py)[0],(*recoJetR07Pz)[0],(*recoJetR07E)[0]);
	deltaPhig1r=tempGenJet1.Angle(tempRecoJet1.Vect());
	deltaPhig2r=tempGenJet2.Angle(tempRecoJet1.Vect());
	int indrj1_m=0;
	float ang_rj1_g=deltaPhig1r;
	if(deltaPhig1r<deltaPhig2r){
	  h_hist_vec[52]->Fill(tempRecoJet1.E()/tempGenJet1.E());
	  h_hist_vec[58]->Fill(deltaPhig1r*TMath::RadToDeg());
	  reco1_over_gen=tempRecoJet1.E()/tempGenJet1.E();
	}else{	 
	  indrj1_m=1;
	  h_hist_vec[52]->Fill(tempRecoJet1.E()/tempGenJet2.E());
	  h_hist_vec[58]->Fill(deltaPhig2r*TMath::RadToDeg());
	  reco1_over_gen=tempRecoJet1.E()/tempGenJet2.E();
	  ang_rj1_g=deltaPhig2r;
	}
	tempRecoJet2.SetPxPyPzE((*recoJetR07Px)[1],(*recoJetR07Py)[1],(*recoJetR07Pz)[1],(*recoJetR07E)[1]);
	deltaPhig1r=tempGenJet1.Angle(tempRecoJet2.Vect());
	deltaPhig2r=tempGenJet2.Angle(tempRecoJet2.Vect());
	int indrj2_m=0;
	float ang_rj2_g=deltaPhig2r;
	if(deltaPhig1r<deltaPhig2r){
	  h_hist_vec[52]->Fill(tempRecoJet2.E()/tempGenJet1.E());
	  h_hist_vec[58]->Fill(deltaPhig1r*TMath::RadToDeg());
	  reco2_over_gen=tempRecoJet2.E()/tempGenJet1.E();
	  ang_rj2_g=deltaPhig1r;
	}else{
	  indrj2_m=1;
	  h_hist_vec[52]->Fill(tempRecoJet2.E()/tempGenJet2.E());
	  h_hist_vec[58]->Fill(deltaPhig2r*TMath::RadToDeg());
	  reco2_over_gen=tempRecoJet2.E()/tempGenJet2.E();
	}
	if(indrj1_m!=indrj2_m  && DeltaPhi(tempGenJet1.Phi(),tempGenJet2.Phi())> delta_phi_min){
	  if(fabs(d1_cosTheta)<0.65){
	    if(indrj1_m==0){
	      h_hist_vec[145]->Fill(TMath::RadToDeg()*DeltaPhiDir(tempRecoJet1.Phi(),tempGenJet1.Phi()));
	      h_hist_vec[145]->Fill(TMath::RadToDeg()*DeltaPhiDir(tempRecoJet2.Phi(),tempGenJet2.Phi()));
	      h_hist_vec[149]->Fill((tempRecoJet1.Theta()-tempGenJet1.Theta())*TMath::RadToDeg());
	      h_hist_vec[149]->Fill((tempRecoJet2.Theta()-tempGenJet2.Theta())*TMath::RadToDeg());
	    }else{
	      h_hist_vec[145]->Fill(TMath::RadToDeg()*DeltaPhiDir(tempRecoJet1.Phi(),tempGenJet2.Phi()));
	      h_hist_vec[145]->Fill(TMath::RadToDeg()*DeltaPhiDir(tempRecoJet2.Phi(),tempGenJet1.Phi()));
	      h_hist_vec[149]->Fill((tempRecoJet1.Theta()-tempGenJet2.Theta())*TMath::RadToDeg());
	      h_hist_vec[149]->Fill((tempRecoJet2.Theta()-tempGenJet1.Theta())*TMath::RadToDeg());
	    }
	  }else if(fabs(d1_cosTheta)<0.80){
	    if(indrj1_m==0){
	      h_hist_vec[146]->Fill(TMath::RadToDeg()*DeltaPhiDir(tempRecoJet1.Phi(),tempGenJet1.Phi()));
	      h_hist_vec[146]->Fill(TMath::RadToDeg()*DeltaPhiDir(tempRecoJet2.Phi(),tempGenJet2.Phi()));
	      h_hist_vec[150]->Fill((tempRecoJet1.Theta()-tempGenJet1.Theta())*TMath::RadToDeg());
	      h_hist_vec[150]->Fill((tempRecoJet2.Theta()-tempGenJet2.Theta())*TMath::RadToDeg());
	    }else{
	      h_hist_vec[146]->Fill(TMath::RadToDeg()*DeltaPhiDir(tempRecoJet1.Phi(),tempGenJet2.Phi()));
	      h_hist_vec[146]->Fill(TMath::RadToDeg()*DeltaPhiDir(tempRecoJet2.Phi(),tempGenJet1.Phi()));
	      h_hist_vec[150]->Fill((tempRecoJet1.Theta()-tempGenJet2.Theta())*TMath::RadToDeg());
	      h_hist_vec[150]->Fill((tempRecoJet2.Theta()-tempGenJet1.Theta())*TMath::RadToDeg());
	    }
	  }else if(fabs(d1_cosTheta)<0.925){
	    if(indrj1_m==0){
	      h_hist_vec[147]->Fill(TMath::RadToDeg()*DeltaPhiDir(tempRecoJet1.Phi(),tempGenJet1.Phi()));
	      h_hist_vec[147]->Fill(TMath::RadToDeg()*DeltaPhiDir(tempRecoJet2.Phi(),tempGenJet2.Phi()));
	      h_hist_vec[151]->Fill((tempRecoJet1.Theta()-tempGenJet1.Theta())*TMath::RadToDeg());
	      h_hist_vec[151]->Fill((tempRecoJet2.Theta()-tempGenJet2.Theta())*TMath::RadToDeg());
	    }else{
	      h_hist_vec[147]->Fill(TMath::RadToDeg()*DeltaPhiDir(tempRecoJet1.Phi(),tempGenJet2.Phi()));
	      h_hist_vec[147]->Fill(TMath::RadToDeg()*DeltaPhiDir(tempRecoJet2.Phi(),tempGenJet1.Phi()));
	      h_hist_vec[151]->Fill((tempRecoJet1.Theta()-tempGenJet2.Theta())*TMath::RadToDeg());
	      h_hist_vec[151]->Fill((tempRecoJet2.Theta()-tempGenJet1.Theta())*TMath::RadToDeg());
	    }
	  }else if(fabs(d1_cosTheta)<0.975){
	    if(indrj1_m==0){
	      h_hist_vec[148]->Fill(TMath::RadToDeg()*DeltaPhiDir(tempRecoJet1.Phi(),tempGenJet1.Phi()));
	      h_hist_vec[148]->Fill(TMath::RadToDeg()*DeltaPhiDir(tempRecoJet2.Phi(),tempGenJet2.Phi()));
	      h_hist_vec[152]->Fill((tempRecoJet1.Theta()-tempGenJet1.Theta())*TMath::RadToDeg());
	      h_hist_vec[152]->Fill((tempRecoJet2.Theta()-tempGenJet2.Theta())*TMath::RadToDeg());
	    }else{
	      h_hist_vec[151]->Fill(TMath::RadToDeg()*DeltaPhiDir(tempRecoJet1.Phi(),tempGenJet2.Phi()));
	      h_hist_vec[151]->Fill(TMath::RadToDeg()*DeltaPhiDir(tempRecoJet2.Phi(),tempGenJet1.Phi()));
	      h_hist_vec[152]->Fill((tempRecoJet1.Theta()-tempGenJet2.Theta())*TMath::RadToDeg());
	      h_hist_vec[152]->Fill((tempRecoJet2.Theta()-tempGenJet1.Theta())*TMath::RadToDeg());
	    }
	  }
	}
	if(indrj1_m!=indrj2_m){
	  if(fabs(d1_cosTheta)<0.1){
	    if((ang_rj1_g*TMath::RadToDeg())<delta_phi_max_reco_gen){
	      h_hist_vec[85]->Fill(reco1_over_gen);
	    }
	    if((ang_rj2_g*TMath::RadToDeg())<delta_phi_max_reco_gen){
	      h_hist_vec[85]->Fill(reco2_over_gen);
	    }
	  }else if(fabs(d1_cosTheta)<0.2){
	    if((ang_rj1_g*TMath::RadToDeg())<delta_phi_max_reco_gen){
	      h_hist_vec[86]->Fill(reco1_over_gen);
	    }
	    if((ang_rj2_g*TMath::RadToDeg())<delta_phi_max_reco_gen){
	      h_hist_vec[86]->Fill(reco2_over_gen);
	    }
	  }else if(fabs(d1_cosTheta)<0.3){
	    if((ang_rj1_g*TMath::RadToDeg())<delta_phi_max_reco_gen){
	      h_hist_vec[87]->Fill(reco1_over_gen);
	    }
	    if((ang_rj2_g*TMath::RadToDeg())<delta_phi_max_reco_gen){
	      h_hist_vec[87]->Fill(reco2_over_gen);
	    }
	  }else if(fabs(d1_cosTheta)<0.4){
	    if((ang_rj1_g*TMath::RadToDeg())<delta_phi_max_reco_gen){
	      h_hist_vec[88]->Fill(reco1_over_gen);
	    }
	    if((ang_rj2_g*TMath::RadToDeg())<delta_phi_max_reco_gen){
	      h_hist_vec[88]->Fill(reco2_over_gen);
	    }
	  }else if(fabs(d1_cosTheta)<0.5){
	    if((ang_rj1_g*TMath::RadToDeg())<delta_phi_max_reco_gen){
	      h_hist_vec[89]->Fill(reco1_over_gen);
	    }
	    if((ang_rj2_g*TMath::RadToDeg())<delta_phi_max_reco_gen){
	      h_hist_vec[89]->Fill(reco2_over_gen);
	    }
	  }else if(fabs(d1_cosTheta)<0.6){
	    if((ang_rj1_g*TMath::RadToDeg())<delta_phi_max_reco_gen){
	      h_hist_vec[90]->Fill(reco1_over_gen);
	    }
	    if((ang_rj2_g*TMath::RadToDeg())<delta_phi_max_reco_gen){
	      h_hist_vec[90]->Fill(reco2_over_gen);
	    }
	  }else if(fabs(d1_cosTheta)<0.7){
	    if((ang_rj1_g*TMath::RadToDeg())<delta_phi_max_reco_gen){
	      h_hist_vec[91]->Fill(reco1_over_gen);
	    }
	    if((ang_rj2_g*TMath::RadToDeg())<delta_phi_max_reco_gen){
	      h_hist_vec[91]->Fill(reco2_over_gen);
	    }
	  }else if(fabs(d1_cosTheta)<0.8){
	    if((ang_rj1_g*TMath::RadToDeg())<delta_phi_max_reco_gen){
	      h_hist_vec[92]->Fill(reco1_over_gen);
	    }
	    if((ang_rj2_g*TMath::RadToDeg())<delta_phi_max_reco_gen){
	      h_hist_vec[92]->Fill(reco2_over_gen);
	    }
	  }else if(fabs(d1_cosTheta)<0.9){
	    if((ang_rj1_g*TMath::RadToDeg())<delta_phi_max_reco_gen){
	      h_hist_vec[93]->Fill(reco1_over_gen);
	    }
	    if((ang_rj2_g*TMath::RadToDeg())<delta_phi_max_reco_gen){
	      h_hist_vec[93]->Fill(reco2_over_gen);
	    }
	  }else if(fabs(d1_cosTheta)<0.925){
	    if((ang_rj1_g*TMath::RadToDeg())<delta_phi_max_reco_gen){
	      h_hist_vec[94]->Fill(reco1_over_gen);
	    }
	    if((ang_rj2_g*TMath::RadToDeg())<delta_phi_max_reco_gen){
	      h_hist_vec[94]->Fill(reco2_over_gen);
	    }
	  }else if(fabs(d1_cosTheta)<0.950){
	    if((ang_rj1_g*TMath::RadToDeg())<delta_phi_max_reco_gen){
	      h_hist_vec[95]->Fill(reco1_over_gen);
	    }
	    if((ang_rj2_g*TMath::RadToDeg())<delta_phi_max_reco_gen){
	      h_hist_vec[95]->Fill(reco2_over_gen);
	    }
	  }else if(fabs(d1_cosTheta)<0.975){
	    if((ang_rj1_g*TMath::RadToDeg())<delta_phi_max_reco_gen){
	      h_hist_vec[96]->Fill(reco1_over_gen);
	    }
	    if((ang_rj2_g*TMath::RadToDeg())<delta_phi_max_reco_gen){
	      h_hist_vec[96]->Fill(reco2_over_gen);
	    }	    
	  }else{
	    if((ang_rj1_g*TMath::RadToDeg())<delta_phi_max_reco_gen){
	      h_hist_vec[97]->Fill(reco1_over_gen);
	    }
	    if((ang_rj2_g*TMath::RadToDeg())<delta_phi_max_reco_gen){
	      h_hist_vec[97]->Fill(reco2_over_gen);
	    }	  
	  }
	}
      }
    }
    if(genJetR08E->size()==2){
      tempGenJet1.SetPxPyPzE((*genJetR08Px)[0],(*genJetR08Py)[0],(*genJetR08Pz)[0],(*genJetR08E)[0]);
      tempGenJet2.SetPxPyPzE((*genJetR08Px)[1],(*genJetR08Py)[1],(*genJetR08Pz)[1],(*genJetR08E)[1]);
      h_hist_vec[15]->Fill(DeltaPhi(tempGenJet1.Phi(),tempGenJet2.Phi()));
      if(DeltaPhi(tempGenJet1.Phi(),tempGenJet2.Phi())> delta_phi_min){
	//back to back jets to increase dijet content in sample
	h_hist_vec[16]->Fill((tempGenJet1.E()+tempGenJet2.E())/E_trueAll);
	if(i_entry%2 ==0 ){
	  h_hist_vec[17]->Fill((tempGenJet1.E()-tempGenJet2.E())/(tempGenJet1.E()+tempGenJet2.E()));
	}else{
	  h_hist_vec[17]->Fill((tempGenJet2.E()-tempGenJet1.E())/(tempGenJet1.E()+tempGenJet2.E()));
	}
      }
      if(recoJetR08E->size()==2){
	tempRecoJet1.SetPxPyPzE((*recoJetR08Px)[0],(*recoJetR08Py)[0],(*recoJetR08Pz)[0],(*recoJetR08E)[0]);
	deltaPhig1r=tempGenJet1.Angle(tempRecoJet1.Vect());
	deltaPhig2r=tempGenJet2.Angle(tempRecoJet1.Vect());
	int indrj1_m=0;
	float ang_rj1_g=deltaPhig1r;
	if(deltaPhig1r<deltaPhig2r){
	  reco1_over_gen=tempRecoJet1.E()/tempGenJet1.E();
	  h_hist_vec[53]->Fill(tempRecoJet1.E()/tempGenJet1.E());
	}else{
	  indrj1_m=1;
	  reco1_over_gen=tempRecoJet1.E()/tempGenJet2.E();
	  h_hist_vec[53]->Fill(tempRecoJet1.E()/tempGenJet2.E());
	  ang_rj1_g=deltaPhig2r;
	}
	tempRecoJet2.SetPxPyPzE((*recoJetR08Px)[1],(*recoJetR08Py)[1],(*recoJetR08Pz)[1],(*recoJetR08E)[1]);
	deltaPhig1r=tempGenJet1.Angle(tempRecoJet2.Vect());
	deltaPhig2r=tempGenJet2.Angle(tempRecoJet2.Vect());
	int indrj2_m=0;
	float ang_rj2_g=deltaPhig2r;
	if(deltaPhig1r<deltaPhig2r){
	  reco2_over_gen=tempRecoJet2.E()/tempGenJet1.E();
	  h_hist_vec[53]->Fill(tempRecoJet2.E()/tempGenJet1.E());
	  ang_rj2_g=deltaPhig2r;
	}else{
	  indrj2_m=1;
	  reco2_over_gen=tempRecoJet2.E()/tempGenJet2.E();
	  h_hist_vec[53]->Fill(tempRecoJet2.E()/tempGenJet2.E());
	}
	if(indrj1_m!=indrj2_m){// && DeltaPhi(tempGenJet1.Phi(),tempGenJet2.Phi())> delta_phi_min){
	  if(fabs(d1_cosTheta)<0.1){
	    if((ang_rj1_g*TMath::RadToDeg())<delta_phi_max_reco_gen){
	      h_hist_vec[98]->Fill(reco1_over_gen);
	    }
	    if((ang_rj2_g*TMath::RadToDeg())<delta_phi_max_reco_gen){
	      h_hist_vec[98]->Fill(reco2_over_gen);
	    }
	  }else if(fabs(d1_cosTheta)<0.2){
	    if((ang_rj1_g*TMath::RadToDeg())<delta_phi_max_reco_gen){
	      h_hist_vec[99]->Fill(reco1_over_gen);
	    }
	    if((ang_rj2_g*TMath::RadToDeg())<delta_phi_max_reco_gen){
	      h_hist_vec[99]->Fill(reco2_over_gen);
	    }
	  }else if(fabs(d1_cosTheta)<0.3){
	    if((ang_rj1_g*TMath::RadToDeg())<delta_phi_max_reco_gen){
	      h_hist_vec[100]->Fill(reco1_over_gen);
	    }
	    if((ang_rj2_g*TMath::RadToDeg())<delta_phi_max_reco_gen){
	      h_hist_vec[100]->Fill(reco2_over_gen);
	    }
	  }else if(fabs(d1_cosTheta)<0.4){
	    if((ang_rj1_g*TMath::RadToDeg())<delta_phi_max_reco_gen){
	      h_hist_vec[101]->Fill(reco1_over_gen);
	    }
	    if((ang_rj2_g*TMath::RadToDeg())<delta_phi_max_reco_gen){
	      h_hist_vec[101]->Fill(reco2_over_gen);
	    }
	  }else if(fabs(d1_cosTheta)<0.5){
	    if((ang_rj1_g*TMath::RadToDeg())<delta_phi_max_reco_gen){
	      h_hist_vec[102]->Fill(reco1_over_gen);
	    }
	    if((ang_rj2_g*TMath::RadToDeg())<delta_phi_max_reco_gen){
	      h_hist_vec[102]->Fill(reco2_over_gen);
	    }
	  }else if(fabs(d1_cosTheta)<0.6){
	    if((ang_rj1_g*TMath::RadToDeg())<delta_phi_max_reco_gen){
	      h_hist_vec[103]->Fill(reco1_over_gen);
	    }
	    if((ang_rj2_g*TMath::RadToDeg())<delta_phi_max_reco_gen){
	      h_hist_vec[103]->Fill(reco2_over_gen);
	    }
	  }else if(fabs(d1_cosTheta)<0.7){
	    if((ang_rj1_g*TMath::RadToDeg())<delta_phi_max_reco_gen){
	      h_hist_vec[104]->Fill(reco1_over_gen);
	    }
	    if((ang_rj2_g*TMath::RadToDeg())<delta_phi_max_reco_gen){
	      h_hist_vec[104]->Fill(reco2_over_gen);
	    }
	  }else if(fabs(d1_cosTheta)<0.8){
	    if((ang_rj1_g*TMath::RadToDeg())<delta_phi_max_reco_gen){
	      h_hist_vec[105]->Fill(reco1_over_gen);
	    }
	    if((ang_rj2_g*TMath::RadToDeg())<delta_phi_max_reco_gen){
	      h_hist_vec[105]->Fill(reco2_over_gen);
	    }
	  }else if(fabs(d1_cosTheta)<0.9){
	    if((ang_rj1_g*TMath::RadToDeg())<delta_phi_max_reco_gen){
	      h_hist_vec[106]->Fill(reco1_over_gen);
	    }
	    if((ang_rj2_g*TMath::RadToDeg())<delta_phi_max_reco_gen){
	      h_hist_vec[106]->Fill(reco2_over_gen);
	    }
	  }else if(fabs(d1_cosTheta)<0.925){
	    if((ang_rj1_g*TMath::RadToDeg())<delta_phi_max_reco_gen){
	      h_hist_vec[107]->Fill(reco1_over_gen);
	    }
	    if((ang_rj2_g*TMath::RadToDeg())<delta_phi_max_reco_gen){
	      h_hist_vec[107]->Fill(reco2_over_gen);
	    }
	  }else if(fabs(d1_cosTheta)<0.950){
	    if((ang_rj1_g*TMath::RadToDeg())<delta_phi_max_reco_gen){
	      h_hist_vec[108]->Fill(reco1_over_gen);
	    }
	    if((ang_rj2_g*TMath::RadToDeg())<delta_phi_max_reco_gen){
	      h_hist_vec[108]->Fill(reco2_over_gen);
	    }
	  }else if(fabs(d1_cosTheta)<0.975){
	    if((ang_rj1_g*TMath::RadToDeg())<delta_phi_max_reco_gen){
	      h_hist_vec[109]->Fill(reco1_over_gen);
	    }
	    if((ang_rj2_g*TMath::RadToDeg())<delta_phi_max_reco_gen){
	      h_hist_vec[109]->Fill(reco2_over_gen);
	    }
	  }else{
	    if((ang_rj1_g*TMath::RadToDeg())<delta_phi_max_reco_gen){
	      h_hist_vec[110]->Fill(reco1_over_gen);
	    }
	    if((ang_rj2_g*TMath::RadToDeg())<delta_phi_max_reco_gen){
	      h_hist_vec[110]->Fill(reco2_over_gen);
	    }
	  }
	}
      }
    }
    if(genJetR09E->size()==2){
      tempGenJet1.SetPxPyPzE((*genJetR09Px)[0],(*genJetR09Py)[0],(*genJetR09Pz)[0],(*genJetR09E)[0]);
      tempGenJet2.SetPxPyPzE((*genJetR09Px)[1],(*genJetR09Py)[1],(*genJetR09Pz)[1],(*genJetR09E)[1]);
      h_hist_vec[18]->Fill(DeltaPhi(tempGenJet1.Phi(),tempGenJet2.Phi()));
      if(DeltaPhi(tempGenJet1.Phi(),tempGenJet2.Phi())> delta_phi_min){
	//back to back jets to increase dijet content in sample
	h_hist_vec[19]->Fill((tempGenJet1.E()+tempGenJet2.E())/E_trueAll);
	if(i_entry%2 ==0 ){
	  h_hist_vec[20]->Fill((tempGenJet1.E()-tempGenJet2.E())/(tempGenJet1.E()+tempGenJet2.E()));
	}else{
	  h_hist_vec[20]->Fill((tempGenJet2.E()-tempGenJet1.E())/(tempGenJet1.E()+tempGenJet2.E()));
	}
      }
      if(recoJetR09E->size()==2){
	tempRecoJet1.SetPxPyPzE((*recoJetR09Px)[0],(*recoJetR09Py)[0],(*recoJetR09Pz)[0],(*recoJetR09E)[0]);
	deltaPhig1r=tempGenJet1.Angle(tempRecoJet1.Vect());
	deltaPhig2r=tempGenJet2.Angle(tempRecoJet1.Vect());
	int indrj1_m=0;
	float ang_rj1_g=deltaPhig1r;
	if(deltaPhig1r<deltaPhig2r){
	  reco1_over_gen=tempRecoJet1.E()/tempGenJet1.E();
	  h_hist_vec[54]->Fill(tempRecoJet1.E()/tempGenJet1.E());
	}else{
	  indrj1_m=1;
	  reco1_over_gen=tempRecoJet1.E()/tempGenJet2.E();
	  h_hist_vec[54]->Fill(tempRecoJet1.E()/tempGenJet2.E());
	  ang_rj1_g=deltaPhig2r;
	}
	tempRecoJet2.SetPxPyPzE((*recoJetR09Px)[1],(*recoJetR09Py)[1],(*recoJetR09Pz)[1],(*recoJetR09E)[1]);
	deltaPhig1r=tempGenJet1.Angle(tempRecoJet2.Vect());
	deltaPhig2r=tempGenJet2.Angle(tempRecoJet2.Vect());
	int indrj2_m=0;
	float ang_rj2_g=deltaPhig2r;
	if(deltaPhig1r<deltaPhig2r){
	  reco2_over_gen=tempRecoJet2.E()/tempGenJet1.E();
	  h_hist_vec[54]->Fill(tempRecoJet2.E()/tempGenJet1.E());
	  ang_rj2_g=deltaPhig1r;
	}else{
	  indrj2_m=1;
	  reco2_over_gen=tempRecoJet2.E()/tempGenJet2.E();
	  h_hist_vec[54]->Fill(tempRecoJet2.E()/tempGenJet2.E());
	}
	if(indrj1_m!=indrj2_m){
	  if(fabs(d1_cosTheta)<0.1){
	    if((ang_rj1_g*TMath::RadToDeg())<delta_phi_max_reco_gen){
	      h_hist_vec[111]->Fill(reco1_over_gen);
	    }
	    if((ang_rj2_g*TMath::RadToDeg())<delta_phi_max_reco_gen){
	      h_hist_vec[111]->Fill(reco2_over_gen);
	    }
	  }else if(fabs(d1_cosTheta)<0.2){
	    if((ang_rj1_g*TMath::RadToDeg())<delta_phi_max_reco_gen){
	      h_hist_vec[112]->Fill(reco1_over_gen);
	    }
	    if((ang_rj2_g*TMath::RadToDeg())<delta_phi_max_reco_gen){
	      h_hist_vec[112]->Fill(reco2_over_gen);
	    }
	  }else if(fabs(d1_cosTheta)<0.3){
	    if((ang_rj1_g*TMath::RadToDeg())<delta_phi_max_reco_gen){
	      h_hist_vec[113]->Fill(reco1_over_gen);
	    }
	    if((ang_rj2_g*TMath::RadToDeg())<delta_phi_max_reco_gen){
	      h_hist_vec[113]->Fill(reco2_over_gen);
	    }
	  }else if(fabs(d1_cosTheta)<0.4){
	    if((ang_rj1_g*TMath::RadToDeg())<delta_phi_max_reco_gen){
	      h_hist_vec[114]->Fill(reco1_over_gen);
	    }
	    if((ang_rj2_g*TMath::RadToDeg())<delta_phi_max_reco_gen){
	      h_hist_vec[114]->Fill(reco2_over_gen);
	    }
	  }else if(fabs(d1_cosTheta)<0.5){
	    if((ang_rj1_g*TMath::RadToDeg())<delta_phi_max_reco_gen){
	      h_hist_vec[115]->Fill(reco1_over_gen);
	    }
	    if((ang_rj2_g*TMath::RadToDeg())<delta_phi_max_reco_gen){
	      h_hist_vec[115]->Fill(reco2_over_gen);
	    }
	  }else if(fabs(d1_cosTheta)<0.6){
	    if((ang_rj1_g*TMath::RadToDeg())<delta_phi_max_reco_gen){
	      h_hist_vec[116]->Fill(reco1_over_gen);
	    }
	    if((ang_rj2_g*TMath::RadToDeg())<delta_phi_max_reco_gen){
	      h_hist_vec[116]->Fill(reco2_over_gen);
	    }
	  }else if(fabs(d1_cosTheta)<0.7){
	    if((ang_rj1_g*TMath::RadToDeg())<delta_phi_max_reco_gen){
	      h_hist_vec[117]->Fill(reco1_over_gen);
	    }
	    if((ang_rj2_g*TMath::RadToDeg())<delta_phi_max_reco_gen){
	      h_hist_vec[117]->Fill(reco2_over_gen);
	    }
	  }else if(fabs(d1_cosTheta)<0.8){
	    if((ang_rj1_g*TMath::RadToDeg())<delta_phi_max_reco_gen){
	      h_hist_vec[118]->Fill(reco1_over_gen);
	    }
	    if((ang_rj2_g*TMath::RadToDeg())<delta_phi_max_reco_gen){
	      h_hist_vec[118]->Fill(reco2_over_gen);
	    }
	  }else if(fabs(d1_cosTheta)<0.9){
	    if((ang_rj1_g*TMath::RadToDeg())<delta_phi_max_reco_gen){
	      h_hist_vec[119]->Fill(reco1_over_gen);
	    }
	    if((ang_rj2_g*TMath::RadToDeg())<delta_phi_max_reco_gen){
	      h_hist_vec[119]->Fill(reco2_over_gen);
	    }
	  }else if(fabs(d1_cosTheta)<0.925){
	    if((ang_rj1_g*TMath::RadToDeg())<delta_phi_max_reco_gen){
	      h_hist_vec[120]->Fill(reco1_over_gen);
	    }
	    if((ang_rj2_g*TMath::RadToDeg())<delta_phi_max_reco_gen){
	      h_hist_vec[120]->Fill(reco2_over_gen);
	    }
	  }else if(fabs(d1_cosTheta)<0.950){
	    if((ang_rj1_g*TMath::RadToDeg())<delta_phi_max_reco_gen){
	      h_hist_vec[121]->Fill(reco1_over_gen);
	    }
	    if((ang_rj2_g*TMath::RadToDeg())<delta_phi_max_reco_gen){
	      h_hist_vec[121]->Fill(reco2_over_gen);
	    }
	  }else if(fabs(d1_cosTheta)<0.975){
	    if((ang_rj1_g*TMath::RadToDeg())<delta_phi_max_reco_gen){
	      h_hist_vec[122]->Fill(reco1_over_gen);
	    }
	    if((ang_rj2_g*TMath::RadToDeg())<delta_phi_max_reco_gen){
	      h_hist_vec[122]->Fill(reco2_over_gen);
	    }
	  }else{
	    if((ang_rj1_g*TMath::RadToDeg())<delta_phi_max_reco_gen){
	      h_hist_vec[123]->Fill(reco1_over_gen);
	    }
	    if((ang_rj2_g*TMath::RadToDeg())<delta_phi_max_reco_gen){
	      h_hist_vec[123]->Fill(reco2_over_gen);
	    }
	  }
	}
      }
    }
    if(genJetR10E->size()==2){
      tempGenJet1.SetPxPyPzE((*genJetR10Px)[0],(*genJetR10Py)[0],(*genJetR10Pz)[0],(*genJetR10E)[0]);
      tempGenJet2.SetPxPyPzE((*genJetR10Px)[1],(*genJetR10Py)[1],(*genJetR10Pz)[1],(*genJetR10E)[1]);
      h_hist_vec[21]->Fill(DeltaPhi(tempGenJet1.Phi(),tempGenJet2.Phi()));
      if(DeltaPhi(tempGenJet1.Phi(),tempGenJet2.Phi())> delta_phi_min){
	//back to back jets to increase dijet content in sample
	h_hist_vec[22]->Fill((tempGenJet1.E()+tempGenJet2.E())/E_trueAll);
	if(i_entry%2 ==0 ){
	  h_hist_vec[23]->Fill((tempGenJet1.E()-tempGenJet2.E())/(tempGenJet1.E()+tempGenJet2.E()));
	}else{
	  h_hist_vec[23]->Fill((tempGenJet2.E()-tempGenJet1.E())/(tempGenJet1.E()+tempGenJet2.E()));
	}
      }
      if(recoJetR10E->size()==2){
	tempRecoJet1.SetPxPyPzE((*recoJetR10Px)[0],(*recoJetR10Py)[0],(*recoJetR10Pz)[0],(*recoJetR10E)[0]);
	deltaPhig1r=tempGenJet1.Angle(tempRecoJet1.Vect());
	deltaPhig2r=tempGenJet2.Angle(tempRecoJet1.Vect());
	int indrj1_m=0;
	float ang_rj1_g=deltaPhig1r;
	if(deltaPhig1r<deltaPhig2r){
	  reco1_over_gen=tempRecoJet1.E()/tempGenJet1.E();
	  h_hist_vec[55]->Fill(tempRecoJet1.E()/tempGenJet1.E());
	  ang_rj1_g=deltaPhig2r;
	}else{
	  indrj1_m=1;
	  reco1_over_gen=tempRecoJet1.E()/tempGenJet2.E();
	  h_hist_vec[55]->Fill(tempRecoJet1.E()/tempGenJet2.E());
	}
	//std::cout<<"delta angle1/delta angle 2 reco 1: "<<TMath::RadToDeg()*deltaPhig1r<<"/"<<TMath::RadToDeg()*deltaPhig2r<<"/"<<indrj1_m<<std::endl;
	tempRecoJet2.SetPxPyPzE((*recoJetR10Px)[1],(*recoJetR10Py)[1],(*recoJetR10Pz)[1],(*recoJetR10E)[1]);
	deltaPhig1r=tempGenJet1.Angle(tempRecoJet2.Vect());
	deltaPhig2r=tempGenJet2.Angle(tempRecoJet2.Vect());
	int indrj2_m=0;
	float ang_rj2_g=deltaPhig2r;
	if(deltaPhig1r<deltaPhig2r){
	  reco2_over_gen=tempRecoJet2.E()/tempGenJet1.E();
	  h_hist_vec[55]->Fill(tempRecoJet2.E()/tempGenJet1.E());
	  ang_rj2_g=deltaPhig1r;
	}else{
	  indrj2_m=1;
	  reco2_over_gen=tempRecoJet2.E()/tempGenJet2.E();
	  h_hist_vec[55]->Fill(tempRecoJet2.E()/tempGenJet2.E());
	}
	//std::cout<<"delta angle1/delta angle 2 reco 2: "<<TMath::RadToDeg()*deltaPhig1r<<"/"<<TMath::RadToDeg()*deltaPhig2r<<"/"<<indrj2_m<<std::endl;
	if(indrj1_m!=indrj2_m && DeltaPhi(tempGenJet1.Phi(),tempGenJet2.Phi())> delta_phi_min){
	  if(fabs(d1_cosTheta)<0.65){
	    if(indrj1_m==0){
	      h_hist_vec[153]->Fill(TMath::RadToDeg()*DeltaPhiDir(tempRecoJet1.Phi(),tempGenJet1.Phi()));
	      h_hist_vec[153]->Fill(TMath::RadToDeg()*DeltaPhiDir(tempRecoJet2.Phi(),tempGenJet2.Phi()));
	      h_hist_vec[157]->Fill((tempRecoJet1.Theta()-tempGenJet1.Theta())*TMath::RadToDeg());
	      h_hist_vec[157]->Fill((tempRecoJet2.Theta()-tempGenJet2.Theta())*TMath::RadToDeg());
	    }else{
	      h_hist_vec[153]->Fill(TMath::RadToDeg()*DeltaPhiDir(tempRecoJet1.Phi(),tempGenJet2.Phi()));
	      h_hist_vec[153]->Fill(TMath::RadToDeg()*DeltaPhiDir(tempRecoJet2.Phi(),tempGenJet1.Phi()));
	      h_hist_vec[157]->Fill((tempRecoJet1.Theta()-tempGenJet2.Theta())*TMath::RadToDeg());
	      h_hist_vec[157]->Fill((tempRecoJet2.Theta()-tempGenJet1.Theta())*TMath::RadToDeg());
	    }
	  }else if(fabs(d1_cosTheta)<0.80){
	    if(indrj1_m==0){
	      h_hist_vec[154]->Fill(TMath::RadToDeg()*DeltaPhiDir(tempRecoJet1.Phi(),tempGenJet1.Phi()));
	      h_hist_vec[154]->Fill(TMath::RadToDeg()*DeltaPhiDir(tempRecoJet2.Phi(),tempGenJet2.Phi()));
	      h_hist_vec[158]->Fill((tempRecoJet1.Theta()-tempGenJet1.Theta())*TMath::RadToDeg());
	      h_hist_vec[158]->Fill((tempRecoJet2.Theta()-tempGenJet2.Theta())*TMath::RadToDeg());
	    }else{
	      h_hist_vec[154]->Fill(TMath::RadToDeg()*DeltaPhiDir(tempRecoJet1.Phi(),tempGenJet2.Phi()));
	      h_hist_vec[154]->Fill(TMath::RadToDeg()*DeltaPhiDir(tempRecoJet2.Phi(),tempGenJet1.Phi()));
	      h_hist_vec[158]->Fill((tempRecoJet1.Theta()-tempGenJet2.Theta())*TMath::RadToDeg());
	      h_hist_vec[158]->Fill((tempRecoJet2.Theta()-tempGenJet1.Theta())*TMath::RadToDeg());
	    }
	  }else if(fabs(d1_cosTheta)<0.925){
	    if(indrj1_m==0){
	      h_hist_vec[155]->Fill(TMath::RadToDeg()*DeltaPhiDir(tempRecoJet1.Phi(),tempGenJet1.Phi()));
	      h_hist_vec[155]->Fill(TMath::RadToDeg()*DeltaPhiDir(tempRecoJet2.Phi(),tempGenJet2.Phi()));
	      h_hist_vec[159]->Fill((tempRecoJet1.Theta()-tempGenJet1.Theta())*TMath::RadToDeg());
	      h_hist_vec[159]->Fill((tempRecoJet2.Theta()-tempGenJet2.Theta())*TMath::RadToDeg());
	    }else{
	      h_hist_vec[155]->Fill(TMath::RadToDeg()*DeltaPhiDir(tempRecoJet1.Phi(),tempGenJet2.Phi()));
	      h_hist_vec[155]->Fill(TMath::RadToDeg()*DeltaPhiDir(tempRecoJet2.Phi(),tempGenJet1.Phi()));
	      h_hist_vec[159]->Fill((tempRecoJet1.Theta()-tempGenJet2.Theta())*TMath::RadToDeg());
	      h_hist_vec[159]->Fill((tempRecoJet2.Theta()-tempGenJet1.Theta())*TMath::RadToDeg());
	    }
	  }else if(fabs(d1_cosTheta)<0.975){
	    if(indrj1_m==0){
	      h_hist_vec[156]->Fill(TMath::RadToDeg()*DeltaPhiDir(tempRecoJet1.Phi(),tempGenJet1.Phi()));
	      h_hist_vec[156]->Fill(TMath::RadToDeg()*DeltaPhiDir(tempRecoJet2.Phi(),tempGenJet2.Phi()));
	      h_hist_vec[160]->Fill((tempRecoJet1.Theta()-tempGenJet1.Theta())*TMath::RadToDeg());
	      h_hist_vec[160]->Fill((tempRecoJet2.Theta()-tempGenJet2.Theta())*TMath::RadToDeg());
	    }else{
	      h_hist_vec[159]->Fill(TMath::RadToDeg()*DeltaPhiDir(tempRecoJet1.Phi(),tempGenJet2.Phi()));
	      h_hist_vec[159]->Fill(TMath::RadToDeg()*DeltaPhiDir(tempRecoJet2.Phi(),tempGenJet1.Phi()));
	      h_hist_vec[160]->Fill((tempRecoJet1.Theta()-tempGenJet2.Theta())*TMath::RadToDeg());
	      h_hist_vec[160]->Fill((tempRecoJet2.Theta()-tempGenJet1.Theta())*TMath::RadToDeg());
	    }
	  }
	}
	if(indrj1_m!=indrj2_m){
	  if(fabs(d1_cosTheta)<0.1){
	    if((ang_rj1_g*TMath::RadToDeg())<delta_phi_max_reco_gen){
	      h_hist_vec[124]->Fill(reco1_over_gen);
	    }
	    if((ang_rj2_g*TMath::RadToDeg())<delta_phi_max_reco_gen){
	      h_hist_vec[124]->Fill(reco2_over_gen);
	    }
	  }else if(fabs(d1_cosTheta)<0.2){
	    if((ang_rj1_g*TMath::RadToDeg())<delta_phi_max_reco_gen){
	      h_hist_vec[125]->Fill(reco1_over_gen);
	    }
	    if((ang_rj2_g*TMath::RadToDeg())<delta_phi_max_reco_gen){
	      h_hist_vec[125]->Fill(reco2_over_gen);
	    }
	  }else if(fabs(d1_cosTheta)<0.3){
	    if((ang_rj1_g*TMath::RadToDeg())<delta_phi_max_reco_gen){
	      h_hist_vec[126]->Fill(reco1_over_gen);
	    }
	    if((ang_rj2_g*TMath::RadToDeg())<delta_phi_max_reco_gen){
	      h_hist_vec[126]->Fill(reco2_over_gen);
	    }
	  }else if(fabs(d1_cosTheta)<0.4){
	    if((ang_rj1_g*TMath::RadToDeg())<delta_phi_max_reco_gen){
	      h_hist_vec[127]->Fill(reco1_over_gen);
	    }
	    if((ang_rj2_g*TMath::RadToDeg())<delta_phi_max_reco_gen){
	      h_hist_vec[127]->Fill(reco2_over_gen);
	    }
	  }else if(fabs(d1_cosTheta)<0.5){
	    if((ang_rj1_g*TMath::RadToDeg())<delta_phi_max_reco_gen){
	      h_hist_vec[128]->Fill(reco1_over_gen);
	    }
	    if((ang_rj2_g*TMath::RadToDeg())<delta_phi_max_reco_gen){
	      h_hist_vec[128]->Fill(reco2_over_gen);
	    }
	  }else if(fabs(d1_cosTheta)<0.6){
	    if((ang_rj1_g*TMath::RadToDeg())<delta_phi_max_reco_gen){
	      h_hist_vec[129]->Fill(reco1_over_gen);
	    }
	    if((ang_rj2_g*TMath::RadToDeg())<delta_phi_max_reco_gen){
	      h_hist_vec[129]->Fill(reco2_over_gen);
	    }
	  }else if(fabs(d1_cosTheta)<0.7){
	    if((ang_rj1_g*TMath::RadToDeg())<delta_phi_max_reco_gen){
	      h_hist_vec[130]->Fill(reco1_over_gen);
	    }
	    if((ang_rj2_g*TMath::RadToDeg())<delta_phi_max_reco_gen){
	      h_hist_vec[130]->Fill(reco2_over_gen);
	    }
	  }else if(fabs(d1_cosTheta)<0.8){
	    if((ang_rj1_g*TMath::RadToDeg())<delta_phi_max_reco_gen){
	      h_hist_vec[131]->Fill(reco1_over_gen);
	    }
	    if((ang_rj2_g*TMath::RadToDeg())<delta_phi_max_reco_gen){
	      h_hist_vec[131]->Fill(reco2_over_gen);
	    }
	  }else if(fabs(d1_cosTheta)<0.9){
	    if((ang_rj1_g*TMath::RadToDeg())<delta_phi_max_reco_gen){
	      h_hist_vec[132]->Fill(reco1_over_gen);
	    }
	    if((ang_rj2_g*TMath::RadToDeg())<delta_phi_max_reco_gen){
	      h_hist_vec[132]->Fill(reco2_over_gen);
	    }
	  }else if(fabs(d1_cosTheta)<0.925){
	    if((ang_rj1_g*TMath::RadToDeg())<delta_phi_max_reco_gen){
	      h_hist_vec[133]->Fill(reco1_over_gen);
	    }
	    if((ang_rj2_g*TMath::RadToDeg())<delta_phi_max_reco_gen){
	      h_hist_vec[133]->Fill(reco2_over_gen);
	    }
	  }else if(fabs(d1_cosTheta)<0.950){
	    if((ang_rj1_g*TMath::RadToDeg())<delta_phi_max_reco_gen){
	      h_hist_vec[134]->Fill(reco1_over_gen);
	    }
	    if((ang_rj2_g*TMath::RadToDeg())<delta_phi_max_reco_gen){
	      h_hist_vec[134]->Fill(reco2_over_gen);
	    }
	  }else if(fabs(d1_cosTheta)<0.975){
	    if((ang_rj1_g*TMath::RadToDeg())<delta_phi_max_reco_gen){
	      h_hist_vec[135]->Fill(reco1_over_gen);
	    }
	    if((ang_rj2_g*TMath::RadToDeg())<delta_phi_max_reco_gen){
	      h_hist_vec[135]->Fill(reco2_over_gen);
	    }
	  }else{
	    if((ang_rj1_g*TMath::RadToDeg())<delta_phi_max_reco_gen){
	      h_hist_vec[136]->Fill(reco1_over_gen);	  
	    } 
	    if((ang_rj2_g*TMath::RadToDeg())<delta_phi_max_reco_gen){
	      h_hist_vec[136]->Fill(reco2_over_gen);
	    } 
	  }
	}
      }else{
	std::cout<<"FAIL SPLIT JET TEST"<<std::endl;
      }
    }
    //now the histograms for the reconstructed jets, here the total PFO energy is considered in the denominator
    if(recoJetR03E->size()==2){
      tempGenJet1.SetPxPyPzE((*recoJetR03Px)[0],(*recoJetR03Py)[0],(*recoJetR03Pz)[0],(*recoJetR03E)[0]);
      tempGenJet2.SetPxPyPzE((*recoJetR03Px)[1],(*recoJetR03Py)[1],(*recoJetR03Pz)[1],(*recoJetR03E)[1]);
      h_hist_vec[24]->Fill(DeltaPhi(tempGenJet1.Phi(),tempGenJet2.Phi()));
      if(DeltaPhi(tempGenJet1.Phi(),tempGenJet2.Phi())> delta_phi_min){
	//back to back jets to increase dijet content in sample
	h_hist_vec[25]->Fill((tempGenJet1.E()+tempGenJet2.E())/E_totPFO);
	if(i_entry%2 ==0 ){
	  h_hist_vec[26]->Fill((tempGenJet1.E()-tempGenJet2.E())/(tempGenJet1.E()+tempGenJet2.E()));
	}else{
	  h_hist_vec[26]->Fill((tempGenJet2.E()-tempGenJet1.E())/(tempGenJet1.E()+tempGenJet2.E()));
	}
      }
    }
    if(recoJetR04E->size()==2){
      tempGenJet1.SetPxPyPzE((*recoJetR04Px)[0],(*recoJetR04Py)[0],(*recoJetR04Pz)[0],(*recoJetR04E)[0]);
      tempGenJet2.SetPxPyPzE((*recoJetR04Px)[1],(*recoJetR04Py)[1],(*recoJetR04Pz)[1],(*recoJetR04E)[1]);
      h_hist_vec[27]->Fill(DeltaPhi(tempGenJet1.Phi(),tempGenJet2.Phi()));
      if(DeltaPhi(tempGenJet1.Phi(),tempGenJet2.Phi())> delta_phi_min){
	//back to back jets to increase dijet content in sample
	h_hist_vec[28]->Fill((tempGenJet1.E()+tempGenJet2.E())/E_totPFO);
	if(i_entry%2 ==0 ){
	  h_hist_vec[29]->Fill((tempGenJet1.E()-tempGenJet2.E())/(tempGenJet1.E()+tempGenJet2.E()));
	}else{
	  h_hist_vec[29]->Fill((tempGenJet2.E()-tempGenJet1.E())/(tempGenJet1.E()+tempGenJet2.E()));
	}
      }
    }
    if(recoJetR05E->size()==2){
      tempGenJet1.SetPxPyPzE((*recoJetR05Px)[0],(*recoJetR05Py)[0],(*recoJetR05Pz)[0],(*recoJetR05E)[0]);
      tempGenJet2.SetPxPyPzE((*recoJetR05Px)[1],(*recoJetR05Py)[1],(*recoJetR05Pz)[1],(*recoJetR05E)[1]);
      h_hist_vec[30]->Fill(DeltaPhi(tempGenJet1.Phi(),tempGenJet2.Phi()));
      if(DeltaPhi(tempGenJet1.Phi(),tempGenJet2.Phi())> delta_phi_min){
	//back to back jets to increase dijet content in sample
	h_hist_vec[31]->Fill((tempGenJet1.E()+tempGenJet2.E())/E_totPFO);
	if(i_entry%2 ==0 ){
	  h_hist_vec[32]->Fill((tempGenJet1.E()-tempGenJet2.E())/(tempGenJet1.E()+tempGenJet2.E()));
	}else{
	  h_hist_vec[32]->Fill((tempGenJet2.E()-tempGenJet1.E())/(tempGenJet1.E()+tempGenJet2.E()));
	}
      }
    }
    if(recoJetR06E->size()==2){
      tempGenJet1.SetPxPyPzE((*recoJetR06Px)[0],(*recoJetR06Py)[0],(*recoJetR06Pz)[0],(*recoJetR06E)[0]);
      tempGenJet2.SetPxPyPzE((*recoJetR06Px)[1],(*recoJetR06Py)[1],(*recoJetR06Pz)[1],(*recoJetR06E)[1]);
      h_hist_vec[33]->Fill(DeltaPhi(tempGenJet1.Phi(),tempGenJet2.Phi()));
      if(DeltaPhi(tempGenJet1.Phi(),tempGenJet2.Phi())> delta_phi_min){
	//back to back jets to increase dijet content in sample
	h_hist_vec[34]->Fill((tempGenJet1.E()+tempGenJet2.E())/E_totPFO);
	if(i_entry%2 ==0 ){
	  h_hist_vec[35]->Fill((tempGenJet1.E()-tempGenJet2.E())/(tempGenJet1.E()+tempGenJet2.E()));
	}else{
	  h_hist_vec[35]->Fill((tempGenJet2.E()-tempGenJet1.E())/(tempGenJet1.E()+tempGenJet2.E()));
	}
      }
    }
    if(recoJetR07E->size()==2){
      tempGenJet1.SetPxPyPzE((*recoJetR07Px)[0],(*recoJetR07Py)[0],(*recoJetR07Pz)[0],(*recoJetR07E)[0]);
      tempGenJet2.SetPxPyPzE((*recoJetR07Px)[1],(*recoJetR07Py)[1],(*recoJetR07Pz)[1],(*recoJetR07E)[1]);
      h_hist_vec[36]->Fill(DeltaPhi(tempGenJet1.Phi(),tempGenJet2.Phi()));
      if(DeltaPhi(tempGenJet1.Phi(),tempGenJet2.Phi())> delta_phi_min){
	//back to back jets to increase dijet content in sample
	h_hist_vec[37]->Fill((tempGenJet1.E()+tempGenJet2.E())/E_totPFO);
	if(i_entry%2 ==0 ){
	  h_hist_vec[38]->Fill((tempGenJet1.E()-tempGenJet2.E())/(tempGenJet1.E()+tempGenJet2.E()));
	}else{
	  h_hist_vec[38]->Fill((tempGenJet2.E()-tempGenJet1.E())/(tempGenJet1.E()+tempGenJet2.E()));
	}
      }
    }
    if(recoJetR08E->size()==2){
      tempGenJet1.SetPxPyPzE((*recoJetR08Px)[0],(*recoJetR08Py)[0],(*recoJetR08Pz)[0],(*recoJetR08E)[0]);
      tempGenJet2.SetPxPyPzE((*recoJetR08Px)[1],(*recoJetR08Py)[1],(*recoJetR08Pz)[1],(*recoJetR08E)[1]);
      h_hist_vec[39]->Fill(DeltaPhi(tempGenJet1.Phi(),tempGenJet2.Phi()));
      if(DeltaPhi(tempGenJet1.Phi(),tempGenJet2.Phi())> delta_phi_min){
	//back to back jets to increase dijet content in sample
	h_hist_vec[40]->Fill((tempGenJet1.E()+tempGenJet2.E())/E_totPFO);
	if(i_entry%2 ==0 ){
	  h_hist_vec[41]->Fill((tempGenJet1.E()-tempGenJet2.E())/(tempGenJet1.E()+tempGenJet2.E()));
	}else{
	  h_hist_vec[41]->Fill((tempGenJet2.E()-tempGenJet1.E())/(tempGenJet1.E()+tempGenJet2.E()));
	}
      }
    }
    if(recoJetR09E->size()==2){
      tempGenJet1.SetPxPyPzE((*recoJetR09Px)[0],(*recoJetR09Py)[0],(*recoJetR09Pz)[0],(*recoJetR09E)[0]);
      tempGenJet2.SetPxPyPzE((*recoJetR09Px)[1],(*recoJetR09Py)[1],(*recoJetR09Pz)[1],(*recoJetR09E)[1]);
      h_hist_vec[42]->Fill(DeltaPhi(tempGenJet1.Phi(),tempGenJet2.Phi()));
      if(DeltaPhi(tempGenJet1.Phi(),tempGenJet2.Phi())> delta_phi_min){
	//back to back jets to increase dijet content in sample
	h_hist_vec[43]->Fill((tempGenJet1.E()+tempGenJet2.E())/E_totPFO);
	if(i_entry%2 ==0 ){
	  h_hist_vec[44]->Fill((tempGenJet1.E()-tempGenJet2.E())/(tempGenJet1.E()+tempGenJet2.E()));
	}else{
	  h_hist_vec[44]->Fill((tempGenJet2.E()-tempGenJet1.E())/(tempGenJet1.E()+tempGenJet2.E()));
	}
      }
    }
    if(recoJetR10E->size()==2){
      tempGenJet1.SetPxPyPzE((*recoJetR10Px)[0],(*recoJetR10Py)[0],(*recoJetR10Pz)[0],(*recoJetR10E)[0]);
      tempGenJet2.SetPxPyPzE((*recoJetR10Px)[1],(*recoJetR10Py)[1],(*recoJetR10Pz)[1],(*recoJetR10E)[1]);
      h_hist_vec[45]->Fill(DeltaPhi(tempGenJet1.Phi(),tempGenJet2.Phi()));     if(DeltaPhi(tempGenJet1.Phi(),tempGenJet2.Phi())> delta_phi_min){
	//back to back jets to increase dijet content in sample
	h_hist_vec[46]->Fill((tempGenJet1.E()+tempGenJet2.E())/E_totPFO);
	if(i_entry%2 ==0 ){
	  h_hist_vec[47]->Fill((tempGenJet1.E()-tempGenJet2.E())/(tempGenJet1.E()+tempGenJet2.E()));
	}else{
	  h_hist_vec[47]->Fill((tempGenJet2.E()-tempGenJet1.E())/(tempGenJet1.E()+tempGenJet2.E()));
	}
      }
    }
  }
  delete tree;
}






void JERPlotsFull(){

  CLICdpStyle();

  gROOT->ProcessLine("#include <vector>");

  const char* final_histo_name="/afs/cern.ch/user/w/weberma2/performanceHistoFiles/Zuds_CT_wO_181101_histoFitRange_0_00_to_3_00_SWC_allRange_allSamples_nPFO_1.root";

  //ROOT::Math::Minimizer* pMinimizer = ROOT::Math::Factory::CreateMinimizer("Minuit2", "Migrad");
  //pMinimizer->SetMaxFunctionCalls(10000000);
  //pMinimizer->SetMaxIterations(1000000);

  ROOT::Math::Minimizer* pMinimizer = ROOT::Math::Factory::CreateMinimizer("Minuit2", "Migrad");
  pMinimizer->SetMaxFunctionCalls(10000000);
  pMinimizer->SetMaxIterations(1000000);
  pMinimizer->SetTolerance(0.001);

  TVirtualFitter::SetDefaultFitter("Minuit2");
  TVirtualFitter::SetMaxIterations(20000);
  //TVirtualFitter::SetPrecision(0.01);

  string label_legend= "#gamma, E_{true}=1 GeV";

  const unsigned int nRegionBinsAngles(4);
  float pRegionBinEdgesAngles[nRegionBinsAngles + 1] = {0, 0.65, 0.8, 0.925, 0.975};

  const unsigned int nRegionBins(13);
  float pRegionBinEdges[nRegionBins + 1] = {0, 0.1, 0.2, 0.3, 0.4, 0.5, 0.6, 0.7, 0.8, 0.9, 0.925, 0.95, 0.975, 1.0};

  float resolutionTH1(0.f), resolutionErrorTH1(0.f),meanTH1(0.f),meanErrorTH1(0.f);
  resolutionTH1 = 0.0;
  resolutionErrorTH1 = 0.0;

  meanTH1 = 0.0;
  meanErrorTH1 = 0.0;

  float m_top_CosTheta=0.3;

 
  //TFile* file_CLIC_100_CT=TFile::Open("/eos/user/w/weberma2/data/JetAnalyzerFiles/181101_gcc62/SWCAllDetector_allSamples_nPFO_1/JetStudy_Zuds100_12954_noOverlay_CLIC_o3_v14_CT_PandoraPFOs.root");
  TFile* file_CLIC_100_CT=TFile::Open("/eos/user/w/weberma2/data/JetAnalyzerFiles/181101_gcc62/JetStudy_Zuds100_11771_noOverlay_CLIC_o3_v14_CT_PandoraPFOs.root");
  TFile* file_CLIC_100_CT_wO=TFile::Open("/eos/user/w/weberma2/data/JetAnalyzerFiles/181101_gcc62/JetStudy_Zuds100_11772_3TeVOverlay_CLIC_o3_v14_CT_TightSelectedPandoraPFOs.root");
  TFile* file_CLIC_100_CT_noSC=TFile::Open("/eos/user/w/weberma2/data/JetAnalyzerFiles/181101_gcc62/JetStudy_Zuds100_11841_noOverlay_CLIC_o3_v14_CT_PandoraPFOs_noSC.root");
  TFile* file_CLIC_100_CT_noSC_wO=TFile::Open("/eos/user/w/weberma2/data/JetAnalyzerFiles/181101_gcc62/JetStudy_Zuds100_11842_3TeVOverlay_CLIC_o3_v14_CT_TightSelectedPandoraPFOs_noSC.root");
  TFile* file_CLIC_100_CT_wO_380=TFile::Open("/eos/user/w/weberma2/data/JetAnalyzerFiles/181101_gcc62/JetStudy_Zuds100_11799_380GeVOverlay_CLIC_o3_v14_CT_LE_LooseSelectedPandoraPFOs.root");

  // TFile* file_CLIC_200_CT=TFile::Open("/eos/user/w/weberma2/data/JetAnalyzerFiles/181101_gcc62/SWCAllDetector_allSamples_nPFO_1/JetStudy_Zuds200_12955_noOverlay_CLIC_o3_v14_CT_PandoraPFOs.root");
  TFile* file_CLIC_200_CT=TFile::Open("/eos/user/w/weberma2/data/JetAnalyzerFiles/181101_gcc62/JetStudy_Zuds200_11775_noOverlay_CLIC_o3_v14_CT_PandoraPFOs.root");
  TFile* file_CLIC_200_CT_wO=TFile::Open("/eos/user/w/weberma2/data/JetAnalyzerFiles/181101_gcc62/JetStudy_Zuds200_11776_3TeVOverlay_CLIC_o3_v14_CT_TightSelectedPandoraPFOs.root");
  //TFile* file_CLIC_200_CT_noSC=TFile::Open("/eos/user/w/weberma2/data/JetAnalyzerFiles/181101_gcc62/JetStudy_Zuds200_11849_noOverlay_CLIC_o3_v14_CT_PandoraPFOs_noSC.root");
  TFile* file_CLIC_200_CT_noSC=TFile::Open("/eos/user/w/weberma2/data/JetAnalyzerFiles/181101_gcc62/JetStudy_Zuds200_11849_noOverlay_CLIC_o3_v14_CT_PandoraPFOs_noSC_real.root");
  TFile* file_CLIC_200_CT_noSC_wO=TFile::Open("/eos/user/w/weberma2/data/JetAnalyzerFiles/181101_gcc62/JetStudy_Zuds200_11850_3TeVOverlay_CLIC_o3_v14_CT_TightSelectedPandoraPFOs_noSC.root");
  TFile* file_CLIC_200_CT_wO_380=TFile::Open("/eos/user/w/weberma2/data/JetAnalyzerFiles/181101_gcc62/JetStudy_Zuds200_11801_380GeVOverlay_CLIC_o3_v14_CT_LE_LooseSelectedPandoraPFOs.root");
  
  TFile* file_CLIC_380_CT=TFile::Open("/eos/user/w/weberma2/data/JetAnalyzerFiles/181101_gcc62/JetStudy_Zuds380_11779_noOverlay_CLIC_o3_v14_CT_PandoraPFOs.root");
  TFile* file_CLIC_380_CT_wO=TFile::Open("/eos/user/w/weberma2/data/JetAnalyzerFiles/181101_gcc62/JetStudy_Zuds380_11780_3TeVOverlay_CLIC_o3_v14_CT_TightSelectedPandoraPFOs.root");
  //TFile* file_CLIC_380_CT_noSC=TFile::Open("/eos/user/w/weberma2/data/JetAnalyzerFiles/181101_gcc62/JetStudy_Zuds380_11857_noOverlay_CLIC_o3_v14_CT_PandoraPFOs_noSC.root");
  TFile* file_CLIC_380_CT_noSC=TFile::Open("/eos/user/w/weberma2/data/JetAnalyzerFiles/181101_gcc62/JetStudy_Zuds380_11857_noOverlay_CLIC_o3_v14_CT_PandoraPFOs_noSC_real.root");
  TFile* file_CLIC_380_CT_noSC_wO=TFile::Open("/eos/user/w/weberma2/data/JetAnalyzerFiles/181101_gcc62/JetStudy_Zuds380_11858_3TeVOverlay_CLIC_o3_v14_CT_TightSelectedPandoraPFOs_noSC.root");
  TFile* file_CLIC_380_CT_wO_380=TFile::Open("/eos/user/w/weberma2/data/JetAnalyzerFiles/181101_gcc62/JetStudy_Zuds380_11803_380GeVOverlay_CLIC_o3_v14_CT_LE_LooseSelectedPandoraPFOs.root");
  
  //TFile* file_CLIC_500_CT=TFile::Open("/eos/user/w/weberma2/data/JetAnalyzerFiles/181101_gcc62/SWCAllDetector_allSamples_nPFO_1/JetStudy_Zuds500_12956_noOverlay_CLIC_o3_v14_CT_PandoraPFOs.root");
  TFile* file_CLIC_500_CT=TFile::Open("/eos/user/w/weberma2/data/JetAnalyzerFiles/181101_gcc62/JetStudy_Zuds500_11783_noOverlay_CLIC_o3_v14_CT_PandoraPFOs.root");
  //TFile* file_CLIC_500_CT=TFile::Open("/eos/user/w/weberma2/data/JetAnalyzerFiles/181011_gcc62/JetStudy_Zuds500_11483_noOverlay_CLIC_o3_v14_CT_TightSelectedPandoraPFOs.root");
  TFile* file_CLIC_500_CT_wO=TFile::Open("/eos/user/w/weberma2/data/JetAnalyzerFiles/181101_gcc62/JetStudy_Zuds500_11784_3TeVOverlay_CLIC_o3_v14_CT_TightSelectedPandoraPFOs.root");
  TFile* file_CLIC_500_CT_noSC=TFile::Open("/eos/user/w/weberma2/data/JetAnalyzerFiles/181101_gcc62/JetStudy_Zuds500_11865_noOverlay_CLIC_o3_v14_CT_PandoraPFOs_noSC.root");
  TFile* file_CLIC_500_CT_noSC_wO=TFile::Open("/eos/user/w/weberma2/data/JetAnalyzerFiles/181101_gcc62/JetStudy_Zuds500_11866_3TeVOverlay_CLIC_o3_v14_CT_TightSelectedPandoraPFOs_noSC.root");

  //TFile* file_CLIC_1500_CT=TFile::Open("/eos/user/w/weberma2/data/JetAnalyzerFiles/180724_gcc62/JetStudy_Zuds1500_10828_no3TeVOverlay_CLIC_o3_v14_CT_PandoraPFOs.root");
  //TFile* file_CLIC_1500_CT_wO=TFile::Open("/eos/user/w/weberma2/data/JetAnalyzerFiles/180724_gcc62/JetStudy_Zuds1500_10829_3TeVOverlay_CLIC_o3_v14_CT_TightSelectedPandoraPFOs.root");
  //TFile* file_CLIC_1500_CT=TFile::Open("/eos/user/w/weberma2/data/JetAnalyzerFiles/181101_gcc62/SWCAllDetector_allSamples_nPFO_1/JetStudy_Zuds1500_12959_noOverlay_CLIC_o3_v14_CT_PandoraPFOs.root");
  TFile* file_CLIC_1500_CT=TFile::Open("/eos/user/w/weberma2/data/JetAnalyzerFiles/181101_gcc62/JetStudy_Zuds1500_11787_noOverlay_CLIC_o3_v14_CT_PandoraPFOs.root");
  TFile* file_CLIC_1500_CT_wO=TFile::Open("/eos/user/w/weberma2/data/JetAnalyzerFiles/181101_gcc62/JetStudy_Zuds1500_11788_3TeVOverlay_CLIC_o3_v14_CT_TightSelectedPandoraPFOs.root");
  TFile* file_CLIC_1500_CT_noSC=TFile::Open("/eos/user/w/weberma2/data/JetAnalyzerFiles/181101_gcc62/JetStudy_Zuds1500_11873_noOverlay_CLIC_o3_v14_CT_PandoraPFOs_noSC.root");
  TFile* file_CLIC_1500_CT_noSC_wO=TFile::Open("/eos/user/w/weberma2/data/JetAnalyzerFiles/181101_gcc62/JetStudy_Zuds1500_11874_3TeVOverlay_CLIC_o3_v14_CT_TightSelectedPandoraPFOs_noSC.root");

   //TFile* file_CLIC_3000_CT=TFile::Open("/eos/user/w/weberma2/data/JetAnalyzerFiles/180724_gcc62/JetStudy_Zuds3000_10832_no3TeVOverlay_CLIC_o3_v14_CT_PandoraPFOs.root");
   //TFile* file_CLIC_3000_CT_wO=TFile::Open("/eos/user/w/weberma2/data/JetAnalyzerFiles/180724_gcc62/JetStudy_Zuds3000_10833_3TeVOverlay_CLIC_o3_v14_CT_TightSelectedPandoraPFOs.root");
  //TFile* file_CLIC_3000_CT=TFile::Open("/eos/user/w/weberma2/data/JetAnalyzerFiles/181101_gcc62/SWCAllDetector_allSamples_nPFO_1/JetStudy_Zuds3000_12957_noOverlay_CLIC_o3_v14_CT_PandoraPFOs.root");
  TFile* file_CLIC_3000_CT=TFile::Open("/eos/user/w/weberma2/data/JetAnalyzerFiles/181101_gcc62/JetStudy_Zuds3000_11791_noOverlay_CLIC_o3_v14_CT_PandoraPFOs.root");
  TFile* file_CLIC_3000_CT_wO=TFile::Open("/eos/user/w/weberma2/data/JetAnalyzerFiles/181101_gcc62/JetStudy_Zuds3000_11792_3TeVOverlay_CLIC_o3_v14_CT_TightSelectedPandoraPFOs.root");
  TFile* file_CLIC_3000_CT_noSC=TFile::Open("/eos/user/w/weberma2/data/JetAnalyzerFiles/181101_gcc62/JetStudy_Zuds3000_11881_noOverlay_CLIC_o3_v14_CT_PandoraPFOs_noSC.root");
  TFile* file_CLIC_3000_CT_noSC_wO=TFile::Open("/eos/user/w/weberma2/data/JetAnalyzerFiles/181101_gcc62/JetStudy_Zuds3000_11882_3TeVOverlay_CLIC_o3_v14_CT_TightSelectedPandoraPFOs_noSC.root");

  TFile* file_CLIC_WW_250_CT = TFile::Open("/eos/user/w/weberma2/data/JetAnalyzerFiles/181011_gcc62/JetStudy_WW250_11560_noOverlay_CLIC_o3_v14_CT_PandoraPFOs.root");
  TFile* file_CLIC_WW_250_CT_wO = TFile::Open("/eos/user/w/weberma2/data/JetAnalyzerFiles/181011_gcc62/JetStudy_WW250_11561_3TeVOverlay_CLIC_o3_v14_CT_TightSelectedPandoraPFOs.root");
  TFile* file_CLIC_WW_250_CT_wO_Loose = TFile::Open("/eos/user/w/weberma2/data/JetAnalyzerFiles/181011_gcc62/JetStudy_WW250_11561_3TeVOverlay_CLIC_o3_v14_CT_SelectedPandoraPFOs.root");
  TFile* file_CLIC_WW_250_CT_wO_Selected = TFile::Open("/eos/user/w/weberma2/data/JetAnalyzerFiles/181011_gcc62/JetStudy_WW250_11561_3TeVOverlay_CLIC_o3_v14_CT_LooseSelectedPandoraPFOs.root");
  TFile* file_CLIC_WW_250_CT_wO_allPFOs = TFile::Open("/eos/user/w/weberma2/data/JetAnalyzerFiles/181011_gcc62/JetStudy_WW250_11561_3TeVOverlay_CLIC_o3_v14_CT_PandoraPFOs.root");

  TFile* file_CLIC_WW_500_CT = TFile::Open("/eos/user/w/weberma2/data/JetAnalyzerFiles/181011_gcc62/JetStudy_WW500_11564_noOverlay_CLIC_o3_v14_CT_PandoraPFOs.root");
  TFile* file_CLIC_WW_500_CT_wO = TFile::Open("/eos/user/w/weberma2/data/JetAnalyzerFiles/181011_gcc62/JetStudy_WW500_11565_3TeVOverlay_CLIC_o3_v14_CT_TightSelectedPandoraPFOs.root");
  TFile* file_CLIC_WW_500_CT_wO_Loose = TFile::Open("/eos/user/w/weberma2/data/JetAnalyzerFiles/181011_gcc62/JetStudy_WW500_11565_3TeVOverlay_CLIC_o3_v14_CT_SelectedPandoraPFOs.root");
  TFile* file_CLIC_WW_500_CT_wO_Selected = TFile::Open("/eos/user/w/weberma2/data/JetAnalyzerFiles/181011_gcc62/JetStudy_WW500_11565_3TeVOverlay_CLIC_o3_v14_CT_LooseSelectedPandoraPFOs.root");
  TFile* file_CLIC_WW_500_CT_wO_allPFOs = TFile::Open("/eos/user/w/weberma2/data/JetAnalyzerFiles/181011_gcc62/JetStudy_WW500_11565_3TeVOverlay_CLIC_o3_v14_CT_PandoraPFOs.root");

  TFile* file_CLIC_WW_1000_CT = TFile::Open("/eos/user/w/weberma2/data/JetAnalyzerFiles/181011_gcc62/JetStudy_WW1000_11568_noOverlay_CLIC_o3_v14_CT_PandoraPFOs.root");
  TFile* file_CLIC_WW_1000_CT_wO = TFile::Open("/eos/user/w/weberma2/data/JetAnalyzerFiles/181011_gcc62/JetStudy_WW1000_11569_3TeVOverlay_CLIC_o3_v14_CT_TightSelectedPandoraPFOs.root");
  TFile* file_CLIC_WW_1000_CT_wO_Loose = TFile::Open("/eos/user/w/weberma2/data/JetAnalyzerFiles/181011_gcc62/JetStudy_WW1000_11569_3TeVOverlay_CLIC_o3_v14_CT_SelectedPandoraPFOs.root");
  TFile* file_CLIC_WW_1000_CT_wO_Selected = TFile::Open("/eos/user/w/weberma2/data/JetAnalyzerFiles/181011_gcc62/JetStudy_WW1000_11569_3TeVOverlay_CLIC_o3_v14_CT_LooseSelectedPandoraPFOs.root");
  TFile* file_CLIC_WW_1000_CT_wO_allPFOs = TFile::Open("/eos/user/w/weberma2/data/JetAnalyzerFiles/181011_gcc62/JetStudy_WW1000_11569_3TeVOverlay_CLIC_o3_v14_CT_PandoraPFOs.root");

  TFile* file_CLIC_WW_2000_CT = TFile::Open("/eos/user/w/weberma2/data/JetAnalyzerFiles/181011_gcc62/JetStudy_WW2000_11572_noOverlay_CLIC_o3_v14_CT_PandoraPFOs.root");
  TFile* file_CLIC_WW_2000_CT_wO = TFile::Open("/eos/user/w/weberma2/data/JetAnalyzerFiles/181011_gcc62/JetStudy_WW2000_11573_3TeVOverlay_CLIC_o3_v14_CT_TightSelectedPandoraPFOs.root");
  TFile* file_CLIC_WW_2000_CT_wO_Loose = TFile::Open("/eos/user/w/weberma2/data/JetAnalyzerFiles/181011_gcc62/JetStudy_WW2000_11573_3TeVOverlay_CLIC_o3_v14_CT_SelectedPandoraPFOs.root");
  TFile* file_CLIC_WW_2000_CT_wO_Selected = TFile::Open("/eos/user/w/weberma2/data/JetAnalyzerFiles/181011_gcc62/JetStudy_WW2000_11573_3TeVOverlay_CLIC_o3_v14_CT_LooseSelectedPandoraPFOs.root");
  TFile* file_CLIC_WW_2000_CT_wO_allPFOs = TFile::Open("/eos/user/w/weberma2/data/JetAnalyzerFiles/181011_gcc62/JetStudy_WW2000_11573_3TeVOverlay_CLIC_o3_v14_CT_PandoraPFOs.root");
  
  TFile* file_CLIC_ZZ_250_CT = TFile::Open("/eos/user/w/weberma2/data/JetAnalyzerFiles/181011_gcc62/JetStudy_ZZ250_11576_noOverlay_CLIC_o3_v14_CT_PandoraPFOs.root");
  TFile* file_CLIC_ZZ_250_CT_wO = TFile::Open("/eos/user/w/weberma2/data/JetAnalyzerFiles/181011_gcc62/JetStudy_ZZ250_11577_3TeVOverlay_CLIC_o3_v14_CT_TightSelectedPandoraPFOs.root");
  TFile* file_CLIC_ZZ_500_CT    = TFile::Open("/eos/user/w/weberma2/data/JetAnalyzerFiles/181011_gcc62/JetStudy_ZZ500_11580_noOverlay_CLIC_o3_v14_CT_PandoraPFOs.root");
  TFile* file_CLIC_ZZ_500_CT_wO = TFile::Open("/eos/user/w/weberma2/data/JetAnalyzerFiles/181011_gcc62/JetStudy_ZZ500_11581_3TeVOverlay_CLIC_o3_v14_CT_TightSelectedPandoraPFOs.root");
  
  TFile* file_CLIC_ZZ_1000_CT = TFile::Open("/eos/user/w/weberma2/data/JetAnalyzerFiles/181011_gcc62/JetStudy_ZZ1000_11584_noOverlay_CLIC_o3_v14_CT_PandoraPFOs.root");
  TFile* file_CLIC_ZZ_1000_CT_wO = TFile::Open("/eos/user/w/weberma2/data/JetAnalyzerFiles/181011_gcc62/JetStudy_ZZ1000_11585_3TeVOverlay_CLIC_o3_v14_CT_TightSelectedPandoraPFOs.root");
  TFile* file_CLIC_ZZ_2000_CT = TFile::Open("/eos/user/w/weberma2/data/JetAnalyzerFiles/181011_gcc62/JetStudy_ZZ2000_11588_noOverlay_CLIC_o3_v14_CT_PandoraPFOs.root");
  TFile* file_CLIC_ZZ_2000_CT_wO = TFile::Open("/eos/user/w/weberma2/data/JetAnalyzerFiles/181011_gcc62/JetStudy_ZZ2000_11589_3TeVOverlay_CLIC_o3_v14_CT_TightSelectedPandoraPFOs.root");
  

  TFile* file_CLIC_WW_250_CT_wO_380_Loose = TFile::Open("/eos/user/w/weberma2/data/JetAnalyzerFiles/181011_gcc62/JetStudy_WW250_11608_380GeVOverlay_CLIC_o3_v14_CT_LE_LooseSelectedPandoraPFOs.root");
  TFile* file_CLIC_ZZ_250_CT_wO_380_Loose = TFile::Open("/eos/user/w/weberma2/data/JetAnalyzerFiles/181011_gcc62/JetStudy_ZZ250_11610_380GeVOverlay_CLIC_o3_v14_CT_LE_LooseSelectedPandoraPFOs.root");

  TFile* file_noOverlay = TFile::Open("/eos/user/w/weberma2/data/ttbarMacroFiles/181101_gcc62/photonStudy_tt3000_11795_noOverlay_CLIC_o3_v14_AllMCInfo_ElMu_fromW_PandoraPFOs_real.root");
  TFile* file_OverlayTight = TFile::Open("/eos/user/w/weberma2/data/ttbarMacroFiles/181101_gcc62/photonStudy_tt3000_11796_3TeVOverlay_CLIC_o3_v14_AllMCInfo_ElMu_fromW_TightSelectedPandoraPFOs_real.root");
  TFile* file_OverlaySelected = TFile::Open("/eos/user/w/weberma2/data/ttbarMacroFiles/181101_gcc62/photonStudy_tt3000_11796_3TeVOverlay_CLIC_o3_v14_AllMCInfo_ElMu_fromW_SelectedPandoraPFOs_real.root");
  TFile* file_OverlayLoose = TFile::Open("/eos/user/w/weberma2/data/ttbarMacroFiles/181101_gcc62/photonStudy_tt3000_11796_3TeVOverlay_CLIC_o3_v14_AllMCInfo_ElMu_fromW_LooseSelectedPandoraPFOs_real.root");
  TFile* file_OverlayAll = TFile::Open("/eos/user/w/weberma2/data/ttbarMacroFiles/181101_gcc62/photonStudy_tt3000_11796_3TeVOverlay_CLIC_o3_v14_AllMCInfo_ElMu_fromW_PandoraPFOs_real.root");

  TFile* file_CLIC_100_CT_EC_Erat99_allSamples_SC=TFile::Open("/eos/user/w/weberma2/data/JetAnalyzerFiles/181101_gcc62/SWCAllDetector_allSamples_nPFO_1/JetStudy_Zuds100_12954_noOverlay_CLIC_o3_v14_CT_PandoraPFOs.root");
  TFile* file_CLIC_200_CT_EC_Erat99_allSamples_SC=TFile::Open("/eos/user/w/weberma2/data/JetAnalyzerFiles/181101_gcc62/SWCAllDetector_allSamples_nPFO_1/JetStudy_Zuds200_12955_noOverlay_CLIC_o3_v14_CT_PandoraPFOs.root");
  TFile* file_CLIC_500_CT_EC_Erat99_allSamples_SC=TFile::Open("/eos/user/w/weberma2/data/JetAnalyzerFiles/181101_gcc62/SWCAllDetector_allSamples_nPFO_1/JetStudy_Zuds500_12956_noOverlay_CLIC_o3_v14_CT_PandoraPFOs.root");
  TFile* file_CLIC_1500_CT_EC_Erat99_allSamples_SC=TFile::Open("/eos/user/w/weberma2/data/JetAnalyzerFiles/181101_gcc62/SWCAllDetector_allSamples_nPFO_1/JetStudy_Zuds1500_12959_noOverlay_CLIC_o3_v14_CT_PandoraPFOs.root"); 
  TFile* file_CLIC_3000_CT_EC_Erat99_allSamples_SC=TFile::Open("/eos/user/w/weberma2/data/JetAnalyzerFiles/181101_gcc62/SWCAllDetector_allSamples_nPFO_1/JetStudy_Zuds3000_12957_noOverlay_CLIC_o3_v14_CT_PandoraPFOs.root");


  TFile* file_histogram=new TFile(final_histo_name,"recreate");

  unsigned int n_bins100=300;
  int n_binsJER = 200;
  int n_binsJER_FW = 100;
  float lim_E_rel_low=0;
  float lim_E_rel_high=3.00;

  float lim_angleDeg=25.00;

  int firstbin=59;
  

  TH1F* h_100_CT_genjet03_dphi_j1j2 =  new TH1F("h_100_CT_genjet03_dphi_j1j2","", n_bins100, 0.5,TMath::Pi());
  TH1F* h_100_CT_genjet03_E1_E2_over_E_True =  new TH1F("h_100_CT_genjet03_E1_E2_over_E_True","", n_bins100, 0.5,1.00);
  TH1F* h_100_CT_genjet03_Delta_E1_E2_over_E12 =  new TH1F("h_100_CT_genjet03_Delta_E1_E2_over_E12","", n_bins100, -0.5,0.5);
  TH1F* h_100_CT_genjet04_dphi_j1j2 =  new TH1F("h_100_CT_genjet04_dphi_j1j2","", n_bins100, 0.5,TMath::Pi());
  TH1F* h_100_CT_genjet04_E1_E2_over_E_True =  new TH1F("h_100_CT_genjet04_E1_E2_over_E_True","", n_bins100, 0.5,1.00);
  TH1F* h_100_CT_genjet04_Delta_E1_E2_over_E12 =  new TH1F("h_100_CT_genjet04_Delta_E1_E2_over_E12","", n_bins100, -0.5,0.5);
  TH1F* h_100_CT_genjet05_dphi_j1j2 =  new TH1F("h_100_CT_genjet05_dphi_j1j2","", n_bins100, 0.5,TMath::Pi());
  TH1F* h_100_CT_genjet05_E1_E2_over_E_True =  new TH1F("h_100_CT_genjet05_E1_E2_over_E_True","", n_bins100, 0.5,1.00);
  TH1F* h_100_CT_genjet05_Delta_E1_E2_over_E12 =  new TH1F("h_100_CT_genjet05_Delta_E1_E2_over_E12","", n_bins100, -0.5,0.5);
  TH1F* h_100_CT_genjet06_dphi_j1j2 =  new TH1F("h_100_CT_genjet06_dphi_j1j2","", n_bins100, 0.5,TMath::Pi());
  TH1F* h_100_CT_genjet06_E1_E2_over_E_True =  new TH1F("h_100_CT_genjet06_E1_E2_over_E_True","", n_bins100, 0.5,1.00);
  TH1F* h_100_CT_genjet06_Delta_E1_E2_over_E12 =  new TH1F("h_100_CT_genjet06_Delta_E1_E2_over_E12","", n_bins100, -0.5,0.5);
  TH1F* h_100_CT_genjet07_dphi_j1j2 =  new TH1F("h_100_CT_genjet07_dphi_j1j2","", n_bins100, 0.5,TMath::Pi());
  TH1F* h_100_CT_genjet07_E1_E2_over_E_True =  new TH1F("h_100_CT_genjet07_E1_E2_over_E_True","", n_bins100, 0.5,1.00);
  TH1F* h_100_CT_genjet07_Delta_E1_E2_over_E12 =  new TH1F("h_100_CT_genjet07_Delta_E1_E2_over_E12","", n_bins100, -0.5,0.5);
  TH1F* h_100_CT_genjet08_dphi_j1j2 =  new TH1F("h_100_CT_genjet08_dphi_j1j2","", n_bins100, 0.5,TMath::Pi());
  TH1F* h_100_CT_genjet08_E1_E2_over_E_True =  new TH1F("h_100_CT_genjet08_E1_E2_over_E_True","", n_bins100, 0.5,1.00);
  TH1F* h_100_CT_genjet08_Delta_E1_E2_over_E12 =  new TH1F("h_100_CT_genjet08_Delta_E1_E2_over_E12","", n_bins100, -0.5,0.5);
  TH1F* h_100_CT_genjet09_dphi_j1j2 =  new TH1F("h_100_CT_genjet09_dphi_j1j2","", n_bins100, 0.5,TMath::Pi());
  TH1F* h_100_CT_genjet09_E1_E2_over_E_True =  new TH1F("h_100_CT_genjet09_E1_E2_over_E_True","", n_bins100, 0.5,1.00);
  TH1F* h_100_CT_genjet09_Delta_E1_E2_over_E12 =  new TH1F("h_100_CT_genjet09_Delta_E1_E2_over_E12","", n_bins100, -0.5,0.5);
  TH1F* h_100_CT_genjet10_dphi_j1j2 =  new TH1F("h_100_CT_genjet10_dphi_j1j2","", n_bins100, 0.5,TMath::Pi());
  TH1F* h_100_CT_genjet10_E1_E2_over_E_True =  new TH1F("h_100_CT_genjet10_E1_E2_over_E_True","", n_bins100, 0.5,1.00);
  TH1F* h_100_CT_genjet10_Delta_E1_E2_over_E12 =  new TH1F("h_100_CT_genjet10_Delta_E1_E2_over_E12","", n_bins100, -0.5,0.5);

  TH1F* h_100_CT_recojet03_dphi_j1j2 =  new TH1F("h_100_CT_recojet03_dphi_j1j2","", n_bins100, 0.5,TMath::Pi());
  TH1F* h_100_CT_recojet03_E1_E2_over_E_True =  new TH1F("h_100_CT_recojet03_E1_E2_over_E_True","", n_bins100, 0.5,1.00);
  TH1F* h_100_CT_recojet03_Delta_E1_E2_over_E12 =  new TH1F("h_100_CT_recojet03_Delta_E1_E2_over_E12","", n_bins100, -0.5,0.5);
  TH1F* h_100_CT_recojet04_dphi_j1j2 =  new TH1F("h_100_CT_recojet04_dphi_j1j2","", n_bins100, 0.5,TMath::Pi());
  TH1F* h_100_CT_recojet04_E1_E2_over_E_True =  new TH1F("h_100_CT_recojet04_E1_E2_over_E_True","", n_bins100, 0.5,1.00);
  TH1F* h_100_CT_recojet04_Delta_E1_E2_over_E12 =  new TH1F("h_100_CT_recojet04_Delta_E1_E2_over_E12","", n_bins100, -0.5,0.5);
  TH1F* h_100_CT_recojet05_dphi_j1j2 =  new TH1F("h_100_CT_recojet05_dphi_j1j2","", n_bins100, 0.5,TMath::Pi());
  TH1F* h_100_CT_recojet05_E1_E2_over_E_True =  new TH1F("h_100_CT_recojet05_E1_E2_over_E_True","", n_bins100, 0.5,1.00);
  TH1F* h_100_CT_recojet05_Delta_E1_E2_over_E12 =  new TH1F("h_100_CT_recojet05_Delta_E1_E2_over_E12","", n_bins100, -0.5,0.5);
  TH1F* h_100_CT_recojet06_dphi_j1j2 =  new TH1F("h_100_CT_recojet06_dphi_j1j2","", n_bins100, 0.5,TMath::Pi());
  TH1F* h_100_CT_recojet06_E1_E2_over_E_True =  new TH1F("h_100_CT_recojet06_E1_E2_over_E_True","", n_bins100, 0.5,1.00);
  TH1F* h_100_CT_recojet06_Delta_E1_E2_over_E12 =  new TH1F("h_100_CT_recojet06_Delta_E1_E2_over_E12","", n_bins100, -0.5,0.5);
  TH1F* h_100_CT_recojet07_dphi_j1j2 =  new TH1F("h_100_CT_recojet07_dphi_j1j2","", n_bins100, 0.5,TMath::Pi());
  TH1F* h_100_CT_recojet07_E1_E2_over_E_True =  new TH1F("h_100_CT_recojet07_E1_E2_over_E_True","", n_bins100, 0.5,1.00);
  TH1F* h_100_CT_recojet07_Delta_E1_E2_over_E12 =  new TH1F("h_100_CT_recojet07_Delta_E1_E2_over_E12","", n_bins100, -0.5,0.5);
  TH1F* h_100_CT_recojet08_dphi_j1j2 =  new TH1F("h_100_CT_recojet08_dphi_j1j2","", n_bins100, 0.5,TMath::Pi());
  TH1F* h_100_CT_recojet08_E1_E2_over_E_True =  new TH1F("h_100_CT_recojet08_E1_E2_over_E_True","", n_bins100, 0.5,1.00);
  TH1F* h_100_CT_recojet08_Delta_E1_E2_over_E12 =  new TH1F("h_100_CT_recojet08_Delta_E1_E2_over_E12","", n_bins100, -0.5,0.5);
  TH1F* h_100_CT_recojet09_dphi_j1j2 =  new TH1F("h_100_CT_recojet09_dphi_j1j2","", n_bins100, 0.5,TMath::Pi());
  TH1F* h_100_CT_recojet09_E1_E2_over_E_True =  new TH1F("h_100_CT_recojet09_E1_E2_over_E_True","", n_bins100, 0.5,1.00);
  TH1F* h_100_CT_recojet09_Delta_E1_E2_over_E12 =  new TH1F("h_100_CT_recojet09_Delta_E1_E2_over_E12","", n_bins100, -0.5,0.5);
  TH1F* h_100_CT_recojet10_dphi_j1j2 =  new TH1F("h_100_CT_recojet10_dphi_j1j2","", n_bins100, 0.5,TMath::Pi());
  TH1F* h_100_CT_recojet10_E1_E2_over_E_True =  new TH1F("h_100_CT_recojet10_E1_E2_over_E_True","", n_bins100, 0.5,1.00);
  TH1F* h_100_CT_recojet10_Delta_E1_E2_over_E12 =  new TH1F("h_100_CT_recojet10_Delta_E1_E2_over_E12","", n_bins100, -0.5,0.5);
  TH1F* h_100_CT_recojetE_over_genjetE_DR03 =  new TH1F("h_100_CT_recojetE_over_genjetE_DR03","", n_bins100, 0.5,1.5);
  TH1F* h_100_CT_recojetE_over_genjetE_DR04 =  new TH1F("h_100_CT_recojetE_over_genjetE_DR04","", n_bins100, 0.5,1.5);
  TH1F* h_100_CT_recojetE_over_genjetE_DR05 =  new TH1F("h_100_CT_recojetE_over_genjetE_DR05","", n_bins100, 0.5,1.5);
  TH1F* h_100_CT_recojetE_over_genjetE_DR06 =  new TH1F("h_100_CT_recojetE_over_genjetE_DR06","", n_bins100, 0.5,1.5);
  TH1F* h_100_CT_recojetE_over_genjetE_DR07 =  new TH1F("h_100_CT_recojetE_over_genjetE_DR07","", n_bins100, 0.5,1.5);
  TH1F* h_100_CT_recojetE_over_genjetE_DR08 =  new TH1F("h_100_CT_recojetE_over_genjetE_DR08","", n_bins100, 0.5,1.5);
  TH1F* h_100_CT_recojetE_over_genjetE_DR09 =  new TH1F("h_100_CT_recojetE_over_genjetE_DR09","", n_bins100, 0.5,1.5);
  TH1F* h_100_CT_recojetE_over_genjetE_DR10 =  new TH1F("h_100_CT_recojetE_over_genjetE_DR10","", n_bins100, 0.5,1.5);

  TH1F* h_100_CT_dphi_gen_reco_DR05 =  new TH1F("h_100_CT_dphi_gen_reco_DR05","", n_bins100, -0.1,9.9);
  TH1F* h_100_CT_dphi_gen_reco_DR06 =  new TH1F("h_100_CT_dphi_gen_reco_DR06","", n_bins100, -0.1,9.9);
  TH1F* h_100_CT_dphi_gen_reco_DR07 =  new TH1F("h_100_CT_dphi_gen_reco_DR07","", n_bins100, -0.1,9.9);

  TH1F* h_100_CT_DR05_E_rel_totVis_RMS_d1_cosT_0_to_0_10 =  new TH1F("h_100_CT_DR05_E_rel_totVis_RMS_d1_cosT_0_to_0_10","", n_binsJER, lim_E_rel_low,lim_E_rel_high);
  TH1F* h_100_CT_DR05_E_rel_totVis_RMS_d1_cosT_0_10_to_0_20 =  new TH1F("h_100_CT_DR05_E_rel_totVis_RMS_d1_cosT_0_10_to_0_20","", n_binsJER, lim_E_rel_low,lim_E_rel_high);
  TH1F* h_100_CT_DR05_E_rel_totVis_RMS_d1_cosT_0_20_to_0_30 =  new TH1F("h_100_CT_DR05_E_rel_totVis_RMS_d1_cosT_0_20_to_0_30","", n_binsJER, lim_E_rel_low,lim_E_rel_high);
  TH1F* h_100_CT_DR05_E_rel_totVis_RMS_d1_cosT_0_30_to_0_40 =  new TH1F("h_100_CT_DR05_E_rel_totVis_RMS_d1_cosT_0_30_to_0_40","", n_binsJER, lim_E_rel_low,lim_E_rel_high);
  TH1F* h_100_CT_DR05_E_rel_totVis_RMS_d1_cosT_0_40_to_0_50 =  new TH1F("h_100_CT_DR05_E_rel_totVis_RMS_d1_cosT_0_40_to_0_50","", n_binsJER, lim_E_rel_low,lim_E_rel_high);
  TH1F* h_100_CT_DR05_E_rel_totVis_RMS_d1_cosT_0_50_to_0_60 =  new TH1F("h_100_CT_DR05_E_rel_totVis_RMS_d1_cosT_0_50_to_0_60","", n_binsJER, lim_E_rel_low,lim_E_rel_high);
  TH1F* h_100_CT_DR05_E_rel_totVis_RMS_d1_cosT_0_60_to_0_70 =  new TH1F("h_100_CT_DR05_E_rel_totVis_RMS_d1_cosT_0_60_to_0_70","", n_binsJER, lim_E_rel_low,lim_E_rel_high);
  TH1F* h_100_CT_DR05_E_rel_totVis_RMS_d1_cosT_0_70_to_0_80 =  new TH1F("h_100_CT_DR05_E_rel_totVis_RMS_d1_cosT_0_70_to_0_80","", n_binsJER, lim_E_rel_low,lim_E_rel_high);
  TH1F* h_100_CT_DR05_E_rel_totVis_RMS_d1_cosT_0_80_to_0_90 =  new TH1F("h_100_CT_DR05_E_rel_totVis_RMS_d1_cosT_0_80_to_0_90","", n_binsJER, lim_E_rel_low,lim_E_rel_high);
  TH1F* h_100_CT_DR05_E_rel_totVis_RMS_d1_cosT_0_900_to_0_925 =  new TH1F("h_100_CT_DR05_E_rel_totVis_RMS_d1_cosT_0_900_to_0_925","", n_binsJER_FW, lim_E_rel_low,lim_E_rel_high);
  TH1F* h_100_CT_DR05_E_rel_totVis_RMS_d1_cosT_0_925_to_0_950 =  new TH1F("h_100_CT_DR05_E_rel_totVis_RMS_d1_cosT_0_925_to_0_950","", n_binsJER_FW, lim_E_rel_low,lim_E_rel_high);
  TH1F* h_100_CT_DR05_E_rel_totVis_RMS_d1_cosT_0_950_to_0_975 =  new TH1F("h_100_CT_DR05_E_rel_totVis_RMS_d1_cosT_0_950_to_0_975","", n_binsJER_FW, lim_E_rel_low,lim_E_rel_high);
  TH1F* h_100_CT_DR05_E_rel_totVis_RMS_d1_cosT_0_975_to_1_00 =  new TH1F("h_100_CT_DR05_E_rel_totVis_RMS_d1_cosT_0_975_to_1_00","", n_binsJER_FW, lim_E_rel_low,lim_E_rel_high);

  TH1F* h_100_CT_DR06_E_rel_totVis_RMS_d1_cosT_0_to_0_10 =  new TH1F("h_100_CT_DR06_E_rel_totVis_RMS_d1_cosT_0_to_0_10","", n_binsJER, lim_E_rel_low,lim_E_rel_high);
  TH1F* h_100_CT_DR06_E_rel_totVis_RMS_d1_cosT_0_10_to_0_20 =  new TH1F("h_100_CT_DR06_E_rel_totVis_RMS_d1_cosT_0_10_to_0_20","", n_binsJER, lim_E_rel_low,lim_E_rel_high);
  TH1F* h_100_CT_DR06_E_rel_totVis_RMS_d1_cosT_0_20_to_0_30 =  new TH1F("h_100_CT_DR06_E_rel_totVis_RMS_d1_cosT_0_20_to_0_30","", n_binsJER, lim_E_rel_low,lim_E_rel_high);
  TH1F* h_100_CT_DR06_E_rel_totVis_RMS_d1_cosT_0_30_to_0_40 =  new TH1F("h_100_CT_DR06_E_rel_totVis_RMS_d1_cosT_0_30_to_0_40","", n_binsJER, lim_E_rel_low,lim_E_rel_high);
  TH1F* h_100_CT_DR06_E_rel_totVis_RMS_d1_cosT_0_40_to_0_50 =  new TH1F("h_100_CT_DR06_E_rel_totVis_RMS_d1_cosT_0_40_to_0_50","", n_binsJER, lim_E_rel_low,lim_E_rel_high);
  TH1F* h_100_CT_DR06_E_rel_totVis_RMS_d1_cosT_0_50_to_0_60 =  new TH1F("h_100_CT_DR06_E_rel_totVis_RMS_d1_cosT_0_50_to_0_60","", n_binsJER, lim_E_rel_low,lim_E_rel_high);
  TH1F* h_100_CT_DR06_E_rel_totVis_RMS_d1_cosT_0_60_to_0_70 =  new TH1F("h_100_CT_DR06_E_rel_totVis_RMS_d1_cosT_0_60_to_0_70","", n_binsJER, lim_E_rel_low,lim_E_rel_high);
  TH1F* h_100_CT_DR06_E_rel_totVis_RMS_d1_cosT_0_70_to_0_80 =  new TH1F("h_100_CT_DR06_E_rel_totVis_RMS_d1_cosT_0_70_to_0_80","", n_binsJER, lim_E_rel_low,lim_E_rel_high);
  TH1F* h_100_CT_DR06_E_rel_totVis_RMS_d1_cosT_0_80_to_0_90 =  new TH1F("h_100_CT_DR06_E_rel_totVis_RMS_d1_cosT_0_80_to_0_90","", n_binsJER, lim_E_rel_low,lim_E_rel_high);
  TH1F* h_100_CT_DR06_E_rel_totVis_RMS_d1_cosT_0_900_to_0_925 =  new TH1F("h_100_CT_DR06_E_rel_totVis_RMS_d1_cosT_0_900_to_0_925","", n_binsJER_FW, lim_E_rel_low,lim_E_rel_high);
  TH1F* h_100_CT_DR06_E_rel_totVis_RMS_d1_cosT_0_925_to_0_950 =  new TH1F("h_100_CT_DR06_E_rel_totVis_RMS_d1_cosT_0_925_to_0_950","", n_binsJER_FW, lim_E_rel_low,lim_E_rel_high);
  TH1F* h_100_CT_DR06_E_rel_totVis_RMS_d1_cosT_0_950_to_0_975 =  new TH1F("h_100_CT_DR06_E_rel_totVis_RMS_d1_cosT_0_950_to_0_975","", n_binsJER_FW, lim_E_rel_low,lim_E_rel_high);
  TH1F* h_100_CT_DR06_E_rel_totVis_RMS_d1_cosT_0_975_to_1_00 =  new TH1F("h_100_CT_DR06_E_rel_totVis_RMS_d1_cosT_0_975_to_1_00","", n_binsJER_FW, lim_E_rel_low,lim_E_rel_high);

  TH1F* h_100_CT_DR07_E_rel_totVis_RMS_d1_cosT_0_to_0_10 =  new TH1F("h_100_CT_DR07_E_rel_totVis_RMS_d1_cosT_0_to_0_10","", n_binsJER, lim_E_rel_low,lim_E_rel_high);
  TH1F* h_100_CT_DR07_E_rel_totVis_RMS_d1_cosT_0_10_to_0_20 =  new TH1F("h_100_CT_DR07_E_rel_totVis_RMS_d1_cosT_0_10_to_0_20","", n_binsJER, lim_E_rel_low,lim_E_rel_high);
  TH1F* h_100_CT_DR07_E_rel_totVis_RMS_d1_cosT_0_20_to_0_30 =  new TH1F("h_100_CT_DR07_E_rel_totVis_RMS_d1_cosT_0_20_to_0_30","", n_binsJER, lim_E_rel_low,lim_E_rel_high);
  TH1F* h_100_CT_DR07_E_rel_totVis_RMS_d1_cosT_0_30_to_0_40 =  new TH1F("h_100_CT_DR07_E_rel_totVis_RMS_d1_cosT_0_30_to_0_40","", n_binsJER, lim_E_rel_low,lim_E_rel_high);
  TH1F* h_100_CT_DR07_E_rel_totVis_RMS_d1_cosT_0_40_to_0_50 =  new TH1F("h_100_CT_DR07_E_rel_totVis_RMS_d1_cosT_0_40_to_0_50","", n_binsJER, lim_E_rel_low,lim_E_rel_high);
  TH1F* h_100_CT_DR07_E_rel_totVis_RMS_d1_cosT_0_50_to_0_60 =  new TH1F("h_100_CT_DR07_E_rel_totVis_RMS_d1_cosT_0_50_to_0_60","", n_binsJER, lim_E_rel_low,lim_E_rel_high);
  TH1F* h_100_CT_DR07_E_rel_totVis_RMS_d1_cosT_0_60_to_0_70 =  new TH1F("h_100_CT_DR07_E_rel_totVis_RMS_d1_cosT_0_60_to_0_70","", n_binsJER, lim_E_rel_low,lim_E_rel_high);
  TH1F* h_100_CT_DR07_E_rel_totVis_RMS_d1_cosT_0_70_to_0_80 =  new TH1F("h_100_CT_DR07_E_rel_totVis_RMS_d1_cosT_0_70_to_0_80","", n_binsJER, lim_E_rel_low,lim_E_rel_high);
  TH1F* h_100_CT_DR07_E_rel_totVis_RMS_d1_cosT_0_80_to_0_90 =  new TH1F("h_100_CT_DR07_E_rel_totVis_RMS_d1_cosT_0_80_to_0_90","", n_binsJER, lim_E_rel_low,lim_E_rel_high);
  TH1F* h_100_CT_DR07_E_rel_totVis_RMS_d1_cosT_0_900_to_0_925 =  new TH1F("h_100_CT_DR07_E_rel_totVis_RMS_d1_cosT_0_900_to_0_925","", n_binsJER_FW, lim_E_rel_low,lim_E_rel_high);
  TH1F* h_100_CT_DR07_E_rel_totVis_RMS_d1_cosT_0_925_to_0_950 =  new TH1F("h_100_CT_DR07_E_rel_totVis_RMS_d1_cosT_0_925_to_0_950","", n_binsJER_FW, lim_E_rel_low,lim_E_rel_high);
  TH1F* h_100_CT_DR07_E_rel_totVis_RMS_d1_cosT_0_950_to_0_975 =  new TH1F("h_100_CT_DR07_E_rel_totVis_RMS_d1_cosT_0_950_to_0_975","", n_binsJER_FW, lim_E_rel_low,lim_E_rel_high);
  TH1F* h_100_CT_DR07_E_rel_totVis_RMS_d1_cosT_0_975_to_1_00 =  new TH1F("h_100_CT_DR07_E_rel_totVis_RMS_d1_cosT_0_975_to_1_00","", n_binsJER_FW, lim_E_rel_low,lim_E_rel_high);

  TH1F* h_100_CT_DR08_E_rel_totVis_RMS_d1_cosT_0_to_0_10 =  new TH1F("h_100_CT_DR08_E_rel_totVis_RMS_d1_cosT_0_to_0_10","", n_binsJER, lim_E_rel_low,lim_E_rel_high);
  TH1F* h_100_CT_DR08_E_rel_totVis_RMS_d1_cosT_0_10_to_0_20 =  new TH1F("h_100_CT_DR08_E_rel_totVis_RMS_d1_cosT_0_10_to_0_20","", n_binsJER, lim_E_rel_low,lim_E_rel_high);
  TH1F* h_100_CT_DR08_E_rel_totVis_RMS_d1_cosT_0_20_to_0_30 =  new TH1F("h_100_CT_DR08_E_rel_totVis_RMS_d1_cosT_0_20_to_0_30","", n_binsJER, lim_E_rel_low,lim_E_rel_high);
  TH1F* h_100_CT_DR08_E_rel_totVis_RMS_d1_cosT_0_30_to_0_40 =  new TH1F("h_100_CT_DR08_E_rel_totVis_RMS_d1_cosT_0_30_to_0_40","", n_binsJER, lim_E_rel_low,lim_E_rel_high);
  TH1F* h_100_CT_DR08_E_rel_totVis_RMS_d1_cosT_0_40_to_0_50 =  new TH1F("h_100_CT_DR08_E_rel_totVis_RMS_d1_cosT_0_40_to_0_50","", n_binsJER, lim_E_rel_low,lim_E_rel_high);
  TH1F* h_100_CT_DR08_E_rel_totVis_RMS_d1_cosT_0_50_to_0_60 =  new TH1F("h_100_CT_DR08_E_rel_totVis_RMS_d1_cosT_0_50_to_0_60","", n_binsJER, lim_E_rel_low,lim_E_rel_high);
  TH1F* h_100_CT_DR08_E_rel_totVis_RMS_d1_cosT_0_60_to_0_70 =  new TH1F("h_100_CT_DR08_E_rel_totVis_RMS_d1_cosT_0_60_to_0_70","", n_binsJER, lim_E_rel_low,lim_E_rel_high);
  TH1F* h_100_CT_DR08_E_rel_totVis_RMS_d1_cosT_0_70_to_0_80 =  new TH1F("h_100_CT_DR08_E_rel_totVis_RMS_d1_cosT_0_70_to_0_80","", n_binsJER, lim_E_rel_low,lim_E_rel_high);
  TH1F* h_100_CT_DR08_E_rel_totVis_RMS_d1_cosT_0_80_to_0_90 =  new TH1F("h_100_CT_DR08_E_rel_totVis_RMS_d1_cosT_0_80_to_0_90","", n_binsJER, lim_E_rel_low,lim_E_rel_high);
  TH1F* h_100_CT_DR08_E_rel_totVis_RMS_d1_cosT_0_900_to_0_925 =  new TH1F("h_100_CT_DR08_E_rel_totVis_RMS_d1_cosT_0_900_to_0_925","", n_binsJER_FW, lim_E_rel_low,lim_E_rel_high);
  TH1F* h_100_CT_DR08_E_rel_totVis_RMS_d1_cosT_0_925_to_0_950 =  new TH1F("h_100_CT_DR08_E_rel_totVis_RMS_d1_cosT_0_925_to_0_950","", n_binsJER_FW, lim_E_rel_low,lim_E_rel_high);
  TH1F* h_100_CT_DR08_E_rel_totVis_RMS_d1_cosT_0_950_to_0_975 =  new TH1F("h_100_CT_DR08_E_rel_totVis_RMS_d1_cosT_0_950_to_0_975","", n_binsJER_FW, lim_E_rel_low,lim_E_rel_high);
  TH1F* h_100_CT_DR08_E_rel_totVis_RMS_d1_cosT_0_975_to_1_00 =  new TH1F("h_100_CT_DR08_E_rel_totVis_RMS_d1_cosT_0_975_to_1_00","", n_binsJER_FW, lim_E_rel_low,lim_E_rel_high);

  TH1F* h_100_CT_DR09_E_rel_totVis_RMS_d1_cosT_0_to_0_10 =  new TH1F("h_100_CT_DR09_E_rel_totVis_RMS_d1_cosT_0_to_0_10","", n_binsJER, lim_E_rel_low,lim_E_rel_high);
  TH1F* h_100_CT_DR09_E_rel_totVis_RMS_d1_cosT_0_10_to_0_20 =  new TH1F("h_100_CT_DR09_E_rel_totVis_RMS_d1_cosT_0_10_to_0_20","", n_binsJER, lim_E_rel_low,lim_E_rel_high);
  TH1F* h_100_CT_DR09_E_rel_totVis_RMS_d1_cosT_0_20_to_0_30 =  new TH1F("h_100_CT_DR09_E_rel_totVis_RMS_d1_cosT_0_20_to_0_30","", n_binsJER, lim_E_rel_low,lim_E_rel_high);
  TH1F* h_100_CT_DR09_E_rel_totVis_RMS_d1_cosT_0_30_to_0_40 =  new TH1F("h_100_CT_DR09_E_rel_totVis_RMS_d1_cosT_0_30_to_0_40","", n_binsJER, lim_E_rel_low,lim_E_rel_high);
  TH1F* h_100_CT_DR09_E_rel_totVis_RMS_d1_cosT_0_40_to_0_50 =  new TH1F("h_100_CT_DR09_E_rel_totVis_RMS_d1_cosT_0_40_to_0_50","", n_binsJER, lim_E_rel_low,lim_E_rel_high);
  TH1F* h_100_CT_DR09_E_rel_totVis_RMS_d1_cosT_0_50_to_0_60 =  new TH1F("h_100_CT_DR09_E_rel_totVis_RMS_d1_cosT_0_50_to_0_60","", n_binsJER, lim_E_rel_low,lim_E_rel_high);
  TH1F* h_100_CT_DR09_E_rel_totVis_RMS_d1_cosT_0_60_to_0_70 =  new TH1F("h_100_CT_DR09_E_rel_totVis_RMS_d1_cosT_0_60_to_0_70","", n_binsJER, lim_E_rel_low,lim_E_rel_high);
  TH1F* h_100_CT_DR09_E_rel_totVis_RMS_d1_cosT_0_70_to_0_80 =  new TH1F("h_100_CT_DR09_E_rel_totVis_RMS_d1_cosT_0_70_to_0_80","", n_binsJER, lim_E_rel_low,lim_E_rel_high);
  TH1F* h_100_CT_DR09_E_rel_totVis_RMS_d1_cosT_0_80_to_0_90 =  new TH1F("h_100_CT_DR09_E_rel_totVis_RMS_d1_cosT_0_80_to_0_90","", n_binsJER, lim_E_rel_low,lim_E_rel_high);
  TH1F* h_100_CT_DR09_E_rel_totVis_RMS_d1_cosT_0_900_to_0_925 =  new TH1F("h_100_CT_DR09_E_rel_totVis_RMS_d1_cosT_0_900_to_0_925","", n_binsJER_FW, lim_E_rel_low,lim_E_rel_high);
  TH1F* h_100_CT_DR09_E_rel_totVis_RMS_d1_cosT_0_925_to_0_950 =  new TH1F("h_100_CT_DR09_E_rel_totVis_RMS_d1_cosT_0_925_to_0_950","", n_binsJER_FW, lim_E_rel_low,lim_E_rel_high);
  TH1F* h_100_CT_DR09_E_rel_totVis_RMS_d1_cosT_0_950_to_0_975 =  new TH1F("h_100_CT_DR09_E_rel_totVis_RMS_d1_cosT_0_950_to_0_975","", n_binsJER_FW, lim_E_rel_low,lim_E_rel_high);
  TH1F* h_100_CT_DR09_E_rel_totVis_RMS_d1_cosT_0_975_to_1_00 =  new TH1F("h_100_CT_DR09_E_rel_totVis_RMS_d1_cosT_0_975_to_1_00","", n_binsJER_FW, lim_E_rel_low,lim_E_rel_high);

  TH1F* h_100_CT_DR10_E_rel_totVis_RMS_d1_cosT_0_to_0_10 =  new TH1F("h_100_CT_DR10_E_rel_totVis_RMS_d1_cosT_0_to_0_10","", n_binsJER, lim_E_rel_low,lim_E_rel_high);
  TH1F* h_100_CT_DR10_E_rel_totVis_RMS_d1_cosT_0_10_to_0_20 =  new TH1F("h_100_CT_DR10_E_rel_totVis_RMS_d1_cosT_0_10_to_0_20","", n_binsJER, lim_E_rel_low,lim_E_rel_high);
  TH1F* h_100_CT_DR10_E_rel_totVis_RMS_d1_cosT_0_20_to_0_30 =  new TH1F("h_100_CT_DR10_E_rel_totVis_RMS_d1_cosT_0_20_to_0_30","", n_binsJER, lim_E_rel_low,lim_E_rel_high);
  TH1F* h_100_CT_DR10_E_rel_totVis_RMS_d1_cosT_0_30_to_0_40 =  new TH1F("h_100_CT_DR10_E_rel_totVis_RMS_d1_cosT_0_30_to_0_40","", n_binsJER, lim_E_rel_low,lim_E_rel_high);
  TH1F* h_100_CT_DR10_E_rel_totVis_RMS_d1_cosT_0_40_to_0_50 =  new TH1F("h_100_CT_DR10_E_rel_totVis_RMS_d1_cosT_0_40_to_0_50","", n_binsJER, lim_E_rel_low,lim_E_rel_high);
  TH1F* h_100_CT_DR10_E_rel_totVis_RMS_d1_cosT_0_50_to_0_60 =  new TH1F("h_100_CT_DR10_E_rel_totVis_RMS_d1_cosT_0_50_to_0_60","", n_binsJER, lim_E_rel_low,lim_E_rel_high);
  TH1F* h_100_CT_DR10_E_rel_totVis_RMS_d1_cosT_0_60_to_0_70 =  new TH1F("h_100_CT_DR10_E_rel_totVis_RMS_d1_cosT_0_60_to_0_70","", n_binsJER, lim_E_rel_low,lim_E_rel_high);
  TH1F* h_100_CT_DR10_E_rel_totVis_RMS_d1_cosT_0_70_to_0_80 =  new TH1F("h_100_CT_DR10_E_rel_totVis_RMS_d1_cosT_0_70_to_0_80","", n_binsJER, lim_E_rel_low,lim_E_rel_high);
  TH1F* h_100_CT_DR10_E_rel_totVis_RMS_d1_cosT_0_80_to_0_90 =  new TH1F("h_100_CT_DR10_E_rel_totVis_RMS_d1_cosT_0_80_to_0_90","", n_binsJER, lim_E_rel_low,lim_E_rel_high);
  TH1F* h_100_CT_DR10_E_rel_totVis_RMS_d1_cosT_0_900_to_0_925 =  new TH1F("h_100_CT_DR10_E_rel_totVis_RMS_d1_cosT_0_900_to_0_925","", n_binsJER_FW, lim_E_rel_low,lim_E_rel_high);
  TH1F* h_100_CT_DR10_E_rel_totVis_RMS_d1_cosT_0_925_to_0_950 =  new TH1F("h_100_CT_DR10_E_rel_totVis_RMS_d1_cosT_0_925_to_0_950","", n_binsJER_FW, lim_E_rel_low,lim_E_rel_high);
  TH1F* h_100_CT_DR10_E_rel_totVis_RMS_d1_cosT_0_950_to_0_975 =  new TH1F("h_100_CT_DR10_E_rel_totVis_RMS_d1_cosT_0_950_to_0_975","", n_binsJER_FW, lim_E_rel_low,lim_E_rel_high);
  TH1F* h_100_CT_DR10_E_rel_totVis_RMS_d1_cosT_0_975_to_1_00 =  new TH1F("h_100_CT_DR10_E_rel_totVis_RMS_d1_cosT_0_975_to_1_00","", n_binsJER_FW, lim_E_rel_low,lim_E_rel_high);

  TH1F* h_100_CT_DR05_dphi_reco_gen_cosTheta_0_65 =  new TH1F("h_100_CT_DR05_dphi_reco_gen_cosTheta_0_65","", n_bins100, -lim_angleDeg,lim_angleDeg);
  TH1F* h_100_CT_DR05_dtheta_reco_gen_cosTheta_0_65 =  new TH1F("h_100_CT_DR05_dtheta_reco_gen_cosTheta_0_65","", n_bins100, -lim_angleDeg,lim_angleDeg);
  TH1F* h_100_CT_DR05_dphi_reco_gen_cosTheta_0_65_to_0_80 =  new TH1F("h_100_CT_DR05_dphi_reco_gen_cosTheta_0_65_to_0_80","", n_bins100, -lim_angleDeg,lim_angleDeg);
  TH1F* h_100_CT_DR05_dtheta_reco_gen_cosTheta_0_65_to_0_80 =  new TH1F("h_100_CT_DR05_dtheta_reco_gen_cosTheta_0_65_to_0_80","", n_bins100, -lim_angleDeg,lim_angleDeg);
  TH1F* h_100_CT_DR05_dphi_reco_gen_cosTheta_0_80_to_0_925 =  new TH1F("h_100_CT_DR05_dphi_reco_gen_cosTheta_0_80_to_0_925","", n_bins100, -lim_angleDeg,lim_angleDeg);
  TH1F* h_100_CT_DR05_dtheta_reco_gen_cosTheta_0_80_to_0_925 =  new TH1F("h_100_CT_DR05_dtheta_reco_gen_cosTheta_0_80_to_0_925","", n_bins100, -lim_angleDeg,lim_angleDeg);
  TH1F* h_100_CT_DR05_dphi_reco_gen_cosTheta_0_925_to_0_975 =  new TH1F("h_100_CT_DR05_dphi_reco_gen_cosTheta_0_925_to_0_975","", n_bins100, -lim_angleDeg,lim_angleDeg);
  TH1F* h_100_CT_DR05_dtheta_reco_gen_cosTheta_0_925_to_0_975 =  new TH1F("h_100_CT_DR05_dtheta_reco_gen_cosTheta_0_925_to_0_975","", n_bins100, -lim_angleDeg,lim_angleDeg);

  TH1F* h_100_CT_DR07_dphi_reco_gen_cosTheta_0_65 =  new TH1F("h_100_CT_DR07_dphi_reco_gen_cosTheta_0_65","", n_bins100, -lim_angleDeg,lim_angleDeg);
  TH1F* h_100_CT_DR07_dtheta_reco_gen_cosTheta_0_65 =  new TH1F("h_100_CT_DR07_dtheta_reco_gen_cosTheta_0_65","", n_bins100, -lim_angleDeg,lim_angleDeg);
  TH1F* h_100_CT_DR07_dphi_reco_gen_cosTheta_0_65_to_0_80 =  new TH1F("h_100_CT_DR07_dphi_reco_gen_cosTheta_0_65_to_0_80","", n_bins100, -lim_angleDeg,lim_angleDeg);
  TH1F* h_100_CT_DR07_dtheta_reco_gen_cosTheta_0_65_to_0_80 =  new TH1F("h_100_CT_DR07_dtheta_reco_gen_cosTheta_0_65_to_0_80","", n_bins100, -lim_angleDeg,lim_angleDeg);
  TH1F* h_100_CT_DR07_dphi_reco_gen_cosTheta_0_80_to_0_925 =  new TH1F("h_100_CT_DR07_dphi_reco_gen_cosTheta_0_80_to_0_925","", n_bins100, -lim_angleDeg,lim_angleDeg);
  TH1F* h_100_CT_DR07_dtheta_reco_gen_cosTheta_0_80_to_0_925 =  new TH1F("h_100_CT_DR07_dtheta_reco_gen_cosTheta_0_80_to_0_925","", n_bins100, -lim_angleDeg,lim_angleDeg);
  TH1F* h_100_CT_DR07_dphi_reco_gen_cosTheta_0_925_to_0_975 =  new TH1F("h_100_CT_DR07_dphi_reco_gen_cosTheta_0_925_to_0_975","", n_bins100, -lim_angleDeg,lim_angleDeg);
  TH1F* h_100_CT_DR07_dtheta_reco_gen_cosTheta_0_925_to_0_975 =  new TH1F("h_100_CT_DR07_dtheta_reco_gen_cosTheta_0_925_to_0_975","", n_bins100, -lim_angleDeg,lim_angleDeg);

  TH1F* h_100_CT_DR10_dphi_reco_gen_cosTheta_0_65 =  new TH1F("h_100_CT_DR10_dphi_reco_gen_cosTheta_0_65","", n_bins100, -lim_angleDeg,lim_angleDeg);
  TH1F* h_100_CT_DR10_dtheta_reco_gen_cosTheta_0_65 =  new TH1F("h_100_CT_DR10_dtheta_reco_gen_cosTheta_0_65","", n_bins100, -lim_angleDeg,lim_angleDeg);
  TH1F* h_100_CT_DR10_dphi_reco_gen_cosTheta_0_65_to_0_80 =  new TH1F("h_100_CT_DR10_dphi_reco_gen_cosTheta_0_65_to_0_80","", n_bins100, -lim_angleDeg,lim_angleDeg);
  TH1F* h_100_CT_DR10_dtheta_reco_gen_cosTheta_0_65_to_0_80 =  new TH1F("h_100_CT_DR10_dtheta_reco_gen_cosTheta_0_65_to_0_80","", n_bins100, -lim_angleDeg,lim_angleDeg);
  TH1F* h_100_CT_DR10_dphi_reco_gen_cosTheta_0_80_to_0_925 =  new TH1F("h_100_CT_DR10_dphi_reco_gen_cosTheta_0_80_to_0_925","", n_bins100, -lim_angleDeg,lim_angleDeg);
  TH1F* h_100_CT_DR10_dtheta_reco_gen_cosTheta_0_80_to_0_925 =  new TH1F("h_100_CT_DR10_dtheta_reco_gen_cosTheta_0_80_to_0_925","", n_bins100, -lim_angleDeg,lim_angleDeg);
  TH1F* h_100_CT_DR10_dphi_reco_gen_cosTheta_0_925_to_0_975 =  new TH1F("h_100_CT_DR10_dphi_reco_gen_cosTheta_0_925_to_0_975","", n_bins100, -lim_angleDeg,lim_angleDeg);
  TH1F* h_100_CT_DR10_dtheta_reco_gen_cosTheta_0_925_to_0_975 =  new TH1F("h_100_CT_DR10_dtheta_reco_gen_cosTheta_0_925_to_0_975","", n_bins100, -lim_angleDeg,lim_angleDeg);

  std::vector<TH1F*> hist_vec_100_CT;
  hist_vec_100_CT.push_back(h_100_CT_genjet03_dphi_j1j2);
  hist_vec_100_CT.push_back(h_100_CT_genjet03_E1_E2_over_E_True);
  hist_vec_100_CT.push_back(h_100_CT_genjet03_Delta_E1_E2_over_E12);
  hist_vec_100_CT.push_back(h_100_CT_genjet04_dphi_j1j2);
  hist_vec_100_CT.push_back(h_100_CT_genjet04_E1_E2_over_E_True);
  hist_vec_100_CT.push_back(h_100_CT_genjet04_Delta_E1_E2_over_E12);
  hist_vec_100_CT.push_back(h_100_CT_genjet05_dphi_j1j2);
  hist_vec_100_CT.push_back(h_100_CT_genjet05_E1_E2_over_E_True);
  hist_vec_100_CT.push_back(h_100_CT_genjet05_Delta_E1_E2_over_E12);
  hist_vec_100_CT.push_back(h_100_CT_genjet06_dphi_j1j2);
  hist_vec_100_CT.push_back(h_100_CT_genjet06_E1_E2_over_E_True);
  hist_vec_100_CT.push_back(h_100_CT_genjet06_Delta_E1_E2_over_E12);
  hist_vec_100_CT.push_back(h_100_CT_genjet07_dphi_j1j2);
  hist_vec_100_CT.push_back(h_100_CT_genjet07_E1_E2_over_E_True);
  hist_vec_100_CT.push_back(h_100_CT_genjet07_Delta_E1_E2_over_E12);
  hist_vec_100_CT.push_back(h_100_CT_genjet08_dphi_j1j2);
  hist_vec_100_CT.push_back(h_100_CT_genjet08_E1_E2_over_E_True);
  hist_vec_100_CT.push_back(h_100_CT_genjet08_Delta_E1_E2_over_E12);
  hist_vec_100_CT.push_back(h_100_CT_genjet09_dphi_j1j2);
  hist_vec_100_CT.push_back(h_100_CT_genjet09_E1_E2_over_E_True);
  hist_vec_100_CT.push_back(h_100_CT_genjet09_Delta_E1_E2_over_E12);
  hist_vec_100_CT.push_back(h_100_CT_genjet10_dphi_j1j2);
  hist_vec_100_CT.push_back(h_100_CT_genjet10_E1_E2_over_E_True);
  hist_vec_100_CT.push_back(h_100_CT_genjet10_Delta_E1_E2_over_E12);

  hist_vec_100_CT.push_back(h_100_CT_recojet03_dphi_j1j2);
  hist_vec_100_CT.push_back(h_100_CT_recojet03_E1_E2_over_E_True);
  hist_vec_100_CT.push_back(h_100_CT_recojet03_Delta_E1_E2_over_E12);
  hist_vec_100_CT.push_back(h_100_CT_recojet04_dphi_j1j2);
  hist_vec_100_CT.push_back(h_100_CT_recojet04_E1_E2_over_E_True);
  hist_vec_100_CT.push_back(h_100_CT_recojet04_Delta_E1_E2_over_E12);
  hist_vec_100_CT.push_back(h_100_CT_recojet05_dphi_j1j2);
  hist_vec_100_CT.push_back(h_100_CT_recojet05_E1_E2_over_E_True);
  hist_vec_100_CT.push_back(h_100_CT_recojet05_Delta_E1_E2_over_E12);
  hist_vec_100_CT.push_back(h_100_CT_recojet06_dphi_j1j2);
  hist_vec_100_CT.push_back(h_100_CT_recojet06_E1_E2_over_E_True);
  hist_vec_100_CT.push_back(h_100_CT_recojet06_Delta_E1_E2_over_E12);
  hist_vec_100_CT.push_back(h_100_CT_recojet07_dphi_j1j2);
  hist_vec_100_CT.push_back(h_100_CT_recojet07_E1_E2_over_E_True);
  hist_vec_100_CT.push_back(h_100_CT_recojet07_Delta_E1_E2_over_E12);
  hist_vec_100_CT.push_back(h_100_CT_recojet08_dphi_j1j2);
  hist_vec_100_CT.push_back(h_100_CT_recojet08_E1_E2_over_E_True);
  hist_vec_100_CT.push_back(h_100_CT_recojet08_Delta_E1_E2_over_E12);
  hist_vec_100_CT.push_back(h_100_CT_recojet09_dphi_j1j2);
  hist_vec_100_CT.push_back(h_100_CT_recojet09_E1_E2_over_E_True);
  hist_vec_100_CT.push_back(h_100_CT_recojet09_Delta_E1_E2_over_E12);
  hist_vec_100_CT.push_back(h_100_CT_recojet10_dphi_j1j2);
  hist_vec_100_CT.push_back(h_100_CT_recojet10_E1_E2_over_E_True);
  hist_vec_100_CT.push_back(h_100_CT_recojet10_Delta_E1_E2_over_E12);

  hist_vec_100_CT.push_back(h_100_CT_recojetE_over_genjetE_DR03);
  hist_vec_100_CT.push_back(h_100_CT_recojetE_over_genjetE_DR04);
  hist_vec_100_CT.push_back(h_100_CT_recojetE_over_genjetE_DR05);
  hist_vec_100_CT.push_back(h_100_CT_recojetE_over_genjetE_DR06);
  hist_vec_100_CT.push_back(h_100_CT_recojetE_over_genjetE_DR07);
  hist_vec_100_CT.push_back(h_100_CT_recojetE_over_genjetE_DR08);
  hist_vec_100_CT.push_back(h_100_CT_recojetE_over_genjetE_DR09);
  hist_vec_100_CT.push_back(h_100_CT_recojetE_over_genjetE_DR10);

  hist_vec_100_CT.push_back(h_100_CT_dphi_gen_reco_DR05);
  hist_vec_100_CT.push_back(h_100_CT_dphi_gen_reco_DR06);
  hist_vec_100_CT.push_back(h_100_CT_dphi_gen_reco_DR07);

  hist_vec_100_CT.push_back(h_100_CT_DR05_E_rel_totVis_RMS_d1_cosT_0_to_0_10);
  hist_vec_100_CT.push_back(h_100_CT_DR05_E_rel_totVis_RMS_d1_cosT_0_10_to_0_20);
  hist_vec_100_CT.push_back(h_100_CT_DR05_E_rel_totVis_RMS_d1_cosT_0_20_to_0_30);
  hist_vec_100_CT.push_back(h_100_CT_DR05_E_rel_totVis_RMS_d1_cosT_0_30_to_0_40);
  hist_vec_100_CT.push_back(h_100_CT_DR05_E_rel_totVis_RMS_d1_cosT_0_40_to_0_50);
  hist_vec_100_CT.push_back(h_100_CT_DR05_E_rel_totVis_RMS_d1_cosT_0_50_to_0_60);
  hist_vec_100_CT.push_back(h_100_CT_DR05_E_rel_totVis_RMS_d1_cosT_0_60_to_0_70);
  hist_vec_100_CT.push_back(h_100_CT_DR05_E_rel_totVis_RMS_d1_cosT_0_70_to_0_80);
  hist_vec_100_CT.push_back(h_100_CT_DR05_E_rel_totVis_RMS_d1_cosT_0_80_to_0_90);
  hist_vec_100_CT.push_back(h_100_CT_DR05_E_rel_totVis_RMS_d1_cosT_0_900_to_0_925);
  hist_vec_100_CT.push_back(h_100_CT_DR05_E_rel_totVis_RMS_d1_cosT_0_925_to_0_950);
  hist_vec_100_CT.push_back(h_100_CT_DR05_E_rel_totVis_RMS_d1_cosT_0_950_to_0_975);
  hist_vec_100_CT.push_back(h_100_CT_DR05_E_rel_totVis_RMS_d1_cosT_0_975_to_1_00);

  hist_vec_100_CT.push_back(h_100_CT_DR06_E_rel_totVis_RMS_d1_cosT_0_to_0_10);
  hist_vec_100_CT.push_back(h_100_CT_DR06_E_rel_totVis_RMS_d1_cosT_0_10_to_0_20);
  hist_vec_100_CT.push_back(h_100_CT_DR06_E_rel_totVis_RMS_d1_cosT_0_20_to_0_30);
  hist_vec_100_CT.push_back(h_100_CT_DR06_E_rel_totVis_RMS_d1_cosT_0_30_to_0_40);
  hist_vec_100_CT.push_back(h_100_CT_DR06_E_rel_totVis_RMS_d1_cosT_0_40_to_0_50);
  hist_vec_100_CT.push_back(h_100_CT_DR06_E_rel_totVis_RMS_d1_cosT_0_50_to_0_60);
  hist_vec_100_CT.push_back(h_100_CT_DR06_E_rel_totVis_RMS_d1_cosT_0_60_to_0_70);
  hist_vec_100_CT.push_back(h_100_CT_DR06_E_rel_totVis_RMS_d1_cosT_0_70_to_0_80);
  hist_vec_100_CT.push_back(h_100_CT_DR06_E_rel_totVis_RMS_d1_cosT_0_80_to_0_90);
  hist_vec_100_CT.push_back(h_100_CT_DR06_E_rel_totVis_RMS_d1_cosT_0_900_to_0_925);
  hist_vec_100_CT.push_back(h_100_CT_DR06_E_rel_totVis_RMS_d1_cosT_0_925_to_0_950);
  hist_vec_100_CT.push_back(h_100_CT_DR06_E_rel_totVis_RMS_d1_cosT_0_950_to_0_975);
  hist_vec_100_CT.push_back(h_100_CT_DR06_E_rel_totVis_RMS_d1_cosT_0_975_to_1_00); 

  hist_vec_100_CT.push_back(h_100_CT_DR07_E_rel_totVis_RMS_d1_cosT_0_to_0_10);
  hist_vec_100_CT.push_back(h_100_CT_DR07_E_rel_totVis_RMS_d1_cosT_0_10_to_0_20);
  hist_vec_100_CT.push_back(h_100_CT_DR07_E_rel_totVis_RMS_d1_cosT_0_20_to_0_30);
  hist_vec_100_CT.push_back(h_100_CT_DR07_E_rel_totVis_RMS_d1_cosT_0_30_to_0_40);
  hist_vec_100_CT.push_back(h_100_CT_DR07_E_rel_totVis_RMS_d1_cosT_0_40_to_0_50);
  hist_vec_100_CT.push_back(h_100_CT_DR07_E_rel_totVis_RMS_d1_cosT_0_50_to_0_60);
  hist_vec_100_CT.push_back(h_100_CT_DR07_E_rel_totVis_RMS_d1_cosT_0_60_to_0_70);
  hist_vec_100_CT.push_back(h_100_CT_DR07_E_rel_totVis_RMS_d1_cosT_0_70_to_0_80);
  hist_vec_100_CT.push_back(h_100_CT_DR07_E_rel_totVis_RMS_d1_cosT_0_80_to_0_90);
  hist_vec_100_CT.push_back(h_100_CT_DR07_E_rel_totVis_RMS_d1_cosT_0_900_to_0_925);
  hist_vec_100_CT.push_back(h_100_CT_DR07_E_rel_totVis_RMS_d1_cosT_0_925_to_0_950);
  hist_vec_100_CT.push_back(h_100_CT_DR07_E_rel_totVis_RMS_d1_cosT_0_950_to_0_975);
  hist_vec_100_CT.push_back(h_100_CT_DR07_E_rel_totVis_RMS_d1_cosT_0_975_to_1_00); 


  hist_vec_100_CT.push_back(h_100_CT_DR08_E_rel_totVis_RMS_d1_cosT_0_to_0_10);
  hist_vec_100_CT.push_back(h_100_CT_DR08_E_rel_totVis_RMS_d1_cosT_0_10_to_0_20);
  hist_vec_100_CT.push_back(h_100_CT_DR08_E_rel_totVis_RMS_d1_cosT_0_20_to_0_30);
  hist_vec_100_CT.push_back(h_100_CT_DR08_E_rel_totVis_RMS_d1_cosT_0_30_to_0_40);
  hist_vec_100_CT.push_back(h_100_CT_DR08_E_rel_totVis_RMS_d1_cosT_0_40_to_0_50);
  hist_vec_100_CT.push_back(h_100_CT_DR08_E_rel_totVis_RMS_d1_cosT_0_50_to_0_60);
  hist_vec_100_CT.push_back(h_100_CT_DR08_E_rel_totVis_RMS_d1_cosT_0_60_to_0_70);
  hist_vec_100_CT.push_back(h_100_CT_DR08_E_rel_totVis_RMS_d1_cosT_0_70_to_0_80);
  hist_vec_100_CT.push_back(h_100_CT_DR08_E_rel_totVis_RMS_d1_cosT_0_80_to_0_90);
  hist_vec_100_CT.push_back(h_100_CT_DR08_E_rel_totVis_RMS_d1_cosT_0_900_to_0_925);
  hist_vec_100_CT.push_back(h_100_CT_DR08_E_rel_totVis_RMS_d1_cosT_0_925_to_0_950);
  hist_vec_100_CT.push_back(h_100_CT_DR08_E_rel_totVis_RMS_d1_cosT_0_950_to_0_975);
  hist_vec_100_CT.push_back(h_100_CT_DR08_E_rel_totVis_RMS_d1_cosT_0_975_to_1_00); //110

  hist_vec_100_CT.push_back(h_100_CT_DR09_E_rel_totVis_RMS_d1_cosT_0_to_0_10);
  hist_vec_100_CT.push_back(h_100_CT_DR09_E_rel_totVis_RMS_d1_cosT_0_10_to_0_20);
  hist_vec_100_CT.push_back(h_100_CT_DR09_E_rel_totVis_RMS_d1_cosT_0_20_to_0_30);
  hist_vec_100_CT.push_back(h_100_CT_DR09_E_rel_totVis_RMS_d1_cosT_0_30_to_0_40);
  hist_vec_100_CT.push_back(h_100_CT_DR09_E_rel_totVis_RMS_d1_cosT_0_40_to_0_50);
  hist_vec_100_CT.push_back(h_100_CT_DR09_E_rel_totVis_RMS_d1_cosT_0_50_to_0_60);
  hist_vec_100_CT.push_back(h_100_CT_DR09_E_rel_totVis_RMS_d1_cosT_0_60_to_0_70);
  hist_vec_100_CT.push_back(h_100_CT_DR09_E_rel_totVis_RMS_d1_cosT_0_70_to_0_80);
  hist_vec_100_CT.push_back(h_100_CT_DR09_E_rel_totVis_RMS_d1_cosT_0_80_to_0_90);
  hist_vec_100_CT.push_back(h_100_CT_DR09_E_rel_totVis_RMS_d1_cosT_0_900_to_0_925);
  hist_vec_100_CT.push_back(h_100_CT_DR09_E_rel_totVis_RMS_d1_cosT_0_925_to_0_950);
  hist_vec_100_CT.push_back(h_100_CT_DR09_E_rel_totVis_RMS_d1_cosT_0_950_to_0_975);
  hist_vec_100_CT.push_back(h_100_CT_DR09_E_rel_totVis_RMS_d1_cosT_0_975_to_1_00); //123

  hist_vec_100_CT.push_back(h_100_CT_DR10_E_rel_totVis_RMS_d1_cosT_0_to_0_10);
  hist_vec_100_CT.push_back(h_100_CT_DR10_E_rel_totVis_RMS_d1_cosT_0_10_to_0_20);
  hist_vec_100_CT.push_back(h_100_CT_DR10_E_rel_totVis_RMS_d1_cosT_0_20_to_0_30);
  hist_vec_100_CT.push_back(h_100_CT_DR10_E_rel_totVis_RMS_d1_cosT_0_30_to_0_40);
  hist_vec_100_CT.push_back(h_100_CT_DR10_E_rel_totVis_RMS_d1_cosT_0_40_to_0_50);
  hist_vec_100_CT.push_back(h_100_CT_DR10_E_rel_totVis_RMS_d1_cosT_0_50_to_0_60);
  hist_vec_100_CT.push_back(h_100_CT_DR10_E_rel_totVis_RMS_d1_cosT_0_60_to_0_70);
  hist_vec_100_CT.push_back(h_100_CT_DR10_E_rel_totVis_RMS_d1_cosT_0_70_to_0_80);
  hist_vec_100_CT.push_back(h_100_CT_DR10_E_rel_totVis_RMS_d1_cosT_0_80_to_0_90);
  hist_vec_100_CT.push_back(h_100_CT_DR10_E_rel_totVis_RMS_d1_cosT_0_900_to_0_925);
  hist_vec_100_CT.push_back(h_100_CT_DR10_E_rel_totVis_RMS_d1_cosT_0_925_to_0_950);
  hist_vec_100_CT.push_back(h_100_CT_DR10_E_rel_totVis_RMS_d1_cosT_0_950_to_0_975);
  hist_vec_100_CT.push_back(h_100_CT_DR10_E_rel_totVis_RMS_d1_cosT_0_975_to_1_00); //136

  hist_vec_100_CT.push_back(h_100_CT_DR05_dphi_reco_gen_cosTheta_0_65);//137
  hist_vec_100_CT.push_back(h_100_CT_DR05_dphi_reco_gen_cosTheta_0_65_to_0_80);
  hist_vec_100_CT.push_back(h_100_CT_DR05_dphi_reco_gen_cosTheta_0_80_to_0_925);
  hist_vec_100_CT.push_back(h_100_CT_DR05_dphi_reco_gen_cosTheta_0_925_to_0_975);
  hist_vec_100_CT.push_back(h_100_CT_DR05_dtheta_reco_gen_cosTheta_0_65);
  hist_vec_100_CT.push_back(h_100_CT_DR05_dtheta_reco_gen_cosTheta_0_65_to_0_80);
  hist_vec_100_CT.push_back(h_100_CT_DR05_dtheta_reco_gen_cosTheta_0_80_to_0_925);
  hist_vec_100_CT.push_back(h_100_CT_DR05_dtheta_reco_gen_cosTheta_0_925_to_0_975);

  hist_vec_100_CT.push_back(h_100_CT_DR07_dphi_reco_gen_cosTheta_0_65);//145
  hist_vec_100_CT.push_back(h_100_CT_DR07_dphi_reco_gen_cosTheta_0_65_to_0_80);
  hist_vec_100_CT.push_back(h_100_CT_DR07_dphi_reco_gen_cosTheta_0_80_to_0_925);
  hist_vec_100_CT.push_back(h_100_CT_DR07_dphi_reco_gen_cosTheta_0_925_to_0_975);
  hist_vec_100_CT.push_back(h_100_CT_DR07_dtheta_reco_gen_cosTheta_0_65);
  hist_vec_100_CT.push_back(h_100_CT_DR07_dtheta_reco_gen_cosTheta_0_65_to_0_80);
  hist_vec_100_CT.push_back(h_100_CT_DR07_dtheta_reco_gen_cosTheta_0_80_to_0_925);
  hist_vec_100_CT.push_back(h_100_CT_DR07_dtheta_reco_gen_cosTheta_0_925_to_0_975);

  hist_vec_100_CT.push_back(h_100_CT_DR10_dphi_reco_gen_cosTheta_0_65);//153
  hist_vec_100_CT.push_back(h_100_CT_DR10_dphi_reco_gen_cosTheta_0_65_to_0_80);
  hist_vec_100_CT.push_back(h_100_CT_DR10_dphi_reco_gen_cosTheta_0_80_to_0_925);
  hist_vec_100_CT.push_back(h_100_CT_DR10_dphi_reco_gen_cosTheta_0_925_to_0_975);
  hist_vec_100_CT.push_back(h_100_CT_DR10_dtheta_reco_gen_cosTheta_0_65);
  hist_vec_100_CT.push_back(h_100_CT_DR10_dtheta_reco_gen_cosTheta_0_65_to_0_80);
  hist_vec_100_CT.push_back(h_100_CT_DR10_dtheta_reco_gen_cosTheta_0_80_to_0_925);
  hist_vec_100_CT.push_back(h_100_CT_DR10_dtheta_reco_gen_cosTheta_0_925_to_0_975);//160

  for(unsigned int i=0;i<hist_vec_100_CT.size();i++){
    hist_vec_100_CT[i]->Sumw2();
  }
  fill_jet_histograms(file_CLIC_100_CT,hist_vec_100_CT);


 

  TH1F* h_100_CT_DR05_dphi_SigmaCB_summary_histogram=new TH1F("dphiRes_SigmaCBVsCosTheta_CT_DR05_100", "#sigma#Delta#phi(j_{reco},j_{true}) vs |cos#theta|", nRegionBinsAngles, pRegionBinEdgesAngles);
  h_100_CT_DR05_dphi_SigmaCB_summary_histogram ->SetYTitle("#sigma#Delta#phi(j_{reco},j_{true})");
  h_100_CT_DR05_dphi_SigmaCB_summary_histogram->SetXTitle("|cos#theta|");
  h_100_CT_DR05_dphi_SigmaCB_summary_histogram->SetLineWidth(2);
  h_100_CT_DR05_dphi_SigmaCB_summary_histogram->SetLineColor(kCyan+1);
  h_100_CT_DR05_dphi_SigmaCB_summary_histogram->SetLineStyle(2);

  TH1F* h_100_CT_DR05_dphi_RMS90_summary_histogram=new TH1F("dphiRes_RMS90VsCosTheta_CT_DR05_100", "RMS_{90} #Delta#phi(j_{reco},j_{true}) vs |cos#theta|", nRegionBinsAngles, pRegionBinEdgesAngles);
  h_100_CT_DR05_dphi_RMS90_summary_histogram ->SetYTitle("RMS_{90}#Delta#phi(j_{reco},j_{true})");
  h_100_CT_DR05_dphi_RMS90_summary_histogram->SetXTitle("|cos#theta|");
  h_100_CT_DR05_dphi_RMS90_summary_histogram->SetLineWidth(2);
  h_100_CT_DR05_dphi_RMS90_summary_histogram->SetLineColor(kCyan+1);
  h_100_CT_DR05_dphi_RMS90_summary_histogram->SetLineStyle(2);

  TH1F* h_100_CT_DR07_dphi_SigmaCB_summary_histogram=new TH1F("dphiRes_SigmaCBVsCosTheta_CT_DR07_100", "#sigma#Delta#phi(j_{reco},j_{true}) vs |cos#theta|", nRegionBinsAngles, pRegionBinEdgesAngles);
  h_100_CT_DR07_dphi_SigmaCB_summary_histogram ->SetYTitle("#sigma#Delta#phi(j_{reco},j_{true})");
  h_100_CT_DR07_dphi_SigmaCB_summary_histogram->SetXTitle("|cos#theta|");
  h_100_CT_DR07_dphi_SigmaCB_summary_histogram->SetLineWidth(2);
  h_100_CT_DR07_dphi_SigmaCB_summary_histogram->SetLineColor(kCyan+1);
  h_100_CT_DR07_dphi_SigmaCB_summary_histogram->SetLineStyle(2);

  TH1F* h_100_CT_DR07_dphi_RMS90_summary_histogram=new TH1F("dphiRes_RMS90VsCosTheta_CT_DR07_100", "RMS_{90} #Delta#phi(j_{reco},j_{true}) vs |cos#theta|", nRegionBinsAngles, pRegionBinEdgesAngles);
  h_100_CT_DR07_dphi_RMS90_summary_histogram ->SetYTitle("RMS_{90}#Delta#phi(j_{reco},j_{true})");
  h_100_CT_DR07_dphi_RMS90_summary_histogram->SetXTitle("|cos#theta|");
  h_100_CT_DR07_dphi_RMS90_summary_histogram->SetLineWidth(2);
  h_100_CT_DR07_dphi_RMS90_summary_histogram->SetLineColor(kCyan+1);
  h_100_CT_DR07_dphi_RMS90_summary_histogram->SetLineStyle(2);

  TH1F* h_100_CT_DR10_dphi_SigmaCB_summary_histogram=new TH1F("dphiRes_SigmaCBVsCosTheta_CT_DR10_100", "#sigma#Delta#phi(j_{reco},j_{true}) vs |cos#theta|", nRegionBinsAngles, pRegionBinEdgesAngles);
  h_100_CT_DR10_dphi_SigmaCB_summary_histogram ->SetYTitle("#sigma#Delta#phi(j_{reco},j_{true})");
  h_100_CT_DR10_dphi_SigmaCB_summary_histogram->SetXTitle("|cos#theta|");
  h_100_CT_DR10_dphi_SigmaCB_summary_histogram->SetLineWidth(2);
  h_100_CT_DR10_dphi_SigmaCB_summary_histogram->SetLineColor(kCyan+1);
  h_100_CT_DR10_dphi_SigmaCB_summary_histogram->SetLineStyle(2);

  TH1F* h_100_CT_DR10_dphi_RMS90_summary_histogram=new TH1F("dphiRes_RMS90VsCosTheta_CT_DR10_100", "RMS_{90} #Delta#phi(j_{reco},j_{true}) vs |cos#theta|", nRegionBinsAngles, pRegionBinEdgesAngles);
  h_100_CT_DR10_dphi_RMS90_summary_histogram ->SetYTitle("RMS_{90}#Delta#phi(j_{reco},j_{true})");
  h_100_CT_DR10_dphi_RMS90_summary_histogram->SetXTitle("|cos#theta|");
  h_100_CT_DR10_dphi_RMS90_summary_histogram->SetLineWidth(2);
  h_100_CT_DR10_dphi_RMS90_summary_histogram->SetLineColor(kCyan+1);
  h_100_CT_DR10_dphi_RMS90_summary_histogram->SetLineStyle(2);

  TH1F* h_100_CT_DR05_dtheta_SigmaCB_summary_histogram=new TH1F("dthetaRes_SigmaCBVsCosTheta_CT_DR05_100", "#sigma#Delta#theta(j_{reco},j_{true}) vs |cos#theta|", nRegionBinsAngles, pRegionBinEdgesAngles);
  h_100_CT_DR05_dtheta_SigmaCB_summary_histogram ->SetYTitle("#sigma#Delta#theta(j_{reco},j_{true})");
  h_100_CT_DR05_dtheta_SigmaCB_summary_histogram->SetXTitle("|cos#theta|");
  h_100_CT_DR05_dtheta_SigmaCB_summary_histogram->SetLineWidth(2);
  h_100_CT_DR05_dtheta_SigmaCB_summary_histogram->SetLineColor(kCyan+1);
  h_100_CT_DR05_dtheta_SigmaCB_summary_histogram->SetLineStyle(2);

  TH1F* h_100_CT_DR05_dtheta_RMS90_summary_histogram=new TH1F("dthetaRes_RMS90VsCosTheta_CT_DR05_100", "RMS_{90} #Delta#theta(j_{reco},j_{true}) vs |cos#theta|", nRegionBinsAngles, pRegionBinEdgesAngles);
  h_100_CT_DR05_dtheta_RMS90_summary_histogram ->SetYTitle("RMS_{90}#Delta#theta(j_{reco},j_{true})");
  h_100_CT_DR05_dtheta_RMS90_summary_histogram->SetXTitle("|cos#theta|");
  h_100_CT_DR05_dtheta_RMS90_summary_histogram->SetLineWidth(2);
  h_100_CT_DR05_dtheta_RMS90_summary_histogram->SetLineColor(kCyan+1);
  h_100_CT_DR05_dtheta_RMS90_summary_histogram->SetLineStyle(2);

  TH1F* h_100_CT_DR07_dtheta_SigmaCB_summary_histogram=new TH1F("dthetaRes_SigmaCBVsCosTheta_CT_DR07_100", "#sigma#Delta#theta(j_{reco},j_{true}) vs |cos#theta|", nRegionBinsAngles, pRegionBinEdgesAngles);
  h_100_CT_DR07_dtheta_SigmaCB_summary_histogram ->SetYTitle("#sigma#Delta#theta(j_{reco},j_{true})");
  h_100_CT_DR07_dtheta_SigmaCB_summary_histogram->SetXTitle("|cos#theta|");
  h_100_CT_DR07_dtheta_SigmaCB_summary_histogram->SetLineWidth(2);
  h_100_CT_DR07_dtheta_SigmaCB_summary_histogram->SetLineColor(kCyan+1);
  h_100_CT_DR07_dtheta_SigmaCB_summary_histogram->SetLineStyle(2);

  TH1F* h_100_CT_DR07_dtheta_RMS90_summary_histogram=new TH1F("dthetaRes_RMS90VsCosTheta_CT_DR07_100", "RMS_{90} #Delta#theta(j_{reco},j_{true}) vs |cos#theta|", nRegionBinsAngles, pRegionBinEdgesAngles);
  h_100_CT_DR07_dtheta_RMS90_summary_histogram ->SetYTitle("RMS_{90}#Delta#theta(j_{reco},j_{true})");
  h_100_CT_DR07_dtheta_RMS90_summary_histogram->SetXTitle("|cos#theta|");
  h_100_CT_DR07_dtheta_RMS90_summary_histogram->SetLineWidth(2);
  h_100_CT_DR07_dtheta_RMS90_summary_histogram->SetLineColor(kCyan+1);
  h_100_CT_DR07_dtheta_RMS90_summary_histogram->SetLineStyle(2);

  TH1F* h_100_CT_DR10_dtheta_SigmaCB_summary_histogram=new TH1F("dthetaRes_SigmaCBVsCosTheta_CT_DR10_100", "#sigma#Delta#theta(j_{reco},j_{true}) vs |cos#theta|", nRegionBinsAngles, pRegionBinEdgesAngles);
  h_100_CT_DR10_dtheta_SigmaCB_summary_histogram ->SetYTitle("#sigma#Delta#theta(j_{reco},j_{true})");
  h_100_CT_DR10_dtheta_SigmaCB_summary_histogram->SetXTitle("|cos#theta|");
  h_100_CT_DR10_dtheta_SigmaCB_summary_histogram->SetLineWidth(2);
  h_100_CT_DR10_dtheta_SigmaCB_summary_histogram->SetLineColor(kCyan+1);
  h_100_CT_DR10_dtheta_SigmaCB_summary_histogram->SetLineStyle(2);

  TH1F* h_100_CT_DR10_dtheta_RMS90_summary_histogram=new TH1F("dthetaRes_RMS90VsCosTheta_CT_DR10_100", "RMS_{90} #Delta#theta(j_{reco},j_{true}) vs |cos#theta|", nRegionBinsAngles, pRegionBinEdgesAngles);
  h_100_CT_DR10_dtheta_RMS90_summary_histogram ->SetYTitle("RMS_{90}#Delta#theta(j_{reco},j_{true})");
  h_100_CT_DR10_dtheta_RMS90_summary_histogram->SetXTitle("|cos#theta|");
  h_100_CT_DR10_dtheta_RMS90_summary_histogram->SetLineWidth(2);
  h_100_CT_DR10_dtheta_RMS90_summary_histogram->SetLineColor(kCyan+1);
  h_100_CT_DR10_dtheta_RMS90_summary_histogram->SetLineStyle(2);

  for(int i=137;i<161;i++){
    //continue;
    std::cout<<"ang histo 100 "<<i<<"]"<<std::endl;
   //double sided crystal ball
    TF1* fit_gaus_tmp = new TF1("fit_gaus_tmp", "gaus",-5.,5.);
    hist_vec_100_CT[i]->Fit("fit_gaus_tmp","R");
    hist_vec_100_CT[i]->GetFunction("fit_gaus_tmp");
    TF1* fdscb_tmp = new TF1("fdscb_tmp",fnc_dscb,-lim_angleDeg,lim_angleDeg,7);
    fdscb_tmp->SetNpx(2000);
    fdscb_tmp->SetParameter(0,fit_gaus_tmp->GetParameter(0));
    //norm
    fdscb_tmp->SetParLimits (0,0.5*fit_gaus_tmp->GetParameter(0),1.5*fit_gaus_tmp->GetParameter(0));
    fdscb_tmp->SetParameter(1,fit_gaus_tmp->GetParameter(1));
    //gaussian mean
    fdscb_tmp->SetParLimits (1,-2.,2.);
    fdscb_tmp->SetParameter(2,fit_gaus_tmp->GetParameter(2));
    fdscb_tmp->SetParLimits(2,fit_gaus_tmp->GetParameter(2)*0.50,1.50*fit_gaus_tmp->GetParameter(2));
    //-a1: parameter, from when the gaussian core should count
    fdscb_tmp->SetParameter(2,fit_gaus_tmp->GetParameter(2));
    fdscb_tmp->SetParameter (3,3.0);
    fdscb_tmp->SetParLimits (3,0.0,10.);
    //a2 parameter, up to when the gaussian core should count
    fdscb_tmp->SetParameter (5,3.0);
    fdscb_tmp->SetParLimits (5,0.0,10.);
    fdscb_tmp->SetParameter(4,5.);
    fdscb_tmp->SetParLimits(4,0.,25.);
    fdscb_tmp->SetParameter(6,5.);
    fdscb_tmp->SetParLimits(6,0.,25.);
    int fitstatus(0); 
    fitstatus = hist_vec_100_CT[i]->Fit(fdscb_tmp,"R");
    fdscb_tmp = hist_vec_100_CT[i]->GetFunction("fdscb_tmp");
    resolutionTH1=0; 
    resolutionErrorTH1=0;
    meanTH1=0;
    meanErrorTH1=0;
    CalculatePerformanceNoMean( hist_vec_100_CT[i], resolutionTH1, resolutionErrorTH1,meanTH1,meanErrorTH1);
    int first_bin_ang=137;
    if(i<141){//dphi DR05
      first_bin_ang=137;
      h_100_CT_DR05_dphi_SigmaCB_summary_histogram->SetBinContent(i-first_bin_ang+1,fdscb_tmp->GetParameter(2));
      h_100_CT_DR05_dphi_SigmaCB_summary_histogram->SetBinError(i-first_bin_ang+1,fdscb_tmp->GetParError(2));
      h_100_CT_DR05_dphi_RMS90_summary_histogram->SetBinContent(i-first_bin_ang+1,resolutionTH1);
      h_100_CT_DR05_dphi_RMS90_summary_histogram->SetBinError(i-first_bin_ang+1, resolutionErrorTH1);
    }else if(i<145){//dtheta DR05
      first_bin_ang=141;
      h_100_CT_DR05_dtheta_SigmaCB_summary_histogram->SetBinContent(i-first_bin_ang+1,fdscb_tmp->GetParameter(2));
      h_100_CT_DR05_dtheta_SigmaCB_summary_histogram->SetBinError(i-first_bin_ang+1,fdscb_tmp->GetParError(2));
      h_100_CT_DR05_dtheta_RMS90_summary_histogram->SetBinContent(i-first_bin_ang+1,resolutionTH1);
      h_100_CT_DR05_dtheta_RMS90_summary_histogram->SetBinError(i-first_bin_ang+1, resolutionErrorTH1);
    }else if(i<149){//dphi DR07
      first_bin_ang=145;
      h_100_CT_DR07_dphi_SigmaCB_summary_histogram->SetBinContent(i-first_bin_ang+1,fdscb_tmp->GetParameter(2));
      h_100_CT_DR07_dphi_SigmaCB_summary_histogram->SetBinError(i-first_bin_ang+1,fdscb_tmp->GetParError(2));
      h_100_CT_DR07_dphi_RMS90_summary_histogram->SetBinContent(i-first_bin_ang+1,resolutionTH1);
      h_100_CT_DR07_dphi_RMS90_summary_histogram->SetBinError(i-first_bin_ang+1, resolutionErrorTH1);
    }else if(i<153){//dtheta DR07
      first_bin_ang=149;
      h_100_CT_DR07_dtheta_SigmaCB_summary_histogram->SetBinContent(i-first_bin_ang+1,fdscb_tmp->GetParameter(2));
      h_100_CT_DR07_dtheta_SigmaCB_summary_histogram->SetBinError(i-first_bin_ang+1,fdscb_tmp->GetParError(2));
      h_100_CT_DR07_dtheta_RMS90_summary_histogram->SetBinContent(i-first_bin_ang+1,resolutionTH1);
      h_100_CT_DR07_dtheta_RMS90_summary_histogram->SetBinError(i-first_bin_ang+1, resolutionErrorTH1);
    }else if(i<157){//dphi DR07
      first_bin_ang=153;
      h_100_CT_DR10_dphi_SigmaCB_summary_histogram->SetBinContent(i-first_bin_ang+1,fdscb_tmp->GetParameter(2));
      h_100_CT_DR10_dphi_SigmaCB_summary_histogram->SetBinError(i-first_bin_ang+1,fdscb_tmp->GetParError(2));
      h_100_CT_DR10_dphi_RMS90_summary_histogram->SetBinContent(i-first_bin_ang+1,resolutionTH1);
      h_100_CT_DR10_dphi_RMS90_summary_histogram->SetBinError(i-first_bin_ang+1, resolutionErrorTH1);
    }else if(i<161){//dtheta DR07
      first_bin_ang=157;
      h_100_CT_DR10_dtheta_SigmaCB_summary_histogram->SetBinContent(i-first_bin_ang+1,fdscb_tmp->GetParameter(2));
      h_100_CT_DR10_dtheta_SigmaCB_summary_histogram->SetBinError(i-first_bin_ang+1,fdscb_tmp->GetParError(2));
      h_100_CT_DR10_dtheta_RMS90_summary_histogram->SetBinContent(i-first_bin_ang+1,resolutionTH1);
      h_100_CT_DR10_dtheta_RMS90_summary_histogram->SetBinError(i-first_bin_ang+1, resolutionErrorTH1);
    }
  }

  TH1F* h_100_CT_DR05_E_SigmaCB_summary_histogram=new TH1F("JER_SigmaCBVsCosTheta_CT_DR05_100", "#sigma (E_{j}^{reco} / E_{j}^{true}) vs |cos#theta|", nRegionBins, pRegionBinEdges);
  h_100_CT_DR05_E_SigmaCB_summary_histogram ->SetYTitle("#sigma(E_{j}) / E_{j} [%]");
  h_100_CT_DR05_E_SigmaCB_summary_histogram->SetXTitle("|cos#theta|");
  h_100_CT_DR05_E_SigmaCB_summary_histogram->SetLineWidth(2);
  h_100_CT_DR05_E_SigmaCB_summary_histogram->SetLineColor(kCyan+1);
  h_100_CT_DR05_E_SigmaCB_summary_histogram->SetLineStyle(2);

  TH1F* h_100_CT_DR05_E_RMS90_summary_histogram=new TH1F("JER_RMS90VsCosTheta_CT_DR05_100", "RMS_{90}(E_{j}^{reco}/E_{j}^{gen}) / Mean_{90}(E_{j}^{reco}/E_{j}^{gen}) vs |cos#theta|", nRegionBins, pRegionBinEdges);
  h_100_CT_DR05_E_RMS90_summary_histogram ->SetYTitle("RMS_{90}(E_{j}^{reco}/E_{j}^{gen}) / Mean_{90}(E_{j}^{reco}/E_{j}^{gen}) [%]");
  h_100_CT_DR05_E_RMS90_summary_histogram->SetXTitle("|cos#theta|");
  h_100_CT_DR05_E_RMS90_summary_histogram->SetLineWidth(2);
  h_100_CT_DR05_E_RMS90_summary_histogram->SetLineColor(kCyan+1);
  h_100_CT_DR05_E_RMS90_summary_histogram->SetLineStyle(2);

  TH1F* h_100_CT_DR05_E_RMS_summary_histogram=new TH1F("JER_RMSVsCosTheta_CT_DR05_100", "RMS(E_{j}) / Mean(E_{j}) vs |cos#theta|", nRegionBins, pRegionBinEdges);
  h_100_CT_DR05_E_RMS_summary_histogram ->SetYTitle("RMS(E_{j}) / Mean(E_{j}) [%]");
  h_100_CT_DR05_E_RMS_summary_histogram->SetXTitle("|cos#theta|");
  h_100_CT_DR05_E_RMS_summary_histogram->SetLineWidth(2);
  h_100_CT_DR05_E_RMS_summary_histogram->SetLineColor(kCyan+1);
  h_100_CT_DR05_E_RMS_summary_histogram->SetLineStyle(2);

  TH1F* h_100_CT_DR05_E_JER_Mean_summary_histogram=new TH1F("JER_MeanVsCosTheta_CT_DR05_100", "Mean(E_{tot}^{RECO}/E_{tot}^{true}) vs |cos#theta|", nRegionBins, pRegionBinEdges);
  h_100_CT_DR05_E_JER_Mean_summary_histogram->SetYTitle("Mean(E_{tot}^{RECO}/E_{tot}^{true})");
  h_100_CT_DR05_E_JER_Mean_summary_histogram->SetXTitle("|cos#theta|");
  h_100_CT_DR05_E_JER_Mean_summary_histogram->SetLineWidth(2);
  h_100_CT_DR05_E_JER_Mean_summary_histogram->SetLineColor(kCyan+1);
  h_100_CT_DR05_E_JER_Mean_summary_histogram->SetLineStyle(2);
  firstbin=59;
  for(int i=firstbin;i<(firstbin+13);i++){
    //continue;
    resolutionTH1=0; 
    resolutionErrorTH1=0;
    meanTH1=0;
    meanErrorTH1=0;
    CalculatePerformance( hist_vec_100_CT[i], resolutionTH1, resolutionErrorTH1,meanTH1,meanErrorTH1);
    h_100_CT_DR05_E_RMS90_summary_histogram->SetBinContent(i-firstbin+1,resolutionTH1/sqrt(2.));
    h_100_CT_DR05_E_RMS90_summary_histogram ->SetBinError(i-firstbin+1, resolutionErrorTH1/sqrt(2.));
    h_100_CT_DR05_E_RMS_summary_histogram->SetBinContent(i-firstbin+1,hist_vec_100_CT[i]->GetRMS()*100. );
    h_100_CT_DR05_E_RMS_summary_histogram ->SetBinError(i-firstbin+1, hist_vec_100_CT[i]->GetRMSError()*100.);
    h_100_CT_DR05_E_JER_Mean_summary_histogram->SetBinContent(i-firstbin+1,hist_vec_100_CT[i]->GetMean());
    h_100_CT_DR05_E_JER_Mean_summary_histogram->SetBinError(i-firstbin+1,hist_vec_100_CT[i]->GetMeanError());
   //double sided crystal ball
    TF1* fit_gaus_tmp = new TF1("fit_gaus_tmp", "gaus",0.50,1.50);
    hist_vec_100_CT[i]->Fit("fit_gaus_tmp","R");
    hist_vec_100_CT[i]->GetFunction("fit_gaus_tmp");
    TF1* fdscb_tmp = new TF1("fdscb_tmp",fnc_dscb,0.,3.,7);
    fdscb_tmp->SetNpx(1000);
    fdscb_tmp->SetParameter(0,fit_gaus_tmp->GetParameter(0));
    //norm
    fdscb_tmp->SetParLimits (0,0.5*fit_gaus_tmp->GetParameter(0),1.5*fit_gaus_tmp->GetParameter(0));
    fdscb_tmp->SetParameter(1,fit_gaus_tmp->GetParameter(1));
    //gaussian mean
    fdscb_tmp->SetParLimits (1,0.8,1.2);
    //fdscb_tmp->SetParameter(2,fit_gaus_tmp->GetParameter(2));
    //fdscb_tmp->SetParLimits(2,fit_gaus_tmp->GetParameter(2)*0.50,1.50*fit_gaus_tmp->GetParameter(2));
    //-a1: parameter, from when the gaussian core should count
    //fdscb_tmp->SetParameter(2,fit_gaus_tmp->GetParameter(2));
    std::vector<float>sigma2SFit=sigmaGaussianFits2Sigma(hist_vec_100_CT[i]);
    fdscb_tmp->SetParameter(2,sigma2SFit[0]);
    fdscb_tmp->SetParLimits(2,sigma2SFit[0]*0.50,1.50*sigma2SFit[0]);
    fdscb_tmp->SetParameter (3,3.0);
    fdscb_tmp->SetParLimits (3,0.0,10.);
    //a2 parameter, up to when the gaussian core should count
    fdscb_tmp->SetParameter (5,3.0);
    fdscb_tmp->SetParLimits (5,0.0,10.);
    fdscb_tmp->SetParameter(4,5.);
    fdscb_tmp->SetParLimits(4,0.,30.);
    fdscb_tmp->SetParameter(6,5.);
    fdscb_tmp->SetParLimits(6,0.,30.);
    int fitstatus(0); 
    fitstatus = hist_vec_100_CT[i]->Fit(fdscb_tmp,"R");
    fdscb_tmp = hist_vec_100_CT[i]->GetFunction("fdscb_tmp");
    h_100_CT_DR05_E_SigmaCB_summary_histogram->SetBinContent(i-firstbin+1,fdscb_tmp->GetParameter(2)*100. );
    h_100_CT_DR05_E_SigmaCB_summary_histogram->SetBinError(i-firstbin+1,fdscb_tmp->GetParError(2)*100. );
  } 
  TH1F* h_100_CT_DR06_E_SigmaCB_summary_histogram=new TH1F("JER_SigmaCBVsCosTheta_CT_DR06_100", "#sigma (E_{j}^{reco} / E_{j}^{true}) vs |cos#theta|", nRegionBins, pRegionBinEdges);
  h_100_CT_DR06_E_SigmaCB_summary_histogram ->SetYTitle("#sigma(E_{j}) / E_{j} [%]");
  h_100_CT_DR06_E_SigmaCB_summary_histogram->SetXTitle("|cos#theta|");
  h_100_CT_DR06_E_SigmaCB_summary_histogram->SetLineWidth(2);
  h_100_CT_DR06_E_SigmaCB_summary_histogram->SetLineColor(kCyan+1);
  h_100_CT_DR06_E_SigmaCB_summary_histogram->SetLineStyle(2);
  TH1F* h_100_CT_DR06_E_RMS90_summary_histogram=new TH1F("JER_RMS90VsCosTheta_CT_DR06_100", "RMS_{90}(E_{j}^{reco}/E_{j}^{gen}) / Mean_{90}(E_{j}^{reco}/E_{j}^{gen}) vs |cos#theta|", nRegionBins, pRegionBinEdges);
  h_100_CT_DR06_E_RMS90_summary_histogram ->SetYTitle("RMS_{90}(E_{j}^{reco}/E_{j}^{gen}) / Mean_{90}(E_{j}^{reco}/E_{j}^{gen}) [%]");
  h_100_CT_DR06_E_RMS90_summary_histogram->SetXTitle("|cos#theta|");
  h_100_CT_DR06_E_RMS90_summary_histogram->SetLineWidth(2);
  h_100_CT_DR06_E_RMS90_summary_histogram->SetLineColor(kCyan+1);
  h_100_CT_DR06_E_RMS90_summary_histogram->SetLineStyle(2);

  TH1F* h_100_CT_DR06_E_RMS_summary_histogram=new TH1F("JER_RMSVsCosTheta_CT_DR06_100", "RMS(E_{j}) / Mean(E_{j}) vs |cos#theta|", nRegionBins, pRegionBinEdges);
  h_100_CT_DR06_E_RMS_summary_histogram ->SetYTitle("RMS(E_{j}) / Mean(E_{j}) [%]");
  h_100_CT_DR06_E_RMS_summary_histogram->SetXTitle("|cos#theta|");
  h_100_CT_DR06_E_RMS_summary_histogram->SetLineWidth(2);
  h_100_CT_DR06_E_RMS_summary_histogram->SetLineColor(kCyan+1);
  h_100_CT_DR06_E_RMS_summary_histogram->SetLineStyle(2);

  TH1F* h_100_CT_DR06_E_JER_Mean_summary_histogram=new TH1F("JER_MeanVsCosTheta_CT_DR06_100", "Mean(E_{tot}^{RECO}/E_{tot}^{true}) vs |cos#theta|", nRegionBins, pRegionBinEdges);
  h_100_CT_DR06_E_JER_Mean_summary_histogram->SetYTitle("Mean(E_{tot}^{RECO}/E_{tot}^{true})");
  h_100_CT_DR06_E_JER_Mean_summary_histogram->SetXTitle("|cos#theta|");
  h_100_CT_DR06_E_JER_Mean_summary_histogram->SetLineWidth(2);
  h_100_CT_DR06_E_JER_Mean_summary_histogram->SetLineColor(kCyan+1);
  h_100_CT_DR06_E_JER_Mean_summary_histogram->SetLineStyle(2);

  firstbin=72;
  for(int i=firstbin;i<(firstbin+13);i++){
    //continue;
    resolutionTH1=0;
    resolutionErrorTH1=0;
    meanTH1=0;
    meanErrorTH1=0;
    CalculatePerformance( hist_vec_100_CT[i], resolutionTH1, resolutionErrorTH1,meanTH1,meanErrorTH1);
    h_100_CT_DR06_E_RMS90_summary_histogram->SetBinContent(i-firstbin+1,resolutionTH1/sqrt(2.));
    h_100_CT_DR06_E_RMS90_summary_histogram ->SetBinError(i-firstbin+1, resolutionErrorTH1/sqrt(2.));
    h_100_CT_DR06_E_RMS_summary_histogram->SetBinContent(i-firstbin+1,hist_vec_100_CT[i]->GetRMS()*100. );
    h_100_CT_DR06_E_RMS_summary_histogram ->SetBinError(i-firstbin+1, hist_vec_100_CT[i]->GetRMSError()*100.);
    h_100_CT_DR06_E_JER_Mean_summary_histogram->SetBinContent(i-firstbin+1,hist_vec_100_CT[i]->GetMean());
    h_100_CT_DR06_E_JER_Mean_summary_histogram->SetBinError(i-firstbin+1,hist_vec_100_CT[i]->GetMeanError());
   //double sided crystal ball
    TF1* fit_gaus_tmp = new TF1("fit_gaus_tmp", "gaus",0.50,1.50);
    hist_vec_100_CT[i]->Fit("fit_gaus_tmp","R");
    hist_vec_100_CT[i]->GetFunction("fit_gaus_tmp");
    TF1* fdscb_tmp = new TF1("fdscb_tmp",fnc_dscb,0.,3.,7);
    fdscb_tmp->SetNpx(1000);
    fdscb_tmp->SetParameter(0,fit_gaus_tmp->GetParameter(0));
    //norm
    fdscb_tmp->SetParLimits (0,0.5*fit_gaus_tmp->GetParameter(0),1.5*fit_gaus_tmp->GetParameter(0));
    fdscb_tmp->SetParameter(1,fit_gaus_tmp->GetParameter(1));
    //gaussian mean
    fdscb_tmp->SetParLimits (1,0.8,1.2);
    //fdscb_tmp->SetParameter(2,fit_gaus_tmp->GetParameter(2));
    //fdscb_tmp->SetParLimits(2,fit_gaus_tmp->GetParameter(2)*0.50,1.50*fit_gaus_tmp->GetParameter(2));
    std::vector<float>sigma2SFit=sigmaGaussianFits2Sigma(hist_vec_100_CT[i]);
    fdscb_tmp->SetParameter(2,sigma2SFit[0]);
    fdscb_tmp->SetParLimits(2,sigma2SFit[0]*0.50,1.50*sigma2SFit[0]);
    //-a1: parameter, from when the gaussian core should count
    fdscb_tmp->SetParameter(2,fit_gaus_tmp->GetParameter(2));
    fdscb_tmp->SetParameter (3,3.0);
    fdscb_tmp->SetParLimits (3,0.0,10.);
    //a2 parameter, up to when the gaussian core should count
    fdscb_tmp->SetParameter (5,3.0);
    fdscb_tmp->SetParLimits (5,0.0,10.);
    fdscb_tmp->SetParameter(4,5.);
    fdscb_tmp->SetParLimits(4,0.,30.);
    fdscb_tmp->SetParameter(6,5.);
    fdscb_tmp->SetParLimits(6,0.,30.);
    int fitstatus(0); 
    fitstatus = hist_vec_100_CT[i]->Fit(fdscb_tmp,"R");
    fdscb_tmp = hist_vec_100_CT[i]->GetFunction("fdscb_tmp");
    h_100_CT_DR06_E_SigmaCB_summary_histogram->SetBinContent(i-firstbin+1,fdscb_tmp->GetParameter(2)*100. );
    h_100_CT_DR06_E_SigmaCB_summary_histogram->SetBinError(i-firstbin+1,fdscb_tmp->GetParError(2)*100. );
  }  
  TH1F* h_100_CT_DR07_E_SigmaCB_summary_histogram=new TH1F("JER_SigmaCBVsCosTheta_CT_DR07_100", "#sigma (E_{j}^{reco} / E_{j}^{true}) vs |cos#theta|", nRegionBins, pRegionBinEdges);
  h_100_CT_DR07_E_SigmaCB_summary_histogram ->SetYTitle("#sigma(E_{j}) / E_{j} [%]");
  h_100_CT_DR07_E_SigmaCB_summary_histogram->SetXTitle("|cos#theta|");
  h_100_CT_DR07_E_SigmaCB_summary_histogram->SetLineWidth(2);
  h_100_CT_DR07_E_SigmaCB_summary_histogram->SetLineColor(kCyan+1);
  h_100_CT_DR07_E_SigmaCB_summary_histogram->SetLineStyle(2);
  TH1F* h_100_CT_DR07_E_RMS90_summary_histogram=new TH1F("JER_RMS90VsCosTheta_CT_DR07_100", "RMS_{90}(E_{j}^{reco}/E_{j}^{gen}) / Mean_{90}(E_{j}^{reco}/E_{j}^{gen}) vs |cos#theta|", nRegionBins, pRegionBinEdges);
  h_100_CT_DR07_E_RMS90_summary_histogram ->SetYTitle("RMS_{90}(E_{j}^{reco}/E_{j}^{gen}) / Mean_{90}(E_{j}^{reco}/E_{j}^{gen}) [%]");
  h_100_CT_DR07_E_RMS90_summary_histogram->SetXTitle("|cos#theta|");
  h_100_CT_DR07_E_RMS90_summary_histogram->SetLineWidth(2);
  h_100_CT_DR07_E_RMS90_summary_histogram->SetLineColor(kCyan+1);
  h_100_CT_DR07_E_RMS90_summary_histogram->SetLineStyle(2);

  TH1F* h_100_CT_DR07_E_RMS_summary_histogram=new TH1F("JER_RMSVsCosTheta_CT_DR07_100", "RMS(E_{j}) / Mean(E_{j}) vs |cos#theta|", nRegionBins, pRegionBinEdges);
  h_100_CT_DR07_E_RMS_summary_histogram ->SetYTitle("RMS(E_{j}) / Mean(E_{j}) [%]");
  h_100_CT_DR07_E_RMS_summary_histogram->SetXTitle("|cos#theta|");
  h_100_CT_DR07_E_RMS_summary_histogram->SetLineWidth(2);
  h_100_CT_DR07_E_RMS_summary_histogram->SetLineColor(kCyan+1);
  h_100_CT_DR07_E_RMS_summary_histogram->SetLineStyle(2);

  TH1F* h_100_CT_DR07_E_JER_Mean_summary_histogram=new TH1F("JER_MeanVsCosTheta_CT_DR07_100", "Mean(E_{tot}^{RECO}/E_{tot}^{true}) vs |cos#theta|", nRegionBins, pRegionBinEdges);
  h_100_CT_DR07_E_JER_Mean_summary_histogram->SetYTitle("Mean(E_{tot}^{RECO}/E_{tot}^{true})");
  h_100_CT_DR07_E_JER_Mean_summary_histogram->SetXTitle("|cos#theta|");
  h_100_CT_DR07_E_JER_Mean_summary_histogram->SetLineWidth(2);
  h_100_CT_DR07_E_JER_Mean_summary_histogram->SetLineColor(kCyan+1);
  h_100_CT_DR07_E_JER_Mean_summary_histogram->SetLineStyle(2);
  firstbin=85;
  std::cout<<"start DR07 noO CT 100 "<<std::endl;
  for(int i=firstbin;i<(firstbin+13);i++){
    //continue;
    resolutionTH1=0; 
    resolutionErrorTH1=0;
    meanTH1=0;
    meanErrorTH1=0;
    CalculatePerformance( hist_vec_100_CT[i], resolutionTH1, resolutionErrorTH1,meanTH1,meanErrorTH1);
    h_100_CT_DR07_E_RMS90_summary_histogram->SetBinContent(i-firstbin+1,resolutionTH1/sqrt(2.));
    h_100_CT_DR07_E_RMS90_summary_histogram ->SetBinError(i-firstbin+1, resolutionErrorTH1/sqrt(2.));
    h_100_CT_DR07_E_RMS_summary_histogram->SetBinContent(i-firstbin+1,hist_vec_100_CT[i]->GetRMS()*100. );
    h_100_CT_DR07_E_RMS_summary_histogram ->SetBinError(i-firstbin+1, hist_vec_100_CT[i]->GetRMSError()*100.);
    h_100_CT_DR07_E_JER_Mean_summary_histogram->SetBinContent(i-firstbin+1,hist_vec_100_CT[i]->GetMean());
    h_100_CT_DR07_E_JER_Mean_summary_histogram->SetBinError(i-firstbin+1,hist_vec_100_CT[i]->GetMeanError());
   //double sided crystal ball
    TF1* fit_gaus_tmp = new TF1("fit_gaus_tmp", "gaus",0.50,1.50);
    hist_vec_100_CT[i]->Fit("fit_gaus_tmp","R");
    hist_vec_100_CT[i]->GetFunction("fit_gaus_tmp");
    //TF1* fdscb_tmp = new TF1("fdscb_tmp",fnc_dscb,0.,3.,7);
    //fdscb_tmp->SetParameter(0,fit_gaus_tmp->GetParameter(0));
    //norm

    std::vector<float>sigma_gaus_temp=sigmaGaussianFits2Sigma(hist_vec_100_CT[i]);

    TF1* fdscb_tmp = new TF1("fdscb_tmp",fnc_dscb,0.,3.,7);
    fdscb_tmp->SetNpx(1000);
    fdscb_tmp->SetParameter(0,fit_gaus_tmp->GetParameter(0));
    //norm
    fdscb_tmp->SetParLimits (0,0.5*fit_gaus_tmp->GetParameter(0),1.5*fit_gaus_tmp->GetParameter(0));
    fdscb_tmp->SetParameter(1,fit_gaus_tmp->GetParameter(1));
    //gaussian mean
    fdscb_tmp->SetParLimits (1,0.8,1.2);
    std::vector<float>sigma2SFit=sigmaGaussianFits2Sigma(hist_vec_100_CT[i]);
    fdscb_tmp->SetParameter(2,sigma2SFit[0]);
    fdscb_tmp->SetParLimits(2,sigma2SFit[0]*0.50,1.50*sigma2SFit[0]);
    //fdscb_tmp->FixParameter(2,sigma_gaus_temp[0]);
    //fdscb_tmp->SetParLimits(2,fit_gaus_tmp->GetParameter(2)*0.50,1.50*fit_gaus_tmp->GetParameter(2));
    //-a1: parameter, from when the gaussian core should count
    //fdscb_tmp->SetParameter(2,fit_gaus_tmp->GetParameter(2));


    fdscb_tmp->SetParLimits (0,0.5*fit_gaus_tmp->GetParameter(0),1.5*fit_gaus_tmp->GetParameter(0));
    fdscb_tmp->SetParameter(1,fit_gaus_tmp->GetParameter(1));
    //gaussian mean
    fdscb_tmp->SetParLimits (1,0.8,1.2);
    //fdscb_tmp->SetParameter(2,fit_gaus_tmp->GetParameter(2));
    //fdscb_tmp->SetParLimits(2,fit_gaus_tmp->GetParameter(2)*0.50,1.50*fit_gaus_tmp->GetParameter(2));
    //-a1: parameter, from when the gaussian core should count
    //fdscb_tmp->SetParameter(2,fit_gaus_tmp->GetParameter(2));
    fdscb_tmp->SetParameter (3,3.0);
    fdscb_tmp->SetParLimits (3,0.0,10.);
    //a2 parameter, up to when the gaussian core should count
    fdscb_tmp->SetParameter (5,3.0);
    fdscb_tmp->SetParLimits (5,0.0,10.);
    fdscb_tmp->SetParameter(4,5.);
    fdscb_tmp->SetParLimits(4,0.,30.);
    fdscb_tmp->SetParameter(6,5.);
    fdscb_tmp->SetParLimits(6,0.,30.);
    int fitstatus(0); 
    fitstatus = hist_vec_100_CT[i]->Fit(fdscb_tmp,"R");
    fdscb_tmp = hist_vec_100_CT[i]->GetFunction("fdscb_tmp");
    h_100_CT_DR07_E_SigmaCB_summary_histogram->SetBinContent(i-firstbin+1,fdscb_tmp->GetParameter(2)*100. );
    h_100_CT_DR07_E_SigmaCB_summary_histogram->SetBinError(i-firstbin+1,fdscb_tmp->GetParError(2)*100. );
  }  
  std::cout<<"DR07 done "<<std::endl;

  TH1F* h_100_CT_DR08_E_SigmaCB_summary_histogram=new TH1F("JER_SigmaCBVsCosTheta_CT_DR08_100", "#sigma (E_{j}^{reco} / E_{j}^{true}) vs |cos#theta|", nRegionBins, pRegionBinEdges);
  h_100_CT_DR08_E_SigmaCB_summary_histogram ->SetYTitle("#sigma(E_{j}) / E_{j} [%]");
  h_100_CT_DR08_E_SigmaCB_summary_histogram->SetXTitle("|cos#theta|");
  h_100_CT_DR08_E_SigmaCB_summary_histogram->SetLineWidth(2);
  h_100_CT_DR08_E_SigmaCB_summary_histogram->SetLineColor(kCyan+1);
  h_100_CT_DR08_E_SigmaCB_summary_histogram->SetLineStyle(2);
  TH1F* h_100_CT_DR08_E_RMS90_summary_histogram=new TH1F("JER_RMS90VsCosTheta_CT_DR08_100", "RMS_{90}(E_{j}^{reco}/E_{j}^{gen}) / Mean_{90}(E_{j}^{reco}/E_{j}^{gen}) vs |cos#theta|", nRegionBins, pRegionBinEdges);
  h_100_CT_DR08_E_RMS90_summary_histogram ->SetYTitle("RMS_{90}(E_{j}^{reco}/E_{j}^{gen}) / Mean_{90}(E_{j}^{reco}/E_{j}^{gen}) [%]");
  h_100_CT_DR08_E_RMS90_summary_histogram->SetXTitle("|cos#theta|");
  h_100_CT_DR08_E_RMS90_summary_histogram->SetLineWidth(2);
  h_100_CT_DR08_E_RMS90_summary_histogram->SetLineColor(kCyan+1);
  h_100_CT_DR08_E_RMS90_summary_histogram->SetLineStyle(2);

  TH1F* h_100_CT_DR08_E_RMS_summary_histogram=new TH1F("JER_RMSVsCosTheta_CT_DR08_100", "RMS(E_{j}) / Mean(E_{j}) vs |cos#theta|", nRegionBins, pRegionBinEdges);
  h_100_CT_DR08_E_RMS_summary_histogram ->SetYTitle("RMS(E_{j}) / Mean(E_{j}) [%]");
  h_100_CT_DR08_E_RMS_summary_histogram->SetXTitle("|cos#theta|");
  h_100_CT_DR08_E_RMS_summary_histogram->SetLineWidth(2);
  h_100_CT_DR08_E_RMS_summary_histogram->SetLineColor(kCyan+1);
  h_100_CT_DR08_E_RMS_summary_histogram->SetLineStyle(2);

  TH1F* h_100_CT_DR08_E_JER_Mean_summary_histogram=new TH1F("JER_MeanVsCosTheta_CT_DR08_100", "Mean(E_{tot}^{RECO}/E_{tot}^{true}) vs |cos#theta|", nRegionBins, pRegionBinEdges);
  h_100_CT_DR08_E_JER_Mean_summary_histogram->SetYTitle("Mean(E_{tot}^{RECO}/E_{tot}^{true})");
  h_100_CT_DR08_E_JER_Mean_summary_histogram->SetXTitle("|cos#theta|");
  h_100_CT_DR08_E_JER_Mean_summary_histogram->SetLineWidth(2);
  h_100_CT_DR08_E_JER_Mean_summary_histogram->SetLineColor(kCyan+1);
  h_100_CT_DR08_E_JER_Mean_summary_histogram->SetLineStyle(2);
  firstbin=98;
  for(int i=firstbin;i<(firstbin+13);i++){
    //continue;
    resolutionTH1=0; 
    resolutionErrorTH1=0;
    meanTH1=0;
    meanErrorTH1=0;
    CalculatePerformance( hist_vec_100_CT[i], resolutionTH1, resolutionErrorTH1,meanTH1,meanErrorTH1);
    h_100_CT_DR08_E_RMS90_summary_histogram->SetBinContent(i-firstbin+1,resolutionTH1/sqrt(2.));
    h_100_CT_DR08_E_RMS90_summary_histogram ->SetBinError(i-firstbin+1, resolutionErrorTH1/sqrt(2.));
    h_100_CT_DR08_E_RMS_summary_histogram->SetBinContent(i-firstbin+1,hist_vec_100_CT[i]->GetRMS()*100. );
    h_100_CT_DR08_E_RMS_summary_histogram ->SetBinError(i-firstbin+1, hist_vec_100_CT[i]->GetRMSError()*100.);
    h_100_CT_DR08_E_JER_Mean_summary_histogram->SetBinContent(i-firstbin+1,hist_vec_100_CT[i]->GetMean());
    h_100_CT_DR08_E_JER_Mean_summary_histogram->SetBinError(i-firstbin+1,hist_vec_100_CT[i]->GetMeanError());
    //double sided crystal ball
    TF1* fit_gaus_tmp = new TF1("fit_gaus_tmp", "gaus",0.50,1.50);
    hist_vec_100_CT[i]->Fit("fit_gaus_tmp","R");
    hist_vec_100_CT[i]->GetFunction("fit_gaus_tmp");
    TF1* fdscb_tmp = new TF1("fdscb_tmp",fnc_dscb,0.,3.,7);
    fdscb_tmp->SetNpx(1000);
    fdscb_tmp->SetParameter(0,fit_gaus_tmp->GetParameter(0));
    //norm
    fdscb_tmp->SetParLimits (0,0.5*fit_gaus_tmp->GetParameter(0),1.5*fit_gaus_tmp->GetParameter(0));
    fdscb_tmp->SetParameter(1,fit_gaus_tmp->GetParameter(1));
    //gaussian mean
    fdscb_tmp->SetParLimits (1,0.8,1.2);
    //fdscb_tmp->SetParameter(2,fit_gaus_tmp->GetParameter(2));
    //fdscb_tmp->SetParLimits(2,fit_gaus_tmp->GetParameter(2)*0.50,1.50*fit_gaus_tmp->GetParameter(2));
    std::vector<float>sigma2SFit=sigmaGaussianFits2Sigma(hist_vec_100_CT[i]);
    fdscb_tmp->SetParameter(2,sigma2SFit[0]);
    fdscb_tmp->SetParLimits(2,sigma2SFit[0]*0.50,1.50*sigma2SFit[0]);
    //-a1: parameter, from when the gaussian core should count
    fdscb_tmp->SetParameter(2,fit_gaus_tmp->GetParameter(2));
    fdscb_tmp->SetParameter (3,3.0);
    fdscb_tmp->SetParLimits (3,0.0,10.);
    //a2 parameter, up to when the gaussian core should count
    fdscb_tmp->SetParameter (5,3.0);
    fdscb_tmp->SetParLimits (5,0.0,10.);
    fdscb_tmp->SetParameter(4,5.);
    fdscb_tmp->SetParLimits(4,0.,30.);
    fdscb_tmp->SetParameter(6,5.);
    fdscb_tmp->SetParLimits(6,0.,30.);
    int fitstatus(0); 
    fitstatus = hist_vec_100_CT[i]->Fit(fdscb_tmp,"R");
    fdscb_tmp = hist_vec_100_CT[i]->GetFunction("fdscb_tmp");
    h_100_CT_DR08_E_SigmaCB_summary_histogram->SetBinContent(i-firstbin+1,fdscb_tmp->GetParameter(2)*100. );
    h_100_CT_DR08_E_SigmaCB_summary_histogram->SetBinError(i-firstbin+1,fdscb_tmp->GetParError(2)*100. );
  }  
  TH1F* h_100_CT_DR09_E_SigmaCB_summary_histogram=new TH1F("JER_SigmaCBVsCosTheta_CT_DR09_100", "#sigma (E_{j}^{reco} / E_{j}^{true}) vs |cos#theta|", nRegionBins, pRegionBinEdges);
  h_100_CT_DR09_E_SigmaCB_summary_histogram ->SetYTitle("#sigma(E_{j}) / E_{j} [%]");
  h_100_CT_DR09_E_SigmaCB_summary_histogram->SetXTitle("|cos#theta|");
  h_100_CT_DR09_E_SigmaCB_summary_histogram->SetLineWidth(2);
  h_100_CT_DR09_E_SigmaCB_summary_histogram->SetLineColor(kCyan+1);
  h_100_CT_DR09_E_SigmaCB_summary_histogram->SetLineStyle(2);
  TH1F* h_100_CT_DR09_E_RMS90_summary_histogram=new TH1F("JER_RMS90VsCosTheta_CT_DR09_100", "RMS_{90}(E_{j}^{reco}/E_{j}^{gen}) / Mean_{90}(E_{j}^{reco}/E_{j}^{gen}) vs |cos#theta|", nRegionBins, pRegionBinEdges);
  h_100_CT_DR09_E_RMS90_summary_histogram ->SetYTitle("RMS_{90}(E_{j}^{reco}/E_{j}^{gen}) / Mean_{90}(E_{j}^{reco}/E_{j}^{gen}) [%]");
  h_100_CT_DR09_E_RMS90_summary_histogram->SetXTitle("|cos#theta|");
  h_100_CT_DR09_E_RMS90_summary_histogram->SetLineWidth(2);
  h_100_CT_DR09_E_RMS90_summary_histogram->SetLineColor(kCyan+1);
  h_100_CT_DR09_E_RMS90_summary_histogram->SetLineStyle(2);

  TH1F* h_100_CT_DR09_E_RMS_summary_histogram=new TH1F("JER_RMSVsCosTheta_CT_DR09_100", "RMS(E_{j}) / Mean(E_{j}) vs |cos#theta|", nRegionBins, pRegionBinEdges);
  h_100_CT_DR09_E_RMS_summary_histogram ->SetYTitle("RMS(E_{j}) / Mean(E_{j}) [%]");
  h_100_CT_DR09_E_RMS_summary_histogram->SetXTitle("|cos#theta|");
  h_100_CT_DR09_E_RMS_summary_histogram->SetLineWidth(2);
  h_100_CT_DR09_E_RMS_summary_histogram->SetLineColor(kCyan+1);
  h_100_CT_DR09_E_RMS_summary_histogram->SetLineStyle(2);

  TH1F* h_100_CT_DR09_E_JER_Mean_summary_histogram=new TH1F("JER_MeanVsCosTheta_CT_DR09_100", "Mean(E_{tot}^{RECO}/E_{tot}^{true}) vs |cos#theta|", nRegionBins, pRegionBinEdges);
  h_100_CT_DR09_E_JER_Mean_summary_histogram->SetYTitle("Mean(E_{tot}^{RECO}/E_{tot}^{true})");
  h_100_CT_DR09_E_JER_Mean_summary_histogram->SetXTitle("|cos#theta|");
  h_100_CT_DR09_E_JER_Mean_summary_histogram->SetLineWidth(2);
  h_100_CT_DR09_E_JER_Mean_summary_histogram->SetLineColor(kCyan+1);
  h_100_CT_DR09_E_JER_Mean_summary_histogram->SetLineStyle(2);
  firstbin=111;
  for(int i=firstbin;i<(firstbin+13);i++){
    //continue;
    resolutionTH1=0; 
    resolutionErrorTH1=0;
    meanTH1=0;
    meanErrorTH1=0;
    CalculatePerformance( hist_vec_100_CT[i], resolutionTH1, resolutionErrorTH1,meanTH1,meanErrorTH1);
    h_100_CT_DR09_E_RMS90_summary_histogram->SetBinContent(i-firstbin+1,resolutionTH1/sqrt(2.));
    h_100_CT_DR09_E_RMS90_summary_histogram ->SetBinError(i-firstbin+1, resolutionErrorTH1/sqrt(2.));
    h_100_CT_DR09_E_RMS_summary_histogram->SetBinContent(i-firstbin+1,hist_vec_100_CT[i]->GetRMS()*100. );
    h_100_CT_DR09_E_RMS_summary_histogram ->SetBinError(i-firstbin+1, hist_vec_100_CT[i]->GetRMSError()*100.);
    h_100_CT_DR09_E_JER_Mean_summary_histogram->SetBinContent(i-firstbin+1,hist_vec_100_CT[i]->GetMean());
    h_100_CT_DR09_E_JER_Mean_summary_histogram->SetBinError(i-firstbin+1,hist_vec_100_CT[i]->GetMeanError());
   //double sided crystal ball
    TF1* fit_gaus_tmp = new TF1("fit_gaus_tmp", "gaus",0.50,1.50);
    hist_vec_100_CT[i]->Fit("fit_gaus_tmp","R");
    hist_vec_100_CT[i]->GetFunction("fit_gaus_tmp");
    TF1* fdscb_tmp = new TF1("fdscb_tmp",fnc_dscb,0.,3.,7);
   fdscb_tmp->SetNpx(1000);
    fdscb_tmp->SetParameter(0,fit_gaus_tmp->GetParameter(0));
    //norm
    fdscb_tmp->SetParLimits (0,0.5*fit_gaus_tmp->GetParameter(0),1.5*fit_gaus_tmp->GetParameter(0));
    fdscb_tmp->SetParameter(1,fit_gaus_tmp->GetParameter(1));
    //gaussian mean
    fdscb_tmp->SetParLimits (1,0.8,1.2);
    //fdscb_tmp->SetParameter(2,fit_gaus_tmp->GetParameter(2));
    //fdscb_tmp->SetParLimits(2,fit_gaus_tmp->GetParameter(2)*0.50,1.50*fit_gaus_tmp->GetParameter(2));
    std::vector<float>sigma2SFit=sigmaGaussianFits2Sigma(hist_vec_100_CT[i]);
    fdscb_tmp->SetParameter(2,sigma2SFit[0]);
    fdscb_tmp->SetParLimits(2,sigma2SFit[0]*0.50,1.50*sigma2SFit[0]);
    //-a1: parameter, from when the gaussian core should count
    fdscb_tmp->SetParameter(2,fit_gaus_tmp->GetParameter(2));
    fdscb_tmp->SetParameter (3,3.0);
    fdscb_tmp->SetParLimits (3,0.0,10.);
    //a2 parameter, up to when the gaussian core should count
    fdscb_tmp->SetParameter (5,3.0);
    fdscb_tmp->SetParLimits (5,0.0,10.);
    fdscb_tmp->SetParameter(4,5.);
    fdscb_tmp->SetParLimits(4,0.,30.);
    fdscb_tmp->SetParameter(6,5.);
    fdscb_tmp->SetParLimits(6,0.,30.);
    int fitstatus(0); 
    fitstatus = hist_vec_100_CT[i]->Fit(fdscb_tmp,"R");
    fdscb_tmp = hist_vec_100_CT[i]->GetFunction("fdscb_tmp");
    h_100_CT_DR09_E_SigmaCB_summary_histogram->SetBinContent(i-firstbin+1,fdscb_tmp->GetParameter(2)*100. );
    h_100_CT_DR09_E_SigmaCB_summary_histogram->SetBinError(i-firstbin+1,fdscb_tmp->GetParError(2)*100. );
  }  
  TH1F* h_100_CT_DR10_E_SigmaCB_summary_histogram=new TH1F("JER_SigmaCBVsCosTheta_CT_DR10_100", "#sigma (E_{j}^{reco} / E_{j}^{true}) vs |cos#theta|", nRegionBins, pRegionBinEdges);
  h_100_CT_DR10_E_SigmaCB_summary_histogram ->SetYTitle("#sigma(E_{j}) / E_{j} [%]");
  h_100_CT_DR10_E_SigmaCB_summary_histogram->SetXTitle("|cos#theta|");
  h_100_CT_DR10_E_SigmaCB_summary_histogram->SetLineWidth(2);
  h_100_CT_DR10_E_SigmaCB_summary_histogram->SetLineColor(kCyan+1);
  h_100_CT_DR10_E_SigmaCB_summary_histogram->SetLineStyle(2);
  TH1F* h_100_CT_DR10_E_RMS90_summary_histogram=new TH1F("JER_RMS90VsCosTheta_CT_DR10_100", "RMS_{90}(E_{j}^{reco}/E_{j}^{gen}) / Mean_{90}(E_{j}^{reco}/E_{j}^{gen}) vs |cos#theta|", nRegionBins, pRegionBinEdges);
  h_100_CT_DR10_E_RMS90_summary_histogram ->SetYTitle("RMS_{90}(E_{j}^{reco}/E_{j}^{gen}) / Mean_{90}(E_{j}^{reco}/E_{j}^{gen}) [%]");
  h_100_CT_DR10_E_RMS90_summary_histogram->SetXTitle("|cos#theta|");
  h_100_CT_DR10_E_RMS90_summary_histogram->SetLineWidth(2);
  h_100_CT_DR10_E_RMS90_summary_histogram->SetLineColor(kCyan+1);
  h_100_CT_DR10_E_RMS90_summary_histogram->SetLineStyle(2);

  TH1F* h_100_CT_DR10_E_RMS_summary_histogram=new TH1F("JER_RMSVsCosTheta_CT_DR10_100", "RMS(E_{j}) / Mean(E_{j}) vs |cos#theta|", nRegionBins, pRegionBinEdges);
  h_100_CT_DR10_E_RMS_summary_histogram ->SetYTitle("RMS(E_{j}) / Mean(E_{j}) [%]");
  h_100_CT_DR10_E_RMS_summary_histogram->SetXTitle("|cos#theta|");
  h_100_CT_DR10_E_RMS_summary_histogram->SetLineWidth(2);
  h_100_CT_DR10_E_RMS_summary_histogram->SetLineColor(kCyan+1);
  h_100_CT_DR10_E_RMS_summary_histogram->SetLineStyle(2);

  TH1F* h_100_CT_DR10_E_JER_Mean_summary_histogram=new TH1F("JER_MeanVsCosTheta_CT_DR10_100", "Mean(E_{tot}^{RECO}/E_{tot}^{true}) vs |cos#theta|", nRegionBins, pRegionBinEdges);
  h_100_CT_DR10_E_JER_Mean_summary_histogram->SetYTitle("Mean(E_{tot}^{RECO}/E_{tot}^{true})");
  h_100_CT_DR10_E_JER_Mean_summary_histogram->SetXTitle("|cos#theta|");
  h_100_CT_DR10_E_JER_Mean_summary_histogram->SetLineWidth(2);
  h_100_CT_DR10_E_JER_Mean_summary_histogram->SetLineColor(kCyan+1);
  h_100_CT_DR10_E_JER_Mean_summary_histogram->SetLineStyle(2);
  firstbin=124;
  std::cout<<"start DR10 noO 100"<<std::endl;
  for(int i=firstbin;i<(firstbin+13);i++){
    //continue;
    resolutionTH1=0; 
    resolutionErrorTH1=0;
    meanTH1=0;
    meanErrorTH1=0;
    CalculatePerformance( hist_vec_100_CT[i], resolutionTH1, resolutionErrorTH1,meanTH1,meanErrorTH1);
    h_100_CT_DR10_E_RMS90_summary_histogram->SetBinContent(i-firstbin+1,resolutionTH1/sqrt(2.));
    h_100_CT_DR10_E_RMS90_summary_histogram ->SetBinError(i-firstbin+1, resolutionErrorTH1/sqrt(2.));
    h_100_CT_DR10_E_RMS_summary_histogram->SetBinContent(i-firstbin+1,hist_vec_100_CT[i]->GetRMS()*100. );
    h_100_CT_DR10_E_RMS_summary_histogram ->SetBinError(i-firstbin+1, hist_vec_100_CT[i]->GetRMSError()*100.);
    h_100_CT_DR10_E_JER_Mean_summary_histogram->SetBinContent(i-firstbin+1,hist_vec_100_CT[i]->GetMean());
    h_100_CT_DR10_E_JER_Mean_summary_histogram->SetBinError(i-firstbin+1,hist_vec_100_CT[i]->GetMeanError());
    //double sided crystal ball
    TF1* fit_gaus_tmp = new TF1("fit_gaus_tmp", "gaus",0.50,1.50);
    hist_vec_100_CT[i]->Fit("fit_gaus_tmp","R");
    hist_vec_100_CT[i]->GetFunction("fit_gaus_tmp");
    TF1* fdscb_tmp = new TF1("fdscb_tmp",fnc_dscb,0.,3.,7);
   fdscb_tmp->SetNpx(1000);
    fdscb_tmp->SetParameter(0,fit_gaus_tmp->GetParameter(0));
    //norm
    fdscb_tmp->SetParLimits (0,0.5*fit_gaus_tmp->GetParameter(0),1.5*fit_gaus_tmp->GetParameter(0));
    fdscb_tmp->SetParameter(1,fit_gaus_tmp->GetParameter(1));
    //gaussian mean
    fdscb_tmp->SetParLimits (1,0.8,1.2);
    //fdscb_tmp->SetParameter(2,fit_gaus_tmp->GetParameter(2));
    //fdscb_tmp->SetParLimits(2,fit_gaus_tmp->GetParameter(2)*0.50,1.50*fit_gaus_tmp->GetParameter(2));
    std::vector<float>sigma2SFit=sigmaGaussianFits2Sigma(hist_vec_100_CT[i]);
    fdscb_tmp->SetParameter(2,sigma2SFit[0]);
    fdscb_tmp->SetParLimits(2,sigma2SFit[0]*0.50,1.50*sigma2SFit[0]);
    //-a1: parameter, from when the gaussian core should count
    fdscb_tmp->SetParameter(2,fit_gaus_tmp->GetParameter(2));
    fdscb_tmp->SetParameter (3,3.0);
    fdscb_tmp->SetParLimits (3,0.0,10.);
    //a2 parameter, up to when the gaussian core should count
    fdscb_tmp->SetParameter (5,3.0);
    fdscb_tmp->SetParLimits (5,0.0,10.);
    fdscb_tmp->SetParameter(4,5.);
    fdscb_tmp->SetParLimits(4,0.,30.);
    fdscb_tmp->SetParameter(6,5.);
    fdscb_tmp->SetParLimits(6,0.,30.);
    int fitstatus(0); 
    fitstatus = hist_vec_100_CT[i]->Fit(fdscb_tmp,"R");
    fdscb_tmp = hist_vec_100_CT[i]->GetFunction("fdscb_tmp");
    h_100_CT_DR10_E_SigmaCB_summary_histogram->SetBinContent(i-firstbin+1,fdscb_tmp->GetParameter(2)*100. );
    h_100_CT_DR10_E_SigmaCB_summary_histogram->SetBinError(i-firstbin+1,fdscb_tmp->GetParError(2)*100. );
  }  
  std::cout<<"end DR10 noO 100"<<std::endl;

  std::cout<<"100 03/04/05/06 "<< calculate_over90(h_100_CT_recojet03_E1_E2_over_E_True)<<"/"<< calculate_over90(h_100_CT_recojet04_E1_E2_over_E_True)<<"/"<< calculate_over90(h_100_CT_recojet05_E1_E2_over_E_True)<<"/"<<calculate_over90(h_100_CT_recojet06_E1_E2_over_E_True)<<" 07/08/09/10 "<< calculate_over90(h_100_CT_recojet07_E1_E2_over_E_True)<<"/"<< calculate_over90(h_100_CT_recojet08_E1_E2_over_E_True)<<"/"<< calculate_over90(h_100_CT_recojet09_E1_E2_over_E_True)<<"/"<<calculate_over90(h_100_CT_recojet10_E1_E2_over_E_True)<<std::endl;
  std::cout<<"jet histos 100 CT filled"<<std::endl;



  TH1F* h_100_CT_wO_genjet03_dphi_j1j2 =  new TH1F("h_100_CT_wO_genjet03_dphi_j1j2","", n_bins100, 0.5,TMath::Pi());
  TH1F* h_100_CT_wO_genjet03_E1_E2_over_E_True =  new TH1F("h_100_CT_wO_genjet03_E1_E2_over_E_True","", n_bins100, 0.5,1.00);
  TH1F* h_100_CT_wO_genjet03_Delta_E1_E2_over_E12 =  new TH1F("h_100_CT_wO_genjet03_Delta_E1_E2_over_E12","", n_bins100, -0.5,0.5);
  TH1F* h_100_CT_wO_genjet04_dphi_j1j2 =  new TH1F("h_100_CT_wO_genjet04_dphi_j1j2","", n_bins100, 0.5,TMath::Pi());
  TH1F* h_100_CT_wO_genjet04_E1_E2_over_E_True =  new TH1F("h_100_CT_wO_genjet04_E1_E2_over_E_True","", n_bins100, 0.5,1.00);
  TH1F* h_100_CT_wO_genjet04_Delta_E1_E2_over_E12 =  new TH1F("h_100_CT_wO_genjet04_Delta_E1_E2_over_E12","", n_bins100, -0.5,0.5);
  TH1F* h_100_CT_wO_genjet05_dphi_j1j2 =  new TH1F("h_100_CT_wO_genjet05_dphi_j1j2","", n_bins100, 0.5,TMath::Pi());
  TH1F* h_100_CT_wO_genjet05_E1_E2_over_E_True =  new TH1F("h_100_CT_wO_genjet05_E1_E2_over_E_True","", n_bins100, 0.5,1.00);
  TH1F* h_100_CT_wO_genjet05_Delta_E1_E2_over_E12 =  new TH1F("h_100_CT_wO_genjet05_Delta_E1_E2_over_E12","", n_bins100, -0.5,0.5);
  TH1F* h_100_CT_wO_genjet06_dphi_j1j2 =  new TH1F("h_100_CT_wO_genjet06_dphi_j1j2","", n_bins100, 0.5,TMath::Pi());
  TH1F* h_100_CT_wO_genjet06_E1_E2_over_E_True =  new TH1F("h_100_CT_wO_genjet06_E1_E2_over_E_True","", n_bins100, 0.5,1.00);
  TH1F* h_100_CT_wO_genjet06_Delta_E1_E2_over_E12 =  new TH1F("h_100_CT_wO_genjet06_Delta_E1_E2_over_E12","", n_bins100, -0.5,0.5);
  TH1F* h_100_CT_wO_genjet07_dphi_j1j2 =  new TH1F("h_100_CT_wO_genjet07_dphi_j1j2","", n_bins100, 0.5,TMath::Pi());
  TH1F* h_100_CT_wO_genjet07_E1_E2_over_E_True =  new TH1F("h_100_CT_wO_genjet07_E1_E2_over_E_True","", n_bins100, 0.5,1.00);
  TH1F* h_100_CT_wO_genjet07_Delta_E1_E2_over_E12 =  new TH1F("h_100_CT_wO_genjet07_Delta_E1_E2_over_E12","", n_bins100, -0.5,0.5);
  TH1F* h_100_CT_wO_genjet08_dphi_j1j2 =  new TH1F("h_100_CT_wO_genjet08_dphi_j1j2","", n_bins100, 0.5,TMath::Pi());
  TH1F* h_100_CT_wO_genjet08_E1_E2_over_E_True =  new TH1F("h_100_CT_wO_genjet08_E1_E2_over_E_True","", n_bins100, 0.5,1.00);
  TH1F* h_100_CT_wO_genjet08_Delta_E1_E2_over_E12 =  new TH1F("h_100_CT_wO_genjet08_Delta_E1_E2_over_E12","", n_bins100, -0.5,0.5);
  TH1F* h_100_CT_wO_genjet09_dphi_j1j2 =  new TH1F("h_100_CT_wO_genjet09_dphi_j1j2","", n_bins100, 0.5,TMath::Pi());
  TH1F* h_100_CT_wO_genjet09_E1_E2_over_E_True =  new TH1F("h_100_CT_wO_genjet09_E1_E2_over_E_True","", n_bins100, 0.5,1.00);
  TH1F* h_100_CT_wO_genjet09_Delta_E1_E2_over_E12 =  new TH1F("h_100_CT_wO_genjet09_Delta_E1_E2_over_E12","", n_bins100, -0.5,0.5);
  TH1F* h_100_CT_wO_genjet10_dphi_j1j2 =  new TH1F("h_100_CT_wO_genjet10_dphi_j1j2","", n_bins100, 0.5,TMath::Pi());
  TH1F* h_100_CT_wO_genjet10_E1_E2_over_E_True =  new TH1F("h_100_CT_wO_genjet10_E1_E2_over_E_True","", n_bins100, 0.5,1.00);
  TH1F* h_100_CT_wO_genjet10_Delta_E1_E2_over_E12 =  new TH1F("h_100_CT_wO_genjet10_Delta_E1_E2_over_E12","", n_bins100, -0.5,0.5);

  TH1F* h_100_CT_wO_recojet03_dphi_j1j2 =  new TH1F("h_100_CT_wO_recojet03_dphi_j1j2","", n_bins100, 0.5,TMath::Pi());
  TH1F* h_100_CT_wO_recojet03_E1_E2_over_E_True =  new TH1F("h_100_CT_wO_recojet03_E1_E2_over_E_True","", n_bins100, 0.5,1.00);
  TH1F* h_100_CT_wO_recojet03_Delta_E1_E2_over_E12 =  new TH1F("h_100_CT_wO_recojet03_Delta_E1_E2_over_E12","", n_bins100, -0.5,0.5);
  TH1F* h_100_CT_wO_recojet04_dphi_j1j2 =  new TH1F("h_100_CT_wO_recojet04_dphi_j1j2","", n_bins100, 0.5,TMath::Pi());
  TH1F* h_100_CT_wO_recojet04_E1_E2_over_E_True =  new TH1F("h_100_CT_wO_recojet04_E1_E2_over_E_True","", n_bins100, 0.5,1.00);
  TH1F* h_100_CT_wO_recojet04_Delta_E1_E2_over_E12 =  new TH1F("h_100_CT_wO_recojet04_Delta_E1_E2_over_E12","", n_bins100, -0.5,0.5);
  TH1F* h_100_CT_wO_recojet05_dphi_j1j2 =  new TH1F("h_100_CT_wO_recojet05_dphi_j1j2","", n_bins100, 0.5,TMath::Pi());
  TH1F* h_100_CT_wO_recojet05_E1_E2_over_E_True =  new TH1F("h_100_CT_wO_recojet05_E1_E2_over_E_True","", n_bins100, 0.5,1.00);
  TH1F* h_100_CT_wO_recojet05_Delta_E1_E2_over_E12 =  new TH1F("h_100_CT_wO_recojet05_Delta_E1_E2_over_E12","", n_bins100, -0.5,0.5);
  TH1F* h_100_CT_wO_recojet06_dphi_j1j2 =  new TH1F("h_100_CT_wO_recojet06_dphi_j1j2","", n_bins100, 0.5,TMath::Pi());
  TH1F* h_100_CT_wO_recojet06_E1_E2_over_E_True =  new TH1F("h_100_CT_wO_recojet06_E1_E2_over_E_True","", n_bins100, 0.5,1.00);
  TH1F* h_100_CT_wO_recojet06_Delta_E1_E2_over_E12 =  new TH1F("h_100_CT_wO_recojet06_Delta_E1_E2_over_E12","", n_bins100, -0.5,0.5);
  TH1F* h_100_CT_wO_recojet07_dphi_j1j2 =  new TH1F("h_100_CT_wO_recojet07_dphi_j1j2","", n_bins100, 0.5,TMath::Pi());
  TH1F* h_100_CT_wO_recojet07_E1_E2_over_E_True =  new TH1F("h_100_CT_wO_recojet07_E1_E2_over_E_True","", n_bins100, 0.5,1.00);
  TH1F* h_100_CT_wO_recojet07_Delta_E1_E2_over_E12 =  new TH1F("h_100_CT_wO_recojet07_Delta_E1_E2_over_E12","", n_bins100, -0.5,0.5);
  TH1F* h_100_CT_wO_recojet08_dphi_j1j2 =  new TH1F("h_100_CT_wO_recojet08_dphi_j1j2","", n_bins100, 0.5,TMath::Pi());
  TH1F* h_100_CT_wO_recojet08_E1_E2_over_E_True =  new TH1F("h_100_CT_wO_recojet08_E1_E2_over_E_True","", n_bins100, 0.5,1.00);
  TH1F* h_100_CT_wO_recojet08_Delta_E1_E2_over_E12 =  new TH1F("h_100_CT_wO_recojet08_Delta_E1_E2_over_E12","", n_bins100, -0.5,0.5);
  TH1F* h_100_CT_wO_recojet09_dphi_j1j2 =  new TH1F("h_100_CT_wO_recojet09_dphi_j1j2","", n_bins100, 0.5,TMath::Pi());
  TH1F* h_100_CT_wO_recojet09_E1_E2_over_E_True =  new TH1F("h_100_CT_wO_recojet09_E1_E2_over_E_True","", n_bins100, 0.5,1.00);
  TH1F* h_100_CT_wO_recojet09_Delta_E1_E2_over_E12 =  new TH1F("h_100_CT_wO_recojet09_Delta_E1_E2_over_E12","", n_bins100, -0.5,0.5);
  TH1F* h_100_CT_wO_recojet10_dphi_j1j2 =  new TH1F("h_100_CT_wO_recojet10_dphi_j1j2","", n_bins100, 0.5,TMath::Pi());
  TH1F* h_100_CT_wO_recojet10_E1_E2_over_E_True =  new TH1F("h_100_CT_wO_recojet10_E1_E2_over_E_True","", n_bins100, 0.5,1.00);
  TH1F* h_100_CT_wO_recojet10_Delta_E1_E2_over_E12 =  new TH1F("h_100_CT_wO_recojet10_Delta_E1_E2_over_E12","", n_bins100, -0.5,0.5);

  TH1F* h_100_CT_wO_recojetE_over_genjetE_DR03 =  new TH1F("h_100_CT_wO_recojetE_over_genjetE_DR03","", n_bins100, 0.5,1.5);
  TH1F* h_100_CT_wO_recojetE_over_genjetE_DR04 =  new TH1F("h_100_CT_wO_recojetE_over_genjetE_DR04","", n_bins100, 0.5,1.5);
  TH1F* h_100_CT_wO_recojetE_over_genjetE_DR05 =  new TH1F("h_100_CT_wO_recojetE_over_genjetE_DR05","", n_bins100, 0.5,1.5);
  TH1F* h_100_CT_wO_recojetE_over_genjetE_DR06 =  new TH1F("h_100_CT_wO_recojetE_over_genjetE_DR06","", n_bins100, 0.5,1.5);
  TH1F* h_100_CT_wO_recojetE_over_genjetE_DR07 =  new TH1F("h_100_CT_wO_recojetE_over_genjetE_DR07","", n_bins100, 0.5,1.5);
  TH1F* h_100_CT_wO_recojetE_over_genjetE_DR08 =  new TH1F("h_100_CT_wO_recojetE_over_genjetE_DR08","", n_bins100, 0.5,1.5);
  TH1F* h_100_CT_wO_recojetE_over_genjetE_DR09 =  new TH1F("h_100_CT_wO_recojetE_over_genjetE_DR09","", n_bins100, 0.5,1.5);
  TH1F* h_100_CT_wO_recojetE_over_genjetE_DR10 =  new TH1F("h_100_CT_wO_recojetE_over_genjetE_DR10","", n_bins100, 0.5,1.5);

  TH1F* h_100_CT_wO_dphi_gen_reco_DR05 =  new TH1F("h_100_CT_wO_dphi_gen_reco_DR05","", n_bins100, -0.1,9.9);
  TH1F* h_100_CT_wO_dphi_gen_reco_DR06 =  new TH1F("h_100_CT_wO_dphi_gen_reco_DR06","", n_bins100, -0.1,9.9);
  TH1F* h_100_CT_wO_dphi_gen_reco_DR07 =  new TH1F("h_100_CT_wO_dphi_gen_reco_DR07","", n_bins100, -0.1,9.9);

  TH1F* h_100_CT_wO_DR05_E_rel_totVis_RMS_d1_cosT_0_to_0_10 =  new TH1F("h_100_CT_wO_DR05_E_rel_totVis_RMS_d1_cosT_0_to_0_10","", n_binsJER, lim_E_rel_low,lim_E_rel_high);
  TH1F* h_100_CT_wO_DR05_E_rel_totVis_RMS_d1_cosT_0_10_to_0_20 =  new TH1F("h_100_CT_wO_DR05_E_rel_totVis_RMS_d1_cosT_0_10_to_0_20","", n_binsJER, lim_E_rel_low,lim_E_rel_high);
  TH1F* h_100_CT_wO_DR05_E_rel_totVis_RMS_d1_cosT_0_20_to_0_30 =  new TH1F("h_100_CT_wO_DR05_E_rel_totVis_RMS_d1_cosT_0_20_to_0_30","", n_binsJER, lim_E_rel_low,lim_E_rel_high);
  TH1F* h_100_CT_wO_DR05_E_rel_totVis_RMS_d1_cosT_0_30_to_0_40 =  new TH1F("h_100_CT_wO_DR05_E_rel_totVis_RMS_d1_cosT_0_30_to_0_40","", n_binsJER, lim_E_rel_low,lim_E_rel_high);
  TH1F* h_100_CT_wO_DR05_E_rel_totVis_RMS_d1_cosT_0_40_to_0_50 =  new TH1F("h_100_CT_wO_DR05_E_rel_totVis_RMS_d1_cosT_0_40_to_0_50","", n_binsJER, lim_E_rel_low,lim_E_rel_high);
  TH1F* h_100_CT_wO_DR05_E_rel_totVis_RMS_d1_cosT_0_50_to_0_60 =  new TH1F("h_100_CT_wO_DR05_E_rel_totVis_RMS_d1_cosT_0_50_to_0_60","", n_binsJER, lim_E_rel_low,lim_E_rel_high);
  TH1F* h_100_CT_wO_DR05_E_rel_totVis_RMS_d1_cosT_0_60_to_0_70 =  new TH1F("h_100_CT_wO_DR05_E_rel_totVis_RMS_d1_cosT_0_60_to_0_70","", n_binsJER, lim_E_rel_low,lim_E_rel_high);
  TH1F* h_100_CT_wO_DR05_E_rel_totVis_RMS_d1_cosT_0_70_to_0_80 =  new TH1F("h_100_CT_wO_DR05_E_rel_totVis_RMS_d1_cosT_0_70_to_0_80","", n_binsJER, lim_E_rel_low,lim_E_rel_high);
  TH1F* h_100_CT_wO_DR05_E_rel_totVis_RMS_d1_cosT_0_80_to_0_90 =  new TH1F("h_100_CT_wO_DR05_E_rel_totVis_RMS_d1_cosT_0_80_to_0_90","", n_binsJER, lim_E_rel_low,lim_E_rel_high);
  TH1F* h_100_CT_wO_DR05_E_rel_totVis_RMS_d1_cosT_0_900_to_0_925 =  new TH1F("h_100_CT_wO_DR05_E_rel_totVis_RMS_d1_cosT_0_900_to_0_925","", n_binsJER_FW, lim_E_rel_low,lim_E_rel_high);
  TH1F* h_100_CT_wO_DR05_E_rel_totVis_RMS_d1_cosT_0_925_to_0_950 =  new TH1F("h_100_CT_wO_DR05_E_rel_totVis_RMS_d1_cosT_0_925_to_0_950","", n_binsJER_FW, lim_E_rel_low,lim_E_rel_high);
  TH1F* h_100_CT_wO_DR05_E_rel_totVis_RMS_d1_cosT_0_950_to_0_975 =  new TH1F("h_100_CT_wO_DR05_E_rel_totVis_RMS_d1_cosT_0_950_to_0_975","", n_binsJER_FW, lim_E_rel_low,lim_E_rel_high);
  TH1F* h_100_CT_wO_DR05_E_rel_totVis_RMS_d1_cosT_0_975_to_1_00 =  new TH1F("h_100_CT_wO_DR05_E_rel_totVis_RMS_d1_cosT_0_975_to_1_00","", n_binsJER_FW, lim_E_rel_low,lim_E_rel_high);

  TH1F* h_100_CT_wO_DR06_E_rel_totVis_RMS_d1_cosT_0_to_0_10 =  new TH1F("h_100_CT_wO_DR06_E_rel_totVis_RMS_d1_cosT_0_to_0_10","", n_binsJER, lim_E_rel_low,lim_E_rel_high);
  TH1F* h_100_CT_wO_DR06_E_rel_totVis_RMS_d1_cosT_0_10_to_0_20 =  new TH1F("h_100_CT_wO_DR06_E_rel_totVis_RMS_d1_cosT_0_10_to_0_20","", n_binsJER, lim_E_rel_low,lim_E_rel_high);
  TH1F* h_100_CT_wO_DR06_E_rel_totVis_RMS_d1_cosT_0_20_to_0_30 =  new TH1F("h_100_CT_wO_DR06_E_rel_totVis_RMS_d1_cosT_0_20_to_0_30","", n_binsJER, lim_E_rel_low,lim_E_rel_high);
  TH1F* h_100_CT_wO_DR06_E_rel_totVis_RMS_d1_cosT_0_30_to_0_40 =  new TH1F("h_100_CT_wO_DR06_E_rel_totVis_RMS_d1_cosT_0_30_to_0_40","", n_binsJER, lim_E_rel_low,lim_E_rel_high);
  TH1F* h_100_CT_wO_DR06_E_rel_totVis_RMS_d1_cosT_0_40_to_0_50 =  new TH1F("h_100_CT_wO_DR06_E_rel_totVis_RMS_d1_cosT_0_40_to_0_50","", n_binsJER, lim_E_rel_low,lim_E_rel_high);
  TH1F* h_100_CT_wO_DR06_E_rel_totVis_RMS_d1_cosT_0_50_to_0_60 =  new TH1F("h_100_CT_wO_DR06_E_rel_totVis_RMS_d1_cosT_0_50_to_0_60","", n_binsJER, lim_E_rel_low,lim_E_rel_high);
  TH1F* h_100_CT_wO_DR06_E_rel_totVis_RMS_d1_cosT_0_60_to_0_70 =  new TH1F("h_100_CT_wO_DR06_E_rel_totVis_RMS_d1_cosT_0_60_to_0_70","", n_binsJER, lim_E_rel_low,lim_E_rel_high);
  TH1F* h_100_CT_wO_DR06_E_rel_totVis_RMS_d1_cosT_0_70_to_0_80 =  new TH1F("h_100_CT_wO_DR06_E_rel_totVis_RMS_d1_cosT_0_70_to_0_80","", n_binsJER, lim_E_rel_low,lim_E_rel_high);
  TH1F* h_100_CT_wO_DR06_E_rel_totVis_RMS_d1_cosT_0_80_to_0_90 =  new TH1F("h_100_CT_wO_DR06_E_rel_totVis_RMS_d1_cosT_0_80_to_0_90","", n_binsJER, lim_E_rel_low,lim_E_rel_high);
  TH1F* h_100_CT_wO_DR06_E_rel_totVis_RMS_d1_cosT_0_900_to_0_925 =  new TH1F("h_100_CT_wO_DR06_E_rel_totVis_RMS_d1_cosT_0_900_to_0_925","", n_binsJER_FW, lim_E_rel_low,lim_E_rel_high);
  TH1F* h_100_CT_wO_DR06_E_rel_totVis_RMS_d1_cosT_0_925_to_0_950 =  new TH1F("h_100_CT_wO_DR06_E_rel_totVis_RMS_d1_cosT_0_925_to_0_950","", n_binsJER_FW, lim_E_rel_low,lim_E_rel_high);
  TH1F* h_100_CT_wO_DR06_E_rel_totVis_RMS_d1_cosT_0_950_to_0_975 =  new TH1F("h_100_CT_wO_DR06_E_rel_totVis_RMS_d1_cosT_0_950_to_0_975","", n_binsJER_FW, lim_E_rel_low,lim_E_rel_high);
  TH1F* h_100_CT_wO_DR06_E_rel_totVis_RMS_d1_cosT_0_975_to_1_00 =  new TH1F("h_100_CT_wO_DR06_E_rel_totVis_RMS_d1_cosT_0_975_to_1_00","", n_binsJER_FW, lim_E_rel_low,lim_E_rel_high);

  TH1F* h_100_CT_wO_DR07_E_rel_totVis_RMS_d1_cosT_0_to_0_10 =  new TH1F("h_100_CT_wO_DR07_E_rel_totVis_RMS_d1_cosT_0_to_0_10","", n_binsJER, lim_E_rel_low,lim_E_rel_high);
  TH1F* h_100_CT_wO_DR07_E_rel_totVis_RMS_d1_cosT_0_10_to_0_20 =  new TH1F("h_100_CT_wO_DR07_E_rel_totVis_RMS_d1_cosT_0_10_to_0_20","", n_binsJER, lim_E_rel_low,lim_E_rel_high);
  TH1F* h_100_CT_wO_DR07_E_rel_totVis_RMS_d1_cosT_0_20_to_0_30 =  new TH1F("h_100_CT_wO_DR07_E_rel_totVis_RMS_d1_cosT_0_20_to_0_30","", n_binsJER, lim_E_rel_low,lim_E_rel_high);
  TH1F* h_100_CT_wO_DR07_E_rel_totVis_RMS_d1_cosT_0_30_to_0_40 =  new TH1F("h_100_CT_wO_DR07_E_rel_totVis_RMS_d1_cosT_0_30_to_0_40","", n_binsJER, lim_E_rel_low,lim_E_rel_high);
  TH1F* h_100_CT_wO_DR07_E_rel_totVis_RMS_d1_cosT_0_40_to_0_50 =  new TH1F("h_100_CT_wO_DR07_E_rel_totVis_RMS_d1_cosT_0_40_to_0_50","", n_binsJER, lim_E_rel_low,lim_E_rel_high);
  TH1F* h_100_CT_wO_DR07_E_rel_totVis_RMS_d1_cosT_0_50_to_0_60 =  new TH1F("h_100_CT_wO_DR07_E_rel_totVis_RMS_d1_cosT_0_50_to_0_60","", n_binsJER, lim_E_rel_low,lim_E_rel_high);
  TH1F* h_100_CT_wO_DR07_E_rel_totVis_RMS_d1_cosT_0_60_to_0_70 =  new TH1F("h_100_CT_wO_DR07_E_rel_totVis_RMS_d1_cosT_0_60_to_0_70","", n_binsJER, lim_E_rel_low,lim_E_rel_high);
  TH1F* h_100_CT_wO_DR07_E_rel_totVis_RMS_d1_cosT_0_70_to_0_80 =  new TH1F("h_100_CT_wO_DR07_E_rel_totVis_RMS_d1_cosT_0_70_to_0_80","", n_binsJER, lim_E_rel_low,lim_E_rel_high);
  TH1F* h_100_CT_wO_DR07_E_rel_totVis_RMS_d1_cosT_0_80_to_0_90 =  new TH1F("h_100_CT_wO_DR07_E_rel_totVis_RMS_d1_cosT_0_80_to_0_90","", n_binsJER, lim_E_rel_low,lim_E_rel_high);
  TH1F* h_100_CT_wO_DR07_E_rel_totVis_RMS_d1_cosT_0_900_to_0_925 =  new TH1F("h_100_CT_wO_DR07_E_rel_totVis_RMS_d1_cosT_0_900_to_0_925","", n_binsJER_FW, lim_E_rel_low,lim_E_rel_high);
  TH1F* h_100_CT_wO_DR07_E_rel_totVis_RMS_d1_cosT_0_925_to_0_950 =  new TH1F("h_100_CT_wO_DR07_E_rel_totVis_RMS_d1_cosT_0_925_to_0_950","", n_binsJER_FW, lim_E_rel_low,lim_E_rel_high);
  TH1F* h_100_CT_wO_DR07_E_rel_totVis_RMS_d1_cosT_0_950_to_0_975 =  new TH1F("h_100_CT_wO_DR07_E_rel_totVis_RMS_d1_cosT_0_950_to_0_975","", n_binsJER_FW, lim_E_rel_low,lim_E_rel_high);
  TH1F* h_100_CT_wO_DR07_E_rel_totVis_RMS_d1_cosT_0_975_to_1_00 =  new TH1F("h_100_CT_wO_DR07_E_rel_totVis_RMS_d1_cosT_0_975_to_1_00","", n_binsJER_FW, lim_E_rel_low,lim_E_rel_high);

  TH1F* h_100_CT_wO_DR08_E_rel_totVis_RMS_d1_cosT_0_to_0_10 =  new TH1F("h_100_CT_wO_DR08_E_rel_totVis_RMS_d1_cosT_0_to_0_10","", n_binsJER, lim_E_rel_low,lim_E_rel_high);
  TH1F* h_100_CT_wO_DR08_E_rel_totVis_RMS_d1_cosT_0_10_to_0_20 =  new TH1F("h_100_CT_wO_DR08_E_rel_totVis_RMS_d1_cosT_0_10_to_0_20","", n_binsJER, lim_E_rel_low,lim_E_rel_high);
  TH1F* h_100_CT_wO_DR08_E_rel_totVis_RMS_d1_cosT_0_20_to_0_30 =  new TH1F("h_100_CT_wO_DR08_E_rel_totVis_RMS_d1_cosT_0_20_to_0_30","", n_binsJER, lim_E_rel_low,lim_E_rel_high);
  TH1F* h_100_CT_wO_DR08_E_rel_totVis_RMS_d1_cosT_0_30_to_0_40 =  new TH1F("h_100_CT_wO_DR08_E_rel_totVis_RMS_d1_cosT_0_30_to_0_40","", n_binsJER, lim_E_rel_low,lim_E_rel_high);
  TH1F* h_100_CT_wO_DR08_E_rel_totVis_RMS_d1_cosT_0_40_to_0_50 =  new TH1F("h_100_CT_wO_DR08_E_rel_totVis_RMS_d1_cosT_0_40_to_0_50","", n_binsJER, lim_E_rel_low,lim_E_rel_high);
  TH1F* h_100_CT_wO_DR08_E_rel_totVis_RMS_d1_cosT_0_50_to_0_60 =  new TH1F("h_100_CT_wO_DR08_E_rel_totVis_RMS_d1_cosT_0_50_to_0_60","", n_binsJER, lim_E_rel_low,lim_E_rel_high);
  TH1F* h_100_CT_wO_DR08_E_rel_totVis_RMS_d1_cosT_0_60_to_0_70 =  new TH1F("h_100_CT_wO_DR08_E_rel_totVis_RMS_d1_cosT_0_60_to_0_70","", n_binsJER, lim_E_rel_low,lim_E_rel_high);
  TH1F* h_100_CT_wO_DR08_E_rel_totVis_RMS_d1_cosT_0_70_to_0_80 =  new TH1F("h_100_CT_wO_DR08_E_rel_totVis_RMS_d1_cosT_0_70_to_0_80","", n_binsJER, lim_E_rel_low,lim_E_rel_high);
  TH1F* h_100_CT_wO_DR08_E_rel_totVis_RMS_d1_cosT_0_80_to_0_90 =  new TH1F("h_100_CT_wO_DR08_E_rel_totVis_RMS_d1_cosT_0_80_to_0_90","", n_binsJER, lim_E_rel_low,lim_E_rel_high);
  TH1F* h_100_CT_wO_DR08_E_rel_totVis_RMS_d1_cosT_0_900_to_0_925 =  new TH1F("h_100_CT_wO_DR08_E_rel_totVis_RMS_d1_cosT_0_900_to_0_925","", n_binsJER_FW, lim_E_rel_low,lim_E_rel_high);
  TH1F* h_100_CT_wO_DR08_E_rel_totVis_RMS_d1_cosT_0_925_to_0_950 =  new TH1F("h_100_CT_wO_DR08_E_rel_totVis_RMS_d1_cosT_0_925_to_0_950","", n_binsJER_FW, lim_E_rel_low,lim_E_rel_high);
  TH1F* h_100_CT_wO_DR08_E_rel_totVis_RMS_d1_cosT_0_950_to_0_975 =  new TH1F("h_100_CT_wO_DR08_E_rel_totVis_RMS_d1_cosT_0_950_to_0_975","", n_binsJER_FW, lim_E_rel_low,lim_E_rel_high);
  TH1F* h_100_CT_wO_DR08_E_rel_totVis_RMS_d1_cosT_0_975_to_1_00 =  new TH1F("h_100_CT_wO_DR08_E_rel_totVis_RMS_d1_cosT_0_975_to_1_00","", n_binsJER_FW, lim_E_rel_low,lim_E_rel_high);

  TH1F* h_100_CT_wO_DR09_E_rel_totVis_RMS_d1_cosT_0_to_0_10 =  new TH1F("h_100_CT_wO_DR09_E_rel_totVis_RMS_d1_cosT_0_to_0_10","", n_binsJER, lim_E_rel_low,lim_E_rel_high);
  TH1F* h_100_CT_wO_DR09_E_rel_totVis_RMS_d1_cosT_0_10_to_0_20 =  new TH1F("h_100_CT_wO_DR09_E_rel_totVis_RMS_d1_cosT_0_10_to_0_20","", n_binsJER, lim_E_rel_low,lim_E_rel_high);
  TH1F* h_100_CT_wO_DR09_E_rel_totVis_RMS_d1_cosT_0_20_to_0_30 =  new TH1F("h_100_CT_wO_DR09_E_rel_totVis_RMS_d1_cosT_0_20_to_0_30","", n_binsJER, lim_E_rel_low,lim_E_rel_high);
  TH1F* h_100_CT_wO_DR09_E_rel_totVis_RMS_d1_cosT_0_30_to_0_40 =  new TH1F("h_100_CT_wO_DR09_E_rel_totVis_RMS_d1_cosT_0_30_to_0_40","", n_binsJER, lim_E_rel_low,lim_E_rel_high);
  TH1F* h_100_CT_wO_DR09_E_rel_totVis_RMS_d1_cosT_0_40_to_0_50 =  new TH1F("h_100_CT_wO_DR09_E_rel_totVis_RMS_d1_cosT_0_40_to_0_50","", n_binsJER, lim_E_rel_low,lim_E_rel_high);
  TH1F* h_100_CT_wO_DR09_E_rel_totVis_RMS_d1_cosT_0_50_to_0_60 =  new TH1F("h_100_CT_wO_DR09_E_rel_totVis_RMS_d1_cosT_0_50_to_0_60","", n_binsJER, lim_E_rel_low,lim_E_rel_high);
  TH1F* h_100_CT_wO_DR09_E_rel_totVis_RMS_d1_cosT_0_60_to_0_70 =  new TH1F("h_100_CT_wO_DR09_E_rel_totVis_RMS_d1_cosT_0_60_to_0_70","", n_binsJER, lim_E_rel_low,lim_E_rel_high);
  TH1F* h_100_CT_wO_DR09_E_rel_totVis_RMS_d1_cosT_0_70_to_0_80 =  new TH1F("h_100_CT_wO_DR09_E_rel_totVis_RMS_d1_cosT_0_70_to_0_80","", n_binsJER, lim_E_rel_low,lim_E_rel_high);
  TH1F* h_100_CT_wO_DR09_E_rel_totVis_RMS_d1_cosT_0_80_to_0_90 =  new TH1F("h_100_CT_wO_DR09_E_rel_totVis_RMS_d1_cosT_0_80_to_0_90","", n_binsJER, lim_E_rel_low,lim_E_rel_high);
  TH1F* h_100_CT_wO_DR09_E_rel_totVis_RMS_d1_cosT_0_900_to_0_925 =  new TH1F("h_100_CT_wO_DR09_E_rel_totVis_RMS_d1_cosT_0_900_to_0_925","", n_binsJER_FW, lim_E_rel_low,lim_E_rel_high);
  TH1F* h_100_CT_wO_DR09_E_rel_totVis_RMS_d1_cosT_0_925_to_0_950 =  new TH1F("h_100_CT_wO_DR09_E_rel_totVis_RMS_d1_cosT_0_925_to_0_950","", n_binsJER_FW, lim_E_rel_low,lim_E_rel_high);
  TH1F* h_100_CT_wO_DR09_E_rel_totVis_RMS_d1_cosT_0_950_to_0_975 =  new TH1F("h_100_CT_wO_DR09_E_rel_totVis_RMS_d1_cosT_0_950_to_0_975","", n_binsJER_FW, lim_E_rel_low,lim_E_rel_high);
  TH1F* h_100_CT_wO_DR09_E_rel_totVis_RMS_d1_cosT_0_975_to_1_00 =  new TH1F("h_100_CT_wO_DR09_E_rel_totVis_RMS_d1_cosT_0_975_to_1_00","", n_binsJER_FW, lim_E_rel_low,lim_E_rel_high);

  TH1F* h_100_CT_wO_DR10_E_rel_totVis_RMS_d1_cosT_0_to_0_10 =  new TH1F("h_100_CT_wO_DR10_E_rel_totVis_RMS_d1_cosT_0_to_0_10","", n_binsJER, lim_E_rel_low,lim_E_rel_high);
  TH1F* h_100_CT_wO_DR10_E_rel_totVis_RMS_d1_cosT_0_10_to_0_20 =  new TH1F("h_100_CT_wO_DR10_E_rel_totVis_RMS_d1_cosT_0_10_to_0_20","", n_binsJER, lim_E_rel_low,lim_E_rel_high);
  TH1F* h_100_CT_wO_DR10_E_rel_totVis_RMS_d1_cosT_0_20_to_0_30 =  new TH1F("h_100_CT_wO_DR10_E_rel_totVis_RMS_d1_cosT_0_20_to_0_30","", n_binsJER, lim_E_rel_low,lim_E_rel_high);
  TH1F* h_100_CT_wO_DR10_E_rel_totVis_RMS_d1_cosT_0_30_to_0_40 =  new TH1F("h_100_CT_wO_DR10_E_rel_totVis_RMS_d1_cosT_0_30_to_0_40","", n_binsJER, lim_E_rel_low,lim_E_rel_high);
  TH1F* h_100_CT_wO_DR10_E_rel_totVis_RMS_d1_cosT_0_40_to_0_50 =  new TH1F("h_100_CT_wO_DR10_E_rel_totVis_RMS_d1_cosT_0_40_to_0_50","", n_binsJER, lim_E_rel_low,lim_E_rel_high);
  TH1F* h_100_CT_wO_DR10_E_rel_totVis_RMS_d1_cosT_0_50_to_0_60 =  new TH1F("h_100_CT_wO_DR10_E_rel_totVis_RMS_d1_cosT_0_50_to_0_60","", n_binsJER, lim_E_rel_low,lim_E_rel_high);
  TH1F* h_100_CT_wO_DR10_E_rel_totVis_RMS_d1_cosT_0_60_to_0_70 =  new TH1F("h_100_CT_wO_DR10_E_rel_totVis_RMS_d1_cosT_0_60_to_0_70","", n_binsJER, lim_E_rel_low,lim_E_rel_high);
  TH1F* h_100_CT_wO_DR10_E_rel_totVis_RMS_d1_cosT_0_70_to_0_80 =  new TH1F("h_100_CT_wO_DR10_E_rel_totVis_RMS_d1_cosT_0_70_to_0_80","", n_binsJER, lim_E_rel_low,lim_E_rel_high);
  TH1F* h_100_CT_wO_DR10_E_rel_totVis_RMS_d1_cosT_0_80_to_0_90 =  new TH1F("h_100_CT_wO_DR10_E_rel_totVis_RMS_d1_cosT_0_80_to_0_90","", n_binsJER, lim_E_rel_low,lim_E_rel_high);
  TH1F* h_100_CT_wO_DR10_E_rel_totVis_RMS_d1_cosT_0_900_to_0_925 =  new TH1F("h_100_CT_wO_DR10_E_rel_totVis_RMS_d1_cosT_0_900_to_0_925","", n_binsJER_FW, lim_E_rel_low,lim_E_rel_high);
  TH1F* h_100_CT_wO_DR10_E_rel_totVis_RMS_d1_cosT_0_925_to_0_950 =  new TH1F("h_100_CT_wO_DR10_E_rel_totVis_RMS_d1_cosT_0_925_to_0_950","", n_binsJER_FW, lim_E_rel_low,lim_E_rel_high);
  TH1F* h_100_CT_wO_DR10_E_rel_totVis_RMS_d1_cosT_0_950_to_0_975 =  new TH1F("h_100_CT_wO_DR10_E_rel_totVis_RMS_d1_cosT_0_950_to_0_975","", n_binsJER_FW, lim_E_rel_low,lim_E_rel_high);
  TH1F* h_100_CT_wO_DR10_E_rel_totVis_RMS_d1_cosT_0_975_to_1_00 =  new TH1F("h_100_CT_wO_DR10_E_rel_totVis_RMS_d1_cosT_0_975_to_1_00","", n_binsJER_FW, lim_E_rel_low,lim_E_rel_high);

  TH1F* h_100_CT_wO_DR05_dphi_reco_gen_cosTheta_0_65 =  new TH1F("h_100_CT_wO_DR05_dphi_reco_gen_cosTheta_0_65","", n_bins100, -lim_angleDeg,lim_angleDeg);
  TH1F* h_100_CT_wO_DR05_dtheta_reco_gen_cosTheta_0_65 =  new TH1F("h_100_CT_wO_DR05_dtheta_reco_gen_cosTheta_0_65","", n_bins100, -lim_angleDeg,lim_angleDeg);
  TH1F* h_100_CT_wO_DR05_dphi_reco_gen_cosTheta_0_65_to_0_80 =  new TH1F("h_100_CT_wO_DR05_dphi_reco_gen_cosTheta_0_65_to_0_80","", n_bins100, -lim_angleDeg,lim_angleDeg);
  TH1F* h_100_CT_wO_DR05_dtheta_reco_gen_cosTheta_0_65_to_0_80 =  new TH1F("h_100_CT_wO_DR05_dtheta_reco_gen_cosTheta_0_65_to_0_80","", n_bins100, -lim_angleDeg,lim_angleDeg);
  TH1F* h_100_CT_wO_DR05_dphi_reco_gen_cosTheta_0_80_to_0_925 =  new TH1F("h_100_CT_wO_DR05_dphi_reco_gen_cosTheta_0_80_to_0_925","", n_bins100, -lim_angleDeg,lim_angleDeg);
  TH1F* h_100_CT_wO_DR05_dtheta_reco_gen_cosTheta_0_80_to_0_925 =  new TH1F("h_100_CT_wO_DR05_dtheta_reco_gen_cosTheta_0_80_to_0_925","", n_bins100, -lim_angleDeg,lim_angleDeg);
  TH1F* h_100_CT_wO_DR05_dphi_reco_gen_cosTheta_0_925_to_0_975 =  new TH1F("h_100_CT_wO_DR05_dphi_reco_gen_cosTheta_0_925_to_0_975","", n_bins100, -lim_angleDeg,lim_angleDeg);
  TH1F* h_100_CT_wO_DR05_dtheta_reco_gen_cosTheta_0_925_to_0_975 =  new TH1F("h_100_CT_wO_DR05_dtheta_reco_gen_cosTheta_0_925_to_0_975","", n_bins100, -lim_angleDeg,lim_angleDeg);

  TH1F* h_100_CT_wO_DR07_dphi_reco_gen_cosTheta_0_65 =  new TH1F("h_100_CT_wO_DR07_dphi_reco_gen_cosTheta_0_65","", n_bins100, -lim_angleDeg,lim_angleDeg);
  TH1F* h_100_CT_wO_DR07_dtheta_reco_gen_cosTheta_0_65 =  new TH1F("h_100_CT_wO_DR07_dtheta_reco_gen_cosTheta_0_65","", n_bins100, -lim_angleDeg,lim_angleDeg);
  TH1F* h_100_CT_wO_DR07_dphi_reco_gen_cosTheta_0_65_to_0_80 =  new TH1F("h_100_CT_wO_DR07_dphi_reco_gen_cosTheta_0_65_to_0_80","", n_bins100, -lim_angleDeg,lim_angleDeg);
  TH1F* h_100_CT_wO_DR07_dtheta_reco_gen_cosTheta_0_65_to_0_80 =  new TH1F("h_100_CT_wO_DR07_dtheta_reco_gen_cosTheta_0_65_to_0_80","", n_bins100, -lim_angleDeg,lim_angleDeg);
  TH1F* h_100_CT_wO_DR07_dphi_reco_gen_cosTheta_0_80_to_0_925 =  new TH1F("h_100_CT_wO_DR07_dphi_reco_gen_cosTheta_0_80_to_0_925","", n_bins100, -lim_angleDeg,lim_angleDeg);
  TH1F* h_100_CT_wO_DR07_dtheta_reco_gen_cosTheta_0_80_to_0_925 =  new TH1F("h_100_CT_wO_DR07_dtheta_reco_gen_cosTheta_0_80_to_0_925","", n_bins100, -lim_angleDeg,lim_angleDeg);
  TH1F* h_100_CT_wO_DR07_dphi_reco_gen_cosTheta_0_925_to_0_975 =  new TH1F("h_100_CT_wO_DR07_dphi_reco_gen_cosTheta_0_925_to_0_975","", n_bins100, -lim_angleDeg,lim_angleDeg);
  TH1F* h_100_CT_wO_DR07_dtheta_reco_gen_cosTheta_0_925_to_0_975 =  new TH1F("h_100_CT_wO_DR07_dtheta_reco_gen_cosTheta_0_925_to_0_975","", n_bins100, -lim_angleDeg,lim_angleDeg);

  TH1F* h_100_CT_wO_DR10_dphi_reco_gen_cosTheta_0_65 =  new TH1F("h_100_CT_wO_DR10_dphi_reco_gen_cosTheta_0_65","", n_bins100, -lim_angleDeg,lim_angleDeg);
  TH1F* h_100_CT_wO_DR10_dtheta_reco_gen_cosTheta_0_65 =  new TH1F("h_100_CT_wO_DR10_dtheta_reco_gen_cosTheta_0_65","", n_bins100, -lim_angleDeg,lim_angleDeg);
  TH1F* h_100_CT_wO_DR10_dphi_reco_gen_cosTheta_0_65_to_0_80 =  new TH1F("h_100_CT_wO_DR10_dphi_reco_gen_cosTheta_0_65_to_0_80","", n_bins100, -lim_angleDeg,lim_angleDeg);
  TH1F* h_100_CT_wO_DR10_dtheta_reco_gen_cosTheta_0_65_to_0_80 =  new TH1F("h_100_CT_wO_DR10_dtheta_reco_gen_cosTheta_0_65_to_0_80","", n_bins100, -lim_angleDeg,lim_angleDeg);
  TH1F* h_100_CT_wO_DR10_dphi_reco_gen_cosTheta_0_80_to_0_925 =  new TH1F("h_100_CT_wO_DR10_dphi_reco_gen_cosTheta_0_80_to_0_925","", n_bins100, -lim_angleDeg,lim_angleDeg);
  TH1F* h_100_CT_wO_DR10_dtheta_reco_gen_cosTheta_0_80_to_0_925 =  new TH1F("h_100_CT_wO_DR10_dtheta_reco_gen_cosTheta_0_80_to_0_925","", n_bins100, -lim_angleDeg,lim_angleDeg);
  TH1F* h_100_CT_wO_DR10_dphi_reco_gen_cosTheta_0_925_to_0_975 =  new TH1F("h_100_CT_wO_DR10_dphi_reco_gen_cosTheta_0_925_to_0_975","", n_bins100, -lim_angleDeg,lim_angleDeg);
  TH1F* h_100_CT_wO_DR10_dtheta_reco_gen_cosTheta_0_925_to_0_975 =  new TH1F("h_100_CT_wO_DR10_dtheta_reco_gen_cosTheta_0_925_to_0_975","", n_bins100, -lim_angleDeg,lim_angleDeg);


  std::vector<TH1F*> hist_vec_100_CT_wO;
  hist_vec_100_CT_wO.push_back(h_100_CT_wO_genjet03_dphi_j1j2);
  hist_vec_100_CT_wO.push_back(h_100_CT_wO_genjet03_E1_E2_over_E_True);
  hist_vec_100_CT_wO.push_back(h_100_CT_wO_genjet03_Delta_E1_E2_over_E12);
  hist_vec_100_CT_wO.push_back(h_100_CT_wO_genjet04_dphi_j1j2);
  hist_vec_100_CT_wO.push_back(h_100_CT_wO_genjet04_E1_E2_over_E_True);
  hist_vec_100_CT_wO.push_back(h_100_CT_wO_genjet04_Delta_E1_E2_over_E12);
  hist_vec_100_CT_wO.push_back(h_100_CT_wO_genjet05_dphi_j1j2);
  hist_vec_100_CT_wO.push_back(h_100_CT_wO_genjet05_E1_E2_over_E_True);
  hist_vec_100_CT_wO.push_back(h_100_CT_wO_genjet05_Delta_E1_E2_over_E12);
  hist_vec_100_CT_wO.push_back(h_100_CT_wO_genjet06_dphi_j1j2);
  hist_vec_100_CT_wO.push_back(h_100_CT_wO_genjet06_E1_E2_over_E_True);
  hist_vec_100_CT_wO.push_back(h_100_CT_wO_genjet06_Delta_E1_E2_over_E12);
  hist_vec_100_CT_wO.push_back(h_100_CT_wO_genjet07_dphi_j1j2);
  hist_vec_100_CT_wO.push_back(h_100_CT_wO_genjet07_E1_E2_over_E_True);
  hist_vec_100_CT_wO.push_back(h_100_CT_wO_genjet07_Delta_E1_E2_over_E12);
  hist_vec_100_CT_wO.push_back(h_100_CT_wO_genjet08_dphi_j1j2);
  hist_vec_100_CT_wO.push_back(h_100_CT_wO_genjet08_E1_E2_over_E_True);
  hist_vec_100_CT_wO.push_back(h_100_CT_wO_genjet08_Delta_E1_E2_over_E12);
  hist_vec_100_CT_wO.push_back(h_100_CT_wO_genjet09_dphi_j1j2);
  hist_vec_100_CT_wO.push_back(h_100_CT_wO_genjet09_E1_E2_over_E_True);
  hist_vec_100_CT_wO.push_back(h_100_CT_wO_genjet09_Delta_E1_E2_over_E12);
  hist_vec_100_CT_wO.push_back(h_100_CT_wO_genjet10_dphi_j1j2);
  hist_vec_100_CT_wO.push_back(h_100_CT_wO_genjet10_E1_E2_over_E_True);
  hist_vec_100_CT_wO.push_back(h_100_CT_wO_genjet10_Delta_E1_E2_over_E12);

  hist_vec_100_CT_wO.push_back(h_100_CT_wO_recojet03_dphi_j1j2);
  hist_vec_100_CT_wO.push_back(h_100_CT_wO_recojet03_E1_E2_over_E_True);
  hist_vec_100_CT_wO.push_back(h_100_CT_wO_recojet03_Delta_E1_E2_over_E12);
  hist_vec_100_CT_wO.push_back(h_100_CT_wO_recojet04_dphi_j1j2);
  hist_vec_100_CT_wO.push_back(h_100_CT_wO_recojet04_E1_E2_over_E_True);
  hist_vec_100_CT_wO.push_back(h_100_CT_wO_recojet04_Delta_E1_E2_over_E12);
  hist_vec_100_CT_wO.push_back(h_100_CT_wO_recojet05_dphi_j1j2);
  hist_vec_100_CT_wO.push_back(h_100_CT_wO_recojet05_E1_E2_over_E_True);
  hist_vec_100_CT_wO.push_back(h_100_CT_wO_recojet05_Delta_E1_E2_over_E12);
  hist_vec_100_CT_wO.push_back(h_100_CT_wO_recojet06_dphi_j1j2);
  hist_vec_100_CT_wO.push_back(h_100_CT_wO_recojet06_E1_E2_over_E_True);
  hist_vec_100_CT_wO.push_back(h_100_CT_wO_recojet06_Delta_E1_E2_over_E12);
  hist_vec_100_CT_wO.push_back(h_100_CT_wO_recojet07_dphi_j1j2);
  hist_vec_100_CT_wO.push_back(h_100_CT_wO_recojet07_E1_E2_over_E_True);
  hist_vec_100_CT_wO.push_back(h_100_CT_wO_recojet07_Delta_E1_E2_over_E12);
  hist_vec_100_CT_wO.push_back(h_100_CT_wO_recojet08_dphi_j1j2);
  hist_vec_100_CT_wO.push_back(h_100_CT_wO_recojet08_E1_E2_over_E_True);
  hist_vec_100_CT_wO.push_back(h_100_CT_wO_recojet08_Delta_E1_E2_over_E12);
  hist_vec_100_CT_wO.push_back(h_100_CT_wO_recojet09_dphi_j1j2);
  hist_vec_100_CT_wO.push_back(h_100_CT_wO_recojet09_E1_E2_over_E_True);
  hist_vec_100_CT_wO.push_back(h_100_CT_wO_recojet09_Delta_E1_E2_over_E12);
  hist_vec_100_CT_wO.push_back(h_100_CT_wO_recojet10_dphi_j1j2);
  hist_vec_100_CT_wO.push_back(h_100_CT_wO_recojet10_E1_E2_over_E_True);
  hist_vec_100_CT_wO.push_back(h_100_CT_wO_recojet10_Delta_E1_E2_over_E12);

  hist_vec_100_CT_wO.push_back(h_100_CT_wO_recojetE_over_genjetE_DR03);
  hist_vec_100_CT_wO.push_back(h_100_CT_wO_recojetE_over_genjetE_DR04);
  hist_vec_100_CT_wO.push_back(h_100_CT_wO_recojetE_over_genjetE_DR05);
  hist_vec_100_CT_wO.push_back(h_100_CT_wO_recojetE_over_genjetE_DR06);
  hist_vec_100_CT_wO.push_back(h_100_CT_wO_recojetE_over_genjetE_DR07);
  hist_vec_100_CT_wO.push_back(h_100_CT_wO_recojetE_over_genjetE_DR08);
  hist_vec_100_CT_wO.push_back(h_100_CT_wO_recojetE_over_genjetE_DR09);
  hist_vec_100_CT_wO.push_back(h_100_CT_wO_recojetE_over_genjetE_DR10);

  hist_vec_100_CT_wO.push_back(h_100_CT_wO_dphi_gen_reco_DR05);
  hist_vec_100_CT_wO.push_back(h_100_CT_wO_dphi_gen_reco_DR06);
  hist_vec_100_CT_wO.push_back(h_100_CT_wO_dphi_gen_reco_DR07);

  hist_vec_100_CT_wO.push_back(h_100_CT_wO_DR05_E_rel_totVis_RMS_d1_cosT_0_to_0_10);
  hist_vec_100_CT_wO.push_back(h_100_CT_wO_DR05_E_rel_totVis_RMS_d1_cosT_0_10_to_0_20);
  hist_vec_100_CT_wO.push_back(h_100_CT_wO_DR05_E_rel_totVis_RMS_d1_cosT_0_20_to_0_30);
  hist_vec_100_CT_wO.push_back(h_100_CT_wO_DR05_E_rel_totVis_RMS_d1_cosT_0_30_to_0_40);
  hist_vec_100_CT_wO.push_back(h_100_CT_wO_DR05_E_rel_totVis_RMS_d1_cosT_0_40_to_0_50);
  hist_vec_100_CT_wO.push_back(h_100_CT_wO_DR05_E_rel_totVis_RMS_d1_cosT_0_50_to_0_60);
  hist_vec_100_CT_wO.push_back(h_100_CT_wO_DR05_E_rel_totVis_RMS_d1_cosT_0_60_to_0_70);
  hist_vec_100_CT_wO.push_back(h_100_CT_wO_DR05_E_rel_totVis_RMS_d1_cosT_0_70_to_0_80);
  hist_vec_100_CT_wO.push_back(h_100_CT_wO_DR05_E_rel_totVis_RMS_d1_cosT_0_80_to_0_90);
  hist_vec_100_CT_wO.push_back(h_100_CT_wO_DR05_E_rel_totVis_RMS_d1_cosT_0_900_to_0_925);
  hist_vec_100_CT_wO.push_back(h_100_CT_wO_DR05_E_rel_totVis_RMS_d1_cosT_0_925_to_0_950);
  hist_vec_100_CT_wO.push_back(h_100_CT_wO_DR05_E_rel_totVis_RMS_d1_cosT_0_950_to_0_975);
  hist_vec_100_CT_wO.push_back(h_100_CT_wO_DR05_E_rel_totVis_RMS_d1_cosT_0_975_to_1_00);

  hist_vec_100_CT_wO.push_back(h_100_CT_wO_DR06_E_rel_totVis_RMS_d1_cosT_0_to_0_10);
  hist_vec_100_CT_wO.push_back(h_100_CT_wO_DR06_E_rel_totVis_RMS_d1_cosT_0_10_to_0_20);
  hist_vec_100_CT_wO.push_back(h_100_CT_wO_DR06_E_rel_totVis_RMS_d1_cosT_0_20_to_0_30);
  hist_vec_100_CT_wO.push_back(h_100_CT_wO_DR06_E_rel_totVis_RMS_d1_cosT_0_30_to_0_40);
  hist_vec_100_CT_wO.push_back(h_100_CT_wO_DR06_E_rel_totVis_RMS_d1_cosT_0_40_to_0_50);
  hist_vec_100_CT_wO.push_back(h_100_CT_wO_DR06_E_rel_totVis_RMS_d1_cosT_0_50_to_0_60);
  hist_vec_100_CT_wO.push_back(h_100_CT_wO_DR06_E_rel_totVis_RMS_d1_cosT_0_60_to_0_70);
  hist_vec_100_CT_wO.push_back(h_100_CT_wO_DR06_E_rel_totVis_RMS_d1_cosT_0_70_to_0_80);
  hist_vec_100_CT_wO.push_back(h_100_CT_wO_DR06_E_rel_totVis_RMS_d1_cosT_0_80_to_0_90);
  hist_vec_100_CT_wO.push_back(h_100_CT_wO_DR06_E_rel_totVis_RMS_d1_cosT_0_900_to_0_925);
  hist_vec_100_CT_wO.push_back(h_100_CT_wO_DR06_E_rel_totVis_RMS_d1_cosT_0_925_to_0_950);
  hist_vec_100_CT_wO.push_back(h_100_CT_wO_DR06_E_rel_totVis_RMS_d1_cosT_0_950_to_0_975);
  hist_vec_100_CT_wO.push_back(h_100_CT_wO_DR06_E_rel_totVis_RMS_d1_cosT_0_975_to_1_00); 

  hist_vec_100_CT_wO.push_back(h_100_CT_wO_DR07_E_rel_totVis_RMS_d1_cosT_0_to_0_10);
  hist_vec_100_CT_wO.push_back(h_100_CT_wO_DR07_E_rel_totVis_RMS_d1_cosT_0_10_to_0_20);
  hist_vec_100_CT_wO.push_back(h_100_CT_wO_DR07_E_rel_totVis_RMS_d1_cosT_0_20_to_0_30);
  hist_vec_100_CT_wO.push_back(h_100_CT_wO_DR07_E_rel_totVis_RMS_d1_cosT_0_30_to_0_40);
  hist_vec_100_CT_wO.push_back(h_100_CT_wO_DR07_E_rel_totVis_RMS_d1_cosT_0_40_to_0_50);
  hist_vec_100_CT_wO.push_back(h_100_CT_wO_DR07_E_rel_totVis_RMS_d1_cosT_0_50_to_0_60);
  hist_vec_100_CT_wO.push_back(h_100_CT_wO_DR07_E_rel_totVis_RMS_d1_cosT_0_60_to_0_70);
  hist_vec_100_CT_wO.push_back(h_100_CT_wO_DR07_E_rel_totVis_RMS_d1_cosT_0_70_to_0_80);
  hist_vec_100_CT_wO.push_back(h_100_CT_wO_DR07_E_rel_totVis_RMS_d1_cosT_0_80_to_0_90);
  hist_vec_100_CT_wO.push_back(h_100_CT_wO_DR07_E_rel_totVis_RMS_d1_cosT_0_900_to_0_925);
  hist_vec_100_CT_wO.push_back(h_100_CT_wO_DR07_E_rel_totVis_RMS_d1_cosT_0_925_to_0_950);
  hist_vec_100_CT_wO.push_back(h_100_CT_wO_DR07_E_rel_totVis_RMS_d1_cosT_0_950_to_0_975);
  hist_vec_100_CT_wO.push_back(h_100_CT_wO_DR07_E_rel_totVis_RMS_d1_cosT_0_975_to_1_00); 

  hist_vec_100_CT_wO.push_back(h_100_CT_wO_DR08_E_rel_totVis_RMS_d1_cosT_0_to_0_10);
  hist_vec_100_CT_wO.push_back(h_100_CT_wO_DR08_E_rel_totVis_RMS_d1_cosT_0_10_to_0_20);
  hist_vec_100_CT_wO.push_back(h_100_CT_wO_DR08_E_rel_totVis_RMS_d1_cosT_0_20_to_0_30);
  hist_vec_100_CT_wO.push_back(h_100_CT_wO_DR08_E_rel_totVis_RMS_d1_cosT_0_30_to_0_40);
  hist_vec_100_CT_wO.push_back(h_100_CT_wO_DR08_E_rel_totVis_RMS_d1_cosT_0_40_to_0_50);
  hist_vec_100_CT_wO.push_back(h_100_CT_wO_DR08_E_rel_totVis_RMS_d1_cosT_0_50_to_0_60);
  hist_vec_100_CT_wO.push_back(h_100_CT_wO_DR08_E_rel_totVis_RMS_d1_cosT_0_60_to_0_70);
  hist_vec_100_CT_wO.push_back(h_100_CT_wO_DR08_E_rel_totVis_RMS_d1_cosT_0_70_to_0_80);
  hist_vec_100_CT_wO.push_back(h_100_CT_wO_DR08_E_rel_totVis_RMS_d1_cosT_0_80_to_0_90);
  hist_vec_100_CT_wO.push_back(h_100_CT_wO_DR08_E_rel_totVis_RMS_d1_cosT_0_900_to_0_925);
  hist_vec_100_CT_wO.push_back(h_100_CT_wO_DR08_E_rel_totVis_RMS_d1_cosT_0_925_to_0_950);
  hist_vec_100_CT_wO.push_back(h_100_CT_wO_DR08_E_rel_totVis_RMS_d1_cosT_0_950_to_0_975);
  hist_vec_100_CT_wO.push_back(h_100_CT_wO_DR08_E_rel_totVis_RMS_d1_cosT_0_975_to_1_00); //110

  hist_vec_100_CT_wO.push_back(h_100_CT_wO_DR09_E_rel_totVis_RMS_d1_cosT_0_to_0_10);
  hist_vec_100_CT_wO.push_back(h_100_CT_wO_DR09_E_rel_totVis_RMS_d1_cosT_0_10_to_0_20);
  hist_vec_100_CT_wO.push_back(h_100_CT_wO_DR09_E_rel_totVis_RMS_d1_cosT_0_20_to_0_30);
  hist_vec_100_CT_wO.push_back(h_100_CT_wO_DR09_E_rel_totVis_RMS_d1_cosT_0_30_to_0_40);
  hist_vec_100_CT_wO.push_back(h_100_CT_wO_DR09_E_rel_totVis_RMS_d1_cosT_0_40_to_0_50);
  hist_vec_100_CT_wO.push_back(h_100_CT_wO_DR09_E_rel_totVis_RMS_d1_cosT_0_50_to_0_60);
  hist_vec_100_CT_wO.push_back(h_100_CT_wO_DR09_E_rel_totVis_RMS_d1_cosT_0_60_to_0_70);
  hist_vec_100_CT_wO.push_back(h_100_CT_wO_DR09_E_rel_totVis_RMS_d1_cosT_0_70_to_0_80);
  hist_vec_100_CT_wO.push_back(h_100_CT_wO_DR09_E_rel_totVis_RMS_d1_cosT_0_80_to_0_90);
  hist_vec_100_CT_wO.push_back(h_100_CT_wO_DR09_E_rel_totVis_RMS_d1_cosT_0_900_to_0_925);
  hist_vec_100_CT_wO.push_back(h_100_CT_wO_DR09_E_rel_totVis_RMS_d1_cosT_0_925_to_0_950);
  hist_vec_100_CT_wO.push_back(h_100_CT_wO_DR09_E_rel_totVis_RMS_d1_cosT_0_950_to_0_975);
  hist_vec_100_CT_wO.push_back(h_100_CT_wO_DR09_E_rel_totVis_RMS_d1_cosT_0_975_to_1_00); //123

  hist_vec_100_CT_wO.push_back(h_100_CT_wO_DR10_E_rel_totVis_RMS_d1_cosT_0_to_0_10);
  hist_vec_100_CT_wO.push_back(h_100_CT_wO_DR10_E_rel_totVis_RMS_d1_cosT_0_10_to_0_20);
  hist_vec_100_CT_wO.push_back(h_100_CT_wO_DR10_E_rel_totVis_RMS_d1_cosT_0_20_to_0_30);
  hist_vec_100_CT_wO.push_back(h_100_CT_wO_DR10_E_rel_totVis_RMS_d1_cosT_0_30_to_0_40);
  hist_vec_100_CT_wO.push_back(h_100_CT_wO_DR10_E_rel_totVis_RMS_d1_cosT_0_40_to_0_50);
  hist_vec_100_CT_wO.push_back(h_100_CT_wO_DR10_E_rel_totVis_RMS_d1_cosT_0_50_to_0_60);
  hist_vec_100_CT_wO.push_back(h_100_CT_wO_DR10_E_rel_totVis_RMS_d1_cosT_0_60_to_0_70);
  hist_vec_100_CT_wO.push_back(h_100_CT_wO_DR10_E_rel_totVis_RMS_d1_cosT_0_70_to_0_80);
  hist_vec_100_CT_wO.push_back(h_100_CT_wO_DR10_E_rel_totVis_RMS_d1_cosT_0_80_to_0_90);
  hist_vec_100_CT_wO.push_back(h_100_CT_wO_DR10_E_rel_totVis_RMS_d1_cosT_0_900_to_0_925);
  hist_vec_100_CT_wO.push_back(h_100_CT_wO_DR10_E_rel_totVis_RMS_d1_cosT_0_925_to_0_950);
  hist_vec_100_CT_wO.push_back(h_100_CT_wO_DR10_E_rel_totVis_RMS_d1_cosT_0_950_to_0_975);
  hist_vec_100_CT_wO.push_back(h_100_CT_wO_DR10_E_rel_totVis_RMS_d1_cosT_0_975_to_1_00); //136

  hist_vec_100_CT_wO.push_back(h_100_CT_wO_DR05_dphi_reco_gen_cosTheta_0_65);//137
  hist_vec_100_CT_wO.push_back(h_100_CT_wO_DR05_dphi_reco_gen_cosTheta_0_65_to_0_80);
  hist_vec_100_CT_wO.push_back(h_100_CT_wO_DR05_dphi_reco_gen_cosTheta_0_80_to_0_925);
  hist_vec_100_CT_wO.push_back(h_100_CT_wO_DR05_dphi_reco_gen_cosTheta_0_925_to_0_975);
  hist_vec_100_CT_wO.push_back(h_100_CT_wO_DR05_dtheta_reco_gen_cosTheta_0_65);
  hist_vec_100_CT_wO.push_back(h_100_CT_wO_DR05_dtheta_reco_gen_cosTheta_0_65_to_0_80);
  hist_vec_100_CT_wO.push_back(h_100_CT_wO_DR05_dtheta_reco_gen_cosTheta_0_80_to_0_925);
  hist_vec_100_CT_wO.push_back(h_100_CT_wO_DR05_dtheta_reco_gen_cosTheta_0_925_to_0_975);

  hist_vec_100_CT_wO.push_back(h_100_CT_wO_DR07_dphi_reco_gen_cosTheta_0_65);//145
  hist_vec_100_CT_wO.push_back(h_100_CT_wO_DR07_dphi_reco_gen_cosTheta_0_65_to_0_80);
  hist_vec_100_CT_wO.push_back(h_100_CT_wO_DR07_dphi_reco_gen_cosTheta_0_80_to_0_925);
  hist_vec_100_CT_wO.push_back(h_100_CT_wO_DR07_dphi_reco_gen_cosTheta_0_925_to_0_975);
  hist_vec_100_CT_wO.push_back(h_100_CT_wO_DR07_dtheta_reco_gen_cosTheta_0_65);
  hist_vec_100_CT_wO.push_back(h_100_CT_wO_DR07_dtheta_reco_gen_cosTheta_0_65_to_0_80);
  hist_vec_100_CT_wO.push_back(h_100_CT_wO_DR07_dtheta_reco_gen_cosTheta_0_80_to_0_925);
  hist_vec_100_CT_wO.push_back(h_100_CT_wO_DR07_dtheta_reco_gen_cosTheta_0_925_to_0_975);

  hist_vec_100_CT_wO.push_back(h_100_CT_wO_DR10_dphi_reco_gen_cosTheta_0_65);//153
  hist_vec_100_CT_wO.push_back(h_100_CT_wO_DR10_dphi_reco_gen_cosTheta_0_65_to_0_80);
  hist_vec_100_CT_wO.push_back(h_100_CT_wO_DR10_dphi_reco_gen_cosTheta_0_80_to_0_925);
  hist_vec_100_CT_wO.push_back(h_100_CT_wO_DR10_dphi_reco_gen_cosTheta_0_925_to_0_975);
  hist_vec_100_CT_wO.push_back(h_100_CT_wO_DR10_dtheta_reco_gen_cosTheta_0_65);
  hist_vec_100_CT_wO.push_back(h_100_CT_wO_DR10_dtheta_reco_gen_cosTheta_0_65_to_0_80);
  hist_vec_100_CT_wO.push_back(h_100_CT_wO_DR10_dtheta_reco_gen_cosTheta_0_80_to_0_925);
  hist_vec_100_CT_wO.push_back(h_100_CT_wO_DR10_dtheta_reco_gen_cosTheta_0_925_to_0_975);

  for(unsigned int i=0;i<hist_vec_100_CT.size();i++){
    hist_vec_100_CT_wO[i]->Sumw2();
  }
  fill_jet_histograms(file_CLIC_100_CT_wO,hist_vec_100_CT_wO);

  TH1F* h_100_CT_wO_DR05_dphi_SigmaCB_summary_histogram=new TH1F("dphiRes_SigmaCBVsCosTheta_CT_wO_DR05_100", "#sigma#Delta#phi(j_{reco},j_{true}) vs |cos#theta|", nRegionBinsAngles, pRegionBinEdgesAngles);
  h_100_CT_wO_DR05_dphi_SigmaCB_summary_histogram ->SetYTitle("#sigma#Delta#phi(j_{reco},j_{true})");
  h_100_CT_wO_DR05_dphi_SigmaCB_summary_histogram->SetXTitle("|cos#theta|");
  h_100_CT_wO_DR05_dphi_SigmaCB_summary_histogram->SetLineWidth(2);
  h_100_CT_wO_DR05_dphi_SigmaCB_summary_histogram->SetLineColor(kCyan+1);
  h_100_CT_wO_DR05_dphi_SigmaCB_summary_histogram->SetLineStyle(2);

  TH1F* h_100_CT_wO_DR05_dphi_RMS90_summary_histogram=new TH1F("dphiRes_RMS90VsCosTheta_CT_wO_DR05_100", "RMS_{90} #Delta#phi(j_{reco},j_{true}) vs |cos#theta|", nRegionBinsAngles, pRegionBinEdgesAngles);
  h_100_CT_wO_DR05_dphi_RMS90_summary_histogram ->SetYTitle("RMS_{90}#Delta#phi(j_{reco},j_{true})");
  h_100_CT_wO_DR05_dphi_RMS90_summary_histogram->SetXTitle("|cos#theta|");
  h_100_CT_wO_DR05_dphi_RMS90_summary_histogram->SetLineWidth(2);
  h_100_CT_wO_DR05_dphi_RMS90_summary_histogram->SetLineColor(kCyan+1);
  h_100_CT_wO_DR05_dphi_RMS90_summary_histogram->SetLineStyle(2);

  TH1F* h_100_CT_wO_DR07_dphi_SigmaCB_summary_histogram=new TH1F("dphiRes_SigmaCBVsCosTheta_CT_wO_DR07_100", "#sigma#Delta#phi(j_{reco},j_{true}) vs |cos#theta|", nRegionBinsAngles, pRegionBinEdgesAngles);
  h_100_CT_wO_DR07_dphi_SigmaCB_summary_histogram ->SetYTitle("#sigma#Delta#phi(j_{reco},j_{true})");
  h_100_CT_wO_DR07_dphi_SigmaCB_summary_histogram->SetXTitle("|cos#theta|");
  h_100_CT_wO_DR07_dphi_SigmaCB_summary_histogram->SetLineWidth(2);
  h_100_CT_wO_DR07_dphi_SigmaCB_summary_histogram->SetLineColor(kCyan+1);
  h_100_CT_wO_DR07_dphi_SigmaCB_summary_histogram->SetLineStyle(2);

  TH1F* h_100_CT_wO_DR07_dphi_RMS90_summary_histogram=new TH1F("dphiRes_RMS90VsCosTheta_CT_wO_DR07_100", "RMS_{90} #Delta#phi(j_{reco},j_{true}) vs |cos#theta|", nRegionBinsAngles, pRegionBinEdgesAngles);
  h_100_CT_wO_DR07_dphi_RMS90_summary_histogram ->SetYTitle("RMS_{90}#Delta#phi(j_{reco},j_{true})");
  h_100_CT_wO_DR07_dphi_RMS90_summary_histogram->SetXTitle("|cos#theta|");
  h_100_CT_wO_DR07_dphi_RMS90_summary_histogram->SetLineWidth(2);
  h_100_CT_wO_DR07_dphi_RMS90_summary_histogram->SetLineColor(kCyan+1);
  h_100_CT_wO_DR07_dphi_RMS90_summary_histogram->SetLineStyle(2);

  TH1F* h_100_CT_wO_DR10_dphi_SigmaCB_summary_histogram=new TH1F("dphiRes_SigmaCBVsCosTheta_CT_wO_DR10_100", "#sigma#Delta#phi(j_{reco},j_{true}) vs |cos#theta|", nRegionBinsAngles, pRegionBinEdgesAngles);
  h_100_CT_wO_DR10_dphi_SigmaCB_summary_histogram ->SetYTitle("#sigma#Delta#phi(j_{reco},j_{true})");
  h_100_CT_wO_DR10_dphi_SigmaCB_summary_histogram->SetXTitle("|cos#theta|");
  h_100_CT_wO_DR10_dphi_SigmaCB_summary_histogram->SetLineWidth(2);
  h_100_CT_wO_DR10_dphi_SigmaCB_summary_histogram->SetLineColor(kCyan+1);
  h_100_CT_wO_DR10_dphi_SigmaCB_summary_histogram->SetLineStyle(2);

  TH1F* h_100_CT_wO_DR10_dphi_RMS90_summary_histogram=new TH1F("dphiRes_RMS90VsCosTheta_CT_wO_DR10_100", "RMS_{90} #Delta#phi(j_{reco},j_{true}) vs |cos#theta|", nRegionBinsAngles, pRegionBinEdgesAngles);
  h_100_CT_wO_DR10_dphi_RMS90_summary_histogram ->SetYTitle("RMS_{90}#Delta#phi(j_{reco},j_{true})");
  h_100_CT_wO_DR10_dphi_RMS90_summary_histogram->SetXTitle("|cos#theta|");
  h_100_CT_wO_DR10_dphi_RMS90_summary_histogram->SetLineWidth(2);
  h_100_CT_wO_DR10_dphi_RMS90_summary_histogram->SetLineColor(kCyan+1);
  h_100_CT_wO_DR10_dphi_RMS90_summary_histogram->SetLineStyle(2);

  TH1F* h_100_CT_wO_DR05_dtheta_SigmaCB_summary_histogram=new TH1F("dthetaRes_SigmaCBVsCosTheta_CT_wO_DR05_100", "#sigma#Delta#theta(j_{reco},j_{true}) vs |cos#theta|", nRegionBinsAngles, pRegionBinEdgesAngles);
  h_100_CT_wO_DR05_dtheta_SigmaCB_summary_histogram ->SetYTitle("#sigma#Delta#theta(j_{reco},j_{true})");
  h_100_CT_wO_DR05_dtheta_SigmaCB_summary_histogram->SetXTitle("|cos#theta|");
  h_100_CT_wO_DR05_dtheta_SigmaCB_summary_histogram->SetLineWidth(2);
  h_100_CT_wO_DR05_dtheta_SigmaCB_summary_histogram->SetLineColor(kCyan+1);
  h_100_CT_wO_DR05_dtheta_SigmaCB_summary_histogram->SetLineStyle(2);

  TH1F* h_100_CT_wO_DR05_dtheta_RMS90_summary_histogram=new TH1F("dthetaRes_RMS90VsCosTheta_CT_wO_DR05_100", "RMS_{90} #Delta#theta(j_{reco},j_{true}) vs |cos#theta|", nRegionBinsAngles, pRegionBinEdgesAngles);
  h_100_CT_wO_DR05_dtheta_RMS90_summary_histogram ->SetYTitle("RMS_{90}#Delta#theta(j_{reco},j_{true})");
  h_100_CT_wO_DR05_dtheta_RMS90_summary_histogram->SetXTitle("|cos#theta|");
  h_100_CT_wO_DR05_dtheta_RMS90_summary_histogram->SetLineWidth(2);
  h_100_CT_wO_DR05_dtheta_RMS90_summary_histogram->SetLineColor(kCyan+1);
  h_100_CT_wO_DR05_dtheta_RMS90_summary_histogram->SetLineStyle(2);

  TH1F* h_100_CT_wO_DR07_dtheta_SigmaCB_summary_histogram=new TH1F("dthetaRes_SigmaCBVsCosTheta_CT_wO_DR07_100", "#sigma#Delta#theta(j_{reco},j_{true}) vs |cos#theta|", nRegionBinsAngles, pRegionBinEdgesAngles);
  h_100_CT_wO_DR07_dtheta_SigmaCB_summary_histogram ->SetYTitle("#sigma#Delta#theta(j_{reco},j_{true})");
  h_100_CT_wO_DR07_dtheta_SigmaCB_summary_histogram->SetXTitle("|cos#theta|");
  h_100_CT_wO_DR07_dtheta_SigmaCB_summary_histogram->SetLineWidth(2);
  h_100_CT_wO_DR07_dtheta_SigmaCB_summary_histogram->SetLineColor(kCyan+1);
  h_100_CT_wO_DR07_dtheta_SigmaCB_summary_histogram->SetLineStyle(2);

  TH1F* h_100_CT_wO_DR07_dtheta_RMS90_summary_histogram=new TH1F("dthetaRes_RMS90VsCosTheta_CT_wO_DR07_100", "RMS_{90} #Delta#theta(j_{reco},j_{true}) vs |cos#theta|", nRegionBinsAngles, pRegionBinEdgesAngles);
  h_100_CT_wO_DR07_dtheta_RMS90_summary_histogram ->SetYTitle("RMS_{90}#Delta#theta(j_{reco},j_{true})");
  h_100_CT_wO_DR07_dtheta_RMS90_summary_histogram->SetXTitle("|cos#theta|");
  h_100_CT_wO_DR07_dtheta_RMS90_summary_histogram->SetLineWidth(2);
  h_100_CT_wO_DR07_dtheta_RMS90_summary_histogram->SetLineColor(kCyan+1);
  h_100_CT_wO_DR07_dtheta_RMS90_summary_histogram->SetLineStyle(2);

  TH1F* h_100_CT_wO_DR10_dtheta_SigmaCB_summary_histogram=new TH1F("dthetaRes_SigmaCBVsCosTheta_CT_wO_DR10_100", "#sigma#Delta#theta(j_{reco},j_{true}) vs |cos#theta|", nRegionBinsAngles, pRegionBinEdgesAngles);
  h_100_CT_wO_DR10_dtheta_SigmaCB_summary_histogram ->SetYTitle("#sigma#Delta#theta(j_{reco},j_{true})");
  h_100_CT_wO_DR10_dtheta_SigmaCB_summary_histogram->SetXTitle("|cos#theta|");
  h_100_CT_wO_DR10_dtheta_SigmaCB_summary_histogram->SetLineWidth(2);
  h_100_CT_wO_DR10_dtheta_SigmaCB_summary_histogram->SetLineColor(kCyan+1);
  h_100_CT_wO_DR10_dtheta_SigmaCB_summary_histogram->SetLineStyle(2);

  TH1F* h_100_CT_wO_DR10_dtheta_RMS90_summary_histogram=new TH1F("dthetaRes_RMS90VsCosTheta_CT_wO_DR10_100", "RMS_{90} #Delta#theta(j_{reco},j_{true}) vs |cos#theta|", nRegionBinsAngles, pRegionBinEdgesAngles);
  h_100_CT_wO_DR10_dtheta_RMS90_summary_histogram ->SetYTitle("RMS_{90}#Delta#theta(j_{reco},j_{true})");
  h_100_CT_wO_DR10_dtheta_RMS90_summary_histogram->SetXTitle("|cos#theta|");
  h_100_CT_wO_DR10_dtheta_RMS90_summary_histogram->SetLineWidth(2);
  h_100_CT_wO_DR10_dtheta_RMS90_summary_histogram->SetLineColor(kCyan+1);
  h_100_CT_wO_DR10_dtheta_RMS90_summary_histogram->SetLineStyle(2);

  for(int i=137;i<161;i++){
    //continue;
    std::cout<<"ang histo 100 "<<i<<"]"<<std::endl;
   //double sided crystal ball
    TF1* fit_gaus_tmp = new TF1("fit_gaus_tmp", "gaus",-5.,5.);
    hist_vec_100_CT_wO[i]->Fit("fit_gaus_tmp","R");
    hist_vec_100_CT_wO[i]->GetFunction("fit_gaus_tmp");
    TF1* fdscb_tmp = new TF1("fdscb_tmp",fnc_dscb,-lim_angleDeg,lim_angleDeg,7);
    fdscb_tmp->SetNpx(2000);
    fdscb_tmp->SetParameter(0,fit_gaus_tmp->GetParameter(0));
    //norm
    fdscb_tmp->SetParLimits (0,0.5*fit_gaus_tmp->GetParameter(0),1.5*fit_gaus_tmp->GetParameter(0));
    fdscb_tmp->SetParameter(1,fit_gaus_tmp->GetParameter(1));
    //gaussian mean
    fdscb_tmp->SetParLimits (1,-2.,2.);
    fdscb_tmp->SetParameter(2,fit_gaus_tmp->GetParameter(2));
    fdscb_tmp->SetParLimits(2,fit_gaus_tmp->GetParameter(2)*0.50,1.50*fit_gaus_tmp->GetParameter(2));
    //std::vector<float>sigma2SFit=sigmaGaussianFits2Sigma(hist_vec_100_CT_wO[i]);
    //fdscb_tmp->SetParameter(2,sigma2SFit[0]);
    //fdscb_tmp->SetParLimits(2,sigma2SFit[0]*0.50,1.50*sigma2SFit[0]);
    //-a1: parameter, from when the gaussian core should count
    fdscb_tmp->SetParameter(2,fit_gaus_tmp->GetParameter(2));
    fdscb_tmp->SetParameter (3,3.0);
    fdscb_tmp->SetParLimits (3,0.0,10.);
    //a2 parameter, up to when the gaussian core should count
    fdscb_tmp->SetParameter (5,3.0);
    fdscb_tmp->SetParLimits (5,0.0,10.);
    fdscb_tmp->SetParameter(4,5.);
    fdscb_tmp->SetParLimits(4,0.,25.);
    fdscb_tmp->SetParameter(6,5.);
    fdscb_tmp->SetParLimits(6,0.,25.);
    int fitstatus(0); 
    fitstatus = hist_vec_100_CT_wO[i]->Fit(fdscb_tmp,"R");
    fdscb_tmp = hist_vec_100_CT_wO[i]->GetFunction("fdscb_tmp");
    resolutionTH1=0; 
    resolutionErrorTH1=0;
    meanTH1=0;
    meanErrorTH1=0;
    CalculatePerformanceNoMean( hist_vec_100_CT_wO[i], resolutionTH1, resolutionErrorTH1,meanTH1,meanErrorTH1);
    int first_bin_ang=137;
    if(i<141){//dphi DR05
      first_bin_ang=137;
      h_100_CT_wO_DR05_dphi_SigmaCB_summary_histogram->SetBinContent(i-first_bin_ang+1,fdscb_tmp->GetParameter(2));
      h_100_CT_wO_DR05_dphi_SigmaCB_summary_histogram->SetBinError(i-first_bin_ang+1,fdscb_tmp->GetParError(2));
      h_100_CT_wO_DR05_dphi_RMS90_summary_histogram->SetBinContent(i-first_bin_ang+1,resolutionTH1);
      h_100_CT_wO_DR05_dphi_RMS90_summary_histogram->SetBinError(i-first_bin_ang+1, resolutionErrorTH1);
    }else if(i<145){//dtheta DR05
      first_bin_ang=141;
      h_100_CT_wO_DR05_dtheta_SigmaCB_summary_histogram->SetBinContent(i-first_bin_ang+1,fdscb_tmp->GetParameter(2));
      h_100_CT_wO_DR05_dtheta_SigmaCB_summary_histogram->SetBinError(i-first_bin_ang+1,fdscb_tmp->GetParError(2));
      h_100_CT_wO_DR05_dtheta_RMS90_summary_histogram->SetBinContent(i-first_bin_ang+1,resolutionTH1);
      h_100_CT_wO_DR05_dtheta_RMS90_summary_histogram->SetBinError(i-first_bin_ang+1, resolutionErrorTH1);
    }else if(i<149){//dphi DR07
      first_bin_ang=145;
      h_100_CT_wO_DR07_dphi_SigmaCB_summary_histogram->SetBinContent(i-first_bin_ang+1,fdscb_tmp->GetParameter(2));
      h_100_CT_wO_DR07_dphi_SigmaCB_summary_histogram->SetBinError(i-first_bin_ang+1,fdscb_tmp->GetParError(2));
      h_100_CT_wO_DR07_dphi_RMS90_summary_histogram->SetBinContent(i-first_bin_ang+1,resolutionTH1);
      h_100_CT_wO_DR07_dphi_RMS90_summary_histogram->SetBinError(i-first_bin_ang+1, resolutionErrorTH1);
    }else if(i<153){//dtheta DR07
      first_bin_ang=149;
      h_100_CT_wO_DR07_dtheta_SigmaCB_summary_histogram->SetBinContent(i-first_bin_ang+1,fdscb_tmp->GetParameter(2));
      h_100_CT_wO_DR07_dtheta_SigmaCB_summary_histogram->SetBinError(i-first_bin_ang+1,fdscb_tmp->GetParError(2));
      h_100_CT_wO_DR07_dtheta_RMS90_summary_histogram->SetBinContent(i-first_bin_ang+1,resolutionTH1);
      h_100_CT_wO_DR07_dtheta_RMS90_summary_histogram->SetBinError(i-first_bin_ang+1, resolutionErrorTH1);
    }else if(i<157){//dphi DR07
      first_bin_ang=153;
      h_100_CT_wO_DR10_dphi_SigmaCB_summary_histogram->SetBinContent(i-first_bin_ang+1,fdscb_tmp->GetParameter(2));
      h_100_CT_wO_DR10_dphi_SigmaCB_summary_histogram->SetBinError(i-first_bin_ang+1,fdscb_tmp->GetParError(2));
      h_100_CT_wO_DR10_dphi_RMS90_summary_histogram->SetBinContent(i-first_bin_ang+1,resolutionTH1);
      h_100_CT_wO_DR10_dphi_RMS90_summary_histogram->SetBinError(i-first_bin_ang+1, resolutionErrorTH1);
    }else if(i<161){//dtheta DR07
      first_bin_ang=157;
      h_100_CT_wO_DR10_dtheta_SigmaCB_summary_histogram->SetBinContent(i-first_bin_ang+1,fdscb_tmp->GetParameter(2));
      h_100_CT_wO_DR10_dtheta_SigmaCB_summary_histogram->SetBinError(i-first_bin_ang+1,fdscb_tmp->GetParError(2));
      h_100_CT_wO_DR10_dtheta_RMS90_summary_histogram->SetBinContent(i-first_bin_ang+1,resolutionTH1);
      h_100_CT_wO_DR10_dtheta_RMS90_summary_histogram->SetBinError(i-first_bin_ang+1, resolutionErrorTH1);
    }
  }

  TH1F* h_100_CT_wO_DR05_E_SigmaCB_summary_histogram=new TH1F("JER_SigmaCBVsCosTheta_CT_wO_DR05_100", "RMS_{90}(E_{j}^{reco}/E_{j}^{gen}) / Mean_{90}(E_{j}^{reco}/E_{j}^{gen}) vs |cos#theta|", nRegionBins, pRegionBinEdges);
  h_100_CT_wO_DR05_E_SigmaCB_summary_histogram ->SetYTitle("#sigma(E_{j}) / E_{j} [%]");
  h_100_CT_wO_DR05_E_SigmaCB_summary_histogram->SetXTitle("|cos#theta|");
  h_100_CT_wO_DR05_E_SigmaCB_summary_histogram->SetLineWidth(2);
  h_100_CT_wO_DR05_E_SigmaCB_summary_histogram->SetLineColor(kCyan+1);
  h_100_CT_wO_DR05_E_SigmaCB_summary_histogram->SetLineStyle(2);
  TH1F* h_100_CT_wO_DR05_E_RMS90_summary_histogram=new TH1F("JER_RMS90VsCosTheta_CT_wO_DR05_100", "RMS_{90}(E_{j}^{reco}/E_{j}^{gen}) / Mean_{90}(E_{j}^{reco}/E_{j}^{gen}) vs |cos#theta|", nRegionBins, pRegionBinEdges);
  h_100_CT_wO_DR05_E_RMS90_summary_histogram ->SetYTitle("RMS_{90}(E_{j}^{reco}/E_{j}^{gen}) / Mean_{90}(E_{j}^{reco}/E_{j}^{gen}) [%]");
  h_100_CT_wO_DR05_E_RMS90_summary_histogram->SetXTitle("|cos#theta|");
  h_100_CT_wO_DR05_E_RMS90_summary_histogram->SetLineWidth(2);
  h_100_CT_wO_DR05_E_RMS90_summary_histogram->SetLineColor(kRed);
  h_100_CT_wO_DR05_E_RMS90_summary_histogram->SetLineStyle(2);

  TH1F* h_100_CT_wO_DR05_E_RMS_summary_histogram=new TH1F("JER_RMSVsCosTheta_CT_wO_DR05_100", "RMS(E_{j}) / Mean(E_{j}) vs |cos#theta|", nRegionBins, pRegionBinEdges);
  h_100_CT_wO_DR05_E_RMS_summary_histogram ->SetYTitle("RMS(E_{j}) / Mean(E_{j}) [%]");
  h_100_CT_wO_DR05_E_RMS_summary_histogram->SetXTitle("|cos#theta|");
  h_100_CT_wO_DR05_E_RMS_summary_histogram->SetLineWidth(2);
  h_100_CT_wO_DR05_E_RMS_summary_histogram->SetLineColor(kRed);
  h_100_CT_wO_DR05_E_RMS_summary_histogram->SetLineStyle(2);

  TH1F* h_100_CT_wO_DR05_E_JER_Mean_summary_histogram=new TH1F("JER_MeanVsCosTheta_CT_wO_DR05_100", "Mean(E_{tot}^{RECO}/E_{tot}^{true}) vs |cos#theta|", nRegionBins, pRegionBinEdges);
  h_100_CT_wO_DR05_E_JER_Mean_summary_histogram->SetYTitle("Mean(E_{tot}^{RECO}/E_{tot}^{true})");
  h_100_CT_wO_DR05_E_JER_Mean_summary_histogram->SetXTitle("|cos#theta|");
  h_100_CT_wO_DR05_E_JER_Mean_summary_histogram->SetLineWidth(2);
  h_100_CT_wO_DR05_E_JER_Mean_summary_histogram->SetLineColor(kRed);
  h_100_CT_wO_DR05_E_JER_Mean_summary_histogram->SetLineStyle(2);

  firstbin=59;
  for(int i=firstbin;i<(firstbin+13);i++){
    resolutionTH1=0; 
    resolutionErrorTH1=0;
    meanTH1=0;
    meanErrorTH1=0;
    CalculatePerformance( hist_vec_100_CT_wO[i], resolutionTH1, resolutionErrorTH1,meanTH1,meanErrorTH1);
    h_100_CT_wO_DR05_E_RMS90_summary_histogram->SetBinContent(i-firstbin+1,resolutionTH1/sqrt(2.));
    h_100_CT_wO_DR05_E_RMS90_summary_histogram ->SetBinError(i-firstbin+1, resolutionErrorTH1/sqrt(2.));
    h_100_CT_wO_DR05_E_RMS_summary_histogram->SetBinContent(i-firstbin+1,hist_vec_100_CT_wO[i]->GetRMS()*100. );
    h_100_CT_wO_DR05_E_RMS_summary_histogram ->SetBinError(i-firstbin+1, hist_vec_100_CT_wO[i]->GetRMSError()*100.);
    h_100_CT_wO_DR05_E_JER_Mean_summary_histogram->SetBinContent(i-firstbin+1,hist_vec_100_CT_wO[i]->GetMean());
    h_100_CT_wO_DR05_E_JER_Mean_summary_histogram->SetBinError(i-firstbin+1,hist_vec_100_CT_wO[i]->GetMeanError());
    //double sided crystal ball
    TF1* fit_gaus_tmp = new TF1("fit_gaus_tmp", "gaus",0.50,1.50);
    hist_vec_100_CT_wO[i]->Fit("fit_gaus_tmp","R");
    hist_vec_100_CT_wO[i]->GetFunction("fit_gaus_tmp");

    TF1* fdscb_tmp = new TF1("fdscb_tmp",fnc_dscb,0.,3.,7);
    fdscb_tmp->SetNpx(1000);
    fdscb_tmp->SetParameter(0,fit_gaus_tmp->GetParameter(0));
    //norm
    fdscb_tmp->SetParLimits (0,0.5*fit_gaus_tmp->GetParameter(0),1.5*fit_gaus_tmp->GetParameter(0));
    fdscb_tmp->SetParameter(1,fit_gaus_tmp->GetParameter(1));
    //gaussian mean
    fdscb_tmp->SetParLimits (1,0.8,1.2);
    //fdscb_tmp->SetParameter(2,fit_gaus_tmp->GetParameter(2));
    //fdscb_tmp->SetParLimits(2,fit_gaus_tmp->GetParameter(2)*0.50,1.50*fit_gaus_tmp->GetParameter(2));
    std::vector<float>sigma2SFit=sigmaGaussianFits2Sigma(hist_vec_100_CT_wO[i]);
    fdscb_tmp->SetParameter(2,sigma2SFit[0]);
    fdscb_tmp->SetParLimits(2,sigma2SFit[0]*0.50,1.50*sigma2SFit[0]);
    //-a1: parameter, from when the gaussian core should count
    fdscb_tmp->SetParameter(2,fit_gaus_tmp->GetParameter(2));
    fdscb_tmp->SetParameter (3,3.0);
    fdscb_tmp->SetParLimits (3,0.0,10.);
    //a2 parameter, up to when the gaussian core should count
    fdscb_tmp->SetParameter (5,3.0);
    fdscb_tmp->SetParLimits (5,0.0,10.);
    fdscb_tmp->SetParameter(4,5.);
    fdscb_tmp->SetParLimits(4,0.,25.);
    fdscb_tmp->SetParameter(6,5.);
    fdscb_tmp->SetParLimits(6,0.,25.);
    int fitstatus(0); 
    fitstatus = hist_vec_100_CT_wO[i]->Fit(fdscb_tmp,"R");
    fdscb_tmp = hist_vec_100_CT_wO[i]->GetFunction("fdscb_tmp");
    h_100_CT_wO_DR05_E_SigmaCB_summary_histogram->SetBinContent(i-firstbin+1,fdscb_tmp->GetParameter(2)*100. );
    h_100_CT_wO_DR05_E_SigmaCB_summary_histogram->SetBinError(i-firstbin+1,fdscb_tmp->GetParError(2)*100. );
  }  
  TH1F* h_100_CT_wO_DR06_E_SigmaCB_summary_histogram=new TH1F("JER_SigmaCBVsCosTheta_CT_wO_DR06_100", "RMS_{90}(E_{j}^{reco}/E_{j}^{gen}) / Mean_{90}(E_{j}^{reco}/E_{j}^{gen}) vs |cos#theta|", nRegionBins, pRegionBinEdges);
  h_100_CT_wO_DR06_E_SigmaCB_summary_histogram ->SetYTitle("#sigma(E_{j}) / E_{j} [%]");
  h_100_CT_wO_DR06_E_SigmaCB_summary_histogram->SetXTitle("|cos#theta|");
  h_100_CT_wO_DR06_E_SigmaCB_summary_histogram->SetLineWidth(2);
  h_100_CT_wO_DR06_E_SigmaCB_summary_histogram->SetLineColor(kCyan+1);
  h_100_CT_wO_DR06_E_SigmaCB_summary_histogram->SetLineStyle(2);
  TH1F* h_100_CT_wO_DR06_E_RMS90_summary_histogram=new TH1F("JER_RMS90VsCosTheta_CT_wO_DR06_100", "RMS_{90}(E_{j}^{reco}/E_{j}^{gen}) / Mean_{90}(E_{j}^{reco}/E_{j}^{gen}) vs |cos#theta|", nRegionBins, pRegionBinEdges);
  h_100_CT_wO_DR06_E_RMS90_summary_histogram ->SetYTitle("RMS_{90}(E_{j}^{reco}/E_{j}^{gen}) / Mean_{90}(E_{j}^{reco}/E_{j}^{gen}) [%]");
  h_100_CT_wO_DR06_E_RMS90_summary_histogram->SetXTitle("|cos#theta|");
  h_100_CT_wO_DR06_E_RMS90_summary_histogram->SetLineWidth(2);
  h_100_CT_wO_DR06_E_RMS90_summary_histogram->SetLineColor(kRed);
  h_100_CT_wO_DR06_E_RMS90_summary_histogram->SetLineStyle(2);

  TH1F* h_100_CT_wO_DR06_E_RMS_summary_histogram=new TH1F("JER_RMSVsCosTheta_CT_wO_DR06_100", "RMS(E_{j}) / Mean(E_{j}) vs |cos#theta|", nRegionBins, pRegionBinEdges);
  h_100_CT_wO_DR06_E_RMS_summary_histogram ->SetYTitle("RMS(E_{j}) / Mean(E_{j}) [%]");
  h_100_CT_wO_DR06_E_RMS_summary_histogram->SetXTitle("|cos#theta|");
  h_100_CT_wO_DR06_E_RMS_summary_histogram->SetLineWidth(2);
  h_100_CT_wO_DR06_E_RMS_summary_histogram->SetLineColor(kRed);
  h_100_CT_wO_DR06_E_RMS_summary_histogram->SetLineStyle(2);

  TH1F* h_100_CT_wO_DR06_E_JER_Mean_summary_histogram=new TH1F("JER_MeanVsCosTheta_CT_wO_DR06_100", "Mean(E_{tot}^{RECO}/E_{tot}^{true}) vs |cos#theta|", nRegionBins, pRegionBinEdges);
  h_100_CT_wO_DR06_E_JER_Mean_summary_histogram->SetYTitle("Mean(E_{tot}^{RECO}/E_{tot}^{true})");
  h_100_CT_wO_DR06_E_JER_Mean_summary_histogram->SetXTitle("|cos#theta|");
  h_100_CT_wO_DR06_E_JER_Mean_summary_histogram->SetLineWidth(2);
  h_100_CT_wO_DR06_E_JER_Mean_summary_histogram->SetLineColor(kRed);
  h_100_CT_wO_DR06_E_JER_Mean_summary_histogram->SetLineStyle(2);
  firstbin=72;
  for(int i=firstbin;i<(firstbin+13);i++){
    //continue;
    resolutionTH1=0; 
    resolutionErrorTH1=0;
    meanTH1=0;
    meanErrorTH1=0;
    CalculatePerformance( hist_vec_100_CT_wO[i], resolutionTH1, resolutionErrorTH1,meanTH1,meanErrorTH1);
    h_100_CT_wO_DR06_E_RMS90_summary_histogram->SetBinContent(i-firstbin+1,resolutionTH1/sqrt(2.));
    h_100_CT_wO_DR06_E_RMS90_summary_histogram ->SetBinError(i-firstbin+1, resolutionErrorTH1/sqrt(2.));
    h_100_CT_wO_DR06_E_RMS_summary_histogram->SetBinContent(i-firstbin+1,hist_vec_100_CT_wO[i]->GetRMS()*100. );
    h_100_CT_wO_DR06_E_RMS_summary_histogram ->SetBinError(i-firstbin+1, hist_vec_100_CT_wO[i]->GetRMSError()*100.);
    h_100_CT_wO_DR06_E_JER_Mean_summary_histogram->SetBinContent(i-firstbin+1,hist_vec_100_CT_wO[i]->GetMean());
    h_100_CT_wO_DR06_E_JER_Mean_summary_histogram->SetBinError(i-firstbin+1,hist_vec_100_CT_wO[i]->GetMeanError());
    //double sided crystal ball
    TF1* fit_gaus_tmp = new TF1("fit_gaus_tmp", "gaus",0.50,1.50);
    hist_vec_100_CT_wO[i]->Fit("fit_gaus_tmp","R");
    hist_vec_100_CT_wO[i]->GetFunction("fit_gaus_tmp");

    TF1* fdscb_tmp = new TF1("fdscb_tmp",fnc_dscb,0.,3.,7);
   fdscb_tmp->SetNpx(1000);
    fdscb_tmp->SetParameter(0,fit_gaus_tmp->GetParameter(0));
    //norm
    fdscb_tmp->SetParLimits (0,0.5*fit_gaus_tmp->GetParameter(0),1.5*fit_gaus_tmp->GetParameter(0));
    fdscb_tmp->SetParameter(1,fit_gaus_tmp->GetParameter(1));
    //gaussian mean
    fdscb_tmp->SetParLimits (1,0.8,1.2);
    //fdscb_tmp->SetParameter(2,fit_gaus_tmp->GetParameter(2));
    //fdscb_tmp->SetParLimits(2,fit_gaus_tmp->GetParameter(2)*0.50,1.50*fit_gaus_tmp->GetParameter(2));
    std::vector<float>sigma2SFit=sigmaGaussianFits2Sigma(hist_vec_100_CT_wO[i]);
    fdscb_tmp->SetParameter(2,sigma2SFit[0]);
    fdscb_tmp->SetParLimits(2,sigma2SFit[0]*0.50,1.50*sigma2SFit[0]);
    //-a1: parameter, from when the gaussian core should count
    fdscb_tmp->SetParameter(2,fit_gaus_tmp->GetParameter(2));
    fdscb_tmp->SetParameter (3,3.0);
    fdscb_tmp->SetParLimits (3,0.0,10.);
    //a2 parameter, up to when the gaussian core should count
    fdscb_tmp->SetParameter (5,3.0);
    fdscb_tmp->SetParLimits (5,0.0,10.);
    fdscb_tmp->SetParameter(4,5.);
    fdscb_tmp->SetParLimits(4,0.,25.);
    fdscb_tmp->SetParameter(6,5.);
    fdscb_tmp->SetParLimits(6,0.,25.);
    int fitstatus(0); 
    fitstatus = hist_vec_100_CT_wO[i]->Fit(fdscb_tmp,"R");
    fdscb_tmp = hist_vec_100_CT_wO[i]->GetFunction("fdscb_tmp");
    h_100_CT_wO_DR06_E_SigmaCB_summary_histogram->SetBinContent(i-firstbin+1,fdscb_tmp->GetParameter(2)*100. );
    h_100_CT_wO_DR06_E_SigmaCB_summary_histogram->SetBinError(i-firstbin+1,fdscb_tmp->GetParError(2)*100. );
  }  
  TH1F* h_100_CT_wO_DR07_E_SigmaCB_summary_histogram=new TH1F("JER_SigmaCBVsCosTheta_CT_wO_DR07_100", "RMS_{90}(E_{j}^{reco}/E_{j}^{gen}) / Mean_{90}(E_{j}^{reco}/E_{j}^{gen}) vs |cos#theta|", nRegionBins, pRegionBinEdges);
  h_100_CT_wO_DR07_E_SigmaCB_summary_histogram ->SetYTitle("#sigma(E_{j}) / E_{j} [%]");
  h_100_CT_wO_DR07_E_SigmaCB_summary_histogram->SetXTitle("|cos#theta|");
  h_100_CT_wO_DR07_E_SigmaCB_summary_histogram->SetLineWidth(2);
  h_100_CT_wO_DR07_E_SigmaCB_summary_histogram->SetLineColor(kCyan+1);
  h_100_CT_wO_DR07_E_SigmaCB_summary_histogram->SetLineStyle(2);
  TH1F* h_100_CT_wO_DR07_E_RMS90_summary_histogram=new TH1F("JER_RMS90VsCosTheta_CT_wO_DR07_100", "RMS_{90}(E_{j}^{reco}/E_{j}^{gen}) / Mean_{90}(E_{j}^{reco}/E_{j}^{gen}) vs |cos#theta|", nRegionBins, pRegionBinEdges);
  h_100_CT_wO_DR07_E_RMS90_summary_histogram ->SetYTitle("RMS_{90}(E_{j}^{reco}/E_{j}^{gen}) / Mean_{90}(E_{j}^{reco}/E_{j}^{gen}) [%]");
  h_100_CT_wO_DR07_E_RMS90_summary_histogram->SetXTitle("|cos#theta|");
  h_100_CT_wO_DR07_E_RMS90_summary_histogram->SetLineWidth(2);
  h_100_CT_wO_DR07_E_RMS90_summary_histogram->SetLineColor(kRed);
  h_100_CT_wO_DR07_E_RMS90_summary_histogram->SetLineStyle(2);

  TH1F* h_100_CT_wO_DR07_E_RMS_summary_histogram=new TH1F("JER_RMSVsCosTheta_CT_wO_DR07_100", "RMS(E_{j}) / Mean(E_{j}) vs |cos#theta|", nRegionBins, pRegionBinEdges);
  h_100_CT_wO_DR07_E_RMS_summary_histogram ->SetYTitle("RMS(E_{j}) / Mean(E_{j}) [%]");
  h_100_CT_wO_DR07_E_RMS_summary_histogram->SetXTitle("|cos#theta|");
  h_100_CT_wO_DR07_E_RMS_summary_histogram->SetLineWidth(2);
  h_100_CT_wO_DR07_E_RMS_summary_histogram->SetLineColor(kRed);
  h_100_CT_wO_DR07_E_RMS_summary_histogram->SetLineStyle(2);

  TH1F* h_100_CT_wO_DR07_E_JER_Mean_summary_histogram=new TH1F("JER_MeanVsCosTheta_CT_wO_DR07_100", "Mean(E_{tot}^{RECO}/E_{tot}^{true}) vs |cos#theta|", nRegionBins, pRegionBinEdges);
  h_100_CT_wO_DR07_E_JER_Mean_summary_histogram->SetYTitle("Mean(E_{tot}^{RECO}/E_{tot}^{true})");
  h_100_CT_wO_DR07_E_JER_Mean_summary_histogram->SetXTitle("|cos#theta|");
  h_100_CT_wO_DR07_E_JER_Mean_summary_histogram->SetLineWidth(2);
  h_100_CT_wO_DR07_E_JER_Mean_summary_histogram->SetLineColor(kRed);
  h_100_CT_wO_DR07_E_JER_Mean_summary_histogram->SetLineStyle(2);
  firstbin=85;
  std::cout<<"start DR07 wO 100"<<std::endl;
  for(int i=firstbin;i<(firstbin+13);i++){
    //continue;
    resolutionTH1=0; 
    resolutionErrorTH1=0;
    meanTH1=0;
    meanErrorTH1=0;
    CalculatePerformance( hist_vec_100_CT_wO[i], resolutionTH1, resolutionErrorTH1,meanTH1,meanErrorTH1);
    h_100_CT_wO_DR07_E_RMS90_summary_histogram->SetBinContent(i-firstbin+1,resolutionTH1/sqrt(2.));
    h_100_CT_wO_DR07_E_RMS90_summary_histogram ->SetBinError(i-firstbin+1, resolutionErrorTH1/sqrt(2.));
    h_100_CT_wO_DR07_E_RMS_summary_histogram->SetBinContent(i-firstbin+1,hist_vec_100_CT_wO[i]->GetRMS()*100. );
    h_100_CT_wO_DR07_E_RMS_summary_histogram ->SetBinError(i-firstbin+1, hist_vec_100_CT_wO[i]->GetRMSError()*100.);
    h_100_CT_wO_DR07_E_JER_Mean_summary_histogram->SetBinContent(i-firstbin+1,hist_vec_100_CT_wO[i]->GetMean());
    h_100_CT_wO_DR07_E_JER_Mean_summary_histogram->SetBinError(i-firstbin+1,hist_vec_100_CT_wO[i]->GetMeanError());
    //double sided crystal ball
    TF1* fit_gaus_tmp = new TF1("fit_gaus_tmp", "gaus",0.50,1.50);
    hist_vec_100_CT_wO[i]->Fit("fit_gaus_tmp","R");
    hist_vec_100_CT_wO[i]->GetFunction("fit_gaus_tmp");

    TF1* fdscb_tmp = new TF1("fdscb_tmp",fnc_dscb,0.,3.,7);
    fdscb_tmp->SetNpx(1000);
    fdscb_tmp->SetParameter(0,fit_gaus_tmp->GetParameter(0));
    //norm
    fdscb_tmp->SetParLimits (0,0.5*fit_gaus_tmp->GetParameter(0),1.5*fit_gaus_tmp->GetParameter(0));
    fdscb_tmp->SetParameter(1,fit_gaus_tmp->GetParameter(1));
    //gaussian mean
    fdscb_tmp->SetParLimits (1,0.8,1.2);
    //fdscb_tmp->SetParameter(2,fit_gaus_tmp->GetParameter(2));
    //fdscb_tmp->SetParLimits(2,fit_gaus_tmp->GetParameter(2)*0.50,1.50*fit_gaus_tmp->GetParameter(2));
    std::vector<float>sigma2SFit=sigmaGaussianFits2Sigma(hist_vec_100_CT_wO[i]);
    fdscb_tmp->SetParameter(2,sigma2SFit[0]);
    fdscb_tmp->SetParLimits(2,sigma2SFit[0]*0.50,1.50*sigma2SFit[0]);
    //-a1: parameter, from when the gaussian core should count
    fdscb_tmp->SetParameter(2,fit_gaus_tmp->GetParameter(2));
    fdscb_tmp->SetParameter (3,3.0);
    fdscb_tmp->SetParLimits (3,0.0,10.0);
    //a2 parameter, up to when the gaussian core should count
    fdscb_tmp->SetParameter (5,3.0);
    fdscb_tmp->SetParLimits (5,0.0,10.0);
    fdscb_tmp->SetParameter(4,5.);
    fdscb_tmp->SetParLimits(4,0.,25.);
    fdscb_tmp->SetParameter(6,5.);
    fdscb_tmp->SetParLimits(6,0.,25.);
    int fitstatus(0); 
    fitstatus = hist_vec_100_CT_wO[i]->Fit(fdscb_tmp,"R");
    fdscb_tmp = hist_vec_100_CT_wO[i]->GetFunction("fdscb_tmp");
    h_100_CT_wO_DR07_E_SigmaCB_summary_histogram->SetBinContent(i-firstbin+1,fdscb_tmp->GetParameter(2)*100. );
    h_100_CT_wO_DR07_E_SigmaCB_summary_histogram->SetBinError(i-firstbin+1,fdscb_tmp->GetParError(2)*100. );
  }  
  std::cout<<"tend DR07 wO 100"<<std::endl;
  TH1F* h_100_CT_wO_DR08_E_SigmaCB_summary_histogram=new TH1F("JER_SigmaCBVsCosTheta_CT_wO_DR08_100", "RMS_{90}(E_{j}^{reco}/E_{j}^{gen}) / Mean_{90}(E_{j}^{reco}/E_{j}^{gen}) vs |cos#theta|", nRegionBins, pRegionBinEdges);
  h_100_CT_wO_DR08_E_SigmaCB_summary_histogram ->SetYTitle("#sigma(E_{j}) / E_{j} [%]");
  h_100_CT_wO_DR08_E_SigmaCB_summary_histogram->SetXTitle("|cos#theta|");
  h_100_CT_wO_DR08_E_SigmaCB_summary_histogram->SetLineWidth(2);
  h_100_CT_wO_DR08_E_SigmaCB_summary_histogram->SetLineColor(kCyan+1);
  h_100_CT_wO_DR08_E_SigmaCB_summary_histogram->SetLineStyle(2);
  TH1F* h_100_CT_wO_DR08_E_RMS90_summary_histogram=new TH1F("JER_RMS90VsCosTheta_CT_wO_DR08_100", "RMS_{90}(E_{j}^{reco}/E_{j}^{gen}) / Mean_{90}(E_{j}^{reco}/E_{j}^{gen}) vs |cos#theta|", nRegionBins, pRegionBinEdges);
  h_100_CT_wO_DR08_E_RMS90_summary_histogram ->SetYTitle("RMS_{90}(E_{j}^{reco}/E_{j}^{gen}) / Mean_{90}(E_{j}^{reco}/E_{j}^{gen}) [%]");
  h_100_CT_wO_DR08_E_RMS90_summary_histogram->SetXTitle("|cos#theta|");
  h_100_CT_wO_DR08_E_RMS90_summary_histogram->SetLineWidth(2);
  h_100_CT_wO_DR08_E_RMS90_summary_histogram->SetLineColor(kRed);
  h_100_CT_wO_DR08_E_RMS90_summary_histogram->SetLineStyle(2);

  TH1F* h_100_CT_wO_DR08_E_RMS_summary_histogram=new TH1F("JER_RMSVsCosTheta_CT_wO_DR08_100", "RMS(E_{j}) / Mean(E_{j}) vs |cos#theta|", nRegionBins, pRegionBinEdges);
  h_100_CT_wO_DR08_E_RMS_summary_histogram ->SetYTitle("RMS(E_{j}) / Mean(E_{j}) [%]");
  h_100_CT_wO_DR08_E_RMS_summary_histogram->SetXTitle("|cos#theta|");
  h_100_CT_wO_DR08_E_RMS_summary_histogram->SetLineWidth(2);
  h_100_CT_wO_DR08_E_RMS_summary_histogram->SetLineColor(kRed);
  h_100_CT_wO_DR08_E_RMS_summary_histogram->SetLineStyle(2);

  TH1F* h_100_CT_wO_DR08_E_JER_Mean_summary_histogram=new TH1F("JER_MeanVsCosTheta_CT_wO_DR08_100", "Mean(E_{tot}^{RECO}/E_{tot}^{true}) vs |cos#theta|", nRegionBins, pRegionBinEdges);
  h_100_CT_wO_DR08_E_JER_Mean_summary_histogram->SetYTitle("Mean(E_{tot}^{RECO}/E_{tot}^{true})");
  h_100_CT_wO_DR08_E_JER_Mean_summary_histogram->SetXTitle("|cos#theta|");
  h_100_CT_wO_DR08_E_JER_Mean_summary_histogram->SetLineWidth(2);
  h_100_CT_wO_DR08_E_JER_Mean_summary_histogram->SetLineColor(kRed);
  h_100_CT_wO_DR08_E_JER_Mean_summary_histogram->SetLineStyle(2);
  firstbin=98;
  for(int i=firstbin;i<(firstbin+13);i++){
    //continue;
    resolutionTH1=0; 
    resolutionErrorTH1=0;
    meanTH1=0;
    meanErrorTH1=0;
    CalculatePerformance( hist_vec_100_CT_wO[i], resolutionTH1, resolutionErrorTH1,meanTH1,meanErrorTH1);
    h_100_CT_wO_DR08_E_RMS90_summary_histogram->SetBinContent(i-firstbin+1,resolutionTH1/sqrt(2.));
    h_100_CT_wO_DR08_E_RMS90_summary_histogram ->SetBinError(i-firstbin+1, resolutionErrorTH1/sqrt(2.));
    h_100_CT_wO_DR08_E_RMS_summary_histogram->SetBinContent(i-firstbin+1,hist_vec_100_CT_wO[i]->GetRMS()*100. );
    h_100_CT_wO_DR08_E_RMS_summary_histogram ->SetBinError(i-firstbin+1, hist_vec_100_CT_wO[i]->GetRMSError()*100.);
    h_100_CT_wO_DR08_E_JER_Mean_summary_histogram->SetBinContent(i-firstbin+1,hist_vec_100_CT_wO[i]->GetMean());
    h_100_CT_wO_DR08_E_JER_Mean_summary_histogram->SetBinError(i-firstbin+1,hist_vec_100_CT_wO[i]->GetMeanError());
    //double sided crystal ball
    TF1* fit_gaus_tmp = new TF1("fit_gaus_tmp", "gaus",0.50,1.50);
    hist_vec_100_CT_wO[i]->Fit("fit_gaus_tmp","R");
    hist_vec_100_CT_wO[i]->GetFunction("fit_gaus_tmp");

    TF1* fdscb_tmp = new TF1("fdscb_tmp",fnc_dscb,0.,3.,7);
    fdscb_tmp->SetNpx(1000);
    fdscb_tmp->SetParameter(0,fit_gaus_tmp->GetParameter(0));
    //norm
    fdscb_tmp->SetParLimits (0,0.5*fit_gaus_tmp->GetParameter(0),1.5*fit_gaus_tmp->GetParameter(0));
    fdscb_tmp->SetParameter(1,fit_gaus_tmp->GetParameter(1));
    //gaussian mean
    fdscb_tmp->SetParLimits (1,0.8,1.2);
    //fdscb_tmp->SetParameter(2,fit_gaus_tmp->GetParameter(2));
    //fdscb_tmp->SetParLimits(2,fit_gaus_tmp->GetParameter(2)*0.50,1.50*fit_gaus_tmp->GetParameter(2));
    std::vector<float>sigma2SFit=sigmaGaussianFits2Sigma(hist_vec_100_CT_wO[i]);
    fdscb_tmp->SetParameter(2,sigma2SFit[0]);
    fdscb_tmp->SetParLimits(2,sigma2SFit[0]*0.50,1.50*sigma2SFit[0]);
    //-a1: parameter, from when the gaussian core should count
    fdscb_tmp->SetParameter(2,fit_gaus_tmp->GetParameter(2));
    fdscb_tmp->SetParameter (3,3.0);
    fdscb_tmp->SetParLimits (3,0.0,10.0);
    //a2 parameter, up to when the gaussian core should count
    fdscb_tmp->SetParameter (5,3.0);
    fdscb_tmp->SetParLimits (5,0.0,10.0);
    fdscb_tmp->SetParameter(4,5.);
    fdscb_tmp->SetParLimits(4,0.,25.);
    fdscb_tmp->SetParameter(6,5.);
    fdscb_tmp->SetParLimits(6,0.,25.);
    int fitstatus(0); 
    fitstatus = hist_vec_100_CT_wO[i]->Fit(fdscb_tmp,"R");
    fdscb_tmp = hist_vec_100_CT_wO[i]->GetFunction("fdscb_tmp");
    h_100_CT_wO_DR08_E_SigmaCB_summary_histogram->SetBinContent(i-firstbin+1,fdscb_tmp->GetParameter(2)*100. );
    h_100_CT_wO_DR08_E_SigmaCB_summary_histogram->SetBinError(i-firstbin+1,fdscb_tmp->GetParError(2)*100. );
  }  
  TH1F* h_100_CT_wO_DR09_E_SigmaCB_summary_histogram=new TH1F("JER_SigmaCBVsCosTheta_CT_wO_DR09_100", "RMS_{90}(E_{j}^{reco}/E_{j}^{gen}) / Mean_{90}(E_{j}^{reco}/E_{j}^{gen}) vs |cos#theta|", nRegionBins, pRegionBinEdges);
  h_100_CT_wO_DR09_E_SigmaCB_summary_histogram ->SetYTitle("#sigma(E_{j}) / E_{j} [%]");
  h_100_CT_wO_DR09_E_SigmaCB_summary_histogram->SetXTitle("|cos#theta|");
  h_100_CT_wO_DR09_E_SigmaCB_summary_histogram->SetLineWidth(2);
  h_100_CT_wO_DR09_E_SigmaCB_summary_histogram->SetLineColor(kCyan+1);
  h_100_CT_wO_DR09_E_SigmaCB_summary_histogram->SetLineStyle(2);
  TH1F* h_100_CT_wO_DR09_E_RMS90_summary_histogram=new TH1F("JER_RMS90VsCosTheta_CT_wO_DR09_100", "RMS_{90}(E_{j}^{reco}/E_{j}^{gen}) / Mean_{90}(E_{j}^{reco}/E_{j}^{gen}) vs |cos#theta|", nRegionBins, pRegionBinEdges);
  h_100_CT_wO_DR09_E_RMS90_summary_histogram ->SetYTitle("RMS_{90}(E_{j}^{reco}/E_{j}^{gen}) / Mean_{90}(E_{j}^{reco}/E_{j}^{gen}) [%]");
  h_100_CT_wO_DR09_E_RMS90_summary_histogram->SetXTitle("|cos#theta|");
  h_100_CT_wO_DR09_E_RMS90_summary_histogram->SetLineWidth(2);
  h_100_CT_wO_DR09_E_RMS90_summary_histogram->SetLineColor(kRed);
  h_100_CT_wO_DR09_E_RMS90_summary_histogram->SetLineStyle(2);

  TH1F* h_100_CT_wO_DR09_E_RMS_summary_histogram=new TH1F("JER_RMSVsCosTheta_CT_wO_DR09_100", "RMS(E_{j}) / Mean(E_{j}) vs |cos#theta|", nRegionBins, pRegionBinEdges);
  h_100_CT_wO_DR09_E_RMS_summary_histogram ->SetYTitle("RMS(E_{j}) / Mean(E_{j}) [%]");
  h_100_CT_wO_DR09_E_RMS_summary_histogram->SetXTitle("|cos#theta|");
  h_100_CT_wO_DR09_E_RMS_summary_histogram->SetLineWidth(2);
  h_100_CT_wO_DR09_E_RMS_summary_histogram->SetLineColor(kRed);
  h_100_CT_wO_DR09_E_RMS_summary_histogram->SetLineStyle(2);

  TH1F* h_100_CT_wO_DR09_E_JER_Mean_summary_histogram=new TH1F("JER_MeanVsCosTheta_CT_wO_DR09_100", "Mean(E_{tot}^{RECO}/E_{tot}^{true}) vs |cos#theta|", nRegionBins, pRegionBinEdges);
  h_100_CT_wO_DR09_E_JER_Mean_summary_histogram->SetYTitle("Mean(E_{tot}^{RECO}/E_{tot}^{true})");
  h_100_CT_wO_DR09_E_JER_Mean_summary_histogram->SetXTitle("|cos#theta|");
  h_100_CT_wO_DR09_E_JER_Mean_summary_histogram->SetLineWidth(2);
  h_100_CT_wO_DR09_E_JER_Mean_summary_histogram->SetLineColor(kRed);
  h_100_CT_wO_DR09_E_JER_Mean_summary_histogram->SetLineStyle(2);
  firstbin=111;
  for(int i=firstbin;i<(firstbin+13);i++){
    //continue;
    resolutionTH1=0; 
    resolutionErrorTH1=0;
    meanTH1=0;
    meanErrorTH1=0;
    CalculatePerformance( hist_vec_100_CT_wO[i], resolutionTH1, resolutionErrorTH1,meanTH1,meanErrorTH1);
    h_100_CT_wO_DR09_E_RMS90_summary_histogram->SetBinContent(i-firstbin+1,resolutionTH1/sqrt(2.));
    h_100_CT_wO_DR09_E_RMS90_summary_histogram ->SetBinError(i-firstbin+1, resolutionErrorTH1/sqrt(2.));
    h_100_CT_wO_DR09_E_RMS_summary_histogram->SetBinContent(i-firstbin+1,hist_vec_100_CT_wO[i]->GetRMS()*100. );
    h_100_CT_wO_DR09_E_RMS_summary_histogram ->SetBinError(i-firstbin+1, hist_vec_100_CT_wO[i]->GetRMSError()*100.);
    h_100_CT_wO_DR09_E_JER_Mean_summary_histogram->SetBinContent(i-firstbin+1,hist_vec_100_CT_wO[i]->GetMean());
    h_100_CT_wO_DR09_E_JER_Mean_summary_histogram->SetBinError(i-firstbin+1,hist_vec_100_CT_wO[i]->GetMeanError());
    //double sided crystal ball
    TF1* fit_gaus_tmp = new TF1("fit_gaus_tmp", "gaus",0.50,1.50);
    hist_vec_100_CT_wO[i]->Fit("fit_gaus_tmp","R");
    hist_vec_100_CT_wO[i]->GetFunction("fit_gaus_tmp");

    TF1* fdscb_tmp = new TF1("fdscb_tmp",fnc_dscb,0.,3.,7);
   fdscb_tmp->SetNpx(1000);
    fdscb_tmp->SetParameter(0,fit_gaus_tmp->GetParameter(0));
    //norm
    fdscb_tmp->SetParLimits (0,0.5*fit_gaus_tmp->GetParameter(0),1.5*fit_gaus_tmp->GetParameter(0));
    fdscb_tmp->SetParameter(1,fit_gaus_tmp->GetParameter(1));
    //gaussian mean
    fdscb_tmp->SetParLimits (1,0.8,1.2);
    //fdscb_tmp->SetParameter(2,fit_gaus_tmp->GetParameter(2));
    //fdscb_tmp->SetParLimits(2,fit_gaus_tmp->GetParameter(2)*0.50,1.50*fit_gaus_tmp->GetParameter(2));
    std::vector<float>sigma2SFit=sigmaGaussianFits2Sigma(hist_vec_100_CT_wO[i]);
    fdscb_tmp->SetParameter(2,sigma2SFit[0]);
    fdscb_tmp->SetParLimits(2,sigma2SFit[0]*0.50,1.50*sigma2SFit[0]);
    //-a1: parameter, from when the gaussian core should count
    fdscb_tmp->SetParameter(2,fit_gaus_tmp->GetParameter(2));
    fdscb_tmp->SetParameter (3,3.0);
    fdscb_tmp->SetParLimits (3,0.0,10.0);
    //a2 parameter, up to when the gaussian core should count
    fdscb_tmp->SetParameter (5,3.0);
    fdscb_tmp->SetParLimits (5,0.0,10.0);
    fdscb_tmp->SetParameter(4,5.);
    fdscb_tmp->SetParLimits(4,0.,25.);
    fdscb_tmp->SetParameter(6,5.);
    fdscb_tmp->SetParLimits(6,0.,25.);
    int fitstatus(0); 
    fitstatus = hist_vec_100_CT_wO[i]->Fit(fdscb_tmp,"R");
    fdscb_tmp = hist_vec_100_CT_wO[i]->GetFunction("fdscb_tmp");
    h_100_CT_wO_DR09_E_SigmaCB_summary_histogram->SetBinContent(i-firstbin+1,fdscb_tmp->GetParameter(2)*100. );
    h_100_CT_wO_DR09_E_SigmaCB_summary_histogram->SetBinError(i-firstbin+1,fdscb_tmp->GetParError(2)*100. );
  }  
  TH1F* h_100_CT_wO_DR10_E_SigmaCB_summary_histogram=new TH1F("JER_SigmaCBVsCosTheta_CT_wO_DR10_100", "RMS_{90}(E_{j}^{reco}/E_{j}^{gen}) / Mean_{90}(E_{j}^{reco}/E_{j}^{gen}) vs |cos#theta|", nRegionBins, pRegionBinEdges);
  h_100_CT_wO_DR10_E_SigmaCB_summary_histogram ->SetYTitle("#sigma(E_{j}) / E_{j} [%]");
  h_100_CT_wO_DR10_E_SigmaCB_summary_histogram->SetXTitle("|cos#theta|");
  h_100_CT_wO_DR10_E_SigmaCB_summary_histogram->SetLineWidth(2);
  h_100_CT_wO_DR10_E_SigmaCB_summary_histogram->SetLineColor(kCyan+1);
  h_100_CT_wO_DR10_E_SigmaCB_summary_histogram->SetLineStyle(2);
  TH1F* h_100_CT_wO_DR10_E_RMS90_summary_histogram=new TH1F("JER_RMS90VsCosTheta_CT_wO_DR10_100", "RMS_{90}(E_{j}^{reco}/E_{j}^{gen}) / Mean_{90}(E_{j}^{reco}/E_{j}^{gen}) vs |cos#theta|", nRegionBins, pRegionBinEdges);
  h_100_CT_wO_DR10_E_RMS90_summary_histogram ->SetYTitle("RMS_{90}(E_{j}^{reco}/E_{j}^{gen}) / Mean_{90}(E_{j}^{reco}/E_{j}^{gen}) [%]");
  h_100_CT_wO_DR10_E_RMS90_summary_histogram->SetXTitle("|cos#theta|");
  h_100_CT_wO_DR10_E_RMS90_summary_histogram->SetLineWidth(2);
  h_100_CT_wO_DR10_E_RMS90_summary_histogram->SetLineColor(kRed);
  h_100_CT_wO_DR10_E_RMS90_summary_histogram->SetLineStyle(2);

  TH1F* h_100_CT_wO_DR10_E_RMS_summary_histogram=new TH1F("JER_RMSVsCosTheta_CT_wO_DR10_100", "RMS(E_{j}) / Mean(E_{j}) vs |cos#theta|", nRegionBins, pRegionBinEdges);
  h_100_CT_wO_DR10_E_RMS_summary_histogram ->SetYTitle("RMS(E_{j}) / Mean(E_{j}) [%]");
  h_100_CT_wO_DR10_E_RMS_summary_histogram->SetXTitle("|cos#theta|");
  h_100_CT_wO_DR10_E_RMS_summary_histogram->SetLineWidth(2);
  h_100_CT_wO_DR10_E_RMS_summary_histogram->SetLineColor(kRed);
  h_100_CT_wO_DR10_E_RMS_summary_histogram->SetLineStyle(2);

  TH1F* h_100_CT_wO_DR10_E_JER_Mean_summary_histogram=new TH1F("JER_MeanVsCosTheta_CT_wO_DR10_100", "Mean(E_{tot}^{RECO}/E_{tot}^{true}) vs |cos#theta|", nRegionBins, pRegionBinEdges);
  h_100_CT_wO_DR10_E_JER_Mean_summary_histogram->SetYTitle("Mean(E_{tot}^{RECO}/E_{tot}^{true})");
  h_100_CT_wO_DR10_E_JER_Mean_summary_histogram->SetXTitle("|cos#theta|");
  h_100_CT_wO_DR10_E_JER_Mean_summary_histogram->SetLineWidth(2);
  h_100_CT_wO_DR10_E_JER_Mean_summary_histogram->SetLineColor(kRed);
  h_100_CT_wO_DR10_E_JER_Mean_summary_histogram->SetLineStyle(2);
  firstbin=124;
 std::cout<<"start DR10 wO 100"<<std::endl;
  for(int i=firstbin;i<(firstbin+13);i++){
    //continue;
    resolutionTH1=0; 
    resolutionErrorTH1=0;
    meanTH1=0;
    meanErrorTH1=0;
    CalculatePerformance( hist_vec_100_CT_wO[i], resolutionTH1, resolutionErrorTH1,meanTH1,meanErrorTH1);
    h_100_CT_wO_DR10_E_RMS90_summary_histogram->SetBinContent(i-firstbin+1,resolutionTH1/sqrt(2.));
    h_100_CT_wO_DR10_E_RMS90_summary_histogram ->SetBinError(i-firstbin+1, resolutionErrorTH1/sqrt(2.));
    h_100_CT_wO_DR10_E_RMS_summary_histogram->SetBinContent(i-firstbin+1,hist_vec_100_CT_wO[i]->GetRMS()*100. );
    h_100_CT_wO_DR10_E_RMS_summary_histogram ->SetBinError(i-firstbin+1, hist_vec_100_CT_wO[i]->GetRMSError()*100.);
    h_100_CT_wO_DR10_E_JER_Mean_summary_histogram->SetBinContent(i-firstbin+1,hist_vec_100_CT_wO[i]->GetMean());
    h_100_CT_wO_DR10_E_JER_Mean_summary_histogram->SetBinError(i-firstbin+1,hist_vec_100_CT_wO[i]->GetMeanError());
    //double sided crystal ball
    TF1* fit_gaus_tmp = new TF1("fit_gaus_tmp", "gaus",0.50,1.50);
    hist_vec_100_CT_wO[i]->Fit("fit_gaus_tmp","R");
    hist_vec_100_CT_wO[i]->GetFunction("fit_gaus_tmp");

    TF1* fdscb_tmp = new TF1("fdscb_tmp",fnc_dscb,0.,3.,7);
   fdscb_tmp->SetNpx(1000);
    fdscb_tmp->SetParameter(0,fit_gaus_tmp->GetParameter(0));
    //norm
    fdscb_tmp->SetParLimits (0,0.5*fit_gaus_tmp->GetParameter(0),1.5*fit_gaus_tmp->GetParameter(0));
    fdscb_tmp->SetParameter(1,fit_gaus_tmp->GetParameter(1));
    //gaussian mean
    fdscb_tmp->SetParLimits (1,0.8,1.2);
    //fdscb_tmp->SetParameter(2,fit_gaus_tmp->GetParameter(2));
    //fdscb_tmp->SetParLimits(2,fit_gaus_tmp->GetParameter(2)*0.50,1.50*fit_gaus_tmp->GetParameter(2));
    std::vector<float>sigma2SFit=sigmaGaussianFits2Sigma(hist_vec_100_CT_wO[i]);
    fdscb_tmp->SetParameter(2,sigma2SFit[0]);
    fdscb_tmp->SetParLimits(2,sigma2SFit[0]*0.50,1.50*sigma2SFit[0]);
    //-a1: parameter, from when the gaussian core should count
    fdscb_tmp->SetParameter(2,fit_gaus_tmp->GetParameter(2));
    fdscb_tmp->SetParameter (3,3.0);
    fdscb_tmp->SetParLimits (3,0.0,10.0);
    //a2 parameter, up to when the gaussian core should count
    fdscb_tmp->SetParameter (5,3.0);
    fdscb_tmp->SetParLimits (5,0.0,10.0);
    fdscb_tmp->SetParameter(4,5.);
    fdscb_tmp->SetParLimits(4,0.,25.);
    fdscb_tmp->SetParameter(6,5.);
    fdscb_tmp->SetParLimits(6,0.,25.);
    int fitstatus(0); 
    fitstatus = hist_vec_100_CT_wO[i]->Fit(fdscb_tmp,"R");
    fdscb_tmp = hist_vec_100_CT_wO[i]->GetFunction("fdscb_tmp");
    h_100_CT_wO_DR10_E_SigmaCB_summary_histogram->SetBinContent(i-firstbin+1,fdscb_tmp->GetParameter(2)*100. );
    h_100_CT_wO_DR10_E_SigmaCB_summary_histogram->SetBinError(i-firstbin+1,fdscb_tmp->GetParError(2)*100. );
  }  
  std::cout<<"end DR10 wO 100"<<std::endl;
  std::cout<<"100 wO 03/04/05/06 "<< calculate_over90(h_100_CT_wO_recojet03_E1_E2_over_E_True)<<"/"<< calculate_over90(h_100_CT_wO_recojet04_E1_E2_over_E_True)<<"/"<< calculate_over90(h_100_CT_wO_recojet05_E1_E2_over_E_True)<<"/"<<calculate_over90(h_100_CT_wO_recojet06_E1_E2_over_E_True)<<" 07/08/09/10 "<< calculate_over90(h_100_CT_wO_recojet07_E1_E2_over_E_True)<<"/"<< calculate_over90(h_100_CT_wO_recojet08_E1_E2_over_E_True)<<"/"<< calculate_over90(h_100_CT_wO_recojet09_E1_E2_over_E_True)<<"/"<<calculate_over90(h_100_CT_wO_recojet10_E1_E2_over_E_True)<<std::endl;
  std::cout<<"jet histos 100 CT_wO filled"<<std::endl;

  TH1F* h_200_CT_genjet03_dphi_j1j2 =  new TH1F("h_200_CT_genjet03_dphi_j1j2","", n_bins100, 0.5,TMath::Pi());
  TH1F* h_200_CT_genjet03_E1_E2_over_E_True =  new TH1F("h_200_CT_genjet03_E1_E2_over_E_True","", n_bins100, 0.5,1.00);
  TH1F* h_200_CT_genjet03_Delta_E1_E2_over_E12 =  new TH1F("h_200_CT_genjet03_Delta_E1_E2_over_E12","", n_bins100, -0.5,0.5);
  TH1F* h_200_CT_genjet04_dphi_j1j2 =  new TH1F("h_200_CT_genjet04_dphi_j1j2","", n_bins100, 0.5,TMath::Pi());
  TH1F* h_200_CT_genjet04_E1_E2_over_E_True =  new TH1F("h_200_CT_genjet04_E1_E2_over_E_True","", n_bins100, 0.5,1.00);
  TH1F* h_200_CT_genjet04_Delta_E1_E2_over_E12 =  new TH1F("h_200_CT_genjet04_Delta_E1_E2_over_E12","", n_bins100, -0.5,0.5);
  TH1F* h_200_CT_genjet05_dphi_j1j2 =  new TH1F("h_200_CT_genjet05_dphi_j1j2","", n_bins100, 0.5,TMath::Pi());
  TH1F* h_200_CT_genjet05_E1_E2_over_E_True =  new TH1F("h_200_CT_genjet05_E1_E2_over_E_True","", n_bins100, 0.5,1.00);
  TH1F* h_200_CT_genjet05_Delta_E1_E2_over_E12 =  new TH1F("h_200_CT_genjet05_Delta_E1_E2_over_E12","", n_bins100, -0.5,0.5);
  TH1F* h_200_CT_genjet06_dphi_j1j2 =  new TH1F("h_200_CT_genjet06_dphi_j1j2","", n_bins100, 0.5,TMath::Pi());
  TH1F* h_200_CT_genjet06_E1_E2_over_E_True =  new TH1F("h_200_CT_genjet06_E1_E2_over_E_True","", n_bins100, 0.5,1.00);
  TH1F* h_200_CT_genjet06_Delta_E1_E2_over_E12 =  new TH1F("h_200_CT_genjet06_Delta_E1_E2_over_E12","", n_bins100, -0.5,0.5);
  TH1F* h_200_CT_genjet07_dphi_j1j2 =  new TH1F("h_200_CT_genjet07_dphi_j1j2","", n_bins100, 0.5,TMath::Pi());
  TH1F* h_200_CT_genjet07_E1_E2_over_E_True =  new TH1F("h_200_CT_genjet07_E1_E2_over_E_True","", n_bins100, 0.5,1.00);
  TH1F* h_200_CT_genjet07_Delta_E1_E2_over_E12 =  new TH1F("h_200_CT_genjet07_Delta_E1_E2_over_E12","", n_bins100, -0.5,0.5);
  TH1F* h_200_CT_genjet08_dphi_j1j2 =  new TH1F("h_200_CT_genjet08_dphi_j1j2","", n_bins100, 0.5,TMath::Pi());
  TH1F* h_200_CT_genjet08_E1_E2_over_E_True =  new TH1F("h_200_CT_genjet08_E1_E2_over_E_True","", n_bins100, 0.5,1.00);
  TH1F* h_200_CT_genjet08_Delta_E1_E2_over_E12 =  new TH1F("h_200_CT_genjet08_Delta_E1_E2_over_E12","", n_bins100, -0.5,0.5);
  TH1F* h_200_CT_genjet09_dphi_j1j2 =  new TH1F("h_200_CT_genjet09_dphi_j1j2","", n_bins100, 0.5,TMath::Pi());
  TH1F* h_200_CT_genjet09_E1_E2_over_E_True =  new TH1F("h_200_CT_genjet09_E1_E2_over_E_True","", n_bins100, 0.5,1.00);
  TH1F* h_200_CT_genjet09_Delta_E1_E2_over_E12 =  new TH1F("h_200_CT_genjet09_Delta_E1_E2_over_E12","", n_bins100, -0.5,0.5);
  TH1F* h_200_CT_genjet10_dphi_j1j2 =  new TH1F("h_200_CT_genjet10_dphi_j1j2","", n_bins100, 0.5,TMath::Pi());
  TH1F* h_200_CT_genjet10_E1_E2_over_E_True =  new TH1F("h_200_CT_genjet10_E1_E2_over_E_True","", n_bins100, 0.5,1.00);
  TH1F* h_200_CT_genjet10_Delta_E1_E2_over_E12 =  new TH1F("h_200_CT_genjet10_Delta_E1_E2_over_E12","", n_bins100, -0.5,0.5);

  TH1F* h_200_CT_recojet03_dphi_j1j2 =  new TH1F("h_200_CT_recojet03_dphi_j1j2","", n_bins100, 0.5,TMath::Pi());
  TH1F* h_200_CT_recojet03_E1_E2_over_E_True =  new TH1F("h_200_CT_recojet03_E1_E2_over_E_True","", n_bins100, 0.5,1.00);
  TH1F* h_200_CT_recojet03_Delta_E1_E2_over_E12 =  new TH1F("h_200_CT_recojet03_Delta_E1_E2_over_E12","", n_bins100, -0.5,0.5);
  TH1F* h_200_CT_recojet04_dphi_j1j2 =  new TH1F("h_200_CT_recojet04_dphi_j1j2","", n_bins100, 0.5,TMath::Pi());
  TH1F* h_200_CT_recojet04_E1_E2_over_E_True =  new TH1F("h_200_CT_recojet04_E1_E2_over_E_True","", n_bins100, 0.5,1.00);
  TH1F* h_200_CT_recojet04_Delta_E1_E2_over_E12 =  new TH1F("h_200_CT_recojet04_Delta_E1_E2_over_E12","", n_bins100, -0.5,0.5);
  TH1F* h_200_CT_recojet05_dphi_j1j2 =  new TH1F("h_200_CT_recojet05_dphi_j1j2","", n_bins100, 0.5,TMath::Pi());
  TH1F* h_200_CT_recojet05_E1_E2_over_E_True =  new TH1F("h_200_CT_recojet05_E1_E2_over_E_True","", n_bins100, 0.5,1.00);
  TH1F* h_200_CT_recojet05_Delta_E1_E2_over_E12 =  new TH1F("h_200_CT_recojet05_Delta_E1_E2_over_E12","", n_bins100, -0.5,0.5);
  TH1F* h_200_CT_recojet06_dphi_j1j2 =  new TH1F("h_200_CT_recojet06_dphi_j1j2","", n_bins100, 0.5,TMath::Pi());
  TH1F* h_200_CT_recojet06_E1_E2_over_E_True =  new TH1F("h_200_CT_recojet06_E1_E2_over_E_True","", n_bins100, 0.5,1.00);
  TH1F* h_200_CT_recojet06_Delta_E1_E2_over_E12 =  new TH1F("h_200_CT_recojet06_Delta_E1_E2_over_E12","", n_bins100, -0.5,0.5);
  TH1F* h_200_CT_recojet07_dphi_j1j2 =  new TH1F("h_200_CT_recojet07_dphi_j1j2","", n_bins100, 0.5,TMath::Pi());
  TH1F* h_200_CT_recojet07_E1_E2_over_E_True =  new TH1F("h_200_CT_recojet07_E1_E2_over_E_True","", n_bins100, 0.5,1.00);
  TH1F* h_200_CT_recojet07_Delta_E1_E2_over_E12 =  new TH1F("h_200_CT_recojet07_Delta_E1_E2_over_E12","", n_bins100, -0.5,0.5);
  TH1F* h_200_CT_recojet08_dphi_j1j2 =  new TH1F("h_200_CT_recojet08_dphi_j1j2","", n_bins100, 0.5,TMath::Pi());
  TH1F* h_200_CT_recojet08_E1_E2_over_E_True =  new TH1F("h_200_CT_recojet08_E1_E2_over_E_True","", n_bins100, 0.5,1.00);
  TH1F* h_200_CT_recojet08_Delta_E1_E2_over_E12 =  new TH1F("h_200_CT_recojet08_Delta_E1_E2_over_E12","", n_bins100, -0.5,0.5);
  TH1F* h_200_CT_recojet09_dphi_j1j2 =  new TH1F("h_200_CT_recojet09_dphi_j1j2","", n_bins100, 0.5,TMath::Pi());
  TH1F* h_200_CT_recojet09_E1_E2_over_E_True =  new TH1F("h_200_CT_recojet09_E1_E2_over_E_True","", n_bins100, 0.5,1.00);
  TH1F* h_200_CT_recojet09_Delta_E1_E2_over_E12 =  new TH1F("h_200_CT_recojet09_Delta_E1_E2_over_E12","", n_bins100, -0.5,0.5);
  TH1F* h_200_CT_recojet10_dphi_j1j2 =  new TH1F("h_200_CT_recojet10_dphi_j1j2","", n_bins100, 0.5,TMath::Pi());
  TH1F* h_200_CT_recojet10_E1_E2_over_E_True =  new TH1F("h_200_CT_recojet10_E1_E2_over_E_True","", n_bins100, 0.5,1.00);
  TH1F* h_200_CT_recojet10_Delta_E1_E2_over_E12 =  new TH1F("h_200_CT_recojet10_Delta_E1_E2_over_E12","", n_bins100, -0.5,0.5);

  TH1F* h_200_CT_recojetE_over_genjetE_DR03 =  new TH1F("h_200_CT_recojetE_over_genjetE_DR03","", n_bins100, 0.5,1.5);
  TH1F* h_200_CT_recojetE_over_genjetE_DR04 =  new TH1F("h_200_CT_recojetE_over_genjetE_DR04","", n_bins100, 0.5,1.5);
  TH1F* h_200_CT_recojetE_over_genjetE_DR05 =  new TH1F("h_200_CT_recojetE_over_genjetE_DR05","", n_bins100, 0.5,1.5);
  TH1F* h_200_CT_recojetE_over_genjetE_DR06 =  new TH1F("h_200_CT_recojetE_over_genjetE_DR06","", n_bins100, 0.5,1.5);
  TH1F* h_200_CT_recojetE_over_genjetE_DR07 =  new TH1F("h_200_CT_recojetE_over_genjetE_DR07","", n_bins100, 0.5,1.5);
  TH1F* h_200_CT_recojetE_over_genjetE_DR08 =  new TH1F("h_200_CT_recojetE_over_genjetE_DR08","", n_bins100, 0.5,1.5);
  TH1F* h_200_CT_recojetE_over_genjetE_DR09 =  new TH1F("h_200_CT_recojetE_over_genjetE_DR09","", n_bins100, 0.5,1.5);
  TH1F* h_200_CT_recojetE_over_genjetE_DR10 =  new TH1F("h_200_CT_recojetE_over_genjetE_DR10","", n_bins100, 0.5,1.5);

  TH1F* h_200_CT_dphi_gen_reco_DR05 =  new TH1F("h_200_CT_dphi_gen_reco_DR05","", n_bins100, -0.1,9.9);
  TH1F* h_200_CT_dphi_gen_reco_DR06 =  new TH1F("h_200_CT_dphi_gen_reco_DR06","", n_bins100, -0.1,9.9);
  TH1F* h_200_CT_dphi_gen_reco_DR07 =  new TH1F("h_200_CT_dphi_gen_reco_DR07","", n_bins100, -0.1,9.9);

  TH1F* h_200_CT_DR05_E_rel_totVis_RMS_d1_cosT_0_to_0_10 =  new TH1F("h_200_CT_DR05_E_rel_totVis_RMS_d1_cosT_0_to_0_10","", n_binsJER, lim_E_rel_low,lim_E_rel_high);
  TH1F* h_200_CT_DR05_E_rel_totVis_RMS_d1_cosT_0_10_to_0_20 =  new TH1F("h_200_CT_DR05_E_rel_totVis_RMS_d1_cosT_0_10_to_0_20","", n_binsJER, lim_E_rel_low,lim_E_rel_high);
  TH1F* h_200_CT_DR05_E_rel_totVis_RMS_d1_cosT_0_20_to_0_30 =  new TH1F("h_200_CT_DR05_E_rel_totVis_RMS_d1_cosT_0_20_to_0_30","", n_binsJER, lim_E_rel_low,lim_E_rel_high);
  TH1F* h_200_CT_DR05_E_rel_totVis_RMS_d1_cosT_0_30_to_0_40 =  new TH1F("h_200_CT_DR05_E_rel_totVis_RMS_d1_cosT_0_30_to_0_40","", n_binsJER, lim_E_rel_low,lim_E_rel_high);
  TH1F* h_200_CT_DR05_E_rel_totVis_RMS_d1_cosT_0_40_to_0_50 =  new TH1F("h_200_CT_DR05_E_rel_totVis_RMS_d1_cosT_0_40_to_0_50","", n_binsJER, lim_E_rel_low,lim_E_rel_high);
  TH1F* h_200_CT_DR05_E_rel_totVis_RMS_d1_cosT_0_50_to_0_60 =  new TH1F("h_200_CT_DR05_E_rel_totVis_RMS_d1_cosT_0_50_to_0_60","", n_binsJER, lim_E_rel_low,lim_E_rel_high);
  TH1F* h_200_CT_DR05_E_rel_totVis_RMS_d1_cosT_0_60_to_0_70 =  new TH1F("h_200_CT_DR05_E_rel_totVis_RMS_d1_cosT_0_60_to_0_70","", n_binsJER, lim_E_rel_low,lim_E_rel_high);
  TH1F* h_200_CT_DR05_E_rel_totVis_RMS_d1_cosT_0_70_to_0_80 =  new TH1F("h_200_CT_DR05_E_rel_totVis_RMS_d1_cosT_0_70_to_0_80","", n_binsJER, lim_E_rel_low,lim_E_rel_high);
  TH1F* h_200_CT_DR05_E_rel_totVis_RMS_d1_cosT_0_80_to_0_90 =  new TH1F("h_200_CT_DR05_E_rel_totVis_RMS_d1_cosT_0_80_to_0_90","", n_binsJER, lim_E_rel_low,lim_E_rel_high);
  TH1F* h_200_CT_DR05_E_rel_totVis_RMS_d1_cosT_0_900_to_0_925 =  new TH1F("h_200_CT_DR05_E_rel_totVis_RMS_d1_cosT_0_900_to_0_925","", n_binsJER_FW, lim_E_rel_low,lim_E_rel_high);
  TH1F* h_200_CT_DR05_E_rel_totVis_RMS_d1_cosT_0_925_to_0_950 =  new TH1F("h_200_CT_DR05_E_rel_totVis_RMS_d1_cosT_0_925_to_0_950","", n_binsJER_FW, lim_E_rel_low,lim_E_rel_high);
  TH1F* h_200_CT_DR05_E_rel_totVis_RMS_d1_cosT_0_950_to_0_975 =  new TH1F("h_200_CT_DR05_E_rel_totVis_RMS_d1_cosT_0_950_to_0_975","", n_binsJER_FW, lim_E_rel_low,lim_E_rel_high);
  TH1F* h_200_CT_DR05_E_rel_totVis_RMS_d1_cosT_0_975_to_1_00 =  new TH1F("h_200_CT_DR05_E_rel_totVis_RMS_d1_cosT_0_975_to_1_00","", n_binsJER_FW, lim_E_rel_low,lim_E_rel_high);

  TH1F* h_200_CT_DR06_E_rel_totVis_RMS_d1_cosT_0_to_0_10 =  new TH1F("h_200_CT_DR06_E_rel_totVis_RMS_d1_cosT_0_to_0_10","", n_binsJER, lim_E_rel_low,lim_E_rel_high);
  TH1F* h_200_CT_DR06_E_rel_totVis_RMS_d1_cosT_0_10_to_0_20 =  new TH1F("h_200_CT_DR06_E_rel_totVis_RMS_d1_cosT_0_10_to_0_20","", n_binsJER, lim_E_rel_low,lim_E_rel_high);
  TH1F* h_200_CT_DR06_E_rel_totVis_RMS_d1_cosT_0_20_to_0_30 =  new TH1F("h_200_CT_DR06_E_rel_totVis_RMS_d1_cosT_0_20_to_0_30","", n_binsJER, lim_E_rel_low,lim_E_rel_high);
  TH1F* h_200_CT_DR06_E_rel_totVis_RMS_d1_cosT_0_30_to_0_40 =  new TH1F("h_200_CT_DR06_E_rel_totVis_RMS_d1_cosT_0_30_to_0_40","", n_binsJER, lim_E_rel_low,lim_E_rel_high);
  TH1F* h_200_CT_DR06_E_rel_totVis_RMS_d1_cosT_0_40_to_0_50 =  new TH1F("h_200_CT_DR06_E_rel_totVis_RMS_d1_cosT_0_40_to_0_50","", n_binsJER, lim_E_rel_low,lim_E_rel_high);
  TH1F* h_200_CT_DR06_E_rel_totVis_RMS_d1_cosT_0_50_to_0_60 =  new TH1F("h_200_CT_DR06_E_rel_totVis_RMS_d1_cosT_0_50_to_0_60","", n_binsJER, lim_E_rel_low,lim_E_rel_high);
  TH1F* h_200_CT_DR06_E_rel_totVis_RMS_d1_cosT_0_60_to_0_70 =  new TH1F("h_200_CT_DR06_E_rel_totVis_RMS_d1_cosT_0_60_to_0_70","", n_binsJER, lim_E_rel_low,lim_E_rel_high);
  TH1F* h_200_CT_DR06_E_rel_totVis_RMS_d1_cosT_0_70_to_0_80 =  new TH1F("h_200_CT_DR06_E_rel_totVis_RMS_d1_cosT_0_70_to_0_80","", n_binsJER, lim_E_rel_low,lim_E_rel_high);
  TH1F* h_200_CT_DR06_E_rel_totVis_RMS_d1_cosT_0_80_to_0_90 =  new TH1F("h_200_CT_DR06_E_rel_totVis_RMS_d1_cosT_0_80_to_0_90","", n_binsJER, lim_E_rel_low,lim_E_rel_high);
  TH1F* h_200_CT_DR06_E_rel_totVis_RMS_d1_cosT_0_900_to_0_925 =  new TH1F("h_200_CT_DR06_E_rel_totVis_RMS_d1_cosT_0_900_to_0_925","", n_binsJER_FW, lim_E_rel_low,lim_E_rel_high);
  TH1F* h_200_CT_DR06_E_rel_totVis_RMS_d1_cosT_0_925_to_0_950 =  new TH1F("h_200_CT_DR06_E_rel_totVis_RMS_d1_cosT_0_925_to_0_950","", n_binsJER_FW, lim_E_rel_low,lim_E_rel_high);
  TH1F* h_200_CT_DR06_E_rel_totVis_RMS_d1_cosT_0_950_to_0_975 =  new TH1F("h_200_CT_DR06_E_rel_totVis_RMS_d1_cosT_0_950_to_0_975","", n_binsJER_FW, lim_E_rel_low,lim_E_rel_high);
  TH1F* h_200_CT_DR06_E_rel_totVis_RMS_d1_cosT_0_975_to_1_00 =  new TH1F("h_200_CT_DR06_E_rel_totVis_RMS_d1_cosT_0_975_to_1_00","", n_binsJER_FW, lim_E_rel_low,lim_E_rel_high);

  TH1F* h_200_CT_DR07_E_rel_totVis_RMS_d1_cosT_0_to_0_10 =  new TH1F("h_200_CT_DR07_E_rel_totVis_RMS_d1_cosT_0_to_0_10","", n_binsJER, lim_E_rel_low,lim_E_rel_high);
  TH1F* h_200_CT_DR07_E_rel_totVis_RMS_d1_cosT_0_10_to_0_20 =  new TH1F("h_200_CT_DR07_E_rel_totVis_RMS_d1_cosT_0_10_to_0_20","", n_binsJER, lim_E_rel_low,lim_E_rel_high);
  TH1F* h_200_CT_DR07_E_rel_totVis_RMS_d1_cosT_0_20_to_0_30 =  new TH1F("h_200_CT_DR07_E_rel_totVis_RMS_d1_cosT_0_20_to_0_30","", n_binsJER, lim_E_rel_low,lim_E_rel_high);
  TH1F* h_200_CT_DR07_E_rel_totVis_RMS_d1_cosT_0_30_to_0_40 =  new TH1F("h_200_CT_DR07_E_rel_totVis_RMS_d1_cosT_0_30_to_0_40","", n_binsJER, lim_E_rel_low,lim_E_rel_high);
  TH1F* h_200_CT_DR07_E_rel_totVis_RMS_d1_cosT_0_40_to_0_50 =  new TH1F("h_200_CT_DR07_E_rel_totVis_RMS_d1_cosT_0_40_to_0_50","", n_binsJER, lim_E_rel_low,lim_E_rel_high);
  TH1F* h_200_CT_DR07_E_rel_totVis_RMS_d1_cosT_0_50_to_0_60 =  new TH1F("h_200_CT_DR07_E_rel_totVis_RMS_d1_cosT_0_50_to_0_60","", n_binsJER, lim_E_rel_low,lim_E_rel_high);
  TH1F* h_200_CT_DR07_E_rel_totVis_RMS_d1_cosT_0_60_to_0_70 =  new TH1F("h_200_CT_DR07_E_rel_totVis_RMS_d1_cosT_0_60_to_0_70","", n_binsJER, lim_E_rel_low,lim_E_rel_high);
  TH1F* h_200_CT_DR07_E_rel_totVis_RMS_d1_cosT_0_70_to_0_80 =  new TH1F("h_200_CT_DR07_E_rel_totVis_RMS_d1_cosT_0_70_to_0_80","", n_binsJER, lim_E_rel_low,lim_E_rel_high);
  TH1F* h_200_CT_DR07_E_rel_totVis_RMS_d1_cosT_0_80_to_0_90 =  new TH1F("h_200_CT_DR07_E_rel_totVis_RMS_d1_cosT_0_80_to_0_90","", n_binsJER, lim_E_rel_low,lim_E_rel_high);
  TH1F* h_200_CT_DR07_E_rel_totVis_RMS_d1_cosT_0_900_to_0_925 =  new TH1F("h_200_CT_DR07_E_rel_totVis_RMS_d1_cosT_0_900_to_0_925","", n_binsJER_FW, lim_E_rel_low,lim_E_rel_high);
  TH1F* h_200_CT_DR07_E_rel_totVis_RMS_d1_cosT_0_925_to_0_950 =  new TH1F("h_200_CT_DR07_E_rel_totVis_RMS_d1_cosT_0_925_to_0_950","", n_binsJER_FW, lim_E_rel_low,lim_E_rel_high);
  TH1F* h_200_CT_DR07_E_rel_totVis_RMS_d1_cosT_0_950_to_0_975 =  new TH1F("h_200_CT_DR07_E_rel_totVis_RMS_d1_cosT_0_950_to_0_975","", n_binsJER_FW, lim_E_rel_low,lim_E_rel_high);
  TH1F* h_200_CT_DR07_E_rel_totVis_RMS_d1_cosT_0_975_to_1_00 =  new TH1F("h_200_CT_DR07_E_rel_totVis_RMS_d1_cosT_0_975_to_1_00","", n_binsJER_FW, lim_E_rel_low,lim_E_rel_high);

  TH1F* h_200_CT_DR08_E_rel_totVis_RMS_d1_cosT_0_to_0_10 =  new TH1F("h_200_CT_DR08_E_rel_totVis_RMS_d1_cosT_0_to_0_10","", n_binsJER, lim_E_rel_low,lim_E_rel_high);
  TH1F* h_200_CT_DR08_E_rel_totVis_RMS_d1_cosT_0_10_to_0_20 =  new TH1F("h_200_CT_DR08_E_rel_totVis_RMS_d1_cosT_0_10_to_0_20","", n_binsJER, lim_E_rel_low,lim_E_rel_high);
  TH1F* h_200_CT_DR08_E_rel_totVis_RMS_d1_cosT_0_20_to_0_30 =  new TH1F("h_200_CT_DR08_E_rel_totVis_RMS_d1_cosT_0_20_to_0_30","", n_binsJER, lim_E_rel_low,lim_E_rel_high);
  TH1F* h_200_CT_DR08_E_rel_totVis_RMS_d1_cosT_0_30_to_0_40 =  new TH1F("h_200_CT_DR08_E_rel_totVis_RMS_d1_cosT_0_30_to_0_40","", n_binsJER, lim_E_rel_low,lim_E_rel_high);
  TH1F* h_200_CT_DR08_E_rel_totVis_RMS_d1_cosT_0_40_to_0_50 =  new TH1F("h_200_CT_DR08_E_rel_totVis_RMS_d1_cosT_0_40_to_0_50","", n_binsJER, lim_E_rel_low,lim_E_rel_high);
  TH1F* h_200_CT_DR08_E_rel_totVis_RMS_d1_cosT_0_50_to_0_60 =  new TH1F("h_200_CT_DR08_E_rel_totVis_RMS_d1_cosT_0_50_to_0_60","", n_binsJER, lim_E_rel_low,lim_E_rel_high);
  TH1F* h_200_CT_DR08_E_rel_totVis_RMS_d1_cosT_0_60_to_0_70 =  new TH1F("h_200_CT_DR08_E_rel_totVis_RMS_d1_cosT_0_60_to_0_70","", n_binsJER, lim_E_rel_low,lim_E_rel_high);
  TH1F* h_200_CT_DR08_E_rel_totVis_RMS_d1_cosT_0_70_to_0_80 =  new TH1F("h_200_CT_DR08_E_rel_totVis_RMS_d1_cosT_0_70_to_0_80","", n_binsJER, lim_E_rel_low,lim_E_rel_high);
  TH1F* h_200_CT_DR08_E_rel_totVis_RMS_d1_cosT_0_80_to_0_90 =  new TH1F("h_200_CT_DR08_E_rel_totVis_RMS_d1_cosT_0_80_to_0_90","", n_binsJER, lim_E_rel_low,lim_E_rel_high);
  TH1F* h_200_CT_DR08_E_rel_totVis_RMS_d1_cosT_0_900_to_0_925 =  new TH1F("h_200_CT_DR08_E_rel_totVis_RMS_d1_cosT_0_900_to_0_925","", n_binsJER_FW, lim_E_rel_low,lim_E_rel_high);
  TH1F* h_200_CT_DR08_E_rel_totVis_RMS_d1_cosT_0_925_to_0_950 =  new TH1F("h_200_CT_DR08_E_rel_totVis_RMS_d1_cosT_0_925_to_0_950","", n_binsJER_FW, lim_E_rel_low,lim_E_rel_high);
  TH1F* h_200_CT_DR08_E_rel_totVis_RMS_d1_cosT_0_950_to_0_975 =  new TH1F("h_200_CT_DR08_E_rel_totVis_RMS_d1_cosT_0_950_to_0_975","", n_binsJER_FW, lim_E_rel_low,lim_E_rel_high);
  TH1F* h_200_CT_DR08_E_rel_totVis_RMS_d1_cosT_0_975_to_1_00 =  new TH1F("h_200_CT_DR08_E_rel_totVis_RMS_d1_cosT_0_975_to_1_00","", n_binsJER_FW, lim_E_rel_low,lim_E_rel_high);

  TH1F* h_200_CT_DR09_E_rel_totVis_RMS_d1_cosT_0_to_0_10 =  new TH1F("h_200_CT_DR09_E_rel_totVis_RMS_d1_cosT_0_to_0_10","", n_binsJER, lim_E_rel_low,lim_E_rel_high);
  TH1F* h_200_CT_DR09_E_rel_totVis_RMS_d1_cosT_0_10_to_0_20 =  new TH1F("h_200_CT_DR09_E_rel_totVis_RMS_d1_cosT_0_10_to_0_20","", n_binsJER, lim_E_rel_low,lim_E_rel_high);
  TH1F* h_200_CT_DR09_E_rel_totVis_RMS_d1_cosT_0_20_to_0_30 =  new TH1F("h_200_CT_DR09_E_rel_totVis_RMS_d1_cosT_0_20_to_0_30","", n_binsJER, lim_E_rel_low,lim_E_rel_high);
  TH1F* h_200_CT_DR09_E_rel_totVis_RMS_d1_cosT_0_30_to_0_40 =  new TH1F("h_200_CT_DR09_E_rel_totVis_RMS_d1_cosT_0_30_to_0_40","", n_binsJER, lim_E_rel_low,lim_E_rel_high);
  TH1F* h_200_CT_DR09_E_rel_totVis_RMS_d1_cosT_0_40_to_0_50 =  new TH1F("h_200_CT_DR09_E_rel_totVis_RMS_d1_cosT_0_40_to_0_50","", n_binsJER, lim_E_rel_low,lim_E_rel_high);
  TH1F* h_200_CT_DR09_E_rel_totVis_RMS_d1_cosT_0_50_to_0_60 =  new TH1F("h_200_CT_DR09_E_rel_totVis_RMS_d1_cosT_0_50_to_0_60","", n_binsJER, lim_E_rel_low,lim_E_rel_high);
  TH1F* h_200_CT_DR09_E_rel_totVis_RMS_d1_cosT_0_60_to_0_70 =  new TH1F("h_200_CT_DR09_E_rel_totVis_RMS_d1_cosT_0_60_to_0_70","", n_binsJER, lim_E_rel_low,lim_E_rel_high);
  TH1F* h_200_CT_DR09_E_rel_totVis_RMS_d1_cosT_0_70_to_0_80 =  new TH1F("h_200_CT_DR09_E_rel_totVis_RMS_d1_cosT_0_70_to_0_80","", n_binsJER, lim_E_rel_low,lim_E_rel_high);
  TH1F* h_200_CT_DR09_E_rel_totVis_RMS_d1_cosT_0_80_to_0_90 =  new TH1F("h_200_CT_DR09_E_rel_totVis_RMS_d1_cosT_0_80_to_0_90","", n_binsJER, lim_E_rel_low,lim_E_rel_high);
  TH1F* h_200_CT_DR09_E_rel_totVis_RMS_d1_cosT_0_900_to_0_925 =  new TH1F("h_200_CT_DR09_E_rel_totVis_RMS_d1_cosT_0_900_to_0_925","", n_binsJER_FW, lim_E_rel_low,lim_E_rel_high);
  TH1F* h_200_CT_DR09_E_rel_totVis_RMS_d1_cosT_0_925_to_0_950 =  new TH1F("h_200_CT_DR09_E_rel_totVis_RMS_d1_cosT_0_925_to_0_950","", n_binsJER_FW, lim_E_rel_low,lim_E_rel_high);
  TH1F* h_200_CT_DR09_E_rel_totVis_RMS_d1_cosT_0_950_to_0_975 =  new TH1F("h_200_CT_DR09_E_rel_totVis_RMS_d1_cosT_0_950_to_0_975","", n_binsJER_FW, lim_E_rel_low,lim_E_rel_high);
  TH1F* h_200_CT_DR09_E_rel_totVis_RMS_d1_cosT_0_975_to_1_00 =  new TH1F("h_200_CT_DR09_E_rel_totVis_RMS_d1_cosT_0_975_to_1_00","", n_binsJER_FW, lim_E_rel_low,lim_E_rel_high);

  TH1F* h_200_CT_DR10_E_rel_totVis_RMS_d1_cosT_0_to_0_10 =  new TH1F("h_200_CT_DR10_E_rel_totVis_RMS_d1_cosT_0_to_0_10","", n_binsJER, lim_E_rel_low,lim_E_rel_high);
  TH1F* h_200_CT_DR10_E_rel_totVis_RMS_d1_cosT_0_10_to_0_20 =  new TH1F("h_200_CT_DR10_E_rel_totVis_RMS_d1_cosT_0_10_to_0_20","", n_binsJER, lim_E_rel_low,lim_E_rel_high);
  TH1F* h_200_CT_DR10_E_rel_totVis_RMS_d1_cosT_0_20_to_0_30 =  new TH1F("h_200_CT_DR10_E_rel_totVis_RMS_d1_cosT_0_20_to_0_30","", n_binsJER, lim_E_rel_low,lim_E_rel_high);
  TH1F* h_200_CT_DR10_E_rel_totVis_RMS_d1_cosT_0_30_to_0_40 =  new TH1F("h_200_CT_DR10_E_rel_totVis_RMS_d1_cosT_0_30_to_0_40","", n_binsJER, lim_E_rel_low,lim_E_rel_high);
  TH1F* h_200_CT_DR10_E_rel_totVis_RMS_d1_cosT_0_40_to_0_50 =  new TH1F("h_200_CT_DR10_E_rel_totVis_RMS_d1_cosT_0_40_to_0_50","", n_binsJER, lim_E_rel_low,lim_E_rel_high);
  TH1F* h_200_CT_DR10_E_rel_totVis_RMS_d1_cosT_0_50_to_0_60 =  new TH1F("h_200_CT_DR10_E_rel_totVis_RMS_d1_cosT_0_50_to_0_60","", n_binsJER, lim_E_rel_low,lim_E_rel_high);
  TH1F* h_200_CT_DR10_E_rel_totVis_RMS_d1_cosT_0_60_to_0_70 =  new TH1F("h_200_CT_DR10_E_rel_totVis_RMS_d1_cosT_0_60_to_0_70","", n_binsJER, lim_E_rel_low,lim_E_rel_high);
  TH1F* h_200_CT_DR10_E_rel_totVis_RMS_d1_cosT_0_70_to_0_80 =  new TH1F("h_200_CT_DR10_E_rel_totVis_RMS_d1_cosT_0_70_to_0_80","", n_binsJER, lim_E_rel_low,lim_E_rel_high);
  TH1F* h_200_CT_DR10_E_rel_totVis_RMS_d1_cosT_0_80_to_0_90 =  new TH1F("h_200_CT_DR10_E_rel_totVis_RMS_d1_cosT_0_80_to_0_90","", n_binsJER, lim_E_rel_low,lim_E_rel_high);
  TH1F* h_200_CT_DR10_E_rel_totVis_RMS_d1_cosT_0_900_to_0_925 =  new TH1F("h_200_CT_DR10_E_rel_totVis_RMS_d1_cosT_0_900_to_0_925","", n_binsJER_FW, lim_E_rel_low,lim_E_rel_high);
  TH1F* h_200_CT_DR10_E_rel_totVis_RMS_d1_cosT_0_925_to_0_950 =  new TH1F("h_200_CT_DR10_E_rel_totVis_RMS_d1_cosT_0_925_to_0_950","", n_binsJER_FW, lim_E_rel_low,lim_E_rel_high);
  TH1F* h_200_CT_DR10_E_rel_totVis_RMS_d1_cosT_0_950_to_0_975 =  new TH1F("h_200_CT_DR10_E_rel_totVis_RMS_d1_cosT_0_950_to_0_975","", n_binsJER_FW, lim_E_rel_low,lim_E_rel_high);
  TH1F* h_200_CT_DR10_E_rel_totVis_RMS_d1_cosT_0_975_to_1_00 =  new TH1F("h_200_CT_DR10_E_rel_totVis_RMS_d1_cosT_0_975_to_1_00","", n_binsJER_FW, lim_E_rel_low,lim_E_rel_high);

  TH1F* h_200_CT_DR05_dphi_reco_gen_cosTheta_0_65 =  new TH1F("h_200_CT_DR05_dphi_reco_gen_cosTheta_0_65","", n_bins100, -lim_angleDeg,lim_angleDeg);
  TH1F* h_200_CT_DR05_dtheta_reco_gen_cosTheta_0_65 =  new TH1F("h_200_CT_DR05_dtheta_reco_gen_cosTheta_0_65","", n_bins100, -lim_angleDeg,lim_angleDeg);
  TH1F* h_200_CT_DR05_dphi_reco_gen_cosTheta_0_65_to_0_80 =  new TH1F("h_200_CT_DR05_dphi_reco_gen_cosTheta_0_65_to_0_80","", n_bins100, -lim_angleDeg,lim_angleDeg);
  TH1F* h_200_CT_DR05_dtheta_reco_gen_cosTheta_0_65_to_0_80 =  new TH1F("h_200_CT_DR05_dtheta_reco_gen_cosTheta_0_65_to_0_80","", n_bins100, -lim_angleDeg,lim_angleDeg);
  TH1F* h_200_CT_DR05_dphi_reco_gen_cosTheta_0_80_to_0_925 =  new TH1F("h_200_CT_DR05_dphi_reco_gen_cosTheta_0_80_to_0_925","", n_bins100, -lim_angleDeg,lim_angleDeg);
  TH1F* h_200_CT_DR05_dtheta_reco_gen_cosTheta_0_80_to_0_925 =  new TH1F("h_200_CT_DR05_dtheta_reco_gen_cosTheta_0_80_to_0_925","", n_bins100, -lim_angleDeg,lim_angleDeg);
  TH1F* h_200_CT_DR05_dphi_reco_gen_cosTheta_0_925_to_0_975 =  new TH1F("h_200_CT_DR05_dphi_reco_gen_cosTheta_0_925_to_0_975","", n_bins100, -lim_angleDeg,lim_angleDeg);
  TH1F* h_200_CT_DR05_dtheta_reco_gen_cosTheta_0_925_to_0_975 =  new TH1F("h_200_CT_DR05_dtheta_reco_gen_cosTheta_0_925_to_0_975","", n_bins100, -lim_angleDeg,lim_angleDeg);

  TH1F* h_200_CT_DR07_dphi_reco_gen_cosTheta_0_65 =  new TH1F("h_200_CT_DR07_dphi_reco_gen_cosTheta_0_65","", n_bins100, -lim_angleDeg,lim_angleDeg);
  TH1F* h_200_CT_DR07_dtheta_reco_gen_cosTheta_0_65 =  new TH1F("h_200_CT_DR07_dtheta_reco_gen_cosTheta_0_65","", n_bins100, -lim_angleDeg,lim_angleDeg);
  TH1F* h_200_CT_DR07_dphi_reco_gen_cosTheta_0_65_to_0_80 =  new TH1F("h_200_CT_DR07_dphi_reco_gen_cosTheta_0_65_to_0_80","", n_bins100, -lim_angleDeg,lim_angleDeg);
  TH1F* h_200_CT_DR07_dtheta_reco_gen_cosTheta_0_65_to_0_80 =  new TH1F("h_200_CT_DR07_dtheta_reco_gen_cosTheta_0_65_to_0_80","", n_bins100, -lim_angleDeg,lim_angleDeg);
  TH1F* h_200_CT_DR07_dphi_reco_gen_cosTheta_0_80_to_0_925 =  new TH1F("h_200_CT_DR07_dphi_reco_gen_cosTheta_0_80_to_0_925","", n_bins100, -lim_angleDeg,lim_angleDeg);
  TH1F* h_200_CT_DR07_dtheta_reco_gen_cosTheta_0_80_to_0_925 =  new TH1F("h_200_CT_DR07_dtheta_reco_gen_cosTheta_0_80_to_0_925","", n_bins100, -lim_angleDeg,lim_angleDeg);
  TH1F* h_200_CT_DR07_dphi_reco_gen_cosTheta_0_925_to_0_975 =  new TH1F("h_200_CT_DR07_dphi_reco_gen_cosTheta_0_925_to_0_975","", n_bins100, -lim_angleDeg,lim_angleDeg);
  TH1F* h_200_CT_DR07_dtheta_reco_gen_cosTheta_0_925_to_0_975 =  new TH1F("h_200_CT_DR07_dtheta_reco_gen_cosTheta_0_925_to_0_975","", n_bins100, -lim_angleDeg,lim_angleDeg);

  TH1F* h_200_CT_DR10_dphi_reco_gen_cosTheta_0_65 =  new TH1F("h_200_CT_DR10_dphi_reco_gen_cosTheta_0_65","", n_bins100, -lim_angleDeg,lim_angleDeg);
  TH1F* h_200_CT_DR10_dtheta_reco_gen_cosTheta_0_65 =  new TH1F("h_200_CT_DR10_dtheta_reco_gen_cosTheta_0_65","", n_bins100, -lim_angleDeg,lim_angleDeg);
  TH1F* h_200_CT_DR10_dphi_reco_gen_cosTheta_0_65_to_0_80 =  new TH1F("h_200_CT_DR10_dphi_reco_gen_cosTheta_0_65_to_0_80","", n_bins100, -lim_angleDeg,lim_angleDeg);
  TH1F* h_200_CT_DR10_dtheta_reco_gen_cosTheta_0_65_to_0_80 =  new TH1F("h_200_CT_DR10_dtheta_reco_gen_cosTheta_0_65_to_0_80","", n_bins100, -lim_angleDeg,lim_angleDeg);
  TH1F* h_200_CT_DR10_dphi_reco_gen_cosTheta_0_80_to_0_925 =  new TH1F("h_200_CT_DR10_dphi_reco_gen_cosTheta_0_80_to_0_925","", n_bins100, -lim_angleDeg,lim_angleDeg);
  TH1F* h_200_CT_DR10_dtheta_reco_gen_cosTheta_0_80_to_0_925 =  new TH1F("h_200_CT_DR10_dtheta_reco_gen_cosTheta_0_80_to_0_925","", n_bins100, -lim_angleDeg,lim_angleDeg);
  TH1F* h_200_CT_DR10_dphi_reco_gen_cosTheta_0_925_to_0_975 =  new TH1F("h_200_CT_DR10_dphi_reco_gen_cosTheta_0_925_to_0_975","", n_bins100, -lim_angleDeg,lim_angleDeg);
  TH1F* h_200_CT_DR10_dtheta_reco_gen_cosTheta_0_925_to_0_975 =  new TH1F("h_200_CT_DR10_dtheta_reco_gen_cosTheta_0_925_to_0_975","", n_bins100, -lim_angleDeg,lim_angleDeg);

  std::vector<TH1F*> hist_vec_200_CT;
  hist_vec_200_CT.push_back(h_200_CT_genjet03_dphi_j1j2);
  hist_vec_200_CT.push_back(h_200_CT_genjet03_E1_E2_over_E_True);
  hist_vec_200_CT.push_back(h_200_CT_genjet03_Delta_E1_E2_over_E12);
  hist_vec_200_CT.push_back(h_200_CT_genjet04_dphi_j1j2);
  hist_vec_200_CT.push_back(h_200_CT_genjet04_E1_E2_over_E_True);
  hist_vec_200_CT.push_back(h_200_CT_genjet04_Delta_E1_E2_over_E12);
  hist_vec_200_CT.push_back(h_200_CT_genjet05_dphi_j1j2);
  hist_vec_200_CT.push_back(h_200_CT_genjet05_E1_E2_over_E_True);
  hist_vec_200_CT.push_back(h_200_CT_genjet05_Delta_E1_E2_over_E12);
  hist_vec_200_CT.push_back(h_200_CT_genjet06_dphi_j1j2);
  hist_vec_200_CT.push_back(h_200_CT_genjet06_E1_E2_over_E_True);
  hist_vec_200_CT.push_back(h_200_CT_genjet06_Delta_E1_E2_over_E12);
  hist_vec_200_CT.push_back(h_200_CT_genjet07_dphi_j1j2);
  hist_vec_200_CT.push_back(h_200_CT_genjet07_E1_E2_over_E_True);
  hist_vec_200_CT.push_back(h_200_CT_genjet07_Delta_E1_E2_over_E12);
  hist_vec_200_CT.push_back(h_200_CT_genjet08_dphi_j1j2);
  hist_vec_200_CT.push_back(h_200_CT_genjet08_E1_E2_over_E_True);
  hist_vec_200_CT.push_back(h_200_CT_genjet08_Delta_E1_E2_over_E12);
  hist_vec_200_CT.push_back(h_200_CT_genjet09_dphi_j1j2);
  hist_vec_200_CT.push_back(h_200_CT_genjet09_E1_E2_over_E_True);
  hist_vec_200_CT.push_back(h_200_CT_genjet09_Delta_E1_E2_over_E12);
  hist_vec_200_CT.push_back(h_200_CT_genjet10_dphi_j1j2);
  hist_vec_200_CT.push_back(h_200_CT_genjet10_E1_E2_over_E_True);
  hist_vec_200_CT.push_back(h_200_CT_genjet10_Delta_E1_E2_over_E12);

  hist_vec_200_CT.push_back(h_200_CT_recojet03_dphi_j1j2);
  hist_vec_200_CT.push_back(h_200_CT_recojet03_E1_E2_over_E_True);
  hist_vec_200_CT.push_back(h_200_CT_recojet03_Delta_E1_E2_over_E12);
  hist_vec_200_CT.push_back(h_200_CT_recojet04_dphi_j1j2);
  hist_vec_200_CT.push_back(h_200_CT_recojet04_E1_E2_over_E_True);
  hist_vec_200_CT.push_back(h_200_CT_recojet04_Delta_E1_E2_over_E12);
  hist_vec_200_CT.push_back(h_200_CT_recojet05_dphi_j1j2);
  hist_vec_200_CT.push_back(h_200_CT_recojet05_E1_E2_over_E_True);
  hist_vec_200_CT.push_back(h_200_CT_recojet05_Delta_E1_E2_over_E12);
  hist_vec_200_CT.push_back(h_200_CT_recojet06_dphi_j1j2);
  hist_vec_200_CT.push_back(h_200_CT_recojet06_E1_E2_over_E_True);
  hist_vec_200_CT.push_back(h_200_CT_recojet06_Delta_E1_E2_over_E12);
  hist_vec_200_CT.push_back(h_200_CT_recojet07_dphi_j1j2);
  hist_vec_200_CT.push_back(h_200_CT_recojet07_E1_E2_over_E_True);
  hist_vec_200_CT.push_back(h_200_CT_recojet07_Delta_E1_E2_over_E12);
  hist_vec_200_CT.push_back(h_200_CT_recojet08_dphi_j1j2);
  hist_vec_200_CT.push_back(h_200_CT_recojet08_E1_E2_over_E_True);
  hist_vec_200_CT.push_back(h_200_CT_recojet08_Delta_E1_E2_over_E12);
  hist_vec_200_CT.push_back(h_200_CT_recojet09_dphi_j1j2);
  hist_vec_200_CT.push_back(h_200_CT_recojet09_E1_E2_over_E_True);
  hist_vec_200_CT.push_back(h_200_CT_recojet09_Delta_E1_E2_over_E12);
  hist_vec_200_CT.push_back(h_200_CT_recojet10_dphi_j1j2);
  hist_vec_200_CT.push_back(h_200_CT_recojet10_E1_E2_over_E_True);
  hist_vec_200_CT.push_back(h_200_CT_recojet10_Delta_E1_E2_over_E12);

  hist_vec_200_CT.push_back(h_200_CT_recojetE_over_genjetE_DR03);
  hist_vec_200_CT.push_back(h_200_CT_recojetE_over_genjetE_DR04);
  hist_vec_200_CT.push_back(h_200_CT_recojetE_over_genjetE_DR05);
  hist_vec_200_CT.push_back(h_200_CT_recojetE_over_genjetE_DR06);
  hist_vec_200_CT.push_back(h_200_CT_recojetE_over_genjetE_DR07);
  hist_vec_200_CT.push_back(h_200_CT_recojetE_over_genjetE_DR08);
  hist_vec_200_CT.push_back(h_200_CT_recojetE_over_genjetE_DR09);
  hist_vec_200_CT.push_back(h_200_CT_recojetE_over_genjetE_DR10);

  hist_vec_200_CT.push_back(h_200_CT_dphi_gen_reco_DR05);
  hist_vec_200_CT.push_back(h_200_CT_dphi_gen_reco_DR06);
  hist_vec_200_CT.push_back(h_200_CT_dphi_gen_reco_DR07);

  hist_vec_200_CT.push_back(h_200_CT_DR05_E_rel_totVis_RMS_d1_cosT_0_to_0_10);
  hist_vec_200_CT.push_back(h_200_CT_DR05_E_rel_totVis_RMS_d1_cosT_0_10_to_0_20);
  hist_vec_200_CT.push_back(h_200_CT_DR05_E_rel_totVis_RMS_d1_cosT_0_20_to_0_30);
  hist_vec_200_CT.push_back(h_200_CT_DR05_E_rel_totVis_RMS_d1_cosT_0_30_to_0_40);
  hist_vec_200_CT.push_back(h_200_CT_DR05_E_rel_totVis_RMS_d1_cosT_0_40_to_0_50);
  hist_vec_200_CT.push_back(h_200_CT_DR05_E_rel_totVis_RMS_d1_cosT_0_50_to_0_60);
  hist_vec_200_CT.push_back(h_200_CT_DR05_E_rel_totVis_RMS_d1_cosT_0_60_to_0_70);
  hist_vec_200_CT.push_back(h_200_CT_DR05_E_rel_totVis_RMS_d1_cosT_0_70_to_0_80);
  hist_vec_200_CT.push_back(h_200_CT_DR05_E_rel_totVis_RMS_d1_cosT_0_80_to_0_90);
  hist_vec_200_CT.push_back(h_200_CT_DR05_E_rel_totVis_RMS_d1_cosT_0_900_to_0_925);
  hist_vec_200_CT.push_back(h_200_CT_DR05_E_rel_totVis_RMS_d1_cosT_0_925_to_0_950);
  hist_vec_200_CT.push_back(h_200_CT_DR05_E_rel_totVis_RMS_d1_cosT_0_950_to_0_975);
  hist_vec_200_CT.push_back(h_200_CT_DR05_E_rel_totVis_RMS_d1_cosT_0_975_to_1_00);

  hist_vec_200_CT.push_back(h_200_CT_DR06_E_rel_totVis_RMS_d1_cosT_0_to_0_10);
  hist_vec_200_CT.push_back(h_200_CT_DR06_E_rel_totVis_RMS_d1_cosT_0_10_to_0_20);
  hist_vec_200_CT.push_back(h_200_CT_DR06_E_rel_totVis_RMS_d1_cosT_0_20_to_0_30);
  hist_vec_200_CT.push_back(h_200_CT_DR06_E_rel_totVis_RMS_d1_cosT_0_30_to_0_40);
  hist_vec_200_CT.push_back(h_200_CT_DR06_E_rel_totVis_RMS_d1_cosT_0_40_to_0_50);
  hist_vec_200_CT.push_back(h_200_CT_DR06_E_rel_totVis_RMS_d1_cosT_0_50_to_0_60);
  hist_vec_200_CT.push_back(h_200_CT_DR06_E_rel_totVis_RMS_d1_cosT_0_60_to_0_70);
  hist_vec_200_CT.push_back(h_200_CT_DR06_E_rel_totVis_RMS_d1_cosT_0_70_to_0_80);
  hist_vec_200_CT.push_back(h_200_CT_DR06_E_rel_totVis_RMS_d1_cosT_0_80_to_0_90);
  hist_vec_200_CT.push_back(h_200_CT_DR06_E_rel_totVis_RMS_d1_cosT_0_900_to_0_925);
  hist_vec_200_CT.push_back(h_200_CT_DR06_E_rel_totVis_RMS_d1_cosT_0_925_to_0_950);
  hist_vec_200_CT.push_back(h_200_CT_DR06_E_rel_totVis_RMS_d1_cosT_0_950_to_0_975);
  hist_vec_200_CT.push_back(h_200_CT_DR06_E_rel_totVis_RMS_d1_cosT_0_975_to_1_00); 

  hist_vec_200_CT.push_back(h_200_CT_DR07_E_rel_totVis_RMS_d1_cosT_0_to_0_10);
  hist_vec_200_CT.push_back(h_200_CT_DR07_E_rel_totVis_RMS_d1_cosT_0_10_to_0_20);
  hist_vec_200_CT.push_back(h_200_CT_DR07_E_rel_totVis_RMS_d1_cosT_0_20_to_0_30);
  hist_vec_200_CT.push_back(h_200_CT_DR07_E_rel_totVis_RMS_d1_cosT_0_30_to_0_40);
  hist_vec_200_CT.push_back(h_200_CT_DR07_E_rel_totVis_RMS_d1_cosT_0_40_to_0_50);
  hist_vec_200_CT.push_back(h_200_CT_DR07_E_rel_totVis_RMS_d1_cosT_0_50_to_0_60);
  hist_vec_200_CT.push_back(h_200_CT_DR07_E_rel_totVis_RMS_d1_cosT_0_60_to_0_70);
  hist_vec_200_CT.push_back(h_200_CT_DR07_E_rel_totVis_RMS_d1_cosT_0_70_to_0_80);
  hist_vec_200_CT.push_back(h_200_CT_DR07_E_rel_totVis_RMS_d1_cosT_0_80_to_0_90);
  hist_vec_200_CT.push_back(h_200_CT_DR07_E_rel_totVis_RMS_d1_cosT_0_900_to_0_925);
  hist_vec_200_CT.push_back(h_200_CT_DR07_E_rel_totVis_RMS_d1_cosT_0_925_to_0_950);
  hist_vec_200_CT.push_back(h_200_CT_DR07_E_rel_totVis_RMS_d1_cosT_0_950_to_0_975);
  hist_vec_200_CT.push_back(h_200_CT_DR07_E_rel_totVis_RMS_d1_cosT_0_975_to_1_00); 


  hist_vec_200_CT.push_back(h_200_CT_DR08_E_rel_totVis_RMS_d1_cosT_0_to_0_10);
  hist_vec_200_CT.push_back(h_200_CT_DR08_E_rel_totVis_RMS_d1_cosT_0_10_to_0_20);
  hist_vec_200_CT.push_back(h_200_CT_DR08_E_rel_totVis_RMS_d1_cosT_0_20_to_0_30);
  hist_vec_200_CT.push_back(h_200_CT_DR08_E_rel_totVis_RMS_d1_cosT_0_30_to_0_40);
  hist_vec_200_CT.push_back(h_200_CT_DR08_E_rel_totVis_RMS_d1_cosT_0_40_to_0_50);
  hist_vec_200_CT.push_back(h_200_CT_DR08_E_rel_totVis_RMS_d1_cosT_0_50_to_0_60);
  hist_vec_200_CT.push_back(h_200_CT_DR08_E_rel_totVis_RMS_d1_cosT_0_60_to_0_70);
  hist_vec_200_CT.push_back(h_200_CT_DR08_E_rel_totVis_RMS_d1_cosT_0_70_to_0_80);
  hist_vec_200_CT.push_back(h_200_CT_DR08_E_rel_totVis_RMS_d1_cosT_0_80_to_0_90);
  hist_vec_200_CT.push_back(h_200_CT_DR08_E_rel_totVis_RMS_d1_cosT_0_900_to_0_925);
  hist_vec_200_CT.push_back(h_200_CT_DR08_E_rel_totVis_RMS_d1_cosT_0_925_to_0_950);
  hist_vec_200_CT.push_back(h_200_CT_DR08_E_rel_totVis_RMS_d1_cosT_0_950_to_0_975);
  hist_vec_200_CT.push_back(h_200_CT_DR08_E_rel_totVis_RMS_d1_cosT_0_975_to_1_00); //110

  hist_vec_200_CT.push_back(h_200_CT_DR09_E_rel_totVis_RMS_d1_cosT_0_to_0_10);
  hist_vec_200_CT.push_back(h_200_CT_DR09_E_rel_totVis_RMS_d1_cosT_0_10_to_0_20);
  hist_vec_200_CT.push_back(h_200_CT_DR09_E_rel_totVis_RMS_d1_cosT_0_20_to_0_30);
  hist_vec_200_CT.push_back(h_200_CT_DR09_E_rel_totVis_RMS_d1_cosT_0_30_to_0_40);
  hist_vec_200_CT.push_back(h_200_CT_DR09_E_rel_totVis_RMS_d1_cosT_0_40_to_0_50);
  hist_vec_200_CT.push_back(h_200_CT_DR09_E_rel_totVis_RMS_d1_cosT_0_50_to_0_60);
  hist_vec_200_CT.push_back(h_200_CT_DR09_E_rel_totVis_RMS_d1_cosT_0_60_to_0_70);
  hist_vec_200_CT.push_back(h_200_CT_DR09_E_rel_totVis_RMS_d1_cosT_0_70_to_0_80);
  hist_vec_200_CT.push_back(h_200_CT_DR09_E_rel_totVis_RMS_d1_cosT_0_80_to_0_90);
  hist_vec_200_CT.push_back(h_200_CT_DR09_E_rel_totVis_RMS_d1_cosT_0_900_to_0_925);
  hist_vec_200_CT.push_back(h_200_CT_DR09_E_rel_totVis_RMS_d1_cosT_0_925_to_0_950);
  hist_vec_200_CT.push_back(h_200_CT_DR09_E_rel_totVis_RMS_d1_cosT_0_950_to_0_975);
  hist_vec_200_CT.push_back(h_200_CT_DR09_E_rel_totVis_RMS_d1_cosT_0_975_to_1_00); //123

  hist_vec_200_CT.push_back(h_200_CT_DR10_E_rel_totVis_RMS_d1_cosT_0_to_0_10);
  hist_vec_200_CT.push_back(h_200_CT_DR10_E_rel_totVis_RMS_d1_cosT_0_10_to_0_20);
  hist_vec_200_CT.push_back(h_200_CT_DR10_E_rel_totVis_RMS_d1_cosT_0_20_to_0_30);
  hist_vec_200_CT.push_back(h_200_CT_DR10_E_rel_totVis_RMS_d1_cosT_0_30_to_0_40);
  hist_vec_200_CT.push_back(h_200_CT_DR10_E_rel_totVis_RMS_d1_cosT_0_40_to_0_50);
  hist_vec_200_CT.push_back(h_200_CT_DR10_E_rel_totVis_RMS_d1_cosT_0_50_to_0_60);
  hist_vec_200_CT.push_back(h_200_CT_DR10_E_rel_totVis_RMS_d1_cosT_0_60_to_0_70);
  hist_vec_200_CT.push_back(h_200_CT_DR10_E_rel_totVis_RMS_d1_cosT_0_70_to_0_80);
  hist_vec_200_CT.push_back(h_200_CT_DR10_E_rel_totVis_RMS_d1_cosT_0_80_to_0_90);
  hist_vec_200_CT.push_back(h_200_CT_DR10_E_rel_totVis_RMS_d1_cosT_0_900_to_0_925);
  hist_vec_200_CT.push_back(h_200_CT_DR10_E_rel_totVis_RMS_d1_cosT_0_925_to_0_950);
  hist_vec_200_CT.push_back(h_200_CT_DR10_E_rel_totVis_RMS_d1_cosT_0_950_to_0_975);
  hist_vec_200_CT.push_back(h_200_CT_DR10_E_rel_totVis_RMS_d1_cosT_0_975_to_1_00); //136

  hist_vec_200_CT.push_back(h_200_CT_DR05_dphi_reco_gen_cosTheta_0_65);//137
  hist_vec_200_CT.push_back(h_200_CT_DR05_dphi_reco_gen_cosTheta_0_65_to_0_80);
  hist_vec_200_CT.push_back(h_200_CT_DR05_dphi_reco_gen_cosTheta_0_80_to_0_925);
  hist_vec_200_CT.push_back(h_200_CT_DR05_dphi_reco_gen_cosTheta_0_925_to_0_975);
  hist_vec_200_CT.push_back(h_200_CT_DR05_dtheta_reco_gen_cosTheta_0_65);
  hist_vec_200_CT.push_back(h_200_CT_DR05_dtheta_reco_gen_cosTheta_0_65_to_0_80);
  hist_vec_200_CT.push_back(h_200_CT_DR05_dtheta_reco_gen_cosTheta_0_80_to_0_925);
  hist_vec_200_CT.push_back(h_200_CT_DR05_dtheta_reco_gen_cosTheta_0_925_to_0_975);

  hist_vec_200_CT.push_back(h_200_CT_DR07_dphi_reco_gen_cosTheta_0_65);//145
  hist_vec_200_CT.push_back(h_200_CT_DR07_dphi_reco_gen_cosTheta_0_65_to_0_80);
  hist_vec_200_CT.push_back(h_200_CT_DR07_dphi_reco_gen_cosTheta_0_80_to_0_925);
  hist_vec_200_CT.push_back(h_200_CT_DR07_dphi_reco_gen_cosTheta_0_925_to_0_975);
  hist_vec_200_CT.push_back(h_200_CT_DR07_dtheta_reco_gen_cosTheta_0_65);
  hist_vec_200_CT.push_back(h_200_CT_DR07_dtheta_reco_gen_cosTheta_0_65_to_0_80);
  hist_vec_200_CT.push_back(h_200_CT_DR07_dtheta_reco_gen_cosTheta_0_80_to_0_925);
  hist_vec_200_CT.push_back(h_200_CT_DR07_dtheta_reco_gen_cosTheta_0_925_to_0_975);

  hist_vec_200_CT.push_back(h_200_CT_DR10_dphi_reco_gen_cosTheta_0_65);//153
  hist_vec_200_CT.push_back(h_200_CT_DR10_dphi_reco_gen_cosTheta_0_65_to_0_80);
  hist_vec_200_CT.push_back(h_200_CT_DR10_dphi_reco_gen_cosTheta_0_80_to_0_925);
  hist_vec_200_CT.push_back(h_200_CT_DR10_dphi_reco_gen_cosTheta_0_925_to_0_975);
  hist_vec_200_CT.push_back(h_200_CT_DR10_dtheta_reco_gen_cosTheta_0_65);
  hist_vec_200_CT.push_back(h_200_CT_DR10_dtheta_reco_gen_cosTheta_0_65_to_0_80);
  hist_vec_200_CT.push_back(h_200_CT_DR10_dtheta_reco_gen_cosTheta_0_80_to_0_925);
  hist_vec_200_CT.push_back(h_200_CT_DR10_dtheta_reco_gen_cosTheta_0_925_to_0_975);

  for(unsigned int i=0;i<hist_vec_200_CT.size();i++){
    hist_vec_200_CT[i]->Sumw2();
  }

  fill_jet_histograms(file_CLIC_200_CT,hist_vec_200_CT);


  TH1F* h_200_CT_DR05_dphi_SigmaCB_summary_histogram=new TH1F("dphiRes_SigmaCBVsCosTheta_CT_DR05_200", "#sigma#Delta#phi(j_{reco},j_{true}) vs |cos#theta|", nRegionBinsAngles, pRegionBinEdgesAngles);
  h_200_CT_DR05_dphi_SigmaCB_summary_histogram ->SetYTitle("#sigma#Delta#phi(j_{reco},j_{true})");
  h_200_CT_DR05_dphi_SigmaCB_summary_histogram->SetXTitle("|cos#theta|");
  h_200_CT_DR05_dphi_SigmaCB_summary_histogram->SetLineWidth(2);
  h_200_CT_DR05_dphi_SigmaCB_summary_histogram->SetLineColor(kCyan+1);
  h_200_CT_DR05_dphi_SigmaCB_summary_histogram->SetLineStyle(2);

  TH1F* h_200_CT_DR05_dphi_RMS90_summary_histogram=new TH1F("dphiRes_RMS90VsCosTheta_CT_DR05_200", "RMS_{90} #Delta#phi(j_{reco},j_{true}) vs |cos#theta|", nRegionBinsAngles, pRegionBinEdgesAngles);
  h_200_CT_DR05_dphi_RMS90_summary_histogram ->SetYTitle("RMS_{90}#Delta#phi(j_{reco},j_{true})");
  h_200_CT_DR05_dphi_RMS90_summary_histogram->SetXTitle("|cos#theta|");
  h_200_CT_DR05_dphi_RMS90_summary_histogram->SetLineWidth(2);
  h_200_CT_DR05_dphi_RMS90_summary_histogram->SetLineColor(kCyan+1);
  h_200_CT_DR05_dphi_RMS90_summary_histogram->SetLineStyle(2);

  TH1F* h_200_CT_DR07_dphi_SigmaCB_summary_histogram=new TH1F("dphiRes_SigmaCBVsCosTheta_CT_DR07_200", "#sigma#Delta#phi(j_{reco},j_{true}) vs |cos#theta|", nRegionBinsAngles, pRegionBinEdgesAngles);
  h_200_CT_DR07_dphi_SigmaCB_summary_histogram ->SetYTitle("#sigma#Delta#phi(j_{reco},j_{true})");
  h_200_CT_DR07_dphi_SigmaCB_summary_histogram->SetXTitle("|cos#theta|");
  h_200_CT_DR07_dphi_SigmaCB_summary_histogram->SetLineWidth(2);
  h_200_CT_DR07_dphi_SigmaCB_summary_histogram->SetLineColor(kCyan+1);
  h_200_CT_DR07_dphi_SigmaCB_summary_histogram->SetLineStyle(2);

  TH1F* h_200_CT_DR07_dphi_RMS90_summary_histogram=new TH1F("dphiRes_RMS90VsCosTheta_CT_DR07_200", "RMS_{90} #Delta#phi(j_{reco},j_{true}) vs |cos#theta|", nRegionBinsAngles, pRegionBinEdgesAngles);
  h_200_CT_DR07_dphi_RMS90_summary_histogram ->SetYTitle("RMS_{90}#Delta#phi(j_{reco},j_{true})");
  h_200_CT_DR07_dphi_RMS90_summary_histogram->SetXTitle("|cos#theta|");
  h_200_CT_DR07_dphi_RMS90_summary_histogram->SetLineWidth(2);
  h_200_CT_DR07_dphi_RMS90_summary_histogram->SetLineColor(kCyan+1);
  h_200_CT_DR07_dphi_RMS90_summary_histogram->SetLineStyle(2);

  TH1F* h_200_CT_DR10_dphi_SigmaCB_summary_histogram=new TH1F("dphiRes_SigmaCBVsCosTheta_CT_DR10_200", "#sigma#Delta#phi(j_{reco},j_{true}) vs |cos#theta|", nRegionBinsAngles, pRegionBinEdgesAngles);
  h_200_CT_DR10_dphi_SigmaCB_summary_histogram ->SetYTitle("#sigma#Delta#phi(j_{reco},j_{true})");
  h_200_CT_DR10_dphi_SigmaCB_summary_histogram->SetXTitle("|cos#theta|");
  h_200_CT_DR10_dphi_SigmaCB_summary_histogram->SetLineWidth(2);
  h_200_CT_DR10_dphi_SigmaCB_summary_histogram->SetLineColor(kCyan+1);
  h_200_CT_DR10_dphi_SigmaCB_summary_histogram->SetLineStyle(2);

  TH1F* h_200_CT_DR10_dphi_RMS90_summary_histogram=new TH1F("dphiRes_RMS90VsCosTheta_CT_DR10_200", "RMS_{90} #Delta#phi(j_{reco},j_{true}) vs |cos#theta|", nRegionBinsAngles, pRegionBinEdgesAngles);
  h_200_CT_DR10_dphi_RMS90_summary_histogram ->SetYTitle("RMS_{90}#Delta#phi(j_{reco},j_{true})");
  h_200_CT_DR10_dphi_RMS90_summary_histogram->SetXTitle("|cos#theta|");
  h_200_CT_DR10_dphi_RMS90_summary_histogram->SetLineWidth(2);
  h_200_CT_DR10_dphi_RMS90_summary_histogram->SetLineColor(kCyan+1);
  h_200_CT_DR10_dphi_RMS90_summary_histogram->SetLineStyle(2);

  TH1F* h_200_CT_DR05_dtheta_SigmaCB_summary_histogram=new TH1F("dthetaRes_SigmaCBVsCosTheta_CT_DR05_200", "#sigma#Delta#theta(j_{reco},j_{true}) vs |cos#theta|", nRegionBinsAngles, pRegionBinEdgesAngles);
  h_200_CT_DR05_dtheta_SigmaCB_summary_histogram ->SetYTitle("#sigma#Delta#theta(j_{reco},j_{true})");
  h_200_CT_DR05_dtheta_SigmaCB_summary_histogram->SetXTitle("|cos#theta|");
  h_200_CT_DR05_dtheta_SigmaCB_summary_histogram->SetLineWidth(2);
  h_200_CT_DR05_dtheta_SigmaCB_summary_histogram->SetLineColor(kCyan+1);
  h_200_CT_DR05_dtheta_SigmaCB_summary_histogram->SetLineStyle(2);

  TH1F* h_200_CT_DR05_dtheta_RMS90_summary_histogram=new TH1F("dthetaRes_RMS90VsCosTheta_CT_DR05_200", "RMS_{90} #Delta#theta(j_{reco},j_{true}) vs |cos#theta|", nRegionBinsAngles, pRegionBinEdgesAngles);
  h_200_CT_DR05_dtheta_RMS90_summary_histogram ->SetYTitle("RMS_{90}#Delta#theta(j_{reco},j_{true})");
  h_200_CT_DR05_dtheta_RMS90_summary_histogram->SetXTitle("|cos#theta|");
  h_200_CT_DR05_dtheta_RMS90_summary_histogram->SetLineWidth(2);
  h_200_CT_DR05_dtheta_RMS90_summary_histogram->SetLineColor(kCyan+1);
  h_200_CT_DR05_dtheta_RMS90_summary_histogram->SetLineStyle(2);

  TH1F* h_200_CT_DR07_dtheta_SigmaCB_summary_histogram=new TH1F("dthetaRes_SigmaCBVsCosTheta_CT_DR07_200", "#sigma#Delta#theta(j_{reco},j_{true}) vs |cos#theta|", nRegionBinsAngles, pRegionBinEdgesAngles);
  h_200_CT_DR07_dtheta_SigmaCB_summary_histogram ->SetYTitle("#sigma#Delta#theta(j_{reco},j_{true})");
  h_200_CT_DR07_dtheta_SigmaCB_summary_histogram->SetXTitle("|cos#theta|");
  h_200_CT_DR07_dtheta_SigmaCB_summary_histogram->SetLineWidth(2);
  h_200_CT_DR07_dtheta_SigmaCB_summary_histogram->SetLineColor(kCyan+1);
  h_200_CT_DR07_dtheta_SigmaCB_summary_histogram->SetLineStyle(2);

  TH1F* h_200_CT_DR07_dtheta_RMS90_summary_histogram=new TH1F("dthetaRes_RMS90VsCosTheta_CT_DR07_200", "RMS_{90} #Delta#theta(j_{reco},j_{true}) vs |cos#theta|", nRegionBinsAngles, pRegionBinEdgesAngles);
  h_200_CT_DR07_dtheta_RMS90_summary_histogram ->SetYTitle("RMS_{90}#Delta#theta(j_{reco},j_{true})");
  h_200_CT_DR07_dtheta_RMS90_summary_histogram->SetXTitle("|cos#theta|");
  h_200_CT_DR07_dtheta_RMS90_summary_histogram->SetLineWidth(2);
  h_200_CT_DR07_dtheta_RMS90_summary_histogram->SetLineColor(kCyan+1);
  h_200_CT_DR07_dtheta_RMS90_summary_histogram->SetLineStyle(2);

  TH1F* h_200_CT_DR10_dtheta_SigmaCB_summary_histogram=new TH1F("dthetaRes_SigmaCBVsCosTheta_CT_DR10_200", "#sigma#Delta#theta(j_{reco},j_{true}) vs |cos#theta|", nRegionBinsAngles, pRegionBinEdgesAngles);
  h_200_CT_DR10_dtheta_SigmaCB_summary_histogram ->SetYTitle("#sigma#Delta#theta(j_{reco},j_{true})");
  h_200_CT_DR10_dtheta_SigmaCB_summary_histogram->SetXTitle("|cos#theta|");
  h_200_CT_DR10_dtheta_SigmaCB_summary_histogram->SetLineWidth(2);
  h_200_CT_DR10_dtheta_SigmaCB_summary_histogram->SetLineColor(kCyan+1);
  h_200_CT_DR10_dtheta_SigmaCB_summary_histogram->SetLineStyle(2);

  TH1F* h_200_CT_DR10_dtheta_RMS90_summary_histogram=new TH1F("dthetaRes_RMS90VsCosTheta_CT_DR10_200", "RMS_{90} #Delta#theta(j_{reco},j_{true}) vs |cos#theta|", nRegionBinsAngles, pRegionBinEdgesAngles);
  h_200_CT_DR10_dtheta_RMS90_summary_histogram ->SetYTitle("RMS_{90}#Delta#theta(j_{reco},j_{true})");
  h_200_CT_DR10_dtheta_RMS90_summary_histogram->SetXTitle("|cos#theta|");
  h_200_CT_DR10_dtheta_RMS90_summary_histogram->SetLineWidth(2);
  h_200_CT_DR10_dtheta_RMS90_summary_histogram->SetLineColor(kCyan+1);
  h_200_CT_DR10_dtheta_RMS90_summary_histogram->SetLineStyle(2);

  for(int i=137;i<161;i++){
    //continue;
    std::cout<<"ang histo 200 "<<i<<"]"<<std::endl;
   //double sided crystal ball
    TF1* fit_gaus_tmp = new TF1("fit_gaus_tmp", "gaus",-5.,5.);
    hist_vec_200_CT[i]->Fit("fit_gaus_tmp","R");
    hist_vec_200_CT[i]->GetFunction("fit_gaus_tmp");
    TF1* fdscb_tmp = new TF1("fdscb_tmp",fnc_dscb,-lim_angleDeg,lim_angleDeg,7);
   fdscb_tmp->SetNpx(2000);
    fdscb_tmp->SetParameter(0,fit_gaus_tmp->GetParameter(0));
    //norm
    fdscb_tmp->SetParLimits (0,0.5*fit_gaus_tmp->GetParameter(0),1.5*fit_gaus_tmp->GetParameter(0));
    fdscb_tmp->SetParameter(1,fit_gaus_tmp->GetParameter(1));
    //gaussian mean
    fdscb_tmp->SetParLimits (1,-2.,2.);
    fdscb_tmp->SetParameter(2,fit_gaus_tmp->GetParameter(2));
    fdscb_tmp->SetParLimits(2,fit_gaus_tmp->GetParameter(2)*0.50,1.50*fit_gaus_tmp->GetParameter(2));
    //std::vector<float>sigma2SFit=sigmaGaussianFits2Sigma(hist_vec_200_CT[i]);
    //fdscb_tmp->SetParameter(2,sigma2SFit[0]);
    //fdscb_tmp->SetParLimits(2,sigma2SFit[0]*0.50,1.50*sigma2SFit[0]);
    //-a1: parameter, from when the gaussian core should count
    fdscb_tmp->SetParameter(2,fit_gaus_tmp->GetParameter(2));
    fdscb_tmp->SetParameter (3,3.0);
    fdscb_tmp->SetParLimits (3,0.0,10.0);
    //a2 parameter, up to when the gaussian core should count
    fdscb_tmp->SetParameter (5,3.0);
    fdscb_tmp->SetParLimits (5,0.0,10.0);
    fdscb_tmp->SetParameter(4,5.);
    fdscb_tmp->SetParLimits(4,0.,25.);
    fdscb_tmp->SetParameter(6,5.);
    fdscb_tmp->SetParLimits(6,0.,25.);
    int fitstatus(0); 
    fitstatus = hist_vec_200_CT[i]->Fit(fdscb_tmp,"R");
    fdscb_tmp = hist_vec_200_CT[i]->GetFunction("fdscb_tmp");
    resolutionTH1=0; 
    resolutionErrorTH1=0;
    meanTH1=0;
    meanErrorTH1=0;
    CalculatePerformanceNoMean( hist_vec_200_CT[i], resolutionTH1, resolutionErrorTH1,meanTH1,meanErrorTH1);
    int first_bin_ang=137;
    if(i<141){//dphi DR05
      first_bin_ang=137;
      h_200_CT_DR05_dphi_SigmaCB_summary_histogram->SetBinContent(i-first_bin_ang+1,fdscb_tmp->GetParameter(2));
      h_200_CT_DR05_dphi_SigmaCB_summary_histogram->SetBinError(i-first_bin_ang+1,fdscb_tmp->GetParError(2));
      h_200_CT_DR05_dphi_RMS90_summary_histogram->SetBinContent(i-first_bin_ang+1,resolutionTH1);
      h_200_CT_DR05_dphi_RMS90_summary_histogram->SetBinError(i-first_bin_ang+1, resolutionErrorTH1);
    }else if(i<145){//dtheta DR05
      first_bin_ang=141;
      h_200_CT_DR05_dtheta_SigmaCB_summary_histogram->SetBinContent(i-first_bin_ang+1,fdscb_tmp->GetParameter(2));
      h_200_CT_DR05_dtheta_SigmaCB_summary_histogram->SetBinError(i-first_bin_ang+1,fdscb_tmp->GetParError(2));
      h_200_CT_DR05_dtheta_RMS90_summary_histogram->SetBinContent(i-first_bin_ang+1,resolutionTH1);
      h_200_CT_DR05_dtheta_RMS90_summary_histogram->SetBinError(i-first_bin_ang+1, resolutionErrorTH1);
    }else if(i<149){//dphi DR07
      first_bin_ang=145;
      h_200_CT_DR07_dphi_SigmaCB_summary_histogram->SetBinContent(i-first_bin_ang+1,fdscb_tmp->GetParameter(2));
      h_200_CT_DR07_dphi_SigmaCB_summary_histogram->SetBinError(i-first_bin_ang+1,fdscb_tmp->GetParError(2));
      h_200_CT_DR07_dphi_RMS90_summary_histogram->SetBinContent(i-first_bin_ang+1,resolutionTH1);
      h_200_CT_DR07_dphi_RMS90_summary_histogram->SetBinError(i-first_bin_ang+1, resolutionErrorTH1);
    }else if(i<153){//dtheta DR07
      first_bin_ang=149;
      h_200_CT_DR07_dtheta_SigmaCB_summary_histogram->SetBinContent(i-first_bin_ang+1,fdscb_tmp->GetParameter(2));
      h_200_CT_DR07_dtheta_SigmaCB_summary_histogram->SetBinError(i-first_bin_ang+1,fdscb_tmp->GetParError(2));
      h_200_CT_DR07_dtheta_RMS90_summary_histogram->SetBinContent(i-first_bin_ang+1,resolutionTH1);
      h_200_CT_DR07_dtheta_RMS90_summary_histogram->SetBinError(i-first_bin_ang+1, resolutionErrorTH1);
    }else if(i<157){//dphi DR07
      first_bin_ang=153;
      h_200_CT_DR10_dphi_SigmaCB_summary_histogram->SetBinContent(i-first_bin_ang+1,fdscb_tmp->GetParameter(2));
      h_200_CT_DR10_dphi_SigmaCB_summary_histogram->SetBinError(i-first_bin_ang+1,fdscb_tmp->GetParError(2));
      h_200_CT_DR10_dphi_RMS90_summary_histogram->SetBinContent(i-first_bin_ang+1,resolutionTH1);
      h_200_CT_DR10_dphi_RMS90_summary_histogram->SetBinError(i-first_bin_ang+1, resolutionErrorTH1);
    }else if(i<161){//dtheta DR07
      first_bin_ang=157;
      h_200_CT_DR10_dtheta_SigmaCB_summary_histogram->SetBinContent(i-first_bin_ang+1,fdscb_tmp->GetParameter(2));
      h_200_CT_DR10_dtheta_SigmaCB_summary_histogram->SetBinError(i-first_bin_ang+1,fdscb_tmp->GetParError(2));
      h_200_CT_DR10_dtheta_RMS90_summary_histogram->SetBinContent(i-first_bin_ang+1,resolutionTH1);
      h_200_CT_DR10_dtheta_RMS90_summary_histogram->SetBinError(i-first_bin_ang+1, resolutionErrorTH1);
    }
  }


  TH1F* h_200_CT_DR05_E_SigmaCB_summary_histogram=new TH1F("JER_SigmaCBVsCosTheta_CT_DR05_200", "#sigma (E_{j}^{reco} / E_{j}^{true}) vs |cos#theta|", nRegionBins, pRegionBinEdges);
  h_200_CT_DR05_E_SigmaCB_summary_histogram ->SetYTitle("#sigma(E_{j}) / E_{j} [%]");
  h_200_CT_DR05_E_SigmaCB_summary_histogram->SetXTitle("|cos#theta|");
  h_200_CT_DR05_E_SigmaCB_summary_histogram->SetLineWidth(2);
  h_200_CT_DR05_E_SigmaCB_summary_histogram->SetLineColor(kYellow+1);
  h_200_CT_DR05_E_SigmaCB_summary_histogram->SetLineStyle(2);
  TH1F* h_200_CT_DR05_E_RMS90_summary_histogram=new TH1F("JER_RMS90VsCosTheta_CT_DR05_200", "RMS_{90}(E_{j}^{reco}/E_{j}^{gen}) / Mean_{90}(E_{j}^{reco}/E_{j}^{gen}) vs |cos#theta|", nRegionBins, pRegionBinEdges);
  h_200_CT_DR05_E_RMS90_summary_histogram ->SetYTitle("RMS_{90}(E_{j}^{reco}/E_{j}^{gen}) / Mean_{90}(E_{j}^{reco}/E_{j}^{gen}) [%]");
  h_200_CT_DR05_E_RMS90_summary_histogram->SetXTitle("|cos#theta|");
  h_200_CT_DR05_E_RMS90_summary_histogram->SetLineWidth(2);
  h_200_CT_DR05_E_RMS90_summary_histogram->SetLineColor(kYellow+1);
  h_200_CT_DR05_E_RMS90_summary_histogram->SetLineStyle(2);

  TH1F* h_200_CT_DR05_E_RMS_summary_histogram=new TH1F("JER_RMSVsCosTheta_CT_DR05_200", "RMS(E_{j}) / Mean(E_{j}) vs |cos#theta|", nRegionBins, pRegionBinEdges);
  h_200_CT_DR05_E_RMS_summary_histogram ->SetYTitle("RMS(E_{j}) / Mean(E_{j}) [%]");
  h_200_CT_DR05_E_RMS_summary_histogram->SetXTitle("|cos#theta|");
  h_200_CT_DR05_E_RMS_summary_histogram->SetLineWidth(2);
  h_200_CT_DR05_E_RMS_summary_histogram->SetLineColor(kYellow+1);
  h_200_CT_DR05_E_RMS_summary_histogram->SetLineStyle(2);

  TH1F* h_200_CT_DR05_E_JER_Mean_summary_histogram=new TH1F("JER_MeanVsCosTheta_CT_DR05_200", "Mean(E_{tot}^{RECO}/E_{tot}^{true}) vs |cos#theta|", nRegionBins, pRegionBinEdges);
  h_200_CT_DR05_E_JER_Mean_summary_histogram->SetYTitle("Mean(E_{tot}^{RECO}/E_{tot}^{true})");
  h_200_CT_DR05_E_JER_Mean_summary_histogram->SetXTitle("|cos#theta|");
  h_200_CT_DR05_E_JER_Mean_summary_histogram->SetLineWidth(2);
  h_200_CT_DR05_E_JER_Mean_summary_histogram->SetLineColor(kYellow+1);
  h_200_CT_DR05_E_JER_Mean_summary_histogram->SetLineStyle(2);

  firstbin=59;
  for(int i=firstbin;i<(firstbin+13);i++){
    //continue;
    resolutionTH1=0; 
    resolutionErrorTH1=0;
    meanTH1=0;
    meanErrorTH1=0;
    CalculatePerformance( hist_vec_200_CT[i], resolutionTH1, resolutionErrorTH1,meanTH1,meanErrorTH1);
    h_200_CT_DR05_E_RMS90_summary_histogram->SetBinContent(i-firstbin+1,resolutionTH1/sqrt(2.));
    h_200_CT_DR05_E_RMS90_summary_histogram ->SetBinError(i-firstbin+1, resolutionErrorTH1/sqrt(2.));
    h_200_CT_DR05_E_RMS_summary_histogram->SetBinContent(i-firstbin+1,hist_vec_200_CT[i]->GetRMS()*100. );
    h_200_CT_DR05_E_RMS_summary_histogram ->SetBinError(i-firstbin+1, hist_vec_200_CT[i]->GetRMSError()*100.);
    h_200_CT_DR05_E_JER_Mean_summary_histogram->SetBinContent(i-firstbin+1,hist_vec_200_CT[i]->GetMean());
    h_200_CT_DR05_E_JER_Mean_summary_histogram->SetBinError(i-firstbin+1,hist_vec_200_CT[i]->GetMeanError());
   //double sided crystal ball
    TF1* fit_gaus_tmp = new TF1("fit_gaus_tmp", "gaus",0.50,1.50);
    hist_vec_200_CT[i]->Fit("fit_gaus_tmp","R");
    hist_vec_200_CT[i]->GetFunction("fit_gaus_tmp");
    TF1* fdscb_tmp = new TF1("fdscb_tmp",fnc_dscb,0.,3.,7);
   fdscb_tmp->SetNpx(1000);
    fdscb_tmp->SetParameter(0,fit_gaus_tmp->GetParameter(0));
    //norm
    fdscb_tmp->SetParLimits (0,0.5*fit_gaus_tmp->GetParameter(0),1.5*fit_gaus_tmp->GetParameter(0));
    fdscb_tmp->SetParameter(1,fit_gaus_tmp->GetParameter(1));
    //gaussian mean
    fdscb_tmp->SetParLimits (1,0.8,1.2);
    //fdscb_tmp->SetParameter(2,fit_gaus_tmp->GetParameter(2));
    //fdscb_tmp->SetParLimits(2,fit_gaus_tmp->GetParameter(2)*0.50,1.50*fit_gaus_tmp->GetParameter(2));
    std::vector<float>sigma2SFit=sigmaGaussianFits2Sigma(hist_vec_200_CT[i]);
    fdscb_tmp->SetParameter(2,sigma2SFit[0]);
    fdscb_tmp->SetParLimits(2,sigma2SFit[0]*0.50,1.50*sigma2SFit[0]);
    //-a1: parameter, from when the gaussian core should count
    fdscb_tmp->SetParameter(2,fit_gaus_tmp->GetParameter(2));
    fdscb_tmp->SetParameter (3,3.0);
    fdscb_tmp->SetParLimits (3,0.0,10.0);
    //a2 parameter, up to when the gaussian core should count
    fdscb_tmp->SetParameter (5,3.0);
    fdscb_tmp->SetParLimits (5,0.0,10.0);
    fdscb_tmp->SetParameter(4,5.);
    fdscb_tmp->SetParLimits(4,0.,25.);
    fdscb_tmp->SetParameter(6,5.);
    fdscb_tmp->SetParLimits(6,0.,25.);
    int fitstatus(0); 
    fitstatus = hist_vec_200_CT[i]->Fit(fdscb_tmp,"R");
    fdscb_tmp = hist_vec_200_CT[i]->GetFunction("fdscb_tmp");
    h_200_CT_DR05_E_SigmaCB_summary_histogram->SetBinContent(i-firstbin+1,fdscb_tmp->GetParameter(2)*100. );
    h_200_CT_DR05_E_SigmaCB_summary_histogram->SetBinError(i-firstbin+1,fdscb_tmp->GetParError(2)*100. );
  }  
  TH1F* h_200_CT_DR06_E_SigmaCB_summary_histogram=new TH1F("JER_SigmaCBVsCosTheta_CT_DR06_200", "#sigma (E_{j}^{reco} / E_{j}^{true}) vs |cos#theta|", nRegionBins, pRegionBinEdges);
  h_200_CT_DR06_E_SigmaCB_summary_histogram ->SetYTitle("#sigma(E_{j}) / E_{j} [%]");
  h_200_CT_DR06_E_SigmaCB_summary_histogram->SetXTitle("|cos#theta|");
  h_200_CT_DR06_E_SigmaCB_summary_histogram->SetLineWidth(2);
  h_200_CT_DR06_E_SigmaCB_summary_histogram->SetLineColor(kYellow+1);
  h_200_CT_DR06_E_SigmaCB_summary_histogram->SetLineStyle(2);
  TH1F* h_200_CT_DR06_E_RMS90_summary_histogram=new TH1F("JER_RMS90VsCosTheta_CT_DR06_200", "RMS_{90}(E_{j}^{reco}/E_{j}^{gen}) / Mean_{90}(E_{j}^{reco}/E_{j}^{gen}) vs |cos#theta|", nRegionBins, pRegionBinEdges);
  h_200_CT_DR06_E_RMS90_summary_histogram ->SetYTitle("RMS_{90}(E_{j}^{reco}/E_{j}^{gen}) / Mean_{90}(E_{j}^{reco}/E_{j}^{gen}) [%]");
  h_200_CT_DR06_E_RMS90_summary_histogram->SetXTitle("|cos#theta|");
  h_200_CT_DR06_E_RMS90_summary_histogram->SetLineWidth(2);
  h_200_CT_DR06_E_RMS90_summary_histogram->SetLineColor(kYellow+1);
  h_200_CT_DR06_E_RMS90_summary_histogram->SetLineStyle(2);

  TH1F* h_200_CT_DR06_E_RMS_summary_histogram=new TH1F("JER_RMSVsCosTheta_CT_DR06_200", "RMS(E_{j}) / Mean(E_{j}) vs |cos#theta|", nRegionBins, pRegionBinEdges);
  h_200_CT_DR06_E_RMS_summary_histogram ->SetYTitle("RMS(E_{j}) / Mean(E_{j}) [%]");
  h_200_CT_DR06_E_RMS_summary_histogram->SetXTitle("|cos#theta|");
  h_200_CT_DR06_E_RMS_summary_histogram->SetLineWidth(2);
  h_200_CT_DR06_E_RMS_summary_histogram->SetLineColor(kYellow+1);
  h_200_CT_DR06_E_RMS_summary_histogram->SetLineStyle(2);

  TH1F* h_200_CT_DR06_E_JER_Mean_summary_histogram=new TH1F("JER_MeanVsCosTheta_CT_DR06_200", "Mean(E_{tot}^{RECO}/E_{tot}^{true}) vs |cos#theta|", nRegionBins, pRegionBinEdges);
  h_200_CT_DR06_E_JER_Mean_summary_histogram->SetYTitle("Mean(E_{tot}^{RECO}/E_{tot}^{true})");
  h_200_CT_DR06_E_JER_Mean_summary_histogram->SetXTitle("|cos#theta|");
  h_200_CT_DR06_E_JER_Mean_summary_histogram->SetLineWidth(2);
  h_200_CT_DR06_E_JER_Mean_summary_histogram->SetLineColor(kYellow+1);
  h_200_CT_DR06_E_JER_Mean_summary_histogram->SetLineStyle(2);
  firstbin=72;
  for(int i=firstbin;i<(firstbin+13);i++){
    //continue;
    resolutionTH1=0; 
    resolutionErrorTH1=0;
    meanTH1=0;
    meanErrorTH1=0;
    CalculatePerformance( hist_vec_200_CT[i], resolutionTH1, resolutionErrorTH1,meanTH1,meanErrorTH1);
    h_200_CT_DR06_E_RMS90_summary_histogram->SetBinContent(i-firstbin+1,resolutionTH1/sqrt(2.));
    h_200_CT_DR06_E_RMS90_summary_histogram ->SetBinError(i-firstbin+1, resolutionErrorTH1/sqrt(2.));
    h_200_CT_DR06_E_RMS_summary_histogram->SetBinContent(i-firstbin+1,hist_vec_200_CT[i]->GetRMS()*100. );
    h_200_CT_DR06_E_RMS_summary_histogram ->SetBinError(i-firstbin+1, hist_vec_200_CT[i]->GetRMSError()*100.);
    h_200_CT_DR06_E_JER_Mean_summary_histogram->SetBinContent(i-firstbin+1,hist_vec_200_CT[i]->GetMean());
    h_200_CT_DR06_E_JER_Mean_summary_histogram->SetBinError(i-firstbin+1,hist_vec_200_CT[i]->GetMeanError());
   //double sided crystal ball
    TF1* fit_gaus_tmp = new TF1("fit_gaus_tmp", "gaus",0.50,1.50);
    hist_vec_200_CT[i]->Fit("fit_gaus_tmp","R");
    hist_vec_200_CT[i]->GetFunction("fit_gaus_tmp");
    TF1* fdscb_tmp = new TF1("fdscb_tmp",fnc_dscb,0.,3.,7);
   fdscb_tmp->SetNpx(1000);
    fdscb_tmp->SetParameter(0,fit_gaus_tmp->GetParameter(0));
    //norm
    fdscb_tmp->SetParLimits (0,0.5*fit_gaus_tmp->GetParameter(0),1.5*fit_gaus_tmp->GetParameter(0));
    fdscb_tmp->SetParameter(1,fit_gaus_tmp->GetParameter(1));
    //gaussian mean
    fdscb_tmp->SetParLimits (1,0.8,1.2);
    //fdscb_tmp->SetParameter(2,fit_gaus_tmp->GetParameter(2));
    //fdscb_tmp->SetParLimits(2,fit_gaus_tmp->GetParameter(2)*0.50,1.50*fit_gaus_tmp->GetParameter(2));
    std::vector<float>sigma2SFit=sigmaGaussianFits2Sigma(hist_vec_200_CT[i]);
    fdscb_tmp->SetParameter(2,sigma2SFit[0]);
    fdscb_tmp->SetParLimits(2,sigma2SFit[0]*0.50,1.50*sigma2SFit[0]);
    //-a1: parameter, from when the gaussian core should count
    fdscb_tmp->SetParameter(2,fit_gaus_tmp->GetParameter(2));
    fdscb_tmp->SetParameter (3,3.0);
    fdscb_tmp->SetParLimits (3,0.0,10.0);
    //a2 parameter, up to when the gaussian core should count
    fdscb_tmp->SetParameter (5,3.0);
    fdscb_tmp->SetParLimits (5,0.0,10.0);
    fdscb_tmp->SetParameter(4,5.);
    fdscb_tmp->SetParLimits(4,0.,25.);
    fdscb_tmp->SetParameter(6,5.);
    fdscb_tmp->SetParLimits(6,0.,25.);
    int fitstatus(0); 
    fitstatus = hist_vec_200_CT[i]->Fit(fdscb_tmp,"R");
    fdscb_tmp = hist_vec_200_CT[i]->GetFunction("fdscb_tmp");
    h_200_CT_DR06_E_SigmaCB_summary_histogram->SetBinContent(i-firstbin+1,fdscb_tmp->GetParameter(2)*100. );
    h_200_CT_DR06_E_SigmaCB_summary_histogram->SetBinError(i-firstbin+1,fdscb_tmp->GetParError(2)*100. );
  }  
  TH1F* h_200_CT_DR07_E_SigmaCB_summary_histogram=new TH1F("JER_SigmaCBVsCosTheta_CT_DR07_200", "#sigma (E_{j}^{reco} / E_{j}^{true}) vs |cos#theta|", nRegionBins, pRegionBinEdges);
  h_200_CT_DR07_E_SigmaCB_summary_histogram ->SetYTitle("#sigma(E_{j}) / E_{j} [%]");
  h_200_CT_DR07_E_SigmaCB_summary_histogram->SetXTitle("|cos#theta|");
  h_200_CT_DR07_E_SigmaCB_summary_histogram->SetLineWidth(2);
  h_200_CT_DR07_E_SigmaCB_summary_histogram->SetLineColor(kYellow+1);
  h_200_CT_DR07_E_SigmaCB_summary_histogram->SetLineStyle(2);
  TH1F* h_200_CT_DR07_E_RMS90_summary_histogram=new TH1F("JER_RMS90VsCosTheta_CT_DR07_200", "RMS_{90}(E_{j}^{reco}/E_{j}^{gen}) / Mean_{90}(E_{j}^{reco}/E_{j}^{gen}) vs |cos#theta|", nRegionBins, pRegionBinEdges);
  h_200_CT_DR07_E_RMS90_summary_histogram ->SetYTitle("RMS_{90}(E_{j}^{reco}/E_{j}^{gen}) / Mean_{90}(E_{j}^{reco}/E_{j}^{gen}) [%]");
  h_200_CT_DR07_E_RMS90_summary_histogram->SetXTitle("|cos#theta|");
  h_200_CT_DR07_E_RMS90_summary_histogram->SetLineWidth(2);
  h_200_CT_DR07_E_RMS90_summary_histogram->SetLineColor(kYellow+1);
  h_200_CT_DR07_E_RMS90_summary_histogram->SetLineStyle(2);

  TH1F* h_200_CT_DR07_E_RMS_summary_histogram=new TH1F("JER_RMSVsCosTheta_CT_DR07_200", "RMS(E_{j}) / Mean(E_{j}) vs |cos#theta|", nRegionBins, pRegionBinEdges);
  h_200_CT_DR07_E_RMS_summary_histogram ->SetYTitle("RMS(E_{j}) / Mean(E_{j}) [%]");
  h_200_CT_DR07_E_RMS_summary_histogram->SetXTitle("|cos#theta|");
  h_200_CT_DR07_E_RMS_summary_histogram->SetLineWidth(2);
  h_200_CT_DR07_E_RMS_summary_histogram->SetLineColor(kYellow+1);
  h_200_CT_DR07_E_RMS_summary_histogram->SetLineStyle(2);

  TH1F* h_200_CT_DR07_E_JER_Mean_summary_histogram=new TH1F("JER_MeanVsCosTheta_CT_DR07_200", "Mean(E_{tot}^{RECO}/E_{tot}^{true}) vs |cos#theta|", nRegionBins, pRegionBinEdges);
  h_200_CT_DR07_E_JER_Mean_summary_histogram->SetYTitle("Mean(E_{tot}^{RECO}/E_{tot}^{true})");
  h_200_CT_DR07_E_JER_Mean_summary_histogram->SetXTitle("|cos#theta|");
  h_200_CT_DR07_E_JER_Mean_summary_histogram->SetLineWidth(2);
  h_200_CT_DR07_E_JER_Mean_summary_histogram->SetLineColor(kYellow+1);
  h_200_CT_DR07_E_JER_Mean_summary_histogram->SetLineStyle(2);

  firstbin=85;
  for(int i=firstbin;i<(firstbin+13);i++){
    //continue;
    resolutionTH1=0; 
    resolutionErrorTH1=0;
    meanTH1=0;
    meanErrorTH1=0;
    CalculatePerformance( hist_vec_200_CT[i], resolutionTH1, resolutionErrorTH1,meanTH1,meanErrorTH1);
    h_200_CT_DR07_E_RMS90_summary_histogram->SetBinContent(i-firstbin+1,resolutionTH1/sqrt(2.));
    h_200_CT_DR07_E_RMS90_summary_histogram ->SetBinError(i-firstbin+1, resolutionErrorTH1/sqrt(2.));
    h_200_CT_DR07_E_RMS_summary_histogram->SetBinContent(i-firstbin+1,hist_vec_200_CT[i]->GetRMS()*100. );
    h_200_CT_DR07_E_RMS_summary_histogram ->SetBinError(i-firstbin+1, hist_vec_200_CT[i]->GetRMSError()*100.);
    h_200_CT_DR07_E_JER_Mean_summary_histogram->SetBinContent(i-firstbin+1,hist_vec_200_CT[i]->GetMean());
    h_200_CT_DR07_E_JER_Mean_summary_histogram->SetBinError(i-firstbin+1,hist_vec_200_CT[i]->GetMeanError());
   //double sided crystal ball
    TF1* fit_gaus_tmp = new TF1("fit_gaus_tmp", "gaus",0.50,1.50);
    hist_vec_200_CT[i]->Fit("fit_gaus_tmp","R");
    hist_vec_200_CT[i]->GetFunction("fit_gaus_tmp");
    TF1* fdscb_tmp = new TF1("fdscb_tmp",fnc_dscb,0.,3.,7);
   fdscb_tmp->SetNpx(1000);
    fdscb_tmp->SetParameter(0,fit_gaus_tmp->GetParameter(0));
    //norm
    fdscb_tmp->SetParLimits (0,0.5*fit_gaus_tmp->GetParameter(0),1.5*fit_gaus_tmp->GetParameter(0));
    fdscb_tmp->SetParameter(1,fit_gaus_tmp->GetParameter(1));
    //gaussian mean
    fdscb_tmp->SetParLimits (1,0.8,1.2);
    //fdscb_tmp->SetParameter(2,fit_gaus_tmp->GetParameter(2));
    //fdscb_tmp->SetParLimits(2,fit_gaus_tmp->GetParameter(2)*0.50,1.50*fit_gaus_tmp->GetParameter(2));
    std::vector<float>sigma2SFit=sigmaGaussianFits2Sigma(hist_vec_200_CT[i]);
    fdscb_tmp->SetParameter(2,sigma2SFit[0]);
    fdscb_tmp->SetParLimits(2,sigma2SFit[0]*0.50,1.50*sigma2SFit[0]);
    //-a1: parameter, from when the gaussian core should count
    fdscb_tmp->SetParameter(2,fit_gaus_tmp->GetParameter(2));
    fdscb_tmp->SetParameter (3,3.0);
    fdscb_tmp->SetParLimits (3,0.0,10.0);
    //a2 parameter, up to when the gaussian core should count
    fdscb_tmp->SetParameter (5,3.0);
    fdscb_tmp->SetParLimits (5,0.0,10.0);
    fdscb_tmp->SetParameter(4,5.);
    fdscb_tmp->SetParLimits(4,0.,25.);
    fdscb_tmp->SetParameter(6,5.);
    fdscb_tmp->SetParLimits(6,0.,25.);
    int fitstatus(0); 
    fitstatus = hist_vec_200_CT[i]->Fit(fdscb_tmp,"R");
    fdscb_tmp = hist_vec_200_CT[i]->GetFunction("fdscb_tmp");
    h_200_CT_DR07_E_SigmaCB_summary_histogram->SetBinContent(i-firstbin+1,fdscb_tmp->GetParameter(2)*100. );
    h_200_CT_DR07_E_SigmaCB_summary_histogram->SetBinError(i-firstbin+1,fdscb_tmp->GetParError(2)*100. );
  }  

  TH1F* h_200_CT_DR08_E_SigmaCB_summary_histogram=new TH1F("JER_SigmaCBVsCosTheta_CT_DR08_200", "#sigma (E_{j}^{reco} / E_{j}^{true}) vs |cos#theta|", nRegionBins, pRegionBinEdges);
  h_200_CT_DR08_E_SigmaCB_summary_histogram ->SetYTitle("#sigma(E_{j}) / E_{j} [%]");
  h_200_CT_DR08_E_SigmaCB_summary_histogram->SetXTitle("|cos#theta|");
  h_200_CT_DR08_E_SigmaCB_summary_histogram->SetLineWidth(2);
  h_200_CT_DR08_E_SigmaCB_summary_histogram->SetLineColor(kYellow+1);
  h_200_CT_DR08_E_SigmaCB_summary_histogram->SetLineStyle(2);

  TH1F* h_200_CT_DR08_E_RMS90_summary_histogram=new TH1F("JER_RMS90VsCosTheta_CT_DR08_200", "RMS_{90}(E_{j}^{reco}/E_{j}^{gen}) / Mean_{90}(E_{j}^{reco}/E_{j}^{gen}) vs |cos#theta|", nRegionBins, pRegionBinEdges);
  h_200_CT_DR08_E_RMS90_summary_histogram ->SetYTitle("RMS_{90}(E_{j}^{reco}/E_{j}^{gen}) / Mean_{90}(E_{j}^{reco}/E_{j}^{gen}) [%]");
  h_200_CT_DR08_E_RMS90_summary_histogram->SetXTitle("|cos#theta|");
  h_200_CT_DR08_E_RMS90_summary_histogram->SetLineWidth(2);
  h_200_CT_DR08_E_RMS90_summary_histogram->SetLineColor(kYellow+1);
  h_200_CT_DR08_E_RMS90_summary_histogram->SetLineStyle(2);

  TH1F* h_200_CT_DR08_E_RMS_summary_histogram=new TH1F("JER_RMSVsCosTheta_CT_DR08_200", "RMS(E_{j}) / Mean(E_{j}) vs |cos#theta|", nRegionBins, pRegionBinEdges);
  h_200_CT_DR08_E_RMS_summary_histogram ->SetYTitle("RMS(E_{j}) / Mean(E_{j}) [%]");
  h_200_CT_DR08_E_RMS_summary_histogram->SetXTitle("|cos#theta|");
  h_200_CT_DR08_E_RMS_summary_histogram->SetLineWidth(2);
  h_200_CT_DR08_E_RMS_summary_histogram->SetLineColor(kYellow+1);
  h_200_CT_DR08_E_RMS_summary_histogram->SetLineStyle(2);

  TH1F* h_200_CT_DR08_E_JER_Mean_summary_histogram=new TH1F("JER_MeanVsCosTheta_CT_DR08_200", "Mean(E_{tot}^{RECO}/E_{tot}^{true}) vs |cos#theta|", nRegionBins, pRegionBinEdges);
  h_200_CT_DR08_E_JER_Mean_summary_histogram->SetYTitle("Mean(E_{tot}^{RECO}/E_{tot}^{true})");
  h_200_CT_DR08_E_JER_Mean_summary_histogram->SetXTitle("|cos#theta|");
  h_200_CT_DR08_E_JER_Mean_summary_histogram->SetLineWidth(2);
  h_200_CT_DR08_E_JER_Mean_summary_histogram->SetLineColor(kYellow+1);
  h_200_CT_DR08_E_JER_Mean_summary_histogram->SetLineStyle(2);
  firstbin=98;
  for(int i=firstbin;i<(firstbin+13);i++){
    //continue;
    resolutionTH1=0; 
    resolutionErrorTH1=0;
    meanTH1=0;
    meanErrorTH1=0;
    CalculatePerformance( hist_vec_200_CT[i], resolutionTH1, resolutionErrorTH1,meanTH1,meanErrorTH1);
    h_200_CT_DR08_E_RMS90_summary_histogram->SetBinContent(i-firstbin+1,resolutionTH1/sqrt(2.));
    h_200_CT_DR08_E_RMS90_summary_histogram ->SetBinError(i-firstbin+1, resolutionErrorTH1/sqrt(2.));
    h_200_CT_DR08_E_RMS_summary_histogram->SetBinContent(i-firstbin+1,hist_vec_200_CT[i]->GetRMS()*100. );
    h_200_CT_DR08_E_RMS_summary_histogram ->SetBinError(i-firstbin+1, hist_vec_200_CT[i]->GetRMSError()*100.);
    h_200_CT_DR08_E_JER_Mean_summary_histogram->SetBinContent(i-firstbin+1,hist_vec_200_CT[i]->GetMean());
    h_200_CT_DR08_E_JER_Mean_summary_histogram->SetBinError(i-firstbin+1,hist_vec_200_CT[i]->GetMeanError());
   //double sided crystal ball
    TF1* fit_gaus_tmp = new TF1("fit_gaus_tmp", "gaus",0.50,1.50);
    hist_vec_200_CT[i]->Fit("fit_gaus_tmp","R");
    hist_vec_200_CT[i]->GetFunction("fit_gaus_tmp");
    TF1* fdscb_tmp = new TF1("fdscb_tmp",fnc_dscb,0.,3.,7);
   fdscb_tmp->SetNpx(1000);
    fdscb_tmp->SetParameter(0,fit_gaus_tmp->GetParameter(0));
    //norm
    fdscb_tmp->SetParLimits (0,0.5*fit_gaus_tmp->GetParameter(0),1.5*fit_gaus_tmp->GetParameter(0));
    fdscb_tmp->SetParameter(1,fit_gaus_tmp->GetParameter(1));
    //gaussian mean
    fdscb_tmp->SetParLimits (1,0.8,1.2);
    //fdscb_tmp->SetParameter(2,fit_gaus_tmp->GetParameter(2));
    //fdscb_tmp->SetParLimits(2,fit_gaus_tmp->GetParameter(2)*0.50,1.50*fit_gaus_tmp->GetParameter(2));
    std::vector<float>sigma2SFit=sigmaGaussianFits2Sigma(hist_vec_200_CT[i]);
    fdscb_tmp->SetParameter(2,sigma2SFit[0]);
    fdscb_tmp->SetParLimits(2,sigma2SFit[0]*0.50,1.50*sigma2SFit[0]);
    //-a1: parameter, from when the gaussian core should count
    fdscb_tmp->SetParameter(2,fit_gaus_tmp->GetParameter(2));
    fdscb_tmp->SetParameter (3,3.0);
    fdscb_tmp->SetParLimits (3,0.0,10.0);
    //a2 parameter, up to when the gaussian core should count
    fdscb_tmp->SetParameter (5,3.0);
    fdscb_tmp->SetParLimits (5,0.0,10.0);
    fdscb_tmp->SetParameter(4,5.);
    fdscb_tmp->SetParLimits(4,0.,25.);
    fdscb_tmp->SetParameter(6,5.);
    fdscb_tmp->SetParLimits(6,0.,25.);
    int fitstatus(0); 
    fitstatus = hist_vec_200_CT[i]->Fit(fdscb_tmp,"R");
    fdscb_tmp = hist_vec_200_CT[i]->GetFunction("fdscb_tmp");
    h_200_CT_DR08_E_SigmaCB_summary_histogram->SetBinContent(i-firstbin+1,fdscb_tmp->GetParameter(2)*100. );
    h_200_CT_DR08_E_SigmaCB_summary_histogram->SetBinError(i-firstbin+1,fdscb_tmp->GetParError(2)*100. );
  }  
  TH1F* h_200_CT_DR09_E_SigmaCB_summary_histogram=new TH1F("JER_SigmaCBVsCosTheta_CT_DR09_200", "#sigma (E_{j}^{reco} / E_{j}^{true}) vs |cos#theta|", nRegionBins, pRegionBinEdges);
  h_200_CT_DR09_E_SigmaCB_summary_histogram ->SetYTitle("#sigma(E_{j}) / E_{j} [%]");
  h_200_CT_DR09_E_SigmaCB_summary_histogram->SetXTitle("|cos#theta|");
  h_200_CT_DR09_E_SigmaCB_summary_histogram->SetLineWidth(2);
  h_200_CT_DR09_E_SigmaCB_summary_histogram->SetLineColor(kYellow+1);
  h_200_CT_DR09_E_SigmaCB_summary_histogram->SetLineStyle(2);
  TH1F* h_200_CT_DR09_E_RMS90_summary_histogram=new TH1F("JER_RMS90VsCosTheta_CT_DR09_200", "RMS_{90}(E_{j}^{reco}/E_{j}^{gen}) / Mean_{90}(E_{j}^{reco}/E_{j}^{gen}) vs |cos#theta|", nRegionBins, pRegionBinEdges);
  h_200_CT_DR09_E_RMS90_summary_histogram ->SetYTitle("RMS_{90}(E_{j}^{reco}/E_{j}^{gen}) / Mean_{90}(E_{j}^{reco}/E_{j}^{gen}) [%]");
  h_200_CT_DR09_E_RMS90_summary_histogram->SetXTitle("|cos#theta|");
  h_200_CT_DR09_E_RMS90_summary_histogram->SetLineWidth(2);
  h_200_CT_DR09_E_RMS90_summary_histogram->SetLineColor(kYellow+1);
  h_200_CT_DR09_E_RMS90_summary_histogram->SetLineStyle(2);

  TH1F* h_200_CT_DR09_E_RMS_summary_histogram=new TH1F("JER_RMSVsCosTheta_CT_DR09_200", "RMS(E_{j}) / Mean(E_{j}) vs |cos#theta|", nRegionBins, pRegionBinEdges);
  h_200_CT_DR09_E_RMS_summary_histogram ->SetYTitle("RMS(E_{j}) / Mean(E_{j}) [%]");
  h_200_CT_DR09_E_RMS_summary_histogram->SetXTitle("|cos#theta|");
  h_200_CT_DR09_E_RMS_summary_histogram->SetLineWidth(2);
  h_200_CT_DR09_E_RMS_summary_histogram->SetLineColor(kYellow+1);
  h_200_CT_DR09_E_RMS_summary_histogram->SetLineStyle(2);

  TH1F* h_200_CT_DR09_E_JER_Mean_summary_histogram=new TH1F("JER_MeanVsCosTheta_CT_DR09_200", "Mean(E_{tot}^{RECO}/E_{tot}^{true}) vs |cos#theta|", nRegionBins, pRegionBinEdges);
  h_200_CT_DR09_E_JER_Mean_summary_histogram->SetYTitle("Mean(E_{tot}^{RECO}/E_{tot}^{true})");
  h_200_CT_DR09_E_JER_Mean_summary_histogram->SetXTitle("|cos#theta|");
  h_200_CT_DR09_E_JER_Mean_summary_histogram->SetLineWidth(2);
  h_200_CT_DR09_E_JER_Mean_summary_histogram->SetLineColor(kYellow+1);
  h_200_CT_DR09_E_JER_Mean_summary_histogram->SetLineStyle(2);
  firstbin=111;
  for(int i=firstbin;i<(firstbin+13);i++){
    //continue;
    resolutionTH1=0; 
    resolutionErrorTH1=0;
    meanTH1=0;
    meanErrorTH1=0;
    CalculatePerformance( hist_vec_200_CT[i], resolutionTH1, resolutionErrorTH1,meanTH1,meanErrorTH1);
    h_200_CT_DR09_E_RMS90_summary_histogram->SetBinContent(i-firstbin+1,resolutionTH1/sqrt(2.));
    h_200_CT_DR09_E_RMS90_summary_histogram ->SetBinError(i-firstbin+1, resolutionErrorTH1/sqrt(2.));
    h_200_CT_DR09_E_RMS_summary_histogram->SetBinContent(i-firstbin+1,hist_vec_200_CT[i]->GetRMS()*100. );
    h_200_CT_DR09_E_RMS_summary_histogram ->SetBinError(i-firstbin+1, hist_vec_200_CT[i]->GetRMSError()*100.);
    h_200_CT_DR09_E_JER_Mean_summary_histogram->SetBinContent(i-firstbin+1,hist_vec_200_CT[i]->GetMean());
    h_200_CT_DR09_E_JER_Mean_summary_histogram->SetBinError(i-firstbin+1,hist_vec_200_CT[i]->GetMeanError());
   //double sided crystal ball
    TF1* fit_gaus_tmp = new TF1("fit_gaus_tmp", "gaus",0.50,1.50);
    hist_vec_200_CT[i]->Fit("fit_gaus_tmp","R");
    hist_vec_200_CT[i]->GetFunction("fit_gaus_tmp");
    TF1* fdscb_tmp = new TF1("fdscb_tmp",fnc_dscb,0.,3.,7);
   fdscb_tmp->SetNpx(1000);
    fdscb_tmp->SetParameter(0,fit_gaus_tmp->GetParameter(0));
    //norm
    fdscb_tmp->SetParLimits (0,0.5*fit_gaus_tmp->GetParameter(0),1.5*fit_gaus_tmp->GetParameter(0));
    fdscb_tmp->SetParameter(1,fit_gaus_tmp->GetParameter(1));
    //gaussian mean
    fdscb_tmp->SetParLimits (1,0.8,1.2);
    //fdscb_tmp->SetParameter(2,fit_gaus_tmp->GetParameter(2));
    //fdscb_tmp->SetParLimits(2,fit_gaus_tmp->GetParameter(2)*0.50,1.50*fit_gaus_tmp->GetParameter(2));
    std::vector<float>sigma2SFit=sigmaGaussianFits2Sigma(hist_vec_200_CT[i]);
    fdscb_tmp->SetParameter(2,sigma2SFit[0]);
    fdscb_tmp->SetParLimits(2,sigma2SFit[0]*0.50,1.50*sigma2SFit[0]);
    //-a1: parameter, from when the gaussian core should count
    fdscb_tmp->SetParameter(2,fit_gaus_tmp->GetParameter(2));
    fdscb_tmp->SetParameter (3,3.0);
    fdscb_tmp->SetParLimits (3,0.0,10.0);
    //a2 parameter, up to when the gaussian core should count
    fdscb_tmp->SetParameter (5,3.0);
    fdscb_tmp->SetParLimits (5,0.0,10.0);
    fdscb_tmp->SetParameter(4,5.);
    fdscb_tmp->SetParLimits(4,0.,25.);
    fdscb_tmp->SetParameter(6,5.);
    fdscb_tmp->SetParLimits(6,0.,25.);
    int fitstatus(0); 
    fitstatus = hist_vec_200_CT[i]->Fit(fdscb_tmp,"R");
    fdscb_tmp = hist_vec_200_CT[i]->GetFunction("fdscb_tmp");
    h_200_CT_DR09_E_SigmaCB_summary_histogram->SetBinContent(i-firstbin+1,fdscb_tmp->GetParameter(2)*100. );
    h_200_CT_DR09_E_SigmaCB_summary_histogram->SetBinError(i-firstbin+1,fdscb_tmp->GetParError(2)*100. );
  }  
  TH1F* h_200_CT_DR10_E_SigmaCB_summary_histogram=new TH1F("JER_SigmaCBVsCosTheta_CT_DR10_200", "#sigma (E_{j}^{reco} / E_{j}^{true}) vs |cos#theta|", nRegionBins, pRegionBinEdges);
  h_200_CT_DR10_E_SigmaCB_summary_histogram ->SetYTitle("#sigma(E_{j}) / E_{j} [%]");
  h_200_CT_DR10_E_SigmaCB_summary_histogram->SetXTitle("|cos#theta|");
  h_200_CT_DR10_E_SigmaCB_summary_histogram->SetLineWidth(2);
  h_200_CT_DR10_E_SigmaCB_summary_histogram->SetLineColor(kYellow+1);
  h_200_CT_DR10_E_SigmaCB_summary_histogram->SetLineStyle(2);
  TH1F* h_200_CT_DR10_E_RMS90_summary_histogram=new TH1F("JER_RMS90VsCosTheta_CT_DR10_200", "RMS_{90}(E_{j}^{reco}/E_{j}^{gen}) / Mean_{90}(E_{j}^{reco}/E_{j}^{gen}) vs |cos#theta|", nRegionBins, pRegionBinEdges);
  h_200_CT_DR10_E_RMS90_summary_histogram ->SetYTitle("RMS_{90}(E_{j}^{reco}/E_{j}^{gen}) / Mean_{90}(E_{j}^{reco}/E_{j}^{gen}) [%]");
  h_200_CT_DR10_E_RMS90_summary_histogram->SetXTitle("|cos#theta|");
  h_200_CT_DR10_E_RMS90_summary_histogram->SetLineWidth(2);
  h_200_CT_DR10_E_RMS90_summary_histogram->SetLineColor(kYellow+1);
  h_200_CT_DR10_E_RMS90_summary_histogram->SetLineStyle(2);

  TH1F* h_200_CT_DR10_E_RMS_summary_histogram=new TH1F("JER_RMSVsCosTheta_CT_DR10_200", "RMS(E_{j}) / Mean(E_{j}) vs |cos#theta|", nRegionBins, pRegionBinEdges);
  h_200_CT_DR10_E_RMS_summary_histogram ->SetYTitle("RMS(E_{j}) / Mean(E_{j}) [%]");
  h_200_CT_DR10_E_RMS_summary_histogram->SetXTitle("|cos#theta|");
  h_200_CT_DR10_E_RMS_summary_histogram->SetLineWidth(2);
  h_200_CT_DR10_E_RMS_summary_histogram->SetLineColor(kYellow+1);
  h_200_CT_DR10_E_RMS_summary_histogram->SetLineStyle(2);

  TH1F* h_200_CT_DR10_E_JER_Mean_summary_histogram=new TH1F("JER_MeanVsCosTheta_CT_DR10_200", "Mean(E_{tot}^{RECO}/E_{tot}^{true}) vs |cos#theta|", nRegionBins, pRegionBinEdges);
  h_200_CT_DR10_E_JER_Mean_summary_histogram->SetYTitle("Mean(E_{tot}^{RECO}/E_{tot}^{true})");
  h_200_CT_DR10_E_JER_Mean_summary_histogram->SetXTitle("|cos#theta|");
  h_200_CT_DR10_E_JER_Mean_summary_histogram->SetLineWidth(2);
  h_200_CT_DR10_E_JER_Mean_summary_histogram->SetLineColor(kYellow+1);
  h_200_CT_DR10_E_JER_Mean_summary_histogram->SetLineStyle(2);
  firstbin=124;
  for(int i=firstbin;i<(firstbin+13);i++){
    //continue;
    resolutionTH1=0; 
    resolutionErrorTH1=0;
    meanTH1=0;
    meanErrorTH1=0;
    CalculatePerformance( hist_vec_200_CT[i], resolutionTH1, resolutionErrorTH1,meanTH1,meanErrorTH1);
    h_200_CT_DR10_E_RMS90_summary_histogram->SetBinContent(i-firstbin+1,resolutionTH1/sqrt(2.));
    h_200_CT_DR10_E_RMS90_summary_histogram ->SetBinError(i-firstbin+1, resolutionErrorTH1/sqrt(2.));
    h_200_CT_DR10_E_RMS_summary_histogram->SetBinContent(i-firstbin+1,hist_vec_200_CT[i]->GetRMS()*100. );
    h_200_CT_DR10_E_RMS_summary_histogram ->SetBinError(i-firstbin+1, hist_vec_200_CT[i]->GetRMSError()*100.);
    h_200_CT_DR10_E_JER_Mean_summary_histogram->SetBinContent(i-firstbin+1,hist_vec_200_CT[i]->GetMean());
    h_200_CT_DR10_E_JER_Mean_summary_histogram->SetBinError(i-firstbin+1,hist_vec_200_CT[i]->GetMeanError());
   //double sided crystal ball
    TF1* fit_gaus_tmp = new TF1("fit_gaus_tmp", "gaus",0.50,1.50);
    hist_vec_200_CT[i]->Fit("fit_gaus_tmp","R");
    hist_vec_200_CT[i]->GetFunction("fit_gaus_tmp");
    TF1* fdscb_tmp = new TF1("fdscb_tmp",fnc_dscb,0.,3.,7);
   fdscb_tmp->SetNpx(1000);
    fdscb_tmp->SetParameter(0,fit_gaus_tmp->GetParameter(0));
    //norm
    fdscb_tmp->SetParLimits (0,0.5*fit_gaus_tmp->GetParameter(0),1.5*fit_gaus_tmp->GetParameter(0));
    fdscb_tmp->SetParameter(1,fit_gaus_tmp->GetParameter(1));
    //gaussian mean
    fdscb_tmp->SetParLimits (1,0.8,1.2);
    //fdscb_tmp->SetParameter(2,fit_gaus_tmp->GetParameter(2));
    //fdscb_tmp->SetParLimits(2,fit_gaus_tmp->GetParameter(2)*0.50,1.50*fit_gaus_tmp->GetParameter(2));
    std::vector<float>sigma2SFit=sigmaGaussianFits2Sigma(hist_vec_200_CT[i]);
    fdscb_tmp->SetParameter(2,sigma2SFit[0]);
    fdscb_tmp->SetParLimits(2,sigma2SFit[0]*0.50,1.50*sigma2SFit[0]);
    //-a1: parameter, from when the gaussian core should count
    fdscb_tmp->SetParameter(2,fit_gaus_tmp->GetParameter(2));
    fdscb_tmp->SetParameter (3,3.0);
    fdscb_tmp->SetParLimits (3,0.0,10.0);
    //a2 parameter, up to when the gaussian core should count
    fdscb_tmp->SetParameter (5,3.0);
    fdscb_tmp->SetParLimits (5,0.0,10.0);
    fdscb_tmp->SetParameter(4,5.);
    fdscb_tmp->SetParLimits(4,0.,25.);
    fdscb_tmp->SetParameter(6,5.);
    fdscb_tmp->SetParLimits(6,0.,25.);
    int fitstatus(0); 
    fitstatus = hist_vec_200_CT[i]->Fit(fdscb_tmp,"R");
    fdscb_tmp = hist_vec_200_CT[i]->GetFunction("fdscb_tmp");
    h_200_CT_DR10_E_SigmaCB_summary_histogram->SetBinContent(i-firstbin+1,fdscb_tmp->GetParameter(2)*100. );
    h_200_CT_DR10_E_SigmaCB_summary_histogram->SetBinError(i-firstbin+1,fdscb_tmp->GetParError(2)*100. );
  }  


  std::cout<<"200 03/04/05/06 "<< calculate_over90(h_200_CT_recojet03_E1_E2_over_E_True)<<"/"<< calculate_over90(h_200_CT_recojet04_E1_E2_over_E_True)<<"/"<< calculate_over90(h_200_CT_recojet05_E1_E2_over_E_True)<<"/"<<calculate_over90(h_200_CT_recojet06_E1_E2_over_E_True)<<" 07/08/09/10 "<< calculate_over90(h_200_CT_recojet07_E1_E2_over_E_True)<<"/"<< calculate_over90(h_200_CT_recojet08_E1_E2_over_E_True)<<"/"<< calculate_over90(h_200_CT_recojet09_E1_E2_over_E_True)<<"/"<<calculate_over90(h_200_CT_recojet10_E1_E2_over_E_True)<<std::endl;
  std::cout<<"jet histos 200 CT filled"<<std::endl;



  TH1F* h_200_CT_wO_genjet03_dphi_j1j2 =  new TH1F("h_200_CT_wO_genjet03_dphi_j1j2","", n_bins100, 0.5,TMath::Pi());
  TH1F* h_200_CT_wO_genjet03_E1_E2_over_E_True =  new TH1F("h_200_CT_wO_genjet03_E1_E2_over_E_True","", n_bins100, 0.5,1.00);
  TH1F* h_200_CT_wO_genjet03_Delta_E1_E2_over_E12 =  new TH1F("h_200_CT_wO_genjet03_Delta_E1_E2_over_E12","", n_bins100, -0.5,0.5);
  TH1F* h_200_CT_wO_genjet04_dphi_j1j2 =  new TH1F("h_200_CT_wO_genjet04_dphi_j1j2","", n_bins100, 0.5,TMath::Pi());
  TH1F* h_200_CT_wO_genjet04_E1_E2_over_E_True =  new TH1F("h_200_CT_wO_genjet04_E1_E2_over_E_True","", n_bins100, 0.5,1.00);
  TH1F* h_200_CT_wO_genjet04_Delta_E1_E2_over_E12 =  new TH1F("h_200_CT_wO_genjet04_Delta_E1_E2_over_E12","", n_bins100, -0.5,0.5);
  TH1F* h_200_CT_wO_genjet05_dphi_j1j2 =  new TH1F("h_200_CT_wO_genjet05_dphi_j1j2","", n_bins100, 0.5,TMath::Pi());
  TH1F* h_200_CT_wO_genjet05_E1_E2_over_E_True =  new TH1F("h_200_CT_wO_genjet05_E1_E2_over_E_True","", n_bins100, 0.5,1.00);
  TH1F* h_200_CT_wO_genjet05_Delta_E1_E2_over_E12 =  new TH1F("h_200_CT_wO_genjet05_Delta_E1_E2_over_E12","", n_bins100, -0.5,0.5);
  TH1F* h_200_CT_wO_genjet06_dphi_j1j2 =  new TH1F("h_200_CT_wO_genjet06_dphi_j1j2","", n_bins100, 0.5,TMath::Pi());
  TH1F* h_200_CT_wO_genjet06_E1_E2_over_E_True =  new TH1F("h_200_CT_wO_genjet06_E1_E2_over_E_True","", n_bins100, 0.5,1.00);
  TH1F* h_200_CT_wO_genjet06_Delta_E1_E2_over_E12 =  new TH1F("h_200_CT_wO_genjet06_Delta_E1_E2_over_E12","", n_bins100, -0.5,0.5);
  TH1F* h_200_CT_wO_genjet07_dphi_j1j2 =  new TH1F("h_200_CT_wO_genjet07_dphi_j1j2","", n_bins100, 0.5,TMath::Pi());
  TH1F* h_200_CT_wO_genjet07_E1_E2_over_E_True =  new TH1F("h_200_CT_wO_genjet07_E1_E2_over_E_True","", n_bins100, 0.5,1.00);
  TH1F* h_200_CT_wO_genjet07_Delta_E1_E2_over_E12 =  new TH1F("h_200_CT_wO_genjet07_Delta_E1_E2_over_E12","", n_bins100, -0.5,0.5);
  TH1F* h_200_CT_wO_genjet08_dphi_j1j2 =  new TH1F("h_200_CT_wO_genjet08_dphi_j1j2","", n_bins100, 0.5,TMath::Pi());
  TH1F* h_200_CT_wO_genjet08_E1_E2_over_E_True =  new TH1F("h_200_CT_wO_genjet08_E1_E2_over_E_True","", n_bins100, 0.5,1.00);
  TH1F* h_200_CT_wO_genjet08_Delta_E1_E2_over_E12 =  new TH1F("h_200_CT_wO_genjet08_Delta_E1_E2_over_E12","", n_bins100, -0.5,0.5);
  TH1F* h_200_CT_wO_genjet09_dphi_j1j2 =  new TH1F("h_200_CT_wO_genjet09_dphi_j1j2","", n_bins100, 0.5,TMath::Pi());
  TH1F* h_200_CT_wO_genjet09_E1_E2_over_E_True =  new TH1F("h_200_CT_wO_genjet09_E1_E2_over_E_True","", n_bins100, 0.5,1.00);
  TH1F* h_200_CT_wO_genjet09_Delta_E1_E2_over_E12 =  new TH1F("h_200_CT_wO_genjet09_Delta_E1_E2_over_E12","", n_bins100, -0.5,0.5);
  TH1F* h_200_CT_wO_genjet10_dphi_j1j2 =  new TH1F("h_200_CT_wO_genjet10_dphi_j1j2","", n_bins100, 0.5,TMath::Pi());
  TH1F* h_200_CT_wO_genjet10_E1_E2_over_E_True =  new TH1F("h_200_CT_wO_genjet10_E1_E2_over_E_True","", n_bins100, 0.5,1.00);
  TH1F* h_200_CT_wO_genjet10_Delta_E1_E2_over_E12 =  new TH1F("h_200_CT_wO_genjet10_Delta_E1_E2_over_E12","", n_bins100, -0.5,0.5);

  TH1F* h_200_CT_wO_recojet03_dphi_j1j2 =  new TH1F("h_200_CT_wO_recojet03_dphi_j1j2","", n_bins100, 0.5,TMath::Pi());
  TH1F* h_200_CT_wO_recojet03_E1_E2_over_E_True =  new TH1F("h_200_CT_wO_recojet03_E1_E2_over_E_True","", n_bins100, 0.5,1.00);
  TH1F* h_200_CT_wO_recojet03_Delta_E1_E2_over_E12 =  new TH1F("h_200_CT_wO_recojet03_Delta_E1_E2_over_E12","", n_bins100, -0.5,0.5);
  TH1F* h_200_CT_wO_recojet04_dphi_j1j2 =  new TH1F("h_200_CT_wO_recojet04_dphi_j1j2","", n_bins100, 0.5,TMath::Pi());
  TH1F* h_200_CT_wO_recojet04_E1_E2_over_E_True =  new TH1F("h_200_CT_wO_recojet04_E1_E2_over_E_True","", n_bins100, 0.5,1.00);
  TH1F* h_200_CT_wO_recojet04_Delta_E1_E2_over_E12 =  new TH1F("h_200_CT_wO_recojet04_Delta_E1_E2_over_E12","", n_bins100, -0.5,0.5);
  TH1F* h_200_CT_wO_recojet05_dphi_j1j2 =  new TH1F("h_200_CT_wO_recojet05_dphi_j1j2","", n_bins100, 0.5,TMath::Pi());
  TH1F* h_200_CT_wO_recojet05_E1_E2_over_E_True =  new TH1F("h_200_CT_wO_recojet05_E1_E2_over_E_True","", n_bins100, 0.5,1.00);
  TH1F* h_200_CT_wO_recojet05_Delta_E1_E2_over_E12 =  new TH1F("h_200_CT_wO_recojet05_Delta_E1_E2_over_E12","", n_bins100, -0.5,0.5);
  TH1F* h_200_CT_wO_recojet06_dphi_j1j2 =  new TH1F("h_200_CT_wO_recojet06_dphi_j1j2","", n_bins100, 0.5,TMath::Pi());
  TH1F* h_200_CT_wO_recojet06_E1_E2_over_E_True =  new TH1F("h_200_CT_wO_recojet06_E1_E2_over_E_True","", n_bins100, 0.5,1.00);
  TH1F* h_200_CT_wO_recojet06_Delta_E1_E2_over_E12 =  new TH1F("h_200_CT_wO_recojet06_Delta_E1_E2_over_E12","", n_bins100, -0.5,0.5);
  TH1F* h_200_CT_wO_recojet07_dphi_j1j2 =  new TH1F("h_200_CT_wO_recojet07_dphi_j1j2","", n_bins100, 0.5,TMath::Pi());
  TH1F* h_200_CT_wO_recojet07_E1_E2_over_E_True =  new TH1F("h_200_CT_wO_recojet07_E1_E2_over_E_True","", n_bins100, 0.5,1.00);
  TH1F* h_200_CT_wO_recojet07_Delta_E1_E2_over_E12 =  new TH1F("h_200_CT_wO_recojet07_Delta_E1_E2_over_E12","", n_bins100, -0.5,0.5);
  TH1F* h_200_CT_wO_recojet08_dphi_j1j2 =  new TH1F("h_200_CT_wO_recojet08_dphi_j1j2","", n_bins100, 0.5,TMath::Pi());
  TH1F* h_200_CT_wO_recojet08_E1_E2_over_E_True =  new TH1F("h_200_CT_wO_recojet08_E1_E2_over_E_True","", n_bins100, 0.5,1.00);
  TH1F* h_200_CT_wO_recojet08_Delta_E1_E2_over_E12 =  new TH1F("h_200_CT_wO_recojet08_Delta_E1_E2_over_E12","", n_bins100, -0.5,0.5);
  TH1F* h_200_CT_wO_recojet09_dphi_j1j2 =  new TH1F("h_200_CT_wO_recojet09_dphi_j1j2","", n_bins100, 0.5,TMath::Pi());
  TH1F* h_200_CT_wO_recojet09_E1_E2_over_E_True =  new TH1F("h_200_CT_wO_recojet09_E1_E2_over_E_True","", n_bins100, 0.5,1.00);
  TH1F* h_200_CT_wO_recojet09_Delta_E1_E2_over_E12 =  new TH1F("h_200_CT_wO_recojet09_Delta_E1_E2_over_E12","", n_bins100, -0.5,0.5);
  TH1F* h_200_CT_wO_recojet10_dphi_j1j2 =  new TH1F("h_200_CT_wO_recojet10_dphi_j1j2","", n_bins100, 0.5,TMath::Pi());
  TH1F* h_200_CT_wO_recojet10_E1_E2_over_E_True =  new TH1F("h_200_CT_wO_recojet10_E1_E2_over_E_True","", n_bins100, 0.5,1.00);
  TH1F* h_200_CT_wO_recojet10_Delta_E1_E2_over_E12 =  new TH1F("h_200_CT_wO_recojet10_Delta_E1_E2_over_E12","", n_bins100, -0.5,0.5);

  TH1F* h_200_CT_wO_recojetE_over_genjetE_DR03 =  new TH1F("h_200_CT_wO_recojetE_over_genjetE_DR03","", n_bins100, 0.5,1.5);
  TH1F* h_200_CT_wO_recojetE_over_genjetE_DR04 =  new TH1F("h_200_CT_wO_recojetE_over_genjetE_DR04","", n_bins100, 0.5,1.5);
  TH1F* h_200_CT_wO_recojetE_over_genjetE_DR05 =  new TH1F("h_200_CT_wO_recojetE_over_genjetE_DR05","", n_bins100, 0.5,1.5);
  TH1F* h_200_CT_wO_recojetE_over_genjetE_DR06 =  new TH1F("h_200_CT_wO_recojetE_over_genjetE_DR06","", n_bins100, 0.5,1.5);
  TH1F* h_200_CT_wO_recojetE_over_genjetE_DR07 =  new TH1F("h_200_CT_wO_recojetE_over_genjetE_DR07","", n_bins100, 0.5,1.5);
  TH1F* h_200_CT_wO_recojetE_over_genjetE_DR08 =  new TH1F("h_200_CT_wO_recojetE_over_genjetE_DR08","", n_bins100, 0.5,1.5);
  TH1F* h_200_CT_wO_recojetE_over_genjetE_DR09 =  new TH1F("h_200_CT_wO_recojetE_over_genjetE_DR09","", n_bins100, 0.5,1.5);
  TH1F* h_200_CT_wO_recojetE_over_genjetE_DR10 =  new TH1F("h_200_CT_wO_recojetE_over_genjetE_DR10","", n_bins100, 0.5,1.5);

  TH1F* h_200_CT_wO_dphi_gen_reco_DR05 =  new TH1F("h_200_CT_wO_dphi_gen_reco_DR05","", n_bins100, -0.1,9.9);
  TH1F* h_200_CT_wO_dphi_gen_reco_DR06 =  new TH1F("h_200_CT_wO_dphi_gen_reco_DR06","", n_bins100, -0.1,9.9);
  TH1F* h_200_CT_wO_dphi_gen_reco_DR07 =  new TH1F("h_200_CT_wO_dphi_gen_reco_DR07","", n_bins100, -0.1,9.9);

  TH1F* h_200_CT_wO_DR05_E_rel_totVis_RMS_d1_cosT_0_to_0_10 =  new TH1F("h_200_CT_wO_DR05_E_rel_totVis_RMS_d1_cosT_0_to_0_10","", n_binsJER, lim_E_rel_low,lim_E_rel_high);
  TH1F* h_200_CT_wO_DR05_E_rel_totVis_RMS_d1_cosT_0_10_to_0_20 =  new TH1F("h_200_CT_wO_DR05_E_rel_totVis_RMS_d1_cosT_0_10_to_0_20","", n_binsJER, lim_E_rel_low,lim_E_rel_high);
  TH1F* h_200_CT_wO_DR05_E_rel_totVis_RMS_d1_cosT_0_20_to_0_30 =  new TH1F("h_200_CT_wO_DR05_E_rel_totVis_RMS_d1_cosT_0_20_to_0_30","", n_binsJER, lim_E_rel_low,lim_E_rel_high);
  TH1F* h_200_CT_wO_DR05_E_rel_totVis_RMS_d1_cosT_0_30_to_0_40 =  new TH1F("h_200_CT_wO_DR05_E_rel_totVis_RMS_d1_cosT_0_30_to_0_40","", n_binsJER, lim_E_rel_low,lim_E_rel_high);
  TH1F* h_200_CT_wO_DR05_E_rel_totVis_RMS_d1_cosT_0_40_to_0_50 =  new TH1F("h_200_CT_wO_DR05_E_rel_totVis_RMS_d1_cosT_0_40_to_0_50","", n_binsJER, lim_E_rel_low,lim_E_rel_high);
  TH1F* h_200_CT_wO_DR05_E_rel_totVis_RMS_d1_cosT_0_50_to_0_60 =  new TH1F("h_200_CT_wO_DR05_E_rel_totVis_RMS_d1_cosT_0_50_to_0_60","", n_binsJER, lim_E_rel_low,lim_E_rel_high);
  TH1F* h_200_CT_wO_DR05_E_rel_totVis_RMS_d1_cosT_0_60_to_0_70 =  new TH1F("h_200_CT_wO_DR05_E_rel_totVis_RMS_d1_cosT_0_60_to_0_70","", n_binsJER, lim_E_rel_low,lim_E_rel_high);
  TH1F* h_200_CT_wO_DR05_E_rel_totVis_RMS_d1_cosT_0_70_to_0_80 =  new TH1F("h_200_CT_wO_DR05_E_rel_totVis_RMS_d1_cosT_0_70_to_0_80","", n_binsJER, lim_E_rel_low,lim_E_rel_high);
  TH1F* h_200_CT_wO_DR05_E_rel_totVis_RMS_d1_cosT_0_80_to_0_90 =  new TH1F("h_200_CT_wO_DR05_E_rel_totVis_RMS_d1_cosT_0_80_to_0_90","", n_binsJER, lim_E_rel_low,lim_E_rel_high);
  TH1F* h_200_CT_wO_DR05_E_rel_totVis_RMS_d1_cosT_0_900_to_0_925 =  new TH1F("h_200_CT_wO_DR05_E_rel_totVis_RMS_d1_cosT_0_900_to_0_925","", n_binsJER_FW, lim_E_rel_low,lim_E_rel_high);
  TH1F* h_200_CT_wO_DR05_E_rel_totVis_RMS_d1_cosT_0_925_to_0_950 =  new TH1F("h_200_CT_wO_DR05_E_rel_totVis_RMS_d1_cosT_0_925_to_0_950","", n_binsJER_FW, lim_E_rel_low,lim_E_rel_high);
  TH1F* h_200_CT_wO_DR05_E_rel_totVis_RMS_d1_cosT_0_950_to_0_975 =  new TH1F("h_200_CT_wO_DR05_E_rel_totVis_RMS_d1_cosT_0_950_to_0_975","", n_binsJER_FW, lim_E_rel_low,lim_E_rel_high);
  TH1F* h_200_CT_wO_DR05_E_rel_totVis_RMS_d1_cosT_0_975_to_1_00 =  new TH1F("h_200_CT_wO_DR05_E_rel_totVis_RMS_d1_cosT_0_975_to_1_00","", n_binsJER_FW, lim_E_rel_low,lim_E_rel_high);

  TH1F* h_200_CT_wO_DR06_E_rel_totVis_RMS_d1_cosT_0_to_0_10 =  new TH1F("h_200_CT_wO_DR06_E_rel_totVis_RMS_d1_cosT_0_to_0_10","", n_binsJER, lim_E_rel_low,lim_E_rel_high);
  TH1F* h_200_CT_wO_DR06_E_rel_totVis_RMS_d1_cosT_0_10_to_0_20 =  new TH1F("h_200_CT_wO_DR06_E_rel_totVis_RMS_d1_cosT_0_10_to_0_20","", n_binsJER, lim_E_rel_low,lim_E_rel_high);
  TH1F* h_200_CT_wO_DR06_E_rel_totVis_RMS_d1_cosT_0_20_to_0_30 =  new TH1F("h_200_CT_wO_DR06_E_rel_totVis_RMS_d1_cosT_0_20_to_0_30","", n_binsJER, lim_E_rel_low,lim_E_rel_high);
  TH1F* h_200_CT_wO_DR06_E_rel_totVis_RMS_d1_cosT_0_30_to_0_40 =  new TH1F("h_200_CT_wO_DR06_E_rel_totVis_RMS_d1_cosT_0_30_to_0_40","", n_binsJER, lim_E_rel_low,lim_E_rel_high);
  TH1F* h_200_CT_wO_DR06_E_rel_totVis_RMS_d1_cosT_0_40_to_0_50 =  new TH1F("h_200_CT_wO_DR06_E_rel_totVis_RMS_d1_cosT_0_40_to_0_50","", n_binsJER, lim_E_rel_low,lim_E_rel_high);
  TH1F* h_200_CT_wO_DR06_E_rel_totVis_RMS_d1_cosT_0_50_to_0_60 =  new TH1F("h_200_CT_wO_DR06_E_rel_totVis_RMS_d1_cosT_0_50_to_0_60","", n_binsJER, lim_E_rel_low,lim_E_rel_high);
  TH1F* h_200_CT_wO_DR06_E_rel_totVis_RMS_d1_cosT_0_60_to_0_70 =  new TH1F("h_200_CT_wO_DR06_E_rel_totVis_RMS_d1_cosT_0_60_to_0_70","", n_binsJER, lim_E_rel_low,lim_E_rel_high);
  TH1F* h_200_CT_wO_DR06_E_rel_totVis_RMS_d1_cosT_0_70_to_0_80 =  new TH1F("h_200_CT_wO_DR06_E_rel_totVis_RMS_d1_cosT_0_70_to_0_80","", n_binsJER, lim_E_rel_low,lim_E_rel_high);
  TH1F* h_200_CT_wO_DR06_E_rel_totVis_RMS_d1_cosT_0_80_to_0_90 =  new TH1F("h_200_CT_wO_DR06_E_rel_totVis_RMS_d1_cosT_0_80_to_0_90","", n_binsJER, lim_E_rel_low,lim_E_rel_high);
  TH1F* h_200_CT_wO_DR06_E_rel_totVis_RMS_d1_cosT_0_900_to_0_925 =  new TH1F("h_200_CT_wO_DR06_E_rel_totVis_RMS_d1_cosT_0_900_to_0_925","", n_binsJER_FW, lim_E_rel_low,lim_E_rel_high);
  TH1F* h_200_CT_wO_DR06_E_rel_totVis_RMS_d1_cosT_0_925_to_0_950 =  new TH1F("h_200_CT_wO_DR06_E_rel_totVis_RMS_d1_cosT_0_925_to_0_950","", n_binsJER_FW, lim_E_rel_low,lim_E_rel_high);
  TH1F* h_200_CT_wO_DR06_E_rel_totVis_RMS_d1_cosT_0_950_to_0_975 =  new TH1F("h_200_CT_wO_DR06_E_rel_totVis_RMS_d1_cosT_0_950_to_0_975","", n_binsJER_FW, lim_E_rel_low,lim_E_rel_high);
  TH1F* h_200_CT_wO_DR06_E_rel_totVis_RMS_d1_cosT_0_975_to_1_00 =  new TH1F("h_200_CT_wO_DR06_E_rel_totVis_RMS_d1_cosT_0_975_to_1_00","", n_binsJER_FW, lim_E_rel_low,lim_E_rel_high);

  TH1F* h_200_CT_wO_DR07_E_rel_totVis_RMS_d1_cosT_0_to_0_10 =  new TH1F("h_200_CT_wO_DR07_E_rel_totVis_RMS_d1_cosT_0_to_0_10","", n_binsJER, lim_E_rel_low,lim_E_rel_high);
  TH1F* h_200_CT_wO_DR07_E_rel_totVis_RMS_d1_cosT_0_10_to_0_20 =  new TH1F("h_200_CT_wO_DR07_E_rel_totVis_RMS_d1_cosT_0_10_to_0_20","", n_binsJER, lim_E_rel_low,lim_E_rel_high);
  TH1F* h_200_CT_wO_DR07_E_rel_totVis_RMS_d1_cosT_0_20_to_0_30 =  new TH1F("h_200_CT_wO_DR07_E_rel_totVis_RMS_d1_cosT_0_20_to_0_30","", n_binsJER, lim_E_rel_low,lim_E_rel_high);
  TH1F* h_200_CT_wO_DR07_E_rel_totVis_RMS_d1_cosT_0_30_to_0_40 =  new TH1F("h_200_CT_wO_DR07_E_rel_totVis_RMS_d1_cosT_0_30_to_0_40","", n_binsJER, lim_E_rel_low,lim_E_rel_high);
  TH1F* h_200_CT_wO_DR07_E_rel_totVis_RMS_d1_cosT_0_40_to_0_50 =  new TH1F("h_200_CT_wO_DR07_E_rel_totVis_RMS_d1_cosT_0_40_to_0_50","", n_binsJER, lim_E_rel_low,lim_E_rel_high);
  TH1F* h_200_CT_wO_DR07_E_rel_totVis_RMS_d1_cosT_0_50_to_0_60 =  new TH1F("h_200_CT_wO_DR07_E_rel_totVis_RMS_d1_cosT_0_50_to_0_60","", n_binsJER, lim_E_rel_low,lim_E_rel_high);
  TH1F* h_200_CT_wO_DR07_E_rel_totVis_RMS_d1_cosT_0_60_to_0_70 =  new TH1F("h_200_CT_wO_DR07_E_rel_totVis_RMS_d1_cosT_0_60_to_0_70","", n_binsJER, lim_E_rel_low,lim_E_rel_high);
  TH1F* h_200_CT_wO_DR07_E_rel_totVis_RMS_d1_cosT_0_70_to_0_80 =  new TH1F("h_200_CT_wO_DR07_E_rel_totVis_RMS_d1_cosT_0_70_to_0_80","", n_binsJER, lim_E_rel_low,lim_E_rel_high);
  TH1F* h_200_CT_wO_DR07_E_rel_totVis_RMS_d1_cosT_0_80_to_0_90 =  new TH1F("h_200_CT_wO_DR07_E_rel_totVis_RMS_d1_cosT_0_80_to_0_90","", n_binsJER, lim_E_rel_low,lim_E_rel_high);
  TH1F* h_200_CT_wO_DR07_E_rel_totVis_RMS_d1_cosT_0_900_to_0_925 =  new TH1F("h_200_CT_wO_DR07_E_rel_totVis_RMS_d1_cosT_0_900_to_0_925","", n_binsJER_FW, lim_E_rel_low,lim_E_rel_high);
  TH1F* h_200_CT_wO_DR07_E_rel_totVis_RMS_d1_cosT_0_925_to_0_950 =  new TH1F("h_200_CT_wO_DR07_E_rel_totVis_RMS_d1_cosT_0_925_to_0_950","", n_binsJER_FW, lim_E_rel_low,lim_E_rel_high);
  TH1F* h_200_CT_wO_DR07_E_rel_totVis_RMS_d1_cosT_0_950_to_0_975 =  new TH1F("h_200_CT_wO_DR07_E_rel_totVis_RMS_d1_cosT_0_950_to_0_975","", n_binsJER_FW, lim_E_rel_low,lim_E_rel_high);
  TH1F* h_200_CT_wO_DR07_E_rel_totVis_RMS_d1_cosT_0_975_to_1_00 =  new TH1F("h_200_CT_wO_DR07_E_rel_totVis_RMS_d1_cosT_0_975_to_1_00","", n_binsJER_FW, lim_E_rel_low,lim_E_rel_high);

  TH1F* h_200_CT_wO_DR08_E_rel_totVis_RMS_d1_cosT_0_to_0_10 =  new TH1F("h_200_CT_wO_DR08_E_rel_totVis_RMS_d1_cosT_0_to_0_10","", n_binsJER, lim_E_rel_low,lim_E_rel_high);
  TH1F* h_200_CT_wO_DR08_E_rel_totVis_RMS_d1_cosT_0_10_to_0_20 =  new TH1F("h_200_CT_wO_DR08_E_rel_totVis_RMS_d1_cosT_0_10_to_0_20","", n_binsJER, lim_E_rel_low,lim_E_rel_high);
  TH1F* h_200_CT_wO_DR08_E_rel_totVis_RMS_d1_cosT_0_20_to_0_30 =  new TH1F("h_200_CT_wO_DR08_E_rel_totVis_RMS_d1_cosT_0_20_to_0_30","", n_binsJER, lim_E_rel_low,lim_E_rel_high);
  TH1F* h_200_CT_wO_DR08_E_rel_totVis_RMS_d1_cosT_0_30_to_0_40 =  new TH1F("h_200_CT_wO_DR08_E_rel_totVis_RMS_d1_cosT_0_30_to_0_40","", n_binsJER, lim_E_rel_low,lim_E_rel_high);
  TH1F* h_200_CT_wO_DR08_E_rel_totVis_RMS_d1_cosT_0_40_to_0_50 =  new TH1F("h_200_CT_wO_DR08_E_rel_totVis_RMS_d1_cosT_0_40_to_0_50","", n_binsJER, lim_E_rel_low,lim_E_rel_high);
  TH1F* h_200_CT_wO_DR08_E_rel_totVis_RMS_d1_cosT_0_50_to_0_60 =  new TH1F("h_200_CT_wO_DR08_E_rel_totVis_RMS_d1_cosT_0_50_to_0_60","", n_binsJER, lim_E_rel_low,lim_E_rel_high);
  TH1F* h_200_CT_wO_DR08_E_rel_totVis_RMS_d1_cosT_0_60_to_0_70 =  new TH1F("h_200_CT_wO_DR08_E_rel_totVis_RMS_d1_cosT_0_60_to_0_70","", n_binsJER, lim_E_rel_low,lim_E_rel_high);
  TH1F* h_200_CT_wO_DR08_E_rel_totVis_RMS_d1_cosT_0_70_to_0_80 =  new TH1F("h_200_CT_wO_DR08_E_rel_totVis_RMS_d1_cosT_0_70_to_0_80","", n_binsJER, lim_E_rel_low,lim_E_rel_high);
  TH1F* h_200_CT_wO_DR08_E_rel_totVis_RMS_d1_cosT_0_80_to_0_90 =  new TH1F("h_200_CT_wO_DR08_E_rel_totVis_RMS_d1_cosT_0_80_to_0_90","", n_binsJER, lim_E_rel_low,lim_E_rel_high);
  TH1F* h_200_CT_wO_DR08_E_rel_totVis_RMS_d1_cosT_0_900_to_0_925 =  new TH1F("h_200_CT_wO_DR08_E_rel_totVis_RMS_d1_cosT_0_900_to_0_925","", n_binsJER_FW, lim_E_rel_low,lim_E_rel_high);
  TH1F* h_200_CT_wO_DR08_E_rel_totVis_RMS_d1_cosT_0_925_to_0_950 =  new TH1F("h_200_CT_wO_DR08_E_rel_totVis_RMS_d1_cosT_0_925_to_0_950","", n_binsJER_FW, lim_E_rel_low,lim_E_rel_high);
  TH1F* h_200_CT_wO_DR08_E_rel_totVis_RMS_d1_cosT_0_950_to_0_975 =  new TH1F("h_200_CT_wO_DR08_E_rel_totVis_RMS_d1_cosT_0_950_to_0_975","", n_binsJER_FW, lim_E_rel_low,lim_E_rel_high);
  TH1F* h_200_CT_wO_DR08_E_rel_totVis_RMS_d1_cosT_0_975_to_1_00 =  new TH1F("h_200_CT_wO_DR08_E_rel_totVis_RMS_d1_cosT_0_975_to_1_00","", n_binsJER_FW, lim_E_rel_low,lim_E_rel_high);

  TH1F* h_200_CT_wO_DR09_E_rel_totVis_RMS_d1_cosT_0_to_0_10 =  new TH1F("h_200_CT_wO_DR09_E_rel_totVis_RMS_d1_cosT_0_to_0_10","", n_binsJER, lim_E_rel_low,lim_E_rel_high);
  TH1F* h_200_CT_wO_DR09_E_rel_totVis_RMS_d1_cosT_0_10_to_0_20 =  new TH1F("h_200_CT_wO_DR09_E_rel_totVis_RMS_d1_cosT_0_10_to_0_20","", n_binsJER, lim_E_rel_low,lim_E_rel_high);
  TH1F* h_200_CT_wO_DR09_E_rel_totVis_RMS_d1_cosT_0_20_to_0_30 =  new TH1F("h_200_CT_wO_DR09_E_rel_totVis_RMS_d1_cosT_0_20_to_0_30","", n_binsJER, lim_E_rel_low,lim_E_rel_high);
  TH1F* h_200_CT_wO_DR09_E_rel_totVis_RMS_d1_cosT_0_30_to_0_40 =  new TH1F("h_200_CT_wO_DR09_E_rel_totVis_RMS_d1_cosT_0_30_to_0_40","", n_binsJER, lim_E_rel_low,lim_E_rel_high);
  TH1F* h_200_CT_wO_DR09_E_rel_totVis_RMS_d1_cosT_0_40_to_0_50 =  new TH1F("h_200_CT_wO_DR09_E_rel_totVis_RMS_d1_cosT_0_40_to_0_50","", n_binsJER, lim_E_rel_low,lim_E_rel_high);
  TH1F* h_200_CT_wO_DR09_E_rel_totVis_RMS_d1_cosT_0_50_to_0_60 =  new TH1F("h_200_CT_wO_DR09_E_rel_totVis_RMS_d1_cosT_0_50_to_0_60","", n_binsJER, lim_E_rel_low,lim_E_rel_high);
  TH1F* h_200_CT_wO_DR09_E_rel_totVis_RMS_d1_cosT_0_60_to_0_70 =  new TH1F("h_200_CT_wO_DR09_E_rel_totVis_RMS_d1_cosT_0_60_to_0_70","", n_binsJER, lim_E_rel_low,lim_E_rel_high);
  TH1F* h_200_CT_wO_DR09_E_rel_totVis_RMS_d1_cosT_0_70_to_0_80 =  new TH1F("h_200_CT_wO_DR09_E_rel_totVis_RMS_d1_cosT_0_70_to_0_80","", n_binsJER, lim_E_rel_low,lim_E_rel_high);
  TH1F* h_200_CT_wO_DR09_E_rel_totVis_RMS_d1_cosT_0_80_to_0_90 =  new TH1F("h_200_CT_wO_DR09_E_rel_totVis_RMS_d1_cosT_0_80_to_0_90","", n_binsJER, lim_E_rel_low,lim_E_rel_high);
  TH1F* h_200_CT_wO_DR09_E_rel_totVis_RMS_d1_cosT_0_900_to_0_925 =  new TH1F("h_200_CT_wO_DR09_E_rel_totVis_RMS_d1_cosT_0_900_to_0_925","", n_binsJER_FW, lim_E_rel_low,lim_E_rel_high);
  TH1F* h_200_CT_wO_DR09_E_rel_totVis_RMS_d1_cosT_0_925_to_0_950 =  new TH1F("h_200_CT_wO_DR09_E_rel_totVis_RMS_d1_cosT_0_925_to_0_950","", n_binsJER_FW, lim_E_rel_low,lim_E_rel_high);
  TH1F* h_200_CT_wO_DR09_E_rel_totVis_RMS_d1_cosT_0_950_to_0_975 =  new TH1F("h_200_CT_wO_DR09_E_rel_totVis_RMS_d1_cosT_0_950_to_0_975","", n_binsJER_FW, lim_E_rel_low,lim_E_rel_high);
  TH1F* h_200_CT_wO_DR09_E_rel_totVis_RMS_d1_cosT_0_975_to_1_00 =  new TH1F("h_200_CT_wO_DR09_E_rel_totVis_RMS_d1_cosT_0_975_to_1_00","", n_binsJER_FW, lim_E_rel_low,lim_E_rel_high);

  TH1F* h_200_CT_wO_DR10_E_rel_totVis_RMS_d1_cosT_0_to_0_10 =  new TH1F("h_200_CT_wO_DR10_E_rel_totVis_RMS_d1_cosT_0_to_0_10","", n_binsJER, lim_E_rel_low,lim_E_rel_high);
  TH1F* h_200_CT_wO_DR10_E_rel_totVis_RMS_d1_cosT_0_10_to_0_20 =  new TH1F("h_200_CT_wO_DR10_E_rel_totVis_RMS_d1_cosT_0_10_to_0_20","", n_binsJER, lim_E_rel_low,lim_E_rel_high);
  TH1F* h_200_CT_wO_DR10_E_rel_totVis_RMS_d1_cosT_0_20_to_0_30 =  new TH1F("h_200_CT_wO_DR10_E_rel_totVis_RMS_d1_cosT_0_20_to_0_30","", n_binsJER, lim_E_rel_low,lim_E_rel_high);
  TH1F* h_200_CT_wO_DR10_E_rel_totVis_RMS_d1_cosT_0_30_to_0_40 =  new TH1F("h_200_CT_wO_DR10_E_rel_totVis_RMS_d1_cosT_0_30_to_0_40","", n_binsJER, lim_E_rel_low,lim_E_rel_high);
  TH1F* h_200_CT_wO_DR10_E_rel_totVis_RMS_d1_cosT_0_40_to_0_50 =  new TH1F("h_200_CT_wO_DR10_E_rel_totVis_RMS_d1_cosT_0_40_to_0_50","", n_binsJER, lim_E_rel_low,lim_E_rel_high);
  TH1F* h_200_CT_wO_DR10_E_rel_totVis_RMS_d1_cosT_0_50_to_0_60 =  new TH1F("h_200_CT_wO_DR10_E_rel_totVis_RMS_d1_cosT_0_50_to_0_60","", n_binsJER, lim_E_rel_low,lim_E_rel_high);
  TH1F* h_200_CT_wO_DR10_E_rel_totVis_RMS_d1_cosT_0_60_to_0_70 =  new TH1F("h_200_CT_wO_DR10_E_rel_totVis_RMS_d1_cosT_0_60_to_0_70","", n_binsJER, lim_E_rel_low,lim_E_rel_high);
  TH1F* h_200_CT_wO_DR10_E_rel_totVis_RMS_d1_cosT_0_70_to_0_80 =  new TH1F("h_200_CT_wO_DR10_E_rel_totVis_RMS_d1_cosT_0_70_to_0_80","", n_binsJER, lim_E_rel_low,lim_E_rel_high);
  TH1F* h_200_CT_wO_DR10_E_rel_totVis_RMS_d1_cosT_0_80_to_0_90 =  new TH1F("h_200_CT_wO_DR10_E_rel_totVis_RMS_d1_cosT_0_80_to_0_90","", n_binsJER, lim_E_rel_low,lim_E_rel_high);
  TH1F* h_200_CT_wO_DR10_E_rel_totVis_RMS_d1_cosT_0_900_to_0_925 =  new TH1F("h_200_CT_wO_DR10_E_rel_totVis_RMS_d1_cosT_0_900_to_0_925","", n_binsJER_FW, lim_E_rel_low,lim_E_rel_high);
  TH1F* h_200_CT_wO_DR10_E_rel_totVis_RMS_d1_cosT_0_925_to_0_950 =  new TH1F("h_200_CT_wO_DR10_E_rel_totVis_RMS_d1_cosT_0_925_to_0_950","", n_binsJER_FW, lim_E_rel_low,lim_E_rel_high);
  TH1F* h_200_CT_wO_DR10_E_rel_totVis_RMS_d1_cosT_0_950_to_0_975 =  new TH1F("h_200_CT_wO_DR10_E_rel_totVis_RMS_d1_cosT_0_950_to_0_975","", n_binsJER_FW, lim_E_rel_low,lim_E_rel_high);
  TH1F* h_200_CT_wO_DR10_E_rel_totVis_RMS_d1_cosT_0_975_to_1_00 =  new TH1F("h_200_CT_wO_DR10_E_rel_totVis_RMS_d1_cosT_0_975_to_1_00","", n_binsJER_FW, lim_E_rel_low,lim_E_rel_high);

  TH1F* h_200_CT_wO_DR05_dphi_reco_gen_cosTheta_0_65 =  new TH1F("h_200_CT_wO_DR05_dphi_reco_gen_cosTheta_0_65","", n_bins100, -lim_angleDeg,lim_angleDeg);
  TH1F* h_200_CT_wO_DR05_dtheta_reco_gen_cosTheta_0_65 =  new TH1F("h_200_CT_wO_DR05_dtheta_reco_gen_cosTheta_0_65","", n_bins100, -lim_angleDeg,lim_angleDeg);
  TH1F* h_200_CT_wO_DR05_dphi_reco_gen_cosTheta_0_65_to_0_80 =  new TH1F("h_200_CT_wO_DR05_dphi_reco_gen_cosTheta_0_65_to_0_80","", n_bins100, -lim_angleDeg,lim_angleDeg);
  TH1F* h_200_CT_wO_DR05_dtheta_reco_gen_cosTheta_0_65_to_0_80 =  new TH1F("h_200_CT_wO_DR05_dtheta_reco_gen_cosTheta_0_65_to_0_80","", n_bins100, -lim_angleDeg,lim_angleDeg);
  TH1F* h_200_CT_wO_DR05_dphi_reco_gen_cosTheta_0_80_to_0_925 =  new TH1F("h_200_CT_wO_DR05_dphi_reco_gen_cosTheta_0_80_to_0_925","", n_bins100, -lim_angleDeg,lim_angleDeg);
  TH1F* h_200_CT_wO_DR05_dtheta_reco_gen_cosTheta_0_80_to_0_925 =  new TH1F("h_200_CT_wO_DR05_dtheta_reco_gen_cosTheta_0_80_to_0_925","", n_bins100, -lim_angleDeg,lim_angleDeg);
  TH1F* h_200_CT_wO_DR05_dphi_reco_gen_cosTheta_0_925_to_0_975 =  new TH1F("h_200_CT_wO_DR05_dphi_reco_gen_cosTheta_0_925_to_0_975","", n_bins100, -lim_angleDeg,lim_angleDeg);
  TH1F* h_200_CT_wO_DR05_dtheta_reco_gen_cosTheta_0_925_to_0_975 =  new TH1F("h_200_CT_wO_DR05_dtheta_reco_gen_cosTheta_0_925_to_0_975","", n_bins100, -lim_angleDeg,lim_angleDeg);

  TH1F* h_200_CT_wO_DR07_dphi_reco_gen_cosTheta_0_65 =  new TH1F("h_200_CT_wO_DR07_dphi_reco_gen_cosTheta_0_65","", n_bins100, -lim_angleDeg,lim_angleDeg);
  TH1F* h_200_CT_wO_DR07_dtheta_reco_gen_cosTheta_0_65 =  new TH1F("h_200_CT_wO_DR07_dtheta_reco_gen_cosTheta_0_65","", n_bins100, -lim_angleDeg,lim_angleDeg);
  TH1F* h_200_CT_wO_DR07_dphi_reco_gen_cosTheta_0_65_to_0_80 =  new TH1F("h_200_CT_wO_DR07_dphi_reco_gen_cosTheta_0_65_to_0_80","", n_bins100, -lim_angleDeg,lim_angleDeg);
  TH1F* h_200_CT_wO_DR07_dtheta_reco_gen_cosTheta_0_65_to_0_80 =  new TH1F("h_200_CT_wO_DR07_dtheta_reco_gen_cosTheta_0_65_to_0_80","", n_bins100, -lim_angleDeg,lim_angleDeg);
  TH1F* h_200_CT_wO_DR07_dphi_reco_gen_cosTheta_0_80_to_0_925 =  new TH1F("h_200_CT_wO_DR07_dphi_reco_gen_cosTheta_0_80_to_0_925","", n_bins100, -lim_angleDeg,lim_angleDeg);
  TH1F* h_200_CT_wO_DR07_dtheta_reco_gen_cosTheta_0_80_to_0_925 =  new TH1F("h_200_CT_wO_DR07_dtheta_reco_gen_cosTheta_0_80_to_0_925","", n_bins100, -lim_angleDeg,lim_angleDeg);
  TH1F* h_200_CT_wO_DR07_dphi_reco_gen_cosTheta_0_925_to_0_975 =  new TH1F("h_200_CT_wO_DR07_dphi_reco_gen_cosTheta_0_925_to_0_975","", n_bins100, -lim_angleDeg,lim_angleDeg);
  TH1F* h_200_CT_wO_DR07_dtheta_reco_gen_cosTheta_0_925_to_0_975 =  new TH1F("h_200_CT_wO_DR07_dtheta_reco_gen_cosTheta_0_925_to_0_975","", n_bins100, -lim_angleDeg,lim_angleDeg);

  TH1F* h_200_CT_wO_DR10_dphi_reco_gen_cosTheta_0_65 =  new TH1F("h_200_CT_wO_DR10_dphi_reco_gen_cosTheta_0_65","", n_bins100, -lim_angleDeg,lim_angleDeg);
  TH1F* h_200_CT_wO_DR10_dtheta_reco_gen_cosTheta_0_65 =  new TH1F("h_200_CT_wO_DR10_dtheta_reco_gen_cosTheta_0_65","", n_bins100, -lim_angleDeg,lim_angleDeg);
  TH1F* h_200_CT_wO_DR10_dphi_reco_gen_cosTheta_0_65_to_0_80 =  new TH1F("h_200_CT_wO_DR10_dphi_reco_gen_cosTheta_0_65_to_0_80","", n_bins100, -lim_angleDeg,lim_angleDeg);
  TH1F* h_200_CT_wO_DR10_dtheta_reco_gen_cosTheta_0_65_to_0_80 =  new TH1F("h_200_CT_wO_DR10_dtheta_reco_gen_cosTheta_0_65_to_0_80","", n_bins100, -lim_angleDeg,lim_angleDeg);
  TH1F* h_200_CT_wO_DR10_dphi_reco_gen_cosTheta_0_80_to_0_925 =  new TH1F("h_200_CT_wO_DR10_dphi_reco_gen_cosTheta_0_80_to_0_925","", n_bins100, -lim_angleDeg,lim_angleDeg);
  TH1F* h_200_CT_wO_DR10_dtheta_reco_gen_cosTheta_0_80_to_0_925 =  new TH1F("h_200_CT_wO_DR10_dtheta_reco_gen_cosTheta_0_80_to_0_925","", n_bins100, -lim_angleDeg,lim_angleDeg);
  TH1F* h_200_CT_wO_DR10_dphi_reco_gen_cosTheta_0_925_to_0_975 =  new TH1F("h_200_CT_wO_DR10_dphi_reco_gen_cosTheta_0_925_to_0_975","", n_bins100, -lim_angleDeg,lim_angleDeg);
  TH1F* h_200_CT_wO_DR10_dtheta_reco_gen_cosTheta_0_925_to_0_975 =  new TH1F("h_200_CT_wO_DR10_dtheta_reco_gen_cosTheta_0_925_to_0_975","", n_bins100, -lim_angleDeg,lim_angleDeg);


  std::vector<TH1F*> hist_vec_200_CT_wO;
  hist_vec_200_CT_wO.push_back(h_200_CT_wO_genjet03_dphi_j1j2);
  hist_vec_200_CT_wO.push_back(h_200_CT_wO_genjet03_E1_E2_over_E_True);
  hist_vec_200_CT_wO.push_back(h_200_CT_wO_genjet03_Delta_E1_E2_over_E12);
  hist_vec_200_CT_wO.push_back(h_200_CT_wO_genjet04_dphi_j1j2);
  hist_vec_200_CT_wO.push_back(h_200_CT_wO_genjet04_E1_E2_over_E_True);
  hist_vec_200_CT_wO.push_back(h_200_CT_wO_genjet04_Delta_E1_E2_over_E12);
  hist_vec_200_CT_wO.push_back(h_200_CT_wO_genjet05_dphi_j1j2);
  hist_vec_200_CT_wO.push_back(h_200_CT_wO_genjet05_E1_E2_over_E_True);
  hist_vec_200_CT_wO.push_back(h_200_CT_wO_genjet05_Delta_E1_E2_over_E12);
  hist_vec_200_CT_wO.push_back(h_200_CT_wO_genjet06_dphi_j1j2);
  hist_vec_200_CT_wO.push_back(h_200_CT_wO_genjet06_E1_E2_over_E_True);
  hist_vec_200_CT_wO.push_back(h_200_CT_wO_genjet06_Delta_E1_E2_over_E12);
  hist_vec_200_CT_wO.push_back(h_200_CT_wO_genjet07_dphi_j1j2);
  hist_vec_200_CT_wO.push_back(h_200_CT_wO_genjet07_E1_E2_over_E_True);
  hist_vec_200_CT_wO.push_back(h_200_CT_wO_genjet07_Delta_E1_E2_over_E12);
  hist_vec_200_CT_wO.push_back(h_200_CT_wO_genjet08_dphi_j1j2);
  hist_vec_200_CT_wO.push_back(h_200_CT_wO_genjet08_E1_E2_over_E_True);
  hist_vec_200_CT_wO.push_back(h_200_CT_wO_genjet08_Delta_E1_E2_over_E12);
  hist_vec_200_CT_wO.push_back(h_200_CT_wO_genjet09_dphi_j1j2);
  hist_vec_200_CT_wO.push_back(h_200_CT_wO_genjet09_E1_E2_over_E_True);
  hist_vec_200_CT_wO.push_back(h_200_CT_wO_genjet09_Delta_E1_E2_over_E12);
  hist_vec_200_CT_wO.push_back(h_200_CT_wO_genjet10_dphi_j1j2);
  hist_vec_200_CT_wO.push_back(h_200_CT_wO_genjet10_E1_E2_over_E_True);
  hist_vec_200_CT_wO.push_back(h_200_CT_wO_genjet10_Delta_E1_E2_over_E12);

  hist_vec_200_CT_wO.push_back(h_200_CT_wO_recojet03_dphi_j1j2);
  hist_vec_200_CT_wO.push_back(h_200_CT_wO_recojet03_E1_E2_over_E_True);
  hist_vec_200_CT_wO.push_back(h_200_CT_wO_recojet03_Delta_E1_E2_over_E12);
  hist_vec_200_CT_wO.push_back(h_200_CT_wO_recojet04_dphi_j1j2);
  hist_vec_200_CT_wO.push_back(h_200_CT_wO_recojet04_E1_E2_over_E_True);
  hist_vec_200_CT_wO.push_back(h_200_CT_wO_recojet04_Delta_E1_E2_over_E12);
  hist_vec_200_CT_wO.push_back(h_200_CT_wO_recojet05_dphi_j1j2);
  hist_vec_200_CT_wO.push_back(h_200_CT_wO_recojet05_E1_E2_over_E_True);
  hist_vec_200_CT_wO.push_back(h_200_CT_wO_recojet05_Delta_E1_E2_over_E12);
  hist_vec_200_CT_wO.push_back(h_200_CT_wO_recojet06_dphi_j1j2);
  hist_vec_200_CT_wO.push_back(h_200_CT_wO_recojet06_E1_E2_over_E_True);
  hist_vec_200_CT_wO.push_back(h_200_CT_wO_recojet06_Delta_E1_E2_over_E12);
  hist_vec_200_CT_wO.push_back(h_200_CT_wO_recojet07_dphi_j1j2);
  hist_vec_200_CT_wO.push_back(h_200_CT_wO_recojet07_E1_E2_over_E_True);
  hist_vec_200_CT_wO.push_back(h_200_CT_wO_recojet07_Delta_E1_E2_over_E12);
  hist_vec_200_CT_wO.push_back(h_200_CT_wO_recojet08_dphi_j1j2);
  hist_vec_200_CT_wO.push_back(h_200_CT_wO_recojet08_E1_E2_over_E_True);
  hist_vec_200_CT_wO.push_back(h_200_CT_wO_recojet08_Delta_E1_E2_over_E12);
  hist_vec_200_CT_wO.push_back(h_200_CT_wO_recojet09_dphi_j1j2);
  hist_vec_200_CT_wO.push_back(h_200_CT_wO_recojet09_E1_E2_over_E_True);
  hist_vec_200_CT_wO.push_back(h_200_CT_wO_recojet09_Delta_E1_E2_over_E12);
  hist_vec_200_CT_wO.push_back(h_200_CT_wO_recojet10_dphi_j1j2);
  hist_vec_200_CT_wO.push_back(h_200_CT_wO_recojet10_E1_E2_over_E_True);
  hist_vec_200_CT_wO.push_back(h_200_CT_wO_recojet10_Delta_E1_E2_over_E12);

  hist_vec_200_CT_wO.push_back(h_200_CT_wO_recojetE_over_genjetE_DR03);
  hist_vec_200_CT_wO.push_back(h_200_CT_wO_recojetE_over_genjetE_DR04);
  hist_vec_200_CT_wO.push_back(h_200_CT_wO_recojetE_over_genjetE_DR05);
  hist_vec_200_CT_wO.push_back(h_200_CT_wO_recojetE_over_genjetE_DR06);
  hist_vec_200_CT_wO.push_back(h_200_CT_wO_recojetE_over_genjetE_DR07);
  hist_vec_200_CT_wO.push_back(h_200_CT_wO_recojetE_over_genjetE_DR08);
  hist_vec_200_CT_wO.push_back(h_200_CT_wO_recojetE_over_genjetE_DR09);
  hist_vec_200_CT_wO.push_back(h_200_CT_wO_recojetE_over_genjetE_DR10);

  hist_vec_200_CT_wO.push_back(h_200_CT_wO_dphi_gen_reco_DR05);
  hist_vec_200_CT_wO.push_back(h_200_CT_wO_dphi_gen_reco_DR06);
  hist_vec_200_CT_wO.push_back(h_200_CT_wO_dphi_gen_reco_DR07);

  hist_vec_200_CT_wO.push_back(h_200_CT_wO_DR05_E_rel_totVis_RMS_d1_cosT_0_to_0_10);
  hist_vec_200_CT_wO.push_back(h_200_CT_wO_DR05_E_rel_totVis_RMS_d1_cosT_0_10_to_0_20);
  hist_vec_200_CT_wO.push_back(h_200_CT_wO_DR05_E_rel_totVis_RMS_d1_cosT_0_20_to_0_30);
  hist_vec_200_CT_wO.push_back(h_200_CT_wO_DR05_E_rel_totVis_RMS_d1_cosT_0_30_to_0_40);
  hist_vec_200_CT_wO.push_back(h_200_CT_wO_DR05_E_rel_totVis_RMS_d1_cosT_0_40_to_0_50);
  hist_vec_200_CT_wO.push_back(h_200_CT_wO_DR05_E_rel_totVis_RMS_d1_cosT_0_50_to_0_60);
  hist_vec_200_CT_wO.push_back(h_200_CT_wO_DR05_E_rel_totVis_RMS_d1_cosT_0_60_to_0_70);
  hist_vec_200_CT_wO.push_back(h_200_CT_wO_DR05_E_rel_totVis_RMS_d1_cosT_0_70_to_0_80);
  hist_vec_200_CT_wO.push_back(h_200_CT_wO_DR05_E_rel_totVis_RMS_d1_cosT_0_80_to_0_90);
  hist_vec_200_CT_wO.push_back(h_200_CT_wO_DR05_E_rel_totVis_RMS_d1_cosT_0_900_to_0_925);
  hist_vec_200_CT_wO.push_back(h_200_CT_wO_DR05_E_rel_totVis_RMS_d1_cosT_0_925_to_0_950);
  hist_vec_200_CT_wO.push_back(h_200_CT_wO_DR05_E_rel_totVis_RMS_d1_cosT_0_950_to_0_975);
  hist_vec_200_CT_wO.push_back(h_200_CT_wO_DR05_E_rel_totVis_RMS_d1_cosT_0_975_to_1_00);

  hist_vec_200_CT_wO.push_back(h_200_CT_wO_DR06_E_rel_totVis_RMS_d1_cosT_0_to_0_10);
  hist_vec_200_CT_wO.push_back(h_200_CT_wO_DR06_E_rel_totVis_RMS_d1_cosT_0_10_to_0_20);
  hist_vec_200_CT_wO.push_back(h_200_CT_wO_DR06_E_rel_totVis_RMS_d1_cosT_0_20_to_0_30);
  hist_vec_200_CT_wO.push_back(h_200_CT_wO_DR06_E_rel_totVis_RMS_d1_cosT_0_30_to_0_40);
  hist_vec_200_CT_wO.push_back(h_200_CT_wO_DR06_E_rel_totVis_RMS_d1_cosT_0_40_to_0_50);
  hist_vec_200_CT_wO.push_back(h_200_CT_wO_DR06_E_rel_totVis_RMS_d1_cosT_0_50_to_0_60);
  hist_vec_200_CT_wO.push_back(h_200_CT_wO_DR06_E_rel_totVis_RMS_d1_cosT_0_60_to_0_70);
  hist_vec_200_CT_wO.push_back(h_200_CT_wO_DR06_E_rel_totVis_RMS_d1_cosT_0_70_to_0_80);
  hist_vec_200_CT_wO.push_back(h_200_CT_wO_DR06_E_rel_totVis_RMS_d1_cosT_0_80_to_0_90);
  hist_vec_200_CT_wO.push_back(h_200_CT_wO_DR06_E_rel_totVis_RMS_d1_cosT_0_900_to_0_925);
  hist_vec_200_CT_wO.push_back(h_200_CT_wO_DR06_E_rel_totVis_RMS_d1_cosT_0_925_to_0_950);
  hist_vec_200_CT_wO.push_back(h_200_CT_wO_DR06_E_rel_totVis_RMS_d1_cosT_0_950_to_0_975);
  hist_vec_200_CT_wO.push_back(h_200_CT_wO_DR06_E_rel_totVis_RMS_d1_cosT_0_975_to_1_00); 

  hist_vec_200_CT_wO.push_back(h_200_CT_wO_DR07_E_rel_totVis_RMS_d1_cosT_0_to_0_10);
  hist_vec_200_CT_wO.push_back(h_200_CT_wO_DR07_E_rel_totVis_RMS_d1_cosT_0_10_to_0_20);
  hist_vec_200_CT_wO.push_back(h_200_CT_wO_DR07_E_rel_totVis_RMS_d1_cosT_0_20_to_0_30);
  hist_vec_200_CT_wO.push_back(h_200_CT_wO_DR07_E_rel_totVis_RMS_d1_cosT_0_30_to_0_40);
  hist_vec_200_CT_wO.push_back(h_200_CT_wO_DR07_E_rel_totVis_RMS_d1_cosT_0_40_to_0_50);
  hist_vec_200_CT_wO.push_back(h_200_CT_wO_DR07_E_rel_totVis_RMS_d1_cosT_0_50_to_0_60);
  hist_vec_200_CT_wO.push_back(h_200_CT_wO_DR07_E_rel_totVis_RMS_d1_cosT_0_60_to_0_70);
  hist_vec_200_CT_wO.push_back(h_200_CT_wO_DR07_E_rel_totVis_RMS_d1_cosT_0_70_to_0_80);
  hist_vec_200_CT_wO.push_back(h_200_CT_wO_DR07_E_rel_totVis_RMS_d1_cosT_0_80_to_0_90);
  hist_vec_200_CT_wO.push_back(h_200_CT_wO_DR07_E_rel_totVis_RMS_d1_cosT_0_900_to_0_925);
  hist_vec_200_CT_wO.push_back(h_200_CT_wO_DR07_E_rel_totVis_RMS_d1_cosT_0_925_to_0_950);
  hist_vec_200_CT_wO.push_back(h_200_CT_wO_DR07_E_rel_totVis_RMS_d1_cosT_0_950_to_0_975);
  hist_vec_200_CT_wO.push_back(h_200_CT_wO_DR07_E_rel_totVis_RMS_d1_cosT_0_975_to_1_00); 

  hist_vec_200_CT_wO.push_back(h_200_CT_wO_DR08_E_rel_totVis_RMS_d1_cosT_0_to_0_10);
  hist_vec_200_CT_wO.push_back(h_200_CT_wO_DR08_E_rel_totVis_RMS_d1_cosT_0_10_to_0_20);
  hist_vec_200_CT_wO.push_back(h_200_CT_wO_DR08_E_rel_totVis_RMS_d1_cosT_0_20_to_0_30);
  hist_vec_200_CT_wO.push_back(h_200_CT_wO_DR08_E_rel_totVis_RMS_d1_cosT_0_30_to_0_40);
  hist_vec_200_CT_wO.push_back(h_200_CT_wO_DR08_E_rel_totVis_RMS_d1_cosT_0_40_to_0_50);
  hist_vec_200_CT_wO.push_back(h_200_CT_wO_DR08_E_rel_totVis_RMS_d1_cosT_0_50_to_0_60);
  hist_vec_200_CT_wO.push_back(h_200_CT_wO_DR08_E_rel_totVis_RMS_d1_cosT_0_60_to_0_70);
  hist_vec_200_CT_wO.push_back(h_200_CT_wO_DR08_E_rel_totVis_RMS_d1_cosT_0_70_to_0_80);
  hist_vec_200_CT_wO.push_back(h_200_CT_wO_DR08_E_rel_totVis_RMS_d1_cosT_0_80_to_0_90);
  hist_vec_200_CT_wO.push_back(h_200_CT_wO_DR08_E_rel_totVis_RMS_d1_cosT_0_900_to_0_925);
  hist_vec_200_CT_wO.push_back(h_200_CT_wO_DR08_E_rel_totVis_RMS_d1_cosT_0_925_to_0_950);
  hist_vec_200_CT_wO.push_back(h_200_CT_wO_DR08_E_rel_totVis_RMS_d1_cosT_0_950_to_0_975);
  hist_vec_200_CT_wO.push_back(h_200_CT_wO_DR08_E_rel_totVis_RMS_d1_cosT_0_975_to_1_00); //110

  hist_vec_200_CT_wO.push_back(h_200_CT_wO_DR09_E_rel_totVis_RMS_d1_cosT_0_to_0_10);
  hist_vec_200_CT_wO.push_back(h_200_CT_wO_DR09_E_rel_totVis_RMS_d1_cosT_0_10_to_0_20);
  hist_vec_200_CT_wO.push_back(h_200_CT_wO_DR09_E_rel_totVis_RMS_d1_cosT_0_20_to_0_30);
  hist_vec_200_CT_wO.push_back(h_200_CT_wO_DR09_E_rel_totVis_RMS_d1_cosT_0_30_to_0_40);
  hist_vec_200_CT_wO.push_back(h_200_CT_wO_DR09_E_rel_totVis_RMS_d1_cosT_0_40_to_0_50);
  hist_vec_200_CT_wO.push_back(h_200_CT_wO_DR09_E_rel_totVis_RMS_d1_cosT_0_50_to_0_60);
  hist_vec_200_CT_wO.push_back(h_200_CT_wO_DR09_E_rel_totVis_RMS_d1_cosT_0_60_to_0_70);
  hist_vec_200_CT_wO.push_back(h_200_CT_wO_DR09_E_rel_totVis_RMS_d1_cosT_0_70_to_0_80);
  hist_vec_200_CT_wO.push_back(h_200_CT_wO_DR09_E_rel_totVis_RMS_d1_cosT_0_80_to_0_90);
  hist_vec_200_CT_wO.push_back(h_200_CT_wO_DR09_E_rel_totVis_RMS_d1_cosT_0_900_to_0_925);
  hist_vec_200_CT_wO.push_back(h_200_CT_wO_DR09_E_rel_totVis_RMS_d1_cosT_0_925_to_0_950);
  hist_vec_200_CT_wO.push_back(h_200_CT_wO_DR09_E_rel_totVis_RMS_d1_cosT_0_950_to_0_975);
  hist_vec_200_CT_wO.push_back(h_200_CT_wO_DR09_E_rel_totVis_RMS_d1_cosT_0_975_to_1_00); //123

  hist_vec_200_CT_wO.push_back(h_200_CT_wO_DR10_E_rel_totVis_RMS_d1_cosT_0_to_0_10);
  hist_vec_200_CT_wO.push_back(h_200_CT_wO_DR10_E_rel_totVis_RMS_d1_cosT_0_10_to_0_20);
  hist_vec_200_CT_wO.push_back(h_200_CT_wO_DR10_E_rel_totVis_RMS_d1_cosT_0_20_to_0_30);
  hist_vec_200_CT_wO.push_back(h_200_CT_wO_DR10_E_rel_totVis_RMS_d1_cosT_0_30_to_0_40);
  hist_vec_200_CT_wO.push_back(h_200_CT_wO_DR10_E_rel_totVis_RMS_d1_cosT_0_40_to_0_50);
  hist_vec_200_CT_wO.push_back(h_200_CT_wO_DR10_E_rel_totVis_RMS_d1_cosT_0_50_to_0_60);
  hist_vec_200_CT_wO.push_back(h_200_CT_wO_DR10_E_rel_totVis_RMS_d1_cosT_0_60_to_0_70);
  hist_vec_200_CT_wO.push_back(h_200_CT_wO_DR10_E_rel_totVis_RMS_d1_cosT_0_70_to_0_80);
  hist_vec_200_CT_wO.push_back(h_200_CT_wO_DR10_E_rel_totVis_RMS_d1_cosT_0_80_to_0_90);
  hist_vec_200_CT_wO.push_back(h_200_CT_wO_DR10_E_rel_totVis_RMS_d1_cosT_0_900_to_0_925);
  hist_vec_200_CT_wO.push_back(h_200_CT_wO_DR10_E_rel_totVis_RMS_d1_cosT_0_925_to_0_950);
  hist_vec_200_CT_wO.push_back(h_200_CT_wO_DR10_E_rel_totVis_RMS_d1_cosT_0_950_to_0_975);
  hist_vec_200_CT_wO.push_back(h_200_CT_wO_DR10_E_rel_totVis_RMS_d1_cosT_0_975_to_1_00); //136

  hist_vec_200_CT_wO.push_back(h_200_CT_wO_DR05_dphi_reco_gen_cosTheta_0_65);//137
  hist_vec_200_CT_wO.push_back(h_200_CT_wO_DR05_dphi_reco_gen_cosTheta_0_65_to_0_80);
  hist_vec_200_CT_wO.push_back(h_200_CT_wO_DR05_dphi_reco_gen_cosTheta_0_80_to_0_925);
  hist_vec_200_CT_wO.push_back(h_200_CT_wO_DR05_dphi_reco_gen_cosTheta_0_925_to_0_975);
  hist_vec_200_CT_wO.push_back(h_200_CT_wO_DR05_dtheta_reco_gen_cosTheta_0_65);
  hist_vec_200_CT_wO.push_back(h_200_CT_wO_DR05_dtheta_reco_gen_cosTheta_0_65_to_0_80);
  hist_vec_200_CT_wO.push_back(h_200_CT_wO_DR05_dtheta_reco_gen_cosTheta_0_80_to_0_925);
  hist_vec_200_CT_wO.push_back(h_200_CT_wO_DR05_dtheta_reco_gen_cosTheta_0_925_to_0_975);

  hist_vec_200_CT_wO.push_back(h_200_CT_wO_DR07_dphi_reco_gen_cosTheta_0_65);//145
  hist_vec_200_CT_wO.push_back(h_200_CT_wO_DR07_dphi_reco_gen_cosTheta_0_65_to_0_80);
  hist_vec_200_CT_wO.push_back(h_200_CT_wO_DR07_dphi_reco_gen_cosTheta_0_80_to_0_925);
  hist_vec_200_CT_wO.push_back(h_200_CT_wO_DR07_dphi_reco_gen_cosTheta_0_925_to_0_975);
  hist_vec_200_CT_wO.push_back(h_200_CT_wO_DR07_dtheta_reco_gen_cosTheta_0_65);
  hist_vec_200_CT_wO.push_back(h_200_CT_wO_DR07_dtheta_reco_gen_cosTheta_0_65_to_0_80);
  hist_vec_200_CT_wO.push_back(h_200_CT_wO_DR07_dtheta_reco_gen_cosTheta_0_80_to_0_925);
  hist_vec_200_CT_wO.push_back(h_200_CT_wO_DR07_dtheta_reco_gen_cosTheta_0_925_to_0_975);

  hist_vec_200_CT_wO.push_back(h_200_CT_wO_DR10_dphi_reco_gen_cosTheta_0_65);//153
  hist_vec_200_CT_wO.push_back(h_200_CT_wO_DR10_dphi_reco_gen_cosTheta_0_65_to_0_80);
  hist_vec_200_CT_wO.push_back(h_200_CT_wO_DR10_dphi_reco_gen_cosTheta_0_80_to_0_925);
  hist_vec_200_CT_wO.push_back(h_200_CT_wO_DR10_dphi_reco_gen_cosTheta_0_925_to_0_975);
  hist_vec_200_CT_wO.push_back(h_200_CT_wO_DR10_dtheta_reco_gen_cosTheta_0_65);
  hist_vec_200_CT_wO.push_back(h_200_CT_wO_DR10_dtheta_reco_gen_cosTheta_0_65_to_0_80);
  hist_vec_200_CT_wO.push_back(h_200_CT_wO_DR10_dtheta_reco_gen_cosTheta_0_80_to_0_925);
  hist_vec_200_CT_wO.push_back(h_200_CT_wO_DR10_dtheta_reco_gen_cosTheta_0_925_to_0_975);


  for(unsigned int i=0;i<hist_vec_200_CT_wO.size();i++){
    hist_vec_200_CT_wO[i]->Sumw2();
  }
  fill_jet_histograms(file_CLIC_200_CT_wO,hist_vec_200_CT_wO);

  TH1F* h_200_CT_wO_DR05_dphi_SigmaCB_summary_histogram=new TH1F("dphiRes_SigmaCBVsCosTheta_CT_wO_DR05_200", "#sigma#Delta#phi(j_{reco},j_{true}) vs |cos#theta|", nRegionBinsAngles, pRegionBinEdgesAngles);
  h_200_CT_wO_DR05_dphi_SigmaCB_summary_histogram ->SetYTitle("#sigma#Delta#phi(j_{reco},j_{true})");
  h_200_CT_wO_DR05_dphi_SigmaCB_summary_histogram->SetXTitle("|cos#theta|");
  h_200_CT_wO_DR05_dphi_SigmaCB_summary_histogram->SetLineWidth(2);
  h_200_CT_wO_DR05_dphi_SigmaCB_summary_histogram->SetLineColor(kCyan+1);
  h_200_CT_wO_DR05_dphi_SigmaCB_summary_histogram->SetLineStyle(2);

  TH1F* h_200_CT_wO_DR05_dphi_RMS90_summary_histogram=new TH1F("dphiRes_RMS90VsCosTheta_CT_wO_DR05_200", "RMS_{90} #Delta#phi(j_{reco},j_{true}) vs |cos#theta|", nRegionBinsAngles, pRegionBinEdgesAngles);
  h_200_CT_wO_DR05_dphi_RMS90_summary_histogram ->SetYTitle("RMS_{90}#Delta#phi(j_{reco},j_{true})");
  h_200_CT_wO_DR05_dphi_RMS90_summary_histogram->SetXTitle("|cos#theta|");
  h_200_CT_wO_DR05_dphi_RMS90_summary_histogram->SetLineWidth(2);
  h_200_CT_wO_DR05_dphi_RMS90_summary_histogram->SetLineColor(kCyan+1);
  h_200_CT_wO_DR05_dphi_RMS90_summary_histogram->SetLineStyle(2);

  TH1F* h_200_CT_wO_DR07_dphi_SigmaCB_summary_histogram=new TH1F("dphiRes_SigmaCBVsCosTheta_CT_wO_DR07_200", "#sigma#Delta#phi(j_{reco},j_{true}) vs |cos#theta|", nRegionBinsAngles, pRegionBinEdgesAngles);
  h_200_CT_wO_DR07_dphi_SigmaCB_summary_histogram ->SetYTitle("#sigma#Delta#phi(j_{reco},j_{true})");
  h_200_CT_wO_DR07_dphi_SigmaCB_summary_histogram->SetXTitle("|cos#theta|");
  h_200_CT_wO_DR07_dphi_SigmaCB_summary_histogram->SetLineWidth(2);
  h_200_CT_wO_DR07_dphi_SigmaCB_summary_histogram->SetLineColor(kCyan+1);
  h_200_CT_wO_DR07_dphi_SigmaCB_summary_histogram->SetLineStyle(2);

  TH1F* h_200_CT_wO_DR07_dphi_RMS90_summary_histogram=new TH1F("dphiRes_RMS90VsCosTheta_CT_wO_DR07_200", "RMS_{90} #Delta#phi(j_{reco},j_{true}) vs |cos#theta|", nRegionBinsAngles, pRegionBinEdgesAngles);
  h_200_CT_wO_DR07_dphi_RMS90_summary_histogram ->SetYTitle("RMS_{90}#Delta#phi(j_{reco},j_{true})");
  h_200_CT_wO_DR07_dphi_RMS90_summary_histogram->SetXTitle("|cos#theta|");
  h_200_CT_wO_DR07_dphi_RMS90_summary_histogram->SetLineWidth(2);
  h_200_CT_wO_DR07_dphi_RMS90_summary_histogram->SetLineColor(kCyan+1);
  h_200_CT_wO_DR07_dphi_RMS90_summary_histogram->SetLineStyle(2);

  TH1F* h_200_CT_wO_DR10_dphi_SigmaCB_summary_histogram=new TH1F("dphiRes_SigmaCBVsCosTheta_CT_wO_DR10_200", "#sigma#Delta#phi(j_{reco},j_{true}) vs |cos#theta|", nRegionBinsAngles, pRegionBinEdgesAngles);
  h_200_CT_wO_DR10_dphi_SigmaCB_summary_histogram ->SetYTitle("#sigma#Delta#phi(j_{reco},j_{true})");
  h_200_CT_wO_DR10_dphi_SigmaCB_summary_histogram->SetXTitle("|cos#theta|");
  h_200_CT_wO_DR10_dphi_SigmaCB_summary_histogram->SetLineWidth(2);
  h_200_CT_wO_DR10_dphi_SigmaCB_summary_histogram->SetLineColor(kCyan+1);
  h_200_CT_wO_DR10_dphi_SigmaCB_summary_histogram->SetLineStyle(2);

  TH1F* h_200_CT_wO_DR10_dphi_RMS90_summary_histogram=new TH1F("dphiRes_RMS90VsCosTheta_CT_wO_DR10_200", "RMS_{90} #Delta#phi(j_{reco},j_{true}) vs |cos#theta|", nRegionBinsAngles, pRegionBinEdgesAngles);
  h_200_CT_wO_DR10_dphi_RMS90_summary_histogram ->SetYTitle("RMS_{90}#Delta#phi(j_{reco},j_{true})");
  h_200_CT_wO_DR10_dphi_RMS90_summary_histogram->SetXTitle("|cos#theta|");
  h_200_CT_wO_DR10_dphi_RMS90_summary_histogram->SetLineWidth(2);
  h_200_CT_wO_DR10_dphi_RMS90_summary_histogram->SetLineColor(kCyan+1);
  h_200_CT_wO_DR10_dphi_RMS90_summary_histogram->SetLineStyle(2);

  TH1F* h_200_CT_wO_DR05_dtheta_SigmaCB_summary_histogram=new TH1F("dthetaRes_SigmaCBVsCosTheta_CT_wO_DR05_200", "#sigma#Delta#theta(j_{reco},j_{true}) vs |cos#theta|", nRegionBinsAngles, pRegionBinEdgesAngles);
  h_200_CT_wO_DR05_dtheta_SigmaCB_summary_histogram ->SetYTitle("#sigma#Delta#theta(j_{reco},j_{true})");
  h_200_CT_wO_DR05_dtheta_SigmaCB_summary_histogram->SetXTitle("|cos#theta|");
  h_200_CT_wO_DR05_dtheta_SigmaCB_summary_histogram->SetLineWidth(2);
  h_200_CT_wO_DR05_dtheta_SigmaCB_summary_histogram->SetLineColor(kCyan+1);
  h_200_CT_wO_DR05_dtheta_SigmaCB_summary_histogram->SetLineStyle(2);

  TH1F* h_200_CT_wO_DR05_dtheta_RMS90_summary_histogram=new TH1F("dthetaRes_RMS90VsCosTheta_CT_wO_DR05_200", "RMS_{90} #Delta#theta(j_{reco},j_{true}) vs |cos#theta|", nRegionBinsAngles, pRegionBinEdgesAngles);
  h_200_CT_wO_DR05_dtheta_RMS90_summary_histogram ->SetYTitle("RMS_{90}#Delta#theta(j_{reco},j_{true})");
  h_200_CT_wO_DR05_dtheta_RMS90_summary_histogram->SetXTitle("|cos#theta|");
  h_200_CT_wO_DR05_dtheta_RMS90_summary_histogram->SetLineWidth(2);
  h_200_CT_wO_DR05_dtheta_RMS90_summary_histogram->SetLineColor(kCyan+1);
  h_200_CT_wO_DR05_dtheta_RMS90_summary_histogram->SetLineStyle(2);

  TH1F* h_200_CT_wO_DR07_dtheta_SigmaCB_summary_histogram=new TH1F("dthetaRes_SigmaCBVsCosTheta_CT_wO_DR07_200", "#sigma#Delta#theta(j_{reco},j_{true}) vs |cos#theta|", nRegionBinsAngles, pRegionBinEdgesAngles);
  h_200_CT_wO_DR07_dtheta_SigmaCB_summary_histogram ->SetYTitle("#sigma#Delta#theta(j_{reco},j_{true})");
  h_200_CT_wO_DR07_dtheta_SigmaCB_summary_histogram->SetXTitle("|cos#theta|");
  h_200_CT_wO_DR07_dtheta_SigmaCB_summary_histogram->SetLineWidth(2);
  h_200_CT_wO_DR07_dtheta_SigmaCB_summary_histogram->SetLineColor(kCyan+1);
  h_200_CT_wO_DR07_dtheta_SigmaCB_summary_histogram->SetLineStyle(2);

  TH1F* h_200_CT_wO_DR07_dtheta_RMS90_summary_histogram=new TH1F("dthetaRes_RMS90VsCosTheta_CT_wO_DR07_200", "RMS_{90} #Delta#theta(j_{reco},j_{true}) vs |cos#theta|", nRegionBinsAngles, pRegionBinEdgesAngles);
  h_200_CT_wO_DR07_dtheta_RMS90_summary_histogram ->SetYTitle("RMS_{90}#Delta#theta(j_{reco},j_{true})");
  h_200_CT_wO_DR07_dtheta_RMS90_summary_histogram->SetXTitle("|cos#theta|");
  h_200_CT_wO_DR07_dtheta_RMS90_summary_histogram->SetLineWidth(2);
  h_200_CT_wO_DR07_dtheta_RMS90_summary_histogram->SetLineColor(kCyan+1);
  h_200_CT_wO_DR07_dtheta_RMS90_summary_histogram->SetLineStyle(2);

  TH1F* h_200_CT_wO_DR10_dtheta_SigmaCB_summary_histogram=new TH1F("dthetaRes_SigmaCBVsCosTheta_CT_wO_DR10_200", "#sigma#Delta#theta(j_{reco},j_{true}) vs |cos#theta|", nRegionBinsAngles, pRegionBinEdgesAngles);
  h_200_CT_wO_DR10_dtheta_SigmaCB_summary_histogram ->SetYTitle("#sigma#Delta#theta(j_{reco},j_{true})");
  h_200_CT_wO_DR10_dtheta_SigmaCB_summary_histogram->SetXTitle("|cos#theta|");
  h_200_CT_wO_DR10_dtheta_SigmaCB_summary_histogram->SetLineWidth(2);
  h_200_CT_wO_DR10_dtheta_SigmaCB_summary_histogram->SetLineColor(kCyan+1);
  h_200_CT_wO_DR10_dtheta_SigmaCB_summary_histogram->SetLineStyle(2);

  TH1F* h_200_CT_wO_DR10_dtheta_RMS90_summary_histogram=new TH1F("dthetaRes_RMS90VsCosTheta_CT_wO_DR10_200", "RMS_{90} #Delta#theta(j_{reco},j_{true}) vs |cos#theta|", nRegionBinsAngles, pRegionBinEdgesAngles);
  h_200_CT_wO_DR10_dtheta_RMS90_summary_histogram ->SetYTitle("RMS_{90}#Delta#theta(j_{reco},j_{true})");
  h_200_CT_wO_DR10_dtheta_RMS90_summary_histogram->SetXTitle("|cos#theta|");
  h_200_CT_wO_DR10_dtheta_RMS90_summary_histogram->SetLineWidth(2);
  h_200_CT_wO_DR10_dtheta_RMS90_summary_histogram->SetLineColor(kCyan+1);
  h_200_CT_wO_DR10_dtheta_RMS90_summary_histogram->SetLineStyle(2);

  for(int i=137;i<161;i++){
    //continue;
    std::cout<<"ang histo 200 "<<i<<"]"<<std::endl;
   //double sided crystal ball
    TF1* fit_gaus_tmp = new TF1("fit_gaus_tmp", "gaus",-5.,5.);
    hist_vec_200_CT_wO[i]->Fit("fit_gaus_tmp","R");
    hist_vec_200_CT_wO[i]->GetFunction("fit_gaus_tmp");
    TF1* fdscb_tmp = new TF1("fdscb_tmp",fnc_dscb,-lim_angleDeg,lim_angleDeg,7);
   fdscb_tmp->SetNpx(2000);
    fdscb_tmp->SetParameter(0,fit_gaus_tmp->GetParameter(0));
    //norm
    fdscb_tmp->SetParLimits (0,0.5*fit_gaus_tmp->GetParameter(0),1.5*fit_gaus_tmp->GetParameter(0));
    fdscb_tmp->SetParameter(1,fit_gaus_tmp->GetParameter(1));
    //gaussian mean
    fdscb_tmp->SetParLimits (1,-2,2);
    fdscb_tmp->SetParameter(2,fit_gaus_tmp->GetParameter(2));
    fdscb_tmp->SetParLimits(2,fit_gaus_tmp->GetParameter(2)*0.50,1.50*fit_gaus_tmp->GetParameter(2));
    std::vector<float>sigma2SFit=sigmaGaussianFits2Sigma(hist_vec_200_CT_wO[i]);
    //fdscb_tmp->SetParameter(2,sigma2SFit[0]);
    //fdscb_tmp->SetParLimits(2,sigma2SFit[0]*0.50,1.50*sigma2SFit[0]);
    //-a1: parameter, from when the gaussian core should count
    fdscb_tmp->SetParameter(2,fit_gaus_tmp->GetParameter(2));
    fdscb_tmp->SetParameter (3,3.0);
    fdscb_tmp->SetParLimits (3,0.0,10.0);
    //a2 parameter, up to when the gaussian core should count
    fdscb_tmp->SetParameter (5,3.0);
    fdscb_tmp->SetParLimits (5,0.0,10.0);
    fdscb_tmp->SetParameter(4,5.);
    fdscb_tmp->SetParLimits(4,0.,25.);
    fdscb_tmp->SetParameter(6,5.);
    fdscb_tmp->SetParLimits(6,0.,25.);
    int fitstatus(0); 
    fitstatus = hist_vec_200_CT_wO[i]->Fit(fdscb_tmp,"R");
    fdscb_tmp = hist_vec_200_CT_wO[i]->GetFunction("fdscb_tmp");
    resolutionTH1=0; 
    resolutionErrorTH1=0;
    meanTH1=0;
    meanErrorTH1=0;
    CalculatePerformanceNoMean( hist_vec_200_CT_wO[i], resolutionTH1, resolutionErrorTH1,meanTH1,meanErrorTH1);
    int first_bin_ang=137;
    if(i<141){//dphi DR05
      first_bin_ang=137;
      h_200_CT_wO_DR05_dphi_SigmaCB_summary_histogram->SetBinContent(i-first_bin_ang+1,fdscb_tmp->GetParameter(2));
      h_200_CT_wO_DR05_dphi_SigmaCB_summary_histogram->SetBinError(i-first_bin_ang+1,fdscb_tmp->GetParError(2));
      h_200_CT_wO_DR05_dphi_RMS90_summary_histogram->SetBinContent(i-first_bin_ang+1,resolutionTH1);
      h_200_CT_wO_DR05_dphi_RMS90_summary_histogram->SetBinError(i-first_bin_ang+1, resolutionErrorTH1);
    }else if(i<145){//dtheta DR05
      first_bin_ang=141;
      h_200_CT_wO_DR05_dtheta_SigmaCB_summary_histogram->SetBinContent(i-first_bin_ang+1,fdscb_tmp->GetParameter(2));
      h_200_CT_wO_DR05_dtheta_SigmaCB_summary_histogram->SetBinError(i-first_bin_ang+1,fdscb_tmp->GetParError(2));
      h_200_CT_wO_DR05_dtheta_RMS90_summary_histogram->SetBinContent(i-first_bin_ang+1,resolutionTH1);
      h_200_CT_wO_DR05_dtheta_RMS90_summary_histogram->SetBinError(i-first_bin_ang+1, resolutionErrorTH1);
    }else if(i<149){//dphi DR07
      first_bin_ang=145;
      h_200_CT_wO_DR07_dphi_SigmaCB_summary_histogram->SetBinContent(i-first_bin_ang+1,fdscb_tmp->GetParameter(2));
      h_200_CT_wO_DR07_dphi_SigmaCB_summary_histogram->SetBinError(i-first_bin_ang+1,fdscb_tmp->GetParError(2));
      h_200_CT_wO_DR07_dphi_RMS90_summary_histogram->SetBinContent(i-first_bin_ang+1,resolutionTH1);
      h_200_CT_wO_DR07_dphi_RMS90_summary_histogram->SetBinError(i-first_bin_ang+1, resolutionErrorTH1);
    }else if(i<153){//dtheta DR07
      first_bin_ang=149;
      h_200_CT_wO_DR07_dtheta_SigmaCB_summary_histogram->SetBinContent(i-first_bin_ang+1,fdscb_tmp->GetParameter(2));
      h_200_CT_wO_DR07_dtheta_SigmaCB_summary_histogram->SetBinError(i-first_bin_ang+1,fdscb_tmp->GetParError(2));
      h_200_CT_wO_DR07_dtheta_RMS90_summary_histogram->SetBinContent(i-first_bin_ang+1,resolutionTH1);
      h_200_CT_wO_DR07_dtheta_RMS90_summary_histogram->SetBinError(i-first_bin_ang+1, resolutionErrorTH1);
    }else if(i<157){//dphi DR07
      first_bin_ang=153;
      h_200_CT_wO_DR10_dphi_SigmaCB_summary_histogram->SetBinContent(i-first_bin_ang+1,fdscb_tmp->GetParameter(2));
      h_200_CT_wO_DR10_dphi_SigmaCB_summary_histogram->SetBinError(i-first_bin_ang+1,fdscb_tmp->GetParError(2));
      h_200_CT_wO_DR10_dphi_RMS90_summary_histogram->SetBinContent(i-first_bin_ang+1,resolutionTH1);
      h_200_CT_wO_DR10_dphi_RMS90_summary_histogram->SetBinError(i-first_bin_ang+1, resolutionErrorTH1);
    }else if(i<161){//dtheta DR07
      first_bin_ang=157;
      h_200_CT_wO_DR10_dtheta_SigmaCB_summary_histogram->SetBinContent(i-first_bin_ang+1,fdscb_tmp->GetParameter(2));
      h_200_CT_wO_DR10_dtheta_SigmaCB_summary_histogram->SetBinError(i-first_bin_ang+1,fdscb_tmp->GetParError(2));
      h_200_CT_wO_DR10_dtheta_RMS90_summary_histogram->SetBinContent(i-first_bin_ang+1,resolutionTH1);
      h_200_CT_wO_DR10_dtheta_RMS90_summary_histogram->SetBinError(i-first_bin_ang+1, resolutionErrorTH1);
    }
  }

  TH1F* h_200_CT_wO_DR05_E_SigmaCB_summary_histogram=new TH1F("JER_SigmaCBVsCosTheta_CT_wO_DR05_200", "RMS_{90}(E_{j}^{reco}/E_{j}^{gen}) / Mean_{90}(E_{j}^{reco}/E_{j}^{gen}) vs |cos#theta|", nRegionBins, pRegionBinEdges);
  h_200_CT_wO_DR05_E_SigmaCB_summary_histogram ->SetYTitle("#sigma(E_{j}) / E_{j} [%]");
  h_200_CT_wO_DR05_E_SigmaCB_summary_histogram->SetXTitle("|cos#theta|");
  h_200_CT_wO_DR05_E_SigmaCB_summary_histogram->SetLineWidth(2);
  h_200_CT_wO_DR05_E_SigmaCB_summary_histogram->SetLineColor(kYellow+1);
  h_200_CT_wO_DR05_E_SigmaCB_summary_histogram->SetLineStyle(2);
  TH1F* h_200_CT_wO_DR05_E_RMS90_summary_histogram=new TH1F("JER_RMS90VsCosTheta_CT_wO_DR05_200", "RMS_{90}(E_{j}^{reco}/E_{j}^{gen}) / Mean_{90}(E_{j}^{reco}/E_{j}^{gen}) vs |cos#theta|", nRegionBins, pRegionBinEdges);
  h_200_CT_wO_DR05_E_RMS90_summary_histogram ->SetYTitle("RMS_{90}(E_{j}^{reco}/E_{j}^{gen}) / Mean_{90}(E_{j}^{reco}/E_{j}^{gen}) [%]");
  h_200_CT_wO_DR05_E_RMS90_summary_histogram->SetXTitle("|cos#theta|");
  h_200_CT_wO_DR05_E_RMS90_summary_histogram->SetLineWidth(2);
  h_200_CT_wO_DR05_E_RMS90_summary_histogram->SetLineColor(kRed);
  h_200_CT_wO_DR05_E_RMS90_summary_histogram->SetLineStyle(2);

  TH1F* h_200_CT_wO_DR05_E_RMS_summary_histogram=new TH1F("JER_RMSVsCosTheta_CT_wO_DR05_200", "RMS(E_{j}) / Mean(E_{j}) vs |cos#theta|", nRegionBins, pRegionBinEdges);
  h_200_CT_wO_DR05_E_RMS_summary_histogram ->SetYTitle("RMS(E_{j}) / Mean(E_{j}) [%]");
  h_200_CT_wO_DR05_E_RMS_summary_histogram->SetXTitle("|cos#theta|");
  h_200_CT_wO_DR05_E_RMS_summary_histogram->SetLineWidth(2);
  h_200_CT_wO_DR05_E_RMS_summary_histogram->SetLineColor(kRed);
  h_200_CT_wO_DR05_E_RMS_summary_histogram->SetLineStyle(2);

  TH1F* h_200_CT_wO_DR05_E_JER_Mean_summary_histogram=new TH1F("JER_MeanVsCosTheta_CT_wO_DR05_200", "Mean(E_{tot}^{RECO}/E_{tot}^{true}) vs |cos#theta|", nRegionBins, pRegionBinEdges);
  h_200_CT_wO_DR05_E_JER_Mean_summary_histogram->SetYTitle("Mean(E_{tot}^{RECO}/E_{tot}^{true})");
  h_200_CT_wO_DR05_E_JER_Mean_summary_histogram->SetXTitle("|cos#theta|");
  h_200_CT_wO_DR05_E_JER_Mean_summary_histogram->SetLineWidth(2);
  h_200_CT_wO_DR05_E_JER_Mean_summary_histogram->SetLineColor(kRed);
  h_200_CT_wO_DR05_E_JER_Mean_summary_histogram->SetLineStyle(2);

  firstbin=59;
  for(int i=firstbin;i<(firstbin+13);i++){
    //continue;
    resolutionTH1=0; 
    resolutionErrorTH1=0;
    meanTH1=0;
    meanErrorTH1=0;
    CalculatePerformance( hist_vec_200_CT_wO[i], resolutionTH1, resolutionErrorTH1,meanTH1,meanErrorTH1);
    h_200_CT_wO_DR05_E_RMS90_summary_histogram->SetBinContent(i-firstbin+1,resolutionTH1/sqrt(2.));
    h_200_CT_wO_DR05_E_RMS90_summary_histogram ->SetBinError(i-firstbin+1, resolutionErrorTH1/sqrt(2.));
    h_200_CT_wO_DR05_E_RMS_summary_histogram->SetBinContent(i-firstbin+1,hist_vec_200_CT_wO[i]->GetRMS()*100. );
    h_200_CT_wO_DR05_E_RMS_summary_histogram ->SetBinError(i-firstbin+1, hist_vec_200_CT_wO[i]->GetRMSError()*100.);
    h_200_CT_wO_DR05_E_JER_Mean_summary_histogram->SetBinContent(i-firstbin+1,hist_vec_200_CT_wO[i]->GetMean());
    h_200_CT_wO_DR05_E_JER_Mean_summary_histogram->SetBinError(i-firstbin+1,hist_vec_200_CT_wO[i]->GetMeanError());
    //double sided crystal ball
    TF1* fit_gaus_tmp = new TF1("fit_gaus_tmp", "gaus",0.50,1.50);
    hist_vec_200_CT_wO[i]->Fit("fit_gaus_tmp","R");
    hist_vec_200_CT_wO[i]->GetFunction("fit_gaus_tmp");

    TF1* fdscb_tmp = new TF1("fdscb_tmp",fnc_dscb,0.,3.,7);
    fdscb_tmp->SetNpx(1000);
    fdscb_tmp->SetParameter(0,fit_gaus_tmp->GetParameter(0));
    //norm
    fdscb_tmp->SetParLimits (0,0.5*fit_gaus_tmp->GetParameter(0),1.5*fit_gaus_tmp->GetParameter(0));
    fdscb_tmp->SetParameter(1,fit_gaus_tmp->GetParameter(1));
    //gaussian mean
    fdscb_tmp->SetParLimits (1,0.8,1.2);
    //fdscb_tmp->SetParameter(2,fit_gaus_tmp->GetParameter(2));
    //fdscb_tmp->SetParLimits(2,fit_gaus_tmp->GetParameter(2)*0.50,1.50*fit_gaus_tmp->GetParameter(2));
    std::vector<float>sigma2SFit=sigmaGaussianFits2Sigma(hist_vec_200_CT_wO[i]);
    fdscb_tmp->SetParameter(2,sigma2SFit[0]);
    fdscb_tmp->SetParLimits(2,sigma2SFit[0]*0.50,1.50*sigma2SFit[0]);
    //-a1: parameter, from when the gaussian core should count
    fdscb_tmp->SetParameter(2,fit_gaus_tmp->GetParameter(2));
    fdscb_tmp->SetParameter (3,3.0);
    fdscb_tmp->SetParLimits (3,0.0,10.0);
    //a2 parameter, up to when the gaussian core should count
    fdscb_tmp->SetParameter (5,3.0);
    fdscb_tmp->SetParLimits (5,0.0,10.0);
    fdscb_tmp->SetParameter(4,5.);
    fdscb_tmp->SetParLimits(4,0.,25.);
    fdscb_tmp->SetParameter(6,5.);
    fdscb_tmp->SetParLimits(6,0.,25.);
    int fitstatus(0); 
    fitstatus = hist_vec_200_CT_wO[i]->Fit(fdscb_tmp,"R");
    fdscb_tmp = hist_vec_200_CT_wO[i]->GetFunction("fdscb_tmp");
    h_200_CT_wO_DR05_E_SigmaCB_summary_histogram->SetBinContent(i-firstbin+1,fdscb_tmp->GetParameter(2)*100. );
    h_200_CT_wO_DR05_E_SigmaCB_summary_histogram->SetBinError(i-firstbin+1,fdscb_tmp->GetParError(2)*100. );
  }  
  TH1F* h_200_CT_wO_DR06_E_SigmaCB_summary_histogram=new TH1F("JER_SigmaCBVsCosTheta_CT_wO_DR06_200", "RMS_{90}(E_{j}^{reco}/E_{j}^{gen}) / Mean_{90}(E_{j}^{reco}/E_{j}^{gen}) vs |cos#theta|", nRegionBins, pRegionBinEdges);
  h_200_CT_wO_DR06_E_SigmaCB_summary_histogram ->SetYTitle("#sigma(E_{j}) / E_{j} [%]");
  h_200_CT_wO_DR06_E_SigmaCB_summary_histogram->SetXTitle("|cos#theta|");
  h_200_CT_wO_DR06_E_SigmaCB_summary_histogram->SetLineWidth(2);
  h_200_CT_wO_DR06_E_SigmaCB_summary_histogram->SetLineColor(kYellow+1);
  h_200_CT_wO_DR06_E_SigmaCB_summary_histogram->SetLineStyle(2);
  TH1F* h_200_CT_wO_DR06_E_RMS90_summary_histogram=new TH1F("JER_RMS90VsCosTheta_CT_wO_DR06_200", "RMS_{90}(E_{j}^{reco}/E_{j}^{gen}) / Mean_{90}(E_{j}^{reco}/E_{j}^{gen}) vs |cos#theta|", nRegionBins, pRegionBinEdges);
  h_200_CT_wO_DR06_E_RMS90_summary_histogram ->SetYTitle("RMS_{90}(E_{j}^{reco}/E_{j}^{gen}) / Mean_{90}(E_{j}^{reco}/E_{j}^{gen}) [%]");
  h_200_CT_wO_DR06_E_RMS90_summary_histogram->SetXTitle("|cos#theta|");
  h_200_CT_wO_DR06_E_RMS90_summary_histogram->SetLineWidth(2);
  h_200_CT_wO_DR06_E_RMS90_summary_histogram->SetLineColor(kRed);
  h_200_CT_wO_DR06_E_RMS90_summary_histogram->SetLineStyle(2);

  TH1F* h_200_CT_wO_DR06_E_RMS_summary_histogram=new TH1F("JER_RMSVsCosTheta_CT_wO_DR06_200", "RMS(E_{j}) / Mean(E_{j}) vs |cos#theta|", nRegionBins, pRegionBinEdges);
  h_200_CT_wO_DR06_E_RMS_summary_histogram ->SetYTitle("RMS(E_{j}) / Mean(E_{j}) [%]");
  h_200_CT_wO_DR06_E_RMS_summary_histogram->SetXTitle("|cos#theta|");
  h_200_CT_wO_DR06_E_RMS_summary_histogram->SetLineWidth(2);
  h_200_CT_wO_DR06_E_RMS_summary_histogram->SetLineColor(kRed);
  h_200_CT_wO_DR06_E_RMS_summary_histogram->SetLineStyle(2);

  TH1F* h_200_CT_wO_DR06_E_JER_Mean_summary_histogram=new TH1F("JER_MeanVsCosTheta_CT_wO_DR06_200", "Mean(E_{tot}^{RECO}/E_{tot}^{true}) vs |cos#theta|", nRegionBins, pRegionBinEdges);
  h_200_CT_wO_DR06_E_JER_Mean_summary_histogram->SetYTitle("Mean(E_{tot}^{RECO}/E_{tot}^{true})");
  h_200_CT_wO_DR06_E_JER_Mean_summary_histogram->SetXTitle("|cos#theta|");
  h_200_CT_wO_DR06_E_JER_Mean_summary_histogram->SetLineWidth(2);
  h_200_CT_wO_DR06_E_JER_Mean_summary_histogram->SetLineColor(kRed);
  h_200_CT_wO_DR06_E_JER_Mean_summary_histogram->SetLineStyle(2);
  firstbin=72;
  for(int i=firstbin;i<(firstbin+13);i++){
    //continue;
    resolutionTH1=0; 
    resolutionErrorTH1=0;
    meanTH1=0;
    meanErrorTH1=0;
    CalculatePerformance( hist_vec_200_CT_wO[i], resolutionTH1, resolutionErrorTH1,meanTH1,meanErrorTH1);
    h_200_CT_wO_DR06_E_RMS90_summary_histogram->SetBinContent(i-firstbin+1,resolutionTH1/sqrt(2.));
    h_200_CT_wO_DR06_E_RMS90_summary_histogram ->SetBinError(i-firstbin+1, resolutionErrorTH1/sqrt(2.));
    h_200_CT_wO_DR06_E_RMS_summary_histogram->SetBinContent(i-firstbin+1,hist_vec_200_CT_wO[i]->GetRMS()*100. );
    h_200_CT_wO_DR06_E_RMS_summary_histogram ->SetBinError(i-firstbin+1, hist_vec_200_CT_wO[i]->GetRMSError()*100.);
    h_200_CT_wO_DR06_E_JER_Mean_summary_histogram->SetBinContent(i-firstbin+1,hist_vec_200_CT_wO[i]->GetMean());
    h_200_CT_wO_DR06_E_JER_Mean_summary_histogram->SetBinError(i-firstbin+1,hist_vec_200_CT_wO[i]->GetMeanError());
    //double sided crystal ball
    TF1* fit_gaus_tmp = new TF1("fit_gaus_tmp", "gaus",0.50,1.50);
    hist_vec_200_CT_wO[i]->Fit("fit_gaus_tmp","R");
    hist_vec_200_CT_wO[i]->GetFunction("fit_gaus_tmp");

    TF1* fdscb_tmp = new TF1("fdscb_tmp",fnc_dscb,0.,3.,7);
    fdscb_tmp->SetNpx(1000);
    fdscb_tmp->SetParameter(0,fit_gaus_tmp->GetParameter(0));
    //norm
    fdscb_tmp->SetParLimits (0,0.5*fit_gaus_tmp->GetParameter(0),1.5*fit_gaus_tmp->GetParameter(0));
    fdscb_tmp->SetParameter(1,fit_gaus_tmp->GetParameter(1));
    //gaussian mean
    fdscb_tmp->SetParLimits (1,0.8,1.2);
    //fdscb_tmp->SetParameter(2,fit_gaus_tmp->GetParameter(2));
    //fdscb_tmp->SetParLimits(2,fit_gaus_tmp->GetParameter(2)*0.50,1.50*fit_gaus_tmp->GetParameter(2));
    std::vector<float>sigma2SFit=sigmaGaussianFits2Sigma(hist_vec_200_CT_wO[i]);
    fdscb_tmp->SetParameter(2,sigma2SFit[0]);
    fdscb_tmp->SetParLimits(2,sigma2SFit[0]*0.50,1.50*sigma2SFit[0]);
    //-a1: parameter, from when the gaussian core should count
    fdscb_tmp->SetParameter(2,fit_gaus_tmp->GetParameter(2));
    fdscb_tmp->SetParameter (3,3.0);
    fdscb_tmp->SetParLimits (3,0.0,10.0);
    //a2 parameter, up to when the gaussian core should count
    fdscb_tmp->SetParameter (5,3.0);
    fdscb_tmp->SetParLimits (5,0.0,10.0);
    fdscb_tmp->SetParameter(4,5.);
    fdscb_tmp->SetParLimits(4,0.,25.);
    fdscb_tmp->SetParameter(6,5.);
    fdscb_tmp->SetParLimits(6,0.,25.);
    int fitstatus(0); 
    fitstatus = hist_vec_200_CT_wO[i]->Fit(fdscb_tmp,"R");
    fdscb_tmp = hist_vec_200_CT_wO[i]->GetFunction("fdscb_tmp");
    h_200_CT_wO_DR06_E_SigmaCB_summary_histogram->SetBinContent(i-firstbin+1,fdscb_tmp->GetParameter(2)*100. );
    h_200_CT_wO_DR06_E_SigmaCB_summary_histogram->SetBinError(i-firstbin+1,fdscb_tmp->GetParError(2)*100. );
  }  
  TH1F* h_200_CT_wO_DR07_E_SigmaCB_summary_histogram=new TH1F("JER_SigmaCBVsCosTheta_CT_wO_DR07_200", "RMS_{90}(E_{j}^{reco}/E_{j}^{gen}) / Mean_{90}(E_{j}^{reco}/E_{j}^{gen}) vs |cos#theta|", nRegionBins, pRegionBinEdges);
  h_200_CT_wO_DR07_E_SigmaCB_summary_histogram ->SetYTitle("#sigma(E_{j}) / E_{j} [%]");
  h_200_CT_wO_DR07_E_SigmaCB_summary_histogram->SetXTitle("|cos#theta|");
  h_200_CT_wO_DR07_E_SigmaCB_summary_histogram->SetLineWidth(2);
  h_200_CT_wO_DR07_E_SigmaCB_summary_histogram->SetLineColor(kYellow+1);
  h_200_CT_wO_DR07_E_SigmaCB_summary_histogram->SetLineStyle(2);
  TH1F* h_200_CT_wO_DR07_E_RMS90_summary_histogram=new TH1F("JER_RMS90VsCosTheta_CT_wO_DR07_200", "RMS_{90}(E_{j}^{reco}/E_{j}^{gen}) / Mean_{90}(E_{j}^{reco}/E_{j}^{gen}) vs |cos#theta|", nRegionBins, pRegionBinEdges);
  h_200_CT_wO_DR07_E_RMS90_summary_histogram ->SetYTitle("RMS_{90}(E_{j}^{reco}/E_{j}^{gen}) / Mean_{90}(E_{j}^{reco}/E_{j}^{gen}) [%]");
  h_200_CT_wO_DR07_E_RMS90_summary_histogram->SetXTitle("|cos#theta|");
  h_200_CT_wO_DR07_E_RMS90_summary_histogram->SetLineWidth(2);
  h_200_CT_wO_DR07_E_RMS90_summary_histogram->SetLineColor(kRed);
  h_200_CT_wO_DR07_E_RMS90_summary_histogram->SetLineStyle(2);

  TH1F* h_200_CT_wO_DR07_E_RMS_summary_histogram=new TH1F("JER_RMSVsCosTheta_CT_wO_DR07_200", "RMS(E_{j}) / Mean(E_{j}) vs |cos#theta|", nRegionBins, pRegionBinEdges);
  h_200_CT_wO_DR07_E_RMS_summary_histogram ->SetYTitle("RMS(E_{j}) / Mean(E_{j}) [%]");
  h_200_CT_wO_DR07_E_RMS_summary_histogram->SetXTitle("|cos#theta|");
  h_200_CT_wO_DR07_E_RMS_summary_histogram->SetLineWidth(2);
  h_200_CT_wO_DR07_E_RMS_summary_histogram->SetLineColor(kRed);
  h_200_CT_wO_DR07_E_RMS_summary_histogram->SetLineStyle(2);

  TH1F* h_200_CT_wO_DR07_E_JER_Mean_summary_histogram=new TH1F("JER_MeanVsCosTheta_CT_wO_DR07_200", "Mean(E_{tot}^{RECO}/E_{tot}^{true}) vs |cos#theta|", nRegionBins, pRegionBinEdges);
  h_200_CT_wO_DR07_E_JER_Mean_summary_histogram->SetYTitle("Mean(E_{tot}^{RECO}/E_{tot}^{true})");
  h_200_CT_wO_DR07_E_JER_Mean_summary_histogram->SetXTitle("|cos#theta|");
  h_200_CT_wO_DR07_E_JER_Mean_summary_histogram->SetLineWidth(2);
  h_200_CT_wO_DR07_E_JER_Mean_summary_histogram->SetLineColor(kRed);
  h_200_CT_wO_DR07_E_JER_Mean_summary_histogram->SetLineStyle(2);
  firstbin=85;
  for(int i=firstbin;i<(firstbin+13);i++){
    //continue;
    resolutionTH1=0; 
    resolutionErrorTH1=0;
    meanTH1=0;
    meanErrorTH1=0;
    CalculatePerformance( hist_vec_200_CT_wO[i], resolutionTH1, resolutionErrorTH1,meanTH1,meanErrorTH1);
    h_200_CT_wO_DR07_E_RMS90_summary_histogram->SetBinContent(i-firstbin+1,resolutionTH1/sqrt(2.));
    h_200_CT_wO_DR07_E_RMS90_summary_histogram ->SetBinError(i-firstbin+1, resolutionErrorTH1/sqrt(2.));
    h_200_CT_wO_DR07_E_RMS_summary_histogram->SetBinContent(i-firstbin+1,hist_vec_200_CT_wO[i]->GetRMS()*100. );
    h_200_CT_wO_DR07_E_RMS_summary_histogram ->SetBinError(i-firstbin+1, hist_vec_200_CT_wO[i]->GetRMSError()*100.);
    h_200_CT_wO_DR07_E_JER_Mean_summary_histogram->SetBinContent(i-firstbin+1,hist_vec_200_CT_wO[i]->GetMean());
    h_200_CT_wO_DR07_E_JER_Mean_summary_histogram->SetBinError(i-firstbin+1,hist_vec_200_CT_wO[i]->GetMeanError());
    //double sided crystal ball
    TF1* fit_gaus_tmp = new TF1("fit_gaus_tmp", "gaus",0.50,1.50);
    hist_vec_200_CT_wO[i]->Fit("fit_gaus_tmp","R");
    hist_vec_200_CT_wO[i]->GetFunction("fit_gaus_tmp");
    TF1* fdscb_tmp = new TF1("fdscb_tmp",fnc_dscb,0.,3.,7);
    fdscb_tmp->SetNpx(1000);
    fdscb_tmp->SetParameter(0,fit_gaus_tmp->GetParameter(0));
    //norm
    fdscb_tmp->SetParLimits (0,0.5*fit_gaus_tmp->GetParameter(0),1.5*fit_gaus_tmp->GetParameter(0));
    fdscb_tmp->SetParameter(1,fit_gaus_tmp->GetParameter(1));
    //gaussian mean
    fdscb_tmp->SetParLimits (1,0.8,1.2);
    //fdscb_tmp->SetParameter(2,fit_gaus_tmp->GetParameter(2));
    //fdscb_tmp->SetParLimits(2,fit_gaus_tmp->GetParameter(2)*0.50,1.50*fit_gaus_tmp->GetParameter(2));
    std::vector<float>sigma2SFit=sigmaGaussianFits2Sigma(hist_vec_200_CT_wO[i]);
    fdscb_tmp->SetParameter(2,sigma2SFit[0]);
    fdscb_tmp->SetParLimits(2,sigma2SFit[0]*0.50,1.50*sigma2SFit[0]);
    std::cout<<"here for the 200 dataset "<<i<<" "<<" fit parameters "<< fit_gaus_tmp->GetParameter(2)<<" fit/fiterror "<<sigma2SFit[0]<<" "<<sigma2SFit[1]<<std::endl;
    fdscb_tmp->SetParameter (3,3.0);
    fdscb_tmp->SetParLimits (3,0.0,10.0);
    //a2 parameter, up to when the gaussian core should count
    fdscb_tmp->SetParameter (5,3.0);
    fdscb_tmp->SetParLimits (5,0.0,10.0);
    fdscb_tmp->SetParameter(4,5.);
    fdscb_tmp->SetParLimits(4,0.,25.);
    fdscb_tmp->SetParameter(6,5.);
    fdscb_tmp->SetParLimits(6,0.,25.);
    int fitstatus(0); 
    fitstatus = hist_vec_200_CT_wO[i]->Fit(fdscb_tmp,"R");
    fdscb_tmp = hist_vec_200_CT_wO[i]->GetFunction("fdscb_tmp");
    h_200_CT_wO_DR07_E_SigmaCB_summary_histogram->SetBinContent(i-firstbin+1,fdscb_tmp->GetParameter(2)*100. );
    h_200_CT_wO_DR07_E_SigmaCB_summary_histogram->SetBinError(i-firstbin+1,fdscb_tmp->GetParError(2)*100. );
  }  

  TH1F* h_200_CT_wO_DR08_E_SigmaCB_summary_histogram=new TH1F("JER_SigmaCBVsCosTheta_CT_wO_DR08_200", "RMS_{90}(E_{j}^{reco}/E_{j}^{gen}) / Mean_{90}(E_{j}^{reco}/E_{j}^{gen}) vs |cos#theta|", nRegionBins, pRegionBinEdges);
  h_200_CT_wO_DR08_E_SigmaCB_summary_histogram ->SetYTitle("#sigma(E_{j}) / E_{j} [%]");
  h_200_CT_wO_DR08_E_SigmaCB_summary_histogram->SetXTitle("|cos#theta|");
  h_200_CT_wO_DR08_E_SigmaCB_summary_histogram->SetLineWidth(2);
  h_200_CT_wO_DR08_E_SigmaCB_summary_histogram->SetLineColor(kYellow+1);
  h_200_CT_wO_DR08_E_SigmaCB_summary_histogram->SetLineStyle(2);
  TH1F* h_200_CT_wO_DR08_E_RMS90_summary_histogram=new TH1F("JER_RMS90VsCosTheta_CT_wO_DR08_200", "RMS_{90}(E_{j}^{reco}/E_{j}^{gen}) / Mean_{90}(E_{j}^{reco}/E_{j}^{gen}) vs |cos#theta|", nRegionBins, pRegionBinEdges);
  h_200_CT_wO_DR08_E_RMS90_summary_histogram ->SetYTitle("RMS_{90}(E_{j}^{reco}/E_{j}^{gen}) / Mean_{90}(E_{j}^{reco}/E_{j}^{gen}) [%]");
  h_200_CT_wO_DR08_E_RMS90_summary_histogram->SetXTitle("|cos#theta|");
  h_200_CT_wO_DR08_E_RMS90_summary_histogram->SetLineWidth(2);
  h_200_CT_wO_DR08_E_RMS90_summary_histogram->SetLineColor(kRed);
  h_200_CT_wO_DR08_E_RMS90_summary_histogram->SetLineStyle(2);

  TH1F* h_200_CT_wO_DR08_E_RMS_summary_histogram=new TH1F("JER_RMSVsCosTheta_CT_wO_DR08_200", "RMS(E_{j}) / Mean(E_{j}) vs |cos#theta|", nRegionBins, pRegionBinEdges);
  h_200_CT_wO_DR08_E_RMS_summary_histogram ->SetYTitle("RMS(E_{j}) / Mean(E_{j}) [%]");
  h_200_CT_wO_DR08_E_RMS_summary_histogram->SetXTitle("|cos#theta|");
  h_200_CT_wO_DR08_E_RMS_summary_histogram->SetLineWidth(2);
  h_200_CT_wO_DR08_E_RMS_summary_histogram->SetLineColor(kRed);
  h_200_CT_wO_DR08_E_RMS_summary_histogram->SetLineStyle(2);

  TH1F* h_200_CT_wO_DR08_E_JER_Mean_summary_histogram=new TH1F("JER_MeanVsCosTheta_CT_wO_DR08_200", "Mean(E_{tot}^{RECO}/E_{tot}^{true}) vs |cos#theta|", nRegionBins, pRegionBinEdges);
  h_200_CT_wO_DR08_E_JER_Mean_summary_histogram->SetYTitle("Mean(E_{tot}^{RECO}/E_{tot}^{true})");
  h_200_CT_wO_DR08_E_JER_Mean_summary_histogram->SetXTitle("|cos#theta|");
  h_200_CT_wO_DR08_E_JER_Mean_summary_histogram->SetLineWidth(2);
  h_200_CT_wO_DR08_E_JER_Mean_summary_histogram->SetLineColor(kRed);
  h_200_CT_wO_DR08_E_JER_Mean_summary_histogram->SetLineStyle(2);
  firstbin=98;
  for(int i=firstbin;i<(firstbin+13);i++){
    //continue;
    resolutionTH1=0; 
    resolutionErrorTH1=0;
    meanTH1=0;
    meanErrorTH1=0;
    CalculatePerformance( hist_vec_200_CT_wO[i], resolutionTH1, resolutionErrorTH1,meanTH1,meanErrorTH1);
    h_200_CT_wO_DR08_E_RMS90_summary_histogram->SetBinContent(i-firstbin+1,resolutionTH1/sqrt(2.));
    h_200_CT_wO_DR08_E_RMS90_summary_histogram ->SetBinError(i-firstbin+1, resolutionErrorTH1/sqrt(2.));
    h_200_CT_wO_DR08_E_RMS_summary_histogram->SetBinContent(i-firstbin+1,hist_vec_200_CT_wO[i]->GetRMS()*100. );
    h_200_CT_wO_DR08_E_RMS_summary_histogram ->SetBinError(i-firstbin+1, hist_vec_200_CT_wO[i]->GetRMSError()*100.);
    h_200_CT_wO_DR08_E_JER_Mean_summary_histogram->SetBinContent(i-firstbin+1,hist_vec_200_CT_wO[i]->GetMean());
    h_200_CT_wO_DR08_E_JER_Mean_summary_histogram->SetBinError(i-firstbin+1,hist_vec_200_CT_wO[i]->GetMeanError());
    //double sided crystal ball
    TF1* fit_gaus_tmp = new TF1("fit_gaus_tmp", "gaus",0.50,1.50);
    hist_vec_200_CT_wO[i]->Fit("fit_gaus_tmp","R");
    hist_vec_200_CT_wO[i]->GetFunction("fit_gaus_tmp");

    TF1* fdscb_tmp = new TF1("fdscb_tmp",fnc_dscb,0.,3.,7);
   fdscb_tmp->SetNpx(1000);
    fdscb_tmp->SetParameter(0,fit_gaus_tmp->GetParameter(0));
    //norm
    fdscb_tmp->SetParLimits (0,0.5*fit_gaus_tmp->GetParameter(0),1.5*fit_gaus_tmp->GetParameter(0));
    fdscb_tmp->SetParameter(1,fit_gaus_tmp->GetParameter(1));
    //gaussian mean
    fdscb_tmp->SetParLimits (1,0.8,1.2);
    //fdscb_tmp->SetParameter(2,fit_gaus_tmp->GetParameter(2));
    //fdscb_tmp->SetParLimits(2,fit_gaus_tmp->GetParameter(2)*0.50,1.50*fit_gaus_tmp->GetParameter(2));
    std::vector<float>sigma2SFit=sigmaGaussianFits2Sigma(hist_vec_200_CT_wO[i]);
    fdscb_tmp->SetParameter(2,sigma2SFit[0]);
    fdscb_tmp->SetParLimits(2,sigma2SFit[0]*0.50,1.50*sigma2SFit[0]);
    //-a1: parameter, from when the gaussian core should count
    fdscb_tmp->SetParameter(2,fit_gaus_tmp->GetParameter(2));
    fdscb_tmp->SetParameter (3,3.0);
    fdscb_tmp->SetParLimits (3,0.0,10.0);
    //a2 parameter, up to when the gaussian core should count
    fdscb_tmp->SetParameter (5,3.0);
    fdscb_tmp->SetParLimits (5,0.0,10.0);
    fdscb_tmp->SetParameter(4,5.);
    fdscb_tmp->SetParLimits(4,0.,25.);
    fdscb_tmp->SetParameter(6,5.);
    fdscb_tmp->SetParLimits(6,0.,25.);
    int fitstatus(0); 
    fitstatus = hist_vec_200_CT_wO[i]->Fit(fdscb_tmp,"R");
    fdscb_tmp = hist_vec_200_CT_wO[i]->GetFunction("fdscb_tmp");
    h_200_CT_wO_DR08_E_SigmaCB_summary_histogram->SetBinContent(i-firstbin+1,fdscb_tmp->GetParameter(2)*100. );
    h_200_CT_wO_DR08_E_SigmaCB_summary_histogram->SetBinError(i-firstbin+1,fdscb_tmp->GetParError(2)*100. );
  }  
  TH1F* h_200_CT_wO_DR09_E_SigmaCB_summary_histogram=new TH1F("JER_SigmaCBVsCosTheta_CT_wO_DR09_200", "RMS_{90}(E_{j}^{reco}/E_{j}^{gen}) / Mean_{90}(E_{j}^{reco}/E_{j}^{gen}) vs |cos#theta|", nRegionBins, pRegionBinEdges);
  h_200_CT_wO_DR09_E_SigmaCB_summary_histogram ->SetYTitle("#sigma(E_{j}) / E_{j} [%]");
  h_200_CT_wO_DR09_E_SigmaCB_summary_histogram->SetXTitle("|cos#theta|");
  h_200_CT_wO_DR09_E_SigmaCB_summary_histogram->SetLineWidth(2);
  h_200_CT_wO_DR09_E_SigmaCB_summary_histogram->SetLineColor(kYellow+1);
  h_200_CT_wO_DR09_E_SigmaCB_summary_histogram->SetLineStyle(2);
  TH1F* h_200_CT_wO_DR09_E_RMS90_summary_histogram=new TH1F("JER_RMS90VsCosTheta_CT_wO_DR09_200", "RMS_{90}(E_{j}^{reco}/E_{j}^{gen}) / Mean_{90}(E_{j}^{reco}/E_{j}^{gen}) vs |cos#theta|", nRegionBins, pRegionBinEdges);
  h_200_CT_wO_DR09_E_RMS90_summary_histogram ->SetYTitle("RMS_{90}(E_{j}^{reco}/E_{j}^{gen}) / Mean_{90}(E_{j}^{reco}/E_{j}^{gen}) [%]");
  h_200_CT_wO_DR09_E_RMS90_summary_histogram->SetXTitle("|cos#theta|");
  h_200_CT_wO_DR09_E_RMS90_summary_histogram->SetLineWidth(2);
  h_200_CT_wO_DR09_E_RMS90_summary_histogram->SetLineColor(kRed);
  h_200_CT_wO_DR09_E_RMS90_summary_histogram->SetLineStyle(2);

  TH1F* h_200_CT_wO_DR09_E_RMS_summary_histogram=new TH1F("JER_RMSVsCosTheta_CT_wO_DR09_200", "RMS(E_{j}) / Mean(E_{j}) vs |cos#theta|", nRegionBins, pRegionBinEdges);
  h_200_CT_wO_DR09_E_RMS_summary_histogram ->SetYTitle("RMS(E_{j}) / Mean(E_{j}) [%]");
  h_200_CT_wO_DR09_E_RMS_summary_histogram->SetXTitle("|cos#theta|");
  h_200_CT_wO_DR09_E_RMS_summary_histogram->SetLineWidth(2);
  h_200_CT_wO_DR09_E_RMS_summary_histogram->SetLineColor(kRed);
  h_200_CT_wO_DR09_E_RMS_summary_histogram->SetLineStyle(2);

  TH1F* h_200_CT_wO_DR09_E_JER_Mean_summary_histogram=new TH1F("JER_MeanVsCosTheta_CT_wO_DR09_200", "Mean(E_{tot}^{RECO}/E_{tot}^{true}) vs |cos#theta|", nRegionBins, pRegionBinEdges);
  h_200_CT_wO_DR09_E_JER_Mean_summary_histogram->SetYTitle("Mean(E_{tot}^{RECO}/E_{tot}^{true})");
  h_200_CT_wO_DR09_E_JER_Mean_summary_histogram->SetXTitle("|cos#theta|");
  h_200_CT_wO_DR09_E_JER_Mean_summary_histogram->SetLineWidth(2);
  h_200_CT_wO_DR09_E_JER_Mean_summary_histogram->SetLineColor(kRed);
  h_200_CT_wO_DR09_E_JER_Mean_summary_histogram->SetLineStyle(2);
  firstbin=111;
  for(int i=firstbin;i<(firstbin+13);i++){
    //continue;
    resolutionTH1=0; 
    resolutionErrorTH1=0;
    meanTH1=0;
    meanErrorTH1=0;
    CalculatePerformance( hist_vec_200_CT_wO[i], resolutionTH1, resolutionErrorTH1,meanTH1,meanErrorTH1);
    h_200_CT_wO_DR09_E_RMS90_summary_histogram->SetBinContent(i-firstbin+1,resolutionTH1/sqrt(2.));
    h_200_CT_wO_DR09_E_RMS90_summary_histogram ->SetBinError(i-firstbin+1, resolutionErrorTH1/sqrt(2.));
    h_200_CT_wO_DR09_E_RMS_summary_histogram->SetBinContent(i-firstbin+1,hist_vec_200_CT_wO[i]->GetRMS()*100. );
    h_200_CT_wO_DR09_E_RMS_summary_histogram ->SetBinError(i-firstbin+1, hist_vec_200_CT_wO[i]->GetRMSError()*100.);
    h_200_CT_wO_DR09_E_JER_Mean_summary_histogram->SetBinContent(i-firstbin+1,hist_vec_200_CT_wO[i]->GetMean());
    h_200_CT_wO_DR09_E_JER_Mean_summary_histogram->SetBinError(i-firstbin+1,hist_vec_200_CT_wO[i]->GetMeanError());
    //double sided crystal ball
    TF1* fit_gaus_tmp = new TF1("fit_gaus_tmp", "gaus",0.50,1.50);
    hist_vec_200_CT_wO[i]->Fit("fit_gaus_tmp","R");
    hist_vec_200_CT_wO[i]->GetFunction("fit_gaus_tmp");

    TF1* fdscb_tmp = new TF1("fdscb_tmp",fnc_dscb,0.,3.,7);
   fdscb_tmp->SetNpx(1000);
    fdscb_tmp->SetParameter(0,fit_gaus_tmp->GetParameter(0));
    //norm
    fdscb_tmp->SetParLimits (0,0.5*fit_gaus_tmp->GetParameter(0),1.5*fit_gaus_tmp->GetParameter(0));
    fdscb_tmp->SetParameter(1,fit_gaus_tmp->GetParameter(1));
    //gaussian mean
    fdscb_tmp->SetParLimits (1,0.8,1.2);
    //fdscb_tmp->SetParameter(2,fit_gaus_tmp->GetParameter(2));
    //fdscb_tmp->SetParLimits(2,fit_gaus_tmp->GetParameter(2)*0.50,1.50*fit_gaus_tmp->GetParameter(2));
    std::vector<float>sigma2SFit=sigmaGaussianFits2Sigma(hist_vec_200_CT_wO[i]);
    fdscb_tmp->SetParameter(2,sigma2SFit[0]);
    fdscb_tmp->SetParLimits(2,sigma2SFit[0]*0.50,1.50*sigma2SFit[0]);
    //-a1: parameter, from when the gaussian core should count
    fdscb_tmp->SetParameter(2,fit_gaus_tmp->GetParameter(2));
    fdscb_tmp->SetParameter (3,3.0);
    fdscb_tmp->SetParLimits (3,0.0,10.0);
    //a2 parameter, up to when the gaussian core should count
    fdscb_tmp->SetParameter (5,3.0);
    fdscb_tmp->SetParLimits (5,0.0,10.0);
    fdscb_tmp->SetParameter(4,5.);
    fdscb_tmp->SetParLimits(4,0.,25.);
    fdscb_tmp->SetParameter(6,5.);
    fdscb_tmp->SetParLimits(6,0.,25.);
    int fitstatus(0); 
    fitstatus = hist_vec_200_CT_wO[i]->Fit(fdscb_tmp,"R");
    fdscb_tmp = hist_vec_200_CT_wO[i]->GetFunction("fdscb_tmp");
    h_200_CT_wO_DR09_E_SigmaCB_summary_histogram->SetBinContent(i-firstbin+1,fdscb_tmp->GetParameter(2)*100. );
    h_200_CT_wO_DR09_E_SigmaCB_summary_histogram->SetBinError(i-firstbin+1,fdscb_tmp->GetParError(2)*100. );
  }  
  TH1F* h_200_CT_wO_DR10_E_SigmaCB_summary_histogram=new TH1F("JER_SigmaCBVsCosTheta_CT_wO_DR10_200", "RMS_{90}(E_{j}^{reco}/E_{j}^{gen}) / Mean_{90}(E_{j}^{reco}/E_{j}^{gen}) vs |cos#theta|", nRegionBins, pRegionBinEdges);
  h_200_CT_wO_DR10_E_SigmaCB_summary_histogram ->SetYTitle("#sigma(E_{j}) / E_{j} [%]");
  h_200_CT_wO_DR10_E_SigmaCB_summary_histogram->SetXTitle("|cos#theta|");
  h_200_CT_wO_DR10_E_SigmaCB_summary_histogram->SetLineWidth(2);
  h_200_CT_wO_DR10_E_SigmaCB_summary_histogram->SetLineColor(kYellow+1);
  h_200_CT_wO_DR10_E_SigmaCB_summary_histogram->SetLineStyle(2);
  TH1F* h_200_CT_wO_DR10_E_RMS90_summary_histogram=new TH1F("JER_RMS90VsCosTheta_CT_wO_DR10_200", "RMS_{90}(E_{j}^{reco}/E_{j}^{gen}) / Mean_{90}(E_{j}^{reco}/E_{j}^{gen}) vs |cos#theta|", nRegionBins, pRegionBinEdges);
  h_200_CT_wO_DR10_E_RMS90_summary_histogram ->SetYTitle("RMS_{90}(E_{j}^{reco}/E_{j}^{gen}) / Mean_{90}(E_{j}^{reco}/E_{j}^{gen}) [%]");
  h_200_CT_wO_DR10_E_RMS90_summary_histogram->SetXTitle("|cos#theta|");
  h_200_CT_wO_DR10_E_RMS90_summary_histogram->SetLineWidth(2);
  h_200_CT_wO_DR10_E_RMS90_summary_histogram->SetLineColor(kRed);
  h_200_CT_wO_DR10_E_RMS90_summary_histogram->SetLineStyle(2);

  TH1F* h_200_CT_wO_DR10_E_RMS_summary_histogram=new TH1F("JER_RMSVsCosTheta_CT_wO_DR10_200", "RMS(E_{j}) / Mean(E_{j}) vs |cos#theta|", nRegionBins, pRegionBinEdges);
  h_200_CT_wO_DR10_E_RMS_summary_histogram ->SetYTitle("RMS(E_{j}) / Mean(E_{j}) [%]");
  h_200_CT_wO_DR10_E_RMS_summary_histogram->SetXTitle("|cos#theta|");
  h_200_CT_wO_DR10_E_RMS_summary_histogram->SetLineWidth(2);
  h_200_CT_wO_DR10_E_RMS_summary_histogram->SetLineColor(kRed);
  h_200_CT_wO_DR10_E_RMS_summary_histogram->SetLineStyle(2);

  TH1F* h_200_CT_wO_DR10_E_JER_Mean_summary_histogram=new TH1F("JER_MeanVsCosTheta_CT_wO_DR10_200", "Mean(E_{tot}^{RECO}/E_{tot}^{true}) vs |cos#theta|", nRegionBins, pRegionBinEdges);
  h_200_CT_wO_DR10_E_JER_Mean_summary_histogram->SetYTitle("Mean(E_{tot}^{RECO}/E_{tot}^{true})");
  h_200_CT_wO_DR10_E_JER_Mean_summary_histogram->SetXTitle("|cos#theta|");
  h_200_CT_wO_DR10_E_JER_Mean_summary_histogram->SetLineWidth(2);
  h_200_CT_wO_DR10_E_JER_Mean_summary_histogram->SetLineColor(kRed);
  h_200_CT_wO_DR10_E_JER_Mean_summary_histogram->SetLineStyle(2);
  firstbin=124;
  for(int i=firstbin;i<(firstbin+13);i++){
    //continue;
    resolutionTH1=0; 
    resolutionErrorTH1=0;
    meanTH1=0;
    meanErrorTH1=0;
    CalculatePerformance( hist_vec_200_CT_wO[i], resolutionTH1, resolutionErrorTH1,meanTH1,meanErrorTH1);
    h_200_CT_wO_DR10_E_RMS90_summary_histogram->SetBinContent(i-firstbin+1,resolutionTH1/sqrt(2.));
    h_200_CT_wO_DR10_E_RMS90_summary_histogram ->SetBinError(i-firstbin+1, resolutionErrorTH1/sqrt(2.));
    h_200_CT_wO_DR10_E_RMS_summary_histogram->SetBinContent(i-firstbin+1,hist_vec_200_CT_wO[i]->GetRMS()*100. );
    h_200_CT_wO_DR10_E_RMS_summary_histogram ->SetBinError(i-firstbin+1, hist_vec_200_CT_wO[i]->GetRMSError()*100.);
    h_200_CT_wO_DR10_E_JER_Mean_summary_histogram->SetBinContent(i-firstbin+1,hist_vec_200_CT_wO[i]->GetMean());
    h_200_CT_wO_DR10_E_JER_Mean_summary_histogram->SetBinError(i-firstbin+1,hist_vec_200_CT_wO[i]->GetMeanError());
    //double sided crystal ball
    TF1* fit_gaus_tmp = new TF1("fit_gaus_tmp", "gaus",0.50,1.50);
    hist_vec_200_CT_wO[i]->Fit("fit_gaus_tmp","R");
    hist_vec_200_CT_wO[i]->GetFunction("fit_gaus_tmp");

    TF1* fdscb_tmp = new TF1("fdscb_tmp",fnc_dscb,0.,3.,7);
   fdscb_tmp->SetNpx(1000);
    fdscb_tmp->SetParameter(0,fit_gaus_tmp->GetParameter(0));
    //norm
    fdscb_tmp->SetParLimits (0,0.5*fit_gaus_tmp->GetParameter(0),1.5*fit_gaus_tmp->GetParameter(0));
    fdscb_tmp->SetParameter(1,fit_gaus_tmp->GetParameter(1));
    //gaussian mean
    fdscb_tmp->SetParLimits (1,0.8,1.2);
    //fdscb_tmp->SetParameter(2,fit_gaus_tmp->GetParameter(2));
    //fdscb_tmp->SetParLimits(2,fit_gaus_tmp->GetParameter(2)*0.50,1.50*fit_gaus_tmp->GetParameter(2));
    std::vector<float>sigma2SFit=sigmaGaussianFits2Sigma(hist_vec_200_CT_wO[i]);
    fdscb_tmp->SetParameter(2,sigma2SFit[0]);
    fdscb_tmp->SetParLimits(2,sigma2SFit[0]*0.50,1.50*sigma2SFit[0]);
    //-a1: parameter, from when the gaussian core should count
    fdscb_tmp->SetParameter(2,fit_gaus_tmp->GetParameter(2));
    fdscb_tmp->SetParameter (3,3.0);
    fdscb_tmp->SetParLimits (3,0.0,10.0);
    //a2 parameter, up to when the gaussian core should count
    fdscb_tmp->SetParameter (5,3.0);
    fdscb_tmp->SetParLimits (5,0.0,10.0);
    fdscb_tmp->SetParameter(4,5.);
    fdscb_tmp->SetParLimits(4,0.,25.);
    fdscb_tmp->SetParameter(6,5.);
    fdscb_tmp->SetParLimits(6,0.,25.);
    int fitstatus(0); 
    fitstatus = hist_vec_200_CT_wO[i]->Fit(fdscb_tmp,"R");
    fdscb_tmp = hist_vec_200_CT_wO[i]->GetFunction("fdscb_tmp");
    h_200_CT_wO_DR10_E_SigmaCB_summary_histogram->SetBinContent(i-firstbin+1,fdscb_tmp->GetParameter(2)*100. );
    h_200_CT_wO_DR10_E_SigmaCB_summary_histogram->SetBinError(i-firstbin+1,fdscb_tmp->GetParError(2)*100. );
  }  

  std::cout<<"200 wO 03/04/05/06 "<< calculate_over90(h_200_CT_wO_recojet03_E1_E2_over_E_True)<<"/"<< calculate_over90(h_200_CT_wO_recojet04_E1_E2_over_E_True)<<"/"<< calculate_over90(h_200_CT_wO_recojet05_E1_E2_over_E_True)<<"/"<<calculate_over90(h_200_CT_wO_recojet06_E1_E2_over_E_True)<<" 07/08/09/10 "<< calculate_over90(h_200_CT_wO_recojet07_E1_E2_over_E_True)<<"/"<< calculate_over90(h_200_CT_wO_recojet08_E1_E2_over_E_True)<<"/"<< calculate_over90(h_200_CT_wO_recojet09_E1_E2_over_E_True)<<"/"<<calculate_over90(h_200_CT_wO_recojet10_E1_E2_over_E_True)<<std::endl;
  std::cout<<"jet histos 200 CT_wO filled"<<std::endl;

  TH1F* h_380_CT_genjet03_dphi_j1j2 =  new TH1F("h_380_CT_genjet03_dphi_j1j2","", n_bins100, 0.5,TMath::Pi());
  TH1F* h_380_CT_genjet03_E1_E2_over_E_True =  new TH1F("h_380_CT_genjet03_E1_E2_over_E_True","", n_bins100, 0.5,1.00);
  TH1F* h_380_CT_genjet03_Delta_E1_E2_over_E12 =  new TH1F("h_380_CT_genjet03_Delta_E1_E2_over_E12","", n_bins100, -0.5,0.5);
  TH1F* h_380_CT_genjet04_dphi_j1j2 =  new TH1F("h_380_CT_genjet04_dphi_j1j2","", n_bins100, 0.5,TMath::Pi());
  TH1F* h_380_CT_genjet04_E1_E2_over_E_True =  new TH1F("h_380_CT_genjet04_E1_E2_over_E_True","", n_bins100, 0.5,1.00);
  TH1F* h_380_CT_genjet04_Delta_E1_E2_over_E12 =  new TH1F("h_380_CT_genjet04_Delta_E1_E2_over_E12","", n_bins100, -0.5,0.5);
  TH1F* h_380_CT_genjet05_dphi_j1j2 =  new TH1F("h_380_CT_genjet05_dphi_j1j2","", n_bins100, 0.5,TMath::Pi());
  TH1F* h_380_CT_genjet05_E1_E2_over_E_True =  new TH1F("h_380_CT_genjet05_E1_E2_over_E_True","", n_bins100, 0.5,1.00);
  TH1F* h_380_CT_genjet05_Delta_E1_E2_over_E12 =  new TH1F("h_380_CT_genjet05_Delta_E1_E2_over_E12","", n_bins100, -0.5,0.5);
  TH1F* h_380_CT_genjet06_dphi_j1j2 =  new TH1F("h_380_CT_genjet06_dphi_j1j2","", n_bins100, 0.5,TMath::Pi());
  TH1F* h_380_CT_genjet06_E1_E2_over_E_True =  new TH1F("h_380_CT_genjet06_E1_E2_over_E_True","", n_bins100, 0.5,1.00);
  TH1F* h_380_CT_genjet06_Delta_E1_E2_over_E12 =  new TH1F("h_380_CT_genjet06_Delta_E1_E2_over_E12","", n_bins100, -0.5,0.5);
  TH1F* h_380_CT_genjet07_dphi_j1j2 =  new TH1F("h_380_CT_genjet07_dphi_j1j2","", n_bins100, 0.5,TMath::Pi());
  TH1F* h_380_CT_genjet07_E1_E2_over_E_True =  new TH1F("h_380_CT_genjet07_E1_E2_over_E_True","", n_bins100, 0.5,1.00);
  TH1F* h_380_CT_genjet07_Delta_E1_E2_over_E12 =  new TH1F("h_380_CT_genjet07_Delta_E1_E2_over_E12","", n_bins100, -0.5,0.5);
  TH1F* h_380_CT_genjet08_dphi_j1j2 =  new TH1F("h_380_CT_genjet08_dphi_j1j2","", n_bins100, 0.5,TMath::Pi());
  TH1F* h_380_CT_genjet08_E1_E2_over_E_True =  new TH1F("h_380_CT_genjet08_E1_E2_over_E_True","", n_bins100, 0.5,1.00);
  TH1F* h_380_CT_genjet08_Delta_E1_E2_over_E12 =  new TH1F("h_380_CT_genjet08_Delta_E1_E2_over_E12","", n_bins100, -0.5,0.5);
  TH1F* h_380_CT_genjet09_dphi_j1j2 =  new TH1F("h_380_CT_genjet09_dphi_j1j2","", n_bins100, 0.5,TMath::Pi());
  TH1F* h_380_CT_genjet09_E1_E2_over_E_True =  new TH1F("h_380_CT_genjet09_E1_E2_over_E_True","", n_bins100, 0.5,1.00);
  TH1F* h_380_CT_genjet09_Delta_E1_E2_over_E12 =  new TH1F("h_380_CT_genjet09_Delta_E1_E2_over_E12","", n_bins100, -0.5,0.5);
  TH1F* h_380_CT_genjet10_dphi_j1j2 =  new TH1F("h_380_CT_genjet10_dphi_j1j2","", n_bins100, 0.5,TMath::Pi());
  TH1F* h_380_CT_genjet10_E1_E2_over_E_True =  new TH1F("h_380_CT_genjet10_E1_E2_over_E_True","", n_bins100, 0.5,1.00);
  TH1F* h_380_CT_genjet10_Delta_E1_E2_over_E12 =  new TH1F("h_380_CT_genjet10_Delta_E1_E2_over_E12","", n_bins100, -0.5,0.5);

  TH1F* h_380_CT_recojet03_dphi_j1j2 =  new TH1F("h_380_CT_recojet03_dphi_j1j2","", n_bins100, 0.5,TMath::Pi());
  TH1F* h_380_CT_recojet03_E1_E2_over_E_True =  new TH1F("h_380_CT_recojet03_E1_E2_over_E_True","", n_bins100, 0.5,1.00);
  TH1F* h_380_CT_recojet03_Delta_E1_E2_over_E12 =  new TH1F("h_380_CT_recojet03_Delta_E1_E2_over_E12","", n_bins100, -0.5,0.5);
  TH1F* h_380_CT_recojet04_dphi_j1j2 =  new TH1F("h_380_CT_recojet04_dphi_j1j2","", n_bins100, 0.5,TMath::Pi());
  TH1F* h_380_CT_recojet04_E1_E2_over_E_True =  new TH1F("h_380_CT_recojet04_E1_E2_over_E_True","", n_bins100, 0.5,1.00);
  TH1F* h_380_CT_recojet04_Delta_E1_E2_over_E12 =  new TH1F("h_380_CT_recojet04_Delta_E1_E2_over_E12","", n_bins100, -0.5,0.5);
  TH1F* h_380_CT_recojet05_dphi_j1j2 =  new TH1F("h_380_CT_recojet05_dphi_j1j2","", n_bins100, 0.5,TMath::Pi());
  TH1F* h_380_CT_recojet05_E1_E2_over_E_True =  new TH1F("h_380_CT_recojet05_E1_E2_over_E_True","", n_bins100, 0.5,1.00);
  TH1F* h_380_CT_recojet05_Delta_E1_E2_over_E12 =  new TH1F("h_380_CT_recojet05_Delta_E1_E2_over_E12","", n_bins100, -0.5,0.5);
  TH1F* h_380_CT_recojet06_dphi_j1j2 =  new TH1F("h_380_CT_recojet06_dphi_j1j2","", n_bins100, 0.5,TMath::Pi());
  TH1F* h_380_CT_recojet06_E1_E2_over_E_True =  new TH1F("h_380_CT_recojet06_E1_E2_over_E_True","", n_bins100, 0.5,1.00);
  TH1F* h_380_CT_recojet06_Delta_E1_E2_over_E12 =  new TH1F("h_380_CT_recojet06_Delta_E1_E2_over_E12","", n_bins100, -0.5,0.5);
  TH1F* h_380_CT_recojet07_dphi_j1j2 =  new TH1F("h_380_CT_recojet07_dphi_j1j2","", n_bins100, 0.5,TMath::Pi());
  TH1F* h_380_CT_recojet07_E1_E2_over_E_True =  new TH1F("h_380_CT_recojet07_E1_E2_over_E_True","", n_bins100, 0.5,1.00);
  TH1F* h_380_CT_recojet07_Delta_E1_E2_over_E12 =  new TH1F("h_380_CT_recojet07_Delta_E1_E2_over_E12","", n_bins100, -0.5,0.5);
  TH1F* h_380_CT_recojet08_dphi_j1j2 =  new TH1F("h_380_CT_recojet08_dphi_j1j2","", n_bins100, 0.5,TMath::Pi());
  TH1F* h_380_CT_recojet08_E1_E2_over_E_True =  new TH1F("h_380_CT_recojet08_E1_E2_over_E_True","", n_bins100, 0.5,1.00);
  TH1F* h_380_CT_recojet08_Delta_E1_E2_over_E12 =  new TH1F("h_380_CT_recojet08_Delta_E1_E2_over_E12","", n_bins100, -0.5,0.5);
  TH1F* h_380_CT_recojet09_dphi_j1j2 =  new TH1F("h_380_CT_recojet09_dphi_j1j2","", n_bins100, 0.5,TMath::Pi());
  TH1F* h_380_CT_recojet09_E1_E2_over_E_True =  new TH1F("h_380_CT_recojet09_E1_E2_over_E_True","", n_bins100, 0.5,1.00);
  TH1F* h_380_CT_recojet09_Delta_E1_E2_over_E12 =  new TH1F("h_380_CT_recojet09_Delta_E1_E2_over_E12","", n_bins100, -0.5,0.5);
  TH1F* h_380_CT_recojet10_dphi_j1j2 =  new TH1F("h_380_CT_recojet10_dphi_j1j2","", n_bins100, 0.5,TMath::Pi());
  TH1F* h_380_CT_recojet10_E1_E2_over_E_True =  new TH1F("h_380_CT_recojet10_E1_E2_over_E_True","", n_bins100, 0.5,1.00);
  TH1F* h_380_CT_recojet10_Delta_E1_E2_over_E12 =  new TH1F("h_380_CT_recojet10_Delta_E1_E2_over_E12","", n_bins100, -0.5,0.5);

  TH1F* h_380_CT_recojetE_over_genjetE_DR03 =  new TH1F("h_380_CT_recojetE_over_genjetE_DR03","", n_bins100, 0.5,1.5);
  TH1F* h_380_CT_recojetE_over_genjetE_DR04 =  new TH1F("h_380_CT_recojetE_over_genjetE_DR04","", n_bins100, 0.5,1.5);
  TH1F* h_380_CT_recojetE_over_genjetE_DR05 =  new TH1F("h_380_CT_recojetE_over_genjetE_DR05","", n_bins100, 0.5,1.5);
  TH1F* h_380_CT_recojetE_over_genjetE_DR06 =  new TH1F("h_380_CT_recojetE_over_genjetE_DR06","", n_bins100, 0.5,1.5);
  TH1F* h_380_CT_recojetE_over_genjetE_DR07 =  new TH1F("h_380_CT_recojetE_over_genjetE_DR07","", n_bins100, 0.5,1.5);
  TH1F* h_380_CT_recojetE_over_genjetE_DR08 =  new TH1F("h_380_CT_recojetE_over_genjetE_DR08","", n_bins100, 0.5,1.5);
  TH1F* h_380_CT_recojetE_over_genjetE_DR09 =  new TH1F("h_380_CT_recojetE_over_genjetE_DR09","", n_bins100, 0.5,1.5);
  TH1F* h_380_CT_recojetE_over_genjetE_DR10 =  new TH1F("h_380_CT_recojetE_over_genjetE_DR10","", n_bins100, 0.5,1.5);

  TH1F* h_380_CT_dphi_gen_reco_DR05 =  new TH1F("h_380_CT_dphi_gen_reco_DR05","", n_bins100, -0.1,9.9);
  TH1F* h_380_CT_dphi_gen_reco_DR06 =  new TH1F("h_380_CT_dphi_gen_reco_DR06","", n_bins100, -0.1,9.9);
  TH1F* h_380_CT_dphi_gen_reco_DR07 =  new TH1F("h_380_CT_dphi_gen_reco_DR07","", n_bins100, -0.1,9.9);

  TH1F* h_380_CT_DR05_E_rel_totVis_RMS_d1_cosT_0_to_0_10 =  new TH1F("h_380_CT_DR05_E_rel_totVis_RMS_d1_cosT_0_to_0_10","", n_binsJER, lim_E_rel_low,lim_E_rel_high);
  TH1F* h_380_CT_DR05_E_rel_totVis_RMS_d1_cosT_0_10_to_0_20 =  new TH1F("h_380_CT_DR05_E_rel_totVis_RMS_d1_cosT_0_10_to_0_20","", n_binsJER, lim_E_rel_low,lim_E_rel_high);
  TH1F* h_380_CT_DR05_E_rel_totVis_RMS_d1_cosT_0_20_to_0_30 =  new TH1F("h_380_CT_DR05_E_rel_totVis_RMS_d1_cosT_0_20_to_0_30","", n_binsJER, lim_E_rel_low,lim_E_rel_high);
  TH1F* h_380_CT_DR05_E_rel_totVis_RMS_d1_cosT_0_30_to_0_40 =  new TH1F("h_380_CT_DR05_E_rel_totVis_RMS_d1_cosT_0_30_to_0_40","", n_binsJER, lim_E_rel_low,lim_E_rel_high);
  TH1F* h_380_CT_DR05_E_rel_totVis_RMS_d1_cosT_0_40_to_0_50 =  new TH1F("h_380_CT_DR05_E_rel_totVis_RMS_d1_cosT_0_40_to_0_50","", n_binsJER, lim_E_rel_low,lim_E_rel_high);
  TH1F* h_380_CT_DR05_E_rel_totVis_RMS_d1_cosT_0_50_to_0_60 =  new TH1F("h_380_CT_DR05_E_rel_totVis_RMS_d1_cosT_0_50_to_0_60","", n_binsJER, lim_E_rel_low,lim_E_rel_high);
  TH1F* h_380_CT_DR05_E_rel_totVis_RMS_d1_cosT_0_60_to_0_70 =  new TH1F("h_380_CT_DR05_E_rel_totVis_RMS_d1_cosT_0_60_to_0_70","", n_binsJER, lim_E_rel_low,lim_E_rel_high);
  TH1F* h_380_CT_DR05_E_rel_totVis_RMS_d1_cosT_0_70_to_0_80 =  new TH1F("h_380_CT_DR05_E_rel_totVis_RMS_d1_cosT_0_70_to_0_80","", n_binsJER, lim_E_rel_low,lim_E_rel_high);
  TH1F* h_380_CT_DR05_E_rel_totVis_RMS_d1_cosT_0_80_to_0_90 =  new TH1F("h_380_CT_DR05_E_rel_totVis_RMS_d1_cosT_0_80_to_0_90","", n_binsJER, lim_E_rel_low,lim_E_rel_high);
  TH1F* h_380_CT_DR05_E_rel_totVis_RMS_d1_cosT_0_900_to_0_925 =  new TH1F("h_380_CT_DR05_E_rel_totVis_RMS_d1_cosT_0_900_to_0_925","", n_binsJER_FW, lim_E_rel_low,lim_E_rel_high);
  TH1F* h_380_CT_DR05_E_rel_totVis_RMS_d1_cosT_0_925_to_0_950 =  new TH1F("h_380_CT_DR05_E_rel_totVis_RMS_d1_cosT_0_925_to_0_950","", n_binsJER_FW, lim_E_rel_low,lim_E_rel_high);
  TH1F* h_380_CT_DR05_E_rel_totVis_RMS_d1_cosT_0_950_to_0_975 =  new TH1F("h_380_CT_DR05_E_rel_totVis_RMS_d1_cosT_0_950_to_0_975","", n_binsJER_FW, lim_E_rel_low,lim_E_rel_high);
  TH1F* h_380_CT_DR05_E_rel_totVis_RMS_d1_cosT_0_975_to_1_00 =  new TH1F("h_380_CT_DR05_E_rel_totVis_RMS_d1_cosT_0_975_to_1_00","", n_binsJER_FW, lim_E_rel_low,lim_E_rel_high);

  TH1F* h_380_CT_DR06_E_rel_totVis_RMS_d1_cosT_0_to_0_10 =  new TH1F("h_380_CT_DR06_E_rel_totVis_RMS_d1_cosT_0_to_0_10","", n_binsJER, lim_E_rel_low,lim_E_rel_high);
  TH1F* h_380_CT_DR06_E_rel_totVis_RMS_d1_cosT_0_10_to_0_20 =  new TH1F("h_380_CT_DR06_E_rel_totVis_RMS_d1_cosT_0_10_to_0_20","", n_binsJER, lim_E_rel_low,lim_E_rel_high);
  TH1F* h_380_CT_DR06_E_rel_totVis_RMS_d1_cosT_0_20_to_0_30 =  new TH1F("h_380_CT_DR06_E_rel_totVis_RMS_d1_cosT_0_20_to_0_30","", n_binsJER, lim_E_rel_low,lim_E_rel_high);
  TH1F* h_380_CT_DR06_E_rel_totVis_RMS_d1_cosT_0_30_to_0_40 =  new TH1F("h_380_CT_DR06_E_rel_totVis_RMS_d1_cosT_0_30_to_0_40","", n_binsJER, lim_E_rel_low,lim_E_rel_high);
  TH1F* h_380_CT_DR06_E_rel_totVis_RMS_d1_cosT_0_40_to_0_50 =  new TH1F("h_380_CT_DR06_E_rel_totVis_RMS_d1_cosT_0_40_to_0_50","", n_binsJER, lim_E_rel_low,lim_E_rel_high);
  TH1F* h_380_CT_DR06_E_rel_totVis_RMS_d1_cosT_0_50_to_0_60 =  new TH1F("h_380_CT_DR06_E_rel_totVis_RMS_d1_cosT_0_50_to_0_60","", n_binsJER, lim_E_rel_low,lim_E_rel_high);
  TH1F* h_380_CT_DR06_E_rel_totVis_RMS_d1_cosT_0_60_to_0_70 =  new TH1F("h_380_CT_DR06_E_rel_totVis_RMS_d1_cosT_0_60_to_0_70","", n_binsJER, lim_E_rel_low,lim_E_rel_high);
  TH1F* h_380_CT_DR06_E_rel_totVis_RMS_d1_cosT_0_70_to_0_80 =  new TH1F("h_380_CT_DR06_E_rel_totVis_RMS_d1_cosT_0_70_to_0_80","", n_binsJER, lim_E_rel_low,lim_E_rel_high);
  TH1F* h_380_CT_DR06_E_rel_totVis_RMS_d1_cosT_0_80_to_0_90 =  new TH1F("h_380_CT_DR06_E_rel_totVis_RMS_d1_cosT_0_80_to_0_90","", n_binsJER, lim_E_rel_low,lim_E_rel_high);
  TH1F* h_380_CT_DR06_E_rel_totVis_RMS_d1_cosT_0_900_to_0_925 =  new TH1F("h_380_CT_DR06_E_rel_totVis_RMS_d1_cosT_0_900_to_0_925","", n_binsJER_FW, lim_E_rel_low,lim_E_rel_high);
  TH1F* h_380_CT_DR06_E_rel_totVis_RMS_d1_cosT_0_925_to_0_950 =  new TH1F("h_380_CT_DR06_E_rel_totVis_RMS_d1_cosT_0_925_to_0_950","", n_binsJER_FW, lim_E_rel_low,lim_E_rel_high);
  TH1F* h_380_CT_DR06_E_rel_totVis_RMS_d1_cosT_0_950_to_0_975 =  new TH1F("h_380_CT_DR06_E_rel_totVis_RMS_d1_cosT_0_950_to_0_975","", n_binsJER_FW, lim_E_rel_low,lim_E_rel_high);
  TH1F* h_380_CT_DR06_E_rel_totVis_RMS_d1_cosT_0_975_to_1_00 =  new TH1F("h_380_CT_DR06_E_rel_totVis_RMS_d1_cosT_0_975_to_1_00","", n_binsJER_FW, lim_E_rel_low,lim_E_rel_high);

  TH1F* h_380_CT_DR07_E_rel_totVis_RMS_d1_cosT_0_to_0_10 =  new TH1F("h_380_CT_DR07_E_rel_totVis_RMS_d1_cosT_0_to_0_10","", n_binsJER, lim_E_rel_low,lim_E_rel_high);
  TH1F* h_380_CT_DR07_E_rel_totVis_RMS_d1_cosT_0_10_to_0_20 =  new TH1F("h_380_CT_DR07_E_rel_totVis_RMS_d1_cosT_0_10_to_0_20","", n_binsJER, lim_E_rel_low,lim_E_rel_high);
  TH1F* h_380_CT_DR07_E_rel_totVis_RMS_d1_cosT_0_20_to_0_30 =  new TH1F("h_380_CT_DR07_E_rel_totVis_RMS_d1_cosT_0_20_to_0_30","", n_binsJER, lim_E_rel_low,lim_E_rel_high);
  TH1F* h_380_CT_DR07_E_rel_totVis_RMS_d1_cosT_0_30_to_0_40 =  new TH1F("h_380_CT_DR07_E_rel_totVis_RMS_d1_cosT_0_30_to_0_40","", n_binsJER, lim_E_rel_low,lim_E_rel_high);
  TH1F* h_380_CT_DR07_E_rel_totVis_RMS_d1_cosT_0_40_to_0_50 =  new TH1F("h_380_CT_DR07_E_rel_totVis_RMS_d1_cosT_0_40_to_0_50","", n_binsJER, lim_E_rel_low,lim_E_rel_high);
  TH1F* h_380_CT_DR07_E_rel_totVis_RMS_d1_cosT_0_50_to_0_60 =  new TH1F("h_380_CT_DR07_E_rel_totVis_RMS_d1_cosT_0_50_to_0_60","", n_binsJER, lim_E_rel_low,lim_E_rel_high);
  TH1F* h_380_CT_DR07_E_rel_totVis_RMS_d1_cosT_0_60_to_0_70 =  new TH1F("h_380_CT_DR07_E_rel_totVis_RMS_d1_cosT_0_60_to_0_70","", n_binsJER, lim_E_rel_low,lim_E_rel_high);
  TH1F* h_380_CT_DR07_E_rel_totVis_RMS_d1_cosT_0_70_to_0_80 =  new TH1F("h_380_CT_DR07_E_rel_totVis_RMS_d1_cosT_0_70_to_0_80","", n_binsJER, lim_E_rel_low,lim_E_rel_high);
  TH1F* h_380_CT_DR07_E_rel_totVis_RMS_d1_cosT_0_80_to_0_90 =  new TH1F("h_380_CT_DR07_E_rel_totVis_RMS_d1_cosT_0_80_to_0_90","", n_binsJER, lim_E_rel_low,lim_E_rel_high);
  TH1F* h_380_CT_DR07_E_rel_totVis_RMS_d1_cosT_0_900_to_0_925 =  new TH1F("h_380_CT_DR07_E_rel_totVis_RMS_d1_cosT_0_900_to_0_925","", n_binsJER_FW, lim_E_rel_low,lim_E_rel_high);
  TH1F* h_380_CT_DR07_E_rel_totVis_RMS_d1_cosT_0_925_to_0_950 =  new TH1F("h_380_CT_DR07_E_rel_totVis_RMS_d1_cosT_0_925_to_0_950","", n_binsJER_FW, lim_E_rel_low,lim_E_rel_high);
  TH1F* h_380_CT_DR07_E_rel_totVis_RMS_d1_cosT_0_950_to_0_975 =  new TH1F("h_380_CT_DR07_E_rel_totVis_RMS_d1_cosT_0_950_to_0_975","", n_binsJER_FW, lim_E_rel_low,lim_E_rel_high);
  TH1F* h_380_CT_DR07_E_rel_totVis_RMS_d1_cosT_0_975_to_1_00 =  new TH1F("h_380_CT_DR07_E_rel_totVis_RMS_d1_cosT_0_975_to_1_00","", n_binsJER_FW, lim_E_rel_low,lim_E_rel_high);

  TH1F* h_380_CT_DR08_E_rel_totVis_RMS_d1_cosT_0_to_0_10 =  new TH1F("h_380_CT_DR08_E_rel_totVis_RMS_d1_cosT_0_to_0_10","", n_binsJER, lim_E_rel_low,lim_E_rel_high);
  TH1F* h_380_CT_DR08_E_rel_totVis_RMS_d1_cosT_0_10_to_0_20 =  new TH1F("h_380_CT_DR08_E_rel_totVis_RMS_d1_cosT_0_10_to_0_20","", n_binsJER, lim_E_rel_low,lim_E_rel_high);
  TH1F* h_380_CT_DR08_E_rel_totVis_RMS_d1_cosT_0_20_to_0_30 =  new TH1F("h_380_CT_DR08_E_rel_totVis_RMS_d1_cosT_0_20_to_0_30","", n_binsJER, lim_E_rel_low,lim_E_rel_high);
  TH1F* h_380_CT_DR08_E_rel_totVis_RMS_d1_cosT_0_30_to_0_40 =  new TH1F("h_380_CT_DR08_E_rel_totVis_RMS_d1_cosT_0_30_to_0_40","", n_binsJER, lim_E_rel_low,lim_E_rel_high);
  TH1F* h_380_CT_DR08_E_rel_totVis_RMS_d1_cosT_0_40_to_0_50 =  new TH1F("h_380_CT_DR08_E_rel_totVis_RMS_d1_cosT_0_40_to_0_50","", n_binsJER, lim_E_rel_low,lim_E_rel_high);
  TH1F* h_380_CT_DR08_E_rel_totVis_RMS_d1_cosT_0_50_to_0_60 =  new TH1F("h_380_CT_DR08_E_rel_totVis_RMS_d1_cosT_0_50_to_0_60","", n_binsJER, lim_E_rel_low,lim_E_rel_high);
  TH1F* h_380_CT_DR08_E_rel_totVis_RMS_d1_cosT_0_60_to_0_70 =  new TH1F("h_380_CT_DR08_E_rel_totVis_RMS_d1_cosT_0_60_to_0_70","", n_binsJER, lim_E_rel_low,lim_E_rel_high);
  TH1F* h_380_CT_DR08_E_rel_totVis_RMS_d1_cosT_0_70_to_0_80 =  new TH1F("h_380_CT_DR08_E_rel_totVis_RMS_d1_cosT_0_70_to_0_80","", n_binsJER, lim_E_rel_low,lim_E_rel_high);
  TH1F* h_380_CT_DR08_E_rel_totVis_RMS_d1_cosT_0_80_to_0_90 =  new TH1F("h_380_CT_DR08_E_rel_totVis_RMS_d1_cosT_0_80_to_0_90","", n_binsJER, lim_E_rel_low,lim_E_rel_high);
  TH1F* h_380_CT_DR08_E_rel_totVis_RMS_d1_cosT_0_900_to_0_925 =  new TH1F("h_380_CT_DR08_E_rel_totVis_RMS_d1_cosT_0_900_to_0_925","", n_binsJER_FW, lim_E_rel_low,lim_E_rel_high);
  TH1F* h_380_CT_DR08_E_rel_totVis_RMS_d1_cosT_0_925_to_0_950 =  new TH1F("h_380_CT_DR08_E_rel_totVis_RMS_d1_cosT_0_925_to_0_950","", n_binsJER_FW, lim_E_rel_low,lim_E_rel_high);
  TH1F* h_380_CT_DR08_E_rel_totVis_RMS_d1_cosT_0_950_to_0_975 =  new TH1F("h_380_CT_DR08_E_rel_totVis_RMS_d1_cosT_0_950_to_0_975","", n_binsJER_FW, lim_E_rel_low,lim_E_rel_high);
  TH1F* h_380_CT_DR08_E_rel_totVis_RMS_d1_cosT_0_975_to_1_00 =  new TH1F("h_380_CT_DR08_E_rel_totVis_RMS_d1_cosT_0_975_to_1_00","", n_binsJER_FW, lim_E_rel_low,lim_E_rel_high);

  TH1F* h_380_CT_DR09_E_rel_totVis_RMS_d1_cosT_0_to_0_10 =  new TH1F("h_380_CT_DR09_E_rel_totVis_RMS_d1_cosT_0_to_0_10","", n_binsJER, lim_E_rel_low,lim_E_rel_high);
  TH1F* h_380_CT_DR09_E_rel_totVis_RMS_d1_cosT_0_10_to_0_20 =  new TH1F("h_380_CT_DR09_E_rel_totVis_RMS_d1_cosT_0_10_to_0_20","", n_binsJER, lim_E_rel_low,lim_E_rel_high);
  TH1F* h_380_CT_DR09_E_rel_totVis_RMS_d1_cosT_0_20_to_0_30 =  new TH1F("h_380_CT_DR09_E_rel_totVis_RMS_d1_cosT_0_20_to_0_30","", n_binsJER, lim_E_rel_low,lim_E_rel_high);
  TH1F* h_380_CT_DR09_E_rel_totVis_RMS_d1_cosT_0_30_to_0_40 =  new TH1F("h_380_CT_DR09_E_rel_totVis_RMS_d1_cosT_0_30_to_0_40","", n_binsJER, lim_E_rel_low,lim_E_rel_high);
  TH1F* h_380_CT_DR09_E_rel_totVis_RMS_d1_cosT_0_40_to_0_50 =  new TH1F("h_380_CT_DR09_E_rel_totVis_RMS_d1_cosT_0_40_to_0_50","", n_binsJER, lim_E_rel_low,lim_E_rel_high);
  TH1F* h_380_CT_DR09_E_rel_totVis_RMS_d1_cosT_0_50_to_0_60 =  new TH1F("h_380_CT_DR09_E_rel_totVis_RMS_d1_cosT_0_50_to_0_60","", n_binsJER, lim_E_rel_low,lim_E_rel_high);
  TH1F* h_380_CT_DR09_E_rel_totVis_RMS_d1_cosT_0_60_to_0_70 =  new TH1F("h_380_CT_DR09_E_rel_totVis_RMS_d1_cosT_0_60_to_0_70","", n_binsJER, lim_E_rel_low,lim_E_rel_high);
  TH1F* h_380_CT_DR09_E_rel_totVis_RMS_d1_cosT_0_70_to_0_80 =  new TH1F("h_380_CT_DR09_E_rel_totVis_RMS_d1_cosT_0_70_to_0_80","", n_binsJER, lim_E_rel_low,lim_E_rel_high);
  TH1F* h_380_CT_DR09_E_rel_totVis_RMS_d1_cosT_0_80_to_0_90 =  new TH1F("h_380_CT_DR09_E_rel_totVis_RMS_d1_cosT_0_80_to_0_90","", n_binsJER, lim_E_rel_low,lim_E_rel_high);
  TH1F* h_380_CT_DR09_E_rel_totVis_RMS_d1_cosT_0_900_to_0_925 =  new TH1F("h_380_CT_DR09_E_rel_totVis_RMS_d1_cosT_0_900_to_0_925","", n_binsJER_FW, lim_E_rel_low,lim_E_rel_high);
  TH1F* h_380_CT_DR09_E_rel_totVis_RMS_d1_cosT_0_925_to_0_950 =  new TH1F("h_380_CT_DR09_E_rel_totVis_RMS_d1_cosT_0_925_to_0_950","", n_binsJER_FW, lim_E_rel_low,lim_E_rel_high);
  TH1F* h_380_CT_DR09_E_rel_totVis_RMS_d1_cosT_0_950_to_0_975 =  new TH1F("h_380_CT_DR09_E_rel_totVis_RMS_d1_cosT_0_950_to_0_975","", n_binsJER_FW, lim_E_rel_low,lim_E_rel_high);
  TH1F* h_380_CT_DR09_E_rel_totVis_RMS_d1_cosT_0_975_to_1_00 =  new TH1F("h_380_CT_DR09_E_rel_totVis_RMS_d1_cosT_0_975_to_1_00","", n_binsJER_FW, lim_E_rel_low,lim_E_rel_high);

  TH1F* h_380_CT_DR10_E_rel_totVis_RMS_d1_cosT_0_to_0_10 =  new TH1F("h_380_CT_DR10_E_rel_totVis_RMS_d1_cosT_0_to_0_10","", n_binsJER, lim_E_rel_low,lim_E_rel_high);
  TH1F* h_380_CT_DR10_E_rel_totVis_RMS_d1_cosT_0_10_to_0_20 =  new TH1F("h_380_CT_DR10_E_rel_totVis_RMS_d1_cosT_0_10_to_0_20","", n_binsJER, lim_E_rel_low,lim_E_rel_high);
  TH1F* h_380_CT_DR10_E_rel_totVis_RMS_d1_cosT_0_20_to_0_30 =  new TH1F("h_380_CT_DR10_E_rel_totVis_RMS_d1_cosT_0_20_to_0_30","", n_binsJER, lim_E_rel_low,lim_E_rel_high);
  TH1F* h_380_CT_DR10_E_rel_totVis_RMS_d1_cosT_0_30_to_0_40 =  new TH1F("h_380_CT_DR10_E_rel_totVis_RMS_d1_cosT_0_30_to_0_40","", n_binsJER, lim_E_rel_low,lim_E_rel_high);
  TH1F* h_380_CT_DR10_E_rel_totVis_RMS_d1_cosT_0_40_to_0_50 =  new TH1F("h_380_CT_DR10_E_rel_totVis_RMS_d1_cosT_0_40_to_0_50","", n_binsJER, lim_E_rel_low,lim_E_rel_high);
  TH1F* h_380_CT_DR10_E_rel_totVis_RMS_d1_cosT_0_50_to_0_60 =  new TH1F("h_380_CT_DR10_E_rel_totVis_RMS_d1_cosT_0_50_to_0_60","", n_binsJER, lim_E_rel_low,lim_E_rel_high);
  TH1F* h_380_CT_DR10_E_rel_totVis_RMS_d1_cosT_0_60_to_0_70 =  new TH1F("h_380_CT_DR10_E_rel_totVis_RMS_d1_cosT_0_60_to_0_70","", n_binsJER, lim_E_rel_low,lim_E_rel_high);
  TH1F* h_380_CT_DR10_E_rel_totVis_RMS_d1_cosT_0_70_to_0_80 =  new TH1F("h_380_CT_DR10_E_rel_totVis_RMS_d1_cosT_0_70_to_0_80","", n_binsJER, lim_E_rel_low,lim_E_rel_high);
  TH1F* h_380_CT_DR10_E_rel_totVis_RMS_d1_cosT_0_80_to_0_90 =  new TH1F("h_380_CT_DR10_E_rel_totVis_RMS_d1_cosT_0_80_to_0_90","", n_binsJER, lim_E_rel_low,lim_E_rel_high);
  TH1F* h_380_CT_DR10_E_rel_totVis_RMS_d1_cosT_0_900_to_0_925 =  new TH1F("h_380_CT_DR10_E_rel_totVis_RMS_d1_cosT_0_900_to_0_925","", n_binsJER_FW, lim_E_rel_low,lim_E_rel_high);
  TH1F* h_380_CT_DR10_E_rel_totVis_RMS_d1_cosT_0_925_to_0_950 =  new TH1F("h_380_CT_DR10_E_rel_totVis_RMS_d1_cosT_0_925_to_0_950","", n_binsJER_FW, lim_E_rel_low,lim_E_rel_high);
  TH1F* h_380_CT_DR10_E_rel_totVis_RMS_d1_cosT_0_950_to_0_975 =  new TH1F("h_380_CT_DR10_E_rel_totVis_RMS_d1_cosT_0_950_to_0_975","", n_binsJER_FW, lim_E_rel_low,lim_E_rel_high);
  TH1F* h_380_CT_DR10_E_rel_totVis_RMS_d1_cosT_0_975_to_1_00 =  new TH1F("h_380_CT_DR10_E_rel_totVis_RMS_d1_cosT_0_975_to_1_00","", n_binsJER_FW, lim_E_rel_low,lim_E_rel_high);

  TH1F* h_380_CT_DR05_dphi_reco_gen_cosTheta_0_65 =  new TH1F("h_380_CT_DR05_dphi_reco_gen_cosTheta_0_65","", n_bins100, -lim_angleDeg,lim_angleDeg);
  TH1F* h_380_CT_DR05_dtheta_reco_gen_cosTheta_0_65 =  new TH1F("h_380_CT_DR05_dtheta_reco_gen_cosTheta_0_65","", n_bins100, -lim_angleDeg,lim_angleDeg);
  TH1F* h_380_CT_DR05_dphi_reco_gen_cosTheta_0_65_to_0_80 =  new TH1F("h_380_CT_DR05_dphi_reco_gen_cosTheta_0_65_to_0_80","", n_bins100, -lim_angleDeg,lim_angleDeg);
  TH1F* h_380_CT_DR05_dtheta_reco_gen_cosTheta_0_65_to_0_80 =  new TH1F("h_380_CT_DR05_dtheta_reco_gen_cosTheta_0_65_to_0_80","", n_bins100, -lim_angleDeg,lim_angleDeg);
  TH1F* h_380_CT_DR05_dphi_reco_gen_cosTheta_0_80_to_0_925 =  new TH1F("h_380_CT_DR05_dphi_reco_gen_cosTheta_0_80_to_0_925","", n_bins100, -lim_angleDeg,lim_angleDeg);
  TH1F* h_380_CT_DR05_dtheta_reco_gen_cosTheta_0_80_to_0_925 =  new TH1F("h_380_CT_DR05_dtheta_reco_gen_cosTheta_0_80_to_0_925","", n_bins100, -lim_angleDeg,lim_angleDeg);
  TH1F* h_380_CT_DR05_dphi_reco_gen_cosTheta_0_925_to_0_975 =  new TH1F("h_380_CT_DR05_dphi_reco_gen_cosTheta_0_925_to_0_975","", n_bins100, -lim_angleDeg,lim_angleDeg);
  TH1F* h_380_CT_DR05_dtheta_reco_gen_cosTheta_0_925_to_0_975 =  new TH1F("h_380_CT_DR05_dtheta_reco_gen_cosTheta_0_925_to_0_975","", n_bins100, -lim_angleDeg,lim_angleDeg);

  TH1F* h_380_CT_DR07_dphi_reco_gen_cosTheta_0_65 =  new TH1F("h_380_CT_DR07_dphi_reco_gen_cosTheta_0_65","", n_bins100, -lim_angleDeg,lim_angleDeg);
  TH1F* h_380_CT_DR07_dtheta_reco_gen_cosTheta_0_65 =  new TH1F("h_380_CT_DR07_dtheta_reco_gen_cosTheta_0_65","", n_bins100, -lim_angleDeg,lim_angleDeg);
  TH1F* h_380_CT_DR07_dphi_reco_gen_cosTheta_0_65_to_0_80 =  new TH1F("h_380_CT_DR07_dphi_reco_gen_cosTheta_0_65_to_0_80","", n_bins100, -lim_angleDeg,lim_angleDeg);
  TH1F* h_380_CT_DR07_dtheta_reco_gen_cosTheta_0_65_to_0_80 =  new TH1F("h_380_CT_DR07_dtheta_reco_gen_cosTheta_0_65_to_0_80","", n_bins100, -lim_angleDeg,lim_angleDeg);
  TH1F* h_380_CT_DR07_dphi_reco_gen_cosTheta_0_80_to_0_925 =  new TH1F("h_380_CT_DR07_dphi_reco_gen_cosTheta_0_80_to_0_925","", n_bins100, -lim_angleDeg,lim_angleDeg);
  TH1F* h_380_CT_DR07_dtheta_reco_gen_cosTheta_0_80_to_0_925 =  new TH1F("h_380_CT_DR07_dtheta_reco_gen_cosTheta_0_80_to_0_925","", n_bins100, -lim_angleDeg,lim_angleDeg);
  TH1F* h_380_CT_DR07_dphi_reco_gen_cosTheta_0_925_to_0_975 =  new TH1F("h_380_CT_DR07_dphi_reco_gen_cosTheta_0_925_to_0_975","", n_bins100, -lim_angleDeg,lim_angleDeg);
  TH1F* h_380_CT_DR07_dtheta_reco_gen_cosTheta_0_925_to_0_975 =  new TH1F("h_380_CT_DR07_dtheta_reco_gen_cosTheta_0_925_to_0_975","", n_bins100, -lim_angleDeg,lim_angleDeg);

  TH1F* h_380_CT_DR10_dphi_reco_gen_cosTheta_0_65 =  new TH1F("h_380_CT_DR10_dphi_reco_gen_cosTheta_0_65","", n_bins100, -lim_angleDeg,lim_angleDeg);
  TH1F* h_380_CT_DR10_dtheta_reco_gen_cosTheta_0_65 =  new TH1F("h_380_CT_DR10_dtheta_reco_gen_cosTheta_0_65","", n_bins100, -lim_angleDeg,lim_angleDeg);
  TH1F* h_380_CT_DR10_dphi_reco_gen_cosTheta_0_65_to_0_80 =  new TH1F("h_380_CT_DR10_dphi_reco_gen_cosTheta_0_65_to_0_80","", n_bins100, -lim_angleDeg,lim_angleDeg);
  TH1F* h_380_CT_DR10_dtheta_reco_gen_cosTheta_0_65_to_0_80 =  new TH1F("h_380_CT_DR10_dtheta_reco_gen_cosTheta_0_65_to_0_80","", n_bins100, -lim_angleDeg,lim_angleDeg);
  TH1F* h_380_CT_DR10_dphi_reco_gen_cosTheta_0_80_to_0_925 =  new TH1F("h_380_CT_DR10_dphi_reco_gen_cosTheta_0_80_to_0_925","", n_bins100, -lim_angleDeg,lim_angleDeg);
  TH1F* h_380_CT_DR10_dtheta_reco_gen_cosTheta_0_80_to_0_925 =  new TH1F("h_380_CT_DR10_dtheta_reco_gen_cosTheta_0_80_to_0_925","", n_bins100, -lim_angleDeg,lim_angleDeg);
  TH1F* h_380_CT_DR10_dphi_reco_gen_cosTheta_0_925_to_0_975 =  new TH1F("h_380_CT_DR10_dphi_reco_gen_cosTheta_0_925_to_0_975","", n_bins100, -lim_angleDeg,lim_angleDeg);
  TH1F* h_380_CT_DR10_dtheta_reco_gen_cosTheta_0_925_to_0_975 =  new TH1F("h_380_CT_DR10_dtheta_reco_gen_cosTheta_0_925_to_0_975","", n_bins100, -lim_angleDeg,lim_angleDeg);


  std::vector<TH1F*> hist_vec_380_CT;
  hist_vec_380_CT.push_back(h_380_CT_genjet03_dphi_j1j2);
  hist_vec_380_CT.push_back(h_380_CT_genjet03_E1_E2_over_E_True);
  hist_vec_380_CT.push_back(h_380_CT_genjet03_Delta_E1_E2_over_E12);
  hist_vec_380_CT.push_back(h_380_CT_genjet04_dphi_j1j2);
  hist_vec_380_CT.push_back(h_380_CT_genjet04_E1_E2_over_E_True);
  hist_vec_380_CT.push_back(h_380_CT_genjet04_Delta_E1_E2_over_E12);
  hist_vec_380_CT.push_back(h_380_CT_genjet05_dphi_j1j2);
  hist_vec_380_CT.push_back(h_380_CT_genjet05_E1_E2_over_E_True);
  hist_vec_380_CT.push_back(h_380_CT_genjet05_Delta_E1_E2_over_E12);
  hist_vec_380_CT.push_back(h_380_CT_genjet06_dphi_j1j2);
  hist_vec_380_CT.push_back(h_380_CT_genjet06_E1_E2_over_E_True);
  hist_vec_380_CT.push_back(h_380_CT_genjet06_Delta_E1_E2_over_E12);
  hist_vec_380_CT.push_back(h_380_CT_genjet07_dphi_j1j2);
  hist_vec_380_CT.push_back(h_380_CT_genjet07_E1_E2_over_E_True);
  hist_vec_380_CT.push_back(h_380_CT_genjet07_Delta_E1_E2_over_E12);
  hist_vec_380_CT.push_back(h_380_CT_genjet08_dphi_j1j2);
  hist_vec_380_CT.push_back(h_380_CT_genjet08_E1_E2_over_E_True);
  hist_vec_380_CT.push_back(h_380_CT_genjet08_Delta_E1_E2_over_E12);
  hist_vec_380_CT.push_back(h_380_CT_genjet09_dphi_j1j2);
  hist_vec_380_CT.push_back(h_380_CT_genjet09_E1_E2_over_E_True);
  hist_vec_380_CT.push_back(h_380_CT_genjet09_Delta_E1_E2_over_E12);
  hist_vec_380_CT.push_back(h_380_CT_genjet10_dphi_j1j2);
  hist_vec_380_CT.push_back(h_380_CT_genjet10_E1_E2_over_E_True);
  hist_vec_380_CT.push_back(h_380_CT_genjet10_Delta_E1_E2_over_E12);

  hist_vec_380_CT.push_back(h_380_CT_recojet03_dphi_j1j2);
  hist_vec_380_CT.push_back(h_380_CT_recojet03_E1_E2_over_E_True);
  hist_vec_380_CT.push_back(h_380_CT_recojet03_Delta_E1_E2_over_E12);
  hist_vec_380_CT.push_back(h_380_CT_recojet04_dphi_j1j2);
  hist_vec_380_CT.push_back(h_380_CT_recojet04_E1_E2_over_E_True);
  hist_vec_380_CT.push_back(h_380_CT_recojet04_Delta_E1_E2_over_E12);
  hist_vec_380_CT.push_back(h_380_CT_recojet05_dphi_j1j2);
  hist_vec_380_CT.push_back(h_380_CT_recojet05_E1_E2_over_E_True);
  hist_vec_380_CT.push_back(h_380_CT_recojet05_Delta_E1_E2_over_E12);
  hist_vec_380_CT.push_back(h_380_CT_recojet06_dphi_j1j2);
  hist_vec_380_CT.push_back(h_380_CT_recojet06_E1_E2_over_E_True);
  hist_vec_380_CT.push_back(h_380_CT_recojet06_Delta_E1_E2_over_E12);
  hist_vec_380_CT.push_back(h_380_CT_recojet07_dphi_j1j2);
  hist_vec_380_CT.push_back(h_380_CT_recojet07_E1_E2_over_E_True);
  hist_vec_380_CT.push_back(h_380_CT_recojet07_Delta_E1_E2_over_E12);
  hist_vec_380_CT.push_back(h_380_CT_recojet08_dphi_j1j2);
  hist_vec_380_CT.push_back(h_380_CT_recojet08_E1_E2_over_E_True);
  hist_vec_380_CT.push_back(h_380_CT_recojet08_Delta_E1_E2_over_E12);
  hist_vec_380_CT.push_back(h_380_CT_recojet09_dphi_j1j2);
  hist_vec_380_CT.push_back(h_380_CT_recojet09_E1_E2_over_E_True);
  hist_vec_380_CT.push_back(h_380_CT_recojet09_Delta_E1_E2_over_E12);
  hist_vec_380_CT.push_back(h_380_CT_recojet10_dphi_j1j2);
  hist_vec_380_CT.push_back(h_380_CT_recojet10_E1_E2_over_E_True);
  hist_vec_380_CT.push_back(h_380_CT_recojet10_Delta_E1_E2_over_E12);

  hist_vec_380_CT.push_back(h_380_CT_recojetE_over_genjetE_DR03);
  hist_vec_380_CT.push_back(h_380_CT_recojetE_over_genjetE_DR04);
  hist_vec_380_CT.push_back(h_380_CT_recojetE_over_genjetE_DR05);
  hist_vec_380_CT.push_back(h_380_CT_recojetE_over_genjetE_DR06);
  hist_vec_380_CT.push_back(h_380_CT_recojetE_over_genjetE_DR07);
  hist_vec_380_CT.push_back(h_380_CT_recojetE_over_genjetE_DR08);
  hist_vec_380_CT.push_back(h_380_CT_recojetE_over_genjetE_DR09);
  hist_vec_380_CT.push_back(h_380_CT_recojetE_over_genjetE_DR10);

  hist_vec_380_CT.push_back(h_380_CT_dphi_gen_reco_DR05);
  hist_vec_380_CT.push_back(h_380_CT_dphi_gen_reco_DR06);
  hist_vec_380_CT.push_back(h_380_CT_dphi_gen_reco_DR07);

  hist_vec_380_CT.push_back(h_380_CT_DR05_E_rel_totVis_RMS_d1_cosT_0_to_0_10);
  hist_vec_380_CT.push_back(h_380_CT_DR05_E_rel_totVis_RMS_d1_cosT_0_10_to_0_20);
  hist_vec_380_CT.push_back(h_380_CT_DR05_E_rel_totVis_RMS_d1_cosT_0_20_to_0_30);
  hist_vec_380_CT.push_back(h_380_CT_DR05_E_rel_totVis_RMS_d1_cosT_0_30_to_0_40);
  hist_vec_380_CT.push_back(h_380_CT_DR05_E_rel_totVis_RMS_d1_cosT_0_40_to_0_50);
  hist_vec_380_CT.push_back(h_380_CT_DR05_E_rel_totVis_RMS_d1_cosT_0_50_to_0_60);
  hist_vec_380_CT.push_back(h_380_CT_DR05_E_rel_totVis_RMS_d1_cosT_0_60_to_0_70);
  hist_vec_380_CT.push_back(h_380_CT_DR05_E_rel_totVis_RMS_d1_cosT_0_70_to_0_80);
  hist_vec_380_CT.push_back(h_380_CT_DR05_E_rel_totVis_RMS_d1_cosT_0_80_to_0_90);
  hist_vec_380_CT.push_back(h_380_CT_DR05_E_rel_totVis_RMS_d1_cosT_0_900_to_0_925);
  hist_vec_380_CT.push_back(h_380_CT_DR05_E_rel_totVis_RMS_d1_cosT_0_925_to_0_950);
  hist_vec_380_CT.push_back(h_380_CT_DR05_E_rel_totVis_RMS_d1_cosT_0_950_to_0_975);
  hist_vec_380_CT.push_back(h_380_CT_DR05_E_rel_totVis_RMS_d1_cosT_0_975_to_1_00);

  hist_vec_380_CT.push_back(h_380_CT_DR06_E_rel_totVis_RMS_d1_cosT_0_to_0_10);
  hist_vec_380_CT.push_back(h_380_CT_DR06_E_rel_totVis_RMS_d1_cosT_0_10_to_0_20);
  hist_vec_380_CT.push_back(h_380_CT_DR06_E_rel_totVis_RMS_d1_cosT_0_20_to_0_30);
  hist_vec_380_CT.push_back(h_380_CT_DR06_E_rel_totVis_RMS_d1_cosT_0_30_to_0_40);
  hist_vec_380_CT.push_back(h_380_CT_DR06_E_rel_totVis_RMS_d1_cosT_0_40_to_0_50);
  hist_vec_380_CT.push_back(h_380_CT_DR06_E_rel_totVis_RMS_d1_cosT_0_50_to_0_60);
  hist_vec_380_CT.push_back(h_380_CT_DR06_E_rel_totVis_RMS_d1_cosT_0_60_to_0_70);
  hist_vec_380_CT.push_back(h_380_CT_DR06_E_rel_totVis_RMS_d1_cosT_0_70_to_0_80);
  hist_vec_380_CT.push_back(h_380_CT_DR06_E_rel_totVis_RMS_d1_cosT_0_80_to_0_90);
  hist_vec_380_CT.push_back(h_380_CT_DR06_E_rel_totVis_RMS_d1_cosT_0_900_to_0_925);
  hist_vec_380_CT.push_back(h_380_CT_DR06_E_rel_totVis_RMS_d1_cosT_0_925_to_0_950);
  hist_vec_380_CT.push_back(h_380_CT_DR06_E_rel_totVis_RMS_d1_cosT_0_950_to_0_975);
  hist_vec_380_CT.push_back(h_380_CT_DR06_E_rel_totVis_RMS_d1_cosT_0_975_to_1_00); 

  hist_vec_380_CT.push_back(h_380_CT_DR07_E_rel_totVis_RMS_d1_cosT_0_to_0_10);
  hist_vec_380_CT.push_back(h_380_CT_DR07_E_rel_totVis_RMS_d1_cosT_0_10_to_0_20);
  hist_vec_380_CT.push_back(h_380_CT_DR07_E_rel_totVis_RMS_d1_cosT_0_20_to_0_30);
  hist_vec_380_CT.push_back(h_380_CT_DR07_E_rel_totVis_RMS_d1_cosT_0_30_to_0_40);
  hist_vec_380_CT.push_back(h_380_CT_DR07_E_rel_totVis_RMS_d1_cosT_0_40_to_0_50);
  hist_vec_380_CT.push_back(h_380_CT_DR07_E_rel_totVis_RMS_d1_cosT_0_50_to_0_60);
  hist_vec_380_CT.push_back(h_380_CT_DR07_E_rel_totVis_RMS_d1_cosT_0_60_to_0_70);
  hist_vec_380_CT.push_back(h_380_CT_DR07_E_rel_totVis_RMS_d1_cosT_0_70_to_0_80);
  hist_vec_380_CT.push_back(h_380_CT_DR07_E_rel_totVis_RMS_d1_cosT_0_80_to_0_90);
  hist_vec_380_CT.push_back(h_380_CT_DR07_E_rel_totVis_RMS_d1_cosT_0_900_to_0_925);
  hist_vec_380_CT.push_back(h_380_CT_DR07_E_rel_totVis_RMS_d1_cosT_0_925_to_0_950);
  hist_vec_380_CT.push_back(h_380_CT_DR07_E_rel_totVis_RMS_d1_cosT_0_950_to_0_975);
  hist_vec_380_CT.push_back(h_380_CT_DR07_E_rel_totVis_RMS_d1_cosT_0_975_to_1_00); 

  hist_vec_380_CT.push_back(h_380_CT_DR08_E_rel_totVis_RMS_d1_cosT_0_to_0_10);
  hist_vec_380_CT.push_back(h_380_CT_DR08_E_rel_totVis_RMS_d1_cosT_0_10_to_0_20);
  hist_vec_380_CT.push_back(h_380_CT_DR08_E_rel_totVis_RMS_d1_cosT_0_20_to_0_30);
  hist_vec_380_CT.push_back(h_380_CT_DR08_E_rel_totVis_RMS_d1_cosT_0_30_to_0_40);
  hist_vec_380_CT.push_back(h_380_CT_DR08_E_rel_totVis_RMS_d1_cosT_0_40_to_0_50);
  hist_vec_380_CT.push_back(h_380_CT_DR08_E_rel_totVis_RMS_d1_cosT_0_50_to_0_60);
  hist_vec_380_CT.push_back(h_380_CT_DR08_E_rel_totVis_RMS_d1_cosT_0_60_to_0_70);
  hist_vec_380_CT.push_back(h_380_CT_DR08_E_rel_totVis_RMS_d1_cosT_0_70_to_0_80);
  hist_vec_380_CT.push_back(h_380_CT_DR08_E_rel_totVis_RMS_d1_cosT_0_80_to_0_90);
  hist_vec_380_CT.push_back(h_380_CT_DR08_E_rel_totVis_RMS_d1_cosT_0_900_to_0_925);
  hist_vec_380_CT.push_back(h_380_CT_DR08_E_rel_totVis_RMS_d1_cosT_0_925_to_0_950);
  hist_vec_380_CT.push_back(h_380_CT_DR08_E_rel_totVis_RMS_d1_cosT_0_950_to_0_975);
  hist_vec_380_CT.push_back(h_380_CT_DR08_E_rel_totVis_RMS_d1_cosT_0_975_to_1_00); //110

  hist_vec_380_CT.push_back(h_380_CT_DR09_E_rel_totVis_RMS_d1_cosT_0_to_0_10);
  hist_vec_380_CT.push_back(h_380_CT_DR09_E_rel_totVis_RMS_d1_cosT_0_10_to_0_20);
  hist_vec_380_CT.push_back(h_380_CT_DR09_E_rel_totVis_RMS_d1_cosT_0_20_to_0_30);
  hist_vec_380_CT.push_back(h_380_CT_DR09_E_rel_totVis_RMS_d1_cosT_0_30_to_0_40);
  hist_vec_380_CT.push_back(h_380_CT_DR09_E_rel_totVis_RMS_d1_cosT_0_40_to_0_50);
  hist_vec_380_CT.push_back(h_380_CT_DR09_E_rel_totVis_RMS_d1_cosT_0_50_to_0_60);
  hist_vec_380_CT.push_back(h_380_CT_DR09_E_rel_totVis_RMS_d1_cosT_0_60_to_0_70);
  hist_vec_380_CT.push_back(h_380_CT_DR09_E_rel_totVis_RMS_d1_cosT_0_70_to_0_80);
  hist_vec_380_CT.push_back(h_380_CT_DR09_E_rel_totVis_RMS_d1_cosT_0_80_to_0_90);
  hist_vec_380_CT.push_back(h_380_CT_DR09_E_rel_totVis_RMS_d1_cosT_0_900_to_0_925);
  hist_vec_380_CT.push_back(h_380_CT_DR09_E_rel_totVis_RMS_d1_cosT_0_925_to_0_950);
  hist_vec_380_CT.push_back(h_380_CT_DR09_E_rel_totVis_RMS_d1_cosT_0_950_to_0_975);
  hist_vec_380_CT.push_back(h_380_CT_DR09_E_rel_totVis_RMS_d1_cosT_0_975_to_1_00); //123

  hist_vec_380_CT.push_back(h_380_CT_DR10_E_rel_totVis_RMS_d1_cosT_0_to_0_10);
  hist_vec_380_CT.push_back(h_380_CT_DR10_E_rel_totVis_RMS_d1_cosT_0_10_to_0_20);
  hist_vec_380_CT.push_back(h_380_CT_DR10_E_rel_totVis_RMS_d1_cosT_0_20_to_0_30);
  hist_vec_380_CT.push_back(h_380_CT_DR10_E_rel_totVis_RMS_d1_cosT_0_30_to_0_40);
  hist_vec_380_CT.push_back(h_380_CT_DR10_E_rel_totVis_RMS_d1_cosT_0_40_to_0_50);
  hist_vec_380_CT.push_back(h_380_CT_DR10_E_rel_totVis_RMS_d1_cosT_0_50_to_0_60);
  hist_vec_380_CT.push_back(h_380_CT_DR10_E_rel_totVis_RMS_d1_cosT_0_60_to_0_70);
  hist_vec_380_CT.push_back(h_380_CT_DR10_E_rel_totVis_RMS_d1_cosT_0_70_to_0_80);
  hist_vec_380_CT.push_back(h_380_CT_DR10_E_rel_totVis_RMS_d1_cosT_0_80_to_0_90);
  hist_vec_380_CT.push_back(h_380_CT_DR10_E_rel_totVis_RMS_d1_cosT_0_900_to_0_925);
  hist_vec_380_CT.push_back(h_380_CT_DR10_E_rel_totVis_RMS_d1_cosT_0_925_to_0_950);
  hist_vec_380_CT.push_back(h_380_CT_DR10_E_rel_totVis_RMS_d1_cosT_0_950_to_0_975);
  hist_vec_380_CT.push_back(h_380_CT_DR10_E_rel_totVis_RMS_d1_cosT_0_975_to_1_00); //136

  hist_vec_380_CT.push_back(h_380_CT_DR05_dphi_reco_gen_cosTheta_0_65);//137
  hist_vec_380_CT.push_back(h_380_CT_DR05_dphi_reco_gen_cosTheta_0_65_to_0_80);
  hist_vec_380_CT.push_back(h_380_CT_DR05_dphi_reco_gen_cosTheta_0_80_to_0_925);
  hist_vec_380_CT.push_back(h_380_CT_DR05_dphi_reco_gen_cosTheta_0_925_to_0_975);
  hist_vec_380_CT.push_back(h_380_CT_DR05_dtheta_reco_gen_cosTheta_0_65);
  hist_vec_380_CT.push_back(h_380_CT_DR05_dtheta_reco_gen_cosTheta_0_65_to_0_80);
  hist_vec_380_CT.push_back(h_380_CT_DR05_dtheta_reco_gen_cosTheta_0_80_to_0_925);
  hist_vec_380_CT.push_back(h_380_CT_DR05_dtheta_reco_gen_cosTheta_0_925_to_0_975);

  hist_vec_380_CT.push_back(h_380_CT_DR07_dphi_reco_gen_cosTheta_0_65);//145
  hist_vec_380_CT.push_back(h_380_CT_DR07_dphi_reco_gen_cosTheta_0_65_to_0_80);
  hist_vec_380_CT.push_back(h_380_CT_DR07_dphi_reco_gen_cosTheta_0_80_to_0_925);
  hist_vec_380_CT.push_back(h_380_CT_DR07_dphi_reco_gen_cosTheta_0_925_to_0_975);
  hist_vec_380_CT.push_back(h_380_CT_DR07_dtheta_reco_gen_cosTheta_0_65);
  hist_vec_380_CT.push_back(h_380_CT_DR07_dtheta_reco_gen_cosTheta_0_65_to_0_80);
  hist_vec_380_CT.push_back(h_380_CT_DR07_dtheta_reco_gen_cosTheta_0_80_to_0_925);
  hist_vec_380_CT.push_back(h_380_CT_DR07_dtheta_reco_gen_cosTheta_0_925_to_0_975);

  hist_vec_380_CT.push_back(h_380_CT_DR10_dphi_reco_gen_cosTheta_0_65);//153
  hist_vec_380_CT.push_back(h_380_CT_DR10_dphi_reco_gen_cosTheta_0_65_to_0_80);
  hist_vec_380_CT.push_back(h_380_CT_DR10_dphi_reco_gen_cosTheta_0_80_to_0_925);
  hist_vec_380_CT.push_back(h_380_CT_DR10_dphi_reco_gen_cosTheta_0_925_to_0_975);
  hist_vec_380_CT.push_back(h_380_CT_DR10_dtheta_reco_gen_cosTheta_0_65);
  hist_vec_380_CT.push_back(h_380_CT_DR10_dtheta_reco_gen_cosTheta_0_65_to_0_80);
  hist_vec_380_CT.push_back(h_380_CT_DR10_dtheta_reco_gen_cosTheta_0_80_to_0_925);
  hist_vec_380_CT.push_back(h_380_CT_DR10_dtheta_reco_gen_cosTheta_0_925_to_0_975);

  for(unsigned int i=0;i<hist_vec_380_CT.size();i++){
    hist_vec_380_CT[i]->Sumw2();
  }
  fill_jet_histograms(file_CLIC_380_CT,hist_vec_380_CT);


  TH1F* h_380_CT_DR05_dphi_SigmaCB_summary_histogram=new TH1F("dphiRes_SigmaCBVsCosTheta_CT_DR05_380", "#sigma#Delta#phi(j_{reco},j_{true}) vs |cos#theta|", nRegionBinsAngles, pRegionBinEdgesAngles);
  h_380_CT_DR05_dphi_SigmaCB_summary_histogram ->SetYTitle("#sigma#Delta#phi(j_{reco},j_{true})");
  h_380_CT_DR05_dphi_SigmaCB_summary_histogram->SetXTitle("|cos#theta|");
  h_380_CT_DR05_dphi_SigmaCB_summary_histogram->SetLineWidth(2);
  h_380_CT_DR05_dphi_SigmaCB_summary_histogram->SetLineColor(kCyan+1);
  h_380_CT_DR05_dphi_SigmaCB_summary_histogram->SetLineStyle(2);

  TH1F* h_380_CT_DR05_dphi_RMS90_summary_histogram=new TH1F("dphiRes_RMS90VsCosTheta_CT_DR05_380", "RMS_{90} #Delta#phi(j_{reco},j_{true}) vs |cos#theta|", nRegionBinsAngles, pRegionBinEdgesAngles);
  h_380_CT_DR05_dphi_RMS90_summary_histogram ->SetYTitle("RMS_{90}#Delta#phi(j_{reco},j_{true})");
  h_380_CT_DR05_dphi_RMS90_summary_histogram->SetXTitle("|cos#theta|");
  h_380_CT_DR05_dphi_RMS90_summary_histogram->SetLineWidth(2);
  h_380_CT_DR05_dphi_RMS90_summary_histogram->SetLineColor(kCyan+1);
  h_380_CT_DR05_dphi_RMS90_summary_histogram->SetLineStyle(2);

  TH1F* h_380_CT_DR07_dphi_SigmaCB_summary_histogram=new TH1F("dphiRes_SigmaCBVsCosTheta_CT_DR07_380", "#sigma#Delta#phi(j_{reco},j_{true}) vs |cos#theta|", nRegionBinsAngles, pRegionBinEdgesAngles);
  h_380_CT_DR07_dphi_SigmaCB_summary_histogram ->SetYTitle("#sigma#Delta#phi(j_{reco},j_{true})");
  h_380_CT_DR07_dphi_SigmaCB_summary_histogram->SetXTitle("|cos#theta|");
  h_380_CT_DR07_dphi_SigmaCB_summary_histogram->SetLineWidth(2);
  h_380_CT_DR07_dphi_SigmaCB_summary_histogram->SetLineColor(kCyan+1);
  h_380_CT_DR07_dphi_SigmaCB_summary_histogram->SetLineStyle(2);

  TH1F* h_380_CT_DR07_dphi_RMS90_summary_histogram=new TH1F("dphiRes_RMS90VsCosTheta_CT_DR07_380", "RMS_{90} #Delta#phi(j_{reco},j_{true}) vs |cos#theta|", nRegionBinsAngles, pRegionBinEdgesAngles);
  h_380_CT_DR07_dphi_RMS90_summary_histogram ->SetYTitle("RMS_{90}#Delta#phi(j_{reco},j_{true})");
  h_380_CT_DR07_dphi_RMS90_summary_histogram->SetXTitle("|cos#theta|");
  h_380_CT_DR07_dphi_RMS90_summary_histogram->SetLineWidth(2);
  h_380_CT_DR07_dphi_RMS90_summary_histogram->SetLineColor(kCyan+1);
  h_380_CT_DR07_dphi_RMS90_summary_histogram->SetLineStyle(2);

  TH1F* h_380_CT_DR10_dphi_SigmaCB_summary_histogram=new TH1F("dphiRes_SigmaCBVsCosTheta_CT_DR10_380", "#sigma#Delta#phi(j_{reco},j_{true}) vs |cos#theta|", nRegionBinsAngles, pRegionBinEdgesAngles);
  h_380_CT_DR10_dphi_SigmaCB_summary_histogram ->SetYTitle("#sigma#Delta#phi(j_{reco},j_{true})");
  h_380_CT_DR10_dphi_SigmaCB_summary_histogram->SetXTitle("|cos#theta|");
  h_380_CT_DR10_dphi_SigmaCB_summary_histogram->SetLineWidth(2);
  h_380_CT_DR10_dphi_SigmaCB_summary_histogram->SetLineColor(kCyan+1);
  h_380_CT_DR10_dphi_SigmaCB_summary_histogram->SetLineStyle(2);

  TH1F* h_380_CT_DR10_dphi_RMS90_summary_histogram=new TH1F("dphiRes_RMS90VsCosTheta_CT_DR10_380", "RMS_{90} #Delta#phi(j_{reco},j_{true}) vs |cos#theta|", nRegionBinsAngles, pRegionBinEdgesAngles);
  h_380_CT_DR10_dphi_RMS90_summary_histogram ->SetYTitle("RMS_{90}#Delta#phi(j_{reco},j_{true})");
  h_380_CT_DR10_dphi_RMS90_summary_histogram->SetXTitle("|cos#theta|");
  h_380_CT_DR10_dphi_RMS90_summary_histogram->SetLineWidth(2);
  h_380_CT_DR10_dphi_RMS90_summary_histogram->SetLineColor(kCyan+1);
  h_380_CT_DR10_dphi_RMS90_summary_histogram->SetLineStyle(2);

  TH1F* h_380_CT_DR05_dtheta_SigmaCB_summary_histogram=new TH1F("dthetaRes_SigmaCBVsCosTheta_CT_DR05_380", "#sigma#Delta#theta(j_{reco},j_{true}) vs |cos#theta|", nRegionBinsAngles, pRegionBinEdgesAngles);
  h_380_CT_DR05_dtheta_SigmaCB_summary_histogram ->SetYTitle("#sigma#Delta#theta(j_{reco},j_{true})");
  h_380_CT_DR05_dtheta_SigmaCB_summary_histogram->SetXTitle("|cos#theta|");
  h_380_CT_DR05_dtheta_SigmaCB_summary_histogram->SetLineWidth(2);
  h_380_CT_DR05_dtheta_SigmaCB_summary_histogram->SetLineColor(kCyan+1);
  h_380_CT_DR05_dtheta_SigmaCB_summary_histogram->SetLineStyle(2);

  TH1F* h_380_CT_DR05_dtheta_RMS90_summary_histogram=new TH1F("dthetaRes_RMS90VsCosTheta_CT_DR05_380", "RMS_{90} #Delta#theta(j_{reco},j_{true}) vs |cos#theta|", nRegionBinsAngles, pRegionBinEdgesAngles);
  h_380_CT_DR05_dtheta_RMS90_summary_histogram ->SetYTitle("RMS_{90}#Delta#theta(j_{reco},j_{true})");
  h_380_CT_DR05_dtheta_RMS90_summary_histogram->SetXTitle("|cos#theta|");
  h_380_CT_DR05_dtheta_RMS90_summary_histogram->SetLineWidth(2);
  h_380_CT_DR05_dtheta_RMS90_summary_histogram->SetLineColor(kCyan+1);
  h_380_CT_DR05_dtheta_RMS90_summary_histogram->SetLineStyle(2);

  TH1F* h_380_CT_DR07_dtheta_SigmaCB_summary_histogram=new TH1F("dthetaRes_SigmaCBVsCosTheta_CT_DR07_380", "#sigma#Delta#theta(j_{reco},j_{true}) vs |cos#theta|", nRegionBinsAngles, pRegionBinEdgesAngles);
  h_380_CT_DR07_dtheta_SigmaCB_summary_histogram ->SetYTitle("#sigma#Delta#theta(j_{reco},j_{true})");
  h_380_CT_DR07_dtheta_SigmaCB_summary_histogram->SetXTitle("|cos#theta|");
  h_380_CT_DR07_dtheta_SigmaCB_summary_histogram->SetLineWidth(2);
  h_380_CT_DR07_dtheta_SigmaCB_summary_histogram->SetLineColor(kCyan+1);
  h_380_CT_DR07_dtheta_SigmaCB_summary_histogram->SetLineStyle(2);

  TH1F* h_380_CT_DR07_dtheta_RMS90_summary_histogram=new TH1F("dthetaRes_RMS90VsCosTheta_CT_DR07_380", "RMS_{90} #Delta#theta(j_{reco},j_{true}) vs |cos#theta|", nRegionBinsAngles, pRegionBinEdgesAngles);
  h_380_CT_DR07_dtheta_RMS90_summary_histogram ->SetYTitle("RMS_{90}#Delta#theta(j_{reco},j_{true})");
  h_380_CT_DR07_dtheta_RMS90_summary_histogram->SetXTitle("|cos#theta|");
  h_380_CT_DR07_dtheta_RMS90_summary_histogram->SetLineWidth(2);
  h_380_CT_DR07_dtheta_RMS90_summary_histogram->SetLineColor(kCyan+1);
  h_380_CT_DR07_dtheta_RMS90_summary_histogram->SetLineStyle(2);

  TH1F* h_380_CT_DR10_dtheta_SigmaCB_summary_histogram=new TH1F("dthetaRes_SigmaCBVsCosTheta_CT_DR10_380", "#sigma#Delta#theta(j_{reco},j_{true}) vs |cos#theta|", nRegionBinsAngles, pRegionBinEdgesAngles);
  h_380_CT_DR10_dtheta_SigmaCB_summary_histogram ->SetYTitle("#sigma#Delta#theta(j_{reco},j_{true})");
  h_380_CT_DR10_dtheta_SigmaCB_summary_histogram->SetXTitle("|cos#theta|");
  h_380_CT_DR10_dtheta_SigmaCB_summary_histogram->SetLineWidth(2);
  h_380_CT_DR10_dtheta_SigmaCB_summary_histogram->SetLineColor(kCyan+1);
  h_380_CT_DR10_dtheta_SigmaCB_summary_histogram->SetLineStyle(2);

  TH1F* h_380_CT_DR10_dtheta_RMS90_summary_histogram=new TH1F("dthetaRes_RMS90VsCosTheta_CT_DR10_380", "RMS_{90} #Delta#theta(j_{reco},j_{true}) vs |cos#theta|", nRegionBinsAngles, pRegionBinEdgesAngles);
  h_380_CT_DR10_dtheta_RMS90_summary_histogram ->SetYTitle("RMS_{90}#Delta#theta(j_{reco},j_{true})");
  h_380_CT_DR10_dtheta_RMS90_summary_histogram->SetXTitle("|cos#theta|");
  h_380_CT_DR10_dtheta_RMS90_summary_histogram->SetLineWidth(2);
  h_380_CT_DR10_dtheta_RMS90_summary_histogram->SetLineColor(kCyan+1);
  h_380_CT_DR10_dtheta_RMS90_summary_histogram->SetLineStyle(2);

  for(int i=137;i<161;i++){
    //continue;
    std::cout<<"ang histo 380 "<<i<<"]"<<std::endl;
   //double sided crystal ball
    TF1* fit_gaus_tmp = new TF1("fit_gaus_tmp", "gaus",-5.,5.);
    hist_vec_380_CT[i]->Fit("fit_gaus_tmp","R");
    hist_vec_380_CT[i]->GetFunction("fit_gaus_tmp");
    TF1* fdscb_tmp = new TF1("fdscb_tmp",fnc_dscb,-lim_angleDeg,lim_angleDeg,7);
   fdscb_tmp->SetNpx(2000);
    fdscb_tmp->SetParameter(0,fit_gaus_tmp->GetParameter(0));
    //norm
    fdscb_tmp->SetParLimits (0,0.5*fit_gaus_tmp->GetParameter(0),1.5*fit_gaus_tmp->GetParameter(0));
    fdscb_tmp->SetParameter(1,fit_gaus_tmp->GetParameter(1));
    //gaussian mean
    fdscb_tmp->SetParLimits (1,-2.,2.);
    fdscb_tmp->SetParameter(2,fit_gaus_tmp->GetParameter(2));
    fdscb_tmp->SetParLimits(2,fit_gaus_tmp->GetParameter(2)*0.50,1.50*fit_gaus_tmp->GetParameter(2));
    //std::vector<float>sigma2SFit=sigmaGaussianFits2Sigma(hist_vec_380_CT[i]);
    //fdscb_tmp->SetParameter(2,sigma2SFit[0]);
    //fdscb_tmp->SetParLimits(2,sigma2SFit[0]*0.50,1.50*sigma2SFit[0]);
    //-a1: parameter, from when the gaussian core should count
    fdscb_tmp->SetParameter(2,fit_gaus_tmp->GetParameter(2));
    fdscb_tmp->SetParameter (3,3.0);
    fdscb_tmp->SetParLimits (3,0.0,10.0);
    //a2 parameter, up to when the gaussian core should count
    fdscb_tmp->SetParameter (5,3.0);
    fdscb_tmp->SetParLimits (5,0.0,10.0);
    fdscb_tmp->SetParameter(4,5.);
    fdscb_tmp->SetParLimits(4,0.,25.);
    fdscb_tmp->SetParameter(6,5.);
    fdscb_tmp->SetParLimits(6,0.,25.);
    int fitstatus(0); 
    fitstatus = hist_vec_380_CT[i]->Fit(fdscb_tmp,"R");
    fdscb_tmp = hist_vec_380_CT[i]->GetFunction("fdscb_tmp");
    resolutionTH1=0; 
    resolutionErrorTH1=0;
    meanTH1=0;
    meanErrorTH1=0;
    CalculatePerformanceNoMean( hist_vec_380_CT[i], resolutionTH1, resolutionErrorTH1,meanTH1,meanErrorTH1);
    int first_bin_ang=137;
    if(i<141){//dphi DR05
      first_bin_ang=137;
      h_380_CT_DR05_dphi_SigmaCB_summary_histogram->SetBinContent(i-first_bin_ang+1,fdscb_tmp->GetParameter(2));
      h_380_CT_DR05_dphi_SigmaCB_summary_histogram->SetBinError(i-first_bin_ang+1,fdscb_tmp->GetParError(2));
      h_380_CT_DR05_dphi_RMS90_summary_histogram->SetBinContent(i-first_bin_ang+1,resolutionTH1);
      h_380_CT_DR05_dphi_RMS90_summary_histogram->SetBinError(i-first_bin_ang+1, resolutionErrorTH1);
    }else if(i<145){//dtheta DR05
      first_bin_ang=141;
      h_380_CT_DR05_dtheta_SigmaCB_summary_histogram->SetBinContent(i-first_bin_ang+1,fdscb_tmp->GetParameter(2));
      h_380_CT_DR05_dtheta_SigmaCB_summary_histogram->SetBinError(i-first_bin_ang+1,fdscb_tmp->GetParError(2));
      h_380_CT_DR05_dtheta_RMS90_summary_histogram->SetBinContent(i-first_bin_ang+1,resolutionTH1);
      h_380_CT_DR05_dtheta_RMS90_summary_histogram->SetBinError(i-first_bin_ang+1, resolutionErrorTH1);
    }else if(i<149){//dphi DR07
      first_bin_ang=145;
      h_380_CT_DR07_dphi_SigmaCB_summary_histogram->SetBinContent(i-first_bin_ang+1,fdscb_tmp->GetParameter(2));
      h_380_CT_DR07_dphi_SigmaCB_summary_histogram->SetBinError(i-first_bin_ang+1,fdscb_tmp->GetParError(2));
      h_380_CT_DR07_dphi_RMS90_summary_histogram->SetBinContent(i-first_bin_ang+1,resolutionTH1);
      h_380_CT_DR07_dphi_RMS90_summary_histogram->SetBinError(i-first_bin_ang+1, resolutionErrorTH1);
    }else if(i<153){//dtheta DR07
      first_bin_ang=149;
      h_380_CT_DR07_dtheta_SigmaCB_summary_histogram->SetBinContent(i-first_bin_ang+1,fdscb_tmp->GetParameter(2));
      h_380_CT_DR07_dtheta_SigmaCB_summary_histogram->SetBinError(i-first_bin_ang+1,fdscb_tmp->GetParError(2));
      h_380_CT_DR07_dtheta_RMS90_summary_histogram->SetBinContent(i-first_bin_ang+1,resolutionTH1);
      h_380_CT_DR07_dtheta_RMS90_summary_histogram->SetBinError(i-first_bin_ang+1, resolutionErrorTH1);
    }else if(i<157){//dphi DR07
      first_bin_ang=153;
      h_380_CT_DR10_dphi_SigmaCB_summary_histogram->SetBinContent(i-first_bin_ang+1,fdscb_tmp->GetParameter(2));
      h_380_CT_DR10_dphi_SigmaCB_summary_histogram->SetBinError(i-first_bin_ang+1,fdscb_tmp->GetParError(2));
      h_380_CT_DR10_dphi_RMS90_summary_histogram->SetBinContent(i-first_bin_ang+1,resolutionTH1);
      h_380_CT_DR10_dphi_RMS90_summary_histogram->SetBinError(i-first_bin_ang+1, resolutionErrorTH1);
    }else if(i<161){//dtheta DR07
      first_bin_ang=157;
      h_380_CT_DR10_dtheta_SigmaCB_summary_histogram->SetBinContent(i-first_bin_ang+1,fdscb_tmp->GetParameter(2));
      h_380_CT_DR10_dtheta_SigmaCB_summary_histogram->SetBinError(i-first_bin_ang+1,fdscb_tmp->GetParError(2));
      h_380_CT_DR10_dtheta_RMS90_summary_histogram->SetBinContent(i-first_bin_ang+1,resolutionTH1);
      h_380_CT_DR10_dtheta_RMS90_summary_histogram->SetBinError(i-first_bin_ang+1, resolutionErrorTH1);
    }
  }

  TH1F* h_380_CT_DR05_E_SigmaCB_summary_histogram=new TH1F("JER_SigmaCBVsCosTheta_CT_DR05_380", "#sigma (E_{j}^{reco} / E_{j}^{true}) vs |cos#theta|", nRegionBins, pRegionBinEdges);
  h_380_CT_DR05_E_SigmaCB_summary_histogram ->SetYTitle("#sigma(E_{j}) / E_{j} [%]");
  h_380_CT_DR05_E_SigmaCB_summary_histogram->SetXTitle("|cos#theta|");
  h_380_CT_DR05_E_SigmaCB_summary_histogram->SetLineWidth(2);
  h_380_CT_DR05_E_SigmaCB_summary_histogram->SetLineColor(kOrange);
  h_380_CT_DR05_E_SigmaCB_summary_histogram->SetLineStyle(2);
  TH1F* h_380_CT_DR05_E_RMS90_summary_histogram=new TH1F("JER_RMS90VsCosTheta_CT_DR05_380", "RMS_{90}(E_{j}^{reco}/E_{j}^{gen}) / Mean_{90}(E_{j}^{reco}/E_{j}^{gen}) vs |cos#theta|", nRegionBins, pRegionBinEdges);
  h_380_CT_DR05_E_RMS90_summary_histogram ->SetYTitle("RMS_{90}(E_{j}^{reco}/E_{j}^{gen}) / Mean_{90}(E_{j}^{reco}/E_{j}^{gen}) [%]");
  h_380_CT_DR05_E_RMS90_summary_histogram->SetXTitle("|cos#theta|");
  h_380_CT_DR05_E_RMS90_summary_histogram->SetLineWidth(2);
  h_380_CT_DR05_E_RMS90_summary_histogram->SetLineColor(kOrange);
  h_380_CT_DR05_E_RMS90_summary_histogram->SetLineStyle(2);

  TH1F* h_380_CT_DR05_E_RMS_summary_histogram=new TH1F("JER_RMSVsCosTheta_CT_DR05_380", "RMS(E_{j}) / Mean(E_{j}) vs |cos#theta|", nRegionBins, pRegionBinEdges);
  h_380_CT_DR05_E_RMS_summary_histogram ->SetYTitle("RMS(E_{j}) / Mean(E_{j}) [%]");
  h_380_CT_DR05_E_RMS_summary_histogram->SetXTitle("|cos#theta|");
  h_380_CT_DR05_E_RMS_summary_histogram->SetLineWidth(2);
  h_380_CT_DR05_E_RMS_summary_histogram->SetLineColor(kOrange);
  h_380_CT_DR05_E_RMS_summary_histogram->SetLineStyle(2);

  TH1F* h_380_CT_DR05_E_JER_Mean_summary_histogram=new TH1F("JER_MeanVsCosTheta_CT_DR05_380", "Mean(E_{tot}^{RECO}/E_{tot}^{true}) vs |cos#theta|", nRegionBins, pRegionBinEdges);
  h_380_CT_DR05_E_JER_Mean_summary_histogram->SetYTitle("Mean(E_{tot}^{RECO}/E_{tot}^{true})");
  h_380_CT_DR05_E_JER_Mean_summary_histogram->SetXTitle("|cos#theta|");
  h_380_CT_DR05_E_JER_Mean_summary_histogram->SetLineWidth(2);
  h_380_CT_DR05_E_JER_Mean_summary_histogram->SetLineColor(kOrange);
  h_380_CT_DR05_E_JER_Mean_summary_histogram->SetLineStyle(2);

  firstbin=59;
  for(int i=firstbin;i<(firstbin+13);i++){
    //continue;
    resolutionTH1=0; 
    resolutionErrorTH1=0;
    meanTH1=0;
    meanErrorTH1=0;
    CalculatePerformance( hist_vec_380_CT[i], resolutionTH1, resolutionErrorTH1,meanTH1,meanErrorTH1);
    h_380_CT_DR05_E_RMS90_summary_histogram->SetBinContent(i-firstbin+1,resolutionTH1/sqrt(2.));
    h_380_CT_DR05_E_RMS90_summary_histogram ->SetBinError(i-firstbin+1, resolutionErrorTH1/sqrt(2.));
    h_380_CT_DR05_E_RMS_summary_histogram->SetBinContent(i-firstbin+1,hist_vec_380_CT[i]->GetRMS()*100. );
    h_380_CT_DR05_E_RMS_summary_histogram ->SetBinError(i-firstbin+1, hist_vec_380_CT[i]->GetRMSError()*100.);
    h_380_CT_DR05_E_JER_Mean_summary_histogram->SetBinContent(i-firstbin+1,hist_vec_380_CT[i]->GetMean());
    h_380_CT_DR05_E_JER_Mean_summary_histogram->SetBinError(i-firstbin+1,hist_vec_380_CT[i]->GetMeanError());
   //double sided crystal ball
    TF1* fit_gaus_tmp = new TF1("fit_gaus_tmp", "gaus",0.50,1.50);
    hist_vec_380_CT[i]->Fit("fit_gaus_tmp","R");
    hist_vec_380_CT[i]->GetFunction("fit_gaus_tmp");
    TF1* fdscb_tmp = new TF1("fdscb_tmp",fnc_dscb,0.,3.,7);
   fdscb_tmp->SetNpx(1000);
    fdscb_tmp->SetParameter(0,fit_gaus_tmp->GetParameter(0));
    //norm
    fdscb_tmp->SetParLimits (0,0.5*fit_gaus_tmp->GetParameter(0),1.5*fit_gaus_tmp->GetParameter(0));
    fdscb_tmp->SetParameter(1,fit_gaus_tmp->GetParameter(1));
    //gaussian mean
    fdscb_tmp->SetParLimits (1,0.8,1.2);
    //fdscb_tmp->SetParameter(2,fit_gaus_tmp->GetParameter(2));
    //fdscb_tmp->SetParLimits(2,fit_gaus_tmp->GetParameter(2)*0.50,1.50*fit_gaus_tmp->GetParameter(2));
    std::vector<float>sigma2SFit=sigmaGaussianFits2Sigma(hist_vec_380_CT[i]);
    fdscb_tmp->SetParameter(2,sigma2SFit[0]);
    fdscb_tmp->SetParLimits(2,sigma2SFit[0]*0.50,1.50*sigma2SFit[0]);
    //-a1: parameter, from when the gaussian core should count
    fdscb_tmp->SetParameter(2,fit_gaus_tmp->GetParameter(2));
    fdscb_tmp->SetParameter (3,3.0);
    fdscb_tmp->SetParLimits (3,0.0,10.0);
    //a2 parameter, up to when the gaussian core should count
    fdscb_tmp->SetParameter (5,3.0);
    fdscb_tmp->SetParLimits (5,0.0,10.0);
    fdscb_tmp->SetParameter(4,5.);
    fdscb_tmp->SetParLimits(4,0.,25.);
    fdscb_tmp->SetParameter(6,5.);
    fdscb_tmp->SetParLimits(6,0.,25.);
    int fitstatus(0); 
    fitstatus = hist_vec_380_CT[i]->Fit(fdscb_tmp,"R");
    fdscb_tmp = hist_vec_380_CT[i]->GetFunction("fdscb_tmp");
    h_380_CT_DR05_E_SigmaCB_summary_histogram->SetBinContent(i-firstbin+1,fdscb_tmp->GetParameter(2)*100. );
    h_380_CT_DR05_E_SigmaCB_summary_histogram->SetBinError(i-firstbin+1,fdscb_tmp->GetParError(2)*100. );
  }  
  TH1F* h_380_CT_DR06_E_SigmaCB_summary_histogram=new TH1F("JER_SigmaCBVsCosTheta_CT_DR06_380", "#sigma (E_{j}^{reco} / E_{j}^{true}) vs |cos#theta|", nRegionBins, pRegionBinEdges);
  h_380_CT_DR06_E_SigmaCB_summary_histogram ->SetYTitle("#sigma(E_{j}) / E_{j} [%]");
  h_380_CT_DR06_E_SigmaCB_summary_histogram->SetXTitle("|cos#theta|");
  h_380_CT_DR06_E_SigmaCB_summary_histogram->SetLineWidth(2);
  h_380_CT_DR06_E_SigmaCB_summary_histogram->SetLineColor(kOrange);
  h_380_CT_DR06_E_SigmaCB_summary_histogram->SetLineStyle(2);
  TH1F* h_380_CT_DR06_E_RMS90_summary_histogram=new TH1F("JER_RMS90VsCosTheta_CT_DR06_380", "RMS_{90}(E_{j}^{reco}/E_{j}^{gen}) / Mean_{90}(E_{j}^{reco}/E_{j}^{gen}) vs |cos#theta|", nRegionBins, pRegionBinEdges);
  h_380_CT_DR06_E_RMS90_summary_histogram ->SetYTitle("RMS_{90}(E_{j}^{reco}/E_{j}^{gen}) / Mean_{90}(E_{j}^{reco}/E_{j}^{gen}) [%]");
  h_380_CT_DR06_E_RMS90_summary_histogram->SetXTitle("|cos#theta|");
  h_380_CT_DR06_E_RMS90_summary_histogram->SetLineWidth(2);
  h_380_CT_DR06_E_RMS90_summary_histogram->SetLineColor(kOrange);
  h_380_CT_DR06_E_RMS90_summary_histogram->SetLineStyle(2);

  TH1F* h_380_CT_DR06_E_RMS_summary_histogram=new TH1F("JER_RMSVsCosTheta_CT_DR06_380", "RMS(E_{j}) / Mean(E_{j}) vs |cos#theta|", nRegionBins, pRegionBinEdges);
  h_380_CT_DR06_E_RMS_summary_histogram ->SetYTitle("RMS(E_{j}) / Mean(E_{j}) [%]");
  h_380_CT_DR06_E_RMS_summary_histogram->SetXTitle("|cos#theta|");
  h_380_CT_DR06_E_RMS_summary_histogram->SetLineWidth(2);
  h_380_CT_DR06_E_RMS_summary_histogram->SetLineColor(kOrange);
  h_380_CT_DR06_E_RMS_summary_histogram->SetLineStyle(2);

  TH1F* h_380_CT_DR06_E_JER_Mean_summary_histogram=new TH1F("JER_MeanVsCosTheta_CT_DR06_380", "Mean(E_{tot}^{RECO}/E_{tot}^{true}) vs |cos#theta|", nRegionBins, pRegionBinEdges);
  h_380_CT_DR06_E_JER_Mean_summary_histogram->SetYTitle("Mean(E_{tot}^{RECO}/E_{tot}^{true})");
  h_380_CT_DR06_E_JER_Mean_summary_histogram->SetXTitle("|cos#theta|");
  h_380_CT_DR06_E_JER_Mean_summary_histogram->SetLineWidth(2);
  h_380_CT_DR06_E_JER_Mean_summary_histogram->SetLineColor(kOrange);
  h_380_CT_DR06_E_JER_Mean_summary_histogram->SetLineStyle(2);
  firstbin=72;
  for(int i=firstbin;i<(firstbin+13);i++){
    //continue;
    resolutionTH1=0; 
    resolutionErrorTH1=0;
    meanTH1=0;
    meanErrorTH1=0;
    CalculatePerformance( hist_vec_380_CT[i], resolutionTH1, resolutionErrorTH1,meanTH1,meanErrorTH1);
    h_380_CT_DR06_E_RMS90_summary_histogram->SetBinContent(i-firstbin+1,resolutionTH1/sqrt(2.));
    h_380_CT_DR06_E_RMS90_summary_histogram ->SetBinError(i-firstbin+1, resolutionErrorTH1/sqrt(2.));
    h_380_CT_DR06_E_RMS_summary_histogram->SetBinContent(i-firstbin+1,hist_vec_380_CT[i]->GetRMS()*100. );
    h_380_CT_DR06_E_RMS_summary_histogram ->SetBinError(i-firstbin+1, hist_vec_380_CT[i]->GetRMSError()*100.);
    h_380_CT_DR06_E_JER_Mean_summary_histogram->SetBinContent(i-firstbin+1,hist_vec_380_CT[i]->GetMean());
    h_380_CT_DR06_E_JER_Mean_summary_histogram->SetBinError(i-firstbin+1,hist_vec_380_CT[i]->GetMeanError());
   //double sided crystal ball
    TF1* fit_gaus_tmp = new TF1("fit_gaus_tmp", "gaus",0.50,1.50);
    hist_vec_380_CT[i]->Fit("fit_gaus_tmp","R");
    hist_vec_380_CT[i]->GetFunction("fit_gaus_tmp");
    TF1* fdscb_tmp = new TF1("fdscb_tmp",fnc_dscb,0.,3.,7);
   fdscb_tmp->SetNpx(1000);
    fdscb_tmp->SetParameter(0,fit_gaus_tmp->GetParameter(0));
    //norm
    fdscb_tmp->SetParLimits (0,0.5*fit_gaus_tmp->GetParameter(0),1.5*fit_gaus_tmp->GetParameter(0));
    fdscb_tmp->SetParameter(1,fit_gaus_tmp->GetParameter(1));
    //gaussian mean
    fdscb_tmp->SetParLimits (1,0.8,1.2);
    //fdscb_tmp->SetParameter(2,fit_gaus_tmp->GetParameter(2));
    //fdscb_tmp->SetParLimits(2,fit_gaus_tmp->GetParameter(2)*0.50,1.50*fit_gaus_tmp->GetParameter(2));
    std::vector<float>sigma2SFit=sigmaGaussianFits2Sigma(hist_vec_380_CT[i]);
    fdscb_tmp->SetParameter(2,sigma2SFit[0]);
    fdscb_tmp->SetParLimits(2,sigma2SFit[0]*0.50,1.50*sigma2SFit[0]);
    //-a1: parameter, from when the gaussian core should count
    fdscb_tmp->SetParameter(2,fit_gaus_tmp->GetParameter(2));
    fdscb_tmp->SetParameter (3,3.0);
    fdscb_tmp->SetParLimits (3,0.0,10.0);
    //a2 parameter, up to when the gaussian core should count
    fdscb_tmp->SetParameter (5,3.0);
    fdscb_tmp->SetParLimits (5,0.0,10.0);
    fdscb_tmp->SetParameter(4,5.);
    fdscb_tmp->SetParLimits(4,0.,25.);
    fdscb_tmp->SetParameter(6,5.);
    fdscb_tmp->SetParLimits(6,0.,25.);
    int fitstatus(0); 
    fitstatus = hist_vec_380_CT[i]->Fit(fdscb_tmp,"R");
    fdscb_tmp = hist_vec_380_CT[i]->GetFunction("fdscb_tmp");
    h_380_CT_DR06_E_SigmaCB_summary_histogram->SetBinContent(i-firstbin+1,fdscb_tmp->GetParameter(2)*100. );
    h_380_CT_DR06_E_SigmaCB_summary_histogram->SetBinError(i-firstbin+1,fdscb_tmp->GetParError(2)*100. );
  }  
  TH1F* h_380_CT_DR07_E_SigmaCB_summary_histogram=new TH1F("JER_SigmaCBVsCosTheta_CT_DR07_380", "#sigma (E_{j}^{reco} / E_{j}^{true}) vs |cos#theta|", nRegionBins, pRegionBinEdges);
  h_380_CT_DR07_E_SigmaCB_summary_histogram ->SetYTitle("#sigma(E_{j}) / E_{j} [%]");
  h_380_CT_DR07_E_SigmaCB_summary_histogram->SetXTitle("|cos#theta|");
  h_380_CT_DR07_E_SigmaCB_summary_histogram->SetLineWidth(2);
  h_380_CT_DR07_E_SigmaCB_summary_histogram->SetLineColor(kOrange);
  h_380_CT_DR07_E_SigmaCB_summary_histogram->SetLineStyle(2);

  TH1F* h_380_CT_DR07_E_RMS90_summary_histogram=new TH1F("JER_RMS90VsCosTheta_CT_DR07_380", "RMS_{90}(E_{j}^{reco}/E_{j}^{gen}) / Mean_{90}(E_{j}^{reco}/E_{j}^{gen}) vs |cos#theta|", nRegionBins, pRegionBinEdges);
  h_380_CT_DR07_E_RMS90_summary_histogram ->SetYTitle("RMS_{90}(E_{j}^{reco}/E_{j}^{gen}) / Mean_{90}(E_{j}^{reco}/E_{j}^{gen}) [%]");
  h_380_CT_DR07_E_RMS90_summary_histogram->SetXTitle("|cos#theta|");
  h_380_CT_DR07_E_RMS90_summary_histogram->SetLineWidth(2);
  h_380_CT_DR07_E_RMS90_summary_histogram->SetLineColor(kOrange);
  h_380_CT_DR07_E_RMS90_summary_histogram->SetLineStyle(2);

  TH1F* h_380_CT_DR07_E_RMS_summary_histogram=new TH1F("JER_RMSVsCosTheta_CT_DR07_380", "RMS(E_{j}) / Mean(E_{j}) vs |cos#theta|", nRegionBins, pRegionBinEdges);
  h_380_CT_DR07_E_RMS_summary_histogram ->SetYTitle("RMS(E_{j}) / Mean(E_{j}) [%]");
  h_380_CT_DR07_E_RMS_summary_histogram->SetXTitle("|cos#theta|");
  h_380_CT_DR07_E_RMS_summary_histogram->SetLineWidth(2);
  h_380_CT_DR07_E_RMS_summary_histogram->SetLineColor(kOrange);
  h_380_CT_DR07_E_RMS_summary_histogram->SetLineStyle(2);

  TH1F* h_380_CT_DR07_E_JER_Mean_summary_histogram=new TH1F("JER_MeanVsCosTheta_CT_DR07_380", "Mean(E_{tot}^{RECO}/E_{tot}^{true}) vs |cos#theta|", nRegionBins, pRegionBinEdges);
  h_380_CT_DR07_E_JER_Mean_summary_histogram->SetYTitle("Mean(E_{tot}^{RECO}/E_{tot}^{true})");
  h_380_CT_DR07_E_JER_Mean_summary_histogram->SetXTitle("|cos#theta|");
  h_380_CT_DR07_E_JER_Mean_summary_histogram->SetLineWidth(2);
  h_380_CT_DR07_E_JER_Mean_summary_histogram->SetLineColor(kOrange);
  h_380_CT_DR07_E_JER_Mean_summary_histogram->SetLineStyle(2);
  firstbin=85;
  std::cout<<"start DR07 380"<<std::endl;
  for(int i=firstbin;i<(firstbin+13);i++){
    //continue;
    resolutionTH1=0; 
    resolutionErrorTH1=0;
    meanTH1=0;
    meanErrorTH1=0;
    CalculatePerformance( hist_vec_380_CT[i], resolutionTH1, resolutionErrorTH1,meanTH1,meanErrorTH1);
    h_380_CT_DR07_E_RMS90_summary_histogram->SetBinContent(i-firstbin+1,resolutionTH1/sqrt(2.));
    h_380_CT_DR07_E_RMS90_summary_histogram ->SetBinError(i-firstbin+1, resolutionErrorTH1/sqrt(2.));
    h_380_CT_DR07_E_RMS_summary_histogram->SetBinContent(i-firstbin+1,hist_vec_380_CT[i]->GetRMS()*100. );
    h_380_CT_DR07_E_RMS_summary_histogram ->SetBinError(i-firstbin+1, hist_vec_380_CT[i]->GetRMSError()*100.);
    h_380_CT_DR07_E_JER_Mean_summary_histogram->SetBinContent(i-firstbin+1,hist_vec_380_CT[i]->GetMean());
    h_380_CT_DR07_E_JER_Mean_summary_histogram->SetBinError(i-firstbin+1,hist_vec_380_CT[i]->GetMeanError());
   //double sided crystal ball
    TF1* fit_gaus_tmp = new TF1("fit_gaus_tmp", "gaus",0.50,1.50);
    hist_vec_380_CT[i]->Fit("fit_gaus_tmp","R");
    hist_vec_380_CT[i]->GetFunction("fit_gaus_tmp");
    TF1* fdscb_tmp = new TF1("fdscb_tmp",fnc_dscb,0.,3.,7);
   fdscb_tmp->SetNpx(1000);
    fdscb_tmp->SetParameter(0,fit_gaus_tmp->GetParameter(0));
    //norm
    fdscb_tmp->SetParLimits (0,0.5*fit_gaus_tmp->GetParameter(0),1.5*fit_gaus_tmp->GetParameter(0));
    fdscb_tmp->SetParameter(1,fit_gaus_tmp->GetParameter(1));
    //gaussian mean
    fdscb_tmp->SetParLimits (1,0.8,1.2);
    //fdscb_tmp->SetParameter(2,fit_gaus_tmp->GetParameter(2));
    //fdscb_tmp->SetParLimits(2,fit_gaus_tmp->GetParameter(2)*0.50,1.50*fit_gaus_tmp->GetParameter(2));
    std::vector<float>sigma2SFit=sigmaGaussianFits2Sigma(hist_vec_380_CT[i]);
    fdscb_tmp->SetParameter(2,sigma2SFit[0]);
    fdscb_tmp->SetParLimits(2,sigma2SFit[0]*0.50,1.50*sigma2SFit[0]);
    //-a1: parameter, from when the gaussian core should count
    fdscb_tmp->SetParameter(2,fit_gaus_tmp->GetParameter(2));
    fdscb_tmp->SetParameter (3,3.0);
    fdscb_tmp->SetParLimits (3,0.0,10.0);
    //a2 parameter, up to when the gaussian core should count
    fdscb_tmp->SetParameter (5,3.0);
    fdscb_tmp->SetParLimits (5,0.0,10.0);
    fdscb_tmp->SetParameter(4,5.);
    fdscb_tmp->SetParLimits(4,0.,25.);
    fdscb_tmp->SetParameter(6,5.);
    fdscb_tmp->SetParLimits(6,0.,25.);
    int fitstatus(0); 
    fitstatus = hist_vec_380_CT[i]->Fit(fdscb_tmp,"R");
    fdscb_tmp = hist_vec_380_CT[i]->GetFunction("fdscb_tmp");
    h_380_CT_DR07_E_SigmaCB_summary_histogram->SetBinContent(i-firstbin+1,fdscb_tmp->GetParameter(2)*100. );
    h_380_CT_DR07_E_SigmaCB_summary_histogram->SetBinError(i-firstbin+1,fdscb_tmp->GetParError(2)*100. );
  }  
  TH1F* h_380_CT_DR08_E_SigmaCB_summary_histogram=new TH1F("JER_SigmaCBVsCosTheta_CT_DR08_380", "#sigma (E_{j}^{reco} / E_{j}^{true}) vs |cos#theta|", nRegionBins, pRegionBinEdges);
  h_380_CT_DR08_E_SigmaCB_summary_histogram ->SetYTitle("#sigma(E_{j}) / E_{j} [%]");
  h_380_CT_DR08_E_SigmaCB_summary_histogram->SetXTitle("|cos#theta|");
  h_380_CT_DR08_E_SigmaCB_summary_histogram->SetLineWidth(2);
  h_380_CT_DR08_E_SigmaCB_summary_histogram->SetLineColor(kOrange);
  h_380_CT_DR08_E_SigmaCB_summary_histogram->SetLineStyle(2);
 
  TH1F* h_380_CT_DR08_E_RMS90_summary_histogram=new TH1F("JER_RMS90VsCosTheta_CT_DR08_380", "RMS_{90}(E_{j}^{reco}/E_{j}^{gen}) / Mean_{90}(E_{j}^{reco}/E_{j}^{gen}) vs |cos#theta|", nRegionBins, pRegionBinEdges);
  h_380_CT_DR08_E_RMS90_summary_histogram ->SetYTitle("RMS_{90}(E_{j}^{reco}/E_{j}^{gen}) / Mean_{90}(E_{j}^{reco}/E_{j}^{gen}) [%]");
  h_380_CT_DR08_E_RMS90_summary_histogram->SetXTitle("|cos#theta|");
  h_380_CT_DR08_E_RMS90_summary_histogram->SetLineWidth(2);
  h_380_CT_DR08_E_RMS90_summary_histogram->SetLineColor(kOrange);
  h_380_CT_DR08_E_RMS90_summary_histogram->SetLineStyle(2);

  TH1F* h_380_CT_DR08_E_RMS_summary_histogram=new TH1F("JER_RMSVsCosTheta_CT_DR08_380", "RMS(E_{j}) / Mean(E_{j}) vs |cos#theta|", nRegionBins, pRegionBinEdges);
  h_380_CT_DR08_E_RMS_summary_histogram ->SetYTitle("RMS(E_{j}) / Mean(E_{j}) [%]");
  h_380_CT_DR08_E_RMS_summary_histogram->SetXTitle("|cos#theta|");
  h_380_CT_DR08_E_RMS_summary_histogram->SetLineWidth(2);
  h_380_CT_DR08_E_RMS_summary_histogram->SetLineColor(kOrange);
  h_380_CT_DR08_E_RMS_summary_histogram->SetLineStyle(2);

  TH1F* h_380_CT_DR08_E_JER_Mean_summary_histogram=new TH1F("JER_MeanVsCosTheta_CT_DR08_380", "Mean(E_{tot}^{RECO}/E_{tot}^{true}) vs |cos#theta|", nRegionBins, pRegionBinEdges);
  h_380_CT_DR08_E_JER_Mean_summary_histogram->SetYTitle("Mean(E_{tot}^{RECO}/E_{tot}^{true})");
  h_380_CT_DR08_E_JER_Mean_summary_histogram->SetXTitle("|cos#theta|");
  h_380_CT_DR08_E_JER_Mean_summary_histogram->SetLineWidth(2);
  h_380_CT_DR08_E_JER_Mean_summary_histogram->SetLineColor(kOrange);
  h_380_CT_DR08_E_JER_Mean_summary_histogram->SetLineStyle(2);
  firstbin=98;
  for(int i=firstbin;i<(firstbin+13);i++){
    //continue;
    resolutionTH1=0; 
    resolutionErrorTH1=0;
    meanTH1=0;
    meanErrorTH1=0;
    CalculatePerformance( hist_vec_380_CT[i], resolutionTH1, resolutionErrorTH1,meanTH1,meanErrorTH1);
    h_380_CT_DR08_E_RMS90_summary_histogram->SetBinContent(i-firstbin+1,resolutionTH1/sqrt(2.));
    h_380_CT_DR08_E_RMS90_summary_histogram ->SetBinError(i-firstbin+1, resolutionErrorTH1/sqrt(2.));
    h_380_CT_DR08_E_RMS_summary_histogram->SetBinContent(i-firstbin+1,hist_vec_380_CT[i]->GetRMS()*100. );
    h_380_CT_DR08_E_RMS_summary_histogram ->SetBinError(i-firstbin+1, hist_vec_380_CT[i]->GetRMSError()*100.);
    h_380_CT_DR08_E_JER_Mean_summary_histogram->SetBinContent(i-firstbin+1,hist_vec_380_CT[i]->GetMean());
    h_380_CT_DR08_E_JER_Mean_summary_histogram->SetBinError(i-firstbin+1,hist_vec_380_CT[i]->GetMeanError());
    //double sided crystal ball
    TF1* fit_gaus_tmp = new TF1("fit_gaus_tmp", "gaus",0.50,1.50);
    hist_vec_380_CT[i]->Fit("fit_gaus_tmp","R");
    hist_vec_380_CT[i]->GetFunction("fit_gaus_tmp");
    TF1* fdscb_tmp = new TF1("fdscb_tmp",fnc_dscb,0.,3.,7);
   fdscb_tmp->SetNpx(1000);
    fdscb_tmp->SetParameter(0,fit_gaus_tmp->GetParameter(0));
    //norm
    fdscb_tmp->SetParLimits (0,0.5*fit_gaus_tmp->GetParameter(0),1.5*fit_gaus_tmp->GetParameter(0));
    fdscb_tmp->SetParameter(1,fit_gaus_tmp->GetParameter(1));
    //gaussian mean
    fdscb_tmp->SetParLimits (1,0.8,1.2);
    //fdscb_tmp->SetParameter(2,fit_gaus_tmp->GetParameter(2));
    //fdscb_tmp->SetParLimits(2,fit_gaus_tmp->GetParameter(2)*0.50,1.50*fit_gaus_tmp->GetParameter(2));
    std::vector<float>sigma2SFit=sigmaGaussianFits2Sigma(hist_vec_380_CT[i]);
    fdscb_tmp->SetParameter(2,sigma2SFit[0]);
    fdscb_tmp->SetParLimits(2,sigma2SFit[0]*0.50,1.50*sigma2SFit[0]);
    //-a1: parameter, from when the gaussian core should count
    fdscb_tmp->SetParameter(2,fit_gaus_tmp->GetParameter(2));
    fdscb_tmp->SetParameter (3,3.0);
    fdscb_tmp->SetParLimits (3,0.0,10.0);
    //a2 parameter, up to when the gaussian core should count
    fdscb_tmp->SetParameter (5,3.0);
    fdscb_tmp->SetParLimits (5,0.0,10.0);
    fdscb_tmp->SetParameter(4,5.);
    fdscb_tmp->SetParLimits(4,0.,25.);
    fdscb_tmp->SetParameter(6,5.);
    fdscb_tmp->SetParLimits(6,0.,25.);
    int fitstatus(0); 
    fitstatus = hist_vec_380_CT[i]->Fit(fdscb_tmp,"R");
    fdscb_tmp = hist_vec_380_CT[i]->GetFunction("fdscb_tmp");
    h_380_CT_DR08_E_SigmaCB_summary_histogram->SetBinContent(i-firstbin+1,fdscb_tmp->GetParameter(2)*100. );
    h_380_CT_DR08_E_SigmaCB_summary_histogram->SetBinError(i-firstbin+1,fdscb_tmp->GetParError(2)*100. );
  }  
  TH1F* h_380_CT_DR09_E_SigmaCB_summary_histogram=new TH1F("JER_SigmaCBVsCosTheta_CT_DR09_380", "#sigma (E_{j}^{reco} / E_{j}^{true}) vs |cos#theta|", nRegionBins, pRegionBinEdges);
  h_380_CT_DR09_E_SigmaCB_summary_histogram ->SetYTitle("#sigma(E_{j}) / E_{j} [%]");
  h_380_CT_DR09_E_SigmaCB_summary_histogram->SetXTitle("|cos#theta|");
  h_380_CT_DR09_E_SigmaCB_summary_histogram->SetLineWidth(2);
  h_380_CT_DR09_E_SigmaCB_summary_histogram->SetLineColor(kOrange);
  h_380_CT_DR09_E_SigmaCB_summary_histogram->SetLineStyle(2);
  TH1F* h_380_CT_DR09_E_RMS90_summary_histogram=new TH1F("JER_RMS90VsCosTheta_CT_DR09_380", "RMS_{90}(E_{j}^{reco}/E_{j}^{gen}) / Mean_{90}(E_{j}^{reco}/E_{j}^{gen}) vs |cos#theta|", nRegionBins, pRegionBinEdges);
  h_380_CT_DR09_E_RMS90_summary_histogram ->SetYTitle("RMS_{90}(E_{j}^{reco}/E_{j}^{gen}) / Mean_{90}(E_{j}^{reco}/E_{j}^{gen}) [%]");
  h_380_CT_DR09_E_RMS90_summary_histogram->SetXTitle("|cos#theta|");
  h_380_CT_DR09_E_RMS90_summary_histogram->SetLineWidth(2);
  h_380_CT_DR09_E_RMS90_summary_histogram->SetLineColor(kOrange);
  h_380_CT_DR09_E_RMS90_summary_histogram->SetLineStyle(2);

  TH1F* h_380_CT_DR09_E_RMS_summary_histogram=new TH1F("JER_RMSVsCosTheta_CT_DR09_380", "RMS(E_{j}) / Mean(E_{j}) vs |cos#theta|", nRegionBins, pRegionBinEdges);
  h_380_CT_DR09_E_RMS_summary_histogram ->SetYTitle("RMS(E_{j}) / Mean(E_{j}) [%]");
  h_380_CT_DR09_E_RMS_summary_histogram->SetXTitle("|cos#theta|");
  h_380_CT_DR09_E_RMS_summary_histogram->SetLineWidth(2);
  h_380_CT_DR09_E_RMS_summary_histogram->SetLineColor(kOrange);
  h_380_CT_DR09_E_RMS_summary_histogram->SetLineStyle(2);

  TH1F* h_380_CT_DR09_E_JER_Mean_summary_histogram=new TH1F("JER_MeanVsCosTheta_CT_DR09_380", "Mean(E_{tot}^{RECO}/E_{tot}^{true}) vs |cos#theta|", nRegionBins, pRegionBinEdges);
  h_380_CT_DR09_E_JER_Mean_summary_histogram->SetYTitle("Mean(E_{tot}^{RECO}/E_{tot}^{true})");
  h_380_CT_DR09_E_JER_Mean_summary_histogram->SetXTitle("|cos#theta|");
  h_380_CT_DR09_E_JER_Mean_summary_histogram->SetLineWidth(2);
  h_380_CT_DR09_E_JER_Mean_summary_histogram->SetLineColor(kOrange);
  h_380_CT_DR09_E_JER_Mean_summary_histogram->SetLineStyle(2);
  firstbin=111;
  for(int i=firstbin;i<(firstbin+13);i++){
    //continue;
    resolutionTH1=0; 
    resolutionErrorTH1=0;
    meanTH1=0;
    meanErrorTH1=0;
    CalculatePerformance( hist_vec_380_CT[i], resolutionTH1, resolutionErrorTH1,meanTH1,meanErrorTH1);
    h_380_CT_DR09_E_RMS90_summary_histogram->SetBinContent(i-firstbin+1,resolutionTH1/sqrt(2.));
    h_380_CT_DR09_E_RMS90_summary_histogram ->SetBinError(i-firstbin+1, resolutionErrorTH1/sqrt(2.));
    h_380_CT_DR09_E_RMS_summary_histogram->SetBinContent(i-firstbin+1,hist_vec_380_CT[i]->GetRMS()*100. );
    h_380_CT_DR09_E_RMS_summary_histogram ->SetBinError(i-firstbin+1, hist_vec_380_CT[i]->GetRMSError()*100.);
    h_380_CT_DR09_E_JER_Mean_summary_histogram->SetBinContent(i-firstbin+1,hist_vec_380_CT[i]->GetMean());
    h_380_CT_DR09_E_JER_Mean_summary_histogram->SetBinError(i-firstbin+1,hist_vec_380_CT[i]->GetMeanError());
    //double sided crystal ball
    TF1* fit_gaus_tmp = new TF1("fit_gaus_tmp", "gaus",0.50,1.50);
    hist_vec_380_CT[i]->Fit("fit_gaus_tmp","R");
    hist_vec_380_CT[i]->GetFunction("fit_gaus_tmp");
    TF1* fdscb_tmp = new TF1("fdscb_tmp",fnc_dscb,0.,3.,7);
   fdscb_tmp->SetNpx(1000);
    fdscb_tmp->SetParameter(0,fit_gaus_tmp->GetParameter(0));
    //norm
    fdscb_tmp->SetParLimits (0,0.5*fit_gaus_tmp->GetParameter(0),1.5*fit_gaus_tmp->GetParameter(0));
    fdscb_tmp->SetParameter(1,fit_gaus_tmp->GetParameter(1));
    //gaussian mean
    fdscb_tmp->SetParLimits (1,0.8,1.2);
    //fdscb_tmp->SetParameter(2,fit_gaus_tmp->GetParameter(2));
    //fdscb_tmp->SetParLimits(2,fit_gaus_tmp->GetParameter(2)*0.50,1.50*fit_gaus_tmp->GetParameter(2));
    std::vector<float>sigma2SFit=sigmaGaussianFits2Sigma(hist_vec_380_CT[i]);
    fdscb_tmp->SetParameter(2,sigma2SFit[0]);
    fdscb_tmp->SetParLimits(2,sigma2SFit[0]*0.50,1.50*sigma2SFit[0]);
    //-a1: parameter, from when the gaussian core should count
    fdscb_tmp->SetParameter(2,fit_gaus_tmp->GetParameter(2));
    fdscb_tmp->SetParameter (3,3.0);
    fdscb_tmp->SetParLimits (3,0.0,10.0);
    //a2 parameter, up to when the gaussian core should count
    fdscb_tmp->SetParameter (5,3.0);
    fdscb_tmp->SetParLimits (5,0.0,10.0);
    fdscb_tmp->SetParameter(4,5.);
    fdscb_tmp->SetParLimits(4,0.,25.);
    fdscb_tmp->SetParameter(6,5.);
    fdscb_tmp->SetParLimits(6,0.,25.);
    int fitstatus(0); 
    fitstatus = hist_vec_380_CT[i]->Fit(fdscb_tmp,"R");
    fdscb_tmp = hist_vec_380_CT[i]->GetFunction("fdscb_tmp");
    h_380_CT_DR09_E_SigmaCB_summary_histogram->SetBinContent(i-firstbin+1,fdscb_tmp->GetParameter(2)*100. );
    h_380_CT_DR09_E_SigmaCB_summary_histogram->SetBinError(i-firstbin+1,fdscb_tmp->GetParError(2)*100. );
  }  
  TH1F* h_380_CT_DR10_E_SigmaCB_summary_histogram=new TH1F("JER_SigmaCBVsCosTheta_CT_DR10_380", "#sigma (E_{j}^{reco} / E_{j}^{true}) vs |cos#theta|", nRegionBins, pRegionBinEdges);
  h_380_CT_DR10_E_SigmaCB_summary_histogram ->SetYTitle("#sigma(E_{j}) / E_{j} [%]");
  h_380_CT_DR10_E_SigmaCB_summary_histogram->SetXTitle("|cos#theta|");
  h_380_CT_DR10_E_SigmaCB_summary_histogram->SetLineWidth(2);
  h_380_CT_DR10_E_SigmaCB_summary_histogram->SetLineColor(kOrange);
  h_380_CT_DR10_E_SigmaCB_summary_histogram->SetLineStyle(2);
  TH1F* h_380_CT_DR10_E_RMS90_summary_histogram=new TH1F("JER_RMS90VsCosTheta_CT_DR10_380", "RMS_{90}(E_{j}^{reco}/E_{j}^{gen}) / Mean_{90}(E_{j}^{reco}/E_{j}^{gen}) vs |cos#theta|", nRegionBins, pRegionBinEdges);
  h_380_CT_DR10_E_RMS90_summary_histogram ->SetYTitle("RMS_{90}(E_{j}^{reco}/E_{j}^{gen}) / Mean_{90}(E_{j}^{reco}/E_{j}^{gen}) [%]");
  h_380_CT_DR10_E_RMS90_summary_histogram->SetXTitle("|cos#theta|");
  h_380_CT_DR10_E_RMS90_summary_histogram->SetLineWidth(2);
  h_380_CT_DR10_E_RMS90_summary_histogram->SetLineColor(kOrange);
  h_380_CT_DR10_E_RMS90_summary_histogram->SetLineStyle(2);

  TH1F* h_380_CT_DR10_E_RMS_summary_histogram=new TH1F("JER_RMSVsCosTheta_CT_DR10_380", "RMS(E_{j}) / Mean(E_{j}) vs |cos#theta|", nRegionBins, pRegionBinEdges);
  h_380_CT_DR10_E_RMS_summary_histogram ->SetYTitle("RMS(E_{j}) / Mean(E_{j}) [%]");
  h_380_CT_DR10_E_RMS_summary_histogram->SetXTitle("|cos#theta|");
  h_380_CT_DR10_E_RMS_summary_histogram->SetLineWidth(2);
  h_380_CT_DR10_E_RMS_summary_histogram->SetLineColor(kOrange);
  h_380_CT_DR10_E_RMS_summary_histogram->SetLineStyle(2);

  TH1F* h_380_CT_DR10_E_JER_Mean_summary_histogram=new TH1F("JER_MeanVsCosTheta_CT_DR10_380", "Mean(E_{tot}^{RECO}/E_{tot}^{true}) vs |cos#theta|", nRegionBins, pRegionBinEdges);
  h_380_CT_DR10_E_JER_Mean_summary_histogram->SetYTitle("Mean(E_{tot}^{RECO}/E_{tot}^{true})");
  h_380_CT_DR10_E_JER_Mean_summary_histogram->SetXTitle("|cos#theta|");
  h_380_CT_DR10_E_JER_Mean_summary_histogram->SetLineWidth(2);
  h_380_CT_DR10_E_JER_Mean_summary_histogram->SetLineColor(kOrange);
  h_380_CT_DR10_E_JER_Mean_summary_histogram->SetLineStyle(2);
  firstbin=124;
  for(int i=firstbin;i<(firstbin+13);i++){
    //continue;
    resolutionTH1=0; 
    resolutionErrorTH1=0;
    meanTH1=0;
    meanErrorTH1=0;
    CalculatePerformance( hist_vec_380_CT[i], resolutionTH1, resolutionErrorTH1,meanTH1,meanErrorTH1);
    h_380_CT_DR10_E_RMS90_summary_histogram->SetBinContent(i-firstbin+1,resolutionTH1/sqrt(2.));
    h_380_CT_DR10_E_RMS90_summary_histogram ->SetBinError(i-firstbin+1, resolutionErrorTH1/sqrt(2.));
    h_380_CT_DR10_E_RMS_summary_histogram->SetBinContent(i-firstbin+1,hist_vec_380_CT[i]->GetRMS()*100. );
    h_380_CT_DR10_E_RMS_summary_histogram ->SetBinError(i-firstbin+1, hist_vec_380_CT[i]->GetRMSError()*100.);
    h_380_CT_DR10_E_JER_Mean_summary_histogram->SetBinContent(i-firstbin+1,hist_vec_380_CT[i]->GetMean());
    h_380_CT_DR10_E_JER_Mean_summary_histogram->SetBinError(i-firstbin+1,hist_vec_380_CT[i]->GetMeanError());
   //double sided crystal ball
    TF1* fit_gaus_tmp = new TF1("fit_gaus_tmp", "gaus",0.50,1.50);
    hist_vec_380_CT[i]->Fit("fit_gaus_tmp","R");
    hist_vec_380_CT[i]->GetFunction("fit_gaus_tmp");
    TF1* fdscb_tmp = new TF1("fdscb_tmp",fnc_dscb,0.,3.,7);
   fdscb_tmp->SetNpx(1000);
    fdscb_tmp->SetParameter(0,fit_gaus_tmp->GetParameter(0));
    //norm
    fdscb_tmp->SetParLimits (0,0.5*fit_gaus_tmp->GetParameter(0),1.5*fit_gaus_tmp->GetParameter(0));
    fdscb_tmp->SetParameter(1,fit_gaus_tmp->GetParameter(1));
    //gaussian mean
    fdscb_tmp->SetParLimits (1,0.8,1.2);
    //fdscb_tmp->SetParameter(2,fit_gaus_tmp->GetParameter(2));
    //fdscb_tmp->SetParLimits(2,fit_gaus_tmp->GetParameter(2)*0.50,1.50*fit_gaus_tmp->GetParameter(2));
    std::vector<float>sigma2SFit=sigmaGaussianFits2Sigma(hist_vec_380_CT[i]);
    fdscb_tmp->SetParameter(2,sigma2SFit[0]);
    fdscb_tmp->SetParLimits(2,sigma2SFit[0]*0.50,1.50*sigma2SFit[0]);
    //-a1: parameter, from when the gaussian core should count
    fdscb_tmp->SetParameter(2,fit_gaus_tmp->GetParameter(2));
    fdscb_tmp->SetParameter (3,3.0);
    fdscb_tmp->SetParLimits (3,0.0,10.0);
    //a2 parameter, up to when the gaussian core should count
    fdscb_tmp->SetParameter (5,3.0);
    fdscb_tmp->SetParLimits (5,0.0,10.0);
    fdscb_tmp->SetParameter(4,5.);
    fdscb_tmp->SetParLimits(4,0.,25.);
    fdscb_tmp->SetParameter(6,5.);
    fdscb_tmp->SetParLimits(6,0.,25.);
    int fitstatus(0); 
    fitstatus = hist_vec_380_CT[i]->Fit(fdscb_tmp,"R");
    fdscb_tmp = hist_vec_380_CT[i]->GetFunction("fdscb_tmp");
    h_380_CT_DR10_E_SigmaCB_summary_histogram->SetBinContent(i-firstbin+1,fdscb_tmp->GetParameter(2)*100. );
    h_380_CT_DR10_E_SigmaCB_summary_histogram->SetBinError(i-firstbin+1,fdscb_tmp->GetParError(2)*100. );
  }  

  std::cout<<"380 03/04/05/06 "<< calculate_over90(h_380_CT_recojet03_E1_E2_over_E_True)<<"/"<< calculate_over90(h_380_CT_recojet04_E1_E2_over_E_True)<<"/"<< calculate_over90(h_380_CT_recojet05_E1_E2_over_E_True)<<"/"<<calculate_over90(h_380_CT_recojet06_E1_E2_over_E_True)<<" 07/08/09/10 "<< calculate_over90(h_380_CT_recojet07_E1_E2_over_E_True)<<"/"<< calculate_over90(h_380_CT_recojet08_E1_E2_over_E_True)<<"/"<< calculate_over90(h_380_CT_recojet09_E1_E2_over_E_True)<<"/"<<calculate_over90(h_380_CT_recojet10_E1_E2_over_E_True)<<std::endl;
  std::cout<<"jet histos 380 CT filled"<<std::endl;



  TH1F* h_380_CT_wO_genjet03_dphi_j1j2 =  new TH1F("h_380_CT_wO_genjet03_dphi_j1j2","", n_bins100, 0.5,TMath::Pi());
  TH1F* h_380_CT_wO_genjet03_E1_E2_over_E_True =  new TH1F("h_380_CT_wO_genjet03_E1_E2_over_E_True","", n_bins100, 0.5,1.00);
  TH1F* h_380_CT_wO_genjet03_Delta_E1_E2_over_E12 =  new TH1F("h_380_CT_wO_genjet03_Delta_E1_E2_over_E12","", n_bins100, -0.5,0.5);
  TH1F* h_380_CT_wO_genjet04_dphi_j1j2 =  new TH1F("h_380_CT_wO_genjet04_dphi_j1j2","", n_bins100, 0.5,TMath::Pi());
  TH1F* h_380_CT_wO_genjet04_E1_E2_over_E_True =  new TH1F("h_380_CT_wO_genjet04_E1_E2_over_E_True","", n_bins100, 0.5,1.00);
  TH1F* h_380_CT_wO_genjet04_Delta_E1_E2_over_E12 =  new TH1F("h_380_CT_wO_genjet04_Delta_E1_E2_over_E12","", n_bins100, -0.5,0.5);
  TH1F* h_380_CT_wO_genjet05_dphi_j1j2 =  new TH1F("h_380_CT_wO_genjet05_dphi_j1j2","", n_bins100, 0.5,TMath::Pi());
  TH1F* h_380_CT_wO_genjet05_E1_E2_over_E_True =  new TH1F("h_380_CT_wO_genjet05_E1_E2_over_E_True","", n_bins100, 0.5,1.00);
  TH1F* h_380_CT_wO_genjet05_Delta_E1_E2_over_E12 =  new TH1F("h_380_CT_wO_genjet05_Delta_E1_E2_over_E12","", n_bins100, -0.5,0.5);
  TH1F* h_380_CT_wO_genjet06_dphi_j1j2 =  new TH1F("h_380_CT_wO_genjet06_dphi_j1j2","", n_bins100, 0.5,TMath::Pi());
  TH1F* h_380_CT_wO_genjet06_E1_E2_over_E_True =  new TH1F("h_380_CT_wO_genjet06_E1_E2_over_E_True","", n_bins100, 0.5,1.00);
  TH1F* h_380_CT_wO_genjet06_Delta_E1_E2_over_E12 =  new TH1F("h_380_CT_wO_genjet06_Delta_E1_E2_over_E12","", n_bins100, -0.5,0.5);
  TH1F* h_380_CT_wO_genjet07_dphi_j1j2 =  new TH1F("h_380_CT_wO_genjet07_dphi_j1j2","", n_bins100, 0.5,TMath::Pi());
  TH1F* h_380_CT_wO_genjet07_E1_E2_over_E_True =  new TH1F("h_380_CT_wO_genjet07_E1_E2_over_E_True","", n_bins100, 0.5,1.00);
  TH1F* h_380_CT_wO_genjet07_Delta_E1_E2_over_E12 =  new TH1F("h_380_CT_wO_genjet07_Delta_E1_E2_over_E12","", n_bins100, -0.5,0.5);
  TH1F* h_380_CT_wO_genjet08_dphi_j1j2 =  new TH1F("h_380_CT_wO_genjet08_dphi_j1j2","", n_bins100, 0.5,TMath::Pi());
  TH1F* h_380_CT_wO_genjet08_E1_E2_over_E_True =  new TH1F("h_380_CT_wO_genjet08_E1_E2_over_E_True","", n_bins100, 0.5,1.00);
  TH1F* h_380_CT_wO_genjet08_Delta_E1_E2_over_E12 =  new TH1F("h_380_CT_wO_genjet08_Delta_E1_E2_over_E12","", n_bins100, -0.5,0.5);
  TH1F* h_380_CT_wO_genjet09_dphi_j1j2 =  new TH1F("h_380_CT_wO_genjet09_dphi_j1j2","", n_bins100, 0.5,TMath::Pi());
  TH1F* h_380_CT_wO_genjet09_E1_E2_over_E_True =  new TH1F("h_380_CT_wO_genjet09_E1_E2_over_E_True","", n_bins100, 0.5,1.00);
  TH1F* h_380_CT_wO_genjet09_Delta_E1_E2_over_E12 =  new TH1F("h_380_CT_wO_genjet09_Delta_E1_E2_over_E12","", n_bins100, -0.5,0.5);
  TH1F* h_380_CT_wO_genjet10_dphi_j1j2 =  new TH1F("h_380_CT_wO_genjet10_dphi_j1j2","", n_bins100, 0.5,TMath::Pi());
  TH1F* h_380_CT_wO_genjet10_E1_E2_over_E_True =  new TH1F("h_380_CT_wO_genjet10_E1_E2_over_E_True","", n_bins100, 0.5,1.00);
  TH1F* h_380_CT_wO_genjet10_Delta_E1_E2_over_E12 =  new TH1F("h_380_CT_wO_genjet10_Delta_E1_E2_over_E12","", n_bins100, -0.5,0.5);

  TH1F* h_380_CT_wO_recojet03_dphi_j1j2 =  new TH1F("h_380_CT_wO_recojet03_dphi_j1j2","", n_bins100, 0.5,TMath::Pi());
  TH1F* h_380_CT_wO_recojet03_E1_E2_over_E_True =  new TH1F("h_380_CT_wO_recojet03_E1_E2_over_E_True","", n_bins100, 0.5,1.00);
  TH1F* h_380_CT_wO_recojet03_Delta_E1_E2_over_E12 =  new TH1F("h_380_CT_wO_recojet03_Delta_E1_E2_over_E12","", n_bins100, -0.5,0.5);
  TH1F* h_380_CT_wO_recojet04_dphi_j1j2 =  new TH1F("h_380_CT_wO_recojet04_dphi_j1j2","", n_bins100, 0.5,TMath::Pi());
  TH1F* h_380_CT_wO_recojet04_E1_E2_over_E_True =  new TH1F("h_380_CT_wO_recojet04_E1_E2_over_E_True","", n_bins100, 0.5,1.00);
  TH1F* h_380_CT_wO_recojet04_Delta_E1_E2_over_E12 =  new TH1F("h_380_CT_wO_recojet04_Delta_E1_E2_over_E12","", n_bins100, -0.5,0.5);
  TH1F* h_380_CT_wO_recojet05_dphi_j1j2 =  new TH1F("h_380_CT_wO_recojet05_dphi_j1j2","", n_bins100, 0.5,TMath::Pi());
  TH1F* h_380_CT_wO_recojet05_E1_E2_over_E_True =  new TH1F("h_380_CT_wO_recojet05_E1_E2_over_E_True","", n_bins100, 0.5,1.00);
  TH1F* h_380_CT_wO_recojet05_Delta_E1_E2_over_E12 =  new TH1F("h_380_CT_wO_recojet05_Delta_E1_E2_over_E12","", n_bins100, -0.5,0.5);
  TH1F* h_380_CT_wO_recojet06_dphi_j1j2 =  new TH1F("h_380_CT_wO_recojet06_dphi_j1j2","", n_bins100, 0.5,TMath::Pi());
  TH1F* h_380_CT_wO_recojet06_E1_E2_over_E_True =  new TH1F("h_380_CT_wO_recojet06_E1_E2_over_E_True","", n_bins100, 0.5,1.00);
  TH1F* h_380_CT_wO_recojet06_Delta_E1_E2_over_E12 =  new TH1F("h_380_CT_wO_recojet06_Delta_E1_E2_over_E12","", n_bins100, -0.5,0.5);
  TH1F* h_380_CT_wO_recojet07_dphi_j1j2 =  new TH1F("h_380_CT_wO_recojet07_dphi_j1j2","", n_bins100, 0.5,TMath::Pi());
  TH1F* h_380_CT_wO_recojet07_E1_E2_over_E_True =  new TH1F("h_380_CT_wO_recojet07_E1_E2_over_E_True","", n_bins100, 0.5,1.00);
  TH1F* h_380_CT_wO_recojet07_Delta_E1_E2_over_E12 =  new TH1F("h_380_CT_wO_recojet07_Delta_E1_E2_over_E12","", n_bins100, -0.5,0.5);
  TH1F* h_380_CT_wO_recojet08_dphi_j1j2 =  new TH1F("h_380_CT_wO_recojet08_dphi_j1j2","", n_bins100, 0.5,TMath::Pi());
  TH1F* h_380_CT_wO_recojet08_E1_E2_over_E_True =  new TH1F("h_380_CT_wO_recojet08_E1_E2_over_E_True","", n_bins100, 0.5,1.00);
  TH1F* h_380_CT_wO_recojet08_Delta_E1_E2_over_E12 =  new TH1F("h_380_CT_wO_recojet08_Delta_E1_E2_over_E12","", n_bins100, -0.5,0.5);
  TH1F* h_380_CT_wO_recojet09_dphi_j1j2 =  new TH1F("h_380_CT_wO_recojet09_dphi_j1j2","", n_bins100, 0.5,TMath::Pi());
  TH1F* h_380_CT_wO_recojet09_E1_E2_over_E_True =  new TH1F("h_380_CT_wO_recojet09_E1_E2_over_E_True","", n_bins100, 0.5,1.00);
  TH1F* h_380_CT_wO_recojet09_Delta_E1_E2_over_E12 =  new TH1F("h_380_CT_wO_recojet09_Delta_E1_E2_over_E12","", n_bins100, -0.5,0.5);
  TH1F* h_380_CT_wO_recojet10_dphi_j1j2 =  new TH1F("h_380_CT_wO_recojet10_dphi_j1j2","", n_bins100, 0.5,TMath::Pi());
  TH1F* h_380_CT_wO_recojet10_E1_E2_over_E_True =  new TH1F("h_380_CT_wO_recojet10_E1_E2_over_E_True","", n_bins100, 0.5,1.00);
  TH1F* h_380_CT_wO_recojet10_Delta_E1_E2_over_E12 =  new TH1F("h_380_CT_wO_recojet10_Delta_E1_E2_over_E12","", n_bins100, -0.5,0.5);

  TH1F* h_380_CT_wO_recojetE_over_genjetE_DR03 =  new TH1F("h_380_CT_wO_recojetE_over_genjetE_DR03","", n_bins100, 0.5,1.5);
  TH1F* h_380_CT_wO_recojetE_over_genjetE_DR04 =  new TH1F("h_380_CT_wO_recojetE_over_genjetE_DR04","", n_bins100, 0.5,1.5);
  TH1F* h_380_CT_wO_recojetE_over_genjetE_DR05 =  new TH1F("h_380_CT_wO_recojetE_over_genjetE_DR05","", n_bins100, 0.5,1.5);
  TH1F* h_380_CT_wO_recojetE_over_genjetE_DR06 =  new TH1F("h_380_CT_wO_recojetE_over_genjetE_DR06","", n_bins100, 0.5,1.5);
  TH1F* h_380_CT_wO_recojetE_over_genjetE_DR07 =  new TH1F("h_380_CT_wO_recojetE_over_genjetE_DR07","", n_bins100, 0.5,1.5);
  TH1F* h_380_CT_wO_recojetE_over_genjetE_DR08 =  new TH1F("h_380_CT_wO_recojetE_over_genjetE_DR08","", n_bins100, 0.5,1.5);
  TH1F* h_380_CT_wO_recojetE_over_genjetE_DR09 =  new TH1F("h_380_CT_wO_recojetE_over_genjetE_DR09","", n_bins100, 0.5,1.5);
  TH1F* h_380_CT_wO_recojetE_over_genjetE_DR10 =  new TH1F("h_380_CT_wO_recojetE_over_genjetE_DR10","", n_bins100, 0.5,1.5);

  TH1F* h_380_CT_wO_dphi_gen_reco_DR05 =  new TH1F("h_380_CT_wO_dphi_gen_reco_DR05","", n_bins100, -0.1,9.9);
  TH1F* h_380_CT_wO_dphi_gen_reco_DR06 =  new TH1F("h_380_CT_wO_dphi_gen_reco_DR06","", n_bins100, -0.1,9.9);
  TH1F* h_380_CT_wO_dphi_gen_reco_DR07 =  new TH1F("h_380_CT_wO_dphi_gen_reco_DR07","", n_bins100, -0.1,9.9);

  TH1F* h_380_CT_wO_DR05_E_rel_totVis_RMS_d1_cosT_0_to_0_10 =  new TH1F("h_380_CT_wO_DR05_E_rel_totVis_RMS_d1_cosT_0_to_0_10","", n_binsJER, lim_E_rel_low,lim_E_rel_high);
  TH1F* h_380_CT_wO_DR05_E_rel_totVis_RMS_d1_cosT_0_10_to_0_20 =  new TH1F("h_380_CT_wO_DR05_E_rel_totVis_RMS_d1_cosT_0_10_to_0_20","", n_binsJER, lim_E_rel_low,lim_E_rel_high);
  TH1F* h_380_CT_wO_DR05_E_rel_totVis_RMS_d1_cosT_0_20_to_0_30 =  new TH1F("h_380_CT_wO_DR05_E_rel_totVis_RMS_d1_cosT_0_20_to_0_30","", n_binsJER, lim_E_rel_low,lim_E_rel_high);
  TH1F* h_380_CT_wO_DR05_E_rel_totVis_RMS_d1_cosT_0_30_to_0_40 =  new TH1F("h_380_CT_wO_DR05_E_rel_totVis_RMS_d1_cosT_0_30_to_0_40","", n_binsJER, lim_E_rel_low,lim_E_rel_high);
  TH1F* h_380_CT_wO_DR05_E_rel_totVis_RMS_d1_cosT_0_40_to_0_50 =  new TH1F("h_380_CT_wO_DR05_E_rel_totVis_RMS_d1_cosT_0_40_to_0_50","", n_binsJER, lim_E_rel_low,lim_E_rel_high);
  TH1F* h_380_CT_wO_DR05_E_rel_totVis_RMS_d1_cosT_0_50_to_0_60 =  new TH1F("h_380_CT_wO_DR05_E_rel_totVis_RMS_d1_cosT_0_50_to_0_60","", n_binsJER, lim_E_rel_low,lim_E_rel_high);
  TH1F* h_380_CT_wO_DR05_E_rel_totVis_RMS_d1_cosT_0_60_to_0_70 =  new TH1F("h_380_CT_wO_DR05_E_rel_totVis_RMS_d1_cosT_0_60_to_0_70","", n_binsJER, lim_E_rel_low,lim_E_rel_high);
  TH1F* h_380_CT_wO_DR05_E_rel_totVis_RMS_d1_cosT_0_70_to_0_80 =  new TH1F("h_380_CT_wO_DR05_E_rel_totVis_RMS_d1_cosT_0_70_to_0_80","", n_binsJER, lim_E_rel_low,lim_E_rel_high);
  TH1F* h_380_CT_wO_DR05_E_rel_totVis_RMS_d1_cosT_0_80_to_0_90 =  new TH1F("h_380_CT_wO_DR05_E_rel_totVis_RMS_d1_cosT_0_80_to_0_90","", n_binsJER, lim_E_rel_low,lim_E_rel_high);
  TH1F* h_380_CT_wO_DR05_E_rel_totVis_RMS_d1_cosT_0_900_to_0_925 =  new TH1F("h_380_CT_wO_DR05_E_rel_totVis_RMS_d1_cosT_0_900_to_0_925","", n_binsJER_FW, lim_E_rel_low,lim_E_rel_high);
  TH1F* h_380_CT_wO_DR05_E_rel_totVis_RMS_d1_cosT_0_925_to_0_950 =  new TH1F("h_380_CT_wO_DR05_E_rel_totVis_RMS_d1_cosT_0_925_to_0_950","", n_binsJER_FW, lim_E_rel_low,lim_E_rel_high);
  TH1F* h_380_CT_wO_DR05_E_rel_totVis_RMS_d1_cosT_0_950_to_0_975 =  new TH1F("h_380_CT_wO_DR05_E_rel_totVis_RMS_d1_cosT_0_950_to_0_975","", n_binsJER_FW, lim_E_rel_low,lim_E_rel_high);
  TH1F* h_380_CT_wO_DR05_E_rel_totVis_RMS_d1_cosT_0_975_to_1_00 =  new TH1F("h_380_CT_wO_DR05_E_rel_totVis_RMS_d1_cosT_0_975_to_1_00","", n_binsJER_FW, lim_E_rel_low,lim_E_rel_high);

  TH1F* h_380_CT_wO_DR06_E_rel_totVis_RMS_d1_cosT_0_to_0_10 =  new TH1F("h_380_CT_wO_DR06_E_rel_totVis_RMS_d1_cosT_0_to_0_10","", n_binsJER, lim_E_rel_low,lim_E_rel_high);
  TH1F* h_380_CT_wO_DR06_E_rel_totVis_RMS_d1_cosT_0_10_to_0_20 =  new TH1F("h_380_CT_wO_DR06_E_rel_totVis_RMS_d1_cosT_0_10_to_0_20","", n_binsJER, lim_E_rel_low,lim_E_rel_high);
  TH1F* h_380_CT_wO_DR06_E_rel_totVis_RMS_d1_cosT_0_20_to_0_30 =  new TH1F("h_380_CT_wO_DR06_E_rel_totVis_RMS_d1_cosT_0_20_to_0_30","", n_binsJER, lim_E_rel_low,lim_E_rel_high);
  TH1F* h_380_CT_wO_DR06_E_rel_totVis_RMS_d1_cosT_0_30_to_0_40 =  new TH1F("h_380_CT_wO_DR06_E_rel_totVis_RMS_d1_cosT_0_30_to_0_40","", n_binsJER, lim_E_rel_low,lim_E_rel_high);
  TH1F* h_380_CT_wO_DR06_E_rel_totVis_RMS_d1_cosT_0_40_to_0_50 =  new TH1F("h_380_CT_wO_DR06_E_rel_totVis_RMS_d1_cosT_0_40_to_0_50","", n_binsJER, lim_E_rel_low,lim_E_rel_high);
  TH1F* h_380_CT_wO_DR06_E_rel_totVis_RMS_d1_cosT_0_50_to_0_60 =  new TH1F("h_380_CT_wO_DR06_E_rel_totVis_RMS_d1_cosT_0_50_to_0_60","", n_binsJER, lim_E_rel_low,lim_E_rel_high);
  TH1F* h_380_CT_wO_DR06_E_rel_totVis_RMS_d1_cosT_0_60_to_0_70 =  new TH1F("h_380_CT_wO_DR06_E_rel_totVis_RMS_d1_cosT_0_60_to_0_70","", n_binsJER, lim_E_rel_low,lim_E_rel_high);
  TH1F* h_380_CT_wO_DR06_E_rel_totVis_RMS_d1_cosT_0_70_to_0_80 =  new TH1F("h_380_CT_wO_DR06_E_rel_totVis_RMS_d1_cosT_0_70_to_0_80","", n_binsJER, lim_E_rel_low,lim_E_rel_high);
  TH1F* h_380_CT_wO_DR06_E_rel_totVis_RMS_d1_cosT_0_80_to_0_90 =  new TH1F("h_380_CT_wO_DR06_E_rel_totVis_RMS_d1_cosT_0_80_to_0_90","", n_binsJER, lim_E_rel_low,lim_E_rel_high);
  TH1F* h_380_CT_wO_DR06_E_rel_totVis_RMS_d1_cosT_0_900_to_0_925 =  new TH1F("h_380_CT_wO_DR06_E_rel_totVis_RMS_d1_cosT_0_900_to_0_925","", n_binsJER_FW, lim_E_rel_low,lim_E_rel_high);
  TH1F* h_380_CT_wO_DR06_E_rel_totVis_RMS_d1_cosT_0_925_to_0_950 =  new TH1F("h_380_CT_wO_DR06_E_rel_totVis_RMS_d1_cosT_0_925_to_0_950","", n_binsJER_FW, lim_E_rel_low,lim_E_rel_high);
  TH1F* h_380_CT_wO_DR06_E_rel_totVis_RMS_d1_cosT_0_950_to_0_975 =  new TH1F("h_380_CT_wO_DR06_E_rel_totVis_RMS_d1_cosT_0_950_to_0_975","", n_binsJER_FW, lim_E_rel_low,lim_E_rel_high);
  TH1F* h_380_CT_wO_DR06_E_rel_totVis_RMS_d1_cosT_0_975_to_1_00 =  new TH1F("h_380_CT_wO_DR06_E_rel_totVis_RMS_d1_cosT_0_975_to_1_00","", n_binsJER_FW, lim_E_rel_low,lim_E_rel_high);

  TH1F* h_380_CT_wO_DR07_E_rel_totVis_RMS_d1_cosT_0_to_0_10 =  new TH1F("h_380_CT_wO_DR07_E_rel_totVis_RMS_d1_cosT_0_to_0_10","", n_binsJER, lim_E_rel_low,lim_E_rel_high);
  TH1F* h_380_CT_wO_DR07_E_rel_totVis_RMS_d1_cosT_0_10_to_0_20 =  new TH1F("h_380_CT_wO_DR07_E_rel_totVis_RMS_d1_cosT_0_10_to_0_20","", n_binsJER, lim_E_rel_low,lim_E_rel_high);
  TH1F* h_380_CT_wO_DR07_E_rel_totVis_RMS_d1_cosT_0_20_to_0_30 =  new TH1F("h_380_CT_wO_DR07_E_rel_totVis_RMS_d1_cosT_0_20_to_0_30","", n_binsJER, lim_E_rel_low,lim_E_rel_high);
  TH1F* h_380_CT_wO_DR07_E_rel_totVis_RMS_d1_cosT_0_30_to_0_40 =  new TH1F("h_380_CT_wO_DR07_E_rel_totVis_RMS_d1_cosT_0_30_to_0_40","", n_binsJER, lim_E_rel_low,lim_E_rel_high);
  TH1F* h_380_CT_wO_DR07_E_rel_totVis_RMS_d1_cosT_0_40_to_0_50 =  new TH1F("h_380_CT_wO_DR07_E_rel_totVis_RMS_d1_cosT_0_40_to_0_50","", n_binsJER, lim_E_rel_low,lim_E_rel_high);
  TH1F* h_380_CT_wO_DR07_E_rel_totVis_RMS_d1_cosT_0_50_to_0_60 =  new TH1F("h_380_CT_wO_DR07_E_rel_totVis_RMS_d1_cosT_0_50_to_0_60","", n_binsJER, lim_E_rel_low,lim_E_rel_high);
  TH1F* h_380_CT_wO_DR07_E_rel_totVis_RMS_d1_cosT_0_60_to_0_70 =  new TH1F("h_380_CT_wO_DR07_E_rel_totVis_RMS_d1_cosT_0_60_to_0_70","", n_binsJER, lim_E_rel_low,lim_E_rel_high);
  TH1F* h_380_CT_wO_DR07_E_rel_totVis_RMS_d1_cosT_0_70_to_0_80 =  new TH1F("h_380_CT_wO_DR07_E_rel_totVis_RMS_d1_cosT_0_70_to_0_80","", n_binsJER, lim_E_rel_low,lim_E_rel_high);
  TH1F* h_380_CT_wO_DR07_E_rel_totVis_RMS_d1_cosT_0_80_to_0_90 =  new TH1F("h_380_CT_wO_DR07_E_rel_totVis_RMS_d1_cosT_0_80_to_0_90","", n_binsJER, lim_E_rel_low,lim_E_rel_high);
  TH1F* h_380_CT_wO_DR07_E_rel_totVis_RMS_d1_cosT_0_900_to_0_925 =  new TH1F("h_380_CT_wO_DR07_E_rel_totVis_RMS_d1_cosT_0_900_to_0_925","", n_binsJER_FW, lim_E_rel_low,lim_E_rel_high);
  TH1F* h_380_CT_wO_DR07_E_rel_totVis_RMS_d1_cosT_0_925_to_0_950 =  new TH1F("h_380_CT_wO_DR07_E_rel_totVis_RMS_d1_cosT_0_925_to_0_950","", n_binsJER_FW, lim_E_rel_low,lim_E_rel_high);
  TH1F* h_380_CT_wO_DR07_E_rel_totVis_RMS_d1_cosT_0_950_to_0_975 =  new TH1F("h_380_CT_wO_DR07_E_rel_totVis_RMS_d1_cosT_0_950_to_0_975","", n_binsJER_FW, lim_E_rel_low,lim_E_rel_high);
  TH1F* h_380_CT_wO_DR07_E_rel_totVis_RMS_d1_cosT_0_975_to_1_00 =  new TH1F("h_380_CT_wO_DR07_E_rel_totVis_RMS_d1_cosT_0_975_to_1_00","", n_binsJER_FW, lim_E_rel_low,lim_E_rel_high);

  TH1F* h_380_CT_wO_DR08_E_rel_totVis_RMS_d1_cosT_0_to_0_10 =  new TH1F("h_380_CT_wO_DR08_E_rel_totVis_RMS_d1_cosT_0_to_0_10","", n_binsJER, lim_E_rel_low,lim_E_rel_high);
  TH1F* h_380_CT_wO_DR08_E_rel_totVis_RMS_d1_cosT_0_10_to_0_20 =  new TH1F("h_380_CT_wO_DR08_E_rel_totVis_RMS_d1_cosT_0_10_to_0_20","", n_binsJER, lim_E_rel_low,lim_E_rel_high);
  TH1F* h_380_CT_wO_DR08_E_rel_totVis_RMS_d1_cosT_0_20_to_0_30 =  new TH1F("h_380_CT_wO_DR08_E_rel_totVis_RMS_d1_cosT_0_20_to_0_30","", n_binsJER, lim_E_rel_low,lim_E_rel_high);
  TH1F* h_380_CT_wO_DR08_E_rel_totVis_RMS_d1_cosT_0_30_to_0_40 =  new TH1F("h_380_CT_wO_DR08_E_rel_totVis_RMS_d1_cosT_0_30_to_0_40","", n_binsJER, lim_E_rel_low,lim_E_rel_high);
  TH1F* h_380_CT_wO_DR08_E_rel_totVis_RMS_d1_cosT_0_40_to_0_50 =  new TH1F("h_380_CT_wO_DR08_E_rel_totVis_RMS_d1_cosT_0_40_to_0_50","", n_binsJER, lim_E_rel_low,lim_E_rel_high);
  TH1F* h_380_CT_wO_DR08_E_rel_totVis_RMS_d1_cosT_0_50_to_0_60 =  new TH1F("h_380_CT_wO_DR08_E_rel_totVis_RMS_d1_cosT_0_50_to_0_60","", n_binsJER, lim_E_rel_low,lim_E_rel_high);
  TH1F* h_380_CT_wO_DR08_E_rel_totVis_RMS_d1_cosT_0_60_to_0_70 =  new TH1F("h_380_CT_wO_DR08_E_rel_totVis_RMS_d1_cosT_0_60_to_0_70","", n_binsJER, lim_E_rel_low,lim_E_rel_high);
  TH1F* h_380_CT_wO_DR08_E_rel_totVis_RMS_d1_cosT_0_70_to_0_80 =  new TH1F("h_380_CT_wO_DR08_E_rel_totVis_RMS_d1_cosT_0_70_to_0_80","", n_binsJER, lim_E_rel_low,lim_E_rel_high);
  TH1F* h_380_CT_wO_DR08_E_rel_totVis_RMS_d1_cosT_0_80_to_0_90 =  new TH1F("h_380_CT_wO_DR08_E_rel_totVis_RMS_d1_cosT_0_80_to_0_90","", n_binsJER, lim_E_rel_low,lim_E_rel_high);
  TH1F* h_380_CT_wO_DR08_E_rel_totVis_RMS_d1_cosT_0_900_to_0_925 =  new TH1F("h_380_CT_wO_DR08_E_rel_totVis_RMS_d1_cosT_0_900_to_0_925","", n_binsJER_FW, lim_E_rel_low,lim_E_rel_high);
  TH1F* h_380_CT_wO_DR08_E_rel_totVis_RMS_d1_cosT_0_925_to_0_950 =  new TH1F("h_380_CT_wO_DR08_E_rel_totVis_RMS_d1_cosT_0_925_to_0_950","", n_binsJER_FW, lim_E_rel_low,lim_E_rel_high);
  TH1F* h_380_CT_wO_DR08_E_rel_totVis_RMS_d1_cosT_0_950_to_0_975 =  new TH1F("h_380_CT_wO_DR08_E_rel_totVis_RMS_d1_cosT_0_950_to_0_975","", n_binsJER_FW, lim_E_rel_low,lim_E_rel_high);
  TH1F* h_380_CT_wO_DR08_E_rel_totVis_RMS_d1_cosT_0_975_to_1_00 =  new TH1F("h_380_CT_wO_DR08_E_rel_totVis_RMS_d1_cosT_0_975_to_1_00","", n_binsJER_FW, lim_E_rel_low,lim_E_rel_high);

  TH1F* h_380_CT_wO_DR09_E_rel_totVis_RMS_d1_cosT_0_to_0_10 =  new TH1F("h_380_CT_wO_DR09_E_rel_totVis_RMS_d1_cosT_0_to_0_10","", n_binsJER, lim_E_rel_low,lim_E_rel_high);
  TH1F* h_380_CT_wO_DR09_E_rel_totVis_RMS_d1_cosT_0_10_to_0_20 =  new TH1F("h_380_CT_wO_DR09_E_rel_totVis_RMS_d1_cosT_0_10_to_0_20","", n_binsJER, lim_E_rel_low,lim_E_rel_high);
  TH1F* h_380_CT_wO_DR09_E_rel_totVis_RMS_d1_cosT_0_20_to_0_30 =  new TH1F("h_380_CT_wO_DR09_E_rel_totVis_RMS_d1_cosT_0_20_to_0_30","", n_binsJER, lim_E_rel_low,lim_E_rel_high);
  TH1F* h_380_CT_wO_DR09_E_rel_totVis_RMS_d1_cosT_0_30_to_0_40 =  new TH1F("h_380_CT_wO_DR09_E_rel_totVis_RMS_d1_cosT_0_30_to_0_40","", n_binsJER, lim_E_rel_low,lim_E_rel_high);
  TH1F* h_380_CT_wO_DR09_E_rel_totVis_RMS_d1_cosT_0_40_to_0_50 =  new TH1F("h_380_CT_wO_DR09_E_rel_totVis_RMS_d1_cosT_0_40_to_0_50","", n_binsJER, lim_E_rel_low,lim_E_rel_high);
  TH1F* h_380_CT_wO_DR09_E_rel_totVis_RMS_d1_cosT_0_50_to_0_60 =  new TH1F("h_380_CT_wO_DR09_E_rel_totVis_RMS_d1_cosT_0_50_to_0_60","", n_binsJER, lim_E_rel_low,lim_E_rel_high);
  TH1F* h_380_CT_wO_DR09_E_rel_totVis_RMS_d1_cosT_0_60_to_0_70 =  new TH1F("h_380_CT_wO_DR09_E_rel_totVis_RMS_d1_cosT_0_60_to_0_70","", n_binsJER, lim_E_rel_low,lim_E_rel_high);
  TH1F* h_380_CT_wO_DR09_E_rel_totVis_RMS_d1_cosT_0_70_to_0_80 =  new TH1F("h_380_CT_wO_DR09_E_rel_totVis_RMS_d1_cosT_0_70_to_0_80","", n_binsJER, lim_E_rel_low,lim_E_rel_high);
  TH1F* h_380_CT_wO_DR09_E_rel_totVis_RMS_d1_cosT_0_80_to_0_90 =  new TH1F("h_380_CT_wO_DR09_E_rel_totVis_RMS_d1_cosT_0_80_to_0_90","", n_binsJER, lim_E_rel_low,lim_E_rel_high);
  TH1F* h_380_CT_wO_DR09_E_rel_totVis_RMS_d1_cosT_0_900_to_0_925 =  new TH1F("h_380_CT_wO_DR09_E_rel_totVis_RMS_d1_cosT_0_900_to_0_925","", n_binsJER_FW, lim_E_rel_low,lim_E_rel_high);
  TH1F* h_380_CT_wO_DR09_E_rel_totVis_RMS_d1_cosT_0_925_to_0_950 =  new TH1F("h_380_CT_wO_DR09_E_rel_totVis_RMS_d1_cosT_0_925_to_0_950","", n_binsJER_FW, lim_E_rel_low,lim_E_rel_high);
  TH1F* h_380_CT_wO_DR09_E_rel_totVis_RMS_d1_cosT_0_950_to_0_975 =  new TH1F("h_380_CT_wO_DR09_E_rel_totVis_RMS_d1_cosT_0_950_to_0_975","", n_binsJER_FW, lim_E_rel_low,lim_E_rel_high);
  TH1F* h_380_CT_wO_DR09_E_rel_totVis_RMS_d1_cosT_0_975_to_1_00 =  new TH1F("h_380_CT_wO_DR09_E_rel_totVis_RMS_d1_cosT_0_975_to_1_00","", n_binsJER_FW, lim_E_rel_low,lim_E_rel_high);

  TH1F* h_380_CT_wO_DR10_E_rel_totVis_RMS_d1_cosT_0_to_0_10 =  new TH1F("h_380_CT_wO_DR10_E_rel_totVis_RMS_d1_cosT_0_to_0_10","", n_binsJER, lim_E_rel_low,lim_E_rel_high);
  TH1F* h_380_CT_wO_DR10_E_rel_totVis_RMS_d1_cosT_0_10_to_0_20 =  new TH1F("h_380_CT_wO_DR10_E_rel_totVis_RMS_d1_cosT_0_10_to_0_20","", n_binsJER, lim_E_rel_low,lim_E_rel_high);
  TH1F* h_380_CT_wO_DR10_E_rel_totVis_RMS_d1_cosT_0_20_to_0_30 =  new TH1F("h_380_CT_wO_DR10_E_rel_totVis_RMS_d1_cosT_0_20_to_0_30","", n_binsJER, lim_E_rel_low,lim_E_rel_high);
  TH1F* h_380_CT_wO_DR10_E_rel_totVis_RMS_d1_cosT_0_30_to_0_40 =  new TH1F("h_380_CT_wO_DR10_E_rel_totVis_RMS_d1_cosT_0_30_to_0_40","", n_binsJER, lim_E_rel_low,lim_E_rel_high);
  TH1F* h_380_CT_wO_DR10_E_rel_totVis_RMS_d1_cosT_0_40_to_0_50 =  new TH1F("h_380_CT_wO_DR10_E_rel_totVis_RMS_d1_cosT_0_40_to_0_50","", n_binsJER, lim_E_rel_low,lim_E_rel_high);
  TH1F* h_380_CT_wO_DR10_E_rel_totVis_RMS_d1_cosT_0_50_to_0_60 =  new TH1F("h_380_CT_wO_DR10_E_rel_totVis_RMS_d1_cosT_0_50_to_0_60","", n_binsJER, lim_E_rel_low,lim_E_rel_high);
  TH1F* h_380_CT_wO_DR10_E_rel_totVis_RMS_d1_cosT_0_60_to_0_70 =  new TH1F("h_380_CT_wO_DR10_E_rel_totVis_RMS_d1_cosT_0_60_to_0_70","", n_binsJER, lim_E_rel_low,lim_E_rel_high);
  TH1F* h_380_CT_wO_DR10_E_rel_totVis_RMS_d1_cosT_0_70_to_0_80 =  new TH1F("h_380_CT_wO_DR10_E_rel_totVis_RMS_d1_cosT_0_70_to_0_80","", n_binsJER, lim_E_rel_low,lim_E_rel_high);
  TH1F* h_380_CT_wO_DR10_E_rel_totVis_RMS_d1_cosT_0_80_to_0_90 =  new TH1F("h_380_CT_wO_DR10_E_rel_totVis_RMS_d1_cosT_0_80_to_0_90","", n_binsJER, lim_E_rel_low,lim_E_rel_high);
  TH1F* h_380_CT_wO_DR10_E_rel_totVis_RMS_d1_cosT_0_900_to_0_925 =  new TH1F("h_380_CT_wO_DR10_E_rel_totVis_RMS_d1_cosT_0_900_to_0_925","", n_binsJER_FW, lim_E_rel_low,lim_E_rel_high);
  TH1F* h_380_CT_wO_DR10_E_rel_totVis_RMS_d1_cosT_0_925_to_0_950 =  new TH1F("h_380_CT_wO_DR10_E_rel_totVis_RMS_d1_cosT_0_925_to_0_950","", n_binsJER_FW, lim_E_rel_low,lim_E_rel_high);
  TH1F* h_380_CT_wO_DR10_E_rel_totVis_RMS_d1_cosT_0_950_to_0_975 =  new TH1F("h_380_CT_wO_DR10_E_rel_totVis_RMS_d1_cosT_0_950_to_0_975","", n_binsJER_FW, lim_E_rel_low,lim_E_rel_high);
  TH1F* h_380_CT_wO_DR10_E_rel_totVis_RMS_d1_cosT_0_975_to_1_00 =  new TH1F("h_380_CT_wO_DR10_E_rel_totVis_RMS_d1_cosT_0_975_to_1_00","", n_binsJER_FW, lim_E_rel_low,lim_E_rel_high);

  TH1F* h_380_CT_wO_DR05_dphi_reco_gen_cosTheta_0_65 =  new TH1F("h_380_CT_wO_DR05_dphi_reco_gen_cosTheta_0_65","", n_bins100, -lim_angleDeg,lim_angleDeg);
  TH1F* h_380_CT_wO_DR05_dtheta_reco_gen_cosTheta_0_65 =  new TH1F("h_380_CT_wO_DR05_dtheta_reco_gen_cosTheta_0_65","", n_bins100, -lim_angleDeg,lim_angleDeg);
  TH1F* h_380_CT_wO_DR05_dphi_reco_gen_cosTheta_0_65_to_0_80 =  new TH1F("h_380_CT_wO_DR05_dphi_reco_gen_cosTheta_0_65_to_0_80","", n_bins100, -lim_angleDeg,lim_angleDeg);
  TH1F* h_380_CT_wO_DR05_dtheta_reco_gen_cosTheta_0_65_to_0_80 =  new TH1F("h_380_CT_wO_DR05_dtheta_reco_gen_cosTheta_0_65_to_0_80","", n_bins100, -lim_angleDeg,lim_angleDeg);
  TH1F* h_380_CT_wO_DR05_dphi_reco_gen_cosTheta_0_80_to_0_925 =  new TH1F("h_380_CT_wO_DR05_dphi_reco_gen_cosTheta_0_80_to_0_925","", n_bins100, -lim_angleDeg,lim_angleDeg);
  TH1F* h_380_CT_wO_DR05_dtheta_reco_gen_cosTheta_0_80_to_0_925 =  new TH1F("h_380_CT_wO_DR05_dtheta_reco_gen_cosTheta_0_80_to_0_925","", n_bins100, -lim_angleDeg,lim_angleDeg);
  TH1F* h_380_CT_wO_DR05_dphi_reco_gen_cosTheta_0_925_to_0_975 =  new TH1F("h_380_CT_wO_DR05_dphi_reco_gen_cosTheta_0_925_to_0_975","", n_bins100, -lim_angleDeg,lim_angleDeg);
  TH1F* h_380_CT_wO_DR05_dtheta_reco_gen_cosTheta_0_925_to_0_975 =  new TH1F("h_380_CT_wO_DR05_dtheta_reco_gen_cosTheta_0_925_to_0_975","", n_bins100, -lim_angleDeg,lim_angleDeg);

  TH1F* h_380_CT_wO_DR07_dphi_reco_gen_cosTheta_0_65 =  new TH1F("h_380_CT_wO_DR07_dphi_reco_gen_cosTheta_0_65","", n_bins100, -lim_angleDeg,lim_angleDeg);
  TH1F* h_380_CT_wO_DR07_dtheta_reco_gen_cosTheta_0_65 =  new TH1F("h_380_CT_wO_DR07_dtheta_reco_gen_cosTheta_0_65","", n_bins100, -lim_angleDeg,lim_angleDeg);
  TH1F* h_380_CT_wO_DR07_dphi_reco_gen_cosTheta_0_65_to_0_80 =  new TH1F("h_380_CT_wO_DR07_dphi_reco_gen_cosTheta_0_65_to_0_80","", n_bins100, -lim_angleDeg,lim_angleDeg);
  TH1F* h_380_CT_wO_DR07_dtheta_reco_gen_cosTheta_0_65_to_0_80 =  new TH1F("h_380_CT_wO_DR07_dtheta_reco_gen_cosTheta_0_65_to_0_80","", n_bins100, -lim_angleDeg,lim_angleDeg);
  TH1F* h_380_CT_wO_DR07_dphi_reco_gen_cosTheta_0_80_to_0_925 =  new TH1F("h_380_CT_wO_DR07_dphi_reco_gen_cosTheta_0_80_to_0_925","", n_bins100, -lim_angleDeg,lim_angleDeg);
  TH1F* h_380_CT_wO_DR07_dtheta_reco_gen_cosTheta_0_80_to_0_925 =  new TH1F("h_380_CT_wO_DR07_dtheta_reco_gen_cosTheta_0_80_to_0_925","", n_bins100, -lim_angleDeg,lim_angleDeg);
  TH1F* h_380_CT_wO_DR07_dphi_reco_gen_cosTheta_0_925_to_0_975 =  new TH1F("h_380_CT_wO_DR07_dphi_reco_gen_cosTheta_0_925_to_0_975","", n_bins100, -lim_angleDeg,lim_angleDeg);
  TH1F* h_380_CT_wO_DR07_dtheta_reco_gen_cosTheta_0_925_to_0_975 =  new TH1F("h_380_CT_wO_DR07_dtheta_reco_gen_cosTheta_0_925_to_0_975","", n_bins100, -lim_angleDeg,lim_angleDeg);

  TH1F* h_380_CT_wO_DR10_dphi_reco_gen_cosTheta_0_65 =  new TH1F("h_380_CT_wO_DR10_dphi_reco_gen_cosTheta_0_65","", n_bins100, -lim_angleDeg,lim_angleDeg);
  TH1F* h_380_CT_wO_DR10_dtheta_reco_gen_cosTheta_0_65 =  new TH1F("h_380_CT_wO_DR10_dtheta_reco_gen_cosTheta_0_65","", n_bins100, -lim_angleDeg,lim_angleDeg);
  TH1F* h_380_CT_wO_DR10_dphi_reco_gen_cosTheta_0_65_to_0_80 =  new TH1F("h_380_CT_wO_DR10_dphi_reco_gen_cosTheta_0_65_to_0_80","", n_bins100, -lim_angleDeg,lim_angleDeg);
  TH1F* h_380_CT_wO_DR10_dtheta_reco_gen_cosTheta_0_65_to_0_80 =  new TH1F("h_380_CT_wO_DR10_dtheta_reco_gen_cosTheta_0_65_to_0_80","", n_bins100, -lim_angleDeg,lim_angleDeg);
  TH1F* h_380_CT_wO_DR10_dphi_reco_gen_cosTheta_0_80_to_0_925 =  new TH1F("h_380_CT_wO_DR10_dphi_reco_gen_cosTheta_0_80_to_0_925","", n_bins100, -lim_angleDeg,lim_angleDeg);
  TH1F* h_380_CT_wO_DR10_dtheta_reco_gen_cosTheta_0_80_to_0_925 =  new TH1F("h_380_CT_wO_DR10_dtheta_reco_gen_cosTheta_0_80_to_0_925","", n_bins100, -lim_angleDeg,lim_angleDeg);
  TH1F* h_380_CT_wO_DR10_dphi_reco_gen_cosTheta_0_925_to_0_975 =  new TH1F("h_380_CT_wO_DR10_dphi_reco_gen_cosTheta_0_925_to_0_975","", n_bins100, -lim_angleDeg,lim_angleDeg);
  TH1F* h_380_CT_wO_DR10_dtheta_reco_gen_cosTheta_0_925_to_0_975 =  new TH1F("h_380_CT_wO_DR10_dtheta_reco_gen_cosTheta_0_925_to_0_975","", n_bins100, -lim_angleDeg,lim_angleDeg);

  std::vector<TH1F*> hist_vec_380_CT_wO;
  hist_vec_380_CT_wO.push_back(h_380_CT_wO_genjet03_dphi_j1j2);
  hist_vec_380_CT_wO.push_back(h_380_CT_wO_genjet03_E1_E2_over_E_True);
  hist_vec_380_CT_wO.push_back(h_380_CT_wO_genjet03_Delta_E1_E2_over_E12);
  hist_vec_380_CT_wO.push_back(h_380_CT_wO_genjet04_dphi_j1j2);
  hist_vec_380_CT_wO.push_back(h_380_CT_wO_genjet04_E1_E2_over_E_True);
  hist_vec_380_CT_wO.push_back(h_380_CT_wO_genjet04_Delta_E1_E2_over_E12);
  hist_vec_380_CT_wO.push_back(h_380_CT_wO_genjet05_dphi_j1j2);
  hist_vec_380_CT_wO.push_back(h_380_CT_wO_genjet05_E1_E2_over_E_True);
  hist_vec_380_CT_wO.push_back(h_380_CT_wO_genjet05_Delta_E1_E2_over_E12);
  hist_vec_380_CT_wO.push_back(h_380_CT_wO_genjet06_dphi_j1j2);
  hist_vec_380_CT_wO.push_back(h_380_CT_wO_genjet06_E1_E2_over_E_True);
  hist_vec_380_CT_wO.push_back(h_380_CT_wO_genjet06_Delta_E1_E2_over_E12);
  hist_vec_380_CT_wO.push_back(h_380_CT_wO_genjet07_dphi_j1j2);
  hist_vec_380_CT_wO.push_back(h_380_CT_wO_genjet07_E1_E2_over_E_True);
  hist_vec_380_CT_wO.push_back(h_380_CT_wO_genjet07_Delta_E1_E2_over_E12);
  hist_vec_380_CT_wO.push_back(h_380_CT_wO_genjet08_dphi_j1j2);
  hist_vec_380_CT_wO.push_back(h_380_CT_wO_genjet08_E1_E2_over_E_True);
  hist_vec_380_CT_wO.push_back(h_380_CT_wO_genjet08_Delta_E1_E2_over_E12);
  hist_vec_380_CT_wO.push_back(h_380_CT_wO_genjet09_dphi_j1j2);
  hist_vec_380_CT_wO.push_back(h_380_CT_wO_genjet09_E1_E2_over_E_True);
  hist_vec_380_CT_wO.push_back(h_380_CT_wO_genjet09_Delta_E1_E2_over_E12);
  hist_vec_380_CT_wO.push_back(h_380_CT_wO_genjet10_dphi_j1j2);
  hist_vec_380_CT_wO.push_back(h_380_CT_wO_genjet10_E1_E2_over_E_True);
  hist_vec_380_CT_wO.push_back(h_380_CT_wO_genjet10_Delta_E1_E2_over_E12);

  hist_vec_380_CT_wO.push_back(h_380_CT_wO_recojet03_dphi_j1j2);
  hist_vec_380_CT_wO.push_back(h_380_CT_wO_recojet03_E1_E2_over_E_True);
  hist_vec_380_CT_wO.push_back(h_380_CT_wO_recojet03_Delta_E1_E2_over_E12);
  hist_vec_380_CT_wO.push_back(h_380_CT_wO_recojet04_dphi_j1j2);
  hist_vec_380_CT_wO.push_back(h_380_CT_wO_recojet04_E1_E2_over_E_True);
  hist_vec_380_CT_wO.push_back(h_380_CT_wO_recojet04_Delta_E1_E2_over_E12);
  hist_vec_380_CT_wO.push_back(h_380_CT_wO_recojet05_dphi_j1j2);
  hist_vec_380_CT_wO.push_back(h_380_CT_wO_recojet05_E1_E2_over_E_True);
  hist_vec_380_CT_wO.push_back(h_380_CT_wO_recojet05_Delta_E1_E2_over_E12);
  hist_vec_380_CT_wO.push_back(h_380_CT_wO_recojet06_dphi_j1j2);
  hist_vec_380_CT_wO.push_back(h_380_CT_wO_recojet06_E1_E2_over_E_True);
  hist_vec_380_CT_wO.push_back(h_380_CT_wO_recojet06_Delta_E1_E2_over_E12);
  hist_vec_380_CT_wO.push_back(h_380_CT_wO_recojet07_dphi_j1j2);
  hist_vec_380_CT_wO.push_back(h_380_CT_wO_recojet07_E1_E2_over_E_True);
  hist_vec_380_CT_wO.push_back(h_380_CT_wO_recojet07_Delta_E1_E2_over_E12);
  hist_vec_380_CT_wO.push_back(h_380_CT_wO_recojet08_dphi_j1j2);
  hist_vec_380_CT_wO.push_back(h_380_CT_wO_recojet08_E1_E2_over_E_True);
  hist_vec_380_CT_wO.push_back(h_380_CT_wO_recojet08_Delta_E1_E2_over_E12);
  hist_vec_380_CT_wO.push_back(h_380_CT_wO_recojet09_dphi_j1j2);
  hist_vec_380_CT_wO.push_back(h_380_CT_wO_recojet09_E1_E2_over_E_True);
  hist_vec_380_CT_wO.push_back(h_380_CT_wO_recojet09_Delta_E1_E2_over_E12);
  hist_vec_380_CT_wO.push_back(h_380_CT_wO_recojet10_dphi_j1j2);
  hist_vec_380_CT_wO.push_back(h_380_CT_wO_recojet10_E1_E2_over_E_True);
  hist_vec_380_CT_wO.push_back(h_380_CT_wO_recojet10_Delta_E1_E2_over_E12);

  hist_vec_380_CT_wO.push_back(h_380_CT_wO_recojetE_over_genjetE_DR03);
  hist_vec_380_CT_wO.push_back(h_380_CT_wO_recojetE_over_genjetE_DR04);
  hist_vec_380_CT_wO.push_back(h_380_CT_wO_recojetE_over_genjetE_DR05);
  hist_vec_380_CT_wO.push_back(h_380_CT_wO_recojetE_over_genjetE_DR06);
  hist_vec_380_CT_wO.push_back(h_380_CT_wO_recojetE_over_genjetE_DR07);
  hist_vec_380_CT_wO.push_back(h_380_CT_wO_recojetE_over_genjetE_DR08);
  hist_vec_380_CT_wO.push_back(h_380_CT_wO_recojetE_over_genjetE_DR09);
  hist_vec_380_CT_wO.push_back(h_380_CT_wO_recojetE_over_genjetE_DR10);

  hist_vec_380_CT_wO.push_back(h_380_CT_wO_dphi_gen_reco_DR05);
  hist_vec_380_CT_wO.push_back(h_380_CT_wO_dphi_gen_reco_DR06);
  hist_vec_380_CT_wO.push_back(h_380_CT_wO_dphi_gen_reco_DR07);

  hist_vec_380_CT_wO.push_back(h_380_CT_wO_DR05_E_rel_totVis_RMS_d1_cosT_0_to_0_10);
  hist_vec_380_CT_wO.push_back(h_380_CT_wO_DR05_E_rel_totVis_RMS_d1_cosT_0_10_to_0_20);
  hist_vec_380_CT_wO.push_back(h_380_CT_wO_DR05_E_rel_totVis_RMS_d1_cosT_0_20_to_0_30);
  hist_vec_380_CT_wO.push_back(h_380_CT_wO_DR05_E_rel_totVis_RMS_d1_cosT_0_30_to_0_40);
  hist_vec_380_CT_wO.push_back(h_380_CT_wO_DR05_E_rel_totVis_RMS_d1_cosT_0_40_to_0_50);
  hist_vec_380_CT_wO.push_back(h_380_CT_wO_DR05_E_rel_totVis_RMS_d1_cosT_0_50_to_0_60);
  hist_vec_380_CT_wO.push_back(h_380_CT_wO_DR05_E_rel_totVis_RMS_d1_cosT_0_60_to_0_70);
  hist_vec_380_CT_wO.push_back(h_380_CT_wO_DR05_E_rel_totVis_RMS_d1_cosT_0_70_to_0_80);
  hist_vec_380_CT_wO.push_back(h_380_CT_wO_DR05_E_rel_totVis_RMS_d1_cosT_0_80_to_0_90);
  hist_vec_380_CT_wO.push_back(h_380_CT_wO_DR05_E_rel_totVis_RMS_d1_cosT_0_900_to_0_925);
  hist_vec_380_CT_wO.push_back(h_380_CT_wO_DR05_E_rel_totVis_RMS_d1_cosT_0_925_to_0_950);
  hist_vec_380_CT_wO.push_back(h_380_CT_wO_DR05_E_rel_totVis_RMS_d1_cosT_0_950_to_0_975);
  hist_vec_380_CT_wO.push_back(h_380_CT_wO_DR05_E_rel_totVis_RMS_d1_cosT_0_975_to_1_00);

  hist_vec_380_CT_wO.push_back(h_380_CT_wO_DR06_E_rel_totVis_RMS_d1_cosT_0_to_0_10);
  hist_vec_380_CT_wO.push_back(h_380_CT_wO_DR06_E_rel_totVis_RMS_d1_cosT_0_10_to_0_20);
  hist_vec_380_CT_wO.push_back(h_380_CT_wO_DR06_E_rel_totVis_RMS_d1_cosT_0_20_to_0_30);
  hist_vec_380_CT_wO.push_back(h_380_CT_wO_DR06_E_rel_totVis_RMS_d1_cosT_0_30_to_0_40);
  hist_vec_380_CT_wO.push_back(h_380_CT_wO_DR06_E_rel_totVis_RMS_d1_cosT_0_40_to_0_50);
  hist_vec_380_CT_wO.push_back(h_380_CT_wO_DR06_E_rel_totVis_RMS_d1_cosT_0_50_to_0_60);
  hist_vec_380_CT_wO.push_back(h_380_CT_wO_DR06_E_rel_totVis_RMS_d1_cosT_0_60_to_0_70);
  hist_vec_380_CT_wO.push_back(h_380_CT_wO_DR06_E_rel_totVis_RMS_d1_cosT_0_70_to_0_80);
  hist_vec_380_CT_wO.push_back(h_380_CT_wO_DR06_E_rel_totVis_RMS_d1_cosT_0_80_to_0_90);
  hist_vec_380_CT_wO.push_back(h_380_CT_wO_DR06_E_rel_totVis_RMS_d1_cosT_0_900_to_0_925);
  hist_vec_380_CT_wO.push_back(h_380_CT_wO_DR06_E_rel_totVis_RMS_d1_cosT_0_925_to_0_950);
  hist_vec_380_CT_wO.push_back(h_380_CT_wO_DR06_E_rel_totVis_RMS_d1_cosT_0_950_to_0_975);
  hist_vec_380_CT_wO.push_back(h_380_CT_wO_DR06_E_rel_totVis_RMS_d1_cosT_0_975_to_1_00); 

  hist_vec_380_CT_wO.push_back(h_380_CT_wO_DR07_E_rel_totVis_RMS_d1_cosT_0_to_0_10);
  hist_vec_380_CT_wO.push_back(h_380_CT_wO_DR07_E_rel_totVis_RMS_d1_cosT_0_10_to_0_20);
  hist_vec_380_CT_wO.push_back(h_380_CT_wO_DR07_E_rel_totVis_RMS_d1_cosT_0_20_to_0_30);
  hist_vec_380_CT_wO.push_back(h_380_CT_wO_DR07_E_rel_totVis_RMS_d1_cosT_0_30_to_0_40);
  hist_vec_380_CT_wO.push_back(h_380_CT_wO_DR07_E_rel_totVis_RMS_d1_cosT_0_40_to_0_50);
  hist_vec_380_CT_wO.push_back(h_380_CT_wO_DR07_E_rel_totVis_RMS_d1_cosT_0_50_to_0_60);
  hist_vec_380_CT_wO.push_back(h_380_CT_wO_DR07_E_rel_totVis_RMS_d1_cosT_0_60_to_0_70);
  hist_vec_380_CT_wO.push_back(h_380_CT_wO_DR07_E_rel_totVis_RMS_d1_cosT_0_70_to_0_80);
  hist_vec_380_CT_wO.push_back(h_380_CT_wO_DR07_E_rel_totVis_RMS_d1_cosT_0_80_to_0_90);
  hist_vec_380_CT_wO.push_back(h_380_CT_wO_DR07_E_rel_totVis_RMS_d1_cosT_0_900_to_0_925);
  hist_vec_380_CT_wO.push_back(h_380_CT_wO_DR07_E_rel_totVis_RMS_d1_cosT_0_925_to_0_950);
  hist_vec_380_CT_wO.push_back(h_380_CT_wO_DR07_E_rel_totVis_RMS_d1_cosT_0_950_to_0_975);
  hist_vec_380_CT_wO.push_back(h_380_CT_wO_DR07_E_rel_totVis_RMS_d1_cosT_0_975_to_1_00); 

  hist_vec_380_CT_wO.push_back(h_380_CT_wO_DR08_E_rel_totVis_RMS_d1_cosT_0_to_0_10);
  hist_vec_380_CT_wO.push_back(h_380_CT_wO_DR08_E_rel_totVis_RMS_d1_cosT_0_10_to_0_20);
  hist_vec_380_CT_wO.push_back(h_380_CT_wO_DR08_E_rel_totVis_RMS_d1_cosT_0_20_to_0_30);
  hist_vec_380_CT_wO.push_back(h_380_CT_wO_DR08_E_rel_totVis_RMS_d1_cosT_0_30_to_0_40);
  hist_vec_380_CT_wO.push_back(h_380_CT_wO_DR08_E_rel_totVis_RMS_d1_cosT_0_40_to_0_50);
  hist_vec_380_CT_wO.push_back(h_380_CT_wO_DR08_E_rel_totVis_RMS_d1_cosT_0_50_to_0_60);
  hist_vec_380_CT_wO.push_back(h_380_CT_wO_DR08_E_rel_totVis_RMS_d1_cosT_0_60_to_0_70);
  hist_vec_380_CT_wO.push_back(h_380_CT_wO_DR08_E_rel_totVis_RMS_d1_cosT_0_70_to_0_80);
  hist_vec_380_CT_wO.push_back(h_380_CT_wO_DR08_E_rel_totVis_RMS_d1_cosT_0_80_to_0_90);
  hist_vec_380_CT_wO.push_back(h_380_CT_wO_DR08_E_rel_totVis_RMS_d1_cosT_0_900_to_0_925);
  hist_vec_380_CT_wO.push_back(h_380_CT_wO_DR08_E_rel_totVis_RMS_d1_cosT_0_925_to_0_950);
  hist_vec_380_CT_wO.push_back(h_380_CT_wO_DR08_E_rel_totVis_RMS_d1_cosT_0_950_to_0_975);
  hist_vec_380_CT_wO.push_back(h_380_CT_wO_DR08_E_rel_totVis_RMS_d1_cosT_0_975_to_1_00); //110

  hist_vec_380_CT_wO.push_back(h_380_CT_wO_DR09_E_rel_totVis_RMS_d1_cosT_0_to_0_10);
  hist_vec_380_CT_wO.push_back(h_380_CT_wO_DR09_E_rel_totVis_RMS_d1_cosT_0_10_to_0_20);
  hist_vec_380_CT_wO.push_back(h_380_CT_wO_DR09_E_rel_totVis_RMS_d1_cosT_0_20_to_0_30);
  hist_vec_380_CT_wO.push_back(h_380_CT_wO_DR09_E_rel_totVis_RMS_d1_cosT_0_30_to_0_40);
  hist_vec_380_CT_wO.push_back(h_380_CT_wO_DR09_E_rel_totVis_RMS_d1_cosT_0_40_to_0_50);
  hist_vec_380_CT_wO.push_back(h_380_CT_wO_DR09_E_rel_totVis_RMS_d1_cosT_0_50_to_0_60);
  hist_vec_380_CT_wO.push_back(h_380_CT_wO_DR09_E_rel_totVis_RMS_d1_cosT_0_60_to_0_70);
  hist_vec_380_CT_wO.push_back(h_380_CT_wO_DR09_E_rel_totVis_RMS_d1_cosT_0_70_to_0_80);
  hist_vec_380_CT_wO.push_back(h_380_CT_wO_DR09_E_rel_totVis_RMS_d1_cosT_0_80_to_0_90);
  hist_vec_380_CT_wO.push_back(h_380_CT_wO_DR09_E_rel_totVis_RMS_d1_cosT_0_900_to_0_925);
  hist_vec_380_CT_wO.push_back(h_380_CT_wO_DR09_E_rel_totVis_RMS_d1_cosT_0_925_to_0_950);
  hist_vec_380_CT_wO.push_back(h_380_CT_wO_DR09_E_rel_totVis_RMS_d1_cosT_0_950_to_0_975);
  hist_vec_380_CT_wO.push_back(h_380_CT_wO_DR09_E_rel_totVis_RMS_d1_cosT_0_975_to_1_00); //123

  hist_vec_380_CT_wO.push_back(h_380_CT_wO_DR10_E_rel_totVis_RMS_d1_cosT_0_to_0_10);
  hist_vec_380_CT_wO.push_back(h_380_CT_wO_DR10_E_rel_totVis_RMS_d1_cosT_0_10_to_0_20);
  hist_vec_380_CT_wO.push_back(h_380_CT_wO_DR10_E_rel_totVis_RMS_d1_cosT_0_20_to_0_30);
  hist_vec_380_CT_wO.push_back(h_380_CT_wO_DR10_E_rel_totVis_RMS_d1_cosT_0_30_to_0_40);
  hist_vec_380_CT_wO.push_back(h_380_CT_wO_DR10_E_rel_totVis_RMS_d1_cosT_0_40_to_0_50);
  hist_vec_380_CT_wO.push_back(h_380_CT_wO_DR10_E_rel_totVis_RMS_d1_cosT_0_50_to_0_60);
  hist_vec_380_CT_wO.push_back(h_380_CT_wO_DR10_E_rel_totVis_RMS_d1_cosT_0_60_to_0_70);
  hist_vec_380_CT_wO.push_back(h_380_CT_wO_DR10_E_rel_totVis_RMS_d1_cosT_0_70_to_0_80);
  hist_vec_380_CT_wO.push_back(h_380_CT_wO_DR10_E_rel_totVis_RMS_d1_cosT_0_80_to_0_90);
  hist_vec_380_CT_wO.push_back(h_380_CT_wO_DR10_E_rel_totVis_RMS_d1_cosT_0_900_to_0_925);
  hist_vec_380_CT_wO.push_back(h_380_CT_wO_DR10_E_rel_totVis_RMS_d1_cosT_0_925_to_0_950);
  hist_vec_380_CT_wO.push_back(h_380_CT_wO_DR10_E_rel_totVis_RMS_d1_cosT_0_950_to_0_975);
  hist_vec_380_CT_wO.push_back(h_380_CT_wO_DR10_E_rel_totVis_RMS_d1_cosT_0_975_to_1_00); //136

  hist_vec_380_CT_wO.push_back(h_380_CT_wO_DR05_dphi_reco_gen_cosTheta_0_65);//137
  hist_vec_380_CT_wO.push_back(h_380_CT_wO_DR05_dphi_reco_gen_cosTheta_0_65_to_0_80);
  hist_vec_380_CT_wO.push_back(h_380_CT_wO_DR05_dphi_reco_gen_cosTheta_0_80_to_0_925);
  hist_vec_380_CT_wO.push_back(h_380_CT_wO_DR05_dphi_reco_gen_cosTheta_0_925_to_0_975);
  hist_vec_380_CT_wO.push_back(h_380_CT_wO_DR05_dtheta_reco_gen_cosTheta_0_65);
  hist_vec_380_CT_wO.push_back(h_380_CT_wO_DR05_dtheta_reco_gen_cosTheta_0_65_to_0_80);
  hist_vec_380_CT_wO.push_back(h_380_CT_wO_DR05_dtheta_reco_gen_cosTheta_0_80_to_0_925);
  hist_vec_380_CT_wO.push_back(h_380_CT_wO_DR05_dtheta_reco_gen_cosTheta_0_925_to_0_975);

  hist_vec_380_CT_wO.push_back(h_380_CT_wO_DR07_dphi_reco_gen_cosTheta_0_65);//145
  hist_vec_380_CT_wO.push_back(h_380_CT_wO_DR07_dphi_reco_gen_cosTheta_0_65_to_0_80);
  hist_vec_380_CT_wO.push_back(h_380_CT_wO_DR07_dphi_reco_gen_cosTheta_0_80_to_0_925);
  hist_vec_380_CT_wO.push_back(h_380_CT_wO_DR07_dphi_reco_gen_cosTheta_0_925_to_0_975);
  hist_vec_380_CT_wO.push_back(h_380_CT_wO_DR07_dtheta_reco_gen_cosTheta_0_65);
  hist_vec_380_CT_wO.push_back(h_380_CT_wO_DR07_dtheta_reco_gen_cosTheta_0_65_to_0_80);
  hist_vec_380_CT_wO.push_back(h_380_CT_wO_DR07_dtheta_reco_gen_cosTheta_0_80_to_0_925);
  hist_vec_380_CT_wO.push_back(h_380_CT_wO_DR07_dtheta_reco_gen_cosTheta_0_925_to_0_975);

  hist_vec_380_CT_wO.push_back(h_380_CT_wO_DR10_dphi_reco_gen_cosTheta_0_65);//153
  hist_vec_380_CT_wO.push_back(h_380_CT_wO_DR10_dphi_reco_gen_cosTheta_0_65_to_0_80);
  hist_vec_380_CT_wO.push_back(h_380_CT_wO_DR10_dphi_reco_gen_cosTheta_0_80_to_0_925);
  hist_vec_380_CT_wO.push_back(h_380_CT_wO_DR10_dphi_reco_gen_cosTheta_0_925_to_0_975);
  hist_vec_380_CT_wO.push_back(h_380_CT_wO_DR10_dtheta_reco_gen_cosTheta_0_65);
  hist_vec_380_CT_wO.push_back(h_380_CT_wO_DR10_dtheta_reco_gen_cosTheta_0_65_to_0_80);
  hist_vec_380_CT_wO.push_back(h_380_CT_wO_DR10_dtheta_reco_gen_cosTheta_0_80_to_0_925);
  hist_vec_380_CT_wO.push_back(h_380_CT_wO_DR10_dtheta_reco_gen_cosTheta_0_925_to_0_975);


  for(unsigned int i=0;i<hist_vec_380_CT.size();i++){
    hist_vec_380_CT_wO[i]->Sumw2();
  }
  fill_jet_histograms(file_CLIC_380_CT_wO,hist_vec_380_CT_wO);

  TH1F* h_380_CT_wO_DR05_dphi_SigmaCB_summary_histogram=new TH1F("dphiRes_SigmaCBVsCosTheta_CT_wO_DR05_380", "#sigma#Delta#phi(j_{reco},j_{true}) vs |cos#theta|", nRegionBinsAngles, pRegionBinEdgesAngles);
  h_380_CT_wO_DR05_dphi_SigmaCB_summary_histogram ->SetYTitle("#sigma#Delta#phi(j_{reco},j_{true})");
  h_380_CT_wO_DR05_dphi_SigmaCB_summary_histogram->SetXTitle("|cos#theta|");
  h_380_CT_wO_DR05_dphi_SigmaCB_summary_histogram->SetLineWidth(2);
  h_380_CT_wO_DR05_dphi_SigmaCB_summary_histogram->SetLineColor(kCyan+1);
  h_380_CT_wO_DR05_dphi_SigmaCB_summary_histogram->SetLineStyle(2);

  TH1F* h_380_CT_wO_DR05_dphi_RMS90_summary_histogram=new TH1F("dphiRes_RMS90VsCosTheta_CT_wO_DR05_380", "RMS_{90} #Delta#phi(j_{reco},j_{true}) vs |cos#theta|", nRegionBinsAngles, pRegionBinEdgesAngles);
  h_380_CT_wO_DR05_dphi_RMS90_summary_histogram ->SetYTitle("RMS_{90}#Delta#phi(j_{reco},j_{true})");
  h_380_CT_wO_DR05_dphi_RMS90_summary_histogram->SetXTitle("|cos#theta|");
  h_380_CT_wO_DR05_dphi_RMS90_summary_histogram->SetLineWidth(2);
  h_380_CT_wO_DR05_dphi_RMS90_summary_histogram->SetLineColor(kCyan+1);
  h_380_CT_wO_DR05_dphi_RMS90_summary_histogram->SetLineStyle(2);

  TH1F* h_380_CT_wO_DR07_dphi_SigmaCB_summary_histogram=new TH1F("dphiRes_SigmaCBVsCosTheta_CT_wO_DR07_380", "#sigma#Delta#phi(j_{reco},j_{true}) vs |cos#theta|", nRegionBinsAngles, pRegionBinEdgesAngles);
  h_380_CT_wO_DR07_dphi_SigmaCB_summary_histogram ->SetYTitle("#sigma#Delta#phi(j_{reco},j_{true})");
  h_380_CT_wO_DR07_dphi_SigmaCB_summary_histogram->SetXTitle("|cos#theta|");
  h_380_CT_wO_DR07_dphi_SigmaCB_summary_histogram->SetLineWidth(2);
  h_380_CT_wO_DR07_dphi_SigmaCB_summary_histogram->SetLineColor(kCyan+1);
  h_380_CT_wO_DR07_dphi_SigmaCB_summary_histogram->SetLineStyle(2);

  TH1F* h_380_CT_wO_DR07_dphi_RMS90_summary_histogram=new TH1F("dphiRes_RMS90VsCosTheta_CT_wO_DR07_380", "RMS_{90} #Delta#phi(j_{reco},j_{true}) vs |cos#theta|", nRegionBinsAngles, pRegionBinEdgesAngles);
  h_380_CT_wO_DR07_dphi_RMS90_summary_histogram ->SetYTitle("RMS_{90}#Delta#phi(j_{reco},j_{true})");
  h_380_CT_wO_DR07_dphi_RMS90_summary_histogram->SetXTitle("|cos#theta|");
  h_380_CT_wO_DR07_dphi_RMS90_summary_histogram->SetLineWidth(2);
  h_380_CT_wO_DR07_dphi_RMS90_summary_histogram->SetLineColor(kCyan+1);
  h_380_CT_wO_DR07_dphi_RMS90_summary_histogram->SetLineStyle(2);

  TH1F* h_380_CT_wO_DR10_dphi_SigmaCB_summary_histogram=new TH1F("dphiRes_SigmaCBVsCosTheta_CT_wO_DR10_380", "#sigma#Delta#phi(j_{reco},j_{true}) vs |cos#theta|", nRegionBinsAngles, pRegionBinEdgesAngles);
  h_380_CT_wO_DR10_dphi_SigmaCB_summary_histogram ->SetYTitle("#sigma#Delta#phi(j_{reco},j_{true})");
  h_380_CT_wO_DR10_dphi_SigmaCB_summary_histogram->SetXTitle("|cos#theta|");
  h_380_CT_wO_DR10_dphi_SigmaCB_summary_histogram->SetLineWidth(2);
  h_380_CT_wO_DR10_dphi_SigmaCB_summary_histogram->SetLineColor(kCyan+1);
  h_380_CT_wO_DR10_dphi_SigmaCB_summary_histogram->SetLineStyle(2);

  TH1F* h_380_CT_wO_DR10_dphi_RMS90_summary_histogram=new TH1F("dphiRes_RMS90VsCosTheta_CT_wO_DR10_380", "RMS_{90} #Delta#phi(j_{reco},j_{true}) vs |cos#theta|", nRegionBinsAngles, pRegionBinEdgesAngles);
  h_380_CT_wO_DR10_dphi_RMS90_summary_histogram ->SetYTitle("RMS_{90}#Delta#phi(j_{reco},j_{true})");
  h_380_CT_wO_DR10_dphi_RMS90_summary_histogram->SetXTitle("|cos#theta|");
  h_380_CT_wO_DR10_dphi_RMS90_summary_histogram->SetLineWidth(2);
  h_380_CT_wO_DR10_dphi_RMS90_summary_histogram->SetLineColor(kCyan+1);
  h_380_CT_wO_DR10_dphi_RMS90_summary_histogram->SetLineStyle(2);

  TH1F* h_380_CT_wO_DR05_dtheta_SigmaCB_summary_histogram=new TH1F("dthetaRes_SigmaCBVsCosTheta_CT_wO_DR05_380", "#sigma#Delta#theta(j_{reco},j_{true}) vs |cos#theta|", nRegionBinsAngles, pRegionBinEdgesAngles);
  h_380_CT_wO_DR05_dtheta_SigmaCB_summary_histogram ->SetYTitle("#sigma#Delta#theta(j_{reco},j_{true})");
  h_380_CT_wO_DR05_dtheta_SigmaCB_summary_histogram->SetXTitle("|cos#theta|");
  h_380_CT_wO_DR05_dtheta_SigmaCB_summary_histogram->SetLineWidth(2);
  h_380_CT_wO_DR05_dtheta_SigmaCB_summary_histogram->SetLineColor(kCyan+1);
  h_380_CT_wO_DR05_dtheta_SigmaCB_summary_histogram->SetLineStyle(2);

  TH1F* h_380_CT_wO_DR05_dtheta_RMS90_summary_histogram=new TH1F("dthetaRes_RMS90VsCosTheta_CT_wO_DR05_380", "RMS_{90} #Delta#theta(j_{reco},j_{true}) vs |cos#theta|", nRegionBinsAngles, pRegionBinEdgesAngles);
  h_380_CT_wO_DR05_dtheta_RMS90_summary_histogram ->SetYTitle("RMS_{90}#Delta#theta(j_{reco},j_{true})");
  h_380_CT_wO_DR05_dtheta_RMS90_summary_histogram->SetXTitle("|cos#theta|");
  h_380_CT_wO_DR05_dtheta_RMS90_summary_histogram->SetLineWidth(2);
  h_380_CT_wO_DR05_dtheta_RMS90_summary_histogram->SetLineColor(kCyan+1);
  h_380_CT_wO_DR05_dtheta_RMS90_summary_histogram->SetLineStyle(2);

  TH1F* h_380_CT_wO_DR07_dtheta_SigmaCB_summary_histogram=new TH1F("dthetaRes_SigmaCBVsCosTheta_CT_wO_DR07_380", "#sigma#Delta#theta(j_{reco},j_{true}) vs |cos#theta|", nRegionBinsAngles, pRegionBinEdgesAngles);
  h_380_CT_wO_DR07_dtheta_SigmaCB_summary_histogram ->SetYTitle("#sigma#Delta#theta(j_{reco},j_{true})");
  h_380_CT_wO_DR07_dtheta_SigmaCB_summary_histogram->SetXTitle("|cos#theta|");
  h_380_CT_wO_DR07_dtheta_SigmaCB_summary_histogram->SetLineWidth(2);
  h_380_CT_wO_DR07_dtheta_SigmaCB_summary_histogram->SetLineColor(kCyan+1);
  h_380_CT_wO_DR07_dtheta_SigmaCB_summary_histogram->SetLineStyle(2);

  TH1F* h_380_CT_wO_DR07_dtheta_RMS90_summary_histogram=new TH1F("dthetaRes_RMS90VsCosTheta_CT_wO_DR07_380", "RMS_{90} #Delta#theta(j_{reco},j_{true}) vs |cos#theta|", nRegionBinsAngles, pRegionBinEdgesAngles);
  h_380_CT_wO_DR07_dtheta_RMS90_summary_histogram ->SetYTitle("RMS_{90}#Delta#theta(j_{reco},j_{true})");
  h_380_CT_wO_DR07_dtheta_RMS90_summary_histogram->SetXTitle("|cos#theta|");
  h_380_CT_wO_DR07_dtheta_RMS90_summary_histogram->SetLineWidth(2);
  h_380_CT_wO_DR07_dtheta_RMS90_summary_histogram->SetLineColor(kCyan+1);
  h_380_CT_wO_DR07_dtheta_RMS90_summary_histogram->SetLineStyle(2);

  TH1F* h_380_CT_wO_DR10_dtheta_SigmaCB_summary_histogram=new TH1F("dthetaRes_SigmaCBVsCosTheta_CT_wO_DR10_380", "#sigma#Delta#theta(j_{reco},j_{true}) vs |cos#theta|", nRegionBinsAngles, pRegionBinEdgesAngles);
  h_380_CT_wO_DR10_dtheta_SigmaCB_summary_histogram ->SetYTitle("#sigma#Delta#theta(j_{reco},j_{true})");
  h_380_CT_wO_DR10_dtheta_SigmaCB_summary_histogram->SetXTitle("|cos#theta|");
  h_380_CT_wO_DR10_dtheta_SigmaCB_summary_histogram->SetLineWidth(2);
  h_380_CT_wO_DR10_dtheta_SigmaCB_summary_histogram->SetLineColor(kCyan+1);
  h_380_CT_wO_DR10_dtheta_SigmaCB_summary_histogram->SetLineStyle(2);

  TH1F* h_380_CT_wO_DR10_dtheta_RMS90_summary_histogram=new TH1F("dthetaRes_RMS90VsCosTheta_CT_wO_DR10_380", "RMS_{90} #Delta#theta(j_{reco},j_{true}) vs |cos#theta|", nRegionBinsAngles, pRegionBinEdgesAngles);
  h_380_CT_wO_DR10_dtheta_RMS90_summary_histogram ->SetYTitle("RMS_{90}#Delta#theta(j_{reco},j_{true})");
  h_380_CT_wO_DR10_dtheta_RMS90_summary_histogram->SetXTitle("|cos#theta|");
  h_380_CT_wO_DR10_dtheta_RMS90_summary_histogram->SetLineWidth(2);
  h_380_CT_wO_DR10_dtheta_RMS90_summary_histogram->SetLineColor(kCyan+1);
  h_380_CT_wO_DR10_dtheta_RMS90_summary_histogram->SetLineStyle(2);

  for(int i=137;i<161;i++){
    //continue;
    std::cout<<"ang histo 380 "<<i<<"]"<<std::endl;
   //double sided crystal ball
    TF1* fit_gaus_tmp = new TF1("fit_gaus_tmp", "gaus",-5.,5.);
    hist_vec_380_CT_wO[i]->Fit("fit_gaus_tmp","R");
    hist_vec_380_CT_wO[i]->GetFunction("fit_gaus_tmp");
    TF1* fdscb_tmp = new TF1("fdscb_tmp",fnc_dscb,-lim_angleDeg,lim_angleDeg,7);
   fdscb_tmp->SetNpx(2000);
    fdscb_tmp->SetParameter(0,fit_gaus_tmp->GetParameter(0));
    //norm
    fdscb_tmp->SetParLimits (0,0.5*fit_gaus_tmp->GetParameter(0),1.5*fit_gaus_tmp->GetParameter(0));
    fdscb_tmp->SetParameter(1,fit_gaus_tmp->GetParameter(1));
    //gaussian mean
    fdscb_tmp->SetParLimits (1,-2.,2.);
    fdscb_tmp->SetParameter(2,fit_gaus_tmp->GetParameter(2));
    fdscb_tmp->SetParLimits(2,fit_gaus_tmp->GetParameter(2)*0.50,1.50*fit_gaus_tmp->GetParameter(2));
    //std::vector<float>sigma2SFit=sigmaGaussianFits2Sigma(hist_vec_380_CT_wO[i]);
    //fdscb_tmp->SetParameter(2,sigma2SFit[0]);
    //fdscb_tmp->SetParLimits(2,sigma2SFit[0]*0.50,1.50*sigma2SFit[0]);
    //-a1: parameter, from when the gaussian core should count
    fdscb_tmp->SetParameter(2,fit_gaus_tmp->GetParameter(2));
    fdscb_tmp->SetParameter (3,3.0);
    fdscb_tmp->SetParLimits (3,0.0,10.0);
    //a2 parameter, up to when the gaussian core should count
    fdscb_tmp->SetParameter (5,3.0);
    fdscb_tmp->SetParLimits (5,0.0,10.0);
    fdscb_tmp->SetParameter(4,5.);
    fdscb_tmp->SetParLimits(4,0.,25.);
    fdscb_tmp->SetParameter(6,5.);
    fdscb_tmp->SetParLimits(6,0.,25.);
    int fitstatus(0); 
    fitstatus = hist_vec_380_CT_wO[i]->Fit(fdscb_tmp,"R");
    fdscb_tmp = hist_vec_380_CT_wO[i]->GetFunction("fdscb_tmp");
    resolutionTH1=0; 
    resolutionErrorTH1=0;
    meanTH1=0;
    meanErrorTH1=0;
    CalculatePerformanceNoMean( hist_vec_380_CT_wO[i], resolutionTH1, resolutionErrorTH1,meanTH1,meanErrorTH1);
    int first_bin_ang=137;
    if(i<141){//dphi DR05
      first_bin_ang=137;
      h_380_CT_wO_DR05_dphi_SigmaCB_summary_histogram->SetBinContent(i-first_bin_ang+1,fdscb_tmp->GetParameter(2));
      h_380_CT_wO_DR05_dphi_SigmaCB_summary_histogram->SetBinError(i-first_bin_ang+1,fdscb_tmp->GetParError(2));
      h_380_CT_wO_DR05_dphi_RMS90_summary_histogram->SetBinContent(i-first_bin_ang+1,resolutionTH1);
      h_380_CT_wO_DR05_dphi_RMS90_summary_histogram->SetBinError(i-first_bin_ang+1, resolutionErrorTH1);
    }else if(i<145){//dtheta DR05
      first_bin_ang=141;
      h_380_CT_wO_DR05_dtheta_SigmaCB_summary_histogram->SetBinContent(i-first_bin_ang+1,fdscb_tmp->GetParameter(2));
      h_380_CT_wO_DR05_dtheta_SigmaCB_summary_histogram->SetBinError(i-first_bin_ang+1,fdscb_tmp->GetParError(2));
      h_380_CT_wO_DR05_dtheta_RMS90_summary_histogram->SetBinContent(i-first_bin_ang+1,resolutionTH1);
      h_380_CT_wO_DR05_dtheta_RMS90_summary_histogram->SetBinError(i-first_bin_ang+1, resolutionErrorTH1);
    }else if(i<149){//dphi DR07
      first_bin_ang=145;
      h_380_CT_wO_DR07_dphi_SigmaCB_summary_histogram->SetBinContent(i-first_bin_ang+1,fdscb_tmp->GetParameter(2));
      h_380_CT_wO_DR07_dphi_SigmaCB_summary_histogram->SetBinError(i-first_bin_ang+1,fdscb_tmp->GetParError(2));
      h_380_CT_wO_DR07_dphi_RMS90_summary_histogram->SetBinContent(i-first_bin_ang+1,resolutionTH1);
      h_380_CT_wO_DR07_dphi_RMS90_summary_histogram->SetBinError(i-first_bin_ang+1, resolutionErrorTH1);
    }else if(i<153){//dtheta DR07
      first_bin_ang=149;
      h_380_CT_wO_DR07_dtheta_SigmaCB_summary_histogram->SetBinContent(i-first_bin_ang+1,fdscb_tmp->GetParameter(2));
      h_380_CT_wO_DR07_dtheta_SigmaCB_summary_histogram->SetBinError(i-first_bin_ang+1,fdscb_tmp->GetParError(2));
      h_380_CT_wO_DR07_dtheta_RMS90_summary_histogram->SetBinContent(i-first_bin_ang+1,resolutionTH1);
      h_380_CT_wO_DR07_dtheta_RMS90_summary_histogram->SetBinError(i-first_bin_ang+1, resolutionErrorTH1);
    }else if(i<157){//dphi DR07
      first_bin_ang=153;
      h_380_CT_wO_DR10_dphi_SigmaCB_summary_histogram->SetBinContent(i-first_bin_ang+1,fdscb_tmp->GetParameter(2));
      h_380_CT_wO_DR10_dphi_SigmaCB_summary_histogram->SetBinError(i-first_bin_ang+1,fdscb_tmp->GetParError(2));
      h_380_CT_wO_DR10_dphi_RMS90_summary_histogram->SetBinContent(i-first_bin_ang+1,resolutionTH1);
      h_380_CT_wO_DR10_dphi_RMS90_summary_histogram->SetBinError(i-first_bin_ang+1, resolutionErrorTH1);
    }else if(i<161){//dtheta DR07
      first_bin_ang=157;
      h_380_CT_wO_DR10_dtheta_SigmaCB_summary_histogram->SetBinContent(i-first_bin_ang+1,fdscb_tmp->GetParameter(2));
      h_380_CT_wO_DR10_dtheta_SigmaCB_summary_histogram->SetBinError(i-first_bin_ang+1,fdscb_tmp->GetParError(2));
      h_380_CT_wO_DR10_dtheta_RMS90_summary_histogram->SetBinContent(i-first_bin_ang+1,resolutionTH1);
      h_380_CT_wO_DR10_dtheta_RMS90_summary_histogram->SetBinError(i-first_bin_ang+1, resolutionErrorTH1);
    }
  }

  TH1F* h_380_CT_wO_DR05_E_SigmaCB_summary_histogram=new TH1F("JER_SigmaCBVsCosTheta_CT_wO_DR05_380", "RMS_{90}(E_{j}^{reco}/E_{j}^{gen}) / Mean_{90}(E_{j}^{reco}/E_{j}^{gen}) vs |cos#theta|", nRegionBins, pRegionBinEdges);
  h_380_CT_wO_DR05_E_SigmaCB_summary_histogram ->SetYTitle("#sigma(E_{j}) / E_{j} [%]");
  h_380_CT_wO_DR05_E_SigmaCB_summary_histogram->SetXTitle("|cos#theta|");
  h_380_CT_wO_DR05_E_SigmaCB_summary_histogram->SetLineWidth(2);
  h_380_CT_wO_DR05_E_SigmaCB_summary_histogram->SetLineColor(kOrange);
  h_380_CT_wO_DR05_E_SigmaCB_summary_histogram->SetLineStyle(2);
  TH1F* h_380_CT_wO_DR05_E_RMS90_summary_histogram=new TH1F("JER_RMS90VsCosTheta_CT_wO_DR05_380", "RMS_{90}(E_{j}^{reco}/E_{j}^{gen}) / Mean_{90}(E_{j}^{reco}/E_{j}^{gen}) vs |cos#theta|", nRegionBins, pRegionBinEdges);
  h_380_CT_wO_DR05_E_RMS90_summary_histogram ->SetYTitle("RMS_{90}(E_{j}^{reco}/E_{j}^{gen}) / Mean_{90}(E_{j}^{reco}/E_{j}^{gen}) [%]");
  h_380_CT_wO_DR05_E_RMS90_summary_histogram->SetXTitle("|cos#theta|");
  h_380_CT_wO_DR05_E_RMS90_summary_histogram->SetLineWidth(2);
  h_380_CT_wO_DR05_E_RMS90_summary_histogram->SetLineColor(kRed);
  h_380_CT_wO_DR05_E_RMS90_summary_histogram->SetLineStyle(2);

  TH1F* h_380_CT_wO_DR05_E_RMS_summary_histogram=new TH1F("JER_RMSVsCosTheta_CT_wO_DR05_380", "RMS(E_{j}) / Mean(E_{j}) vs |cos#theta|", nRegionBins, pRegionBinEdges);
  h_380_CT_wO_DR05_E_RMS_summary_histogram ->SetYTitle("RMS(E_{j}) / Mean(E_{j}) [%]");
  h_380_CT_wO_DR05_E_RMS_summary_histogram->SetXTitle("|cos#theta|");
  h_380_CT_wO_DR05_E_RMS_summary_histogram->SetLineWidth(2);
  h_380_CT_wO_DR05_E_RMS_summary_histogram->SetLineColor(kRed);
  h_380_CT_wO_DR05_E_RMS_summary_histogram->SetLineStyle(2);

  TH1F* h_380_CT_wO_DR05_E_JER_Mean_summary_histogram=new TH1F("JER_MeanVsCosTheta_CT_wO_DR05_380", "Mean(E_{tot}^{RECO}/E_{tot}^{true}) vs |cos#theta|", nRegionBins, pRegionBinEdges);
  h_380_CT_wO_DR05_E_JER_Mean_summary_histogram->SetYTitle("Mean(E_{tot}^{RECO}/E_{tot}^{true})");
  h_380_CT_wO_DR05_E_JER_Mean_summary_histogram->SetXTitle("|cos#theta|");
  h_380_CT_wO_DR05_E_JER_Mean_summary_histogram->SetLineWidth(2);
  h_380_CT_wO_DR05_E_JER_Mean_summary_histogram->SetLineColor(kRed);
  h_380_CT_wO_DR05_E_JER_Mean_summary_histogram->SetLineStyle(2);

  firstbin=59;
  for(int i=firstbin;i<(firstbin+13);i++){
    //continue;
    resolutionTH1=0; 
    resolutionErrorTH1=0;
    meanTH1=0;
    meanErrorTH1=0;
    CalculatePerformance( hist_vec_380_CT_wO[i], resolutionTH1, resolutionErrorTH1,meanTH1,meanErrorTH1);
    h_380_CT_wO_DR05_E_RMS90_summary_histogram->SetBinContent(i-firstbin+1,resolutionTH1/sqrt(2.));
    h_380_CT_wO_DR05_E_RMS90_summary_histogram ->SetBinError(i-firstbin+1, resolutionErrorTH1/sqrt(2.));
    h_380_CT_wO_DR05_E_RMS_summary_histogram->SetBinContent(i-firstbin+1,hist_vec_380_CT_wO[i]->GetRMS()*100. );
    h_380_CT_wO_DR05_E_RMS_summary_histogram ->SetBinError(i-firstbin+1, hist_vec_380_CT_wO[i]->GetRMSError()*100.);
    h_380_CT_wO_DR05_E_JER_Mean_summary_histogram->SetBinContent(i-firstbin+1,hist_vec_380_CT_wO[i]->GetMean());
    h_380_CT_wO_DR05_E_JER_Mean_summary_histogram->SetBinError(i-firstbin+1,hist_vec_380_CT_wO[i]->GetMeanError());
    //double sided crystal ball
    TF1* fit_gaus_tmp = new TF1("fit_gaus_tmp", "gaus",0.50,1.50);
    hist_vec_380_CT_wO[i]->Fit("fit_gaus_tmp","R");
    hist_vec_380_CT_wO[i]->GetFunction("fit_gaus_tmp");

    TF1* fdscb_tmp = new TF1("fdscb_tmp",fnc_dscb,0.,3.,7);
    fdscb_tmp->SetNpx(1000);
    fdscb_tmp->SetParameter(0,fit_gaus_tmp->GetParameter(0));
    //norm
    fdscb_tmp->SetParLimits (0,0.5*fit_gaus_tmp->GetParameter(0),1.5*fit_gaus_tmp->GetParameter(0));
    fdscb_tmp->SetParameter(1,fit_gaus_tmp->GetParameter(1));
    //gaussian mean
    fdscb_tmp->SetParLimits (1,0.8,1.2);
    //fdscb_tmp->SetParameter(2,fit_gaus_tmp->GetParameter(2));
    //fdscb_tmp->SetParLimits(2,fit_gaus_tmp->GetParameter(2)*0.50,1.50*fit_gaus_tmp->GetParameter(2));
    std::vector<float>sigma2SFit=sigmaGaussianFits2Sigma(hist_vec_380_CT_wO[i]);
    fdscb_tmp->SetParameter(2,sigma2SFit[0]);
    fdscb_tmp->SetParLimits(2,sigma2SFit[0]*0.50,1.50*sigma2SFit[0]);
    //-a1: parameter, from when the gaussian core should count
    fdscb_tmp->SetParameter(2,fit_gaus_tmp->GetParameter(2));
    fdscb_tmp->SetParameter (3,3.0);
    fdscb_tmp->SetParLimits (3,0.0,10.0);
    //a2 parameter, up to when the gaussian core should count
    fdscb_tmp->SetParameter (5,3.0);
    fdscb_tmp->SetParLimits (5,0.0,10.0);
    fdscb_tmp->SetParameter(4,5.);
    fdscb_tmp->SetParLimits(4,0.,25.);
    fdscb_tmp->SetParameter(6,5.);
    fdscb_tmp->SetParLimits(6,0.,25.);
    int fitstatus(0); 
    fitstatus = hist_vec_380_CT_wO[i]->Fit(fdscb_tmp,"R");
    fdscb_tmp = hist_vec_380_CT_wO[i]->GetFunction("fdscb_tmp");
    h_380_CT_wO_DR05_E_SigmaCB_summary_histogram->SetBinContent(i-firstbin+1,fdscb_tmp->GetParameter(2)*100. );
    h_380_CT_wO_DR05_E_SigmaCB_summary_histogram->SetBinError(i-firstbin+1,fdscb_tmp->GetParError(2)*100. );
  }  
  TH1F* h_380_CT_wO_DR06_E_SigmaCB_summary_histogram=new TH1F("JER_SigmaCBVsCosTheta_CT_wO_DR06_380", "RMS_{90}(E_{j}^{reco}/E_{j}^{gen}) / Mean_{90}(E_{j}^{reco}/E_{j}^{gen}) vs |cos#theta|", nRegionBins, pRegionBinEdges);
  h_380_CT_wO_DR06_E_SigmaCB_summary_histogram ->SetYTitle("#sigma(E_{j}) / E_{j} [%]");
  h_380_CT_wO_DR06_E_SigmaCB_summary_histogram->SetXTitle("|cos#theta|");
  h_380_CT_wO_DR06_E_SigmaCB_summary_histogram->SetLineWidth(2);
  h_380_CT_wO_DR06_E_SigmaCB_summary_histogram->SetLineColor(kOrange);
  h_380_CT_wO_DR06_E_SigmaCB_summary_histogram->SetLineStyle(2);
  TH1F* h_380_CT_wO_DR06_E_RMS90_summary_histogram=new TH1F("JER_RMS90VsCosTheta_CT_wO_DR06_380", "RMS_{90}(E_{j}^{reco}/E_{j}^{gen}) / Mean_{90}(E_{j}^{reco}/E_{j}^{gen}) vs |cos#theta|", nRegionBins, pRegionBinEdges);
  h_380_CT_wO_DR06_E_RMS90_summary_histogram ->SetYTitle("RMS_{90}(E_{j}^{reco}/E_{j}^{gen}) / Mean_{90}(E_{j}^{reco}/E_{j}^{gen}) [%]");
  h_380_CT_wO_DR06_E_RMS90_summary_histogram->SetXTitle("|cos#theta|");
  h_380_CT_wO_DR06_E_RMS90_summary_histogram->SetLineWidth(2);
  h_380_CT_wO_DR06_E_RMS90_summary_histogram->SetLineColor(kRed);
  h_380_CT_wO_DR06_E_RMS90_summary_histogram->SetLineStyle(2);

  TH1F* h_380_CT_wO_DR06_E_RMS_summary_histogram=new TH1F("JER_RMSVsCosTheta_CT_wO_DR06_380", "RMS(E_{j}) / Mean(E_{j}) vs |cos#theta|", nRegionBins, pRegionBinEdges);
  h_380_CT_wO_DR06_E_RMS_summary_histogram ->SetYTitle("RMS(E_{j}) / Mean(E_{j}) [%]");
  h_380_CT_wO_DR06_E_RMS_summary_histogram->SetXTitle("|cos#theta|");
  h_380_CT_wO_DR06_E_RMS_summary_histogram->SetLineWidth(2);
  h_380_CT_wO_DR06_E_RMS_summary_histogram->SetLineColor(kRed);
  h_380_CT_wO_DR06_E_RMS_summary_histogram->SetLineStyle(2);

  TH1F* h_380_CT_wO_DR06_E_JER_Mean_summary_histogram=new TH1F("JER_MeanVsCosTheta_CT_wO_DR06_380", "Mean(E_{tot}^{RECO}/E_{tot}^{true}) vs |cos#theta|", nRegionBins, pRegionBinEdges);
  h_380_CT_wO_DR06_E_JER_Mean_summary_histogram->SetYTitle("Mean(E_{tot}^{RECO}/E_{tot}^{true})");
  h_380_CT_wO_DR06_E_JER_Mean_summary_histogram->SetXTitle("|cos#theta|");
  h_380_CT_wO_DR06_E_JER_Mean_summary_histogram->SetLineWidth(2);
  h_380_CT_wO_DR06_E_JER_Mean_summary_histogram->SetLineColor(kRed);
  h_380_CT_wO_DR06_E_JER_Mean_summary_histogram->SetLineStyle(2);
  firstbin=72;
  for(int i=firstbin;i<(firstbin+13);i++){
    //continue;
    resolutionTH1=0; 
    resolutionErrorTH1=0;
    meanTH1=0;
    meanErrorTH1=0;
    CalculatePerformance( hist_vec_380_CT_wO[i], resolutionTH1, resolutionErrorTH1,meanTH1,meanErrorTH1);
    h_380_CT_wO_DR06_E_RMS90_summary_histogram->SetBinContent(i-firstbin+1,resolutionTH1/sqrt(2.));
    h_380_CT_wO_DR06_E_RMS90_summary_histogram ->SetBinError(i-firstbin+1, resolutionErrorTH1/sqrt(2.));
    h_380_CT_wO_DR06_E_RMS_summary_histogram->SetBinContent(i-firstbin+1,hist_vec_380_CT_wO[i]->GetRMS()*100. );
    h_380_CT_wO_DR06_E_RMS_summary_histogram ->SetBinError(i-firstbin+1, hist_vec_380_CT_wO[i]->GetRMSError()*100.);
    h_380_CT_wO_DR06_E_JER_Mean_summary_histogram->SetBinContent(i-firstbin+1,hist_vec_380_CT_wO[i]->GetMean());
    h_380_CT_wO_DR06_E_JER_Mean_summary_histogram->SetBinError(i-firstbin+1,hist_vec_380_CT_wO[i]->GetMeanError());
    //double sided crystal ball
    TF1* fit_gaus_tmp = new TF1("fit_gaus_tmp", "gaus",0.50,1.50);
    hist_vec_380_CT_wO[i]->Fit("fit_gaus_tmp","R");
    hist_vec_380_CT_wO[i]->GetFunction("fit_gaus_tmp");

    TF1* fdscb_tmp = new TF1("fdscb_tmp",fnc_dscb,0.,3.,7);
   fdscb_tmp->SetNpx(1000);
    fdscb_tmp->SetParameter(0,fit_gaus_tmp->GetParameter(0));
    //norm
    fdscb_tmp->SetParLimits (0,0.5*fit_gaus_tmp->GetParameter(0),1.5*fit_gaus_tmp->GetParameter(0));
    fdscb_tmp->SetParameter(1,fit_gaus_tmp->GetParameter(1));
    //gaussian mean
    fdscb_tmp->SetParLimits (1,0.8,1.2);
    //fdscb_tmp->SetParameter(2,fit_gaus_tmp->GetParameter(2));
    //fdscb_tmp->SetParLimits(2,fit_gaus_tmp->GetParameter(2)*0.50,1.50*fit_gaus_tmp->GetParameter(2));
    std::vector<float>sigma2SFit=sigmaGaussianFits2Sigma(hist_vec_380_CT_wO[i]);
    fdscb_tmp->SetParameter(2,sigma2SFit[0]);
    fdscb_tmp->SetParLimits(2,sigma2SFit[0]*0.50,1.50*sigma2SFit[0]);
    //-a1: parameter, from when the gaussian core should count
    fdscb_tmp->SetParameter(2,fit_gaus_tmp->GetParameter(2));
    fdscb_tmp->SetParameter (3,3.0);
    fdscb_tmp->SetParLimits (3,0.0,10.0);
    //a2 parameter, up to when the gaussian core should count
    fdscb_tmp->SetParameter (5,3.0);
    fdscb_tmp->SetParLimits (5,0.0,10.0);
    fdscb_tmp->SetParameter(4,5.);
    fdscb_tmp->SetParLimits(4,0.,25.);
    fdscb_tmp->SetParameter(6,5.);
    fdscb_tmp->SetParLimits(6,0.,25.);
    int fitstatus(0); 
    fitstatus = hist_vec_380_CT_wO[i]->Fit(fdscb_tmp,"R");
    fdscb_tmp = hist_vec_380_CT_wO[i]->GetFunction("fdscb_tmp");
    h_380_CT_wO_DR06_E_SigmaCB_summary_histogram->SetBinContent(i-firstbin+1,fdscb_tmp->GetParameter(2)*100. );
    h_380_CT_wO_DR06_E_SigmaCB_summary_histogram->SetBinError(i-firstbin+1,fdscb_tmp->GetParError(2)*100. );
  }  
  TH1F* h_380_CT_wO_DR07_E_SigmaCB_summary_histogram=new TH1F("JER_SigmaCBVsCosTheta_CT_wO_DR07_380", "RMS_{90}(E_{j}^{reco}/E_{j}^{gen}) / Mean_{90}(E_{j}^{reco}/E_{j}^{gen}) vs |cos#theta|", nRegionBins, pRegionBinEdges);
  h_380_CT_wO_DR07_E_SigmaCB_summary_histogram ->SetYTitle("#sigma(E_{j}) / E_{j} [%]");
  h_380_CT_wO_DR07_E_SigmaCB_summary_histogram->SetXTitle("|cos#theta|");
  h_380_CT_wO_DR07_E_SigmaCB_summary_histogram->SetLineWidth(2);
  h_380_CT_wO_DR07_E_SigmaCB_summary_histogram->SetLineColor(kOrange);
  h_380_CT_wO_DR07_E_SigmaCB_summary_histogram->SetLineStyle(2);
  TH1F* h_380_CT_wO_DR07_E_RMS90_summary_histogram=new TH1F("JER_RMS90VsCosTheta_CT_wO_DR07_380", "RMS_{90}(E_{j}^{reco}/E_{j}^{gen}) / Mean_{90}(E_{j}^{reco}/E_{j}^{gen}) vs |cos#theta|", nRegionBins, pRegionBinEdges);
  h_380_CT_wO_DR07_E_RMS90_summary_histogram ->SetYTitle("RMS_{90}(E_{j}^{reco}/E_{j}^{gen}) / Mean_{90}(E_{j}^{reco}/E_{j}^{gen}) [%]");
  h_380_CT_wO_DR07_E_RMS90_summary_histogram->SetXTitle("|cos#theta|");
  h_380_CT_wO_DR07_E_RMS90_summary_histogram->SetLineWidth(2);
  h_380_CT_wO_DR07_E_RMS90_summary_histogram->SetLineColor(kRed);
  h_380_CT_wO_DR07_E_RMS90_summary_histogram->SetLineStyle(2);

  TH1F* h_380_CT_wO_DR07_E_RMS_summary_histogram=new TH1F("JER_RMSVsCosTheta_CT_wO_DR07_380", "RMS(E_{j}) / Mean(E_{j}) vs |cos#theta|", nRegionBins, pRegionBinEdges);
  h_380_CT_wO_DR07_E_RMS_summary_histogram ->SetYTitle("RMS(E_{j}) / Mean(E_{j}) [%]");
  h_380_CT_wO_DR07_E_RMS_summary_histogram->SetXTitle("|cos#theta|");
  h_380_CT_wO_DR07_E_RMS_summary_histogram->SetLineWidth(2);
  h_380_CT_wO_DR07_E_RMS_summary_histogram->SetLineColor(kRed);
  h_380_CT_wO_DR07_E_RMS_summary_histogram->SetLineStyle(2);

  TH1F* h_380_CT_wO_DR07_E_JER_Mean_summary_histogram=new TH1F("JER_MeanVsCosTheta_CT_wO_DR07_380", "Mean(E_{tot}^{RECO}/E_{tot}^{true}) vs |cos#theta|", nRegionBins, pRegionBinEdges);
  h_380_CT_wO_DR07_E_JER_Mean_summary_histogram->SetYTitle("Mean(E_{tot}^{RECO}/E_{tot}^{true})");
  h_380_CT_wO_DR07_E_JER_Mean_summary_histogram->SetXTitle("|cos#theta|");
  h_380_CT_wO_DR07_E_JER_Mean_summary_histogram->SetLineWidth(2);
  h_380_CT_wO_DR07_E_JER_Mean_summary_histogram->SetLineColor(kRed);
  h_380_CT_wO_DR07_E_JER_Mean_summary_histogram->SetLineStyle(2);
  firstbin=85;
 std::cout<<"start DR07 wO 380"<<std::endl;
  for(int i=firstbin;i<(firstbin+13);i++){
    //continue;
    resolutionTH1=0; 
    resolutionErrorTH1=0;
    meanTH1=0;
    meanErrorTH1=0;
    CalculatePerformance( hist_vec_380_CT_wO[i], resolutionTH1, resolutionErrorTH1,meanTH1,meanErrorTH1);
    h_380_CT_wO_DR07_E_RMS90_summary_histogram->SetBinContent(i-firstbin+1,resolutionTH1/sqrt(2.));
    h_380_CT_wO_DR07_E_RMS90_summary_histogram ->SetBinError(i-firstbin+1, resolutionErrorTH1/sqrt(2.));
    h_380_CT_wO_DR07_E_RMS_summary_histogram->SetBinContent(i-firstbin+1,hist_vec_380_CT_wO[i]->GetRMS()*100. );
    h_380_CT_wO_DR07_E_RMS_summary_histogram ->SetBinError(i-firstbin+1, hist_vec_380_CT_wO[i]->GetRMSError()*100.);
    h_380_CT_wO_DR07_E_JER_Mean_summary_histogram->SetBinContent(i-firstbin+1,hist_vec_380_CT_wO[i]->GetMean());
    h_380_CT_wO_DR07_E_JER_Mean_summary_histogram->SetBinError(i-firstbin+1,hist_vec_380_CT_wO[i]->GetMeanError());
    //double sided crystal ball
    TF1* fit_gaus_tmp = new TF1("fit_gaus_tmp", "gaus",0.50,1.50);
    hist_vec_380_CT_wO[i]->Fit("fit_gaus_tmp","R");
    hist_vec_380_CT_wO[i]->GetFunction("fit_gaus_tmp");

    TF1* fdscb_tmp = new TF1("fdscb_tmp",fnc_dscb,0.,3.,7);
   fdscb_tmp->SetNpx(1000);
    fdscb_tmp->SetParameter(0,fit_gaus_tmp->GetParameter(0));
    //norm
    fdscb_tmp->SetParLimits (0,0.5*fit_gaus_tmp->GetParameter(0),1.5*fit_gaus_tmp->GetParameter(0));
    fdscb_tmp->SetParameter(1,fit_gaus_tmp->GetParameter(1));
    //gaussian mean
    fdscb_tmp->SetParLimits (1,0.8,1.2);
    //fdscb_tmp->SetParameter(2,fit_gaus_tmp->GetParameter(2));
    //fdscb_tmp->SetParLimits(2,fit_gaus_tmp->GetParameter(2)*0.50,1.50*fit_gaus_tmp->GetParameter(2));
    std::vector<float>sigma2SFit=sigmaGaussianFits2Sigma(hist_vec_380_CT_wO[i]);
    fdscb_tmp->SetParameter(2,sigma2SFit[0]);
    fdscb_tmp->SetParLimits(2,sigma2SFit[0]*0.50,1.50*sigma2SFit[0]);
    //-a1: parameter, from when the gaussian core should count
    fdscb_tmp->SetParameter(2,fit_gaus_tmp->GetParameter(2));
    fdscb_tmp->SetParameter (3,3.0);
    fdscb_tmp->SetParLimits (3,0.0,10.0);
    //a2 parameter, up to when the gaussian core should count
    fdscb_tmp->SetParameter (5,3.0);
    fdscb_tmp->SetParLimits (5,0.0,10.0);
    fdscb_tmp->SetParameter(4,5.);
    fdscb_tmp->SetParLimits(4,0.,25.);
    fdscb_tmp->SetParameter(6,5.);
    fdscb_tmp->SetParLimits(6,0.,25.);
    int fitstatus(0); 
    fitstatus = hist_vec_380_CT_wO[i]->Fit(fdscb_tmp,"R");
    fdscb_tmp = hist_vec_380_CT_wO[i]->GetFunction("fdscb_tmp");
    h_380_CT_wO_DR07_E_SigmaCB_summary_histogram->SetBinContent(i-firstbin+1,fdscb_tmp->GetParameter(2)*100. );
    h_380_CT_wO_DR07_E_SigmaCB_summary_histogram->SetBinError(i-firstbin+1,fdscb_tmp->GetParError(2)*100. );
  }  
 std::cout<<"end DR07 wO 380"<<std::endl;
  TH1F* h_380_CT_wO_DR08_E_SigmaCB_summary_histogram=new TH1F("JER_SigmaCBVsCosTheta_CT_wO_DR08_380", "RMS_{90}(E_{j}^{reco}/E_{j}^{gen}) / Mean_{90}(E_{j}^{reco}/E_{j}^{gen}) vs |cos#theta|", nRegionBins, pRegionBinEdges);
  h_380_CT_wO_DR08_E_SigmaCB_summary_histogram ->SetYTitle("#sigma(E_{j}) / E_{j} [%]");
  h_380_CT_wO_DR08_E_SigmaCB_summary_histogram->SetXTitle("|cos#theta|");
  h_380_CT_wO_DR08_E_SigmaCB_summary_histogram->SetLineWidth(2);
  h_380_CT_wO_DR08_E_SigmaCB_summary_histogram->SetLineColor(kOrange);
  h_380_CT_wO_DR08_E_SigmaCB_summary_histogram->SetLineStyle(2);
  TH1F* h_380_CT_wO_DR08_E_RMS90_summary_histogram=new TH1F("JER_RMS90VsCosTheta_CT_wO_DR08_380", "RMS_{90}(E_{j}^{reco}/E_{j}^{gen}) / Mean_{90}(E_{j}^{reco}/E_{j}^{gen}) vs |cos#theta|", nRegionBins, pRegionBinEdges);
  h_380_CT_wO_DR08_E_RMS90_summary_histogram ->SetYTitle("RMS_{90}(E_{j}^{reco}/E_{j}^{gen}) / Mean_{90}(E_{j}^{reco}/E_{j}^{gen}) [%]");
  h_380_CT_wO_DR08_E_RMS90_summary_histogram->SetXTitle("|cos#theta|");
  h_380_CT_wO_DR08_E_RMS90_summary_histogram->SetLineWidth(2);
  h_380_CT_wO_DR08_E_RMS90_summary_histogram->SetLineColor(kRed);
  h_380_CT_wO_DR08_E_RMS90_summary_histogram->SetLineStyle(2);

  TH1F* h_380_CT_wO_DR08_E_RMS_summary_histogram=new TH1F("JER_RMSVsCosTheta_CT_wO_DR08_380", "RMS(E_{j}) / Mean(E_{j}) vs |cos#theta|", nRegionBins, pRegionBinEdges);
  h_380_CT_wO_DR08_E_RMS_summary_histogram ->SetYTitle("RMS(E_{j}) / Mean(E_{j}) [%]");
  h_380_CT_wO_DR08_E_RMS_summary_histogram->SetXTitle("|cos#theta|");
  h_380_CT_wO_DR08_E_RMS_summary_histogram->SetLineWidth(2);
  h_380_CT_wO_DR08_E_RMS_summary_histogram->SetLineColor(kRed);
  h_380_CT_wO_DR08_E_RMS_summary_histogram->SetLineStyle(2);

  TH1F* h_380_CT_wO_DR08_E_JER_Mean_summary_histogram=new TH1F("JER_MeanVsCosTheta_CT_wO_DR08_380", "Mean(E_{tot}^{RECO}/E_{tot}^{true}) vs |cos#theta|", nRegionBins, pRegionBinEdges);
  h_380_CT_wO_DR08_E_JER_Mean_summary_histogram->SetYTitle("Mean(E_{tot}^{RECO}/E_{tot}^{true})");
  h_380_CT_wO_DR08_E_JER_Mean_summary_histogram->SetXTitle("|cos#theta|");
  h_380_CT_wO_DR08_E_JER_Mean_summary_histogram->SetLineWidth(2);
  h_380_CT_wO_DR08_E_JER_Mean_summary_histogram->SetLineColor(kRed);
  h_380_CT_wO_DR08_E_JER_Mean_summary_histogram->SetLineStyle(2);
  firstbin=98;
  for(int i=firstbin;i<(firstbin+13);i++){
    //continue;
    resolutionTH1=0; 
    resolutionErrorTH1=0;
    meanTH1=0;
    meanErrorTH1=0;
    CalculatePerformance( hist_vec_380_CT_wO[i], resolutionTH1, resolutionErrorTH1,meanTH1,meanErrorTH1);
    h_380_CT_wO_DR08_E_RMS90_summary_histogram->SetBinContent(i-firstbin+1,resolutionTH1/sqrt(2.));
    h_380_CT_wO_DR08_E_RMS90_summary_histogram ->SetBinError(i-firstbin+1, resolutionErrorTH1/sqrt(2.));
    h_380_CT_wO_DR08_E_RMS_summary_histogram->SetBinContent(i-firstbin+1,hist_vec_380_CT_wO[i]->GetRMS()*100. );
    h_380_CT_wO_DR08_E_RMS_summary_histogram ->SetBinError(i-firstbin+1, hist_vec_380_CT_wO[i]->GetRMSError()*100.);
    h_380_CT_wO_DR08_E_JER_Mean_summary_histogram->SetBinContent(i-firstbin+1,hist_vec_380_CT_wO[i]->GetMean());
    h_380_CT_wO_DR08_E_JER_Mean_summary_histogram->SetBinError(i-firstbin+1,hist_vec_380_CT_wO[i]->GetMeanError());
    //double sided crystal ball
    TF1* fit_gaus_tmp = new TF1("fit_gaus_tmp", "gaus",0.50,1.50);
    hist_vec_380_CT_wO[i]->Fit("fit_gaus_tmp","R");
    hist_vec_380_CT_wO[i]->GetFunction("fit_gaus_tmp");

    TF1* fdscb_tmp = new TF1("fdscb_tmp",fnc_dscb,0.,3.,7);
   fdscb_tmp->SetNpx(1000);
    fdscb_tmp->SetParameter(0,fit_gaus_tmp->GetParameter(0));
    //norm
    fdscb_tmp->SetParLimits (0,0.5*fit_gaus_tmp->GetParameter(0),1.5*fit_gaus_tmp->GetParameter(0));
    fdscb_tmp->SetParameter(1,fit_gaus_tmp->GetParameter(1));
    //gaussian mean
    fdscb_tmp->SetParLimits (1,0.8,1.2);
    //fdscb_tmp->SetParameter(2,fit_gaus_tmp->GetParameter(2));
    //fdscb_tmp->SetParLimits(2,fit_gaus_tmp->GetParameter(2)*0.50,1.50*fit_gaus_tmp->GetParameter(2));
    std::vector<float>sigma2SFit=sigmaGaussianFits2Sigma(hist_vec_380_CT_wO[i]);
    fdscb_tmp->SetParameter(2,sigma2SFit[0]);
    fdscb_tmp->SetParLimits(2,sigma2SFit[0]*0.50,1.50*sigma2SFit[0]);
    //-a1: parameter, from when the gaussian core should count
    fdscb_tmp->SetParameter(2,fit_gaus_tmp->GetParameter(2));
    fdscb_tmp->SetParameter (3,3.0);
    fdscb_tmp->SetParLimits (3,0.0,10.0);
    //a2 parameter, up to when the gaussian core should count
    fdscb_tmp->SetParameter (5,3.0);
    fdscb_tmp->SetParLimits (5,0.0,10.0);
    fdscb_tmp->SetParameter(4,5.);
    fdscb_tmp->SetParLimits(4,0.,25.);
    fdscb_tmp->SetParameter(6,5.);
    fdscb_tmp->SetParLimits(6,0.,25.);
    int fitstatus(0); 
    fitstatus = hist_vec_380_CT_wO[i]->Fit(fdscb_tmp,"R");
    fdscb_tmp = hist_vec_380_CT_wO[i]->GetFunction("fdscb_tmp");
    h_380_CT_wO_DR08_E_SigmaCB_summary_histogram->SetBinContent(i-firstbin+1,fdscb_tmp->GetParameter(2)*100. );
    h_380_CT_wO_DR08_E_SigmaCB_summary_histogram->SetBinError(i-firstbin+1,fdscb_tmp->GetParError(2)*100. );
  }  
  TH1F* h_380_CT_wO_DR09_E_SigmaCB_summary_histogram=new TH1F("JER_SigmaCBVsCosTheta_CT_wO_DR09_380", "RMS_{90}(E_{j}^{reco}/E_{j}^{gen}) / Mean_{90}(E_{j}^{reco}/E_{j}^{gen}) vs |cos#theta|", nRegionBins, pRegionBinEdges);
  h_380_CT_wO_DR09_E_SigmaCB_summary_histogram ->SetYTitle("#sigma(E_{j}) / E_{j} [%]");
  h_380_CT_wO_DR09_E_SigmaCB_summary_histogram->SetXTitle("|cos#theta|");
  h_380_CT_wO_DR09_E_SigmaCB_summary_histogram->SetLineWidth(2);
  h_380_CT_wO_DR09_E_SigmaCB_summary_histogram->SetLineColor(kOrange);
  h_380_CT_wO_DR09_E_SigmaCB_summary_histogram->SetLineStyle(2);
  TH1F* h_380_CT_wO_DR09_E_RMS90_summary_histogram=new TH1F("JER_RMS90VsCosTheta_CT_wO_DR09_380", "RMS_{90}(E_{j}^{reco}/E_{j}^{gen}) / Mean_{90}(E_{j}^{reco}/E_{j}^{gen}) vs |cos#theta|", nRegionBins, pRegionBinEdges);
  h_380_CT_wO_DR09_E_RMS90_summary_histogram ->SetYTitle("RMS_{90}(E_{j}^{reco}/E_{j}^{gen}) / Mean_{90}(E_{j}^{reco}/E_{j}^{gen}) [%]");
  h_380_CT_wO_DR09_E_RMS90_summary_histogram->SetXTitle("|cos#theta|");
  h_380_CT_wO_DR09_E_RMS90_summary_histogram->SetLineWidth(2);
  h_380_CT_wO_DR09_E_RMS90_summary_histogram->SetLineColor(kRed);
  h_380_CT_wO_DR09_E_RMS90_summary_histogram->SetLineStyle(2);

  TH1F* h_380_CT_wO_DR09_E_RMS_summary_histogram=new TH1F("JER_RMSVsCosTheta_CT_wO_DR09_380", "RMS(E_{j}) / Mean(E_{j}) vs |cos#theta|", nRegionBins, pRegionBinEdges);
  h_380_CT_wO_DR09_E_RMS_summary_histogram ->SetYTitle("RMS(E_{j}) / Mean(E_{j}) [%]");
  h_380_CT_wO_DR09_E_RMS_summary_histogram->SetXTitle("|cos#theta|");
  h_380_CT_wO_DR09_E_RMS_summary_histogram->SetLineWidth(2);
  h_380_CT_wO_DR09_E_RMS_summary_histogram->SetLineColor(kRed);
  h_380_CT_wO_DR09_E_RMS_summary_histogram->SetLineStyle(2);

  TH1F* h_380_CT_wO_DR09_E_JER_Mean_summary_histogram=new TH1F("JER_MeanVsCosTheta_CT_wO_DR09_380", "Mean(E_{tot}^{RECO}/E_{tot}^{true}) vs |cos#theta|", nRegionBins, pRegionBinEdges);
  h_380_CT_wO_DR09_E_JER_Mean_summary_histogram->SetYTitle("Mean(E_{tot}^{RECO}/E_{tot}^{true})");
  h_380_CT_wO_DR09_E_JER_Mean_summary_histogram->SetXTitle("|cos#theta|");
  h_380_CT_wO_DR09_E_JER_Mean_summary_histogram->SetLineWidth(2);
  h_380_CT_wO_DR09_E_JER_Mean_summary_histogram->SetLineColor(kRed);
  h_380_CT_wO_DR09_E_JER_Mean_summary_histogram->SetLineStyle(2);
  firstbin=111;
  for(int i=firstbin;i<(firstbin+13);i++){
    //continue;
    resolutionTH1=0; 
    resolutionErrorTH1=0;
    meanTH1=0;
    meanErrorTH1=0;
    CalculatePerformance( hist_vec_380_CT_wO[i], resolutionTH1, resolutionErrorTH1,meanTH1,meanErrorTH1);
    h_380_CT_wO_DR09_E_RMS90_summary_histogram->SetBinContent(i-firstbin+1,resolutionTH1/sqrt(2.));
    h_380_CT_wO_DR09_E_RMS90_summary_histogram ->SetBinError(i-firstbin+1, resolutionErrorTH1/sqrt(2.));
    h_380_CT_wO_DR09_E_RMS_summary_histogram->SetBinContent(i-firstbin+1,hist_vec_380_CT_wO[i]->GetRMS()*100. );
    h_380_CT_wO_DR09_E_RMS_summary_histogram ->SetBinError(i-firstbin+1, hist_vec_380_CT_wO[i]->GetRMSError()*100.);
    h_380_CT_wO_DR09_E_JER_Mean_summary_histogram->SetBinContent(i-firstbin+1,hist_vec_380_CT_wO[i]->GetMean());
    h_380_CT_wO_DR09_E_JER_Mean_summary_histogram->SetBinError(i-firstbin+1,hist_vec_380_CT_wO[i]->GetMeanError());
    //double sided crystal ball
    TF1* fit_gaus_tmp = new TF1("fit_gaus_tmp", "gaus",0.50,1.50);
    hist_vec_380_CT_wO[i]->Fit("fit_gaus_tmp","R");
    hist_vec_380_CT_wO[i]->GetFunction("fit_gaus_tmp");

    TF1* fdscb_tmp = new TF1("fdscb_tmp",fnc_dscb,0.,3.,7);
   fdscb_tmp->SetNpx(1000);
    fdscb_tmp->SetParameter(0,fit_gaus_tmp->GetParameter(0));
    //norm
    fdscb_tmp->SetParLimits (0,0.5*fit_gaus_tmp->GetParameter(0),1.5*fit_gaus_tmp->GetParameter(0));
    fdscb_tmp->SetParameter(1,fit_gaus_tmp->GetParameter(1));
    //gaussian mean
    fdscb_tmp->SetParLimits (1,0.8,1.2);
    //fdscb_tmp->SetParameter(2,fit_gaus_tmp->GetParameter(2));
    //fdscb_tmp->SetParLimits(2,fit_gaus_tmp->GetParameter(2)*0.50,1.50*fit_gaus_tmp->GetParameter(2));
    std::vector<float>sigma2SFit=sigmaGaussianFits2Sigma(hist_vec_380_CT_wO[i]);
    fdscb_tmp->SetParameter(2,sigma2SFit[0]);
    fdscb_tmp->SetParLimits(2,sigma2SFit[0]*0.50,1.50*sigma2SFit[0]);
    //-a1: parameter, from when the gaussian core should count
    fdscb_tmp->SetParameter(2,fit_gaus_tmp->GetParameter(2));
    fdscb_tmp->SetParameter (3,3.0);
    fdscb_tmp->SetParLimits (3,0.0,10.0);
    //a2 parameter, up to when the gaussian core should count
    fdscb_tmp->SetParameter (5,3.0);
    fdscb_tmp->SetParLimits (5,0.0,10.0);
    fdscb_tmp->SetParameter(4,5.);
    fdscb_tmp->SetParLimits(4,0.,25.);
    fdscb_tmp->SetParameter(6,5.);
    fdscb_tmp->SetParLimits(6,0.,25.);
    int fitstatus(0); 
    fitstatus = hist_vec_380_CT_wO[i]->Fit(fdscb_tmp,"R");
    fdscb_tmp = hist_vec_380_CT_wO[i]->GetFunction("fdscb_tmp");
    h_380_CT_wO_DR09_E_SigmaCB_summary_histogram->SetBinContent(i-firstbin+1,fdscb_tmp->GetParameter(2)*100. );
    h_380_CT_wO_DR09_E_SigmaCB_summary_histogram->SetBinError(i-firstbin+1,fdscb_tmp->GetParError(2)*100. );
  }  
  TH1F* h_380_CT_wO_DR10_E_SigmaCB_summary_histogram=new TH1F("JER_SigmaCBVsCosTheta_CT_wO_DR10_380", "RMS_{90}(E_{j}^{reco}/E_{j}^{gen}) / Mean_{90}(E_{j}^{reco}/E_{j}^{gen}) vs |cos#theta|", nRegionBins, pRegionBinEdges);
  h_380_CT_wO_DR10_E_SigmaCB_summary_histogram ->SetYTitle("#sigma(E_{j}) / E_{j} [%]");
  h_380_CT_wO_DR10_E_SigmaCB_summary_histogram->SetXTitle("|cos#theta|");
  h_380_CT_wO_DR10_E_SigmaCB_summary_histogram->SetLineWidth(2);
  h_380_CT_wO_DR10_E_SigmaCB_summary_histogram->SetLineColor(kOrange);
  h_380_CT_wO_DR10_E_SigmaCB_summary_histogram->SetLineStyle(2);
  TH1F* h_380_CT_wO_DR10_E_RMS90_summary_histogram=new TH1F("JER_RMS90VsCosTheta_CT_wO_DR10_380", "RMS_{90}(E_{j}^{reco}/E_{j}^{gen}) / Mean_{90}(E_{j}^{reco}/E_{j}^{gen}) vs |cos#theta|", nRegionBins, pRegionBinEdges);
  h_380_CT_wO_DR10_E_RMS90_summary_histogram ->SetYTitle("RMS_{90}(E_{j}^{reco}/E_{j}^{gen}) / Mean_{90}(E_{j}^{reco}/E_{j}^{gen}) [%]");
  h_380_CT_wO_DR10_E_RMS90_summary_histogram->SetXTitle("|cos#theta|");
  h_380_CT_wO_DR10_E_RMS90_summary_histogram->SetLineWidth(2);
  h_380_CT_wO_DR10_E_RMS90_summary_histogram->SetLineColor(kRed);
  h_380_CT_wO_DR10_E_RMS90_summary_histogram->SetLineStyle(2);

  TH1F* h_380_CT_wO_DR10_E_RMS_summary_histogram=new TH1F("JER_RMSVsCosTheta_CT_wO_DR10_380", "RMS(E_{j}) / Mean(E_{j}) vs |cos#theta|", nRegionBins, pRegionBinEdges);
  h_380_CT_wO_DR10_E_RMS_summary_histogram ->SetYTitle("RMS(E_{j}) / Mean(E_{j}) [%]");
  h_380_CT_wO_DR10_E_RMS_summary_histogram->SetXTitle("|cos#theta|");
  h_380_CT_wO_DR10_E_RMS_summary_histogram->SetLineWidth(2);
  h_380_CT_wO_DR10_E_RMS_summary_histogram->SetLineColor(kRed);
  h_380_CT_wO_DR10_E_RMS_summary_histogram->SetLineStyle(2);

  TH1F* h_380_CT_wO_DR10_E_JER_Mean_summary_histogram=new TH1F("JER_MeanVsCosTheta_CT_wO_DR10_380", "Mean(E_{tot}^{RECO}/E_{tot}^{true}) vs |cos#theta|", nRegionBins, pRegionBinEdges);
  h_380_CT_wO_DR10_E_JER_Mean_summary_histogram->SetYTitle("Mean(E_{tot}^{RECO}/E_{tot}^{true})");
  h_380_CT_wO_DR10_E_JER_Mean_summary_histogram->SetXTitle("|cos#theta|");
  h_380_CT_wO_DR10_E_JER_Mean_summary_histogram->SetLineWidth(2);
  h_380_CT_wO_DR10_E_JER_Mean_summary_histogram->SetLineColor(kRed);
  h_380_CT_wO_DR10_E_JER_Mean_summary_histogram->SetLineStyle(2);
  firstbin=124;
  for(int i=firstbin;i<(firstbin+13);i++){
    //continue;
    resolutionTH1=0; 
    resolutionErrorTH1=0;
    meanTH1=0;
    meanErrorTH1=0;
    CalculatePerformance( hist_vec_380_CT_wO[i], resolutionTH1, resolutionErrorTH1,meanTH1,meanErrorTH1);
    h_380_CT_wO_DR10_E_RMS90_summary_histogram->SetBinContent(i-firstbin+1,resolutionTH1/sqrt(2.));
    h_380_CT_wO_DR10_E_RMS90_summary_histogram ->SetBinError(i-firstbin+1, resolutionErrorTH1/sqrt(2.));
    h_380_CT_wO_DR10_E_RMS_summary_histogram->SetBinContent(i-firstbin+1,hist_vec_380_CT_wO[i]->GetRMS()*100. );
    h_380_CT_wO_DR10_E_RMS_summary_histogram ->SetBinError(i-firstbin+1, hist_vec_380_CT_wO[i]->GetRMSError()*100.);
    h_380_CT_wO_DR10_E_JER_Mean_summary_histogram->SetBinContent(i-firstbin+1,hist_vec_380_CT_wO[i]->GetMean());
    h_380_CT_wO_DR10_E_JER_Mean_summary_histogram->SetBinError(i-firstbin+1,hist_vec_380_CT_wO[i]->GetMeanError());
    //double sided crystal ball
    TF1* fit_gaus_tmp = new TF1("fit_gaus_tmp", "gaus",0.50,1.50);
    hist_vec_380_CT_wO[i]->Fit("fit_gaus_tmp","R");
    hist_vec_380_CT_wO[i]->GetFunction("fit_gaus_tmp");

    TF1* fdscb_tmp = new TF1("fdscb_tmp",fnc_dscb,0.,3.,7);
   fdscb_tmp->SetNpx(1000);
    fdscb_tmp->SetParameter(0,fit_gaus_tmp->GetParameter(0));
    //norm
    fdscb_tmp->SetParLimits (0,0.5*fit_gaus_tmp->GetParameter(0),1.5*fit_gaus_tmp->GetParameter(0));
    fdscb_tmp->SetParameter(1,fit_gaus_tmp->GetParameter(1));
    //gaussian mean
    fdscb_tmp->SetParLimits (1,0.8,1.2);
    //fdscb_tmp->SetParameter(2,fit_gaus_tmp->GetParameter(2));
    //fdscb_tmp->SetParLimits(2,fit_gaus_tmp->GetParameter(2)*0.50,1.50*fit_gaus_tmp->GetParameter(2));
    std::vector<float>sigma2SFit=sigmaGaussianFits2Sigma(hist_vec_380_CT_wO[i]);
    fdscb_tmp->SetParameter(2,sigma2SFit[0]);
    fdscb_tmp->SetParLimits(2,sigma2SFit[0]*0.50,1.50*sigma2SFit[0]);
    //-a1: parameter, from when the gaussian core should count
    fdscb_tmp->SetParameter(2,fit_gaus_tmp->GetParameter(2));
    fdscb_tmp->SetParameter (3,3.0);
    fdscb_tmp->SetParLimits (3,0.0,10.0);
    //a2 parameter, up to when the gaussian core should count
    fdscb_tmp->SetParameter (5,3.0);
    fdscb_tmp->SetParLimits (5,0.0,10.0);
    fdscb_tmp->SetParameter(4,5.);
    fdscb_tmp->SetParLimits(4,0.,25.);
    fdscb_tmp->SetParameter(6,5.);
    fdscb_tmp->SetParLimits(6,0.,25.);
    int fitstatus(0); 
    fitstatus = hist_vec_380_CT_wO[i]->Fit(fdscb_tmp,"R");
    fdscb_tmp = hist_vec_380_CT_wO[i]->GetFunction("fdscb_tmp");
    h_380_CT_wO_DR10_E_SigmaCB_summary_histogram->SetBinContent(i-firstbin+1,fdscb_tmp->GetParameter(2)*100. );
    h_380_CT_wO_DR10_E_SigmaCB_summary_histogram->SetBinError(i-firstbin+1,fdscb_tmp->GetParError(2)*100. );
  }  

  std::cout<<"380 wO 03/04/05/06 "<< calculate_over90(h_380_CT_wO_recojet03_E1_E2_over_E_True)<<"/"<< calculate_over90(h_380_CT_wO_recojet04_E1_E2_over_E_True)<<"/"<< calculate_over90(h_380_CT_wO_recojet05_E1_E2_over_E_True)<<"/"<<calculate_over90(h_380_CT_wO_recojet06_E1_E2_over_E_True)<<" 07/08/09/10 "<< calculate_over90(h_380_CT_wO_recojet07_E1_E2_over_E_True)<<"/"<< calculate_over90(h_380_CT_wO_recojet08_E1_E2_over_E_True)<<"/"<< calculate_over90(h_380_CT_wO_recojet09_E1_E2_over_E_True)<<"/"<<calculate_over90(h_380_CT_wO_recojet10_E1_E2_over_E_True)<<std::endl;
  std::cout<<"jet histos 380 CT_wO filled"<<std::endl;

  TH1F* h_500_CT_genjet03_dphi_j1j2 =  new TH1F("h_500_CT_genjet03_dphi_j1j2","", n_bins100, 0.5,TMath::Pi());
  TH1F* h_500_CT_genjet03_E1_E2_over_E_True =  new TH1F("h_500_CT_genjet03_E1_E2_over_E_True","", n_bins100, 0.5,1.00);
  TH1F* h_500_CT_genjet03_Delta_E1_E2_over_E12 =  new TH1F("h_500_CT_genjet03_Delta_E1_E2_over_E12","", n_bins100, -0.5,0.5);
  TH1F* h_500_CT_genjet04_dphi_j1j2 =  new TH1F("h_500_CT_genjet04_dphi_j1j2","", n_bins100, 0.5,TMath::Pi());
  TH1F* h_500_CT_genjet04_E1_E2_over_E_True =  new TH1F("h_500_CT_genjet04_E1_E2_over_E_True","", n_bins100, 0.5,1.00);
  TH1F* h_500_CT_genjet04_Delta_E1_E2_over_E12 =  new TH1F("h_500_CT_genjet04_Delta_E1_E2_over_E12","", n_bins100, -0.5,0.5);
  TH1F* h_500_CT_genjet05_dphi_j1j2 =  new TH1F("h_500_CT_genjet05_dphi_j1j2","", n_bins100, 0.5,TMath::Pi());
  TH1F* h_500_CT_genjet05_E1_E2_over_E_True =  new TH1F("h_500_CT_genjet05_E1_E2_over_E_True","", n_bins100, 0.5,1.00);
  TH1F* h_500_CT_genjet05_Delta_E1_E2_over_E12 =  new TH1F("h_500_CT_genjet05_Delta_E1_E2_over_E12","", n_bins100, -0.5,0.5);
  TH1F* h_500_CT_genjet06_dphi_j1j2 =  new TH1F("h_500_CT_genjet06_dphi_j1j2","", n_bins100, 0.5,TMath::Pi());
  TH1F* h_500_CT_genjet06_E1_E2_over_E_True =  new TH1F("h_500_CT_genjet06_E1_E2_over_E_True","", n_bins100, 0.5,1.00);
  TH1F* h_500_CT_genjet06_Delta_E1_E2_over_E12 =  new TH1F("h_500_CT_genjet06_Delta_E1_E2_over_E12","", n_bins100, -0.5,0.5);
  TH1F* h_500_CT_genjet07_dphi_j1j2 =  new TH1F("h_500_CT_genjet07_dphi_j1j2","", n_bins100, 0.5,TMath::Pi());
  TH1F* h_500_CT_genjet07_E1_E2_over_E_True =  new TH1F("h_500_CT_genjet07_E1_E2_over_E_True","", n_bins100, 0.5,1.00);
  TH1F* h_500_CT_genjet07_Delta_E1_E2_over_E12 =  new TH1F("h_500_CT_genjet07_Delta_E1_E2_over_E12","", n_bins100, -0.5,0.5);
  TH1F* h_500_CT_genjet08_dphi_j1j2 =  new TH1F("h_500_CT_genjet08_dphi_j1j2","", n_bins100, 0.5,TMath::Pi());
  TH1F* h_500_CT_genjet08_E1_E2_over_E_True =  new TH1F("h_500_CT_genjet08_E1_E2_over_E_True","", n_bins100, 0.5,1.00);
  TH1F* h_500_CT_genjet08_Delta_E1_E2_over_E12 =  new TH1F("h_500_CT_genjet08_Delta_E1_E2_over_E12","", n_bins100, -0.5,0.5);
  TH1F* h_500_CT_genjet09_dphi_j1j2 =  new TH1F("h_500_CT_genjet09_dphi_j1j2","", n_bins100, 0.5,TMath::Pi());
  TH1F* h_500_CT_genjet09_E1_E2_over_E_True =  new TH1F("h_500_CT_genjet09_E1_E2_over_E_True","", n_bins100, 0.5,1.00);
  TH1F* h_500_CT_genjet09_Delta_E1_E2_over_E12 =  new TH1F("h_500_CT_genjet09_Delta_E1_E2_over_E12","", n_bins100, -0.5,0.5);
  TH1F* h_500_CT_genjet10_dphi_j1j2 =  new TH1F("h_500_CT_genjet10_dphi_j1j2","", n_bins100, 0.5,TMath::Pi());
  TH1F* h_500_CT_genjet10_E1_E2_over_E_True =  new TH1F("h_500_CT_genjet10_E1_E2_over_E_True","", n_bins100, 0.5,1.00);
  TH1F* h_500_CT_genjet10_Delta_E1_E2_over_E12 =  new TH1F("h_500_CT_genjet10_Delta_E1_E2_over_E12","", n_bins100, -0.5,0.5);

  TH1F* h_500_CT_recojet03_dphi_j1j2 =  new TH1F("h_500_CT_recojet03_dphi_j1j2","", n_bins100, 0.5,TMath::Pi());
  TH1F* h_500_CT_recojet03_E1_E2_over_E_True =  new TH1F("h_500_CT_recojet03_E1_E2_over_E_True","", n_bins100, 0.5,1.00);
  TH1F* h_500_CT_recojet03_Delta_E1_E2_over_E12 =  new TH1F("h_500_CT_recojet03_Delta_E1_E2_over_E12","", n_bins100, -0.5,0.5);
  TH1F* h_500_CT_recojet04_dphi_j1j2 =  new TH1F("h_500_CT_recojet04_dphi_j1j2","", n_bins100, 0.5,TMath::Pi());
  TH1F* h_500_CT_recojet04_E1_E2_over_E_True =  new TH1F("h_500_CT_recojet04_E1_E2_over_E_True","", n_bins100, 0.5,1.00);
  TH1F* h_500_CT_recojet04_Delta_E1_E2_over_E12 =  new TH1F("h_500_CT_recojet04_Delta_E1_E2_over_E12","", n_bins100, -0.5,0.5);
  TH1F* h_500_CT_recojet05_dphi_j1j2 =  new TH1F("h_500_CT_recojet05_dphi_j1j2","", n_bins100, 0.5,TMath::Pi());
  TH1F* h_500_CT_recojet05_E1_E2_over_E_True =  new TH1F("h_500_CT_recojet05_E1_E2_over_E_True","", n_bins100, 0.5,1.00);
  TH1F* h_500_CT_recojet05_Delta_E1_E2_over_E12 =  new TH1F("h_500_CT_recojet05_Delta_E1_E2_over_E12","", n_bins100, -0.5,0.5);
  TH1F* h_500_CT_recojet06_dphi_j1j2 =  new TH1F("h_500_CT_recojet06_dphi_j1j2","", n_bins100, 0.5,TMath::Pi());
  TH1F* h_500_CT_recojet06_E1_E2_over_E_True =  new TH1F("h_500_CT_recojet06_E1_E2_over_E_True","", n_bins100, 0.5,1.00);
  TH1F* h_500_CT_recojet06_Delta_E1_E2_over_E12 =  new TH1F("h_500_CT_recojet06_Delta_E1_E2_over_E12","", n_bins100, -0.5,0.5);
  TH1F* h_500_CT_recojet07_dphi_j1j2 =  new TH1F("h_500_CT_recojet07_dphi_j1j2","", n_bins100, 0.5,TMath::Pi());
  TH1F* h_500_CT_recojet07_E1_E2_over_E_True =  new TH1F("h_500_CT_recojet07_E1_E2_over_E_True","", n_bins100, 0.5,1.00);
  TH1F* h_500_CT_recojet07_Delta_E1_E2_over_E12 =  new TH1F("h_500_CT_recojet07_Delta_E1_E2_over_E12","", n_bins100, -0.5,0.5);
  TH1F* h_500_CT_recojet08_dphi_j1j2 =  new TH1F("h_500_CT_recojet08_dphi_j1j2","", n_bins100, 0.5,TMath::Pi());
  TH1F* h_500_CT_recojet08_E1_E2_over_E_True =  new TH1F("h_500_CT_recojet08_E1_E2_over_E_True","", n_bins100, 0.5,1.00);
  TH1F* h_500_CT_recojet08_Delta_E1_E2_over_E12 =  new TH1F("h_500_CT_recojet08_Delta_E1_E2_over_E12","", n_bins100, -0.5,0.5);
  TH1F* h_500_CT_recojet09_dphi_j1j2 =  new TH1F("h_500_CT_recojet09_dphi_j1j2","", n_bins100, 0.5,TMath::Pi());
  TH1F* h_500_CT_recojet09_E1_E2_over_E_True =  new TH1F("h_500_CT_recojet09_E1_E2_over_E_True","", n_bins100, 0.5,1.00);
  TH1F* h_500_CT_recojet09_Delta_E1_E2_over_E12 =  new TH1F("h_500_CT_recojet09_Delta_E1_E2_over_E12","", n_bins100, -0.5,0.5);
  TH1F* h_500_CT_recojet10_dphi_j1j2 =  new TH1F("h_500_CT_recojet10_dphi_j1j2","", n_bins100, 0.5,TMath::Pi());
  TH1F* h_500_CT_recojet10_E1_E2_over_E_True =  new TH1F("h_500_CT_recojet10_E1_E2_over_E_True","", n_bins100, 0.5,1.00);
  TH1F* h_500_CT_recojet10_Delta_E1_E2_over_E12 =  new TH1F("h_500_CT_recojet10_Delta_E1_E2_over_E12","", n_bins100, -0.5,0.5);

  TH1F* h_500_CT_recojetE_over_genjetE_DR03 =  new TH1F("h_500_CT_recojetE_over_genjetE_DR03","", n_bins100, 0.5,1.5);
  TH1F* h_500_CT_recojetE_over_genjetE_DR04 =  new TH1F("h_500_CT_recojetE_over_genjetE_DR04","", n_bins100, 0.5,1.5);
  TH1F* h_500_CT_recojetE_over_genjetE_DR05 =  new TH1F("h_500_CT_recojetE_over_genjetE_DR05","", n_bins100, 0.5,1.5);
  TH1F* h_500_CT_recojetE_over_genjetE_DR06 =  new TH1F("h_500_CT_recojetE_over_genjetE_DR06","", n_bins100, 0.5,1.5);
  TH1F* h_500_CT_recojetE_over_genjetE_DR07 =  new TH1F("h_500_CT_recojetE_over_genjetE_DR07","", n_bins100, 0.5,1.5);
  TH1F* h_500_CT_recojetE_over_genjetE_DR08 =  new TH1F("h_500_CT_recojetE_over_genjetE_DR08","", n_bins100, 0.5,1.5);
  TH1F* h_500_CT_recojetE_over_genjetE_DR09 =  new TH1F("h_500_CT_recojetE_over_genjetE_DR09","", n_bins100, 0.5,1.5);
  TH1F* h_500_CT_recojetE_over_genjetE_DR10 =  new TH1F("h_500_CT_recojetE_over_genjetE_DR10","", n_bins100, 0.5,1.5);

  TH1F* h_500_CT_dphi_gen_reco_DR05 =  new TH1F("h_500_CT_dphi_gen_reco_DR05","", n_bins100, -0.1,9.9);
  TH1F* h_500_CT_dphi_gen_reco_DR06 =  new TH1F("h_500_CT_dphi_gen_reco_DR06","", n_bins100, -0.1,9.9);
  TH1F* h_500_CT_dphi_gen_reco_DR07 =  new TH1F("h_500_CT_dphi_gen_reco_DR07","", n_bins100, -0.1,9.9);

  TH1F* h_500_CT_DR05_E_rel_totVis_RMS_d1_cosT_0_to_0_10 =  new TH1F("h_500_CT_DR05_E_rel_totVis_RMS_d1_cosT_0_to_0_10","", n_binsJER, lim_E_rel_low,lim_E_rel_high);
  TH1F* h_500_CT_DR05_E_rel_totVis_RMS_d1_cosT_0_10_to_0_20 =  new TH1F("h_500_CT_DR05_E_rel_totVis_RMS_d1_cosT_0_10_to_0_20","", n_binsJER, lim_E_rel_low,lim_E_rel_high);
  TH1F* h_500_CT_DR05_E_rel_totVis_RMS_d1_cosT_0_20_to_0_30 =  new TH1F("h_500_CT_DR05_E_rel_totVis_RMS_d1_cosT_0_20_to_0_30","", n_binsJER, lim_E_rel_low,lim_E_rel_high);
  TH1F* h_500_CT_DR05_E_rel_totVis_RMS_d1_cosT_0_30_to_0_40 =  new TH1F("h_500_CT_DR05_E_rel_totVis_RMS_d1_cosT_0_30_to_0_40","", n_binsJER, lim_E_rel_low,lim_E_rel_high);
  TH1F* h_500_CT_DR05_E_rel_totVis_RMS_d1_cosT_0_40_to_0_50 =  new TH1F("h_500_CT_DR05_E_rel_totVis_RMS_d1_cosT_0_40_to_0_50","", n_binsJER, lim_E_rel_low,lim_E_rel_high);
  TH1F* h_500_CT_DR05_E_rel_totVis_RMS_d1_cosT_0_50_to_0_60 =  new TH1F("h_500_CT_DR05_E_rel_totVis_RMS_d1_cosT_0_50_to_0_60","", n_binsJER, lim_E_rel_low,lim_E_rel_high);
  TH1F* h_500_CT_DR05_E_rel_totVis_RMS_d1_cosT_0_60_to_0_70 =  new TH1F("h_500_CT_DR05_E_rel_totVis_RMS_d1_cosT_0_60_to_0_70","", n_binsJER, lim_E_rel_low,lim_E_rel_high);
  TH1F* h_500_CT_DR05_E_rel_totVis_RMS_d1_cosT_0_70_to_0_80 =  new TH1F("h_500_CT_DR05_E_rel_totVis_RMS_d1_cosT_0_70_to_0_80","", n_binsJER, lim_E_rel_low,lim_E_rel_high);
  TH1F* h_500_CT_DR05_E_rel_totVis_RMS_d1_cosT_0_80_to_0_90 =  new TH1F("h_500_CT_DR05_E_rel_totVis_RMS_d1_cosT_0_80_to_0_90","", n_binsJER, lim_E_rel_low,lim_E_rel_high);
  TH1F* h_500_CT_DR05_E_rel_totVis_RMS_d1_cosT_0_900_to_0_925 =  new TH1F("h_500_CT_DR05_E_rel_totVis_RMS_d1_cosT_0_900_to_0_925","", n_binsJER, lim_E_rel_low,lim_E_rel_high);
  TH1F* h_500_CT_DR05_E_rel_totVis_RMS_d1_cosT_0_925_to_0_950 =  new TH1F("h_500_CT_DR05_E_rel_totVis_RMS_d1_cosT_0_925_to_0_950","", n_binsJER, lim_E_rel_low,lim_E_rel_high);
  TH1F* h_500_CT_DR05_E_rel_totVis_RMS_d1_cosT_0_950_to_0_975 =  new TH1F("h_500_CT_DR05_E_rel_totVis_RMS_d1_cosT_0_950_to_0_975","", n_binsJER, lim_E_rel_low,lim_E_rel_high);
  TH1F* h_500_CT_DR05_E_rel_totVis_RMS_d1_cosT_0_975_to_1_00 =  new TH1F("h_500_CT_DR05_E_rel_totVis_RMS_d1_cosT_0_975_to_1_00","", n_binsJER, lim_E_rel_low,lim_E_rel_high);

  TH1F* h_500_CT_DR06_E_rel_totVis_RMS_d1_cosT_0_to_0_10 =  new TH1F("h_500_CT_DR06_E_rel_totVis_RMS_d1_cosT_0_to_0_10","", n_binsJER, lim_E_rel_low,lim_E_rel_high);
  TH1F* h_500_CT_DR06_E_rel_totVis_RMS_d1_cosT_0_10_to_0_20 =  new TH1F("h_500_CT_DR06_E_rel_totVis_RMS_d1_cosT_0_10_to_0_20","", n_binsJER, lim_E_rel_low,lim_E_rel_high);
  TH1F* h_500_CT_DR06_E_rel_totVis_RMS_d1_cosT_0_20_to_0_30 =  new TH1F("h_500_CT_DR06_E_rel_totVis_RMS_d1_cosT_0_20_to_0_30","", n_binsJER, lim_E_rel_low,lim_E_rel_high);
  TH1F* h_500_CT_DR06_E_rel_totVis_RMS_d1_cosT_0_30_to_0_40 =  new TH1F("h_500_CT_DR06_E_rel_totVis_RMS_d1_cosT_0_30_to_0_40","", n_binsJER, lim_E_rel_low,lim_E_rel_high);
  TH1F* h_500_CT_DR06_E_rel_totVis_RMS_d1_cosT_0_40_to_0_50 =  new TH1F("h_500_CT_DR06_E_rel_totVis_RMS_d1_cosT_0_40_to_0_50","", n_binsJER, lim_E_rel_low,lim_E_rel_high);
  TH1F* h_500_CT_DR06_E_rel_totVis_RMS_d1_cosT_0_50_to_0_60 =  new TH1F("h_500_CT_DR06_E_rel_totVis_RMS_d1_cosT_0_50_to_0_60","", n_binsJER, lim_E_rel_low,lim_E_rel_high);
  TH1F* h_500_CT_DR06_E_rel_totVis_RMS_d1_cosT_0_60_to_0_70 =  new TH1F("h_500_CT_DR06_E_rel_totVis_RMS_d1_cosT_0_60_to_0_70","", n_binsJER, lim_E_rel_low,lim_E_rel_high);
  TH1F* h_500_CT_DR06_E_rel_totVis_RMS_d1_cosT_0_70_to_0_80 =  new TH1F("h_500_CT_DR06_E_rel_totVis_RMS_d1_cosT_0_70_to_0_80","", n_binsJER, lim_E_rel_low,lim_E_rel_high);
  TH1F* h_500_CT_DR06_E_rel_totVis_RMS_d1_cosT_0_80_to_0_90 =  new TH1F("h_500_CT_DR06_E_rel_totVis_RMS_d1_cosT_0_80_to_0_90","", n_binsJER, lim_E_rel_low,lim_E_rel_high);
  TH1F* h_500_CT_DR06_E_rel_totVis_RMS_d1_cosT_0_900_to_0_925 =  new TH1F("h_500_CT_DR06_E_rel_totVis_RMS_d1_cosT_0_900_to_0_925","", n_binsJER, lim_E_rel_low,lim_E_rel_high);
  TH1F* h_500_CT_DR06_E_rel_totVis_RMS_d1_cosT_0_925_to_0_950 =  new TH1F("h_500_CT_DR06_E_rel_totVis_RMS_d1_cosT_0_925_to_0_950","", n_binsJER, lim_E_rel_low,lim_E_rel_high);
  TH1F* h_500_CT_DR06_E_rel_totVis_RMS_d1_cosT_0_950_to_0_975 =  new TH1F("h_500_CT_DR06_E_rel_totVis_RMS_d1_cosT_0_950_to_0_975","", n_binsJER, lim_E_rel_low,lim_E_rel_high);
  TH1F* h_500_CT_DR06_E_rel_totVis_RMS_d1_cosT_0_975_to_1_00 =  new TH1F("h_500_CT_DR06_E_rel_totVis_RMS_d1_cosT_0_975_to_1_00","", n_binsJER, lim_E_rel_low,lim_E_rel_high);

  TH1F* h_500_CT_DR07_E_rel_totVis_RMS_d1_cosT_0_to_0_10 =  new TH1F("h_500_CT_DR07_E_rel_totVis_RMS_d1_cosT_0_to_0_10","", n_binsJER, lim_E_rel_low,lim_E_rel_high);
  TH1F* h_500_CT_DR07_E_rel_totVis_RMS_d1_cosT_0_10_to_0_20 =  new TH1F("h_500_CT_DR07_E_rel_totVis_RMS_d1_cosT_0_10_to_0_20","", n_binsJER, lim_E_rel_low,lim_E_rel_high);
  TH1F* h_500_CT_DR07_E_rel_totVis_RMS_d1_cosT_0_20_to_0_30 =  new TH1F("h_500_CT_DR07_E_rel_totVis_RMS_d1_cosT_0_20_to_0_30","", n_binsJER, lim_E_rel_low,lim_E_rel_high);
  TH1F* h_500_CT_DR07_E_rel_totVis_RMS_d1_cosT_0_30_to_0_40 =  new TH1F("h_500_CT_DR07_E_rel_totVis_RMS_d1_cosT_0_30_to_0_40","", n_binsJER, lim_E_rel_low,lim_E_rel_high);
  TH1F* h_500_CT_DR07_E_rel_totVis_RMS_d1_cosT_0_40_to_0_50 =  new TH1F("h_500_CT_DR07_E_rel_totVis_RMS_d1_cosT_0_40_to_0_50","", n_binsJER, lim_E_rel_low,lim_E_rel_high);
  TH1F* h_500_CT_DR07_E_rel_totVis_RMS_d1_cosT_0_50_to_0_60 =  new TH1F("h_500_CT_DR07_E_rel_totVis_RMS_d1_cosT_0_50_to_0_60","", n_binsJER, lim_E_rel_low,lim_E_rel_high);
  TH1F* h_500_CT_DR07_E_rel_totVis_RMS_d1_cosT_0_60_to_0_70 =  new TH1F("h_500_CT_DR07_E_rel_totVis_RMS_d1_cosT_0_60_to_0_70","", n_binsJER, lim_E_rel_low,lim_E_rel_high);
  TH1F* h_500_CT_DR07_E_rel_totVis_RMS_d1_cosT_0_70_to_0_80 =  new TH1F("h_500_CT_DR07_E_rel_totVis_RMS_d1_cosT_0_70_to_0_80","", n_binsJER, lim_E_rel_low,lim_E_rel_high);
  TH1F* h_500_CT_DR07_E_rel_totVis_RMS_d1_cosT_0_80_to_0_90 =  new TH1F("h_500_CT_DR07_E_rel_totVis_RMS_d1_cosT_0_80_to_0_90","", n_binsJER, lim_E_rel_low,lim_E_rel_high);
  TH1F* h_500_CT_DR07_E_rel_totVis_RMS_d1_cosT_0_900_to_0_925 =  new TH1F("h_500_CT_DR07_E_rel_totVis_RMS_d1_cosT_0_900_to_0_925","", n_binsJER, lim_E_rel_low,lim_E_rel_high);
  TH1F* h_500_CT_DR07_E_rel_totVis_RMS_d1_cosT_0_925_to_0_950 =  new TH1F("h_500_CT_DR07_E_rel_totVis_RMS_d1_cosT_0_925_to_0_950","", n_binsJER, lim_E_rel_low,lim_E_rel_high);
  TH1F* h_500_CT_DR07_E_rel_totVis_RMS_d1_cosT_0_950_to_0_975 =  new TH1F("h_500_CT_DR07_E_rel_totVis_RMS_d1_cosT_0_950_to_0_975","", n_binsJER, lim_E_rel_low,lim_E_rel_high);
  TH1F* h_500_CT_DR07_E_rel_totVis_RMS_d1_cosT_0_975_to_1_00 =  new TH1F("h_500_CT_DR07_E_rel_totVis_RMS_d1_cosT_0_975_to_1_00","", n_binsJER, lim_E_rel_low,lim_E_rel_high);

  TH1F* h_500_CT_DR08_E_rel_totVis_RMS_d1_cosT_0_to_0_10 =  new TH1F("h_500_CT_DR08_E_rel_totVis_RMS_d1_cosT_0_to_0_10","", n_binsJER, lim_E_rel_low,lim_E_rel_high);
  TH1F* h_500_CT_DR08_E_rel_totVis_RMS_d1_cosT_0_10_to_0_20 =  new TH1F("h_500_CT_DR08_E_rel_totVis_RMS_d1_cosT_0_10_to_0_20","", n_binsJER, lim_E_rel_low,lim_E_rel_high);
  TH1F* h_500_CT_DR08_E_rel_totVis_RMS_d1_cosT_0_20_to_0_30 =  new TH1F("h_500_CT_DR08_E_rel_totVis_RMS_d1_cosT_0_20_to_0_30","", n_binsJER, lim_E_rel_low,lim_E_rel_high);
  TH1F* h_500_CT_DR08_E_rel_totVis_RMS_d1_cosT_0_30_to_0_40 =  new TH1F("h_500_CT_DR08_E_rel_totVis_RMS_d1_cosT_0_30_to_0_40","", n_binsJER, lim_E_rel_low,lim_E_rel_high);
  TH1F* h_500_CT_DR08_E_rel_totVis_RMS_d1_cosT_0_40_to_0_50 =  new TH1F("h_500_CT_DR08_E_rel_totVis_RMS_d1_cosT_0_40_to_0_50","", n_binsJER, lim_E_rel_low,lim_E_rel_high);
  TH1F* h_500_CT_DR08_E_rel_totVis_RMS_d1_cosT_0_50_to_0_60 =  new TH1F("h_500_CT_DR08_E_rel_totVis_RMS_d1_cosT_0_50_to_0_60","", n_binsJER, lim_E_rel_low,lim_E_rel_high);
  TH1F* h_500_CT_DR08_E_rel_totVis_RMS_d1_cosT_0_60_to_0_70 =  new TH1F("h_500_CT_DR08_E_rel_totVis_RMS_d1_cosT_0_60_to_0_70","", n_binsJER, lim_E_rel_low,lim_E_rel_high);
  TH1F* h_500_CT_DR08_E_rel_totVis_RMS_d1_cosT_0_70_to_0_80 =  new TH1F("h_500_CT_DR08_E_rel_totVis_RMS_d1_cosT_0_70_to_0_80","", n_binsJER, lim_E_rel_low,lim_E_rel_high);
  TH1F* h_500_CT_DR08_E_rel_totVis_RMS_d1_cosT_0_80_to_0_90 =  new TH1F("h_500_CT_DR08_E_rel_totVis_RMS_d1_cosT_0_80_to_0_90","", n_binsJER, lim_E_rel_low,lim_E_rel_high);
  TH1F* h_500_CT_DR08_E_rel_totVis_RMS_d1_cosT_0_900_to_0_925 =  new TH1F("h_500_CT_DR08_E_rel_totVis_RMS_d1_cosT_0_900_to_0_925","", n_binsJER, lim_E_rel_low,lim_E_rel_high);
  TH1F* h_500_CT_DR08_E_rel_totVis_RMS_d1_cosT_0_925_to_0_950 =  new TH1F("h_500_CT_DR08_E_rel_totVis_RMS_d1_cosT_0_925_to_0_950","", n_binsJER, lim_E_rel_low,lim_E_rel_high);
  TH1F* h_500_CT_DR08_E_rel_totVis_RMS_d1_cosT_0_950_to_0_975 =  new TH1F("h_500_CT_DR08_E_rel_totVis_RMS_d1_cosT_0_950_to_0_975","", n_binsJER, lim_E_rel_low,lim_E_rel_high);
  TH1F* h_500_CT_DR08_E_rel_totVis_RMS_d1_cosT_0_975_to_1_00 =  new TH1F("h_500_CT_DR08_E_rel_totVis_RMS_d1_cosT_0_975_to_1_00","", n_binsJER, lim_E_rel_low,lim_E_rel_high);

  TH1F* h_500_CT_DR09_E_rel_totVis_RMS_d1_cosT_0_to_0_10 =  new TH1F("h_500_CT_DR09_E_rel_totVis_RMS_d1_cosT_0_to_0_10","", n_binsJER, lim_E_rel_low,lim_E_rel_high);
  TH1F* h_500_CT_DR09_E_rel_totVis_RMS_d1_cosT_0_10_to_0_20 =  new TH1F("h_500_CT_DR09_E_rel_totVis_RMS_d1_cosT_0_10_to_0_20","", n_binsJER, lim_E_rel_low,lim_E_rel_high);
  TH1F* h_500_CT_DR09_E_rel_totVis_RMS_d1_cosT_0_20_to_0_30 =  new TH1F("h_500_CT_DR09_E_rel_totVis_RMS_d1_cosT_0_20_to_0_30","", n_binsJER, lim_E_rel_low,lim_E_rel_high);
  TH1F* h_500_CT_DR09_E_rel_totVis_RMS_d1_cosT_0_30_to_0_40 =  new TH1F("h_500_CT_DR09_E_rel_totVis_RMS_d1_cosT_0_30_to_0_40","", n_binsJER, lim_E_rel_low,lim_E_rel_high);
  TH1F* h_500_CT_DR09_E_rel_totVis_RMS_d1_cosT_0_40_to_0_50 =  new TH1F("h_500_CT_DR09_E_rel_totVis_RMS_d1_cosT_0_40_to_0_50","", n_binsJER, lim_E_rel_low,lim_E_rel_high);
  TH1F* h_500_CT_DR09_E_rel_totVis_RMS_d1_cosT_0_50_to_0_60 =  new TH1F("h_500_CT_DR09_E_rel_totVis_RMS_d1_cosT_0_50_to_0_60","", n_binsJER, lim_E_rel_low,lim_E_rel_high);
  TH1F* h_500_CT_DR09_E_rel_totVis_RMS_d1_cosT_0_60_to_0_70 =  new TH1F("h_500_CT_DR09_E_rel_totVis_RMS_d1_cosT_0_60_to_0_70","", n_binsJER, lim_E_rel_low,lim_E_rel_high);
  TH1F* h_500_CT_DR09_E_rel_totVis_RMS_d1_cosT_0_70_to_0_80 =  new TH1F("h_500_CT_DR09_E_rel_totVis_RMS_d1_cosT_0_70_to_0_80","", n_binsJER, lim_E_rel_low,lim_E_rel_high);
  TH1F* h_500_CT_DR09_E_rel_totVis_RMS_d1_cosT_0_80_to_0_90 =  new TH1F("h_500_CT_DR09_E_rel_totVis_RMS_d1_cosT_0_80_to_0_90","", n_binsJER, lim_E_rel_low,lim_E_rel_high);
  TH1F* h_500_CT_DR09_E_rel_totVis_RMS_d1_cosT_0_900_to_0_925 =  new TH1F("h_500_CT_DR09_E_rel_totVis_RMS_d1_cosT_0_900_to_0_925","", n_binsJER, lim_E_rel_low,lim_E_rel_high);
  TH1F* h_500_CT_DR09_E_rel_totVis_RMS_d1_cosT_0_925_to_0_950 =  new TH1F("h_500_CT_DR09_E_rel_totVis_RMS_d1_cosT_0_925_to_0_950","", n_binsJER, lim_E_rel_low,lim_E_rel_high);
  TH1F* h_500_CT_DR09_E_rel_totVis_RMS_d1_cosT_0_950_to_0_975 =  new TH1F("h_500_CT_DR09_E_rel_totVis_RMS_d1_cosT_0_950_to_0_975","", n_binsJER, lim_E_rel_low,lim_E_rel_high);
  TH1F* h_500_CT_DR09_E_rel_totVis_RMS_d1_cosT_0_975_to_1_00 =  new TH1F("h_500_CT_DR09_E_rel_totVis_RMS_d1_cosT_0_975_to_1_00","", n_binsJER, lim_E_rel_low,lim_E_rel_high);

  TH1F* h_500_CT_DR10_E_rel_totVis_RMS_d1_cosT_0_to_0_10 =  new TH1F("h_500_CT_DR10_E_rel_totVis_RMS_d1_cosT_0_to_0_10","", n_binsJER, lim_E_rel_low,lim_E_rel_high);
  TH1F* h_500_CT_DR10_E_rel_totVis_RMS_d1_cosT_0_10_to_0_20 =  new TH1F("h_500_CT_DR10_E_rel_totVis_RMS_d1_cosT_0_10_to_0_20","", n_binsJER, lim_E_rel_low,lim_E_rel_high);
  TH1F* h_500_CT_DR10_E_rel_totVis_RMS_d1_cosT_0_20_to_0_30 =  new TH1F("h_500_CT_DR10_E_rel_totVis_RMS_d1_cosT_0_20_to_0_30","", n_binsJER, lim_E_rel_low,lim_E_rel_high);
  TH1F* h_500_CT_DR10_E_rel_totVis_RMS_d1_cosT_0_30_to_0_40 =  new TH1F("h_500_CT_DR10_E_rel_totVis_RMS_d1_cosT_0_30_to_0_40","", n_binsJER, lim_E_rel_low,lim_E_rel_high);
  TH1F* h_500_CT_DR10_E_rel_totVis_RMS_d1_cosT_0_40_to_0_50 =  new TH1F("h_500_CT_DR10_E_rel_totVis_RMS_d1_cosT_0_40_to_0_50","", n_binsJER, lim_E_rel_low,lim_E_rel_high);
  TH1F* h_500_CT_DR10_E_rel_totVis_RMS_d1_cosT_0_50_to_0_60 =  new TH1F("h_500_CT_DR10_E_rel_totVis_RMS_d1_cosT_0_50_to_0_60","", n_binsJER, lim_E_rel_low,lim_E_rel_high);
  TH1F* h_500_CT_DR10_E_rel_totVis_RMS_d1_cosT_0_60_to_0_70 =  new TH1F("h_500_CT_DR10_E_rel_totVis_RMS_d1_cosT_0_60_to_0_70","", n_binsJER, lim_E_rel_low,lim_E_rel_high);
  TH1F* h_500_CT_DR10_E_rel_totVis_RMS_d1_cosT_0_70_to_0_80 =  new TH1F("h_500_CT_DR10_E_rel_totVis_RMS_d1_cosT_0_70_to_0_80","", n_binsJER, lim_E_rel_low,lim_E_rel_high);
  TH1F* h_500_CT_DR10_E_rel_totVis_RMS_d1_cosT_0_80_to_0_90 =  new TH1F("h_500_CT_DR10_E_rel_totVis_RMS_d1_cosT_0_80_to_0_90","", n_binsJER, lim_E_rel_low,lim_E_rel_high);
  TH1F* h_500_CT_DR10_E_rel_totVis_RMS_d1_cosT_0_900_to_0_925 =  new TH1F("h_500_CT_DR10_E_rel_totVis_RMS_d1_cosT_0_900_to_0_925","", n_binsJER, lim_E_rel_low,lim_E_rel_high);
  TH1F* h_500_CT_DR10_E_rel_totVis_RMS_d1_cosT_0_925_to_0_950 =  new TH1F("h_500_CT_DR10_E_rel_totVis_RMS_d1_cosT_0_925_to_0_950","", n_binsJER, lim_E_rel_low,lim_E_rel_high);
  TH1F* h_500_CT_DR10_E_rel_totVis_RMS_d1_cosT_0_950_to_0_975 =  new TH1F("h_500_CT_DR10_E_rel_totVis_RMS_d1_cosT_0_950_to_0_975","", n_binsJER, lim_E_rel_low,lim_E_rel_high);
  TH1F* h_500_CT_DR10_E_rel_totVis_RMS_d1_cosT_0_975_to_1_00 =  new TH1F("h_500_CT_DR10_E_rel_totVis_RMS_d1_cosT_0_975_to_1_00","", n_binsJER, lim_E_rel_low,lim_E_rel_high);

  TH1F* h_500_CT_DR05_dphi_reco_gen_cosTheta_0_65 =  new TH1F("h_500_CT_DR05_dphi_reco_gen_cosTheta_0_65","", n_bins100, -lim_angleDeg,lim_angleDeg);
  TH1F* h_500_CT_DR05_dtheta_reco_gen_cosTheta_0_65 =  new TH1F("h_500_CT_DR05_dtheta_reco_gen_cosTheta_0_65","", n_bins100, -lim_angleDeg,lim_angleDeg);
  TH1F* h_500_CT_DR05_dphi_reco_gen_cosTheta_0_65_to_0_80 =  new TH1F("h_500_CT_DR05_dphi_reco_gen_cosTheta_0_65_to_0_80","", n_bins100, -lim_angleDeg,lim_angleDeg);
  TH1F* h_500_CT_DR05_dtheta_reco_gen_cosTheta_0_65_to_0_80 =  new TH1F("h_500_CT_DR05_dtheta_reco_gen_cosTheta_0_65_to_0_80","", n_bins100, -lim_angleDeg,lim_angleDeg);
  TH1F* h_500_CT_DR05_dphi_reco_gen_cosTheta_0_80_to_0_925 =  new TH1F("h_500_CT_DR05_dphi_reco_gen_cosTheta_0_80_to_0_925","", n_bins100, -lim_angleDeg,lim_angleDeg);
  TH1F* h_500_CT_DR05_dtheta_reco_gen_cosTheta_0_80_to_0_925 =  new TH1F("h_500_CT_DR05_dtheta_reco_gen_cosTheta_0_80_to_0_925","", n_bins100, -lim_angleDeg,lim_angleDeg);
  TH1F* h_500_CT_DR05_dphi_reco_gen_cosTheta_0_925_to_0_975 =  new TH1F("h_500_CT_DR05_dphi_reco_gen_cosTheta_0_925_to_0_975","", n_bins100, -lim_angleDeg,lim_angleDeg);
  TH1F* h_500_CT_DR05_dtheta_reco_gen_cosTheta_0_925_to_0_975 =  new TH1F("h_500_CT_DR05_dtheta_reco_gen_cosTheta_0_925_to_0_975","", n_bins100, -lim_angleDeg,lim_angleDeg);

  TH1F* h_500_CT_DR07_dphi_reco_gen_cosTheta_0_65 =  new TH1F("h_500_CT_DR07_dphi_reco_gen_cosTheta_0_65","", n_bins100, -lim_angleDeg,lim_angleDeg);
  TH1F* h_500_CT_DR07_dtheta_reco_gen_cosTheta_0_65 =  new TH1F("h_500_CT_DR07_dtheta_reco_gen_cosTheta_0_65","", n_bins100, -lim_angleDeg,lim_angleDeg);
  TH1F* h_500_CT_DR07_dphi_reco_gen_cosTheta_0_65_to_0_80 =  new TH1F("h_500_CT_DR07_dphi_reco_gen_cosTheta_0_65_to_0_80","", n_bins100, -lim_angleDeg,lim_angleDeg);
  TH1F* h_500_CT_DR07_dtheta_reco_gen_cosTheta_0_65_to_0_80 =  new TH1F("h_500_CT_DR07_dtheta_reco_gen_cosTheta_0_65_to_0_80","", n_bins100, -lim_angleDeg,lim_angleDeg);
  TH1F* h_500_CT_DR07_dphi_reco_gen_cosTheta_0_80_to_0_925 =  new TH1F("h_500_CT_DR07_dphi_reco_gen_cosTheta_0_80_to_0_925","", n_bins100, -lim_angleDeg,lim_angleDeg);
  TH1F* h_500_CT_DR07_dtheta_reco_gen_cosTheta_0_80_to_0_925 =  new TH1F("h_500_CT_DR07_dtheta_reco_gen_cosTheta_0_80_to_0_925","", n_bins100, -lim_angleDeg,lim_angleDeg);
  TH1F* h_500_CT_DR07_dphi_reco_gen_cosTheta_0_925_to_0_975 =  new TH1F("h_500_CT_DR07_dphi_reco_gen_cosTheta_0_925_to_0_975","", n_bins100, -lim_angleDeg,lim_angleDeg);
  TH1F* h_500_CT_DR07_dtheta_reco_gen_cosTheta_0_925_to_0_975 =  new TH1F("h_500_CT_DR07_dtheta_reco_gen_cosTheta_0_925_to_0_975","", n_bins100, -lim_angleDeg,lim_angleDeg);

  TH1F* h_500_CT_DR10_dphi_reco_gen_cosTheta_0_65 =  new TH1F("h_500_CT_DR10_dphi_reco_gen_cosTheta_0_65","", n_bins100, -lim_angleDeg,lim_angleDeg);
  TH1F* h_500_CT_DR10_dtheta_reco_gen_cosTheta_0_65 =  new TH1F("h_500_CT_DR10_dtheta_reco_gen_cosTheta_0_65","", n_bins100, -lim_angleDeg,lim_angleDeg);
  TH1F* h_500_CT_DR10_dphi_reco_gen_cosTheta_0_65_to_0_80 =  new TH1F("h_500_CT_DR10_dphi_reco_gen_cosTheta_0_65_to_0_80","", n_bins100, -lim_angleDeg,lim_angleDeg);
  TH1F* h_500_CT_DR10_dtheta_reco_gen_cosTheta_0_65_to_0_80 =  new TH1F("h_500_CT_DR10_dtheta_reco_gen_cosTheta_0_65_to_0_80","", n_bins100, -lim_angleDeg,lim_angleDeg);
  TH1F* h_500_CT_DR10_dphi_reco_gen_cosTheta_0_80_to_0_925 =  new TH1F("h_500_CT_DR10_dphi_reco_gen_cosTheta_0_80_to_0_925","", n_bins100, -lim_angleDeg,lim_angleDeg);
  TH1F* h_500_CT_DR10_dtheta_reco_gen_cosTheta_0_80_to_0_925 =  new TH1F("h_500_CT_DR10_dtheta_reco_gen_cosTheta_0_80_to_0_925","", n_bins100, -lim_angleDeg,lim_angleDeg);
  TH1F* h_500_CT_DR10_dphi_reco_gen_cosTheta_0_925_to_0_975 =  new TH1F("h_500_CT_DR10_dphi_reco_gen_cosTheta_0_925_to_0_975","", n_bins100, -lim_angleDeg,lim_angleDeg);
  TH1F* h_500_CT_DR10_dtheta_reco_gen_cosTheta_0_925_to_0_975 =  new TH1F("h_500_CT_DR10_dtheta_reco_gen_cosTheta_0_925_to_0_975","", n_bins100, -lim_angleDeg,lim_angleDeg);

  std::vector<TH1F*> hist_vec_500_CT;
  hist_vec_500_CT.push_back(h_500_CT_genjet03_dphi_j1j2);
  hist_vec_500_CT.push_back(h_500_CT_genjet03_E1_E2_over_E_True);
  hist_vec_500_CT.push_back(h_500_CT_genjet03_Delta_E1_E2_over_E12);
  hist_vec_500_CT.push_back(h_500_CT_genjet04_dphi_j1j2);
  hist_vec_500_CT.push_back(h_500_CT_genjet04_E1_E2_over_E_True);
  hist_vec_500_CT.push_back(h_500_CT_genjet04_Delta_E1_E2_over_E12);
  hist_vec_500_CT.push_back(h_500_CT_genjet05_dphi_j1j2);
  hist_vec_500_CT.push_back(h_500_CT_genjet05_E1_E2_over_E_True);
  hist_vec_500_CT.push_back(h_500_CT_genjet05_Delta_E1_E2_over_E12);
  hist_vec_500_CT.push_back(h_500_CT_genjet06_dphi_j1j2);
  hist_vec_500_CT.push_back(h_500_CT_genjet06_E1_E2_over_E_True);
  hist_vec_500_CT.push_back(h_500_CT_genjet06_Delta_E1_E2_over_E12);
  hist_vec_500_CT.push_back(h_500_CT_genjet07_dphi_j1j2);
  hist_vec_500_CT.push_back(h_500_CT_genjet07_E1_E2_over_E_True);
  hist_vec_500_CT.push_back(h_500_CT_genjet07_Delta_E1_E2_over_E12);
  hist_vec_500_CT.push_back(h_500_CT_genjet08_dphi_j1j2);
  hist_vec_500_CT.push_back(h_500_CT_genjet08_E1_E2_over_E_True);
  hist_vec_500_CT.push_back(h_500_CT_genjet08_Delta_E1_E2_over_E12);
  hist_vec_500_CT.push_back(h_500_CT_genjet09_dphi_j1j2);
  hist_vec_500_CT.push_back(h_500_CT_genjet09_E1_E2_over_E_True);
  hist_vec_500_CT.push_back(h_500_CT_genjet09_Delta_E1_E2_over_E12);
  hist_vec_500_CT.push_back(h_500_CT_genjet10_dphi_j1j2);
  hist_vec_500_CT.push_back(h_500_CT_genjet10_E1_E2_over_E_True);
  hist_vec_500_CT.push_back(h_500_CT_genjet10_Delta_E1_E2_over_E12);

  hist_vec_500_CT.push_back(h_500_CT_recojet03_dphi_j1j2);
  hist_vec_500_CT.push_back(h_500_CT_recojet03_E1_E2_over_E_True);
  hist_vec_500_CT.push_back(h_500_CT_recojet03_Delta_E1_E2_over_E12);
  hist_vec_500_CT.push_back(h_500_CT_recojet04_dphi_j1j2);
  hist_vec_500_CT.push_back(h_500_CT_recojet04_E1_E2_over_E_True);
  hist_vec_500_CT.push_back(h_500_CT_recojet04_Delta_E1_E2_over_E12);
  hist_vec_500_CT.push_back(h_500_CT_recojet05_dphi_j1j2);
  hist_vec_500_CT.push_back(h_500_CT_recojet05_E1_E2_over_E_True);
  hist_vec_500_CT.push_back(h_500_CT_recojet05_Delta_E1_E2_over_E12);
  hist_vec_500_CT.push_back(h_500_CT_recojet06_dphi_j1j2);
  hist_vec_500_CT.push_back(h_500_CT_recojet06_E1_E2_over_E_True);
  hist_vec_500_CT.push_back(h_500_CT_recojet06_Delta_E1_E2_over_E12);
  hist_vec_500_CT.push_back(h_500_CT_recojet07_dphi_j1j2);
  hist_vec_500_CT.push_back(h_500_CT_recojet07_E1_E2_over_E_True);
  hist_vec_500_CT.push_back(h_500_CT_recojet07_Delta_E1_E2_over_E12);
  hist_vec_500_CT.push_back(h_500_CT_recojet08_dphi_j1j2);
  hist_vec_500_CT.push_back(h_500_CT_recojet08_E1_E2_over_E_True);
  hist_vec_500_CT.push_back(h_500_CT_recojet08_Delta_E1_E2_over_E12);
  hist_vec_500_CT.push_back(h_500_CT_recojet09_dphi_j1j2);
  hist_vec_500_CT.push_back(h_500_CT_recojet09_E1_E2_over_E_True);
  hist_vec_500_CT.push_back(h_500_CT_recojet09_Delta_E1_E2_over_E12);
  hist_vec_500_CT.push_back(h_500_CT_recojet10_dphi_j1j2);
  hist_vec_500_CT.push_back(h_500_CT_recojet10_E1_E2_over_E_True);
  hist_vec_500_CT.push_back(h_500_CT_recojet10_Delta_E1_E2_over_E12);

  hist_vec_500_CT.push_back(h_500_CT_recojetE_over_genjetE_DR03);
  hist_vec_500_CT.push_back(h_500_CT_recojetE_over_genjetE_DR04);
  hist_vec_500_CT.push_back(h_500_CT_recojetE_over_genjetE_DR05);
  hist_vec_500_CT.push_back(h_500_CT_recojetE_over_genjetE_DR06);
  hist_vec_500_CT.push_back(h_500_CT_recojetE_over_genjetE_DR07);
  hist_vec_500_CT.push_back(h_500_CT_recojetE_over_genjetE_DR08);
  hist_vec_500_CT.push_back(h_500_CT_recojetE_over_genjetE_DR09);
  hist_vec_500_CT.push_back(h_500_CT_recojetE_over_genjetE_DR10);

  hist_vec_500_CT.push_back(h_500_CT_dphi_gen_reco_DR05);
  hist_vec_500_CT.push_back(h_500_CT_dphi_gen_reco_DR06);
  hist_vec_500_CT.push_back(h_500_CT_dphi_gen_reco_DR07);

  hist_vec_500_CT.push_back(h_500_CT_DR05_E_rel_totVis_RMS_d1_cosT_0_to_0_10);
  hist_vec_500_CT.push_back(h_500_CT_DR05_E_rel_totVis_RMS_d1_cosT_0_10_to_0_20);
  hist_vec_500_CT.push_back(h_500_CT_DR05_E_rel_totVis_RMS_d1_cosT_0_20_to_0_30);
  hist_vec_500_CT.push_back(h_500_CT_DR05_E_rel_totVis_RMS_d1_cosT_0_30_to_0_40);
  hist_vec_500_CT.push_back(h_500_CT_DR05_E_rel_totVis_RMS_d1_cosT_0_40_to_0_50);
  hist_vec_500_CT.push_back(h_500_CT_DR05_E_rel_totVis_RMS_d1_cosT_0_50_to_0_60);
  hist_vec_500_CT.push_back(h_500_CT_DR05_E_rel_totVis_RMS_d1_cosT_0_60_to_0_70);
  hist_vec_500_CT.push_back(h_500_CT_DR05_E_rel_totVis_RMS_d1_cosT_0_70_to_0_80);
  hist_vec_500_CT.push_back(h_500_CT_DR05_E_rel_totVis_RMS_d1_cosT_0_80_to_0_90);
  hist_vec_500_CT.push_back(h_500_CT_DR05_E_rel_totVis_RMS_d1_cosT_0_900_to_0_925);
  hist_vec_500_CT.push_back(h_500_CT_DR05_E_rel_totVis_RMS_d1_cosT_0_925_to_0_950);
  hist_vec_500_CT.push_back(h_500_CT_DR05_E_rel_totVis_RMS_d1_cosT_0_950_to_0_975);
  hist_vec_500_CT.push_back(h_500_CT_DR05_E_rel_totVis_RMS_d1_cosT_0_975_to_1_00);

  hist_vec_500_CT.push_back(h_500_CT_DR06_E_rel_totVis_RMS_d1_cosT_0_to_0_10);
  hist_vec_500_CT.push_back(h_500_CT_DR06_E_rel_totVis_RMS_d1_cosT_0_10_to_0_20);
  hist_vec_500_CT.push_back(h_500_CT_DR06_E_rel_totVis_RMS_d1_cosT_0_20_to_0_30);
  hist_vec_500_CT.push_back(h_500_CT_DR06_E_rel_totVis_RMS_d1_cosT_0_30_to_0_40);
  hist_vec_500_CT.push_back(h_500_CT_DR06_E_rel_totVis_RMS_d1_cosT_0_40_to_0_50);
  hist_vec_500_CT.push_back(h_500_CT_DR06_E_rel_totVis_RMS_d1_cosT_0_50_to_0_60);
  hist_vec_500_CT.push_back(h_500_CT_DR06_E_rel_totVis_RMS_d1_cosT_0_60_to_0_70);
  hist_vec_500_CT.push_back(h_500_CT_DR06_E_rel_totVis_RMS_d1_cosT_0_70_to_0_80);
  hist_vec_500_CT.push_back(h_500_CT_DR06_E_rel_totVis_RMS_d1_cosT_0_80_to_0_90);
  hist_vec_500_CT.push_back(h_500_CT_DR06_E_rel_totVis_RMS_d1_cosT_0_900_to_0_925);
  hist_vec_500_CT.push_back(h_500_CT_DR06_E_rel_totVis_RMS_d1_cosT_0_925_to_0_950);
  hist_vec_500_CT.push_back(h_500_CT_DR06_E_rel_totVis_RMS_d1_cosT_0_950_to_0_975);
  hist_vec_500_CT.push_back(h_500_CT_DR06_E_rel_totVis_RMS_d1_cosT_0_975_to_1_00); 

  hist_vec_500_CT.push_back(h_500_CT_DR07_E_rel_totVis_RMS_d1_cosT_0_to_0_10);
  hist_vec_500_CT.push_back(h_500_CT_DR07_E_rel_totVis_RMS_d1_cosT_0_10_to_0_20);
  hist_vec_500_CT.push_back(h_500_CT_DR07_E_rel_totVis_RMS_d1_cosT_0_20_to_0_30);
  hist_vec_500_CT.push_back(h_500_CT_DR07_E_rel_totVis_RMS_d1_cosT_0_30_to_0_40);
  hist_vec_500_CT.push_back(h_500_CT_DR07_E_rel_totVis_RMS_d1_cosT_0_40_to_0_50);
  hist_vec_500_CT.push_back(h_500_CT_DR07_E_rel_totVis_RMS_d1_cosT_0_50_to_0_60);
  hist_vec_500_CT.push_back(h_500_CT_DR07_E_rel_totVis_RMS_d1_cosT_0_60_to_0_70);
  hist_vec_500_CT.push_back(h_500_CT_DR07_E_rel_totVis_RMS_d1_cosT_0_70_to_0_80);
  hist_vec_500_CT.push_back(h_500_CT_DR07_E_rel_totVis_RMS_d1_cosT_0_80_to_0_90);
  hist_vec_500_CT.push_back(h_500_CT_DR07_E_rel_totVis_RMS_d1_cosT_0_900_to_0_925);
  hist_vec_500_CT.push_back(h_500_CT_DR07_E_rel_totVis_RMS_d1_cosT_0_925_to_0_950);
  hist_vec_500_CT.push_back(h_500_CT_DR07_E_rel_totVis_RMS_d1_cosT_0_950_to_0_975);
  hist_vec_500_CT.push_back(h_500_CT_DR07_E_rel_totVis_RMS_d1_cosT_0_975_to_1_00); 

  hist_vec_500_CT.push_back(h_500_CT_DR08_E_rel_totVis_RMS_d1_cosT_0_to_0_10);
  hist_vec_500_CT.push_back(h_500_CT_DR08_E_rel_totVis_RMS_d1_cosT_0_10_to_0_20);
  hist_vec_500_CT.push_back(h_500_CT_DR08_E_rel_totVis_RMS_d1_cosT_0_20_to_0_30);
  hist_vec_500_CT.push_back(h_500_CT_DR08_E_rel_totVis_RMS_d1_cosT_0_30_to_0_40);
  hist_vec_500_CT.push_back(h_500_CT_DR08_E_rel_totVis_RMS_d1_cosT_0_40_to_0_50);
  hist_vec_500_CT.push_back(h_500_CT_DR08_E_rel_totVis_RMS_d1_cosT_0_50_to_0_60);
  hist_vec_500_CT.push_back(h_500_CT_DR08_E_rel_totVis_RMS_d1_cosT_0_60_to_0_70);
  hist_vec_500_CT.push_back(h_500_CT_DR08_E_rel_totVis_RMS_d1_cosT_0_70_to_0_80);
  hist_vec_500_CT.push_back(h_500_CT_DR08_E_rel_totVis_RMS_d1_cosT_0_80_to_0_90);
  hist_vec_500_CT.push_back(h_500_CT_DR08_E_rel_totVis_RMS_d1_cosT_0_900_to_0_925);
  hist_vec_500_CT.push_back(h_500_CT_DR08_E_rel_totVis_RMS_d1_cosT_0_925_to_0_950);
  hist_vec_500_CT.push_back(h_500_CT_DR08_E_rel_totVis_RMS_d1_cosT_0_950_to_0_975);
  hist_vec_500_CT.push_back(h_500_CT_DR08_E_rel_totVis_RMS_d1_cosT_0_975_to_1_00); //110

  hist_vec_500_CT.push_back(h_500_CT_DR09_E_rel_totVis_RMS_d1_cosT_0_to_0_10);
  hist_vec_500_CT.push_back(h_500_CT_DR09_E_rel_totVis_RMS_d1_cosT_0_10_to_0_20);
  hist_vec_500_CT.push_back(h_500_CT_DR09_E_rel_totVis_RMS_d1_cosT_0_20_to_0_30);
  hist_vec_500_CT.push_back(h_500_CT_DR09_E_rel_totVis_RMS_d1_cosT_0_30_to_0_40);
  hist_vec_500_CT.push_back(h_500_CT_DR09_E_rel_totVis_RMS_d1_cosT_0_40_to_0_50);
  hist_vec_500_CT.push_back(h_500_CT_DR09_E_rel_totVis_RMS_d1_cosT_0_50_to_0_60);
  hist_vec_500_CT.push_back(h_500_CT_DR09_E_rel_totVis_RMS_d1_cosT_0_60_to_0_70);
  hist_vec_500_CT.push_back(h_500_CT_DR09_E_rel_totVis_RMS_d1_cosT_0_70_to_0_80);
  hist_vec_500_CT.push_back(h_500_CT_DR09_E_rel_totVis_RMS_d1_cosT_0_80_to_0_90);
  hist_vec_500_CT.push_back(h_500_CT_DR09_E_rel_totVis_RMS_d1_cosT_0_900_to_0_925);
  hist_vec_500_CT.push_back(h_500_CT_DR09_E_rel_totVis_RMS_d1_cosT_0_925_to_0_950);
  hist_vec_500_CT.push_back(h_500_CT_DR09_E_rel_totVis_RMS_d1_cosT_0_950_to_0_975);
  hist_vec_500_CT.push_back(h_500_CT_DR09_E_rel_totVis_RMS_d1_cosT_0_975_to_1_00); //123

  hist_vec_500_CT.push_back(h_500_CT_DR10_E_rel_totVis_RMS_d1_cosT_0_to_0_10);
  hist_vec_500_CT.push_back(h_500_CT_DR10_E_rel_totVis_RMS_d1_cosT_0_10_to_0_20);
  hist_vec_500_CT.push_back(h_500_CT_DR10_E_rel_totVis_RMS_d1_cosT_0_20_to_0_30);
  hist_vec_500_CT.push_back(h_500_CT_DR10_E_rel_totVis_RMS_d1_cosT_0_30_to_0_40);
  hist_vec_500_CT.push_back(h_500_CT_DR10_E_rel_totVis_RMS_d1_cosT_0_40_to_0_50);
  hist_vec_500_CT.push_back(h_500_CT_DR10_E_rel_totVis_RMS_d1_cosT_0_50_to_0_60);
  hist_vec_500_CT.push_back(h_500_CT_DR10_E_rel_totVis_RMS_d1_cosT_0_60_to_0_70);
  hist_vec_500_CT.push_back(h_500_CT_DR10_E_rel_totVis_RMS_d1_cosT_0_70_to_0_80);
  hist_vec_500_CT.push_back(h_500_CT_DR10_E_rel_totVis_RMS_d1_cosT_0_80_to_0_90);
  hist_vec_500_CT.push_back(h_500_CT_DR10_E_rel_totVis_RMS_d1_cosT_0_900_to_0_925);
  hist_vec_500_CT.push_back(h_500_CT_DR10_E_rel_totVis_RMS_d1_cosT_0_925_to_0_950);
  hist_vec_500_CT.push_back(h_500_CT_DR10_E_rel_totVis_RMS_d1_cosT_0_950_to_0_975);
  hist_vec_500_CT.push_back(h_500_CT_DR10_E_rel_totVis_RMS_d1_cosT_0_975_to_1_00); //136

  hist_vec_500_CT.push_back(h_500_CT_DR05_dphi_reco_gen_cosTheta_0_65);//137
  hist_vec_500_CT.push_back(h_500_CT_DR05_dphi_reco_gen_cosTheta_0_65_to_0_80);
  hist_vec_500_CT.push_back(h_500_CT_DR05_dphi_reco_gen_cosTheta_0_80_to_0_925);
  hist_vec_500_CT.push_back(h_500_CT_DR05_dphi_reco_gen_cosTheta_0_925_to_0_975);
  hist_vec_500_CT.push_back(h_500_CT_DR05_dtheta_reco_gen_cosTheta_0_65);
  hist_vec_500_CT.push_back(h_500_CT_DR05_dtheta_reco_gen_cosTheta_0_65_to_0_80);
  hist_vec_500_CT.push_back(h_500_CT_DR05_dtheta_reco_gen_cosTheta_0_80_to_0_925);
  hist_vec_500_CT.push_back(h_500_CT_DR05_dtheta_reco_gen_cosTheta_0_925_to_0_975);

  hist_vec_500_CT.push_back(h_500_CT_DR07_dphi_reco_gen_cosTheta_0_65);//145
  hist_vec_500_CT.push_back(h_500_CT_DR07_dphi_reco_gen_cosTheta_0_65_to_0_80);
  hist_vec_500_CT.push_back(h_500_CT_DR07_dphi_reco_gen_cosTheta_0_80_to_0_925);
  hist_vec_500_CT.push_back(h_500_CT_DR07_dphi_reco_gen_cosTheta_0_925_to_0_975);
  hist_vec_500_CT.push_back(h_500_CT_DR07_dtheta_reco_gen_cosTheta_0_65);
  hist_vec_500_CT.push_back(h_500_CT_DR07_dtheta_reco_gen_cosTheta_0_65_to_0_80);
  hist_vec_500_CT.push_back(h_500_CT_DR07_dtheta_reco_gen_cosTheta_0_80_to_0_925);
  hist_vec_500_CT.push_back(h_500_CT_DR07_dtheta_reco_gen_cosTheta_0_925_to_0_975);

  hist_vec_500_CT.push_back(h_500_CT_DR10_dphi_reco_gen_cosTheta_0_65);//153
  hist_vec_500_CT.push_back(h_500_CT_DR10_dphi_reco_gen_cosTheta_0_65_to_0_80);
  hist_vec_500_CT.push_back(h_500_CT_DR10_dphi_reco_gen_cosTheta_0_80_to_0_925);
  hist_vec_500_CT.push_back(h_500_CT_DR10_dphi_reco_gen_cosTheta_0_925_to_0_975);
  hist_vec_500_CT.push_back(h_500_CT_DR10_dtheta_reco_gen_cosTheta_0_65);
  hist_vec_500_CT.push_back(h_500_CT_DR10_dtheta_reco_gen_cosTheta_0_65_to_0_80);
  hist_vec_500_CT.push_back(h_500_CT_DR10_dtheta_reco_gen_cosTheta_0_80_to_0_925);
  hist_vec_500_CT.push_back(h_500_CT_DR10_dtheta_reco_gen_cosTheta_0_925_to_0_975);

  for(unsigned int i=0;i<hist_vec_500_CT.size();i++){
    hist_vec_500_CT[i]->Sumw2();
  }
  fill_jet_histograms(file_CLIC_500_CT,hist_vec_500_CT);

  TH1F* h_500_CT_DR05_dphi_SigmaCB_summary_histogram=new TH1F("dphiRes_SigmaCBVsCosTheta_CT_DR05_500", "#sigma#Delta#phi(j_{reco},j_{true}) vs |cos#theta|", nRegionBinsAngles, pRegionBinEdgesAngles);
  h_500_CT_DR05_dphi_SigmaCB_summary_histogram ->SetYTitle("#sigma#Delta#phi(j_{reco},j_{true})");
  h_500_CT_DR05_dphi_SigmaCB_summary_histogram->SetXTitle("|cos#theta|");
  h_500_CT_DR05_dphi_SigmaCB_summary_histogram->SetLineWidth(2);
  h_500_CT_DR05_dphi_SigmaCB_summary_histogram->SetLineColor(kCyan+1);
  h_500_CT_DR05_dphi_SigmaCB_summary_histogram->SetLineStyle(2);

  TH1F* h_500_CT_DR05_dphi_RMS90_summary_histogram=new TH1F("dphiRes_RMS90VsCosTheta_CT_DR05_500", "RMS_{90} #Delta#phi(j_{reco},j_{true}) vs |cos#theta|", nRegionBinsAngles, pRegionBinEdgesAngles);
  h_500_CT_DR05_dphi_RMS90_summary_histogram ->SetYTitle("RMS_{90}#Delta#phi(j_{reco},j_{true})");
  h_500_CT_DR05_dphi_RMS90_summary_histogram->SetXTitle("|cos#theta|");
  h_500_CT_DR05_dphi_RMS90_summary_histogram->SetLineWidth(2);
  h_500_CT_DR05_dphi_RMS90_summary_histogram->SetLineColor(kCyan+1);
  h_500_CT_DR05_dphi_RMS90_summary_histogram->SetLineStyle(2);

  TH1F* h_500_CT_DR07_dphi_SigmaCB_summary_histogram=new TH1F("dphiRes_SigmaCBVsCosTheta_CT_DR07_500", "#sigma#Delta#phi(j_{reco},j_{true}) vs |cos#theta|", nRegionBinsAngles, pRegionBinEdgesAngles);
  h_500_CT_DR07_dphi_SigmaCB_summary_histogram ->SetYTitle("#sigma#Delta#phi(j_{reco},j_{true})");
  h_500_CT_DR07_dphi_SigmaCB_summary_histogram->SetXTitle("|cos#theta|");
  h_500_CT_DR07_dphi_SigmaCB_summary_histogram->SetLineWidth(2);
  h_500_CT_DR07_dphi_SigmaCB_summary_histogram->SetLineColor(kCyan+1);
  h_500_CT_DR07_dphi_SigmaCB_summary_histogram->SetLineStyle(2);

  TH1F* h_500_CT_DR07_dphi_RMS90_summary_histogram=new TH1F("dphiRes_RMS90VsCosTheta_CT_DR07_500", "RMS_{90} #Delta#phi(j_{reco},j_{true}) vs |cos#theta|", nRegionBinsAngles, pRegionBinEdgesAngles);
  h_500_CT_DR07_dphi_RMS90_summary_histogram ->SetYTitle("RMS_{90}#Delta#phi(j_{reco},j_{true})");
  h_500_CT_DR07_dphi_RMS90_summary_histogram->SetXTitle("|cos#theta|");
  h_500_CT_DR07_dphi_RMS90_summary_histogram->SetLineWidth(2);
  h_500_CT_DR07_dphi_RMS90_summary_histogram->SetLineColor(kCyan+1);
  h_500_CT_DR07_dphi_RMS90_summary_histogram->SetLineStyle(2);

  TH1F* h_500_CT_DR10_dphi_SigmaCB_summary_histogram=new TH1F("dphiRes_SigmaCBVsCosTheta_CT_DR10_500", "#sigma#Delta#phi(j_{reco},j_{true}) vs |cos#theta|", nRegionBinsAngles, pRegionBinEdgesAngles);
  h_500_CT_DR10_dphi_SigmaCB_summary_histogram ->SetYTitle("#sigma#Delta#phi(j_{reco},j_{true})");
  h_500_CT_DR10_dphi_SigmaCB_summary_histogram->SetXTitle("|cos#theta|");
  h_500_CT_DR10_dphi_SigmaCB_summary_histogram->SetLineWidth(2);
  h_500_CT_DR10_dphi_SigmaCB_summary_histogram->SetLineColor(kCyan+1);
  h_500_CT_DR10_dphi_SigmaCB_summary_histogram->SetLineStyle(2);

  TH1F* h_500_CT_DR10_dphi_RMS90_summary_histogram=new TH1F("dphiRes_RMS90VsCosTheta_CT_DR10_500", "RMS_{90} #Delta#phi(j_{reco},j_{true}) vs |cos#theta|", nRegionBinsAngles, pRegionBinEdgesAngles);
  h_500_CT_DR10_dphi_RMS90_summary_histogram ->SetYTitle("RMS_{90}#Delta#phi(j_{reco},j_{true})");
  h_500_CT_DR10_dphi_RMS90_summary_histogram->SetXTitle("|cos#theta|");
  h_500_CT_DR10_dphi_RMS90_summary_histogram->SetLineWidth(2);
  h_500_CT_DR10_dphi_RMS90_summary_histogram->SetLineColor(kCyan+1);
  h_500_CT_DR10_dphi_RMS90_summary_histogram->SetLineStyle(2);

  TH1F* h_500_CT_DR05_dtheta_SigmaCB_summary_histogram=new TH1F("dthetaRes_SigmaCBVsCosTheta_CT_DR05_500", "#sigma#Delta#theta(j_{reco},j_{true}) vs |cos#theta|", nRegionBinsAngles, pRegionBinEdgesAngles);
  h_500_CT_DR05_dtheta_SigmaCB_summary_histogram ->SetYTitle("#sigma#Delta#theta(j_{reco},j_{true})");
  h_500_CT_DR05_dtheta_SigmaCB_summary_histogram->SetXTitle("|cos#theta|");
  h_500_CT_DR05_dtheta_SigmaCB_summary_histogram->SetLineWidth(2);
  h_500_CT_DR05_dtheta_SigmaCB_summary_histogram->SetLineColor(kCyan+1);
  h_500_CT_DR05_dtheta_SigmaCB_summary_histogram->SetLineStyle(2);

  TH1F* h_500_CT_DR05_dtheta_RMS90_summary_histogram=new TH1F("dthetaRes_RMS90VsCosTheta_CT_DR05_500", "RMS_{90} #Delta#theta(j_{reco},j_{true}) vs |cos#theta|", nRegionBinsAngles, pRegionBinEdgesAngles);
  h_500_CT_DR05_dtheta_RMS90_summary_histogram ->SetYTitle("RMS_{90}#Delta#theta(j_{reco},j_{true})");
  h_500_CT_DR05_dtheta_RMS90_summary_histogram->SetXTitle("|cos#theta|");
  h_500_CT_DR05_dtheta_RMS90_summary_histogram->SetLineWidth(2);
  h_500_CT_DR05_dtheta_RMS90_summary_histogram->SetLineColor(kCyan+1);
  h_500_CT_DR05_dtheta_RMS90_summary_histogram->SetLineStyle(2);

  TH1F* h_500_CT_DR07_dtheta_SigmaCB_summary_histogram=new TH1F("dthetaRes_SigmaCBVsCosTheta_CT_DR07_500", "#sigma#Delta#theta(j_{reco},j_{true}) vs |cos#theta|", nRegionBinsAngles, pRegionBinEdgesAngles);
  h_500_CT_DR07_dtheta_SigmaCB_summary_histogram ->SetYTitle("#sigma#Delta#theta(j_{reco},j_{true})");
  h_500_CT_DR07_dtheta_SigmaCB_summary_histogram->SetXTitle("|cos#theta|");
  h_500_CT_DR07_dtheta_SigmaCB_summary_histogram->SetLineWidth(2);
  h_500_CT_DR07_dtheta_SigmaCB_summary_histogram->SetLineColor(kCyan+1);
  h_500_CT_DR07_dtheta_SigmaCB_summary_histogram->SetLineStyle(2);

  TH1F* h_500_CT_DR07_dtheta_RMS90_summary_histogram=new TH1F("dthetaRes_RMS90VsCosTheta_CT_DR07_500", "RMS_{90} #Delta#theta(j_{reco},j_{true}) vs |cos#theta|", nRegionBinsAngles, pRegionBinEdgesAngles);
  h_500_CT_DR07_dtheta_RMS90_summary_histogram ->SetYTitle("RMS_{90}#Delta#theta(j_{reco},j_{true})");
  h_500_CT_DR07_dtheta_RMS90_summary_histogram->SetXTitle("|cos#theta|");
  h_500_CT_DR07_dtheta_RMS90_summary_histogram->SetLineWidth(2);
  h_500_CT_DR07_dtheta_RMS90_summary_histogram->SetLineColor(kCyan+1);
  h_500_CT_DR07_dtheta_RMS90_summary_histogram->SetLineStyle(2);

  TH1F* h_500_CT_DR10_dtheta_SigmaCB_summary_histogram=new TH1F("dthetaRes_SigmaCBVsCosTheta_CT_DR10_500", "#sigma#Delta#theta(j_{reco},j_{true}) vs |cos#theta|", nRegionBinsAngles, pRegionBinEdgesAngles);
  h_500_CT_DR10_dtheta_SigmaCB_summary_histogram ->SetYTitle("#sigma#Delta#theta(j_{reco},j_{true})");
  h_500_CT_DR10_dtheta_SigmaCB_summary_histogram->SetXTitle("|cos#theta|");
  h_500_CT_DR10_dtheta_SigmaCB_summary_histogram->SetLineWidth(2);
  h_500_CT_DR10_dtheta_SigmaCB_summary_histogram->SetLineColor(kCyan+1);
  h_500_CT_DR10_dtheta_SigmaCB_summary_histogram->SetLineStyle(2);

  TH1F* h_500_CT_DR10_dtheta_RMS90_summary_histogram=new TH1F("dthetaRes_RMS90VsCosTheta_CT_DR10_500", "RMS_{90} #Delta#theta(j_{reco},j_{true}) vs |cos#theta|", nRegionBinsAngles, pRegionBinEdgesAngles);
  h_500_CT_DR10_dtheta_RMS90_summary_histogram ->SetYTitle("RMS_{90}#Delta#theta(j_{reco},j_{true})");
  h_500_CT_DR10_dtheta_RMS90_summary_histogram->SetXTitle("|cos#theta|");
  h_500_CT_DR10_dtheta_RMS90_summary_histogram->SetLineWidth(2);
  h_500_CT_DR10_dtheta_RMS90_summary_histogram->SetLineColor(kCyan+1);
  h_500_CT_DR10_dtheta_RMS90_summary_histogram->SetLineStyle(2);

  for(int i=137;i<161;i++){
    //continue;
    std::cout<<"ang histo 500 "<<i<<"]"<<std::endl;
   //double sided crystal ball
    TF1* fit_gaus_tmp = new TF1("fit_gaus_tmp", "gaus",-5.,5.);
    hist_vec_500_CT[i]->Fit("fit_gaus_tmp","R");
    hist_vec_500_CT[i]->GetFunction("fit_gaus_tmp");
    TF1* fdscb_tmp = new TF1("fdscb_tmp",fnc_dscb,-lim_angleDeg,lim_angleDeg,7);
   fdscb_tmp->SetNpx(2000);
    fdscb_tmp->SetParameter(0,fit_gaus_tmp->GetParameter(0));
    //norm
    fdscb_tmp->SetParLimits (0,0.5*fit_gaus_tmp->GetParameter(0),1.5*fit_gaus_tmp->GetParameter(0));
    fdscb_tmp->SetParameter(1,fit_gaus_tmp->GetParameter(1));
    //gaussian mean
    fdscb_tmp->SetParLimits (1,-2.,2.);
    fdscb_tmp->SetParameter(2,fit_gaus_tmp->GetParameter(2));
    fdscb_tmp->SetParLimits(2,fit_gaus_tmp->GetParameter(2)*0.50,1.50*fit_gaus_tmp->GetParameter(2));
    //std::vector<float>sigma2SFit=sigmaGaussianFits2Sigma(hist_vec_500_CT[i]);
    //fdscb_tmp->SetParameter(2,sigma2SFit[0]);
    //fdscb_tmp->SetParLimits(2,sigma2SFit[0]*0.50,1.50*sigma2SFit[0]);
    //-a1: parameter, from when the gaussian core should count
    fdscb_tmp->SetParameter (3,3.0);
    fdscb_tmp->SetParLimits (3,0.0,10.0);
    //a2 parameter, up to when the gaussian core should count
    fdscb_tmp->SetParameter (5,3.0);
    fdscb_tmp->SetParLimits (5,0.0,10.0);
    fdscb_tmp->SetParameter(4,5.);
    fdscb_tmp->SetParLimits(4,0.,25.);
    fdscb_tmp->SetParameter(6,5.);
    fdscb_tmp->SetParLimits(6,0.,25.);
    int fitstatus(0); 
    fitstatus = hist_vec_500_CT[i]->Fit(fdscb_tmp,"R");
    fdscb_tmp = hist_vec_500_CT[i]->GetFunction("fdscb_tmp");
    resolutionTH1=0; 
    resolutionErrorTH1=0;
    meanTH1=0;
    meanErrorTH1=0;
    CalculatePerformanceNoMean( hist_vec_500_CT[i], resolutionTH1, resolutionErrorTH1,meanTH1,meanErrorTH1);
    int first_bin_ang=137;
    if(i<141){//dphi DR05
      first_bin_ang=137;
      h_500_CT_DR05_dphi_SigmaCB_summary_histogram->SetBinContent(i-first_bin_ang+1,fdscb_tmp->GetParameter(2));
      h_500_CT_DR05_dphi_SigmaCB_summary_histogram->SetBinError(i-first_bin_ang+1,fdscb_tmp->GetParError(2));
      h_500_CT_DR05_dphi_RMS90_summary_histogram->SetBinContent(i-first_bin_ang+1,resolutionTH1);
      h_500_CT_DR05_dphi_RMS90_summary_histogram->SetBinError(i-first_bin_ang+1, resolutionErrorTH1);
    }else if(i<145){//dtheta DR05
      first_bin_ang=141;
      h_500_CT_DR05_dtheta_SigmaCB_summary_histogram->SetBinContent(i-first_bin_ang+1,fdscb_tmp->GetParameter(2));
      h_500_CT_DR05_dtheta_SigmaCB_summary_histogram->SetBinError(i-first_bin_ang+1,fdscb_tmp->GetParError(2));
      h_500_CT_DR05_dtheta_RMS90_summary_histogram->SetBinContent(i-first_bin_ang+1,resolutionTH1);
      h_500_CT_DR05_dtheta_RMS90_summary_histogram->SetBinError(i-first_bin_ang+1, resolutionErrorTH1);
    }else if(i<149){//dphi DR07
      first_bin_ang=145;
      h_500_CT_DR07_dphi_SigmaCB_summary_histogram->SetBinContent(i-first_bin_ang+1,fdscb_tmp->GetParameter(2));
      h_500_CT_DR07_dphi_SigmaCB_summary_histogram->SetBinError(i-first_bin_ang+1,fdscb_tmp->GetParError(2));
      h_500_CT_DR07_dphi_RMS90_summary_histogram->SetBinContent(i-first_bin_ang+1,resolutionTH1);
      h_500_CT_DR07_dphi_RMS90_summary_histogram->SetBinError(i-first_bin_ang+1, resolutionErrorTH1);
    }else if(i<153){//dtheta DR07
      first_bin_ang=149;
      h_500_CT_DR07_dtheta_SigmaCB_summary_histogram->SetBinContent(i-first_bin_ang+1,fdscb_tmp->GetParameter(2));
      h_500_CT_DR07_dtheta_SigmaCB_summary_histogram->SetBinError(i-first_bin_ang+1,fdscb_tmp->GetParError(2));
      h_500_CT_DR07_dtheta_RMS90_summary_histogram->SetBinContent(i-first_bin_ang+1,resolutionTH1);
      h_500_CT_DR07_dtheta_RMS90_summary_histogram->SetBinError(i-first_bin_ang+1, resolutionErrorTH1);
    }else if(i<157){//dphi DR07
      first_bin_ang=153;
      h_500_CT_DR10_dphi_SigmaCB_summary_histogram->SetBinContent(i-first_bin_ang+1,fdscb_tmp->GetParameter(2));
      h_500_CT_DR10_dphi_SigmaCB_summary_histogram->SetBinError(i-first_bin_ang+1,fdscb_tmp->GetParError(2));
      h_500_CT_DR10_dphi_RMS90_summary_histogram->SetBinContent(i-first_bin_ang+1,resolutionTH1);
      h_500_CT_DR10_dphi_RMS90_summary_histogram->SetBinError(i-first_bin_ang+1, resolutionErrorTH1);
    }else if(i<161){//dtheta DR07
      first_bin_ang=157;
      h_500_CT_DR10_dtheta_SigmaCB_summary_histogram->SetBinContent(i-first_bin_ang+1,fdscb_tmp->GetParameter(2));
      h_500_CT_DR10_dtheta_SigmaCB_summary_histogram->SetBinError(i-first_bin_ang+1,fdscb_tmp->GetParError(2));
      h_500_CT_DR10_dtheta_RMS90_summary_histogram->SetBinContent(i-first_bin_ang+1,resolutionTH1);
      h_500_CT_DR10_dtheta_RMS90_summary_histogram->SetBinError(i-first_bin_ang+1, resolutionErrorTH1);
    }
  }


  TH1F* h_500_CT_DR05_E_RMS90_summary_histogram=new TH1F("JER_RMS90VsCosTheta_CT_DR05_500", "RMS_{90}(E_{j}^{reco}/E_{j}^{gen}) / Mean_{90}(E_{j}^{reco}/E_{j}^{gen}) vs |cos#theta|", nRegionBins, pRegionBinEdges);
  h_500_CT_DR05_E_RMS90_summary_histogram ->SetYTitle("RMS_{90}(E_{j}^{reco}/E_{j}^{gen}) / Mean_{90}(E_{j}^{reco}/E_{j}^{gen}) [%]");
  h_500_CT_DR05_E_RMS90_summary_histogram->SetXTitle("|cos#theta|");
  h_500_CT_DR05_E_RMS90_summary_histogram->SetLineWidth(2);
  h_500_CT_DR05_E_RMS90_summary_histogram->SetLineColor(kGreen-2);
  h_500_CT_DR05_E_RMS90_summary_histogram->SetLineStyle(2);

 TH1F* h_500_CT_DR05_E_SigmaCB_summary_histogram=new TH1F("JER_SigmaCBVsCosTheta_CT_DR05_500", "RMS_{90}(E_{j}^{reco}/E_{j}^{gen}) / Mean_{90}(E_{j}^{reco}/E_{j}^{gen}) vs |cos#theta|", nRegionBins, pRegionBinEdges);
  h_500_CT_DR05_E_SigmaCB_summary_histogram ->SetYTitle("#sigma(E_{j}) / E_{j} [%]");
  h_500_CT_DR05_E_SigmaCB_summary_histogram->SetXTitle("|cos#theta|");
  h_500_CT_DR05_E_SigmaCB_summary_histogram->SetLineWidth(2);
  h_500_CT_DR05_E_SigmaCB_summary_histogram->SetLineColor(kGreen-2);
  h_500_CT_DR05_E_SigmaCB_summary_histogram->SetLineStyle(2);

  TH1F* h_500_CT_DR05_E_SigmaGauss_Range3S_summary_histogram=new TH1F("JER_SigmaGauss_Range3SVsCosTheta_CT_DR05_500", "RMS_{90}(E_{j}^{reco}/E_{j}^{gen}) / Mean_{90}(E_{j}^{reco}/E_{j}^{gen}) vs |cos#theta|", nRegionBins, pRegionBinEdges);
  h_500_CT_DR05_E_SigmaGauss_Range3S_summary_histogram ->SetYTitle("#sigma(E_{j}) / E_{j} [%]");
  h_500_CT_DR05_E_SigmaGauss_Range3S_summary_histogram->SetXTitle("|cos#theta|");
  h_500_CT_DR05_E_SigmaGauss_Range3S_summary_histogram->SetLineWidth(2);
  h_500_CT_DR05_E_SigmaGauss_Range3S_summary_histogram->SetLineColor(kGreen-2);
  h_500_CT_DR05_E_SigmaGauss_Range3S_summary_histogram->SetLineStyle(2);

 TH1F* h_500_CT_DR05_E_SigmaGauss_Range3S5P_summary_histogram=new TH1F("JER_SigmaGauss_Range3S5PVsCosTheta_CT_DR05_500", "RMS_{90}(E_{j}^{reco}/E_{j}^{gen}) / Mean_{90}(E_{j}^{reco}/E_{j}^{gen}) vs |cos#theta|", nRegionBins, pRegionBinEdges);
  h_500_CT_DR05_E_SigmaGauss_Range3S5P_summary_histogram ->SetYTitle("#sigma(E_{j}) / E_{j} [%]");
  h_500_CT_DR05_E_SigmaGauss_Range3S5P_summary_histogram->SetXTitle("|cos#theta|");
  h_500_CT_DR05_E_SigmaGauss_Range3S5P_summary_histogram->SetLineWidth(2);
  h_500_CT_DR05_E_SigmaGauss_Range3S5P_summary_histogram->SetLineColor(kGreen-2);
  h_500_CT_DR05_E_SigmaGauss_Range3S5P_summary_histogram->SetLineStyle(2);

  TH1F* h_500_CT_DR05_E_SigmaGauss_Range2S_summary_histogram=new TH1F("JER_SigmaGauss_Range2SVsCosTheta_CT_DR05_500", "RMS_{90}(E_{j}^{reco}/E_{j}^{gen}) / Mean_{90}(E_{j}^{reco}/E_{j}^{gen}) vs |cos#theta|", nRegionBins, pRegionBinEdges);
  h_500_CT_DR05_E_SigmaGauss_Range2S_summary_histogram ->SetYTitle("#sigma(E_{j}) / E_{j} [%]");
  h_500_CT_DR05_E_SigmaGauss_Range2S_summary_histogram->SetXTitle("|cos#theta|");
  h_500_CT_DR05_E_SigmaGauss_Range2S_summary_histogram->SetLineWidth(2);
  h_500_CT_DR05_E_SigmaGauss_Range2S_summary_histogram->SetLineColor(kGreen-2);
  h_500_CT_DR05_E_SigmaGauss_Range2S_summary_histogram->SetLineStyle(2);

 TH1F* h_500_CT_DR05_E_SigmaGauss_Range2S5P_summary_histogram=new TH1F("JER_SigmaGauss_Range2S5PVsCosTheta_CT_DR05_500", "RMS_{90}(E_{j}^{reco}/E_{j}^{gen}) / Mean_{90}(E_{j}^{reco}/E_{j}^{gen}) vs |cos#theta|", nRegionBins, pRegionBinEdges);
  h_500_CT_DR05_E_SigmaGauss_Range2S5P_summary_histogram ->SetYTitle("#sigma(E_{j}) / E_{j} [%]");
  h_500_CT_DR05_E_SigmaGauss_Range2S5P_summary_histogram->SetXTitle("|cos#theta|");
  h_500_CT_DR05_E_SigmaGauss_Range2S5P_summary_histogram->SetLineWidth(2);
  h_500_CT_DR05_E_SigmaGauss_Range2S5P_summary_histogram->SetLineColor(kGreen-2);
  h_500_CT_DR05_E_SigmaGauss_Range2S5P_summary_histogram->SetLineStyle(2);


  TH1F* h_500_CT_DR05_E_RMS_summary_histogram=new TH1F("JER_RMSVsCosTheta_CT_DR05_500", "RMS(E_{j}) / Mean(E_{j}) vs |cos#theta|", nRegionBins, pRegionBinEdges);
  h_500_CT_DR05_E_RMS_summary_histogram ->SetYTitle("RMS(E_{j}) / Mean(E_{j}) [%]");
  h_500_CT_DR05_E_RMS_summary_histogram->SetXTitle("|cos#theta|");
  h_500_CT_DR05_E_RMS_summary_histogram->SetLineWidth(2);
  h_500_CT_DR05_E_RMS_summary_histogram->SetLineColor(kGreen-2);
  h_500_CT_DR05_E_RMS_summary_histogram->SetLineStyle(2);

  TH1F* h_500_CT_DR05_E_JER_Mean_summary_histogram=new TH1F("JER_MeanVsCosTheta_CT_DR05_500", "Mean(E_{tot}^{RECO}/E_{tot}^{true}) vs |cos#theta|", nRegionBins, pRegionBinEdges);
  h_500_CT_DR05_E_JER_Mean_summary_histogram->SetYTitle("Mean(E_{tot}^{RECO}/E_{tot}^{true})");
  h_500_CT_DR05_E_JER_Mean_summary_histogram->SetXTitle("|cos#theta|");
  h_500_CT_DR05_E_JER_Mean_summary_histogram->SetLineWidth(2);
  h_500_CT_DR05_E_JER_Mean_summary_histogram->SetLineColor(kGreen-2);
  h_500_CT_DR05_E_JER_Mean_summary_histogram->SetLineStyle(2);

  firstbin=59;
  for(int i=firstbin;i<(firstbin+13);i++){
    //continue;
    resolutionTH1=0; 
    resolutionErrorTH1=0;
    meanTH1=0;
    meanErrorTH1=0;
    CalculatePerformance( hist_vec_500_CT[i], resolutionTH1, resolutionErrorTH1,meanTH1,meanErrorTH1);
    h_500_CT_DR05_E_RMS90_summary_histogram->SetBinContent(i-firstbin+1,resolutionTH1/sqrt(2.));
    h_500_CT_DR05_E_RMS90_summary_histogram ->SetBinError(i-firstbin+1, resolutionErrorTH1/sqrt(2.));
    std::string name ="can_500_CT_DR05_h_and_fit_"+std::to_string(i-firstbin);
    TCanvas* can=setUpperCanvas(name.c_str());
    can->cd();
    hist_vec_500_CT[i]->DrawCopy("hist,e");
    std::cout<<"histo "<<i-firstbin<<" drawn"<<std::endl;

    std::vector<float>sigma_values=sigmaGaussianFits(hist_vec_500_CT[i]);
    h_500_CT_DR05_E_SigmaGauss_Range3S_summary_histogram->SetBinContent(i-firstbin+1,sigma_values[0]*100);
    h_500_CT_DR05_E_SigmaGauss_Range3S_summary_histogram->SetBinError(i-firstbin+1, sigma_values[1]*100.);
    h_500_CT_DR05_E_SigmaGauss_Range3S5P_summary_histogram->SetBinContent(i-firstbin+1,sigma_values[2]*100.);
    h_500_CT_DR05_E_SigmaGauss_Range3S5P_summary_histogram->SetBinError(i-firstbin+1,sigma_values[3]*100.);

    //double sided crystal ball
    TF1* fit_gaus_tmp = new TF1("fit_gaus_tmp", "gaus",0.0,3.0);
    hist_vec_500_CT[i]->Fit("fit_gaus_tmp","R");
    hist_vec_500_CT[i]->GetFunction("fit_gaus_tmp");

    TF1* fdscb_tmp = new TF1("fdscb_tmp",fnc_dscb,0.,3.,7);
    fdscb_tmp->SetNpx(1000);
    fdscb_tmp->SetParameter(0,fit_gaus_tmp->GetParameter(0));
    //norm
    fdscb_tmp->SetParLimits (0,0.5*fit_gaus_tmp->GetParameter(0),1.5*fit_gaus_tmp->GetParameter(0));
    fdscb_tmp->SetParameter(1,fit_gaus_tmp->GetParameter(1));
    //gaussian mean
    fdscb_tmp->SetParLimits (1,0.8,1.2);
    //fdscb_tmp->SetParameter(2,fit_gaus_tmp->GetParameter(2));
    //fdscb_tmp->SetParLimits(2,fit_gaus_tmp->GetParameter(2)*0.50,1.50*fit_gaus_tmp->GetParameter(2));
    std::vector<float>sigma2SFit=sigmaGaussianFits2Sigma(hist_vec_500_CT[i]);
    fdscb_tmp->SetParameter(2,sigma2SFit[0]);
    fdscb_tmp->SetParLimits(2,sigma2SFit[0]*0.50,1.50*sigma2SFit[0]);
    //-a1: parameter, from when the gaussian core should count
    fdscb_tmp->SetParameter (3,3.0);
    fdscb_tmp->SetParLimits (3,1,5.0);
    //a2 parameter, up to when the gaussian core should count
    fdscb_tmp->SetParameter (5,3.0);
    fdscb_tmp->SetParLimits (5,1,5.0);
    fdscb_tmp->SetParameter(4,5.);
    fdscb_tmp->SetParLimits(4,0.,25.);
    fdscb_tmp->SetParameter(6,5.);
    fdscb_tmp->SetParLimits(6,0.,25.);
    int fitstatus(0); 
    fitstatus = hist_vec_500_CT[i]->Fit(fdscb_tmp,"R");
    fdscb_tmp = hist_vec_500_CT[i]->GetFunction("fdscb_tmp");
    for(unsigned int j =0;j<7;j++){
      std::cout<<"fit par "<<j<<": "<<fdscb_tmp->GetParameter(j)<<std::endl;
    }
    h_500_CT_DR05_E_SigmaCB_summary_histogram->SetBinContent(i-firstbin+1,fdscb_tmp->GetParameter(2)*100. );
    h_500_CT_DR05_E_SigmaCB_summary_histogram->SetBinError(i-firstbin+1,fdscb_tmp->GetParError(2)*100. );
    //std::vector<float>sigma_values2S=sigmaGaussianFits2Sigma(hist_vec_500_CT[i]);
    //h_500_CT_DR05_E_SigmaGauss_Range2S_summary_histogram->SetBinContent(i-firstbin+1,sigma_values2S[0]*100);
    //h_500_CT_DR05_E_SigmaGauss_Range2S_summary_histogram->SetBinError(i-firstbin+1, sigma_values2S[1]*100.);
    //h_500_CT_DR05_E_SigmaGauss_Range2S5P_summary_histogram->SetBinContent(i-firstbin+1,sigma_values2S[2]*100.);
    //h_500_CT_DR05_E_SigmaGauss_Range2S5P_summary_histogram->SetBinError(i-firstbin+1,sigma_values2S[3]*100.);

    h_500_CT_DR05_E_RMS_summary_histogram->SetBinContent(i-firstbin+1,hist_vec_500_CT[i]->GetRMS()*100. );
    h_500_CT_DR05_E_RMS_summary_histogram ->SetBinError(i-firstbin+1, hist_vec_500_CT[i]->GetRMSError()*100.);
    h_500_CT_DR05_E_JER_Mean_summary_histogram->SetBinContent(i-firstbin+1,hist_vec_500_CT[i]->GetMean());
    h_500_CT_DR05_E_JER_Mean_summary_histogram->SetBinError(i-firstbin+1,hist_vec_500_CT[i]->GetMeanError());
  }  
  
  TH1F* h_500_CT_DR06_E_SigmaCB_summary_histogram=new TH1F("JER_SigmaCBVsCosTheta_CT_DR06_500", "RMS_{90}(E_{j}^{reco}/E_{j}^{gen}) / Mean_{90}(E_{j}^{reco}/E_{j}^{gen}) vs |cos#theta|", nRegionBins, pRegionBinEdges);
  h_500_CT_DR06_E_SigmaCB_summary_histogram ->SetYTitle("#sigma(E_{j}) / E_{j} [%]");
  h_500_CT_DR06_E_SigmaCB_summary_histogram->SetXTitle("|cos#theta|");
  h_500_CT_DR06_E_SigmaCB_summary_histogram->SetLineWidth(2);
  h_500_CT_DR06_E_SigmaCB_summary_histogram->SetLineColor(kGreen-2);
  h_500_CT_DR06_E_SigmaCB_summary_histogram->SetLineStyle(2);
  TH1F* h_500_CT_DR06_E_RMS90_summary_histogram=new TH1F("JER_RMS90VsCosTheta_CT_DR06_500", "RMS_{90}(E_{j}^{reco}/E_{j}^{gen}) / Mean_{90}(E_{j}^{reco}/E_{j}^{gen}) vs |cos#theta|", nRegionBins, pRegionBinEdges);
  h_500_CT_DR06_E_RMS90_summary_histogram ->SetYTitle("RMS_{90}(E_{j}^{reco}/E_{j}^{gen}) / Mean_{90}(E_{j}^{reco}/E_{j}^{gen}) [%]");
  h_500_CT_DR06_E_RMS90_summary_histogram->SetXTitle("|cos#theta|");
  h_500_CT_DR06_E_RMS90_summary_histogram->SetLineWidth(2);
  h_500_CT_DR06_E_RMS90_summary_histogram->SetLineColor(kGreen-2);
  h_500_CT_DR06_E_RMS90_summary_histogram->SetLineStyle(2);

  TH1F* h_500_CT_DR06_E_RMS_summary_histogram=new TH1F("JER_RMSVsCosTheta_CT_DR06_500", "RMS(E_{j}) / Mean(E_{j}) vs |cos#theta|", nRegionBins, pRegionBinEdges);
  h_500_CT_DR06_E_RMS_summary_histogram ->SetYTitle("RMS(E_{j}) / Mean(E_{j}) [%]");
  h_500_CT_DR06_E_RMS_summary_histogram->SetXTitle("|cos#theta|");
  h_500_CT_DR06_E_RMS_summary_histogram->SetLineWidth(2);
  h_500_CT_DR06_E_RMS_summary_histogram->SetLineColor(kGreen-2);
  h_500_CT_DR06_E_RMS_summary_histogram->SetLineStyle(2);

  TH1F* h_500_CT_DR06_E_JER_Mean_summary_histogram=new TH1F("JER_MeanVsCosTheta_CT_DR06_500", "Mean(E_{tot}^{RECO}/E_{tot}^{true}) vs |cos#theta|", nRegionBins, pRegionBinEdges);
  h_500_CT_DR06_E_JER_Mean_summary_histogram->SetYTitle("Mean(E_{tot}^{RECO}/E_{tot}^{true})");
  h_500_CT_DR06_E_JER_Mean_summary_histogram->SetXTitle("|cos#theta|");
  h_500_CT_DR06_E_JER_Mean_summary_histogram->SetLineWidth(2);
  h_500_CT_DR06_E_JER_Mean_summary_histogram->SetLineColor(kGreen-2);
  h_500_CT_DR06_E_JER_Mean_summary_histogram->SetLineStyle(2);
  firstbin=72;
  for(int i=firstbin;i<(firstbin+13);i++){
    //continue;
    resolutionTH1=0; 
    resolutionErrorTH1=0;
    meanTH1=0;
    meanErrorTH1=0;
    CalculatePerformance( hist_vec_500_CT[i], resolutionTH1, resolutionErrorTH1,meanTH1,meanErrorTH1);
    h_500_CT_DR06_E_RMS90_summary_histogram->SetBinContent(i-firstbin+1,resolutionTH1/sqrt(2.));
    h_500_CT_DR06_E_RMS90_summary_histogram ->SetBinError(i-firstbin+1, resolutionErrorTH1/sqrt(2.));
    h_500_CT_DR06_E_RMS_summary_histogram->SetBinContent(i-firstbin+1,hist_vec_500_CT[i]->GetRMS()*100. );
    h_500_CT_DR06_E_RMS_summary_histogram ->SetBinError(i-firstbin+1, hist_vec_500_CT[i]->GetRMSError()*100.);
    h_500_CT_DR06_E_JER_Mean_summary_histogram->SetBinContent(i-firstbin+1,hist_vec_500_CT[i]->GetMean());
    h_500_CT_DR06_E_JER_Mean_summary_histogram->SetBinError(i-firstbin+1,hist_vec_500_CT[i]->GetMeanError());

    //double sided crystal ball
    TF1* fit_gaus_tmp = new TF1("fit_gaus_tmp", "gaus",0.50,1.50);
    hist_vec_500_CT[i]->Fit("fit_gaus_tmp","R");
    hist_vec_500_CT[i]->GetFunction("fit_gaus_tmp");
    TF1* fdscb_tmp = new TF1("fdscb_tmp",fnc_dscb,0.,3.,7);
   fdscb_tmp->SetNpx(1000);
    fdscb_tmp->SetParameter(0,fit_gaus_tmp->GetParameter(0));
    //norm
    fdscb_tmp->SetParLimits (0,0.5*fit_gaus_tmp->GetParameter(0),1.5*fit_gaus_tmp->GetParameter(0));
    fdscb_tmp->SetParameter(1,fit_gaus_tmp->GetParameter(1));
    //gaussian mean
    fdscb_tmp->SetParLimits (1,0.8,1.2);
    //fdscb_tmp->SetParameter(2,fit_gaus_tmp->GetParameter(2));
    //fdscb_tmp->SetParLimits(2,fit_gaus_tmp->GetParameter(2)*0.50,1.50*fit_gaus_tmp->GetParameter(2));
    std::vector<float>sigma2SFit=sigmaGaussianFits2Sigma(hist_vec_500_CT[i]);
    fdscb_tmp->SetParameter(2,sigma2SFit[0]);
    fdscb_tmp->SetParLimits(2,sigma2SFit[0]*0.50,1.50*sigma2SFit[0]);
    //-a1: parameter, from when the gaussian core should count
    fdscb_tmp->SetParameter(2,fit_gaus_tmp->GetParameter(2));
    fdscb_tmp->SetParameter (3,3.0);
    fdscb_tmp->SetParLimits (3,0.0,10.0);
    //a2 parameter, up to when the gaussian core should count
    fdscb_tmp->SetParameter (5,3.0);
    fdscb_tmp->SetParLimits (5,0.0,10.0);
    fdscb_tmp->SetParameter(4,5.);
    fdscb_tmp->SetParLimits(4,0.,25.);
    fdscb_tmp->SetParameter(6,5.);
    fdscb_tmp->SetParLimits(6,0.,25.);
    int fitstatus(0); 
    fitstatus = hist_vec_500_CT[i]->Fit(fdscb_tmp,"R");
    fdscb_tmp = hist_vec_500_CT[i]->GetFunction("fdscb_tmp");
    for(unsigned int j =0;j<7;j++){
      std::cout<<"fit par "<<j<<": "<<fdscb_tmp->GetParameter(j)<<std::endl;
    }
    h_500_CT_DR06_E_SigmaCB_summary_histogram->SetBinContent(i-firstbin+1,fdscb_tmp->GetParameter(2)*100. );
    h_500_CT_DR06_E_SigmaCB_summary_histogram->SetBinError(i-firstbin+1,fdscb_tmp->GetParError(2)*100. );
  }  
  TH1F* h_500_CT_DR07_E_SigmaCB_summary_histogram=new TH1F("JER_SigmaCBVsCosTheta_CT_DR07_500", "RMS_{90}(E_{j}^{reco}/E_{j}^{gen}) / Mean_{90}(E_{j}^{reco}/E_{j}^{gen}) vs |cos#theta|", nRegionBins, pRegionBinEdges);
  h_500_CT_DR07_E_SigmaCB_summary_histogram ->SetYTitle("#sigma(E_{j}) / E_{j} [%]");
  h_500_CT_DR07_E_SigmaCB_summary_histogram->SetXTitle("|cos#theta|");
  h_500_CT_DR07_E_SigmaCB_summary_histogram->SetLineWidth(2);
  h_500_CT_DR07_E_SigmaCB_summary_histogram->SetLineColor(kGreen-2);
  h_500_CT_DR07_E_SigmaCB_summary_histogram->SetLineStyle(2);
  TH1F* h_500_CT_DR07_E_RMS90_summary_histogram=new TH1F("JER_RMS90VsCosTheta_CT_DR07_500", "RMS_{90}(E_{j}^{reco}/E_{j}^{gen}) / Mean_{90}(E_{j}^{reco}/E_{j}^{gen}) vs |cos#theta|", nRegionBins, pRegionBinEdges);
  h_500_CT_DR07_E_RMS90_summary_histogram ->SetYTitle("RMS_{90}(E_{j}^{reco}/E_{j}^{gen}) / Mean_{90}(E_{j}^{reco}/E_{j}^{gen}) [%]");
  h_500_CT_DR07_E_RMS90_summary_histogram->SetXTitle("|cos#theta|");
  h_500_CT_DR07_E_RMS90_summary_histogram->SetLineWidth(2);
  h_500_CT_DR07_E_RMS90_summary_histogram->SetLineColor(kGreen-2);
  h_500_CT_DR07_E_RMS90_summary_histogram->SetLineStyle(2);

  TH1F* h_500_CT_DR07_E_RMS_summary_histogram=new TH1F("JER_RMSVsCosTheta_CT_DR07_500", "RMS(E_{j}) / Mean(E_{j}) vs |cos#theta|", nRegionBins, pRegionBinEdges);
  h_500_CT_DR07_E_RMS_summary_histogram ->SetYTitle("RMS(E_{j}) / Mean(E_{j}) [%]");
  h_500_CT_DR07_E_RMS_summary_histogram->SetXTitle("|cos#theta|");
  h_500_CT_DR07_E_RMS_summary_histogram->SetLineWidth(2);
  h_500_CT_DR07_E_RMS_summary_histogram->SetLineColor(kGreen-2);
  h_500_CT_DR07_E_RMS_summary_histogram->SetLineStyle(2);

  TH1F* h_500_CT_DR07_E_JER_Mean_summary_histogram=new TH1F("JER_MeanVsCosTheta_CT_DR07_500", "Mean(E_{tot}^{RECO}/E_{tot}^{true}) vs |cos#theta|", nRegionBins, pRegionBinEdges);
  h_500_CT_DR07_E_JER_Mean_summary_histogram->SetYTitle("Mean(E_{tot}^{RECO}/E_{tot}^{true})");
  h_500_CT_DR07_E_JER_Mean_summary_histogram->SetXTitle("|cos#theta|");
  h_500_CT_DR07_E_JER_Mean_summary_histogram->SetLineWidth(2);
  h_500_CT_DR07_E_JER_Mean_summary_histogram->SetLineColor(kGreen-2);
  h_500_CT_DR07_E_JER_Mean_summary_histogram->SetLineStyle(2);
  firstbin=85;
  for(int i=firstbin;i<(firstbin+13);i++){
    //continue;
    resolutionTH1=0; 
    resolutionErrorTH1=0;
    meanTH1=0;
    meanErrorTH1=0;
    CalculatePerformance( hist_vec_500_CT[i], resolutionTH1, resolutionErrorTH1,meanTH1,meanErrorTH1);
    h_500_CT_DR07_E_RMS90_summary_histogram->SetBinContent(i-firstbin+1,resolutionTH1/sqrt(2.));
    h_500_CT_DR07_E_RMS90_summary_histogram ->SetBinError(i-firstbin+1, resolutionErrorTH1/sqrt(2.));
    h_500_CT_DR07_E_RMS_summary_histogram->SetBinContent(i-firstbin+1,hist_vec_500_CT[i]->GetRMS()*100. );
    h_500_CT_DR07_E_RMS_summary_histogram ->SetBinError(i-firstbin+1, hist_vec_500_CT[i]->GetRMSError()*100.);
    h_500_CT_DR07_E_JER_Mean_summary_histogram->SetBinContent(i-firstbin+1,hist_vec_500_CT[i]->GetMean());
    h_500_CT_DR07_E_JER_Mean_summary_histogram->SetBinError(i-firstbin+1,hist_vec_500_CT[i]->GetMeanError());

    //double sided crystal ball
    TF1* fit_gaus_tmp = new TF1("fit_gaus_tmp", "gaus",0.50,1.50);
    hist_vec_500_CT[i]->Fit("fit_gaus_tmp","R");
    hist_vec_500_CT[i]->GetFunction("fit_gaus_tmp");

    std::vector<float>sigma_gaus_temp=sigmaGaussianFits2Sigma(hist_vec_500_CT[i]);

    TF1* fdscb_tmp = new TF1("fdscb_tmp",fnc_dscb,0.,3.,7);
   fdscb_tmp->SetNpx(1000);
    fdscb_tmp->SetParameter(0,fit_gaus_tmp->GetParameter(0));
    //norm
    fdscb_tmp->SetParLimits (0,0.5*fit_gaus_tmp->GetParameter(0),1.5*fit_gaus_tmp->GetParameter(0));
    fdscb_tmp->SetParameter(1,fit_gaus_tmp->GetParameter(1));
    //gaussian mean
    fdscb_tmp->SetParLimits (1,0.8,1.2);
    std::vector<float>sigma2SFit=sigmaGaussianFits2Sigma(hist_vec_500_CT[i]);
    fdscb_tmp->SetParameter(2,sigma2SFit[0]);
    fdscb_tmp->SetParLimits(2,sigma2SFit[0]*0.50,1.50*sigma2SFit[0]);
    //fdscb_tmp->FixParameter(2,sigma_gaus_temp[0]);
    //fdscb_tmp->SetParLimits(2,fit_gaus_tmp->GetParameter(2)*0.50,1.50*fit_gaus_tmp->GetParameter(2));
    //-a1: parameter, from when the gaussian core should count
    //fdscb_tmp->SetParameter(2,fit_gaus_tmp->GetParameter(2));
    fdscb_tmp->SetParameter (3,3.0);
    fdscb_tmp->SetParLimits (3,0.0,10.0);
    //a2 parameter, up to when the gaussian core should count
    fdscb_tmp->SetParameter (5,3.0);
    fdscb_tmp->SetParLimits (5,0.0,10.0);
    fdscb_tmp->SetParameter(4,5.);
    fdscb_tmp->SetParLimits(4,0.,25.);
    fdscb_tmp->SetParameter(6,5.);
    fdscb_tmp->SetParLimits(6,0.,25.);
    int fitstatus(0); 
    fitstatus = hist_vec_500_CT[i]->Fit(fdscb_tmp,"R");
    fdscb_tmp = hist_vec_500_CT[i]->GetFunction("fdscb_tmp");
    for(unsigned int j =0;j<7;j++){
      std::cout<<"fit par "<<j<<": "<<fdscb_tmp->GetParameter(j)<<std::endl;
    }
    h_500_CT_DR07_E_SigmaCB_summary_histogram->SetBinContent(i-firstbin+1,fdscb_tmp->GetParameter(2)*100. );
    h_500_CT_DR07_E_SigmaCB_summary_histogram->SetBinError(i-firstbin+1,fdscb_tmp->GetParError(2)*100. );
  }  
  TH1F* h_500_CT_DR08_E_SigmaCB_summary_histogram=new TH1F("JER_SigmaCBVsCosTheta_CT_DR08_500", "RMS_{90}(E_{j}^{reco}/E_{j}^{gen}) / Mean_{90}(E_{j}^{reco}/E_{j}^{gen}) vs |cos#theta|", nRegionBins, pRegionBinEdges);
  h_500_CT_DR08_E_SigmaCB_summary_histogram ->SetYTitle("#sigma(E_{j}) / E_{j} [%]");
  h_500_CT_DR08_E_SigmaCB_summary_histogram->SetXTitle("|cos#theta|");
  h_500_CT_DR08_E_SigmaCB_summary_histogram->SetLineWidth(2);
  h_500_CT_DR08_E_SigmaCB_summary_histogram->SetLineColor(kGreen-2);
  h_500_CT_DR08_E_SigmaCB_summary_histogram->SetLineStyle(2);


  TH1F* h_500_CT_DR08_E_RMS90_summary_histogram=new TH1F("JER_RMS90VsCosTheta_CT_DR08_500", "RMS_{90}(E_{j}^{reco}/E_{j}^{gen}) / Mean_{90}(E_{j}^{reco}/E_{j}^{gen}) vs |cos#theta|", nRegionBins, pRegionBinEdges);
  h_500_CT_DR08_E_RMS90_summary_histogram ->SetYTitle("RMS_{90}(E_{j}^{reco}/E_{j}^{gen}) / Mean_{90}(E_{j}^{reco}/E_{j}^{gen}) [%]");
  h_500_CT_DR08_E_RMS90_summary_histogram->SetXTitle("|cos#theta|");
  h_500_CT_DR08_E_RMS90_summary_histogram->SetLineWidth(2);
  h_500_CT_DR08_E_RMS90_summary_histogram->SetLineColor(kGreen-2);
  h_500_CT_DR08_E_RMS90_summary_histogram->SetLineStyle(2);

  TH1F* h_500_CT_DR08_E_RMS_summary_histogram=new TH1F("JER_RMSVsCosTheta_CT_DR08_500", "RMS(E_{j}) / Mean(E_{j}) vs |cos#theta|", nRegionBins, pRegionBinEdges);
  h_500_CT_DR08_E_RMS_summary_histogram ->SetYTitle("RMS(E_{j}) / Mean(E_{j}) [%]");
  h_500_CT_DR08_E_RMS_summary_histogram->SetXTitle("|cos#theta|");
  h_500_CT_DR08_E_RMS_summary_histogram->SetLineWidth(2);
  h_500_CT_DR08_E_RMS_summary_histogram->SetLineColor(kGreen-2);
  h_500_CT_DR08_E_RMS_summary_histogram->SetLineStyle(2);

  TH1F* h_500_CT_DR08_E_JER_Mean_summary_histogram=new TH1F("JER_MeanVsCosTheta_CT_DR08_500", "Mean(E_{tot}^{RECO}/E_{tot}^{true}) vs |cos#theta|", nRegionBins, pRegionBinEdges);
  h_500_CT_DR08_E_JER_Mean_summary_histogram->SetYTitle("Mean(E_{tot}^{RECO}/E_{tot}^{true})");
  h_500_CT_DR08_E_JER_Mean_summary_histogram->SetXTitle("|cos#theta|");
  h_500_CT_DR08_E_JER_Mean_summary_histogram->SetLineWidth(2);
  h_500_CT_DR08_E_JER_Mean_summary_histogram->SetLineColor(kGreen-2);
  h_500_CT_DR08_E_JER_Mean_summary_histogram->SetLineStyle(2);
  firstbin=98;
  for(int i=firstbin;i<(firstbin+13);i++){
    //continue;
    resolutionTH1=0; 
    resolutionErrorTH1=0;
    meanTH1=0;
    meanErrorTH1=0;
    CalculatePerformance( hist_vec_500_CT[i], resolutionTH1, resolutionErrorTH1,meanTH1,meanErrorTH1);
    h_500_CT_DR08_E_RMS90_summary_histogram->SetBinContent(i-firstbin+1,resolutionTH1/sqrt(2.));
    h_500_CT_DR08_E_RMS90_summary_histogram ->SetBinError(i-firstbin+1, resolutionErrorTH1/sqrt(2.));
    h_500_CT_DR08_E_RMS_summary_histogram->SetBinContent(i-firstbin+1,hist_vec_500_CT[i]->GetRMS()*100. );
    h_500_CT_DR08_E_RMS_summary_histogram ->SetBinError(i-firstbin+1, hist_vec_500_CT[i]->GetRMSError()*100.);
    h_500_CT_DR08_E_JER_Mean_summary_histogram->SetBinContent(i-firstbin+1,hist_vec_500_CT[i]->GetMean());
    h_500_CT_DR08_E_JER_Mean_summary_histogram->SetBinError(i-firstbin+1,hist_vec_500_CT[i]->GetMeanError());

    //double sided crystal ball
    TF1* fit_gaus_tmp = new TF1("fit_gaus_tmp", "gaus",0.50,1.50);
    hist_vec_500_CT[i]->Fit("fit_gaus_tmp","R");
    hist_vec_500_CT[i]->GetFunction("fit_gaus_tmp");

    TF1* fdscb_tmp = new TF1("fdscb_tmp",fnc_dscb,0.,3.,7);
   fdscb_tmp->SetNpx(1000);
    fdscb_tmp->SetParameter(0,fit_gaus_tmp->GetParameter(0));
    //norm
    fdscb_tmp->SetParLimits (0,0.5*fit_gaus_tmp->GetParameter(0),1.5*fit_gaus_tmp->GetParameter(0));
    fdscb_tmp->SetParameter(1,fit_gaus_tmp->GetParameter(1));
    //gaussian mean
    fdscb_tmp->SetParLimits (1,0.8,1.2);
    //fdscb_tmp->SetParameter(2,fit_gaus_tmp->GetParameter(2));
    //fdscb_tmp->SetParLimits(2,fit_gaus_tmp->GetParameter(2)*0.50,1.50*fit_gaus_tmp->GetParameter(2));
    std::vector<float>sigma2SFit=sigmaGaussianFits2Sigma(hist_vec_500_CT[i]);
    fdscb_tmp->SetParameter(2,sigma2SFit[0]);
    fdscb_tmp->SetParLimits(2,sigma2SFit[0]*0.50,1.50*sigma2SFit[0]);
    //-a1: parameter, from when the gaussian core should count
    fdscb_tmp->SetParameter(2,fit_gaus_tmp->GetParameter(2));
    fdscb_tmp->SetParameter (3,3.0);
    fdscb_tmp->SetParLimits (3,0.0,10.0);
    //a2 parameter, up to when the gaussian core should count
    fdscb_tmp->SetParameter (5,3.0);
    fdscb_tmp->SetParLimits (5,0.0,10.0);
    fdscb_tmp->SetParameter(4,5.);
    fdscb_tmp->SetParLimits(4,0.,25.);
    fdscb_tmp->SetParameter(6,5.);
    fdscb_tmp->SetParLimits(6,0.,25.);
    int fitstatus(0); 
    fitstatus = hist_vec_500_CT[i]->Fit(fdscb_tmp,"R");
    fdscb_tmp = hist_vec_500_CT[i]->GetFunction("fdscb_tmp");
    for(unsigned int j =0;j<7;j++){
      std::cout<<"fit par "<<j<<": "<<fdscb_tmp->GetParameter(j)<<std::endl;
    }
    h_500_CT_DR08_E_SigmaCB_summary_histogram->SetBinContent(i-firstbin+1,fdscb_tmp->GetParameter(2)*100. );
    h_500_CT_DR08_E_SigmaCB_summary_histogram->SetBinError(i-firstbin+1,fdscb_tmp->GetParError(2)*100. );
  }  
  TH1F* h_500_CT_DR09_E_SigmaCB_summary_histogram=new TH1F("JER_SigmaCBVsCosTheta_CT_DR09_500", "RMS_{90}(E_{j}^{reco}/E_{j}^{gen}) / Mean_{90}(E_{j}^{reco}/E_{j}^{gen}) vs |cos#theta|", nRegionBins, pRegionBinEdges);
  h_500_CT_DR09_E_SigmaCB_summary_histogram ->SetYTitle("#sigma(E_{j}) / E_{j} [%]");
  h_500_CT_DR09_E_SigmaCB_summary_histogram->SetXTitle("|cos#theta|");
  h_500_CT_DR09_E_SigmaCB_summary_histogram->SetLineWidth(2);
  h_500_CT_DR09_E_SigmaCB_summary_histogram->SetLineColor(kGreen-2);
  h_500_CT_DR09_E_SigmaCB_summary_histogram->SetLineStyle(2);
  TH1F* h_500_CT_DR09_E_RMS90_summary_histogram=new TH1F("JER_RMS90VsCosTheta_CT_DR09_500", "RMS_{90}(E_{j}^{reco}/E_{j}^{gen}) / Mean_{90}(E_{j}^{reco}/E_{j}^{gen}) vs |cos#theta|", nRegionBins, pRegionBinEdges);
  h_500_CT_DR09_E_RMS90_summary_histogram ->SetYTitle("RMS_{90}(E_{j}^{reco}/E_{j}^{gen}) / Mean_{90}(E_{j}^{reco}/E_{j}^{gen}) [%]");
  h_500_CT_DR09_E_RMS90_summary_histogram->SetXTitle("|cos#theta|");
  h_500_CT_DR09_E_RMS90_summary_histogram->SetLineWidth(2);
  h_500_CT_DR09_E_RMS90_summary_histogram->SetLineColor(kGreen-2);
  h_500_CT_DR09_E_RMS90_summary_histogram->SetLineStyle(2);

  TH1F* h_500_CT_DR09_E_RMS_summary_histogram=new TH1F("JER_RMSVsCosTheta_CT_DR09_500", "RMS(E_{j}) / Mean(E_{j}) vs |cos#theta|", nRegionBins, pRegionBinEdges);
  h_500_CT_DR09_E_RMS_summary_histogram ->SetYTitle("RMS(E_{j}) / Mean(E_{j}) [%]");
  h_500_CT_DR09_E_RMS_summary_histogram->SetXTitle("|cos#theta|");
  h_500_CT_DR09_E_RMS_summary_histogram->SetLineWidth(2);
  h_500_CT_DR09_E_RMS_summary_histogram->SetLineColor(kGreen-2);
  h_500_CT_DR09_E_RMS_summary_histogram->SetLineStyle(2);

  TH1F* h_500_CT_DR09_E_JER_Mean_summary_histogram=new TH1F("JER_MeanVsCosTheta_CT_DR09_500", "Mean(E_{tot}^{RECO}/E_{tot}^{true}) vs |cos#theta|", nRegionBins, pRegionBinEdges);
  h_500_CT_DR09_E_JER_Mean_summary_histogram->SetYTitle("Mean(E_{tot}^{RECO}/E_{tot}^{true})");
  h_500_CT_DR09_E_JER_Mean_summary_histogram->SetXTitle("|cos#theta|");
  h_500_CT_DR09_E_JER_Mean_summary_histogram->SetLineWidth(2);
  h_500_CT_DR09_E_JER_Mean_summary_histogram->SetLineColor(kGreen-2);
  h_500_CT_DR09_E_JER_Mean_summary_histogram->SetLineStyle(2);
  firstbin=111;
  for(int i=firstbin;i<(firstbin+13);i++){
    //continue;
    resolutionTH1=0; 
    resolutionErrorTH1=0;
    meanTH1=0;
    meanErrorTH1=0;
    CalculatePerformance( hist_vec_500_CT[i], resolutionTH1, resolutionErrorTH1,meanTH1,meanErrorTH1);
    h_500_CT_DR09_E_RMS90_summary_histogram->SetBinContent(i-firstbin+1,resolutionTH1/sqrt(2.));
    h_500_CT_DR09_E_RMS90_summary_histogram ->SetBinError(i-firstbin+1, resolutionErrorTH1/sqrt(2.));
    h_500_CT_DR09_E_RMS_summary_histogram->SetBinContent(i-firstbin+1,hist_vec_500_CT[i]->GetRMS()*100. );
    h_500_CT_DR09_E_RMS_summary_histogram ->SetBinError(i-firstbin+1, hist_vec_500_CT[i]->GetRMSError()*100.);
    h_500_CT_DR09_E_JER_Mean_summary_histogram->SetBinContent(i-firstbin+1,hist_vec_500_CT[i]->GetMean());
    h_500_CT_DR09_E_JER_Mean_summary_histogram->SetBinError(i-firstbin+1,hist_vec_500_CT[i]->GetMeanError());

    //double sided crystal ball
    TF1* fit_gaus_tmp = new TF1("fit_gaus_tmp", "gaus",0.50,1.50);
    hist_vec_500_CT[i]->Fit("fit_gaus_tmp","R");
    hist_vec_500_CT[i]->GetFunction("fit_gaus_tmp");

    TF1* fdscb_tmp = new TF1("fdscb_tmp",fnc_dscb,0.,3.,7);
   fdscb_tmp->SetNpx(1000);
    fdscb_tmp->SetParameter(0,fit_gaus_tmp->GetParameter(0));
    //norm
    fdscb_tmp->SetParLimits (0,0.5*fit_gaus_tmp->GetParameter(0),1.5*fit_gaus_tmp->GetParameter(0));
    fdscb_tmp->SetParameter(1,fit_gaus_tmp->GetParameter(1));
    //gaussian mean
    fdscb_tmp->SetParLimits (1,0.8,1.2);
    //fdscb_tmp->SetParameter(2,fit_gaus_tmp->GetParameter(2));
    //fdscb_tmp->SetParLimits(2,fit_gaus_tmp->GetParameter(2)*0.50,1.50*fit_gaus_tmp->GetParameter(2));
    std::vector<float>sigma2SFit=sigmaGaussianFits2Sigma(hist_vec_500_CT[i]);
    fdscb_tmp->SetParameter(2,sigma2SFit[0]);
    fdscb_tmp->SetParLimits(2,sigma2SFit[0]*0.50,1.50*sigma2SFit[0]);
    //-a1: parameter, from when the gaussian core should count
    fdscb_tmp->SetParameter(2,fit_gaus_tmp->GetParameter(2));
    fdscb_tmp->SetParameter (3,3.0);
    fdscb_tmp->SetParLimits (3,0.0,10.0);
    //a2 parameter, up to when the gaussian core should count
    fdscb_tmp->SetParameter (5,3.0);
    fdscb_tmp->SetParLimits (5,0.0,10.0);
    fdscb_tmp->SetParameter(4,5.);
    fdscb_tmp->SetParLimits(4,0.,25.);
    fdscb_tmp->SetParameter(6,5.);
    fdscb_tmp->SetParLimits(6,0.,25.);
    int fitstatus(0); 
    fitstatus = hist_vec_500_CT[i]->Fit(fdscb_tmp,"R");
    fdscb_tmp = hist_vec_500_CT[i]->GetFunction("fdscb_tmp");
    for(unsigned int j =0;j<7;j++){
      std::cout<<"fit par "<<j<<": "<<fdscb_tmp->GetParameter(j)<<std::endl;
    }
    h_500_CT_DR09_E_SigmaCB_summary_histogram->SetBinContent(i-firstbin+1,fdscb_tmp->GetParameter(2)*100. );
    h_500_CT_DR09_E_SigmaCB_summary_histogram->SetBinError(i-firstbin+1,fdscb_tmp->GetParError(2)*100. );
  }  
 TH1F* h_500_CT_DR10_E_SigmaCB_summary_histogram=new TH1F("JER_SigmaCBVsCosTheta_CT_DR10_500", "RMS_{90}(E_{j}^{reco}/E_{j}^{gen}) / Mean_{90}(E_{j}^{reco}/E_{j}^{gen}) vs |cos#theta|", nRegionBins, pRegionBinEdges);
  h_500_CT_DR10_E_SigmaCB_summary_histogram ->SetYTitle("#sigma(E_{j}) / E_{j} [%]");
  h_500_CT_DR10_E_SigmaCB_summary_histogram->SetXTitle("|cos#theta|");
  h_500_CT_DR10_E_SigmaCB_summary_histogram->SetLineWidth(2);
  h_500_CT_DR10_E_SigmaCB_summary_histogram->SetLineColor(kGreen-2);
  h_500_CT_DR10_E_SigmaCB_summary_histogram->SetLineStyle(2);

  TH1F* h_500_CT_DR10_E_RMS90_summary_histogram=new TH1F("JER_RMS90VsCosTheta_CT_DR10_500", "RMS_{90}(E_{j}^{reco}/E_{j}^{gen}) / Mean_{90}(E_{j}^{reco}/E_{j}^{gen}) vs |cos#theta|", nRegionBins, pRegionBinEdges);
  h_500_CT_DR10_E_RMS90_summary_histogram ->SetYTitle("RMS_{90}(E_{j}^{reco}/E_{j}^{gen}) / Mean_{90}(E_{j}^{reco}/E_{j}^{gen}) [%]");
  h_500_CT_DR10_E_RMS90_summary_histogram->SetXTitle("|cos#theta|");
  h_500_CT_DR10_E_RMS90_summary_histogram->SetLineWidth(2);
  h_500_CT_DR10_E_RMS90_summary_histogram->SetLineColor(kGreen-2);
  h_500_CT_DR10_E_RMS90_summary_histogram->SetLineStyle(2);

  TH1F* h_500_CT_DR10_E_RMS_summary_histogram=new TH1F("JER_RMSVsCosTheta_CT_DR10_500", "RMS(E_{j}) / Mean(E_{j}) vs |cos#theta|", nRegionBins, pRegionBinEdges);
  h_500_CT_DR10_E_RMS_summary_histogram ->SetYTitle("RMS(E_{j}) / Mean(E_{j}) [%]");
  h_500_CT_DR10_E_RMS_summary_histogram->SetXTitle("|cos#theta|");
  h_500_CT_DR10_E_RMS_summary_histogram->SetLineWidth(2);
  h_500_CT_DR10_E_RMS_summary_histogram->SetLineColor(kGreen-2);
  h_500_CT_DR10_E_RMS_summary_histogram->SetLineStyle(2);

  TH1F* h_500_CT_DR10_E_JER_Mean_summary_histogram=new TH1F("JER_MeanVsCosTheta_CT_DR10_500", "Mean(E_{tot}^{RECO}/E_{tot}^{true}) vs |cos#theta|", nRegionBins, pRegionBinEdges);
  h_500_CT_DR10_E_JER_Mean_summary_histogram->SetYTitle("Mean(E_{tot}^{RECO}/E_{tot}^{true})");
  h_500_CT_DR10_E_JER_Mean_summary_histogram->SetXTitle("|cos#theta|");
  h_500_CT_DR10_E_JER_Mean_summary_histogram->SetLineWidth(2);
  h_500_CT_DR10_E_JER_Mean_summary_histogram->SetLineColor(kGreen-2);
  h_500_CT_DR10_E_JER_Mean_summary_histogram->SetLineStyle(2);
  firstbin=124;
  for(int i=firstbin;i<(firstbin+13);i++){
    //continue;
    resolutionTH1=0; 
    resolutionErrorTH1=0;
    meanTH1=0;
    meanErrorTH1=0;
    CalculatePerformance( hist_vec_500_CT[i], resolutionTH1, resolutionErrorTH1,meanTH1,meanErrorTH1);
    h_500_CT_DR10_E_RMS90_summary_histogram->SetBinContent(i-firstbin+1,resolutionTH1/sqrt(2.));
    h_500_CT_DR10_E_RMS90_summary_histogram ->SetBinError(i-firstbin+1, resolutionErrorTH1/sqrt(2.));
    h_500_CT_DR10_E_RMS_summary_histogram->SetBinContent(i-firstbin+1,hist_vec_500_CT[i]->GetRMS()*100. );
    h_500_CT_DR10_E_RMS_summary_histogram ->SetBinError(i-firstbin+1, hist_vec_500_CT[i]->GetRMSError()*100.);
    h_500_CT_DR10_E_JER_Mean_summary_histogram->SetBinContent(i-firstbin+1,hist_vec_500_CT[i]->GetMean());
    h_500_CT_DR10_E_JER_Mean_summary_histogram->SetBinError(i-firstbin+1,hist_vec_500_CT[i]->GetMeanError());

    //double sided crystal ball
    TF1* fit_gaus_tmp = new TF1("fit_gaus_tmp", "gaus",0.50,1.50);
    hist_vec_500_CT[i]->Fit("fit_gaus_tmp","R");
    hist_vec_500_CT[i]->GetFunction("fit_gaus_tmp");

    TF1* fdscb_tmp = new TF1("fdscb_tmp",fnc_dscb,0.,3.,7);
   fdscb_tmp->SetNpx(1000);
    fdscb_tmp->SetParameter(0,fit_gaus_tmp->GetParameter(0));
    //norm
    fdscb_tmp->SetParLimits (0,0.5*fit_gaus_tmp->GetParameter(0),1.5*fit_gaus_tmp->GetParameter(0));
    fdscb_tmp->SetParameter(1,fit_gaus_tmp->GetParameter(1));
    //gaussian mean
    fdscb_tmp->SetParLimits (1,0.8,1.2);
    //fdscb_tmp->SetParameter(2,fit_gaus_tmp->GetParameter(2));
    //fdscb_tmp->SetParLimits(2,fit_gaus_tmp->GetParameter(2)*0.50,1.50*fit_gaus_tmp->GetParameter(2));
    std::vector<float>sigma2SFit=sigmaGaussianFits2Sigma(hist_vec_500_CT[i]);
    fdscb_tmp->SetParameter(2,sigma2SFit[0]);
    fdscb_tmp->SetParLimits(2,sigma2SFit[0]*0.50,1.50*sigma2SFit[0]);
    //-a1: parameter, from when the gaussian core should count
    fdscb_tmp->SetParameter(2,fit_gaus_tmp->GetParameter(2));
    fdscb_tmp->SetParameter (3,3.0);
    fdscb_tmp->SetParLimits (3,0.0,10.0);
    //a2 parameter, up to when the gaussian core should count
    fdscb_tmp->SetParameter (5,3.0);
    fdscb_tmp->SetParLimits (5,0.0,10.0);
    fdscb_tmp->SetParameter(4,5.);
    fdscb_tmp->SetParLimits(4,0.,25.);
    fdscb_tmp->SetParameter(6,5.);
    fdscb_tmp->SetParLimits(6,0.,25.);
    int fitstatus(0); 
    fitstatus = hist_vec_500_CT[i]->Fit(fdscb_tmp,"R");
    fdscb_tmp = hist_vec_500_CT[i]->GetFunction("fdscb_tmp");
    for(unsigned int j =0;j<7;j++){
      std::cout<<"fit par "<<j<<": "<<fdscb_tmp->GetParameter(j)<<std::endl;
    }
    h_500_CT_DR10_E_SigmaCB_summary_histogram->SetBinContent(i-firstbin+1,fdscb_tmp->GetParameter(2)*100. );
    h_500_CT_DR10_E_SigmaCB_summary_histogram->SetBinError(i-firstbin+1,fdscb_tmp->GetParError(2)*100. );
  }  
  
  std::cout<<"500 03/04/05/06 "<< calculate_over90(h_500_CT_recojet03_E1_E2_over_E_True)<<"/"<< calculate_over90(h_500_CT_recojet04_E1_E2_over_E_True)<<"/"<< calculate_over90(h_500_CT_recojet05_E1_E2_over_E_True)<<"/"<<calculate_over90(h_500_CT_recojet06_E1_E2_over_E_True)<<" 07/08/09/10 "<< calculate_over90(h_500_CT_recojet07_E1_E2_over_E_True)<<"/"<< calculate_over90(h_500_CT_recojet08_E1_E2_over_E_True)<<"/"<< calculate_over90(h_500_CT_recojet09_E1_E2_over_E_True)<<"/"<<calculate_over90(h_500_CT_recojet10_E1_E2_over_E_True)<<std::endl;
  std::cout<<"jet histos 500 CT filled"<<std::endl;

  TH1F* h_500_CT_wO_genjet03_dphi_j1j2 =  new TH1F("h_500_CT_wO_genjet03_dphi_j1j2","", n_bins100, 0.5,TMath::Pi());
  TH1F* h_500_CT_wO_genjet03_E1_E2_over_E_True =  new TH1F("h_500_CT_wO_genjet03_E1_E2_over_E_True","", n_bins100, 0.5,1.00);
  TH1F* h_500_CT_wO_genjet03_Delta_E1_E2_over_E12 =  new TH1F("h_500_CT_wO_genjet03_Delta_E1_E2_over_E12","", n_bins100, -0.5,0.5);
  TH1F* h_500_CT_wO_genjet04_dphi_j1j2 =  new TH1F("h_500_CT_wO_genjet04_dphi_j1j2","", n_bins100, 0.5,TMath::Pi());
  TH1F* h_500_CT_wO_genjet04_E1_E2_over_E_True =  new TH1F("h_500_CT_wO_genjet04_E1_E2_over_E_True","", n_bins100, 0.5,1.00);
  TH1F* h_500_CT_wO_genjet04_Delta_E1_E2_over_E12 =  new TH1F("h_500_CT_wO_genjet04_Delta_E1_E2_over_E12","", n_bins100, -0.5,0.5);
  TH1F* h_500_CT_wO_genjet05_dphi_j1j2 =  new TH1F("h_500_CT_wO_genjet05_dphi_j1j2","", n_bins100, 0.5,TMath::Pi());
  TH1F* h_500_CT_wO_genjet05_E1_E2_over_E_True =  new TH1F("h_500_CT_wO_genjet05_E1_E2_over_E_True","", n_bins100, 0.5,1.00);
  TH1F* h_500_CT_wO_genjet05_Delta_E1_E2_over_E12 =  new TH1F("h_500_CT_wO_genjet05_Delta_E1_E2_over_E12","", n_bins100, -0.5,0.5);
  TH1F* h_500_CT_wO_genjet06_dphi_j1j2 =  new TH1F("h_500_CT_wO_genjet06_dphi_j1j2","", n_bins100, 0.5,TMath::Pi());
  TH1F* h_500_CT_wO_genjet06_E1_E2_over_E_True =  new TH1F("h_500_CT_wO_genjet06_E1_E2_over_E_True","", n_bins100, 0.5,1.00);
  TH1F* h_500_CT_wO_genjet06_Delta_E1_E2_over_E12 =  new TH1F("h_500_CT_wO_genjet06_Delta_E1_E2_over_E12","", n_bins100, -0.5,0.5);
  TH1F* h_500_CT_wO_genjet07_dphi_j1j2 =  new TH1F("h_500_CT_wO_genjet07_dphi_j1j2","", n_bins100, 0.5,TMath::Pi());
  TH1F* h_500_CT_wO_genjet07_E1_E2_over_E_True =  new TH1F("h_500_CT_wO_genjet07_E1_E2_over_E_True","", n_bins100, 0.5,1.00);
  TH1F* h_500_CT_wO_genjet07_Delta_E1_E2_over_E12 =  new TH1F("h_500_CT_wO_genjet07_Delta_E1_E2_over_E12","", n_bins100, -0.5,0.5);
  TH1F* h_500_CT_wO_genjet08_dphi_j1j2 =  new TH1F("h_500_CT_wO_genjet08_dphi_j1j2","", n_bins100, 0.5,TMath::Pi());
  TH1F* h_500_CT_wO_genjet08_E1_E2_over_E_True =  new TH1F("h_500_CT_wO_genjet08_E1_E2_over_E_True","", n_bins100, 0.5,1.00);
  TH1F* h_500_CT_wO_genjet08_Delta_E1_E2_over_E12 =  new TH1F("h_500_CT_wO_genjet08_Delta_E1_E2_over_E12","", n_bins100, -0.5,0.5);
  TH1F* h_500_CT_wO_genjet09_dphi_j1j2 =  new TH1F("h_500_CT_wO_genjet09_dphi_j1j2","", n_bins100, 0.5,TMath::Pi());
  TH1F* h_500_CT_wO_genjet09_E1_E2_over_E_True =  new TH1F("h_500_CT_wO_genjet09_E1_E2_over_E_True","", n_bins100, 0.5,1.00);
  TH1F* h_500_CT_wO_genjet09_Delta_E1_E2_over_E12 =  new TH1F("h_500_CT_wO_genjet09_Delta_E1_E2_over_E12","", n_bins100, -0.5,0.5);
  TH1F* h_500_CT_wO_genjet10_dphi_j1j2 =  new TH1F("h_500_CT_wO_genjet10_dphi_j1j2","", n_bins100, 0.5,TMath::Pi());
  TH1F* h_500_CT_wO_genjet10_E1_E2_over_E_True =  new TH1F("h_500_CT_wO_genjet10_E1_E2_over_E_True","", n_bins100, 0.5,1.00);
  TH1F* h_500_CT_wO_genjet10_Delta_E1_E2_over_E12 =  new TH1F("h_500_CT_wO_genjet10_Delta_E1_E2_over_E12","", n_bins100, -0.5,0.5);

  TH1F* h_500_CT_wO_recojet03_dphi_j1j2 =  new TH1F("h_500_CT_wO_recojet03_dphi_j1j2","", n_bins100, 0.5,TMath::Pi());
  TH1F* h_500_CT_wO_recojet03_E1_E2_over_E_True =  new TH1F("h_500_CT_wO_recojet03_E1_E2_over_E_True","", n_bins100, 0.5,1.00);
  TH1F* h_500_CT_wO_recojet03_Delta_E1_E2_over_E12 =  new TH1F("h_500_CT_wO_recojet03_Delta_E1_E2_over_E12","", n_bins100, -0.5,0.5);
  TH1F* h_500_CT_wO_recojet04_dphi_j1j2 =  new TH1F("h_500_CT_wO_recojet04_dphi_j1j2","", n_bins100, 0.5,TMath::Pi());
  TH1F* h_500_CT_wO_recojet04_E1_E2_over_E_True =  new TH1F("h_500_CT_wO_recojet04_E1_E2_over_E_True","", n_bins100, 0.5,1.00);
  TH1F* h_500_CT_wO_recojet04_Delta_E1_E2_over_E12 =  new TH1F("h_500_CT_wO_recojet04_Delta_E1_E2_over_E12","", n_bins100, -0.5,0.5);
  TH1F* h_500_CT_wO_recojet05_dphi_j1j2 =  new TH1F("h_500_CT_wO_recojet05_dphi_j1j2","", n_bins100, 0.5,TMath::Pi());
  TH1F* h_500_CT_wO_recojet05_E1_E2_over_E_True =  new TH1F("h_500_CT_wO_recojet05_E1_E2_over_E_True","", n_bins100, 0.5,1.00);
  TH1F* h_500_CT_wO_recojet05_Delta_E1_E2_over_E12 =  new TH1F("h_500_CT_wO_recojet05_Delta_E1_E2_over_E12","", n_bins100, -0.5,0.5);
  TH1F* h_500_CT_wO_recojet06_dphi_j1j2 =  new TH1F("h_500_CT_wO_recojet06_dphi_j1j2","", n_bins100, 0.5,TMath::Pi());
  TH1F* h_500_CT_wO_recojet06_E1_E2_over_E_True =  new TH1F("h_500_CT_wO_recojet06_E1_E2_over_E_True","", n_bins100, 0.5,1.00);
  TH1F* h_500_CT_wO_recojet06_Delta_E1_E2_over_E12 =  new TH1F("h_500_CT_wO_recojet06_Delta_E1_E2_over_E12","", n_bins100, -0.5,0.5);
  TH1F* h_500_CT_wO_recojet07_dphi_j1j2 =  new TH1F("h_500_CT_wO_recojet07_dphi_j1j2","", n_bins100, 0.5,TMath::Pi());
  TH1F* h_500_CT_wO_recojet07_E1_E2_over_E_True =  new TH1F("h_500_CT_wO_recojet07_E1_E2_over_E_True","", n_bins100, 0.5,1.00);
  TH1F* h_500_CT_wO_recojet07_Delta_E1_E2_over_E12 =  new TH1F("h_500_CT_wO_recojet07_Delta_E1_E2_over_E12","", n_bins100, -0.5,0.5);
  TH1F* h_500_CT_wO_recojet08_dphi_j1j2 =  new TH1F("h_500_CT_wO_recojet08_dphi_j1j2","", n_bins100, 0.5,TMath::Pi());
  TH1F* h_500_CT_wO_recojet08_E1_E2_over_E_True =  new TH1F("h_500_CT_wO_recojet08_E1_E2_over_E_True","", n_bins100, 0.5,1.00);
  TH1F* h_500_CT_wO_recojet08_Delta_E1_E2_over_E12 =  new TH1F("h_500_CT_wO_recojet08_Delta_E1_E2_over_E12","", n_bins100, -0.5,0.5);
  TH1F* h_500_CT_wO_recojet09_dphi_j1j2 =  new TH1F("h_500_CT_wO_recojet09_dphi_j1j2","", n_bins100, 0.5,TMath::Pi());
  TH1F* h_500_CT_wO_recojet09_E1_E2_over_E_True =  new TH1F("h_500_CT_wO_recojet09_E1_E2_over_E_True","", n_bins100, 0.5,1.00);
  TH1F* h_500_CT_wO_recojet09_Delta_E1_E2_over_E12 =  new TH1F("h_500_CT_wO_recojet09_Delta_E1_E2_over_E12","", n_bins100, -0.5,0.5);
  TH1F* h_500_CT_wO_recojet10_dphi_j1j2 =  new TH1F("h_500_CT_wO_recojet10_dphi_j1j2","", n_bins100, 0.5,TMath::Pi());
  TH1F* h_500_CT_wO_recojet10_E1_E2_over_E_True =  new TH1F("h_500_CT_wO_recojet10_E1_E2_over_E_True","", n_bins100, 0.5,1.00);
  TH1F* h_500_CT_wO_recojet10_Delta_E1_E2_over_E12 =  new TH1F("h_500_CT_wO_recojet10_Delta_E1_E2_over_E12","", n_bins100, -0.5,0.5);

  TH1F* h_500_CT_wO_recojetE_over_genjetE_DR03 =  new TH1F("h_500_CT_wO_recojetE_over_genjetE_DR03","", n_bins100, 0.5,1.5);
  TH1F* h_500_CT_wO_recojetE_over_genjetE_DR04 =  new TH1F("h_500_CT_wO_recojetE_over_genjetE_DR04","", n_bins100, 0.5,1.5);
  TH1F* h_500_CT_wO_recojetE_over_genjetE_DR05 =  new TH1F("h_500_CT_wO_recojetE_over_genjetE_DR05","", n_bins100, 0.5,1.5);
  TH1F* h_500_CT_wO_recojetE_over_genjetE_DR06 =  new TH1F("h_500_CT_wO_recojetE_over_genjetE_DR06","", n_bins100, 0.5,1.5);
  TH1F* h_500_CT_wO_recojetE_over_genjetE_DR07 =  new TH1F("h_500_CT_wO_recojetE_over_genjetE_DR07","", n_bins100, 0.5,1.5);
  TH1F* h_500_CT_wO_recojetE_over_genjetE_DR08 =  new TH1F("h_500_CT_wO_recojetE_over_genjetE_DR08","", n_bins100, 0.5,1.5);
  TH1F* h_500_CT_wO_recojetE_over_genjetE_DR09 =  new TH1F("h_500_CT_wO_recojetE_over_genjetE_DR09","", n_bins100, 0.5,1.5);
  TH1F* h_500_CT_wO_recojetE_over_genjetE_DR10 =  new TH1F("h_500_CT_wO_recojetE_over_genjetE_DR10","", n_bins100, 0.5,1.5);

  TH1F* h_500_CT_wO_dphi_gen_reco_DR05 =  new TH1F("h_500_CT_wO_dphi_gen_reco_DR05","", n_bins100, -0.1,9.9);
  TH1F* h_500_CT_wO_dphi_gen_reco_DR06 =  new TH1F("h_500_CT_wO_dphi_gen_reco_DR06","", n_bins100, -0.1,9.9);
  TH1F* h_500_CT_wO_dphi_gen_reco_DR07 =  new TH1F("h_500_CT_wO_dphi_gen_reco_DR07","", n_bins100, -0.1,9.9);

  TH1F* h_500_CT_wO_DR05_E_rel_totVis_RMS_d1_cosT_0_to_0_10 =  new TH1F("h_500_CT_wO_DR05_E_rel_totVis_RMS_d1_cosT_0_to_0_10","", n_binsJER, lim_E_rel_low,lim_E_rel_high);
  TH1F* h_500_CT_wO_DR05_E_rel_totVis_RMS_d1_cosT_0_10_to_0_20 =  new TH1F("h_500_CT_wO_DR05_E_rel_totVis_RMS_d1_cosT_0_10_to_0_20","", n_binsJER, lim_E_rel_low,lim_E_rel_high);
  TH1F* h_500_CT_wO_DR05_E_rel_totVis_RMS_d1_cosT_0_20_to_0_30 =  new TH1F("h_500_CT_wO_DR05_E_rel_totVis_RMS_d1_cosT_0_20_to_0_30","", n_binsJER, lim_E_rel_low,lim_E_rel_high);
  TH1F* h_500_CT_wO_DR05_E_rel_totVis_RMS_d1_cosT_0_30_to_0_40 =  new TH1F("h_500_CT_wO_DR05_E_rel_totVis_RMS_d1_cosT_0_30_to_0_40","", n_binsJER, lim_E_rel_low,lim_E_rel_high);
  TH1F* h_500_CT_wO_DR05_E_rel_totVis_RMS_d1_cosT_0_40_to_0_50 =  new TH1F("h_500_CT_wO_DR05_E_rel_totVis_RMS_d1_cosT_0_40_to_0_50","", n_binsJER, lim_E_rel_low,lim_E_rel_high);
  TH1F* h_500_CT_wO_DR05_E_rel_totVis_RMS_d1_cosT_0_50_to_0_60 =  new TH1F("h_500_CT_wO_DR05_E_rel_totVis_RMS_d1_cosT_0_50_to_0_60","", n_binsJER, lim_E_rel_low,lim_E_rel_high);
  TH1F* h_500_CT_wO_DR05_E_rel_totVis_RMS_d1_cosT_0_60_to_0_70 =  new TH1F("h_500_CT_wO_DR05_E_rel_totVis_RMS_d1_cosT_0_60_to_0_70","", n_binsJER, lim_E_rel_low,lim_E_rel_high);
  TH1F* h_500_CT_wO_DR05_E_rel_totVis_RMS_d1_cosT_0_70_to_0_80 =  new TH1F("h_500_CT_wO_DR05_E_rel_totVis_RMS_d1_cosT_0_70_to_0_80","", n_binsJER, lim_E_rel_low,lim_E_rel_high);
  TH1F* h_500_CT_wO_DR05_E_rel_totVis_RMS_d1_cosT_0_80_to_0_90 =  new TH1F("h_500_CT_wO_DR05_E_rel_totVis_RMS_d1_cosT_0_80_to_0_90","", n_binsJER, lim_E_rel_low,lim_E_rel_high);
  TH1F* h_500_CT_wO_DR05_E_rel_totVis_RMS_d1_cosT_0_900_to_0_925 =  new TH1F("h_500_CT_wO_DR05_E_rel_totVis_RMS_d1_cosT_0_900_to_0_925","", n_binsJER, lim_E_rel_low,lim_E_rel_high);
  TH1F* h_500_CT_wO_DR05_E_rel_totVis_RMS_d1_cosT_0_925_to_0_950 =  new TH1F("h_500_CT_wO_DR05_E_rel_totVis_RMS_d1_cosT_0_925_to_0_950","", n_binsJER, lim_E_rel_low,lim_E_rel_high);
  TH1F* h_500_CT_wO_DR05_E_rel_totVis_RMS_d1_cosT_0_950_to_0_975 =  new TH1F("h_500_CT_wO_DR05_E_rel_totVis_RMS_d1_cosT_0_950_to_0_975","", n_binsJER, lim_E_rel_low,lim_E_rel_high);
  TH1F* h_500_CT_wO_DR05_E_rel_totVis_RMS_d1_cosT_0_975_to_1_00 =  new TH1F("h_500_CT_wO_DR05_E_rel_totVis_RMS_d1_cosT_0_975_to_1_00","", n_binsJER, lim_E_rel_low,lim_E_rel_high);

  TH1F* h_500_CT_wO_DR06_E_rel_totVis_RMS_d1_cosT_0_to_0_10 =  new TH1F("h_500_CT_wO_DR06_E_rel_totVis_RMS_d1_cosT_0_to_0_10","", n_binsJER, lim_E_rel_low,lim_E_rel_high);
  TH1F* h_500_CT_wO_DR06_E_rel_totVis_RMS_d1_cosT_0_10_to_0_20 =  new TH1F("h_500_CT_wO_DR06_E_rel_totVis_RMS_d1_cosT_0_10_to_0_20","", n_binsJER, lim_E_rel_low,lim_E_rel_high);
  TH1F* h_500_CT_wO_DR06_E_rel_totVis_RMS_d1_cosT_0_20_to_0_30 =  new TH1F("h_500_CT_wO_DR06_E_rel_totVis_RMS_d1_cosT_0_20_to_0_30","", n_binsJER, lim_E_rel_low,lim_E_rel_high);
  TH1F* h_500_CT_wO_DR06_E_rel_totVis_RMS_d1_cosT_0_30_to_0_40 =  new TH1F("h_500_CT_wO_DR06_E_rel_totVis_RMS_d1_cosT_0_30_to_0_40","", n_binsJER, lim_E_rel_low,lim_E_rel_high);
  TH1F* h_500_CT_wO_DR06_E_rel_totVis_RMS_d1_cosT_0_40_to_0_50 =  new TH1F("h_500_CT_wO_DR06_E_rel_totVis_RMS_d1_cosT_0_40_to_0_50","", n_binsJER, lim_E_rel_low,lim_E_rel_high);
  TH1F* h_500_CT_wO_DR06_E_rel_totVis_RMS_d1_cosT_0_50_to_0_60 =  new TH1F("h_500_CT_wO_DR06_E_rel_totVis_RMS_d1_cosT_0_50_to_0_60","", n_binsJER, lim_E_rel_low,lim_E_rel_high);
  TH1F* h_500_CT_wO_DR06_E_rel_totVis_RMS_d1_cosT_0_60_to_0_70 =  new TH1F("h_500_CT_wO_DR06_E_rel_totVis_RMS_d1_cosT_0_60_to_0_70","", n_binsJER, lim_E_rel_low,lim_E_rel_high);
  TH1F* h_500_CT_wO_DR06_E_rel_totVis_RMS_d1_cosT_0_70_to_0_80 =  new TH1F("h_500_CT_wO_DR06_E_rel_totVis_RMS_d1_cosT_0_70_to_0_80","", n_binsJER, lim_E_rel_low,lim_E_rel_high);
  TH1F* h_500_CT_wO_DR06_E_rel_totVis_RMS_d1_cosT_0_80_to_0_90 =  new TH1F("h_500_CT_wO_DR06_E_rel_totVis_RMS_d1_cosT_0_80_to_0_90","", n_binsJER, lim_E_rel_low,lim_E_rel_high);
  TH1F* h_500_CT_wO_DR06_E_rel_totVis_RMS_d1_cosT_0_900_to_0_925 =  new TH1F("h_500_CT_wO_DR06_E_rel_totVis_RMS_d1_cosT_0_900_to_0_925","", n_binsJER, lim_E_rel_low,lim_E_rel_high);
  TH1F* h_500_CT_wO_DR06_E_rel_totVis_RMS_d1_cosT_0_925_to_0_950 =  new TH1F("h_500_CT_wO_DR06_E_rel_totVis_RMS_d1_cosT_0_925_to_0_950","", n_binsJER, lim_E_rel_low,lim_E_rel_high);
  TH1F* h_500_CT_wO_DR06_E_rel_totVis_RMS_d1_cosT_0_950_to_0_975 =  new TH1F("h_500_CT_wO_DR06_E_rel_totVis_RMS_d1_cosT_0_950_to_0_975","", n_binsJER, lim_E_rel_low,lim_E_rel_high);
  TH1F* h_500_CT_wO_DR06_E_rel_totVis_RMS_d1_cosT_0_975_to_1_00 =  new TH1F("h_500_CT_wO_DR06_E_rel_totVis_RMS_d1_cosT_0_975_to_1_00","", n_binsJER, lim_E_rel_low,lim_E_rel_high);

  TH1F* h_500_CT_wO_DR07_E_rel_totVis_RMS_d1_cosT_0_to_0_10 =  new TH1F("h_500_CT_wO_DR07_E_rel_totVis_RMS_d1_cosT_0_to_0_10","", n_binsJER, lim_E_rel_low,lim_E_rel_high);
  TH1F* h_500_CT_wO_DR07_E_rel_totVis_RMS_d1_cosT_0_10_to_0_20 =  new TH1F("h_500_CT_wO_DR07_E_rel_totVis_RMS_d1_cosT_0_10_to_0_20","", n_binsJER, lim_E_rel_low,lim_E_rel_high);
  TH1F* h_500_CT_wO_DR07_E_rel_totVis_RMS_d1_cosT_0_20_to_0_30 =  new TH1F("h_500_CT_wO_DR07_E_rel_totVis_RMS_d1_cosT_0_20_to_0_30","", n_binsJER, lim_E_rel_low,lim_E_rel_high);
  TH1F* h_500_CT_wO_DR07_E_rel_totVis_RMS_d1_cosT_0_30_to_0_40 =  new TH1F("h_500_CT_wO_DR07_E_rel_totVis_RMS_d1_cosT_0_30_to_0_40","", n_binsJER, lim_E_rel_low,lim_E_rel_high);
  TH1F* h_500_CT_wO_DR07_E_rel_totVis_RMS_d1_cosT_0_40_to_0_50 =  new TH1F("h_500_CT_wO_DR07_E_rel_totVis_RMS_d1_cosT_0_40_to_0_50","", n_binsJER, lim_E_rel_low,lim_E_rel_high);
  TH1F* h_500_CT_wO_DR07_E_rel_totVis_RMS_d1_cosT_0_50_to_0_60 =  new TH1F("h_500_CT_wO_DR07_E_rel_totVis_RMS_d1_cosT_0_50_to_0_60","", n_binsJER, lim_E_rel_low,lim_E_rel_high);
  TH1F* h_500_CT_wO_DR07_E_rel_totVis_RMS_d1_cosT_0_60_to_0_70 =  new TH1F("h_500_CT_wO_DR07_E_rel_totVis_RMS_d1_cosT_0_60_to_0_70","", n_binsJER, lim_E_rel_low,lim_E_rel_high);
  TH1F* h_500_CT_wO_DR07_E_rel_totVis_RMS_d1_cosT_0_70_to_0_80 =  new TH1F("h_500_CT_wO_DR07_E_rel_totVis_RMS_d1_cosT_0_70_to_0_80","", n_binsJER, lim_E_rel_low,lim_E_rel_high);
  TH1F* h_500_CT_wO_DR07_E_rel_totVis_RMS_d1_cosT_0_80_to_0_90 =  new TH1F("h_500_CT_wO_DR07_E_rel_totVis_RMS_d1_cosT_0_80_to_0_90","", n_binsJER, lim_E_rel_low,lim_E_rel_high);
  TH1F* h_500_CT_wO_DR07_E_rel_totVis_RMS_d1_cosT_0_900_to_0_925 =  new TH1F("h_500_CT_wO_DR07_E_rel_totVis_RMS_d1_cosT_0_900_to_0_925","", n_binsJER, lim_E_rel_low,lim_E_rel_high);
  TH1F* h_500_CT_wO_DR07_E_rel_totVis_RMS_d1_cosT_0_925_to_0_950 =  new TH1F("h_500_CT_wO_DR07_E_rel_totVis_RMS_d1_cosT_0_925_to_0_950","", n_binsJER, lim_E_rel_low,lim_E_rel_high);
  TH1F* h_500_CT_wO_DR07_E_rel_totVis_RMS_d1_cosT_0_950_to_0_975 =  new TH1F("h_500_CT_wO_DR07_E_rel_totVis_RMS_d1_cosT_0_950_to_0_975","", n_binsJER, lim_E_rel_low,lim_E_rel_high);
  TH1F* h_500_CT_wO_DR07_E_rel_totVis_RMS_d1_cosT_0_975_to_1_00 =  new TH1F("h_500_CT_wO_DR07_E_rel_totVis_RMS_d1_cosT_0_975_to_1_00","", n_binsJER, lim_E_rel_low,lim_E_rel_high);

  TH1F* h_500_CT_wO_DR08_E_rel_totVis_RMS_d1_cosT_0_to_0_10 =  new TH1F("h_500_CT_wO_DR08_E_rel_totVis_RMS_d1_cosT_0_to_0_10","", n_binsJER, lim_E_rel_low,lim_E_rel_high);
  TH1F* h_500_CT_wO_DR08_E_rel_totVis_RMS_d1_cosT_0_10_to_0_20 =  new TH1F("h_500_CT_wO_DR08_E_rel_totVis_RMS_d1_cosT_0_10_to_0_20","", n_binsJER, lim_E_rel_low,lim_E_rel_high);
  TH1F* h_500_CT_wO_DR08_E_rel_totVis_RMS_d1_cosT_0_20_to_0_30 =  new TH1F("h_500_CT_wO_DR08_E_rel_totVis_RMS_d1_cosT_0_20_to_0_30","", n_binsJER, lim_E_rel_low,lim_E_rel_high);
  TH1F* h_500_CT_wO_DR08_E_rel_totVis_RMS_d1_cosT_0_30_to_0_40 =  new TH1F("h_500_CT_wO_DR08_E_rel_totVis_RMS_d1_cosT_0_30_to_0_40","", n_binsJER, lim_E_rel_low,lim_E_rel_high);
  TH1F* h_500_CT_wO_DR08_E_rel_totVis_RMS_d1_cosT_0_40_to_0_50 =  new TH1F("h_500_CT_wO_DR08_E_rel_totVis_RMS_d1_cosT_0_40_to_0_50","", n_binsJER, lim_E_rel_low,lim_E_rel_high);
  TH1F* h_500_CT_wO_DR08_E_rel_totVis_RMS_d1_cosT_0_50_to_0_60 =  new TH1F("h_500_CT_wO_DR08_E_rel_totVis_RMS_d1_cosT_0_50_to_0_60","", n_binsJER, lim_E_rel_low,lim_E_rel_high);
  TH1F* h_500_CT_wO_DR08_E_rel_totVis_RMS_d1_cosT_0_60_to_0_70 =  new TH1F("h_500_CT_wO_DR08_E_rel_totVis_RMS_d1_cosT_0_60_to_0_70","", n_binsJER, lim_E_rel_low,lim_E_rel_high);
  TH1F* h_500_CT_wO_DR08_E_rel_totVis_RMS_d1_cosT_0_70_to_0_80 =  new TH1F("h_500_CT_wO_DR08_E_rel_totVis_RMS_d1_cosT_0_70_to_0_80","", n_binsJER, lim_E_rel_low,lim_E_rel_high);
  TH1F* h_500_CT_wO_DR08_E_rel_totVis_RMS_d1_cosT_0_80_to_0_90 =  new TH1F("h_500_CT_wO_DR08_E_rel_totVis_RMS_d1_cosT_0_80_to_0_90","", n_binsJER, lim_E_rel_low,lim_E_rel_high);
  TH1F* h_500_CT_wO_DR08_E_rel_totVis_RMS_d1_cosT_0_900_to_0_925 =  new TH1F("h_500_CT_wO_DR08_E_rel_totVis_RMS_d1_cosT_0_900_to_0_925","", n_binsJER, lim_E_rel_low,lim_E_rel_high);
  TH1F* h_500_CT_wO_DR08_E_rel_totVis_RMS_d1_cosT_0_925_to_0_950 =  new TH1F("h_500_CT_wO_DR08_E_rel_totVis_RMS_d1_cosT_0_925_to_0_950","", n_binsJER, lim_E_rel_low,lim_E_rel_high);
  TH1F* h_500_CT_wO_DR08_E_rel_totVis_RMS_d1_cosT_0_950_to_0_975 =  new TH1F("h_500_CT_wO_DR08_E_rel_totVis_RMS_d1_cosT_0_950_to_0_975","", n_binsJER, lim_E_rel_low,lim_E_rel_high);
  TH1F* h_500_CT_wO_DR08_E_rel_totVis_RMS_d1_cosT_0_975_to_1_00 =  new TH1F("h_500_CT_wO_DR08_E_rel_totVis_RMS_d1_cosT_0_975_to_1_00","", n_binsJER, lim_E_rel_low,lim_E_rel_high);

  TH1F* h_500_CT_wO_DR09_E_rel_totVis_RMS_d1_cosT_0_to_0_10 =  new TH1F("h_500_CT_wO_DR09_E_rel_totVis_RMS_d1_cosT_0_to_0_10","", n_binsJER, lim_E_rel_low,lim_E_rel_high);
  TH1F* h_500_CT_wO_DR09_E_rel_totVis_RMS_d1_cosT_0_10_to_0_20 =  new TH1F("h_500_CT_wO_DR09_E_rel_totVis_RMS_d1_cosT_0_10_to_0_20","", n_binsJER, lim_E_rel_low,lim_E_rel_high);
  TH1F* h_500_CT_wO_DR09_E_rel_totVis_RMS_d1_cosT_0_20_to_0_30 =  new TH1F("h_500_CT_wO_DR09_E_rel_totVis_RMS_d1_cosT_0_20_to_0_30","", n_binsJER, lim_E_rel_low,lim_E_rel_high);
  TH1F* h_500_CT_wO_DR09_E_rel_totVis_RMS_d1_cosT_0_30_to_0_40 =  new TH1F("h_500_CT_wO_DR09_E_rel_totVis_RMS_d1_cosT_0_30_to_0_40","", n_binsJER, lim_E_rel_low,lim_E_rel_high);
  TH1F* h_500_CT_wO_DR09_E_rel_totVis_RMS_d1_cosT_0_40_to_0_50 =  new TH1F("h_500_CT_wO_DR09_E_rel_totVis_RMS_d1_cosT_0_40_to_0_50","", n_binsJER, lim_E_rel_low,lim_E_rel_high);
  TH1F* h_500_CT_wO_DR09_E_rel_totVis_RMS_d1_cosT_0_50_to_0_60 =  new TH1F("h_500_CT_wO_DR09_E_rel_totVis_RMS_d1_cosT_0_50_to_0_60","", n_binsJER, lim_E_rel_low,lim_E_rel_high);
  TH1F* h_500_CT_wO_DR09_E_rel_totVis_RMS_d1_cosT_0_60_to_0_70 =  new TH1F("h_500_CT_wO_DR09_E_rel_totVis_RMS_d1_cosT_0_60_to_0_70","", n_binsJER, lim_E_rel_low,lim_E_rel_high);
  TH1F* h_500_CT_wO_DR09_E_rel_totVis_RMS_d1_cosT_0_70_to_0_80 =  new TH1F("h_500_CT_wO_DR09_E_rel_totVis_RMS_d1_cosT_0_70_to_0_80","", n_binsJER, lim_E_rel_low,lim_E_rel_high);
  TH1F* h_500_CT_wO_DR09_E_rel_totVis_RMS_d1_cosT_0_80_to_0_90 =  new TH1F("h_500_CT_wO_DR09_E_rel_totVis_RMS_d1_cosT_0_80_to_0_90","", n_binsJER, lim_E_rel_low,lim_E_rel_high);
  TH1F* h_500_CT_wO_DR09_E_rel_totVis_RMS_d1_cosT_0_900_to_0_925 =  new TH1F("h_500_CT_wO_DR09_E_rel_totVis_RMS_d1_cosT_0_900_to_0_925","", n_binsJER, lim_E_rel_low,lim_E_rel_high);
  TH1F* h_500_CT_wO_DR09_E_rel_totVis_RMS_d1_cosT_0_925_to_0_950 =  new TH1F("h_500_CT_wO_DR09_E_rel_totVis_RMS_d1_cosT_0_925_to_0_950","", n_binsJER, lim_E_rel_low,lim_E_rel_high);
  TH1F* h_500_CT_wO_DR09_E_rel_totVis_RMS_d1_cosT_0_950_to_0_975 =  new TH1F("h_500_CT_wO_DR09_E_rel_totVis_RMS_d1_cosT_0_950_to_0_975","", n_binsJER, lim_E_rel_low,lim_E_rel_high);
  TH1F* h_500_CT_wO_DR09_E_rel_totVis_RMS_d1_cosT_0_975_to_1_00 =  new TH1F("h_500_CT_wO_DR09_E_rel_totVis_RMS_d1_cosT_0_975_to_1_00","", n_binsJER, lim_E_rel_low,lim_E_rel_high);

  TH1F* h_500_CT_wO_DR10_E_rel_totVis_RMS_d1_cosT_0_to_0_10 =  new TH1F("h_500_CT_wO_DR10_E_rel_totVis_RMS_d1_cosT_0_to_0_10","", n_binsJER, lim_E_rel_low,lim_E_rel_high);
  TH1F* h_500_CT_wO_DR10_E_rel_totVis_RMS_d1_cosT_0_10_to_0_20 =  new TH1F("h_500_CT_wO_DR10_E_rel_totVis_RMS_d1_cosT_0_10_to_0_20","", n_binsJER, lim_E_rel_low,lim_E_rel_high);
  TH1F* h_500_CT_wO_DR10_E_rel_totVis_RMS_d1_cosT_0_20_to_0_30 =  new TH1F("h_500_CT_wO_DR10_E_rel_totVis_RMS_d1_cosT_0_20_to_0_30","", n_binsJER, lim_E_rel_low,lim_E_rel_high);
  TH1F* h_500_CT_wO_DR10_E_rel_totVis_RMS_d1_cosT_0_30_to_0_40 =  new TH1F("h_500_CT_wO_DR10_E_rel_totVis_RMS_d1_cosT_0_30_to_0_40","", n_binsJER, lim_E_rel_low,lim_E_rel_high);
  TH1F* h_500_CT_wO_DR10_E_rel_totVis_RMS_d1_cosT_0_40_to_0_50 =  new TH1F("h_500_CT_wO_DR10_E_rel_totVis_RMS_d1_cosT_0_40_to_0_50","", n_binsJER, lim_E_rel_low,lim_E_rel_high);
  TH1F* h_500_CT_wO_DR10_E_rel_totVis_RMS_d1_cosT_0_50_to_0_60 =  new TH1F("h_500_CT_wO_DR10_E_rel_totVis_RMS_d1_cosT_0_50_to_0_60","", n_binsJER, lim_E_rel_low,lim_E_rel_high);
  TH1F* h_500_CT_wO_DR10_E_rel_totVis_RMS_d1_cosT_0_60_to_0_70 =  new TH1F("h_500_CT_wO_DR10_E_rel_totVis_RMS_d1_cosT_0_60_to_0_70","", n_binsJER, lim_E_rel_low,lim_E_rel_high);
  TH1F* h_500_CT_wO_DR10_E_rel_totVis_RMS_d1_cosT_0_70_to_0_80 =  new TH1F("h_500_CT_wO_DR10_E_rel_totVis_RMS_d1_cosT_0_70_to_0_80","", n_binsJER, lim_E_rel_low,lim_E_rel_high);
  TH1F* h_500_CT_wO_DR10_E_rel_totVis_RMS_d1_cosT_0_80_to_0_90 =  new TH1F("h_500_CT_wO_DR10_E_rel_totVis_RMS_d1_cosT_0_80_to_0_90","", n_binsJER, lim_E_rel_low,lim_E_rel_high);
  TH1F* h_500_CT_wO_DR10_E_rel_totVis_RMS_d1_cosT_0_900_to_0_925 =  new TH1F("h_500_CT_wO_DR10_E_rel_totVis_RMS_d1_cosT_0_900_to_0_925","", n_binsJER, lim_E_rel_low,lim_E_rel_high);
  TH1F* h_500_CT_wO_DR10_E_rel_totVis_RMS_d1_cosT_0_925_to_0_950 =  new TH1F("h_500_CT_wO_DR10_E_rel_totVis_RMS_d1_cosT_0_925_to_0_950","", n_binsJER, lim_E_rel_low,lim_E_rel_high);
  TH1F* h_500_CT_wO_DR10_E_rel_totVis_RMS_d1_cosT_0_950_to_0_975 =  new TH1F("h_500_CT_wO_DR10_E_rel_totVis_RMS_d1_cosT_0_950_to_0_975","", n_binsJER, lim_E_rel_low,lim_E_rel_high);
  TH1F* h_500_CT_wO_DR10_E_rel_totVis_RMS_d1_cosT_0_975_to_1_00 =  new TH1F("h_500_CT_wO_DR10_E_rel_totVis_RMS_d1_cosT_0_975_to_1_00","", n_binsJER, lim_E_rel_low,lim_E_rel_high);

  TH1F* h_500_CT_wO_DR05_dphi_reco_gen_cosTheta_0_65 =  new TH1F("h_500_CT_wO_DR05_dphi_reco_gen_cosTheta_0_65","", n_bins100, -lim_angleDeg,lim_angleDeg);
  TH1F* h_500_CT_wO_DR05_dtheta_reco_gen_cosTheta_0_65 =  new TH1F("h_500_CT_wO_DR05_dtheta_reco_gen_cosTheta_0_65","", n_bins100, -lim_angleDeg,lim_angleDeg);
  TH1F* h_500_CT_wO_DR05_dphi_reco_gen_cosTheta_0_65_to_0_80 =  new TH1F("h_500_CT_wO_DR05_dphi_reco_gen_cosTheta_0_65_to_0_80","", n_bins100, -lim_angleDeg,lim_angleDeg);
  TH1F* h_500_CT_wO_DR05_dtheta_reco_gen_cosTheta_0_65_to_0_80 =  new TH1F("h_500_CT_wO_DR05_dtheta_reco_gen_cosTheta_0_65_to_0_80","", n_bins100, -lim_angleDeg,lim_angleDeg);
  TH1F* h_500_CT_wO_DR05_dphi_reco_gen_cosTheta_0_80_to_0_925 =  new TH1F("h_500_CT_wO_DR05_dphi_reco_gen_cosTheta_0_80_to_0_925","", n_bins100, -lim_angleDeg,lim_angleDeg);
  TH1F* h_500_CT_wO_DR05_dtheta_reco_gen_cosTheta_0_80_to_0_925 =  new TH1F("h_500_CT_wO_DR05_dtheta_reco_gen_cosTheta_0_80_to_0_925","", n_bins100, -lim_angleDeg,lim_angleDeg);
  TH1F* h_500_CT_wO_DR05_dphi_reco_gen_cosTheta_0_925_to_0_975 =  new TH1F("h_500_CT_wO_DR05_dphi_reco_gen_cosTheta_0_925_to_0_975","", n_bins100, -lim_angleDeg,lim_angleDeg);
  TH1F* h_500_CT_wO_DR05_dtheta_reco_gen_cosTheta_0_925_to_0_975 =  new TH1F("h_500_CT_wO_DR05_dtheta_reco_gen_cosTheta_0_925_to_0_975","", n_bins100, -lim_angleDeg,lim_angleDeg);

  TH1F* h_500_CT_wO_DR07_dphi_reco_gen_cosTheta_0_65 =  new TH1F("h_500_CT_wO_DR07_dphi_reco_gen_cosTheta_0_65","", n_bins100, -lim_angleDeg,lim_angleDeg);
  TH1F* h_500_CT_wO_DR07_dtheta_reco_gen_cosTheta_0_65 =  new TH1F("h_500_CT_wO_DR07_dtheta_reco_gen_cosTheta_0_65","", n_bins100, -lim_angleDeg,lim_angleDeg);
  TH1F* h_500_CT_wO_DR07_dphi_reco_gen_cosTheta_0_65_to_0_80 =  new TH1F("h_500_CT_wO_DR07_dphi_reco_gen_cosTheta_0_65_to_0_80","", n_bins100, -lim_angleDeg,lim_angleDeg);
  TH1F* h_500_CT_wO_DR07_dtheta_reco_gen_cosTheta_0_65_to_0_80 =  new TH1F("h_500_CT_wO_DR07_dtheta_reco_gen_cosTheta_0_65_to_0_80","", n_bins100, -lim_angleDeg,lim_angleDeg);
  TH1F* h_500_CT_wO_DR07_dphi_reco_gen_cosTheta_0_80_to_0_925 =  new TH1F("h_500_CT_wO_DR07_dphi_reco_gen_cosTheta_0_80_to_0_925","", n_bins100, -lim_angleDeg,lim_angleDeg);
  TH1F* h_500_CT_wO_DR07_dtheta_reco_gen_cosTheta_0_80_to_0_925 =  new TH1F("h_500_CT_wO_DR07_dtheta_reco_gen_cosTheta_0_80_to_0_925","", n_bins100, -lim_angleDeg,lim_angleDeg);
  TH1F* h_500_CT_wO_DR07_dphi_reco_gen_cosTheta_0_925_to_0_975 =  new TH1F("h_500_CT_wO_DR07_dphi_reco_gen_cosTheta_0_925_to_0_975","", n_bins100, -lim_angleDeg,lim_angleDeg);
  TH1F* h_500_CT_wO_DR07_dtheta_reco_gen_cosTheta_0_925_to_0_975 =  new TH1F("h_500_CT_wO_DR07_dtheta_reco_gen_cosTheta_0_925_to_0_975","", n_bins100, -lim_angleDeg,lim_angleDeg);

  TH1F* h_500_CT_wO_DR10_dphi_reco_gen_cosTheta_0_65 =  new TH1F("h_500_CT_wO_DR10_dphi_reco_gen_cosTheta_0_65","", n_bins100, -lim_angleDeg,lim_angleDeg);
  TH1F* h_500_CT_wO_DR10_dtheta_reco_gen_cosTheta_0_65 =  new TH1F("h_500_CT_wO_DR10_dtheta_reco_gen_cosTheta_0_65","", n_bins100, -lim_angleDeg,lim_angleDeg);
  TH1F* h_500_CT_wO_DR10_dphi_reco_gen_cosTheta_0_65_to_0_80 =  new TH1F("h_500_CT_wO_DR10_dphi_reco_gen_cosTheta_0_65_to_0_80","", n_bins100, -lim_angleDeg,lim_angleDeg);
  TH1F* h_500_CT_wO_DR10_dtheta_reco_gen_cosTheta_0_65_to_0_80 =  new TH1F("h_500_CT_wO_DR10_dtheta_reco_gen_cosTheta_0_65_to_0_80","", n_bins100, -lim_angleDeg,lim_angleDeg);
  TH1F* h_500_CT_wO_DR10_dphi_reco_gen_cosTheta_0_80_to_0_925 =  new TH1F("h_500_CT_wO_DR10_dphi_reco_gen_cosTheta_0_80_to_0_925","", n_bins100, -lim_angleDeg,lim_angleDeg);
  TH1F* h_500_CT_wO_DR10_dtheta_reco_gen_cosTheta_0_80_to_0_925 =  new TH1F("h_500_CT_wO_DR10_dtheta_reco_gen_cosTheta_0_80_to_0_925","", n_bins100, -lim_angleDeg,lim_angleDeg);
  TH1F* h_500_CT_wO_DR10_dphi_reco_gen_cosTheta_0_925_to_0_975 =  new TH1F("h_500_CT_wO_DR10_dphi_reco_gen_cosTheta_0_925_to_0_975","", n_bins100, -lim_angleDeg,lim_angleDeg);
  TH1F* h_500_CT_wO_DR10_dtheta_reco_gen_cosTheta_0_925_to_0_975 =  new TH1F("h_500_CT_wO_DR10_dtheta_reco_gen_cosTheta_0_925_to_0_975","", n_bins100, -lim_angleDeg,lim_angleDeg);

  std::vector<TH1F*> hist_vec_500_CT_wO;
  hist_vec_500_CT_wO.push_back(h_500_CT_wO_genjet03_dphi_j1j2);
  hist_vec_500_CT_wO.push_back(h_500_CT_wO_genjet03_E1_E2_over_E_True);
  hist_vec_500_CT_wO.push_back(h_500_CT_wO_genjet03_Delta_E1_E2_over_E12);
  hist_vec_500_CT_wO.push_back(h_500_CT_wO_genjet04_dphi_j1j2);
  hist_vec_500_CT_wO.push_back(h_500_CT_wO_genjet04_E1_E2_over_E_True);
  hist_vec_500_CT_wO.push_back(h_500_CT_wO_genjet04_Delta_E1_E2_over_E12);
  hist_vec_500_CT_wO.push_back(h_500_CT_wO_genjet05_dphi_j1j2);
  hist_vec_500_CT_wO.push_back(h_500_CT_wO_genjet05_E1_E2_over_E_True);
  hist_vec_500_CT_wO.push_back(h_500_CT_wO_genjet05_Delta_E1_E2_over_E12);
  hist_vec_500_CT_wO.push_back(h_500_CT_wO_genjet06_dphi_j1j2);
  hist_vec_500_CT_wO.push_back(h_500_CT_wO_genjet06_E1_E2_over_E_True);
  hist_vec_500_CT_wO.push_back(h_500_CT_wO_genjet06_Delta_E1_E2_over_E12);
  hist_vec_500_CT_wO.push_back(h_500_CT_wO_genjet07_dphi_j1j2);
  hist_vec_500_CT_wO.push_back(h_500_CT_wO_genjet07_E1_E2_over_E_True);
  hist_vec_500_CT_wO.push_back(h_500_CT_wO_genjet07_Delta_E1_E2_over_E12);
  hist_vec_500_CT_wO.push_back(h_500_CT_wO_genjet08_dphi_j1j2);
  hist_vec_500_CT_wO.push_back(h_500_CT_wO_genjet08_E1_E2_over_E_True);
  hist_vec_500_CT_wO.push_back(h_500_CT_wO_genjet08_Delta_E1_E2_over_E12);
  hist_vec_500_CT_wO.push_back(h_500_CT_wO_genjet09_dphi_j1j2);
  hist_vec_500_CT_wO.push_back(h_500_CT_wO_genjet09_E1_E2_over_E_True);
  hist_vec_500_CT_wO.push_back(h_500_CT_wO_genjet09_Delta_E1_E2_over_E12);
  hist_vec_500_CT_wO.push_back(h_500_CT_wO_genjet10_dphi_j1j2);
  hist_vec_500_CT_wO.push_back(h_500_CT_wO_genjet10_E1_E2_over_E_True);
  hist_vec_500_CT_wO.push_back(h_500_CT_wO_genjet10_Delta_E1_E2_over_E12);

  hist_vec_500_CT_wO.push_back(h_500_CT_wO_recojet03_dphi_j1j2);
  hist_vec_500_CT_wO.push_back(h_500_CT_wO_recojet03_E1_E2_over_E_True);
  hist_vec_500_CT_wO.push_back(h_500_CT_wO_recojet03_Delta_E1_E2_over_E12);
  hist_vec_500_CT_wO.push_back(h_500_CT_wO_recojet04_dphi_j1j2);
  hist_vec_500_CT_wO.push_back(h_500_CT_wO_recojet04_E1_E2_over_E_True);
  hist_vec_500_CT_wO.push_back(h_500_CT_wO_recojet04_Delta_E1_E2_over_E12);
  hist_vec_500_CT_wO.push_back(h_500_CT_wO_recojet05_dphi_j1j2);
  hist_vec_500_CT_wO.push_back(h_500_CT_wO_recojet05_E1_E2_over_E_True);
  hist_vec_500_CT_wO.push_back(h_500_CT_wO_recojet05_Delta_E1_E2_over_E12);
  hist_vec_500_CT_wO.push_back(h_500_CT_wO_recojet06_dphi_j1j2);
  hist_vec_500_CT_wO.push_back(h_500_CT_wO_recojet06_E1_E2_over_E_True);
  hist_vec_500_CT_wO.push_back(h_500_CT_wO_recojet06_Delta_E1_E2_over_E12);
  hist_vec_500_CT_wO.push_back(h_500_CT_wO_recojet07_dphi_j1j2);
  hist_vec_500_CT_wO.push_back(h_500_CT_wO_recojet07_E1_E2_over_E_True);
  hist_vec_500_CT_wO.push_back(h_500_CT_wO_recojet07_Delta_E1_E2_over_E12);
  hist_vec_500_CT_wO.push_back(h_500_CT_wO_recojet08_dphi_j1j2);
  hist_vec_500_CT_wO.push_back(h_500_CT_wO_recojet08_E1_E2_over_E_True);
  hist_vec_500_CT_wO.push_back(h_500_CT_wO_recojet08_Delta_E1_E2_over_E12);
  hist_vec_500_CT_wO.push_back(h_500_CT_wO_recojet09_dphi_j1j2);
  hist_vec_500_CT_wO.push_back(h_500_CT_wO_recojet09_E1_E2_over_E_True);
  hist_vec_500_CT_wO.push_back(h_500_CT_wO_recojet09_Delta_E1_E2_over_E12);
  hist_vec_500_CT_wO.push_back(h_500_CT_wO_recojet10_dphi_j1j2);
  hist_vec_500_CT_wO.push_back(h_500_CT_wO_recojet10_E1_E2_over_E_True);
  hist_vec_500_CT_wO.push_back(h_500_CT_wO_recojet10_Delta_E1_E2_over_E12);

  hist_vec_500_CT_wO.push_back(h_500_CT_wO_recojetE_over_genjetE_DR03);
  hist_vec_500_CT_wO.push_back(h_500_CT_wO_recojetE_over_genjetE_DR04);
  hist_vec_500_CT_wO.push_back(h_500_CT_wO_recojetE_over_genjetE_DR05);
  hist_vec_500_CT_wO.push_back(h_500_CT_wO_recojetE_over_genjetE_DR06);
  hist_vec_500_CT_wO.push_back(h_500_CT_wO_recojetE_over_genjetE_DR07);
  hist_vec_500_CT_wO.push_back(h_500_CT_wO_recojetE_over_genjetE_DR08);
  hist_vec_500_CT_wO.push_back(h_500_CT_wO_recojetE_over_genjetE_DR09);
  hist_vec_500_CT_wO.push_back(h_500_CT_wO_recojetE_over_genjetE_DR10);

  hist_vec_500_CT_wO.push_back(h_500_CT_wO_dphi_gen_reco_DR05);
  hist_vec_500_CT_wO.push_back(h_500_CT_wO_dphi_gen_reco_DR06);
  hist_vec_500_CT_wO.push_back(h_500_CT_wO_dphi_gen_reco_DR07);

  hist_vec_500_CT_wO.push_back(h_500_CT_wO_DR05_E_rel_totVis_RMS_d1_cosT_0_to_0_10);
  hist_vec_500_CT_wO.push_back(h_500_CT_wO_DR05_E_rel_totVis_RMS_d1_cosT_0_10_to_0_20);
  hist_vec_500_CT_wO.push_back(h_500_CT_wO_DR05_E_rel_totVis_RMS_d1_cosT_0_20_to_0_30);
  hist_vec_500_CT_wO.push_back(h_500_CT_wO_DR05_E_rel_totVis_RMS_d1_cosT_0_30_to_0_40);
  hist_vec_500_CT_wO.push_back(h_500_CT_wO_DR05_E_rel_totVis_RMS_d1_cosT_0_40_to_0_50);
  hist_vec_500_CT_wO.push_back(h_500_CT_wO_DR05_E_rel_totVis_RMS_d1_cosT_0_50_to_0_60);
  hist_vec_500_CT_wO.push_back(h_500_CT_wO_DR05_E_rel_totVis_RMS_d1_cosT_0_60_to_0_70);
  hist_vec_500_CT_wO.push_back(h_500_CT_wO_DR05_E_rel_totVis_RMS_d1_cosT_0_70_to_0_80);
  hist_vec_500_CT_wO.push_back(h_500_CT_wO_DR05_E_rel_totVis_RMS_d1_cosT_0_80_to_0_90);
  hist_vec_500_CT_wO.push_back(h_500_CT_wO_DR05_E_rel_totVis_RMS_d1_cosT_0_900_to_0_925);
  hist_vec_500_CT_wO.push_back(h_500_CT_wO_DR05_E_rel_totVis_RMS_d1_cosT_0_925_to_0_950);
  hist_vec_500_CT_wO.push_back(h_500_CT_wO_DR05_E_rel_totVis_RMS_d1_cosT_0_950_to_0_975);
  hist_vec_500_CT_wO.push_back(h_500_CT_wO_DR05_E_rel_totVis_RMS_d1_cosT_0_975_to_1_00);

  hist_vec_500_CT_wO.push_back(h_500_CT_wO_DR06_E_rel_totVis_RMS_d1_cosT_0_to_0_10);
  hist_vec_500_CT_wO.push_back(h_500_CT_wO_DR06_E_rel_totVis_RMS_d1_cosT_0_10_to_0_20);
  hist_vec_500_CT_wO.push_back(h_500_CT_wO_DR06_E_rel_totVis_RMS_d1_cosT_0_20_to_0_30);
  hist_vec_500_CT_wO.push_back(h_500_CT_wO_DR06_E_rel_totVis_RMS_d1_cosT_0_30_to_0_40);
  hist_vec_500_CT_wO.push_back(h_500_CT_wO_DR06_E_rel_totVis_RMS_d1_cosT_0_40_to_0_50);
  hist_vec_500_CT_wO.push_back(h_500_CT_wO_DR06_E_rel_totVis_RMS_d1_cosT_0_50_to_0_60);
  hist_vec_500_CT_wO.push_back(h_500_CT_wO_DR06_E_rel_totVis_RMS_d1_cosT_0_60_to_0_70);
  hist_vec_500_CT_wO.push_back(h_500_CT_wO_DR06_E_rel_totVis_RMS_d1_cosT_0_70_to_0_80);
  hist_vec_500_CT_wO.push_back(h_500_CT_wO_DR06_E_rel_totVis_RMS_d1_cosT_0_80_to_0_90);
  hist_vec_500_CT_wO.push_back(h_500_CT_wO_DR06_E_rel_totVis_RMS_d1_cosT_0_900_to_0_925);
  hist_vec_500_CT_wO.push_back(h_500_CT_wO_DR06_E_rel_totVis_RMS_d1_cosT_0_925_to_0_950);
  hist_vec_500_CT_wO.push_back(h_500_CT_wO_DR06_E_rel_totVis_RMS_d1_cosT_0_950_to_0_975);
  hist_vec_500_CT_wO.push_back(h_500_CT_wO_DR06_E_rel_totVis_RMS_d1_cosT_0_975_to_1_00); 

  hist_vec_500_CT_wO.push_back(h_500_CT_wO_DR07_E_rel_totVis_RMS_d1_cosT_0_to_0_10);
  hist_vec_500_CT_wO.push_back(h_500_CT_wO_DR07_E_rel_totVis_RMS_d1_cosT_0_10_to_0_20);
  hist_vec_500_CT_wO.push_back(h_500_CT_wO_DR07_E_rel_totVis_RMS_d1_cosT_0_20_to_0_30);
  hist_vec_500_CT_wO.push_back(h_500_CT_wO_DR07_E_rel_totVis_RMS_d1_cosT_0_30_to_0_40);
  hist_vec_500_CT_wO.push_back(h_500_CT_wO_DR07_E_rel_totVis_RMS_d1_cosT_0_40_to_0_50);
  hist_vec_500_CT_wO.push_back(h_500_CT_wO_DR07_E_rel_totVis_RMS_d1_cosT_0_50_to_0_60);
  hist_vec_500_CT_wO.push_back(h_500_CT_wO_DR07_E_rel_totVis_RMS_d1_cosT_0_60_to_0_70);
  hist_vec_500_CT_wO.push_back(h_500_CT_wO_DR07_E_rel_totVis_RMS_d1_cosT_0_70_to_0_80);
  hist_vec_500_CT_wO.push_back(h_500_CT_wO_DR07_E_rel_totVis_RMS_d1_cosT_0_80_to_0_90);
  hist_vec_500_CT_wO.push_back(h_500_CT_wO_DR07_E_rel_totVis_RMS_d1_cosT_0_900_to_0_925);
  hist_vec_500_CT_wO.push_back(h_500_CT_wO_DR07_E_rel_totVis_RMS_d1_cosT_0_925_to_0_950);
  hist_vec_500_CT_wO.push_back(h_500_CT_wO_DR07_E_rel_totVis_RMS_d1_cosT_0_950_to_0_975);
  hist_vec_500_CT_wO.push_back(h_500_CT_wO_DR07_E_rel_totVis_RMS_d1_cosT_0_975_to_1_00); 

  hist_vec_500_CT_wO.push_back(h_500_CT_wO_DR08_E_rel_totVis_RMS_d1_cosT_0_to_0_10);
  hist_vec_500_CT_wO.push_back(h_500_CT_wO_DR08_E_rel_totVis_RMS_d1_cosT_0_10_to_0_20);
  hist_vec_500_CT_wO.push_back(h_500_CT_wO_DR08_E_rel_totVis_RMS_d1_cosT_0_20_to_0_30);
  hist_vec_500_CT_wO.push_back(h_500_CT_wO_DR08_E_rel_totVis_RMS_d1_cosT_0_30_to_0_40);
  hist_vec_500_CT_wO.push_back(h_500_CT_wO_DR08_E_rel_totVis_RMS_d1_cosT_0_40_to_0_50);
  hist_vec_500_CT_wO.push_back(h_500_CT_wO_DR08_E_rel_totVis_RMS_d1_cosT_0_50_to_0_60);
  hist_vec_500_CT_wO.push_back(h_500_CT_wO_DR08_E_rel_totVis_RMS_d1_cosT_0_60_to_0_70);
  hist_vec_500_CT_wO.push_back(h_500_CT_wO_DR08_E_rel_totVis_RMS_d1_cosT_0_70_to_0_80);
  hist_vec_500_CT_wO.push_back(h_500_CT_wO_DR08_E_rel_totVis_RMS_d1_cosT_0_80_to_0_90);
  hist_vec_500_CT_wO.push_back(h_500_CT_wO_DR08_E_rel_totVis_RMS_d1_cosT_0_900_to_0_925);
  hist_vec_500_CT_wO.push_back(h_500_CT_wO_DR08_E_rel_totVis_RMS_d1_cosT_0_925_to_0_950);
  hist_vec_500_CT_wO.push_back(h_500_CT_wO_DR08_E_rel_totVis_RMS_d1_cosT_0_950_to_0_975);
  hist_vec_500_CT_wO.push_back(h_500_CT_wO_DR08_E_rel_totVis_RMS_d1_cosT_0_975_to_1_00); //110

  hist_vec_500_CT_wO.push_back(h_500_CT_wO_DR09_E_rel_totVis_RMS_d1_cosT_0_to_0_10);
  hist_vec_500_CT_wO.push_back(h_500_CT_wO_DR09_E_rel_totVis_RMS_d1_cosT_0_10_to_0_20);
  hist_vec_500_CT_wO.push_back(h_500_CT_wO_DR09_E_rel_totVis_RMS_d1_cosT_0_20_to_0_30);
  hist_vec_500_CT_wO.push_back(h_500_CT_wO_DR09_E_rel_totVis_RMS_d1_cosT_0_30_to_0_40);
  hist_vec_500_CT_wO.push_back(h_500_CT_wO_DR09_E_rel_totVis_RMS_d1_cosT_0_40_to_0_50);
  hist_vec_500_CT_wO.push_back(h_500_CT_wO_DR09_E_rel_totVis_RMS_d1_cosT_0_50_to_0_60);
  hist_vec_500_CT_wO.push_back(h_500_CT_wO_DR09_E_rel_totVis_RMS_d1_cosT_0_60_to_0_70);
  hist_vec_500_CT_wO.push_back(h_500_CT_wO_DR09_E_rel_totVis_RMS_d1_cosT_0_70_to_0_80);
  hist_vec_500_CT_wO.push_back(h_500_CT_wO_DR09_E_rel_totVis_RMS_d1_cosT_0_80_to_0_90);
  hist_vec_500_CT_wO.push_back(h_500_CT_wO_DR09_E_rel_totVis_RMS_d1_cosT_0_900_to_0_925);
  hist_vec_500_CT_wO.push_back(h_500_CT_wO_DR09_E_rel_totVis_RMS_d1_cosT_0_925_to_0_950);
  hist_vec_500_CT_wO.push_back(h_500_CT_wO_DR09_E_rel_totVis_RMS_d1_cosT_0_950_to_0_975);
  hist_vec_500_CT_wO.push_back(h_500_CT_wO_DR09_E_rel_totVis_RMS_d1_cosT_0_975_to_1_00); //123

  hist_vec_500_CT_wO.push_back(h_500_CT_wO_DR10_E_rel_totVis_RMS_d1_cosT_0_to_0_10);
  hist_vec_500_CT_wO.push_back(h_500_CT_wO_DR10_E_rel_totVis_RMS_d1_cosT_0_10_to_0_20);
  hist_vec_500_CT_wO.push_back(h_500_CT_wO_DR10_E_rel_totVis_RMS_d1_cosT_0_20_to_0_30);
  hist_vec_500_CT_wO.push_back(h_500_CT_wO_DR10_E_rel_totVis_RMS_d1_cosT_0_30_to_0_40);
  hist_vec_500_CT_wO.push_back(h_500_CT_wO_DR10_E_rel_totVis_RMS_d1_cosT_0_40_to_0_50);
  hist_vec_500_CT_wO.push_back(h_500_CT_wO_DR10_E_rel_totVis_RMS_d1_cosT_0_50_to_0_60);
  hist_vec_500_CT_wO.push_back(h_500_CT_wO_DR10_E_rel_totVis_RMS_d1_cosT_0_60_to_0_70);
  hist_vec_500_CT_wO.push_back(h_500_CT_wO_DR10_E_rel_totVis_RMS_d1_cosT_0_70_to_0_80);
  hist_vec_500_CT_wO.push_back(h_500_CT_wO_DR10_E_rel_totVis_RMS_d1_cosT_0_80_to_0_90);
  hist_vec_500_CT_wO.push_back(h_500_CT_wO_DR10_E_rel_totVis_RMS_d1_cosT_0_900_to_0_925);
  hist_vec_500_CT_wO.push_back(h_500_CT_wO_DR10_E_rel_totVis_RMS_d1_cosT_0_925_to_0_950);
  hist_vec_500_CT_wO.push_back(h_500_CT_wO_DR10_E_rel_totVis_RMS_d1_cosT_0_950_to_0_975);
  hist_vec_500_CT_wO.push_back(h_500_CT_wO_DR10_E_rel_totVis_RMS_d1_cosT_0_975_to_1_00); //136

  hist_vec_500_CT_wO.push_back(h_500_CT_wO_DR05_dphi_reco_gen_cosTheta_0_65);//137
  hist_vec_500_CT_wO.push_back(h_500_CT_wO_DR05_dphi_reco_gen_cosTheta_0_65_to_0_80);
  hist_vec_500_CT_wO.push_back(h_500_CT_wO_DR05_dphi_reco_gen_cosTheta_0_80_to_0_925);
  hist_vec_500_CT_wO.push_back(h_500_CT_wO_DR05_dphi_reco_gen_cosTheta_0_925_to_0_975);
  hist_vec_500_CT_wO.push_back(h_500_CT_wO_DR05_dtheta_reco_gen_cosTheta_0_65);
  hist_vec_500_CT_wO.push_back(h_500_CT_wO_DR05_dtheta_reco_gen_cosTheta_0_65_to_0_80);
  hist_vec_500_CT_wO.push_back(h_500_CT_wO_DR05_dtheta_reco_gen_cosTheta_0_80_to_0_925);
  hist_vec_500_CT_wO.push_back(h_500_CT_wO_DR05_dtheta_reco_gen_cosTheta_0_925_to_0_975);

  hist_vec_500_CT_wO.push_back(h_500_CT_wO_DR07_dphi_reco_gen_cosTheta_0_65);//145
  hist_vec_500_CT_wO.push_back(h_500_CT_wO_DR07_dphi_reco_gen_cosTheta_0_65_to_0_80);
  hist_vec_500_CT_wO.push_back(h_500_CT_wO_DR07_dphi_reco_gen_cosTheta_0_80_to_0_925);
  hist_vec_500_CT_wO.push_back(h_500_CT_wO_DR07_dphi_reco_gen_cosTheta_0_925_to_0_975);
  hist_vec_500_CT_wO.push_back(h_500_CT_wO_DR07_dtheta_reco_gen_cosTheta_0_65);
  hist_vec_500_CT_wO.push_back(h_500_CT_wO_DR07_dtheta_reco_gen_cosTheta_0_65_to_0_80);
  hist_vec_500_CT_wO.push_back(h_500_CT_wO_DR07_dtheta_reco_gen_cosTheta_0_80_to_0_925);
  hist_vec_500_CT_wO.push_back(h_500_CT_wO_DR07_dtheta_reco_gen_cosTheta_0_925_to_0_975);

  hist_vec_500_CT_wO.push_back(h_500_CT_wO_DR10_dphi_reco_gen_cosTheta_0_65);//153
  hist_vec_500_CT_wO.push_back(h_500_CT_wO_DR10_dphi_reco_gen_cosTheta_0_65_to_0_80);
  hist_vec_500_CT_wO.push_back(h_500_CT_wO_DR10_dphi_reco_gen_cosTheta_0_80_to_0_925);
  hist_vec_500_CT_wO.push_back(h_500_CT_wO_DR10_dphi_reco_gen_cosTheta_0_925_to_0_975);
  hist_vec_500_CT_wO.push_back(h_500_CT_wO_DR10_dtheta_reco_gen_cosTheta_0_65);
  hist_vec_500_CT_wO.push_back(h_500_CT_wO_DR10_dtheta_reco_gen_cosTheta_0_65_to_0_80);
  hist_vec_500_CT_wO.push_back(h_500_CT_wO_DR10_dtheta_reco_gen_cosTheta_0_80_to_0_925);
  hist_vec_500_CT_wO.push_back(h_500_CT_wO_DR10_dtheta_reco_gen_cosTheta_0_925_to_0_975);

  for(unsigned int i=0;i<hist_vec_500_CT_wO.size();i++){
    hist_vec_500_CT_wO[i]->Sumw2();
  }
  fill_jet_histograms(file_CLIC_500_CT_wO,hist_vec_500_CT_wO);

  TH1F* h_500_CT_wO_DR05_dphi_SigmaCB_summary_histogram=new TH1F("dphiRes_SigmaCBVsCosTheta_CT_wO_DR05_500", "#sigma#Delta#phi(j_{reco},j_{true}) vs |cos#theta|", nRegionBinsAngles, pRegionBinEdgesAngles);
  h_500_CT_wO_DR05_dphi_SigmaCB_summary_histogram ->SetYTitle("#sigma#Delta#phi(j_{reco},j_{true})");
  h_500_CT_wO_DR05_dphi_SigmaCB_summary_histogram->SetXTitle("|cos#theta|");
  h_500_CT_wO_DR05_dphi_SigmaCB_summary_histogram->SetLineWidth(2);
  h_500_CT_wO_DR05_dphi_SigmaCB_summary_histogram->SetLineColor(kCyan+1);
  h_500_CT_wO_DR05_dphi_SigmaCB_summary_histogram->SetLineStyle(2);

  TH1F* h_500_CT_wO_DR05_dphi_RMS90_summary_histogram=new TH1F("dphiRes_RMS90VsCosTheta_CT_wO_DR05_500", "RMS_{90} #Delta#phi(j_{reco},j_{true}) vs |cos#theta|", nRegionBinsAngles, pRegionBinEdgesAngles);
  h_500_CT_wO_DR05_dphi_RMS90_summary_histogram ->SetYTitle("RMS_{90}#Delta#phi(j_{reco},j_{true})");
  h_500_CT_wO_DR05_dphi_RMS90_summary_histogram->SetXTitle("|cos#theta|");
  h_500_CT_wO_DR05_dphi_RMS90_summary_histogram->SetLineWidth(2);
  h_500_CT_wO_DR05_dphi_RMS90_summary_histogram->SetLineColor(kCyan+1);
  h_500_CT_wO_DR05_dphi_RMS90_summary_histogram->SetLineStyle(2);

  TH1F* h_500_CT_wO_DR07_dphi_SigmaCB_summary_histogram=new TH1F("dphiRes_SigmaCBVsCosTheta_CT_wO_DR07_500", "#sigma#Delta#phi(j_{reco},j_{true}) vs |cos#theta|", nRegionBinsAngles, pRegionBinEdgesAngles);
  h_500_CT_wO_DR07_dphi_SigmaCB_summary_histogram ->SetYTitle("#sigma#Delta#phi(j_{reco},j_{true})");
  h_500_CT_wO_DR07_dphi_SigmaCB_summary_histogram->SetXTitle("|cos#theta|");
  h_500_CT_wO_DR07_dphi_SigmaCB_summary_histogram->SetLineWidth(2);
  h_500_CT_wO_DR07_dphi_SigmaCB_summary_histogram->SetLineColor(kCyan+1);
  h_500_CT_wO_DR07_dphi_SigmaCB_summary_histogram->SetLineStyle(2);

  TH1F* h_500_CT_wO_DR07_dphi_RMS90_summary_histogram=new TH1F("dphiRes_RMS90VsCosTheta_CT_wO_DR07_500", "RMS_{90} #Delta#phi(j_{reco},j_{true}) vs |cos#theta|", nRegionBinsAngles, pRegionBinEdgesAngles);
  h_500_CT_wO_DR07_dphi_RMS90_summary_histogram ->SetYTitle("RMS_{90}#Delta#phi(j_{reco},j_{true})");
  h_500_CT_wO_DR07_dphi_RMS90_summary_histogram->SetXTitle("|cos#theta|");
  h_500_CT_wO_DR07_dphi_RMS90_summary_histogram->SetLineWidth(2);
  h_500_CT_wO_DR07_dphi_RMS90_summary_histogram->SetLineColor(kCyan+1);
  h_500_CT_wO_DR07_dphi_RMS90_summary_histogram->SetLineStyle(2);

  TH1F* h_500_CT_wO_DR10_dphi_SigmaCB_summary_histogram=new TH1F("dphiRes_SigmaCBVsCosTheta_CT_wO_DR10_500", "#sigma#Delta#phi(j_{reco},j_{true}) vs |cos#theta|", nRegionBinsAngles, pRegionBinEdgesAngles);
  h_500_CT_wO_DR10_dphi_SigmaCB_summary_histogram ->SetYTitle("#sigma#Delta#phi(j_{reco},j_{true})");
  h_500_CT_wO_DR10_dphi_SigmaCB_summary_histogram->SetXTitle("|cos#theta|");
  h_500_CT_wO_DR10_dphi_SigmaCB_summary_histogram->SetLineWidth(2);
  h_500_CT_wO_DR10_dphi_SigmaCB_summary_histogram->SetLineColor(kCyan+1);
  h_500_CT_wO_DR10_dphi_SigmaCB_summary_histogram->SetLineStyle(2);

  TH1F* h_500_CT_wO_DR10_dphi_RMS90_summary_histogram=new TH1F("dphiRes_RMS90VsCosTheta_CT_wO_DR10_500", "RMS_{90} #Delta#phi(j_{reco},j_{true}) vs |cos#theta|", nRegionBinsAngles, pRegionBinEdgesAngles);
  h_500_CT_wO_DR10_dphi_RMS90_summary_histogram ->SetYTitle("RMS_{90}#Delta#phi(j_{reco},j_{true})");
  h_500_CT_wO_DR10_dphi_RMS90_summary_histogram->SetXTitle("|cos#theta|");
  h_500_CT_wO_DR10_dphi_RMS90_summary_histogram->SetLineWidth(2);
  h_500_CT_wO_DR10_dphi_RMS90_summary_histogram->SetLineColor(kCyan+1);
  h_500_CT_wO_DR10_dphi_RMS90_summary_histogram->SetLineStyle(2);

  TH1F* h_500_CT_wO_DR05_dtheta_SigmaCB_summary_histogram=new TH1F("dthetaRes_SigmaCBVsCosTheta_CT_wO_DR05_500", "#sigma#Delta#theta(j_{reco},j_{true}) vs |cos#theta|", nRegionBinsAngles, pRegionBinEdgesAngles);
  h_500_CT_wO_DR05_dtheta_SigmaCB_summary_histogram ->SetYTitle("#sigma#Delta#theta(j_{reco},j_{true})");
  h_500_CT_wO_DR05_dtheta_SigmaCB_summary_histogram->SetXTitle("|cos#theta|");
  h_500_CT_wO_DR05_dtheta_SigmaCB_summary_histogram->SetLineWidth(2);
  h_500_CT_wO_DR05_dtheta_SigmaCB_summary_histogram->SetLineColor(kCyan+1);
  h_500_CT_wO_DR05_dtheta_SigmaCB_summary_histogram->SetLineStyle(2);

  TH1F* h_500_CT_wO_DR05_dtheta_RMS90_summary_histogram=new TH1F("dthetaRes_RMS90VsCosTheta_CT_wO_DR05_500", "RMS_{90} #Delta#theta(j_{reco},j_{true}) vs |cos#theta|", nRegionBinsAngles, pRegionBinEdgesAngles);
  h_500_CT_wO_DR05_dtheta_RMS90_summary_histogram ->SetYTitle("RMS_{90}#Delta#theta(j_{reco},j_{true})");
  h_500_CT_wO_DR05_dtheta_RMS90_summary_histogram->SetXTitle("|cos#theta|");
  h_500_CT_wO_DR05_dtheta_RMS90_summary_histogram->SetLineWidth(2);
  h_500_CT_wO_DR05_dtheta_RMS90_summary_histogram->SetLineColor(kCyan+1);
  h_500_CT_wO_DR05_dtheta_RMS90_summary_histogram->SetLineStyle(2);

  TH1F* h_500_CT_wO_DR07_dtheta_SigmaCB_summary_histogram=new TH1F("dthetaRes_SigmaCBVsCosTheta_CT_wO_DR07_500", "#sigma#Delta#theta(j_{reco},j_{true}) vs |cos#theta|", nRegionBinsAngles, pRegionBinEdgesAngles);
  h_500_CT_wO_DR07_dtheta_SigmaCB_summary_histogram ->SetYTitle("#sigma#Delta#theta(j_{reco},j_{true})");
  h_500_CT_wO_DR07_dtheta_SigmaCB_summary_histogram->SetXTitle("|cos#theta|");
  h_500_CT_wO_DR07_dtheta_SigmaCB_summary_histogram->SetLineWidth(2);
  h_500_CT_wO_DR07_dtheta_SigmaCB_summary_histogram->SetLineColor(kCyan+1);
  h_500_CT_wO_DR07_dtheta_SigmaCB_summary_histogram->SetLineStyle(2);

  TH1F* h_500_CT_wO_DR07_dtheta_RMS90_summary_histogram=new TH1F("dthetaRes_RMS90VsCosTheta_CT_wO_DR07_500", "RMS_{90} #Delta#theta(j_{reco},j_{true}) vs |cos#theta|", nRegionBinsAngles, pRegionBinEdgesAngles);
  h_500_CT_wO_DR07_dtheta_RMS90_summary_histogram ->SetYTitle("RMS_{90}#Delta#theta(j_{reco},j_{true})");
  h_500_CT_wO_DR07_dtheta_RMS90_summary_histogram->SetXTitle("|cos#theta|");
  h_500_CT_wO_DR07_dtheta_RMS90_summary_histogram->SetLineWidth(2);
  h_500_CT_wO_DR07_dtheta_RMS90_summary_histogram->SetLineColor(kCyan+1);
  h_500_CT_wO_DR07_dtheta_RMS90_summary_histogram->SetLineStyle(2);

  TH1F* h_500_CT_wO_DR10_dtheta_SigmaCB_summary_histogram=new TH1F("dthetaRes_SigmaCBVsCosTheta_CT_wO_DR10_500", "#sigma#Delta#theta(j_{reco},j_{true}) vs |cos#theta|", nRegionBinsAngles, pRegionBinEdgesAngles);
  h_500_CT_wO_DR10_dtheta_SigmaCB_summary_histogram ->SetYTitle("#sigma#Delta#theta(j_{reco},j_{true})");
  h_500_CT_wO_DR10_dtheta_SigmaCB_summary_histogram->SetXTitle("|cos#theta|");
  h_500_CT_wO_DR10_dtheta_SigmaCB_summary_histogram->SetLineWidth(2);
  h_500_CT_wO_DR10_dtheta_SigmaCB_summary_histogram->SetLineColor(kCyan+1);
  h_500_CT_wO_DR10_dtheta_SigmaCB_summary_histogram->SetLineStyle(2);

  TH1F* h_500_CT_wO_DR10_dtheta_RMS90_summary_histogram=new TH1F("dthetaRes_RMS90VsCosTheta_CT_wO_DR10_500", "RMS_{90} #Delta#theta(j_{reco},j_{true}) vs |cos#theta|", nRegionBinsAngles, pRegionBinEdgesAngles);
  h_500_CT_wO_DR10_dtheta_RMS90_summary_histogram ->SetYTitle("RMS_{90}#Delta#theta(j_{reco},j_{true})");
  h_500_CT_wO_DR10_dtheta_RMS90_summary_histogram->SetXTitle("|cos#theta|");
  h_500_CT_wO_DR10_dtheta_RMS90_summary_histogram->SetLineWidth(2);
  h_500_CT_wO_DR10_dtheta_RMS90_summary_histogram->SetLineColor(kCyan+1);
  h_500_CT_wO_DR10_dtheta_RMS90_summary_histogram->SetLineStyle(2);

  for(int i=137;i<161;i++){
    //continue;
    std::cout<<"ang histo 500 "<<i<<"]"<<std::endl;
   //double sided crystal ball
    TF1* fit_gaus_tmp = new TF1("fit_gaus_tmp", "gaus",-5.,5.);
    hist_vec_500_CT_wO[i]->Fit("fit_gaus_tmp","R");
    hist_vec_500_CT_wO[i]->GetFunction("fit_gaus_tmp");
    TF1* fdscb_tmp = new TF1("fdscb_tmp",fnc_dscb,-lim_angleDeg,lim_angleDeg,7);
   fdscb_tmp->SetNpx(2000);
    fdscb_tmp->SetParameter(0,fit_gaus_tmp->GetParameter(0));
    //norm
    fdscb_tmp->SetParLimits (0,0.5*fit_gaus_tmp->GetParameter(0),1.5*fit_gaus_tmp->GetParameter(0));
    fdscb_tmp->SetParameter(1,fit_gaus_tmp->GetParameter(1));
    //gaussian mean
    fdscb_tmp->SetParLimits (1,-2.,2.);
    fdscb_tmp->SetParameter(2,fit_gaus_tmp->GetParameter(2));
    fdscb_tmp->SetParLimits(2,fit_gaus_tmp->GetParameter(2)*0.50,1.50*fit_gaus_tmp->GetParameter(2));
    //std::vector<float>sigma2SFit=sigmaGaussianFits2Sigma(hist_vec_500_CT_wO[i]);
    //fdscb_tmp->SetParameter(2,sigma2SFit[0]);
    //fdscb_tmp->SetParLimits(2,sigma2SFit[0]*0.50,1.50*sigma2SFit[0]);
    //-a1: parameter, from when the gaussian core should count
    //fdscb_tmp->SetParameter(2,fit_gaus_tmp->GetParameter(2));
    fdscb_tmp->SetParameter (3,3.0);
    fdscb_tmp->SetParLimits (3,0.0,10.0);
    //a2 parameter, up to when the gaussian core should count
    fdscb_tmp->SetParameter (5,3.0);
    fdscb_tmp->SetParLimits (5,0.0,10.0);
    fdscb_tmp->SetParameter(4,5.);
    fdscb_tmp->SetParLimits(4,0.,25.);
    fdscb_tmp->SetParameter(6,5.);
    fdscb_tmp->SetParLimits(6,0.,25.);
    int fitstatus(0); 
    fitstatus = hist_vec_500_CT_wO[i]->Fit(fdscb_tmp,"R");
    fdscb_tmp = hist_vec_500_CT_wO[i]->GetFunction("fdscb_tmp");
    resolutionTH1=0; 
    resolutionErrorTH1=0;
    meanTH1=0;
    meanErrorTH1=0;
    CalculatePerformanceNoMean( hist_vec_500_CT_wO[i], resolutionTH1, resolutionErrorTH1,meanTH1,meanErrorTH1);
    int first_bin_ang=137;
    if(i<141){//dphi DR05
      first_bin_ang=137;
      h_500_CT_wO_DR05_dphi_SigmaCB_summary_histogram->SetBinContent(i-first_bin_ang+1,fdscb_tmp->GetParameter(2));
      h_500_CT_wO_DR05_dphi_SigmaCB_summary_histogram->SetBinError(i-first_bin_ang+1,fdscb_tmp->GetParError(2));
      h_500_CT_wO_DR05_dphi_RMS90_summary_histogram->SetBinContent(i-first_bin_ang+1,resolutionTH1);
      h_500_CT_wO_DR05_dphi_RMS90_summary_histogram->SetBinError(i-first_bin_ang+1, resolutionErrorTH1);
    }else if(i<145){//dtheta DR05
      first_bin_ang=141;
      h_500_CT_wO_DR05_dtheta_SigmaCB_summary_histogram->SetBinContent(i-first_bin_ang+1,fdscb_tmp->GetParameter(2));
      h_500_CT_wO_DR05_dtheta_SigmaCB_summary_histogram->SetBinError(i-first_bin_ang+1,fdscb_tmp->GetParError(2));
      h_500_CT_wO_DR05_dtheta_RMS90_summary_histogram->SetBinContent(i-first_bin_ang+1,resolutionTH1);
      h_500_CT_wO_DR05_dtheta_RMS90_summary_histogram->SetBinError(i-first_bin_ang+1, resolutionErrorTH1);
    }else if(i<149){//dphi DR07
      first_bin_ang=145;
      h_500_CT_wO_DR07_dphi_SigmaCB_summary_histogram->SetBinContent(i-first_bin_ang+1,fdscb_tmp->GetParameter(2));
      h_500_CT_wO_DR07_dphi_SigmaCB_summary_histogram->SetBinError(i-first_bin_ang+1,fdscb_tmp->GetParError(2));
      h_500_CT_wO_DR07_dphi_RMS90_summary_histogram->SetBinContent(i-first_bin_ang+1,resolutionTH1);
      h_500_CT_wO_DR07_dphi_RMS90_summary_histogram->SetBinError(i-first_bin_ang+1, resolutionErrorTH1);
    }else if(i<153){//dtheta DR07
      first_bin_ang=149;
      h_500_CT_wO_DR07_dtheta_SigmaCB_summary_histogram->SetBinContent(i-first_bin_ang+1,fdscb_tmp->GetParameter(2));
      h_500_CT_wO_DR07_dtheta_SigmaCB_summary_histogram->SetBinError(i-first_bin_ang+1,fdscb_tmp->GetParError(2));
      h_500_CT_wO_DR07_dtheta_RMS90_summary_histogram->SetBinContent(i-first_bin_ang+1,resolutionTH1);
      h_500_CT_wO_DR07_dtheta_RMS90_summary_histogram->SetBinError(i-first_bin_ang+1, resolutionErrorTH1);
    }else if(i<157){//dphi DR07
      first_bin_ang=153;
      h_500_CT_wO_DR10_dphi_SigmaCB_summary_histogram->SetBinContent(i-first_bin_ang+1,fdscb_tmp->GetParameter(2));
      h_500_CT_wO_DR10_dphi_SigmaCB_summary_histogram->SetBinError(i-first_bin_ang+1,fdscb_tmp->GetParError(2));
      h_500_CT_wO_DR10_dphi_RMS90_summary_histogram->SetBinContent(i-first_bin_ang+1,resolutionTH1);
      h_500_CT_wO_DR10_dphi_RMS90_summary_histogram->SetBinError(i-first_bin_ang+1, resolutionErrorTH1);
    }else if(i<161){//dtheta DR07
      first_bin_ang=157;
      h_500_CT_wO_DR10_dtheta_SigmaCB_summary_histogram->SetBinContent(i-first_bin_ang+1,fdscb_tmp->GetParameter(2));
      h_500_CT_wO_DR10_dtheta_SigmaCB_summary_histogram->SetBinError(i-first_bin_ang+1,fdscb_tmp->GetParError(2));
      h_500_CT_wO_DR10_dtheta_RMS90_summary_histogram->SetBinContent(i-first_bin_ang+1,resolutionTH1);
      h_500_CT_wO_DR10_dtheta_RMS90_summary_histogram->SetBinError(i-first_bin_ang+1, resolutionErrorTH1);
    }
  }

  TH1F* h_500_CT_wO_DR05_E_SigmaCB_summary_histogram=new TH1F("JER_SigmaCBVsCosTheta_CT_wO_DR05_500", "RMS_{90}(E_{j}^{reco}/E_{j}^{gen}) / Mean_{90}(E_{j}^{reco}/E_{j}^{gen}) vs |cos#theta|", nRegionBins, pRegionBinEdges);
  h_500_CT_wO_DR05_E_SigmaCB_summary_histogram ->SetYTitle("#sigma(E_{j}) / E_{j} [%]");
  h_500_CT_wO_DR05_E_SigmaCB_summary_histogram->SetXTitle("|cos#theta|");
  h_500_CT_wO_DR05_E_SigmaCB_summary_histogram->SetLineWidth(2);
  h_500_CT_wO_DR05_E_SigmaCB_summary_histogram->SetLineColor(kGreen-2);
  h_500_CT_wO_DR05_E_SigmaCB_summary_histogram->SetLineStyle(2);
  TH1F* h_500_CT_wO_DR05_E_RMS90_summary_histogram=new TH1F("JER_RMS90VsCosTheta_CT_wO_DR05_500", "RMS_{90}(E_{j}^{reco}/E_{j}^{gen}) / Mean_{90}(E_{j}^{reco}/E_{j}^{gen}) vs |cos#theta|", nRegionBins, pRegionBinEdges);
  h_500_CT_wO_DR05_E_RMS90_summary_histogram ->SetYTitle("RMS_{90}(E_{j}^{reco}/E_{j}^{gen}) / Mean_{90}(E_{j}^{reco}/E_{j}^{gen}) [%]");
  h_500_CT_wO_DR05_E_RMS90_summary_histogram->SetXTitle("|cos#theta|");
  h_500_CT_wO_DR05_E_RMS90_summary_histogram->SetLineWidth(2);
  h_500_CT_wO_DR05_E_RMS90_summary_histogram->SetLineColor(kGreen-2);
  h_500_CT_wO_DR05_E_RMS90_summary_histogram->SetLineStyle(2);

  TH1F* h_500_CT_wO_DR05_E_RMS_summary_histogram=new TH1F("JER_RMSVsCosTheta_CT_wO_DR05_500", "RMS(E_{j}) / Mean(E_{j}) vs |cos#theta|", nRegionBins, pRegionBinEdges);
  h_500_CT_wO_DR05_E_RMS_summary_histogram ->SetYTitle("RMS(E_{j}) / Mean(E_{j}) [%]");
  h_500_CT_wO_DR05_E_RMS_summary_histogram->SetXTitle("|cos#theta|");
  h_500_CT_wO_DR05_E_RMS_summary_histogram->SetLineWidth(2);
  h_500_CT_wO_DR05_E_RMS_summary_histogram->SetLineColor(kGreen-2);
  h_500_CT_wO_DR05_E_RMS_summary_histogram->SetLineStyle(2);

  TH1F* h_500_CT_wO_DR05_E_JER_Mean_summary_histogram=new TH1F("JER_MeanVsCosTheta_CT_wO_DR05_500", "Mean(E_{tot}^{RECO}/E_{tot}^{true}) vs |cos#theta|", nRegionBins, pRegionBinEdges);
  h_500_CT_wO_DR05_E_JER_Mean_summary_histogram->SetYTitle("Mean(E_{tot}^{RECO}/E_{tot}^{true})");
  h_500_CT_wO_DR05_E_JER_Mean_summary_histogram->SetXTitle("|cos#theta|");
  h_500_CT_wO_DR05_E_JER_Mean_summary_histogram->SetLineWidth(2);
  h_500_CT_wO_DR05_E_JER_Mean_summary_histogram->SetLineColor(kGreen-2);
  h_500_CT_wO_DR05_E_JER_Mean_summary_histogram->SetLineStyle(2);

  firstbin=59;
  for(int i=firstbin;i<(firstbin+13);i++){
    //continue;
    resolutionTH1=0; 
    resolutionErrorTH1=0;
    meanTH1=0;
    meanErrorTH1=0;
    CalculatePerformance( hist_vec_500_CT_wO[i], resolutionTH1, resolutionErrorTH1,meanTH1,meanErrorTH1);
    h_500_CT_wO_DR05_E_RMS90_summary_histogram->SetBinContent(i-firstbin+1,resolutionTH1/sqrt(2.));
    h_500_CT_wO_DR05_E_RMS90_summary_histogram ->SetBinError(i-firstbin+1, resolutionErrorTH1/sqrt(2.));
    h_500_CT_wO_DR05_E_RMS_summary_histogram->SetBinContent(i-firstbin+1,hist_vec_500_CT_wO[i]->GetRMS()*500. );
    h_500_CT_wO_DR05_E_RMS_summary_histogram ->SetBinError(i-firstbin+1, hist_vec_500_CT_wO[i]->GetRMSError()*500.);
    h_500_CT_wO_DR05_E_JER_Mean_summary_histogram->SetBinContent(i-firstbin+1,hist_vec_500_CT_wO[i]->GetMean());
    h_500_CT_wO_DR05_E_JER_Mean_summary_histogram->SetBinError(i-firstbin+1,hist_vec_500_CT_wO[i]->GetMeanError());
    //double sided crystal ball
    TF1* fit_gaus_tmp = new TF1("fit_gaus_tmp", "gaus",0.50,1.50);
    hist_vec_500_CT_wO[i]->Fit("fit_gaus_tmp","R");
    hist_vec_500_CT_wO[i]->GetFunction("fit_gaus_tmp");

    TF1* fdscb_tmp = new TF1("fdscb_tmp",fnc_dscb,0.,3.,7);
    fdscb_tmp->SetNpx(1000);
    fdscb_tmp->SetParameter(0,fit_gaus_tmp->GetParameter(0));
    //norm
    fdscb_tmp->SetParLimits (0,0.5*fit_gaus_tmp->GetParameter(0),1.5*fit_gaus_tmp->GetParameter(0));
    fdscb_tmp->SetParameter(1,fit_gaus_tmp->GetParameter(1));
    //gaussian mean
    fdscb_tmp->SetParLimits (1,0.8,1.2);
    //fdscb_tmp->SetParameter(2,fit_gaus_tmp->GetParameter(2));
    //fdscb_tmp->SetParLimits(2,fit_gaus_tmp->GetParameter(2)*0.50,1.50*fit_gaus_tmp->GetParameter(2));
    std::vector<float>sigma2SFit=sigmaGaussianFits2Sigma(hist_vec_500_CT_wO[i]);
    fdscb_tmp->SetParameter(2,sigma2SFit[0]);
    fdscb_tmp->SetParLimits(2,sigma2SFit[0]*0.50,1.50*sigma2SFit[0]);
    //-a1: parameter, from when the gaussian core should count
    fdscb_tmp->SetParameter(2,fit_gaus_tmp->GetParameter(2));
    fdscb_tmp->SetParameter (3,3.0);
    fdscb_tmp->SetParLimits (3,0.0,10.0);
    //a2 parameter, up to when the gaussian core should count
    fdscb_tmp->SetParameter (5,3.0);
    fdscb_tmp->SetParLimits (5,0.0,10.0);
    fdscb_tmp->SetParameter(4,5.);
    fdscb_tmp->SetParLimits(4,0.,25.);
    fdscb_tmp->SetParameter(6,5.);
    fdscb_tmp->SetParLimits(6,0.,25.);
    int fitstatus(0); 
    fitstatus = hist_vec_500_CT_wO[i]->Fit(fdscb_tmp,"R");
    fdscb_tmp = hist_vec_500_CT_wO[i]->GetFunction("fdscb_tmp");
    h_500_CT_wO_DR05_E_SigmaCB_summary_histogram->SetBinContent(i-firstbin+1,fdscb_tmp->GetParameter(2)*100. );
    h_500_CT_wO_DR05_E_SigmaCB_summary_histogram->SetBinError(i-firstbin+1,fdscb_tmp->GetParError(2)*100. );
  }  
  TH1F* h_500_CT_wO_DR06_E_SigmaCB_summary_histogram=new TH1F("JER_SigmaCBVsCosTheta_CT_wO_DR06_500", "RMS_{90}(E_{j}^{reco}/E_{j}^{gen}) / Mean_{90}(E_{j}^{reco}/E_{j}^{gen}) vs |cos#theta|", nRegionBins, pRegionBinEdges);
  h_500_CT_wO_DR06_E_SigmaCB_summary_histogram ->SetYTitle("#sigma(E_{j}) / E_{j} [%]");
  h_500_CT_wO_DR06_E_SigmaCB_summary_histogram->SetXTitle("|cos#theta|");
  h_500_CT_wO_DR06_E_SigmaCB_summary_histogram->SetLineWidth(2);
  h_500_CT_wO_DR06_E_SigmaCB_summary_histogram->SetLineColor(kGreen-2);
  h_500_CT_wO_DR06_E_SigmaCB_summary_histogram->SetLineStyle(2);
  TH1F* h_500_CT_wO_DR06_E_RMS90_summary_histogram=new TH1F("JER_RMS90VsCosTheta_CT_wO_DR06_500", "RMS_{90}(E_{j}^{reco}/E_{j}^{gen}) / Mean_{90}(E_{j}^{reco}/E_{j}^{gen}) vs |cos#theta|", nRegionBins, pRegionBinEdges);
  h_500_CT_wO_DR06_E_RMS90_summary_histogram ->SetYTitle("RMS_{90}(E_{j}^{reco}/E_{j}^{gen}) / Mean_{90}(E_{j}^{reco}/E_{j}^{gen}) [%]");
  h_500_CT_wO_DR06_E_RMS90_summary_histogram->SetXTitle("|cos#theta|");
  h_500_CT_wO_DR06_E_RMS90_summary_histogram->SetLineWidth(2);
  h_500_CT_wO_DR06_E_RMS90_summary_histogram->SetLineColor(kGreen-2);
  h_500_CT_wO_DR06_E_RMS90_summary_histogram->SetLineStyle(2);

  TH1F* h_500_CT_wO_DR06_E_RMS_summary_histogram=new TH1F("JER_RMSVsCosTheta_CT_wO_DR06_500", "RMS(E_{j}) / Mean(E_{j}) vs |cos#theta|", nRegionBins, pRegionBinEdges);
  h_500_CT_wO_DR06_E_RMS_summary_histogram ->SetYTitle("RMS(E_{j}) / Mean(E_{j}) [%]");
  h_500_CT_wO_DR06_E_RMS_summary_histogram->SetXTitle("|cos#theta|");
  h_500_CT_wO_DR06_E_RMS_summary_histogram->SetLineWidth(2);
  h_500_CT_wO_DR06_E_RMS_summary_histogram->SetLineColor(kGreen-2);
  h_500_CT_wO_DR06_E_RMS_summary_histogram->SetLineStyle(2);

  TH1F* h_500_CT_wO_DR06_E_JER_Mean_summary_histogram=new TH1F("JER_MeanVsCosTheta_CT_wO_DR06_500", "Mean(E_{tot}^{RECO}/E_{tot}^{true}) vs |cos#theta|", nRegionBins, pRegionBinEdges);
  h_500_CT_wO_DR06_E_JER_Mean_summary_histogram->SetYTitle("Mean(E_{tot}^{RECO}/E_{tot}^{true})");
  h_500_CT_wO_DR06_E_JER_Mean_summary_histogram->SetXTitle("|cos#theta|");
  h_500_CT_wO_DR06_E_JER_Mean_summary_histogram->SetLineWidth(2);
  h_500_CT_wO_DR06_E_JER_Mean_summary_histogram->SetLineColor(kGreen-2);
  h_500_CT_wO_DR06_E_JER_Mean_summary_histogram->SetLineStyle(2);
  firstbin=72;
  for(int i=firstbin;i<(firstbin+13);i++){
    //continue;
    resolutionTH1=0; 
    resolutionErrorTH1=0;
    meanTH1=0;
    meanErrorTH1=0;
    CalculatePerformance( hist_vec_500_CT_wO[i], resolutionTH1, resolutionErrorTH1,meanTH1,meanErrorTH1);
    h_500_CT_wO_DR06_E_RMS90_summary_histogram->SetBinContent(i-firstbin+1,resolutionTH1/sqrt(2.));
    h_500_CT_wO_DR06_E_RMS90_summary_histogram ->SetBinError(i-firstbin+1, resolutionErrorTH1/sqrt(2.));
    h_500_CT_wO_DR06_E_RMS_summary_histogram->SetBinContent(i-firstbin+1,hist_vec_500_CT_wO[i]->GetRMS()*100. );
    h_500_CT_wO_DR06_E_RMS_summary_histogram ->SetBinError(i-firstbin+1, hist_vec_500_CT_wO[i]->GetRMSError()*100.);
    h_500_CT_wO_DR06_E_JER_Mean_summary_histogram->SetBinContent(i-firstbin+1,hist_vec_500_CT_wO[i]->GetMean());
    h_500_CT_wO_DR06_E_JER_Mean_summary_histogram->SetBinError(i-firstbin+1,hist_vec_500_CT_wO[i]->GetMeanError());
    //double sided crystal ball
    TF1* fit_gaus_tmp = new TF1("fit_gaus_tmp", "gaus",0.50,1.50);
    hist_vec_500_CT_wO[i]->Fit("fit_gaus_tmp","R");
    hist_vec_500_CT_wO[i]->GetFunction("fit_gaus_tmp");

    TF1* fdscb_tmp = new TF1("fdscb_tmp",fnc_dscb,0.,3.,7);
   fdscb_tmp->SetNpx(1000);
    fdscb_tmp->SetParameter(0,fit_gaus_tmp->GetParameter(0));
    //norm
    fdscb_tmp->SetParLimits (0,0.5*fit_gaus_tmp->GetParameter(0),1.5*fit_gaus_tmp->GetParameter(0));
    fdscb_tmp->SetParameter(1,fit_gaus_tmp->GetParameter(1));
    //gaussian mean
    fdscb_tmp->SetParLimits (1,0.8,1.2);
    //fdscb_tmp->SetParameter(2,fit_gaus_tmp->GetParameter(2));
    //fdscb_tmp->SetParLimits(2,fit_gaus_tmp->GetParameter(2)*0.50,1.50*fit_gaus_tmp->GetParameter(2));
    std::vector<float>sigma2SFit=sigmaGaussianFits2Sigma(hist_vec_500_CT_wO[i]);
    fdscb_tmp->SetParameter(2,sigma2SFit[0]);
    fdscb_tmp->SetParLimits(2,sigma2SFit[0]*0.50,1.50*sigma2SFit[0]);
    //-a1: parameter, from when the gaussian core should count
    fdscb_tmp->SetParameter(2,fit_gaus_tmp->GetParameter(2));
    fdscb_tmp->SetParameter (3,3.0);
    fdscb_tmp->SetParLimits (3,0.0,10.0);
    //a2 parameter, up to when the gaussian core should count
    fdscb_tmp->SetParameter (5,3.0);
    fdscb_tmp->SetParLimits (5,0.0,10.0);
    fdscb_tmp->SetParameter(4,5.);
    fdscb_tmp->SetParLimits(4,0.,25.);
    fdscb_tmp->SetParameter(6,5.);
    fdscb_tmp->SetParLimits(6,0.,25.);
    int fitstatus(0); 
    fitstatus = hist_vec_500_CT_wO[i]->Fit(fdscb_tmp,"R");
    fdscb_tmp = hist_vec_500_CT_wO[i]->GetFunction("fdscb_tmp");
    h_500_CT_wO_DR06_E_SigmaCB_summary_histogram->SetBinContent(i-firstbin+1,fdscb_tmp->GetParameter(2)*100. );
    h_500_CT_wO_DR06_E_SigmaCB_summary_histogram->SetBinError(i-firstbin+1,fdscb_tmp->GetParError(2)*100. );
  }  
  TH1F* h_500_CT_wO_DR07_E_SigmaCB_summary_histogram=new TH1F("JER_SigmaCBVsCosTheta_CT_wO_DR07_500", "RMS_{90}(E_{j}^{reco}/E_{j}^{gen}) / Mean_{90}(E_{j}^{reco}/E_{j}^{gen}) vs |cos#theta|", nRegionBins, pRegionBinEdges);
  h_500_CT_wO_DR07_E_SigmaCB_summary_histogram ->SetYTitle("#sigma(E_{j}) / E_{j} [%]");
  h_500_CT_wO_DR07_E_SigmaCB_summary_histogram->SetXTitle("|cos#theta|");
  h_500_CT_wO_DR07_E_SigmaCB_summary_histogram->SetLineWidth(2);
  h_500_CT_wO_DR07_E_SigmaCB_summary_histogram->SetLineColor(kGreen-2);
  h_500_CT_wO_DR07_E_SigmaCB_summary_histogram->SetLineStyle(2);
  TH1F* h_500_CT_wO_DR07_E_RMS90_summary_histogram=new TH1F("JER_RMS90VsCosTheta_CT_wO_DR07_500", "RMS_{90}(E_{j}^{reco}/E_{j}^{gen}) / Mean_{90}(E_{j}^{reco}/E_{j}^{gen}) vs |cos#theta|", nRegionBins, pRegionBinEdges);
  h_500_CT_wO_DR07_E_RMS90_summary_histogram ->SetYTitle("RMS_{90}(E_{j}^{reco}/E_{j}^{gen}) / Mean_{90}(E_{j}^{reco}/E_{j}^{gen}) [%]");
  h_500_CT_wO_DR07_E_RMS90_summary_histogram->SetXTitle("|cos#theta|");
  h_500_CT_wO_DR07_E_RMS90_summary_histogram->SetLineWidth(2);
  h_500_CT_wO_DR07_E_RMS90_summary_histogram->SetLineColor(kGreen-2);
  h_500_CT_wO_DR07_E_RMS90_summary_histogram->SetLineStyle(2);

  TH1F* h_500_CT_wO_DR07_E_RMS_summary_histogram=new TH1F("JER_RMSVsCosTheta_CT_wO_DR07_500", "RMS(E_{j}) / Mean(E_{j}) vs |cos#theta|", nRegionBins, pRegionBinEdges);
  h_500_CT_wO_DR07_E_RMS_summary_histogram ->SetYTitle("RMS(E_{j}) / Mean(E_{j}) [%]");
  h_500_CT_wO_DR07_E_RMS_summary_histogram->SetXTitle("|cos#theta|");
  h_500_CT_wO_DR07_E_RMS_summary_histogram->SetLineWidth(2);
  h_500_CT_wO_DR07_E_RMS_summary_histogram->SetLineColor(kGreen-2);
  h_500_CT_wO_DR07_E_RMS_summary_histogram->SetLineStyle(2);

  TH1F* h_500_CT_wO_DR07_E_JER_Mean_summary_histogram=new TH1F("JER_MeanVsCosTheta_CT_wO_DR07_500", "Mean(E_{tot}^{RECO}/E_{tot}^{true}) vs |cos#theta|", nRegionBins, pRegionBinEdges);
  h_500_CT_wO_DR07_E_JER_Mean_summary_histogram->SetYTitle("Mean(E_{tot}^{RECO}/E_{tot}^{true})");
  h_500_CT_wO_DR07_E_JER_Mean_summary_histogram->SetXTitle("|cos#theta|");
  h_500_CT_wO_DR07_E_JER_Mean_summary_histogram->SetLineWidth(2);
  h_500_CT_wO_DR07_E_JER_Mean_summary_histogram->SetLineColor(kGreen-2);
  h_500_CT_wO_DR07_E_JER_Mean_summary_histogram->SetLineStyle(2);
  firstbin=85;
  for(int i=firstbin;i<(firstbin+13);i++){
    //continue;
    resolutionTH1=0; 
    resolutionErrorTH1=0;
    meanTH1=0;
    meanErrorTH1=0;
    CalculatePerformance( hist_vec_500_CT_wO[i], resolutionTH1, resolutionErrorTH1,meanTH1,meanErrorTH1);
    h_500_CT_wO_DR07_E_RMS90_summary_histogram->SetBinContent(i-firstbin+1,resolutionTH1/sqrt(2.));
    h_500_CT_wO_DR07_E_RMS90_summary_histogram ->SetBinError(i-firstbin+1, resolutionErrorTH1/sqrt(2.));
    h_500_CT_wO_DR07_E_RMS_summary_histogram->SetBinContent(i-firstbin+1,hist_vec_500_CT_wO[i]->GetRMS()*100. );
    h_500_CT_wO_DR07_E_RMS_summary_histogram ->SetBinError(i-firstbin+1, hist_vec_500_CT_wO[i]->GetRMSError()*100.);
    h_500_CT_wO_DR07_E_JER_Mean_summary_histogram->SetBinContent(i-firstbin+1,hist_vec_500_CT_wO[i]->GetMean());
    h_500_CT_wO_DR07_E_JER_Mean_summary_histogram->SetBinError(i-firstbin+1,hist_vec_500_CT_wO[i]->GetMeanError());
    //double sided crystal ball
    TF1* fit_gaus_tmp = new TF1("fit_gaus_tmp", "gaus",0.50,1.50);
    hist_vec_500_CT_wO[i]->Fit("fit_gaus_tmp","R");
    hist_vec_500_CT_wO[i]->GetFunction("fit_gaus_tmp");

    TF1* fdscb_tmp = new TF1("fdscb_tmp",fnc_dscb,0.,3.,7);
    fdscb_tmp->SetNpx(1000);
    fdscb_tmp->SetParameter(0,fit_gaus_tmp->GetParameter(0));
    //norm
    fdscb_tmp->SetParLimits (0,0.5*fit_gaus_tmp->GetParameter(0),1.5*fit_gaus_tmp->GetParameter(0));
    fdscb_tmp->SetParameter(1,fit_gaus_tmp->GetParameter(1));
    //gaussian mean
    fdscb_tmp->SetParLimits (1,0.8,1.2);
    //fdscb_tmp->SetParameter(2,fit_gaus_tmp->GetParameter(2));
    //fdscb_tmp->SetParLimits(2,fit_gaus_tmp->GetParameter(2)*0.50,1.50*fit_gaus_tmp->GetParameter(2));
    std::vector<float>sigma2SFit=sigmaGaussianFits2Sigma(hist_vec_500_CT_wO[i]);
    fdscb_tmp->SetParameter(2,sigma2SFit[0]);
    fdscb_tmp->SetParLimits(2,sigma2SFit[0]*0.50,1.50*sigma2SFit[0]);
    //-a1: parameter, from when the gaussian core should count
    fdscb_tmp->SetParameter(2,fit_gaus_tmp->GetParameter(2));
    fdscb_tmp->SetParameter (3,3.0);
    fdscb_tmp->SetParLimits (3,0.0,10.0);
    //a2 parameter, up to when the gaussian core should count
    fdscb_tmp->SetParameter (5,3.0);
    fdscb_tmp->SetParLimits (5,0.0,10.0);
    fdscb_tmp->SetParameter(4,5.);
    fdscb_tmp->SetParLimits(4,0.,25.);
    fdscb_tmp->SetParameter(6,5.);
    fdscb_tmp->SetParLimits(6,0.,25.);
    int fitstatus(0); 
    fitstatus = hist_vec_500_CT_wO[i]->Fit(fdscb_tmp,"R");
    fdscb_tmp = hist_vec_500_CT_wO[i]->GetFunction("fdscb_tmp");
    h_500_CT_wO_DR07_E_SigmaCB_summary_histogram->SetBinContent(i-firstbin+1,fdscb_tmp->GetParameter(2)*100. );
    h_500_CT_wO_DR07_E_SigmaCB_summary_histogram->SetBinError(i-firstbin+1,fdscb_tmp->GetParError(2)*100. );
  }  


  TH1F* h_500_CT_wO_DR08_E_SigmaCB_summary_histogram=new TH1F("JER_SigmaCBVsCosTheta_CT_wO_DR08_500", "RMS_{90}(E_{j}^{reco}/E_{j}^{gen}) / Mean_{90}(E_{j}^{reco}/E_{j}^{gen}) vs |cos#theta|", nRegionBins, pRegionBinEdges);
  h_500_CT_wO_DR08_E_SigmaCB_summary_histogram ->SetYTitle("#sigma(E_{j}) / E_{j} [%]");
  h_500_CT_wO_DR08_E_SigmaCB_summary_histogram->SetXTitle("|cos#theta|");
  h_500_CT_wO_DR08_E_SigmaCB_summary_histogram->SetLineWidth(2);
  h_500_CT_wO_DR08_E_SigmaCB_summary_histogram->SetLineColor(kGreen-2);
  h_500_CT_wO_DR08_E_SigmaCB_summary_histogram->SetLineStyle(2);
  TH1F* h_500_CT_wO_DR08_E_RMS90_summary_histogram=new TH1F("JER_RMS90VsCosTheta_CT_wO_DR08_500", "RMS_{90}(E_{j}^{reco}/E_{j}^{gen}) / Mean_{90}(E_{j}^{reco}/E_{j}^{gen}) vs |cos#theta|", nRegionBins, pRegionBinEdges);
  h_500_CT_wO_DR08_E_RMS90_summary_histogram ->SetYTitle("RMS_{90}(E_{j}^{reco}/E_{j}^{gen}) / Mean_{90}(E_{j}^{reco}/E_{j}^{gen}) [%]");
  h_500_CT_wO_DR08_E_RMS90_summary_histogram->SetXTitle("|cos#theta|");
  h_500_CT_wO_DR08_E_RMS90_summary_histogram->SetLineWidth(2);
  h_500_CT_wO_DR08_E_RMS90_summary_histogram->SetLineColor(kGreen-2);
  h_500_CT_wO_DR08_E_RMS90_summary_histogram->SetLineStyle(2);

  TH1F* h_500_CT_wO_DR08_E_RMS_summary_histogram=new TH1F("JER_RMSVsCosTheta_CT_wO_DR08_500", "RMS(E_{j}) / Mean(E_{j}) vs |cos#theta|", nRegionBins, pRegionBinEdges);
  h_500_CT_wO_DR08_E_RMS_summary_histogram ->SetYTitle("RMS(E_{j}) / Mean(E_{j}) [%]");
  h_500_CT_wO_DR08_E_RMS_summary_histogram->SetXTitle("|cos#theta|");
  h_500_CT_wO_DR08_E_RMS_summary_histogram->SetLineWidth(2);
  h_500_CT_wO_DR08_E_RMS_summary_histogram->SetLineColor(kGreen-2);
  h_500_CT_wO_DR08_E_RMS_summary_histogram->SetLineStyle(2);

  TH1F* h_500_CT_wO_DR08_E_JER_Mean_summary_histogram=new TH1F("JER_MeanVsCosTheta_CT_wO_DR08_500", "Mean(E_{tot}^{RECO}/E_{tot}^{true}) vs |cos#theta|", nRegionBins, pRegionBinEdges);
  h_500_CT_wO_DR08_E_JER_Mean_summary_histogram->SetYTitle("Mean(E_{tot}^{RECO}/E_{tot}^{true})");
  h_500_CT_wO_DR08_E_JER_Mean_summary_histogram->SetXTitle("|cos#theta|");
  h_500_CT_wO_DR08_E_JER_Mean_summary_histogram->SetLineWidth(2);
  h_500_CT_wO_DR08_E_JER_Mean_summary_histogram->SetLineColor(kGreen-2);
  h_500_CT_wO_DR08_E_JER_Mean_summary_histogram->SetLineStyle(2);
  firstbin=98;
  for(int i=firstbin;i<(firstbin+13);i++){
    //continue;
    resolutionTH1=0; 
    resolutionErrorTH1=0;
    meanTH1=0;
    meanErrorTH1=0;
    CalculatePerformance( hist_vec_500_CT_wO[i], resolutionTH1, resolutionErrorTH1,meanTH1,meanErrorTH1);
    h_500_CT_wO_DR08_E_RMS90_summary_histogram->SetBinContent(i-firstbin+1,resolutionTH1/sqrt(2.));
    h_500_CT_wO_DR08_E_RMS90_summary_histogram ->SetBinError(i-firstbin+1, resolutionErrorTH1/sqrt(2.));
    h_500_CT_wO_DR08_E_RMS_summary_histogram->SetBinContent(i-firstbin+1,hist_vec_500_CT_wO[i]->GetRMS()*100. );
    h_500_CT_wO_DR08_E_RMS_summary_histogram ->SetBinError(i-firstbin+1, hist_vec_500_CT_wO[i]->GetRMSError()*100.);
    h_500_CT_wO_DR08_E_JER_Mean_summary_histogram->SetBinContent(i-firstbin+1,hist_vec_500_CT_wO[i]->GetMean());
    h_500_CT_wO_DR08_E_JER_Mean_summary_histogram->SetBinError(i-firstbin+1,hist_vec_500_CT_wO[i]->GetMeanError());
    //double sided crystal ball
    TF1* fit_gaus_tmp = new TF1("fit_gaus_tmp", "gaus",0.50,1.50);
    hist_vec_500_CT_wO[i]->Fit("fit_gaus_tmp","R");
    hist_vec_500_CT_wO[i]->GetFunction("fit_gaus_tmp");

    TF1* fdscb_tmp = new TF1("fdscb_tmp",fnc_dscb,0.,3.,7);
    fdscb_tmp->SetNpx(1000);
    fdscb_tmp->SetParameter(0,fit_gaus_tmp->GetParameter(0));
    //norm
    fdscb_tmp->SetParLimits (0,0.5*fit_gaus_tmp->GetParameter(0),1.5*fit_gaus_tmp->GetParameter(0));
    fdscb_tmp->SetParameter(1,fit_gaus_tmp->GetParameter(1));
    //gaussian mean
    fdscb_tmp->SetParLimits (1,0.8,1.2);
    //fdscb_tmp->SetParameter(2,fit_gaus_tmp->GetParameter(2));
    //fdscb_tmp->SetParLimits(2,fit_gaus_tmp->GetParameter(2)*0.50,1.50*fit_gaus_tmp->GetParameter(2));
    std::vector<float>sigma2SFit=sigmaGaussianFits2Sigma(hist_vec_500_CT_wO[i]);
    fdscb_tmp->SetParameter(2,sigma2SFit[0]);
    fdscb_tmp->SetParLimits(2,sigma2SFit[0]*0.50,1.50*sigma2SFit[0]);
    //-a1: parameter, from when the gaussian core should count
    fdscb_tmp->SetParameter(2,fit_gaus_tmp->GetParameter(2));
    fdscb_tmp->SetParameter (3,3.0);
    fdscb_tmp->SetParLimits (3,0.0,10.0);
    //a2 parameter, up to when the gaussian core should count
    fdscb_tmp->SetParameter (5,3.0);
    fdscb_tmp->SetParLimits (5,0.0,10.0);
    fdscb_tmp->SetParameter(4,5.);
    fdscb_tmp->SetParLimits(4,0.,25.);
    fdscb_tmp->SetParameter(6,5.);
    fdscb_tmp->SetParLimits(6,0.,25.);
    int fitstatus(0); 
    fitstatus = hist_vec_500_CT_wO[i]->Fit(fdscb_tmp,"R");
    fdscb_tmp = hist_vec_500_CT_wO[i]->GetFunction("fdscb_tmp");
    h_500_CT_wO_DR08_E_SigmaCB_summary_histogram->SetBinContent(i-firstbin+1,fdscb_tmp->GetParameter(2)*100. );
    h_500_CT_wO_DR08_E_SigmaCB_summary_histogram->SetBinError(i-firstbin+1,fdscb_tmp->GetParError(2)*100. );
  }  
  TH1F* h_500_CT_wO_DR09_E_SigmaCB_summary_histogram=new TH1F("JER_SigmaCBVsCosTheta_CT_wO_DR09_500", "RMS_{90}(E_{j}^{reco}/E_{j}^{gen}) / Mean_{90}(E_{j}^{reco}/E_{j}^{gen}) vs |cos#theta|", nRegionBins, pRegionBinEdges);
  h_500_CT_wO_DR09_E_SigmaCB_summary_histogram ->SetYTitle("#sigma(E_{j}) / E_{j} [%]");
  h_500_CT_wO_DR09_E_SigmaCB_summary_histogram->SetXTitle("|cos#theta|");
  h_500_CT_wO_DR09_E_SigmaCB_summary_histogram->SetLineWidth(2);
  h_500_CT_wO_DR09_E_SigmaCB_summary_histogram->SetLineColor(kGreen-2);
  h_500_CT_wO_DR09_E_SigmaCB_summary_histogram->SetLineStyle(2);
  TH1F* h_500_CT_wO_DR09_E_RMS90_summary_histogram=new TH1F("JER_RMS90VsCosTheta_CT_wO_DR09_500", "RMS_{90}(E_{j}^{reco}/E_{j}^{gen}) / Mean_{90}(E_{j}^{reco}/E_{j}^{gen}) vs |cos#theta|", nRegionBins, pRegionBinEdges);
  h_500_CT_wO_DR09_E_RMS90_summary_histogram ->SetYTitle("RMS_{90}(E_{j}^{reco}/E_{j}^{gen}) / Mean_{90}(E_{j}^{reco}/E_{j}^{gen}) [%]");
  h_500_CT_wO_DR09_E_RMS90_summary_histogram->SetXTitle("|cos#theta|");
  h_500_CT_wO_DR09_E_RMS90_summary_histogram->SetLineWidth(2);
  h_500_CT_wO_DR09_E_RMS90_summary_histogram->SetLineColor(kGreen-2);
  h_500_CT_wO_DR09_E_RMS90_summary_histogram->SetLineStyle(2);

  TH1F* h_500_CT_wO_DR09_E_RMS_summary_histogram=new TH1F("JER_RMSVsCosTheta_CT_wO_DR09_500", "RMS(E_{j}) / Mean(E_{j}) vs |cos#theta|", nRegionBins, pRegionBinEdges);
  h_500_CT_wO_DR09_E_RMS_summary_histogram ->SetYTitle("RMS(E_{j}) / Mean(E_{j}) [%]");
  h_500_CT_wO_DR09_E_RMS_summary_histogram->SetXTitle("|cos#theta|");
  h_500_CT_wO_DR09_E_RMS_summary_histogram->SetLineWidth(2);
  h_500_CT_wO_DR09_E_RMS_summary_histogram->SetLineColor(kGreen-2);
  h_500_CT_wO_DR09_E_RMS_summary_histogram->SetLineStyle(2);

  TH1F* h_500_CT_wO_DR09_E_JER_Mean_summary_histogram=new TH1F("JER_MeanVsCosTheta_CT_wO_DR09_500", "Mean(E_{tot}^{RECO}/E_{tot}^{true}) vs |cos#theta|", nRegionBins, pRegionBinEdges);
  h_500_CT_wO_DR09_E_JER_Mean_summary_histogram->SetYTitle("Mean(E_{tot}^{RECO}/E_{tot}^{true})");
  h_500_CT_wO_DR09_E_JER_Mean_summary_histogram->SetXTitle("|cos#theta|");
  h_500_CT_wO_DR09_E_JER_Mean_summary_histogram->SetLineWidth(2);
  h_500_CT_wO_DR09_E_JER_Mean_summary_histogram->SetLineColor(kGreen-2);
  h_500_CT_wO_DR09_E_JER_Mean_summary_histogram->SetLineStyle(2);
  firstbin=111;
  for(int i=firstbin;i<(firstbin+13);i++){
    //continue;
    resolutionTH1=0; 
    resolutionErrorTH1=0;
    meanTH1=0;
    meanErrorTH1=0;
    CalculatePerformance( hist_vec_500_CT_wO[i], resolutionTH1, resolutionErrorTH1,meanTH1,meanErrorTH1);
    h_500_CT_wO_DR09_E_RMS90_summary_histogram->SetBinContent(i-firstbin+1,resolutionTH1/sqrt(2.));
    h_500_CT_wO_DR09_E_RMS90_summary_histogram ->SetBinError(i-firstbin+1, resolutionErrorTH1/sqrt(2.));
    h_500_CT_wO_DR09_E_RMS_summary_histogram->SetBinContent(i-firstbin+1,hist_vec_500_CT_wO[i]->GetRMS()*100. );
    h_500_CT_wO_DR09_E_RMS_summary_histogram ->SetBinError(i-firstbin+1, hist_vec_500_CT_wO[i]->GetRMSError()*100.);
    h_500_CT_wO_DR09_E_JER_Mean_summary_histogram->SetBinContent(i-firstbin+1,hist_vec_500_CT_wO[i]->GetMean());
    h_500_CT_wO_DR09_E_JER_Mean_summary_histogram->SetBinError(i-firstbin+1,hist_vec_500_CT_wO[i]->GetMeanError());
    //double sided crystal ball
    TF1* fit_gaus_tmp = new TF1("fit_gaus_tmp", "gaus",0.50,1.50);
    hist_vec_500_CT_wO[i]->Fit("fit_gaus_tmp","R");
    hist_vec_500_CT_wO[i]->GetFunction("fit_gaus_tmp");

    TF1* fdscb_tmp = new TF1("fdscb_tmp",fnc_dscb,0.,3.,7);
    fdscb_tmp->SetNpx(1000);
    fdscb_tmp->SetParameter(0,fit_gaus_tmp->GetParameter(0));
    //norm
    fdscb_tmp->SetParLimits (0,0.5*fit_gaus_tmp->GetParameter(0),1.5*fit_gaus_tmp->GetParameter(0));
    fdscb_tmp->SetParameter(1,fit_gaus_tmp->GetParameter(1));
    //gaussian mean
    fdscb_tmp->SetParLimits (1,0.8,1.2);
    //fdscb_tmp->SetParameter(2,fit_gaus_tmp->GetParameter(2));
    //fdscb_tmp->SetParLimits(2,fit_gaus_tmp->GetParameter(2)*0.50,1.50*fit_gaus_tmp->GetParameter(2));
    std::vector<float>sigma2SFit=sigmaGaussianFits2Sigma(hist_vec_500_CT_wO[i]);
    fdscb_tmp->SetParameter(2,sigma2SFit[0]);
    fdscb_tmp->SetParLimits(2,sigma2SFit[0]*0.50,1.50*sigma2SFit[0]);
    //-a1: parameter, from when the gaussian core should count
    fdscb_tmp->SetParameter(2,fit_gaus_tmp->GetParameter(2));
    fdscb_tmp->SetParameter (3,3.0);
    fdscb_tmp->SetParLimits (3,0.0,10.0);
    //a2 parameter, up to when the gaussian core should count
    fdscb_tmp->SetParameter (5,3.0);
    fdscb_tmp->SetParLimits (5,0.0,10.0);
    fdscb_tmp->SetParameter(4,5.);
    fdscb_tmp->SetParLimits(4,0.,25.);
    fdscb_tmp->SetParameter(6,5.);
    fdscb_tmp->SetParLimits(6,0.,25.);
    int fitstatus(0); 
    fitstatus = hist_vec_500_CT_wO[i]->Fit(fdscb_tmp,"R");
    fdscb_tmp = hist_vec_500_CT_wO[i]->GetFunction("fdscb_tmp");
    h_500_CT_wO_DR09_E_SigmaCB_summary_histogram->SetBinContent(i-firstbin+1,fdscb_tmp->GetParameter(2)*100. );
    h_500_CT_wO_DR09_E_SigmaCB_summary_histogram->SetBinError(i-firstbin+1,fdscb_tmp->GetParError(2)*100. );
  }  
  TH1F* h_500_CT_wO_DR10_E_SigmaCB_summary_histogram=new TH1F("JER_SigmaCBVsCosTheta_CT_wO_DR10_500", "RMS_{90}(E_{j}^{reco}/E_{j}^{gen}) / Mean_{90}(E_{j}^{reco}/E_{j}^{gen}) vs |cos#theta|", nRegionBins, pRegionBinEdges);
  h_500_CT_wO_DR10_E_SigmaCB_summary_histogram ->SetYTitle("#sigma(E_{j}) / E_{j} [%]");
  h_500_CT_wO_DR10_E_SigmaCB_summary_histogram->SetXTitle("|cos#theta|");
  h_500_CT_wO_DR10_E_SigmaCB_summary_histogram->SetLineWidth(2);
  h_500_CT_wO_DR10_E_SigmaCB_summary_histogram->SetLineColor(kGreen-2);
  h_500_CT_wO_DR10_E_SigmaCB_summary_histogram->SetLineStyle(2);
  TH1F* h_500_CT_wO_DR10_E_RMS90_summary_histogram=new TH1F("JER_RMS90VsCosTheta_CT_wO_DR10_500", "RMS_{90}(E_{j}^{reco}/E_{j}^{gen}) / Mean_{90}(E_{j}^{reco}/E_{j}^{gen}) vs |cos#theta|", nRegionBins, pRegionBinEdges);
  h_500_CT_wO_DR10_E_RMS90_summary_histogram ->SetYTitle("RMS_{90}(E_{j}^{reco}/E_{j}^{gen}) / Mean_{90}(E_{j}^{reco}/E_{j}^{gen}) [%]");
  h_500_CT_wO_DR10_E_RMS90_summary_histogram->SetXTitle("|cos#theta|");
  h_500_CT_wO_DR10_E_RMS90_summary_histogram->SetLineWidth(2);
  h_500_CT_wO_DR10_E_RMS90_summary_histogram->SetLineColor(kGreen-2);
  h_500_CT_wO_DR10_E_RMS90_summary_histogram->SetLineStyle(2);

  TH1F* h_500_CT_wO_DR10_E_RMS_summary_histogram=new TH1F("JER_RMSVsCosTheta_CT_wO_DR10_500", "RMS(E_{j}) / Mean(E_{j}) vs |cos#theta|", nRegionBins, pRegionBinEdges);
  h_500_CT_wO_DR10_E_RMS_summary_histogram ->SetYTitle("RMS(E_{j}) / Mean(E_{j}) [%]");
  h_500_CT_wO_DR10_E_RMS_summary_histogram->SetXTitle("|cos#theta|");
  h_500_CT_wO_DR10_E_RMS_summary_histogram->SetLineWidth(2);
  h_500_CT_wO_DR10_E_RMS_summary_histogram->SetLineColor(kGreen-2);
  h_500_CT_wO_DR10_E_RMS_summary_histogram->SetLineStyle(2);

  TH1F* h_500_CT_wO_DR10_E_JER_Mean_summary_histogram=new TH1F("JER_MeanVsCosTheta_CT_wO_DR10_500", "Mean(E_{tot}^{RECO}/E_{tot}^{true}) vs |cos#theta|", nRegionBins, pRegionBinEdges);
  h_500_CT_wO_DR10_E_JER_Mean_summary_histogram->SetYTitle("Mean(E_{tot}^{RECO}/E_{tot}^{true})");
  h_500_CT_wO_DR10_E_JER_Mean_summary_histogram->SetXTitle("|cos#theta|");
  h_500_CT_wO_DR10_E_JER_Mean_summary_histogram->SetLineWidth(2);
  h_500_CT_wO_DR10_E_JER_Mean_summary_histogram->SetLineColor(kGreen-2);
  h_500_CT_wO_DR10_E_JER_Mean_summary_histogram->SetLineStyle(2);
  firstbin=124;
  for(int i=firstbin;i<(firstbin+13);i++){
    //continue;
    resolutionTH1=0; 
    resolutionErrorTH1=0;
    meanTH1=0;
    meanErrorTH1=0;
    CalculatePerformance( hist_vec_500_CT_wO[i], resolutionTH1, resolutionErrorTH1,meanTH1,meanErrorTH1);
    h_500_CT_wO_DR10_E_RMS90_summary_histogram->SetBinContent(i-firstbin+1,resolutionTH1/sqrt(2.));
    h_500_CT_wO_DR10_E_RMS90_summary_histogram ->SetBinError(i-firstbin+1, resolutionErrorTH1/sqrt(2.));
    h_500_CT_wO_DR10_E_RMS_summary_histogram->SetBinContent(i-firstbin+1,hist_vec_500_CT_wO[i]->GetRMS()*100. );
    h_500_CT_wO_DR10_E_RMS_summary_histogram ->SetBinError(i-firstbin+1, hist_vec_500_CT_wO[i]->GetRMSError()*100.);
    h_500_CT_wO_DR10_E_JER_Mean_summary_histogram->SetBinContent(i-firstbin+1,hist_vec_500_CT_wO[i]->GetMean());
    h_500_CT_wO_DR10_E_JER_Mean_summary_histogram->SetBinError(i-firstbin+1,hist_vec_500_CT_wO[i]->GetMeanError());
    //double sided crystal ball
    TF1* fit_gaus_tmp = new TF1("fit_gaus_tmp", "gaus",0.50,1.50);
    hist_vec_500_CT_wO[i]->Fit("fit_gaus_tmp","R");
    hist_vec_500_CT_wO[i]->GetFunction("fit_gaus_tmp");

    TF1* fdscb_tmp = new TF1("fdscb_tmp",fnc_dscb,0.,3.,7);
    fdscb_tmp->SetNpx(1000);
    fdscb_tmp->SetParameter(0,fit_gaus_tmp->GetParameter(0));
    //norm
    fdscb_tmp->SetParLimits (0,0.5*fit_gaus_tmp->GetParameter(0),1.5*fit_gaus_tmp->GetParameter(0));
    fdscb_tmp->SetParameter(1,fit_gaus_tmp->GetParameter(1));
    //gaussian mean
    fdscb_tmp->SetParLimits (1,0.8,1.2);
    //fdscb_tmp->SetParameter(2,fit_gaus_tmp->GetParameter(2));
    //fdscb_tmp->SetParLimits(2,fit_gaus_tmp->GetParameter(2)*0.50,1.50*fit_gaus_tmp->GetParameter(2));
    std::vector<float>sigma2SFit=sigmaGaussianFits2Sigma(hist_vec_500_CT_wO[i]);
    fdscb_tmp->SetParameter(2,sigma2SFit[0]);
    fdscb_tmp->SetParLimits(2,sigma2SFit[0]*0.50,1.50*sigma2SFit[0]);
    //-a1: parameter, from when the gaussian core should count
    fdscb_tmp->SetParameter(2,fit_gaus_tmp->GetParameter(2));
    fdscb_tmp->SetParameter (3,3.0);
    fdscb_tmp->SetParLimits (3,0.0,10.0);
    //a2 parameter, up to when the gaussian core should count
    fdscb_tmp->SetParameter (5,3.0);
    fdscb_tmp->SetParLimits (5,0.0,10.0);
    fdscb_tmp->SetParameter(4,5.);
    fdscb_tmp->SetParLimits(4,0.,25.);
    fdscb_tmp->SetParameter(6,5.);
    fdscb_tmp->SetParLimits(6,0.,25.);
    int fitstatus(0); 
    fitstatus = hist_vec_500_CT_wO[i]->Fit(fdscb_tmp,"R");
    fdscb_tmp = hist_vec_500_CT_wO[i]->GetFunction("fdscb_tmp");
    h_500_CT_wO_DR10_E_SigmaCB_summary_histogram->SetBinContent(i-firstbin+1,fdscb_tmp->GetParameter(2)*100. );
    h_500_CT_wO_DR10_E_SigmaCB_summary_histogram->SetBinError(i-firstbin+1,fdscb_tmp->GetParError(2)*100. );
  }  

  std::cout<<"500 wO 03/04/05/06 "<< calculate_over90(h_500_CT_wO_recojet03_E1_E2_over_E_True)<<"/"<< calculate_over90(h_500_CT_wO_recojet04_E1_E2_over_E_True)<<"/"<< calculate_over90(h_500_CT_wO_recojet05_E1_E2_over_E_True)<<"/"<<calculate_over90(h_500_CT_wO_recojet06_E1_E2_over_E_True)<<" 07/08/09/10 "<< calculate_over90(h_500_CT_wO_recojet07_E1_E2_over_E_True)<<"/"<< calculate_over90(h_500_CT_wO_recojet08_E1_E2_over_E_True)<<"/"<< calculate_over90(h_500_CT_wO_recojet09_E1_E2_over_E_True)<<"/"<<calculate_over90(h_500_CT_wO_recojet10_E1_E2_over_E_True)<<std::endl;
  std::cout<<"jet histos 500 CT_wO filled"<<std::endl;


  TH1F* h_1500_CT_genjet03_dphi_j1j2 =  new TH1F("h_1500_CT_genjet03_dphi_j1j2","", n_bins100, 0.5,TMath::Pi());
  TH1F* h_1500_CT_genjet03_E1_E2_over_E_True =  new TH1F("h_1500_CT_genjet03_E1_E2_over_E_True","", n_bins100, 0.5,1.00);
  TH1F* h_1500_CT_genjet03_Delta_E1_E2_over_E12 =  new TH1F("h_1500_CT_genjet03_Delta_E1_E2_over_E12","", n_bins100, -0.5,0.5);
  TH1F* h_1500_CT_genjet04_dphi_j1j2 =  new TH1F("h_1500_CT_genjet04_dphi_j1j2","", n_bins100, 0.5,TMath::Pi());
  TH1F* h_1500_CT_genjet04_E1_E2_over_E_True =  new TH1F("h_1500_CT_genjet04_E1_E2_over_E_True","", n_bins100, 0.5,1.00);
  TH1F* h_1500_CT_genjet04_Delta_E1_E2_over_E12 =  new TH1F("h_1500_CT_genjet04_Delta_E1_E2_over_E12","", n_bins100, -0.5,0.5);
  TH1F* h_1500_CT_genjet05_dphi_j1j2 =  new TH1F("h_1500_CT_genjet05_dphi_j1j2","", n_bins100, 0.5,TMath::Pi());
  TH1F* h_1500_CT_genjet05_E1_E2_over_E_True =  new TH1F("h_1500_CT_genjet05_E1_E2_over_E_True","", n_bins100, 0.5,1.00);
  TH1F* h_1500_CT_genjet05_Delta_E1_E2_over_E12 =  new TH1F("h_1500_CT_genjet05_Delta_E1_E2_over_E12","", n_bins100, -0.5,0.5);
  TH1F* h_1500_CT_genjet06_dphi_j1j2 =  new TH1F("h_1500_CT_genjet06_dphi_j1j2","", n_bins100, 0.5,TMath::Pi());
  TH1F* h_1500_CT_genjet06_E1_E2_over_E_True =  new TH1F("h_1500_CT_genjet06_E1_E2_over_E_True","", n_bins100, 0.5,1.00);
  TH1F* h_1500_CT_genjet06_Delta_E1_E2_over_E12 =  new TH1F("h_1500_CT_genjet06_Delta_E1_E2_over_E12","", n_bins100, -0.5,0.5);
  TH1F* h_1500_CT_genjet07_dphi_j1j2 =  new TH1F("h_1500_CT_genjet07_dphi_j1j2","", n_bins100, 0.5,TMath::Pi());
  TH1F* h_1500_CT_genjet07_E1_E2_over_E_True =  new TH1F("h_1500_CT_genjet07_E1_E2_over_E_True","", n_bins100, 0.5,1.00);
  TH1F* h_1500_CT_genjet07_Delta_E1_E2_over_E12 =  new TH1F("h_1500_CT_genjet07_Delta_E1_E2_over_E12","", n_bins100, -0.5,0.5);
  TH1F* h_1500_CT_genjet08_dphi_j1j2 =  new TH1F("h_1500_CT_genjet08_dphi_j1j2","", n_bins100, 0.5,TMath::Pi());
  TH1F* h_1500_CT_genjet08_E1_E2_over_E_True =  new TH1F("h_1500_CT_genjet08_E1_E2_over_E_True","", n_bins100, 0.5,1.00);
  TH1F* h_1500_CT_genjet08_Delta_E1_E2_over_E12 =  new TH1F("h_1500_CT_genjet08_Delta_E1_E2_over_E12","", n_bins100, -0.5,0.5);
  TH1F* h_1500_CT_genjet09_dphi_j1j2 =  new TH1F("h_1500_CT_genjet09_dphi_j1j2","", n_bins100, 0.5,TMath::Pi());
  TH1F* h_1500_CT_genjet09_E1_E2_over_E_True =  new TH1F("h_1500_CT_genjet09_E1_E2_over_E_True","", n_bins100, 0.5,1.00);
  TH1F* h_1500_CT_genjet09_Delta_E1_E2_over_E12 =  new TH1F("h_1500_CT_genjet09_Delta_E1_E2_over_E12","", n_bins100, -0.5,0.5);
  TH1F* h_1500_CT_genjet10_dphi_j1j2 =  new TH1F("h_1500_CT_genjet10_dphi_j1j2","", n_bins100, 0.5,TMath::Pi());
  TH1F* h_1500_CT_genjet10_E1_E2_over_E_True =  new TH1F("h_1500_CT_genjet10_E1_E2_over_E_True","", n_bins100, 0.5,1.00);
  TH1F* h_1500_CT_genjet10_Delta_E1_E2_over_E12 =  new TH1F("h_1500_CT_genjet10_Delta_E1_E2_over_E12","", n_bins100, -0.5,0.5);

  TH1F* h_1500_CT_recojet03_dphi_j1j2 =  new TH1F("h_1500_CT_recojet03_dphi_j1j2","", n_bins100, 0.5,TMath::Pi());
  TH1F* h_1500_CT_recojet03_E1_E2_over_E_True =  new TH1F("h_1500_CT_recojet03_E1_E2_over_E_True","", n_bins100, 0.5,1.00);
  TH1F* h_1500_CT_recojet03_Delta_E1_E2_over_E12 =  new TH1F("h_1500_CT_recojet03_Delta_E1_E2_over_E12","", n_bins100, -0.5,0.5);
  TH1F* h_1500_CT_recojet04_dphi_j1j2 =  new TH1F("h_1500_CT_recojet04_dphi_j1j2","", n_bins100, 0.5,TMath::Pi());
  TH1F* h_1500_CT_recojet04_E1_E2_over_E_True =  new TH1F("h_1500_CT_recojet04_E1_E2_over_E_True","", n_bins100, 0.5,1.00);
  TH1F* h_1500_CT_recojet04_Delta_E1_E2_over_E12 =  new TH1F("h_1500_CT_recojet04_Delta_E1_E2_over_E12","", n_bins100, -0.5,0.5);
  TH1F* h_1500_CT_recojet05_dphi_j1j2 =  new TH1F("h_1500_CT_recojet05_dphi_j1j2","", n_bins100, 0.5,TMath::Pi());
  TH1F* h_1500_CT_recojet05_E1_E2_over_E_True =  new TH1F("h_1500_CT_recojet05_E1_E2_over_E_True","", n_bins100, 0.5,1.00);
  TH1F* h_1500_CT_recojet05_Delta_E1_E2_over_E12 =  new TH1F("h_1500_CT_recojet05_Delta_E1_E2_over_E12","", n_bins100, -0.5,0.5);
  TH1F* h_1500_CT_recojet06_dphi_j1j2 =  new TH1F("h_1500_CT_recojet06_dphi_j1j2","", n_bins100, 0.5,TMath::Pi());
  TH1F* h_1500_CT_recojet06_E1_E2_over_E_True =  new TH1F("h_1500_CT_recojet06_E1_E2_over_E_True","", n_bins100, 0.5,1.00);
  TH1F* h_1500_CT_recojet06_Delta_E1_E2_over_E12 =  new TH1F("h_1500_CT_recojet06_Delta_E1_E2_over_E12","", n_bins100, -0.5,0.5);
  TH1F* h_1500_CT_recojet07_dphi_j1j2 =  new TH1F("h_1500_CT_recojet07_dphi_j1j2","", n_bins100, 0.5,TMath::Pi());
  TH1F* h_1500_CT_recojet07_E1_E2_over_E_True =  new TH1F("h_1500_CT_recojet07_E1_E2_over_E_True","", n_bins100, 0.5,1.00);
  TH1F* h_1500_CT_recojet07_Delta_E1_E2_over_E12 =  new TH1F("h_1500_CT_recojet07_Delta_E1_E2_over_E12","", n_bins100, -0.5,0.5);
  TH1F* h_1500_CT_recojet08_dphi_j1j2 =  new TH1F("h_1500_CT_recojet08_dphi_j1j2","", n_bins100, 0.5,TMath::Pi());
  TH1F* h_1500_CT_recojet08_E1_E2_over_E_True =  new TH1F("h_1500_CT_recojet08_E1_E2_over_E_True","", n_bins100, 0.5,1.00);
  TH1F* h_1500_CT_recojet08_Delta_E1_E2_over_E12 =  new TH1F("h_1500_CT_recojet08_Delta_E1_E2_over_E12","", n_bins100, -0.5,0.5);
  TH1F* h_1500_CT_recojet09_dphi_j1j2 =  new TH1F("h_1500_CT_recojet09_dphi_j1j2","", n_bins100, 0.5,TMath::Pi());
  TH1F* h_1500_CT_recojet09_E1_E2_over_E_True =  new TH1F("h_1500_CT_recojet09_E1_E2_over_E_True","", n_bins100, 0.5,1.00);
  TH1F* h_1500_CT_recojet09_Delta_E1_E2_over_E12 =  new TH1F("h_1500_CT_recojet09_Delta_E1_E2_over_E12","", n_bins100, -0.5,0.5);
  TH1F* h_1500_CT_recojet10_dphi_j1j2 =  new TH1F("h_1500_CT_recojet10_dphi_j1j2","", n_bins100, 0.5,TMath::Pi());
  TH1F* h_1500_CT_recojet10_E1_E2_over_E_True =  new TH1F("h_1500_CT_recojet10_E1_E2_over_E_True","", n_bins100, 0.5,1.00);
  TH1F* h_1500_CT_recojet10_Delta_E1_E2_over_E12 =  new TH1F("h_1500_CT_recojet10_Delta_E1_E2_over_E12","", n_bins100, -0.5,0.5);

  TH1F* h_1500_CT_recojetE_over_genjetE_DR03 =  new TH1F("h_1500_CT_recojetE_over_genjetE_DR03","", n_bins100, 0.5,1.5);
  TH1F* h_1500_CT_recojetE_over_genjetE_DR04 =  new TH1F("h_1500_CT_recojetE_over_genjetE_DR04","", n_bins100, 0.5,1.5);
  TH1F* h_1500_CT_recojetE_over_genjetE_DR05 =  new TH1F("h_1500_CT_recojetE_over_genjetE_DR05","", n_bins100, 0.5,1.5);
  TH1F* h_1500_CT_recojetE_over_genjetE_DR06 =  new TH1F("h_1500_CT_recojetE_over_genjetE_DR06","", n_bins100, 0.5,1.5);
  TH1F* h_1500_CT_recojetE_over_genjetE_DR07 =  new TH1F("h_1500_CT_recojetE_over_genjetE_DR07","", n_bins100, 0.5,1.5);
  TH1F* h_1500_CT_recojetE_over_genjetE_DR08 =  new TH1F("h_1500_CT_recojetE_over_genjetE_DR08","", n_bins100, 0.5,1.5);
  TH1F* h_1500_CT_recojetE_over_genjetE_DR09 =  new TH1F("h_1500_CT_recojetE_over_genjetE_DR09","", n_bins100, 0.5,1.5);
  TH1F* h_1500_CT_recojetE_over_genjetE_DR10 =  new TH1F("h_1500_CT_recojetE_over_genjetE_DR10","", n_bins100, 0.5,1.5);

  TH1F* h_1500_CT_dphi_gen_reco_DR05 =  new TH1F("h_1500_CT_dphi_gen_reco_DR05","", n_bins100, -0.1,9.9);
  TH1F* h_1500_CT_dphi_gen_reco_DR06 =  new TH1F("h_1500_CT_dphi_gen_reco_DR06","", n_bins100, -0.1,9.9);
  TH1F* h_1500_CT_dphi_gen_reco_DR07 =  new TH1F("h_1500_CT_dphi_gen_reco_DR07","", n_bins100, -0.1,9.9);

  TH1F* h_1500_CT_DR05_E_rel_totVis_RMS_d1_cosT_0_to_0_10 =  new TH1F("h_1500_CT_DR05_E_rel_totVis_RMS_d1_cosT_0_to_0_10","", n_binsJER, lim_E_rel_low,lim_E_rel_high);
  TH1F* h_1500_CT_DR05_E_rel_totVis_RMS_d1_cosT_0_10_to_0_20 =  new TH1F("h_1500_CT_DR05_E_rel_totVis_RMS_d1_cosT_0_10_to_0_20","", n_binsJER, lim_E_rel_low,lim_E_rel_high);
  TH1F* h_1500_CT_DR05_E_rel_totVis_RMS_d1_cosT_0_20_to_0_30 =  new TH1F("h_1500_CT_DR05_E_rel_totVis_RMS_d1_cosT_0_20_to_0_30","", n_binsJER, lim_E_rel_low,lim_E_rel_high);
  TH1F* h_1500_CT_DR05_E_rel_totVis_RMS_d1_cosT_0_30_to_0_40 =  new TH1F("h_1500_CT_DR05_E_rel_totVis_RMS_d1_cosT_0_30_to_0_40","", n_binsJER, lim_E_rel_low,lim_E_rel_high);
  TH1F* h_1500_CT_DR05_E_rel_totVis_RMS_d1_cosT_0_40_to_0_50 =  new TH1F("h_1500_CT_DR05_E_rel_totVis_RMS_d1_cosT_0_40_to_0_50","", n_binsJER, lim_E_rel_low,lim_E_rel_high);
  TH1F* h_1500_CT_DR05_E_rel_totVis_RMS_d1_cosT_0_50_to_0_60 =  new TH1F("h_1500_CT_DR05_E_rel_totVis_RMS_d1_cosT_0_50_to_0_60","", n_binsJER, lim_E_rel_low,lim_E_rel_high);
  TH1F* h_1500_CT_DR05_E_rel_totVis_RMS_d1_cosT_0_60_to_0_70 =  new TH1F("h_1500_CT_DR05_E_rel_totVis_RMS_d1_cosT_0_60_to_0_70","", n_binsJER, lim_E_rel_low,lim_E_rel_high);
  TH1F* h_1500_CT_DR05_E_rel_totVis_RMS_d1_cosT_0_70_to_0_80 =  new TH1F("h_1500_CT_DR05_E_rel_totVis_RMS_d1_cosT_0_70_to_0_80","", n_binsJER, lim_E_rel_low,lim_E_rel_high);
  TH1F* h_1500_CT_DR05_E_rel_totVis_RMS_d1_cosT_0_80_to_0_90 =  new TH1F("h_1500_CT_DR05_E_rel_totVis_RMS_d1_cosT_0_80_to_0_90","", n_binsJER, lim_E_rel_low,lim_E_rel_high);
  TH1F* h_1500_CT_DR05_E_rel_totVis_RMS_d1_cosT_0_900_to_0_925 =  new TH1F("h_1500_CT_DR05_E_rel_totVis_RMS_d1_cosT_0_900_to_0_925","", n_binsJER, lim_E_rel_low,lim_E_rel_high);
  TH1F* h_1500_CT_DR05_E_rel_totVis_RMS_d1_cosT_0_925_to_0_950 =  new TH1F("h_1500_CT_DR05_E_rel_totVis_RMS_d1_cosT_0_925_to_0_950","", n_binsJER, lim_E_rel_low,lim_E_rel_high);
  TH1F* h_1500_CT_DR05_E_rel_totVis_RMS_d1_cosT_0_950_to_0_975 =  new TH1F("h_1500_CT_DR05_E_rel_totVis_RMS_d1_cosT_0_950_to_0_975","", n_binsJER, lim_E_rel_low,lim_E_rel_high);
  TH1F* h_1500_CT_DR05_E_rel_totVis_RMS_d1_cosT_0_975_to_1_00 =  new TH1F("h_1500_CT_DR05_E_rel_totVis_RMS_d1_cosT_0_975_to_1_00","", n_binsJER, lim_E_rel_low,lim_E_rel_high);

  TH1F* h_1500_CT_DR06_E_rel_totVis_RMS_d1_cosT_0_to_0_10 =  new TH1F("h_1500_CT_DR06_E_rel_totVis_RMS_d1_cosT_0_to_0_10","", n_binsJER, lim_E_rel_low,lim_E_rel_high);
  TH1F* h_1500_CT_DR06_E_rel_totVis_RMS_d1_cosT_0_10_to_0_20 =  new TH1F("h_1500_CT_DR06_E_rel_totVis_RMS_d1_cosT_0_10_to_0_20","", n_binsJER, lim_E_rel_low,lim_E_rel_high);
  TH1F* h_1500_CT_DR06_E_rel_totVis_RMS_d1_cosT_0_20_to_0_30 =  new TH1F("h_1500_CT_DR06_E_rel_totVis_RMS_d1_cosT_0_20_to_0_30","", n_binsJER, lim_E_rel_low,lim_E_rel_high);
  TH1F* h_1500_CT_DR06_E_rel_totVis_RMS_d1_cosT_0_30_to_0_40 =  new TH1F("h_1500_CT_DR06_E_rel_totVis_RMS_d1_cosT_0_30_to_0_40","", n_binsJER, lim_E_rel_low,lim_E_rel_high);
  TH1F* h_1500_CT_DR06_E_rel_totVis_RMS_d1_cosT_0_40_to_0_50 =  new TH1F("h_1500_CT_DR06_E_rel_totVis_RMS_d1_cosT_0_40_to_0_50","", n_binsJER, lim_E_rel_low,lim_E_rel_high);
  TH1F* h_1500_CT_DR06_E_rel_totVis_RMS_d1_cosT_0_50_to_0_60 =  new TH1F("h_1500_CT_DR06_E_rel_totVis_RMS_d1_cosT_0_50_to_0_60","", n_binsJER, lim_E_rel_low,lim_E_rel_high);
  TH1F* h_1500_CT_DR06_E_rel_totVis_RMS_d1_cosT_0_60_to_0_70 =  new TH1F("h_1500_CT_DR06_E_rel_totVis_RMS_d1_cosT_0_60_to_0_70","", n_binsJER, lim_E_rel_low,lim_E_rel_high);
  TH1F* h_1500_CT_DR06_E_rel_totVis_RMS_d1_cosT_0_70_to_0_80 =  new TH1F("h_1500_CT_DR06_E_rel_totVis_RMS_d1_cosT_0_70_to_0_80","", n_binsJER, lim_E_rel_low,lim_E_rel_high);
  TH1F* h_1500_CT_DR06_E_rel_totVis_RMS_d1_cosT_0_80_to_0_90 =  new TH1F("h_1500_CT_DR06_E_rel_totVis_RMS_d1_cosT_0_80_to_0_90","", n_binsJER, lim_E_rel_low,lim_E_rel_high);
  TH1F* h_1500_CT_DR06_E_rel_totVis_RMS_d1_cosT_0_900_to_0_925 =  new TH1F("h_1500_CT_DR06_E_rel_totVis_RMS_d1_cosT_0_900_to_0_925","", n_binsJER, lim_E_rel_low,lim_E_rel_high);
  TH1F* h_1500_CT_DR06_E_rel_totVis_RMS_d1_cosT_0_925_to_0_950 =  new TH1F("h_1500_CT_DR06_E_rel_totVis_RMS_d1_cosT_0_925_to_0_950","", n_binsJER, lim_E_rel_low,lim_E_rel_high);
  TH1F* h_1500_CT_DR06_E_rel_totVis_RMS_d1_cosT_0_950_to_0_975 =  new TH1F("h_1500_CT_DR06_E_rel_totVis_RMS_d1_cosT_0_950_to_0_975","", n_binsJER, lim_E_rel_low,lim_E_rel_high);
  TH1F* h_1500_CT_DR06_E_rel_totVis_RMS_d1_cosT_0_975_to_1_00 =  new TH1F("h_1500_CT_DR06_E_rel_totVis_RMS_d1_cosT_0_975_to_1_00","", n_binsJER, lim_E_rel_low,lim_E_rel_high);

  TH1F* h_1500_CT_DR07_E_rel_totVis_RMS_d1_cosT_0_to_0_10 =  new TH1F("h_1500_CT_DR07_E_rel_totVis_RMS_d1_cosT_0_to_0_10","", n_binsJER, lim_E_rel_low,lim_E_rel_high);
  TH1F* h_1500_CT_DR07_E_rel_totVis_RMS_d1_cosT_0_10_to_0_20 =  new TH1F("h_1500_CT_DR07_E_rel_totVis_RMS_d1_cosT_0_10_to_0_20","", n_binsJER, lim_E_rel_low,lim_E_rel_high);
  TH1F* h_1500_CT_DR07_E_rel_totVis_RMS_d1_cosT_0_20_to_0_30 =  new TH1F("h_1500_CT_DR07_E_rel_totVis_RMS_d1_cosT_0_20_to_0_30","", n_binsJER, lim_E_rel_low,lim_E_rel_high);
  TH1F* h_1500_CT_DR07_E_rel_totVis_RMS_d1_cosT_0_30_to_0_40 =  new TH1F("h_1500_CT_DR07_E_rel_totVis_RMS_d1_cosT_0_30_to_0_40","", n_binsJER, lim_E_rel_low,lim_E_rel_high);
  TH1F* h_1500_CT_DR07_E_rel_totVis_RMS_d1_cosT_0_40_to_0_50 =  new TH1F("h_1500_CT_DR07_E_rel_totVis_RMS_d1_cosT_0_40_to_0_50","", n_binsJER, lim_E_rel_low,lim_E_rel_high);
  TH1F* h_1500_CT_DR07_E_rel_totVis_RMS_d1_cosT_0_50_to_0_60 =  new TH1F("h_1500_CT_DR07_E_rel_totVis_RMS_d1_cosT_0_50_to_0_60","", n_binsJER, lim_E_rel_low,lim_E_rel_high);
  TH1F* h_1500_CT_DR07_E_rel_totVis_RMS_d1_cosT_0_60_to_0_70 =  new TH1F("h_1500_CT_DR07_E_rel_totVis_RMS_d1_cosT_0_60_to_0_70","", n_binsJER, lim_E_rel_low,lim_E_rel_high);
  TH1F* h_1500_CT_DR07_E_rel_totVis_RMS_d1_cosT_0_70_to_0_80 =  new TH1F("h_1500_CT_DR07_E_rel_totVis_RMS_d1_cosT_0_70_to_0_80","", n_binsJER, lim_E_rel_low,lim_E_rel_high);
  TH1F* h_1500_CT_DR07_E_rel_totVis_RMS_d1_cosT_0_80_to_0_90 =  new TH1F("h_1500_CT_DR07_E_rel_totVis_RMS_d1_cosT_0_80_to_0_90","", n_binsJER, lim_E_rel_low,lim_E_rel_high);
  TH1F* h_1500_CT_DR07_E_rel_totVis_RMS_d1_cosT_0_900_to_0_925 =  new TH1F("h_1500_CT_DR07_E_rel_totVis_RMS_d1_cosT_0_900_to_0_925","", n_binsJER, lim_E_rel_low,lim_E_rel_high);
  TH1F* h_1500_CT_DR07_E_rel_totVis_RMS_d1_cosT_0_925_to_0_950 =  new TH1F("h_1500_CT_DR07_E_rel_totVis_RMS_d1_cosT_0_925_to_0_950","", n_binsJER, lim_E_rel_low,lim_E_rel_high);
  TH1F* h_1500_CT_DR07_E_rel_totVis_RMS_d1_cosT_0_950_to_0_975 =  new TH1F("h_1500_CT_DR07_E_rel_totVis_RMS_d1_cosT_0_950_to_0_975","", n_binsJER, lim_E_rel_low,lim_E_rel_high);
  TH1F* h_1500_CT_DR07_E_rel_totVis_RMS_d1_cosT_0_975_to_1_00 =  new TH1F("h_1500_CT_DR07_E_rel_totVis_RMS_d1_cosT_0_975_to_1_00","", n_binsJER, lim_E_rel_low,lim_E_rel_high);

  TH1F* h_1500_CT_DR08_E_rel_totVis_RMS_d1_cosT_0_to_0_10 =  new TH1F("h_1500_CT_DR08_E_rel_totVis_RMS_d1_cosT_0_to_0_10","", n_binsJER, lim_E_rel_low,lim_E_rel_high);
  TH1F* h_1500_CT_DR08_E_rel_totVis_RMS_d1_cosT_0_10_to_0_20 =  new TH1F("h_1500_CT_DR08_E_rel_totVis_RMS_d1_cosT_0_10_to_0_20","", n_binsJER, lim_E_rel_low,lim_E_rel_high);
  TH1F* h_1500_CT_DR08_E_rel_totVis_RMS_d1_cosT_0_20_to_0_30 =  new TH1F("h_1500_CT_DR08_E_rel_totVis_RMS_d1_cosT_0_20_to_0_30","", n_binsJER, lim_E_rel_low,lim_E_rel_high);
  TH1F* h_1500_CT_DR08_E_rel_totVis_RMS_d1_cosT_0_30_to_0_40 =  new TH1F("h_1500_CT_DR08_E_rel_totVis_RMS_d1_cosT_0_30_to_0_40","", n_binsJER, lim_E_rel_low,lim_E_rel_high);
  TH1F* h_1500_CT_DR08_E_rel_totVis_RMS_d1_cosT_0_40_to_0_50 =  new TH1F("h_1500_CT_DR08_E_rel_totVis_RMS_d1_cosT_0_40_to_0_50","", n_binsJER, lim_E_rel_low,lim_E_rel_high);
  TH1F* h_1500_CT_DR08_E_rel_totVis_RMS_d1_cosT_0_50_to_0_60 =  new TH1F("h_1500_CT_DR08_E_rel_totVis_RMS_d1_cosT_0_50_to_0_60","", n_binsJER, lim_E_rel_low,lim_E_rel_high);
  TH1F* h_1500_CT_DR08_E_rel_totVis_RMS_d1_cosT_0_60_to_0_70 =  new TH1F("h_1500_CT_DR08_E_rel_totVis_RMS_d1_cosT_0_60_to_0_70","", n_binsJER, lim_E_rel_low,lim_E_rel_high);
  TH1F* h_1500_CT_DR08_E_rel_totVis_RMS_d1_cosT_0_70_to_0_80 =  new TH1F("h_1500_CT_DR08_E_rel_totVis_RMS_d1_cosT_0_70_to_0_80","", n_binsJER, lim_E_rel_low,lim_E_rel_high);
  TH1F* h_1500_CT_DR08_E_rel_totVis_RMS_d1_cosT_0_80_to_0_90 =  new TH1F("h_1500_CT_DR08_E_rel_totVis_RMS_d1_cosT_0_80_to_0_90","", n_binsJER, lim_E_rel_low,lim_E_rel_high);
  TH1F* h_1500_CT_DR08_E_rel_totVis_RMS_d1_cosT_0_900_to_0_925 =  new TH1F("h_1500_CT_DR08_E_rel_totVis_RMS_d1_cosT_0_900_to_0_925","", n_binsJER, lim_E_rel_low,lim_E_rel_high);
  TH1F* h_1500_CT_DR08_E_rel_totVis_RMS_d1_cosT_0_925_to_0_950 =  new TH1F("h_1500_CT_DR08_E_rel_totVis_RMS_d1_cosT_0_925_to_0_950","", n_binsJER, lim_E_rel_low,lim_E_rel_high);
  TH1F* h_1500_CT_DR08_E_rel_totVis_RMS_d1_cosT_0_950_to_0_975 =  new TH1F("h_1500_CT_DR08_E_rel_totVis_RMS_d1_cosT_0_950_to_0_975","", n_binsJER, lim_E_rel_low,lim_E_rel_high);
  TH1F* h_1500_CT_DR08_E_rel_totVis_RMS_d1_cosT_0_975_to_1_00 =  new TH1F("h_1500_CT_DR08_E_rel_totVis_RMS_d1_cosT_0_975_to_1_00","", n_binsJER, lim_E_rel_low,lim_E_rel_high);

  TH1F* h_1500_CT_DR09_E_rel_totVis_RMS_d1_cosT_0_to_0_10 =  new TH1F("h_1500_CT_DR09_E_rel_totVis_RMS_d1_cosT_0_to_0_10","", n_binsJER, lim_E_rel_low,lim_E_rel_high);
  TH1F* h_1500_CT_DR09_E_rel_totVis_RMS_d1_cosT_0_10_to_0_20 =  new TH1F("h_1500_CT_DR09_E_rel_totVis_RMS_d1_cosT_0_10_to_0_20","", n_binsJER, lim_E_rel_low,lim_E_rel_high);
  TH1F* h_1500_CT_DR09_E_rel_totVis_RMS_d1_cosT_0_20_to_0_30 =  new TH1F("h_1500_CT_DR09_E_rel_totVis_RMS_d1_cosT_0_20_to_0_30","", n_binsJER, lim_E_rel_low,lim_E_rel_high);
  TH1F* h_1500_CT_DR09_E_rel_totVis_RMS_d1_cosT_0_30_to_0_40 =  new TH1F("h_1500_CT_DR09_E_rel_totVis_RMS_d1_cosT_0_30_to_0_40","", n_binsJER, lim_E_rel_low,lim_E_rel_high);
  TH1F* h_1500_CT_DR09_E_rel_totVis_RMS_d1_cosT_0_40_to_0_50 =  new TH1F("h_1500_CT_DR09_E_rel_totVis_RMS_d1_cosT_0_40_to_0_50","", n_binsJER, lim_E_rel_low,lim_E_rel_high);
  TH1F* h_1500_CT_DR09_E_rel_totVis_RMS_d1_cosT_0_50_to_0_60 =  new TH1F("h_1500_CT_DR09_E_rel_totVis_RMS_d1_cosT_0_50_to_0_60","", n_binsJER, lim_E_rel_low,lim_E_rel_high);
  TH1F* h_1500_CT_DR09_E_rel_totVis_RMS_d1_cosT_0_60_to_0_70 =  new TH1F("h_1500_CT_DR09_E_rel_totVis_RMS_d1_cosT_0_60_to_0_70","", n_binsJER, lim_E_rel_low,lim_E_rel_high);
  TH1F* h_1500_CT_DR09_E_rel_totVis_RMS_d1_cosT_0_70_to_0_80 =  new TH1F("h_1500_CT_DR09_E_rel_totVis_RMS_d1_cosT_0_70_to_0_80","", n_binsJER, lim_E_rel_low,lim_E_rel_high);
  TH1F* h_1500_CT_DR09_E_rel_totVis_RMS_d1_cosT_0_80_to_0_90 =  new TH1F("h_1500_CT_DR09_E_rel_totVis_RMS_d1_cosT_0_80_to_0_90","", n_binsJER, lim_E_rel_low,lim_E_rel_high);
  TH1F* h_1500_CT_DR09_E_rel_totVis_RMS_d1_cosT_0_900_to_0_925 =  new TH1F("h_1500_CT_DR09_E_rel_totVis_RMS_d1_cosT_0_900_to_0_925","", n_binsJER, lim_E_rel_low,lim_E_rel_high);
  TH1F* h_1500_CT_DR09_E_rel_totVis_RMS_d1_cosT_0_925_to_0_950 =  new TH1F("h_1500_CT_DR09_E_rel_totVis_RMS_d1_cosT_0_925_to_0_950","", n_binsJER, lim_E_rel_low,lim_E_rel_high);
  TH1F* h_1500_CT_DR09_E_rel_totVis_RMS_d1_cosT_0_950_to_0_975 =  new TH1F("h_1500_CT_DR09_E_rel_totVis_RMS_d1_cosT_0_950_to_0_975","", n_binsJER, lim_E_rel_low,lim_E_rel_high);
  TH1F* h_1500_CT_DR09_E_rel_totVis_RMS_d1_cosT_0_975_to_1_00 =  new TH1F("h_1500_CT_DR09_E_rel_totVis_RMS_d1_cosT_0_975_to_1_00","", n_binsJER, lim_E_rel_low,lim_E_rel_high);

  TH1F* h_1500_CT_DR10_E_rel_totVis_RMS_d1_cosT_0_to_0_10 =  new TH1F("h_1500_CT_DR10_E_rel_totVis_RMS_d1_cosT_0_to_0_10","", n_binsJER, lim_E_rel_low,lim_E_rel_high);
  TH1F* h_1500_CT_DR10_E_rel_totVis_RMS_d1_cosT_0_10_to_0_20 =  new TH1F("h_1500_CT_DR10_E_rel_totVis_RMS_d1_cosT_0_10_to_0_20","", n_binsJER, lim_E_rel_low,lim_E_rel_high);
  TH1F* h_1500_CT_DR10_E_rel_totVis_RMS_d1_cosT_0_20_to_0_30 =  new TH1F("h_1500_CT_DR10_E_rel_totVis_RMS_d1_cosT_0_20_to_0_30","", n_binsJER, lim_E_rel_low,lim_E_rel_high);
  TH1F* h_1500_CT_DR10_E_rel_totVis_RMS_d1_cosT_0_30_to_0_40 =  new TH1F("h_1500_CT_DR10_E_rel_totVis_RMS_d1_cosT_0_30_to_0_40","", n_binsJER, lim_E_rel_low,lim_E_rel_high);
  TH1F* h_1500_CT_DR10_E_rel_totVis_RMS_d1_cosT_0_40_to_0_50 =  new TH1F("h_1500_CT_DR10_E_rel_totVis_RMS_d1_cosT_0_40_to_0_50","", n_binsJER, lim_E_rel_low,lim_E_rel_high);
  TH1F* h_1500_CT_DR10_E_rel_totVis_RMS_d1_cosT_0_50_to_0_60 =  new TH1F("h_1500_CT_DR10_E_rel_totVis_RMS_d1_cosT_0_50_to_0_60","", n_binsJER, lim_E_rel_low,lim_E_rel_high);
  TH1F* h_1500_CT_DR10_E_rel_totVis_RMS_d1_cosT_0_60_to_0_70 =  new TH1F("h_1500_CT_DR10_E_rel_totVis_RMS_d1_cosT_0_60_to_0_70","", n_binsJER, lim_E_rel_low,lim_E_rel_high);
  TH1F* h_1500_CT_DR10_E_rel_totVis_RMS_d1_cosT_0_70_to_0_80 =  new TH1F("h_1500_CT_DR10_E_rel_totVis_RMS_d1_cosT_0_70_to_0_80","", n_binsJER, lim_E_rel_low,lim_E_rel_high);
  TH1F* h_1500_CT_DR10_E_rel_totVis_RMS_d1_cosT_0_80_to_0_90 =  new TH1F("h_1500_CT_DR10_E_rel_totVis_RMS_d1_cosT_0_80_to_0_90","", n_binsJER, lim_E_rel_low,lim_E_rel_high);
  TH1F* h_1500_CT_DR10_E_rel_totVis_RMS_d1_cosT_0_900_to_0_925 =  new TH1F("h_1500_CT_DR10_E_rel_totVis_RMS_d1_cosT_0_900_to_0_925","", n_binsJER, lim_E_rel_low,lim_E_rel_high);
  TH1F* h_1500_CT_DR10_E_rel_totVis_RMS_d1_cosT_0_925_to_0_950 =  new TH1F("h_1500_CT_DR10_E_rel_totVis_RMS_d1_cosT_0_925_to_0_950","", n_binsJER, lim_E_rel_low,lim_E_rel_high);
  TH1F* h_1500_CT_DR10_E_rel_totVis_RMS_d1_cosT_0_950_to_0_975 =  new TH1F("h_1500_CT_DR10_E_rel_totVis_RMS_d1_cosT_0_950_to_0_975","", n_binsJER, lim_E_rel_low,lim_E_rel_high);
  TH1F* h_1500_CT_DR10_E_rel_totVis_RMS_d1_cosT_0_975_to_1_00 =  new TH1F("h_1500_CT_DR10_E_rel_totVis_RMS_d1_cosT_0_975_to_1_00","", n_binsJER, lim_E_rel_low,lim_E_rel_high);

  TH1F* h_1500_CT_DR05_dphi_reco_gen_cosTheta_0_65 =  new TH1F("h_1500_CT_DR05_dphi_reco_gen_cosTheta_0_65","", n_bins100, -lim_angleDeg,lim_angleDeg);
  TH1F* h_1500_CT_DR05_dtheta_reco_gen_cosTheta_0_65 =  new TH1F("h_1500_CT_DR05_dtheta_reco_gen_cosTheta_0_65","", n_bins100, -lim_angleDeg,lim_angleDeg);
  TH1F* h_1500_CT_DR05_dphi_reco_gen_cosTheta_0_65_to_0_80 =  new TH1F("h_1500_CT_DR05_dphi_reco_gen_cosTheta_0_65_to_0_80","", n_bins100, -lim_angleDeg,lim_angleDeg);
  TH1F* h_1500_CT_DR05_dtheta_reco_gen_cosTheta_0_65_to_0_80 =  new TH1F("h_1500_CT_DR05_dtheta_reco_gen_cosTheta_0_65_to_0_80","", n_bins100, -lim_angleDeg,lim_angleDeg);
  TH1F* h_1500_CT_DR05_dphi_reco_gen_cosTheta_0_80_to_0_925 =  new TH1F("h_1500_CT_DR05_dphi_reco_gen_cosTheta_0_80_to_0_925","", n_bins100, -lim_angleDeg,lim_angleDeg);
  TH1F* h_1500_CT_DR05_dtheta_reco_gen_cosTheta_0_80_to_0_925 =  new TH1F("h_1500_CT_DR05_dtheta_reco_gen_cosTheta_0_80_to_0_925","", n_bins100, -lim_angleDeg,lim_angleDeg);
  TH1F* h_1500_CT_DR05_dphi_reco_gen_cosTheta_0_925_to_0_975 =  new TH1F("h_1500_CT_DR05_dphi_reco_gen_cosTheta_0_925_to_0_975","", n_bins100, -lim_angleDeg,lim_angleDeg);
  TH1F* h_1500_CT_DR05_dtheta_reco_gen_cosTheta_0_925_to_0_975 =  new TH1F("h_1500_CT_DR05_dtheta_reco_gen_cosTheta_0_925_to_0_975","", n_bins100, -lim_angleDeg,lim_angleDeg);

  TH1F* h_1500_CT_DR07_dphi_reco_gen_cosTheta_0_65 =  new TH1F("h_1500_CT_DR07_dphi_reco_gen_cosTheta_0_65","", n_bins100, -lim_angleDeg,lim_angleDeg);
  TH1F* h_1500_CT_DR07_dtheta_reco_gen_cosTheta_0_65 =  new TH1F("h_1500_CT_DR07_dtheta_reco_gen_cosTheta_0_65","", n_bins100, -lim_angleDeg,lim_angleDeg);
  TH1F* h_1500_CT_DR07_dphi_reco_gen_cosTheta_0_65_to_0_80 =  new TH1F("h_1500_CT_DR07_dphi_reco_gen_cosTheta_0_65_to_0_80","", n_bins100, -lim_angleDeg,lim_angleDeg);
  TH1F* h_1500_CT_DR07_dtheta_reco_gen_cosTheta_0_65_to_0_80 =  new TH1F("h_1500_CT_DR07_dtheta_reco_gen_cosTheta_0_65_to_0_80","", n_bins100, -lim_angleDeg,lim_angleDeg);
  TH1F* h_1500_CT_DR07_dphi_reco_gen_cosTheta_0_80_to_0_925 =  new TH1F("h_1500_CT_DR07_dphi_reco_gen_cosTheta_0_80_to_0_925","", n_bins100, -lim_angleDeg,lim_angleDeg);
  TH1F* h_1500_CT_DR07_dtheta_reco_gen_cosTheta_0_80_to_0_925 =  new TH1F("h_1500_CT_DR07_dtheta_reco_gen_cosTheta_0_80_to_0_925","", n_bins100, -lim_angleDeg,lim_angleDeg);
  TH1F* h_1500_CT_DR07_dphi_reco_gen_cosTheta_0_925_to_0_975 =  new TH1F("h_1500_CT_DR07_dphi_reco_gen_cosTheta_0_925_to_0_975","", n_bins100, -lim_angleDeg,lim_angleDeg);
  TH1F* h_1500_CT_DR07_dtheta_reco_gen_cosTheta_0_925_to_0_975 =  new TH1F("h_1500_CT_DR07_dtheta_reco_gen_cosTheta_0_925_to_0_975","", n_bins100, -lim_angleDeg,lim_angleDeg);

  TH1F* h_1500_CT_DR10_dphi_reco_gen_cosTheta_0_65 =  new TH1F("h_1500_CT_DR10_dphi_reco_gen_cosTheta_0_65","", n_bins100, -lim_angleDeg,lim_angleDeg);
  TH1F* h_1500_CT_DR10_dtheta_reco_gen_cosTheta_0_65 =  new TH1F("h_1500_CT_DR10_dtheta_reco_gen_cosTheta_0_65","", n_bins100, -lim_angleDeg,lim_angleDeg);
  TH1F* h_1500_CT_DR10_dphi_reco_gen_cosTheta_0_65_to_0_80 =  new TH1F("h_1500_CT_DR10_dphi_reco_gen_cosTheta_0_65_to_0_80","", n_bins100, -lim_angleDeg,lim_angleDeg);
  TH1F* h_1500_CT_DR10_dtheta_reco_gen_cosTheta_0_65_to_0_80 =  new TH1F("h_1500_CT_DR10_dtheta_reco_gen_cosTheta_0_65_to_0_80","", n_bins100, -lim_angleDeg,lim_angleDeg);
  TH1F* h_1500_CT_DR10_dphi_reco_gen_cosTheta_0_80_to_0_925 =  new TH1F("h_1500_CT_DR10_dphi_reco_gen_cosTheta_0_80_to_0_925","", n_bins100, -lim_angleDeg,lim_angleDeg);
  TH1F* h_1500_CT_DR10_dtheta_reco_gen_cosTheta_0_80_to_0_925 =  new TH1F("h_1500_CT_DR10_dtheta_reco_gen_cosTheta_0_80_to_0_925","", n_bins100, -lim_angleDeg,lim_angleDeg);
  TH1F* h_1500_CT_DR10_dphi_reco_gen_cosTheta_0_925_to_0_975 =  new TH1F("h_1500_CT_DR10_dphi_reco_gen_cosTheta_0_925_to_0_975","", n_bins100, -lim_angleDeg,lim_angleDeg);
  TH1F* h_1500_CT_DR10_dtheta_reco_gen_cosTheta_0_925_to_0_975 =  new TH1F("h_1500_CT_DR10_dtheta_reco_gen_cosTheta_0_925_to_0_975","", n_bins100, -lim_angleDeg,lim_angleDeg);

  std::vector<TH1F*> hist_vec_1500_CT;
  hist_vec_1500_CT.push_back(h_1500_CT_genjet03_dphi_j1j2);
  hist_vec_1500_CT.push_back(h_1500_CT_genjet03_E1_E2_over_E_True);
  hist_vec_1500_CT.push_back(h_1500_CT_genjet03_Delta_E1_E2_over_E12);
  hist_vec_1500_CT.push_back(h_1500_CT_genjet04_dphi_j1j2);
  hist_vec_1500_CT.push_back(h_1500_CT_genjet04_E1_E2_over_E_True);
  hist_vec_1500_CT.push_back(h_1500_CT_genjet04_Delta_E1_E2_over_E12);
  hist_vec_1500_CT.push_back(h_1500_CT_genjet05_dphi_j1j2);
  hist_vec_1500_CT.push_back(h_1500_CT_genjet05_E1_E2_over_E_True);
  hist_vec_1500_CT.push_back(h_1500_CT_genjet05_Delta_E1_E2_over_E12);
  hist_vec_1500_CT.push_back(h_1500_CT_genjet06_dphi_j1j2);
  hist_vec_1500_CT.push_back(h_1500_CT_genjet06_E1_E2_over_E_True);
  hist_vec_1500_CT.push_back(h_1500_CT_genjet06_Delta_E1_E2_over_E12);
  hist_vec_1500_CT.push_back(h_1500_CT_genjet07_dphi_j1j2);
  hist_vec_1500_CT.push_back(h_1500_CT_genjet07_E1_E2_over_E_True);
  hist_vec_1500_CT.push_back(h_1500_CT_genjet07_Delta_E1_E2_over_E12);
  hist_vec_1500_CT.push_back(h_1500_CT_genjet08_dphi_j1j2);
  hist_vec_1500_CT.push_back(h_1500_CT_genjet08_E1_E2_over_E_True);
  hist_vec_1500_CT.push_back(h_1500_CT_genjet08_Delta_E1_E2_over_E12);
  hist_vec_1500_CT.push_back(h_1500_CT_genjet09_dphi_j1j2);
  hist_vec_1500_CT.push_back(h_1500_CT_genjet09_E1_E2_over_E_True);
  hist_vec_1500_CT.push_back(h_1500_CT_genjet09_Delta_E1_E2_over_E12);
  hist_vec_1500_CT.push_back(h_1500_CT_genjet10_dphi_j1j2);
  hist_vec_1500_CT.push_back(h_1500_CT_genjet10_E1_E2_over_E_True);
  hist_vec_1500_CT.push_back(h_1500_CT_genjet10_Delta_E1_E2_over_E12);

  hist_vec_1500_CT.push_back(h_1500_CT_recojet03_dphi_j1j2);
  hist_vec_1500_CT.push_back(h_1500_CT_recojet03_E1_E2_over_E_True);
  hist_vec_1500_CT.push_back(h_1500_CT_recojet03_Delta_E1_E2_over_E12);
  hist_vec_1500_CT.push_back(h_1500_CT_recojet04_dphi_j1j2);
  hist_vec_1500_CT.push_back(h_1500_CT_recojet04_E1_E2_over_E_True);
  hist_vec_1500_CT.push_back(h_1500_CT_recojet04_Delta_E1_E2_over_E12);
  hist_vec_1500_CT.push_back(h_1500_CT_recojet05_dphi_j1j2);
  hist_vec_1500_CT.push_back(h_1500_CT_recojet05_E1_E2_over_E_True);
  hist_vec_1500_CT.push_back(h_1500_CT_recojet05_Delta_E1_E2_over_E12);
  hist_vec_1500_CT.push_back(h_1500_CT_recojet06_dphi_j1j2);
  hist_vec_1500_CT.push_back(h_1500_CT_recojet06_E1_E2_over_E_True);
  hist_vec_1500_CT.push_back(h_1500_CT_recojet06_Delta_E1_E2_over_E12);
  hist_vec_1500_CT.push_back(h_1500_CT_recojet07_dphi_j1j2);
  hist_vec_1500_CT.push_back(h_1500_CT_recojet07_E1_E2_over_E_True);
  hist_vec_1500_CT.push_back(h_1500_CT_recojet07_Delta_E1_E2_over_E12);
  hist_vec_1500_CT.push_back(h_1500_CT_recojet08_dphi_j1j2);
  hist_vec_1500_CT.push_back(h_1500_CT_recojet08_E1_E2_over_E_True);
  hist_vec_1500_CT.push_back(h_1500_CT_recojet08_Delta_E1_E2_over_E12);
  hist_vec_1500_CT.push_back(h_1500_CT_recojet09_dphi_j1j2);
  hist_vec_1500_CT.push_back(h_1500_CT_recojet09_E1_E2_over_E_True);
  hist_vec_1500_CT.push_back(h_1500_CT_recojet09_Delta_E1_E2_over_E12);
  hist_vec_1500_CT.push_back(h_1500_CT_recojet10_dphi_j1j2);
  hist_vec_1500_CT.push_back(h_1500_CT_recojet10_E1_E2_over_E_True);
  hist_vec_1500_CT.push_back(h_1500_CT_recojet10_Delta_E1_E2_over_E12);

  hist_vec_1500_CT.push_back(h_1500_CT_recojetE_over_genjetE_DR03);
  hist_vec_1500_CT.push_back(h_1500_CT_recojetE_over_genjetE_DR04);
  hist_vec_1500_CT.push_back(h_1500_CT_recojetE_over_genjetE_DR05);
  hist_vec_1500_CT.push_back(h_1500_CT_recojetE_over_genjetE_DR06);
  hist_vec_1500_CT.push_back(h_1500_CT_recojetE_over_genjetE_DR07);
  hist_vec_1500_CT.push_back(h_1500_CT_recojetE_over_genjetE_DR08);
  hist_vec_1500_CT.push_back(h_1500_CT_recojetE_over_genjetE_DR09);
  hist_vec_1500_CT.push_back(h_1500_CT_recojetE_over_genjetE_DR10);

  hist_vec_1500_CT.push_back(h_1500_CT_dphi_gen_reco_DR05);
  hist_vec_1500_CT.push_back(h_1500_CT_dphi_gen_reco_DR06);
  hist_vec_1500_CT.push_back(h_1500_CT_dphi_gen_reco_DR07);

  hist_vec_1500_CT.push_back(h_1500_CT_DR05_E_rel_totVis_RMS_d1_cosT_0_to_0_10);
  hist_vec_1500_CT.push_back(h_1500_CT_DR05_E_rel_totVis_RMS_d1_cosT_0_10_to_0_20);
  hist_vec_1500_CT.push_back(h_1500_CT_DR05_E_rel_totVis_RMS_d1_cosT_0_20_to_0_30);
  hist_vec_1500_CT.push_back(h_1500_CT_DR05_E_rel_totVis_RMS_d1_cosT_0_30_to_0_40);
  hist_vec_1500_CT.push_back(h_1500_CT_DR05_E_rel_totVis_RMS_d1_cosT_0_40_to_0_50);
  hist_vec_1500_CT.push_back(h_1500_CT_DR05_E_rel_totVis_RMS_d1_cosT_0_50_to_0_60);
  hist_vec_1500_CT.push_back(h_1500_CT_DR05_E_rel_totVis_RMS_d1_cosT_0_60_to_0_70);
  hist_vec_1500_CT.push_back(h_1500_CT_DR05_E_rel_totVis_RMS_d1_cosT_0_70_to_0_80);
  hist_vec_1500_CT.push_back(h_1500_CT_DR05_E_rel_totVis_RMS_d1_cosT_0_80_to_0_90);
  hist_vec_1500_CT.push_back(h_1500_CT_DR05_E_rel_totVis_RMS_d1_cosT_0_900_to_0_925);
  hist_vec_1500_CT.push_back(h_1500_CT_DR05_E_rel_totVis_RMS_d1_cosT_0_925_to_0_950);
  hist_vec_1500_CT.push_back(h_1500_CT_DR05_E_rel_totVis_RMS_d1_cosT_0_950_to_0_975);
  hist_vec_1500_CT.push_back(h_1500_CT_DR05_E_rel_totVis_RMS_d1_cosT_0_975_to_1_00);

  hist_vec_1500_CT.push_back(h_1500_CT_DR06_E_rel_totVis_RMS_d1_cosT_0_to_0_10);
  hist_vec_1500_CT.push_back(h_1500_CT_DR06_E_rel_totVis_RMS_d1_cosT_0_10_to_0_20);
  hist_vec_1500_CT.push_back(h_1500_CT_DR06_E_rel_totVis_RMS_d1_cosT_0_20_to_0_30);
  hist_vec_1500_CT.push_back(h_1500_CT_DR06_E_rel_totVis_RMS_d1_cosT_0_30_to_0_40);
  hist_vec_1500_CT.push_back(h_1500_CT_DR06_E_rel_totVis_RMS_d1_cosT_0_40_to_0_50);
  hist_vec_1500_CT.push_back(h_1500_CT_DR06_E_rel_totVis_RMS_d1_cosT_0_50_to_0_60);
  hist_vec_1500_CT.push_back(h_1500_CT_DR06_E_rel_totVis_RMS_d1_cosT_0_60_to_0_70);
  hist_vec_1500_CT.push_back(h_1500_CT_DR06_E_rel_totVis_RMS_d1_cosT_0_70_to_0_80);
  hist_vec_1500_CT.push_back(h_1500_CT_DR06_E_rel_totVis_RMS_d1_cosT_0_80_to_0_90);
  hist_vec_1500_CT.push_back(h_1500_CT_DR06_E_rel_totVis_RMS_d1_cosT_0_900_to_0_925);
  hist_vec_1500_CT.push_back(h_1500_CT_DR06_E_rel_totVis_RMS_d1_cosT_0_925_to_0_950);
  hist_vec_1500_CT.push_back(h_1500_CT_DR06_E_rel_totVis_RMS_d1_cosT_0_950_to_0_975);
  hist_vec_1500_CT.push_back(h_1500_CT_DR06_E_rel_totVis_RMS_d1_cosT_0_975_to_1_00); 

  hist_vec_1500_CT.push_back(h_1500_CT_DR07_E_rel_totVis_RMS_d1_cosT_0_to_0_10);
  hist_vec_1500_CT.push_back(h_1500_CT_DR07_E_rel_totVis_RMS_d1_cosT_0_10_to_0_20);
  hist_vec_1500_CT.push_back(h_1500_CT_DR07_E_rel_totVis_RMS_d1_cosT_0_20_to_0_30);
  hist_vec_1500_CT.push_back(h_1500_CT_DR07_E_rel_totVis_RMS_d1_cosT_0_30_to_0_40);
  hist_vec_1500_CT.push_back(h_1500_CT_DR07_E_rel_totVis_RMS_d1_cosT_0_40_to_0_50);
  hist_vec_1500_CT.push_back(h_1500_CT_DR07_E_rel_totVis_RMS_d1_cosT_0_50_to_0_60);
  hist_vec_1500_CT.push_back(h_1500_CT_DR07_E_rel_totVis_RMS_d1_cosT_0_60_to_0_70);
  hist_vec_1500_CT.push_back(h_1500_CT_DR07_E_rel_totVis_RMS_d1_cosT_0_70_to_0_80);
  hist_vec_1500_CT.push_back(h_1500_CT_DR07_E_rel_totVis_RMS_d1_cosT_0_80_to_0_90);
  hist_vec_1500_CT.push_back(h_1500_CT_DR07_E_rel_totVis_RMS_d1_cosT_0_900_to_0_925);
  hist_vec_1500_CT.push_back(h_1500_CT_DR07_E_rel_totVis_RMS_d1_cosT_0_925_to_0_950);
  hist_vec_1500_CT.push_back(h_1500_CT_DR07_E_rel_totVis_RMS_d1_cosT_0_950_to_0_975);
  hist_vec_1500_CT.push_back(h_1500_CT_DR07_E_rel_totVis_RMS_d1_cosT_0_975_to_1_00); 

  hist_vec_1500_CT.push_back(h_1500_CT_DR08_E_rel_totVis_RMS_d1_cosT_0_to_0_10);
  hist_vec_1500_CT.push_back(h_1500_CT_DR08_E_rel_totVis_RMS_d1_cosT_0_10_to_0_20);
  hist_vec_1500_CT.push_back(h_1500_CT_DR08_E_rel_totVis_RMS_d1_cosT_0_20_to_0_30);
  hist_vec_1500_CT.push_back(h_1500_CT_DR08_E_rel_totVis_RMS_d1_cosT_0_30_to_0_40);
  hist_vec_1500_CT.push_back(h_1500_CT_DR08_E_rel_totVis_RMS_d1_cosT_0_40_to_0_50);
  hist_vec_1500_CT.push_back(h_1500_CT_DR08_E_rel_totVis_RMS_d1_cosT_0_50_to_0_60);
  hist_vec_1500_CT.push_back(h_1500_CT_DR08_E_rel_totVis_RMS_d1_cosT_0_60_to_0_70);
  hist_vec_1500_CT.push_back(h_1500_CT_DR08_E_rel_totVis_RMS_d1_cosT_0_70_to_0_80);
  hist_vec_1500_CT.push_back(h_1500_CT_DR08_E_rel_totVis_RMS_d1_cosT_0_80_to_0_90);
  hist_vec_1500_CT.push_back(h_1500_CT_DR08_E_rel_totVis_RMS_d1_cosT_0_900_to_0_925);
  hist_vec_1500_CT.push_back(h_1500_CT_DR08_E_rel_totVis_RMS_d1_cosT_0_925_to_0_950);
  hist_vec_1500_CT.push_back(h_1500_CT_DR08_E_rel_totVis_RMS_d1_cosT_0_950_to_0_975);
  hist_vec_1500_CT.push_back(h_1500_CT_DR08_E_rel_totVis_RMS_d1_cosT_0_975_to_1_00); //110

  hist_vec_1500_CT.push_back(h_1500_CT_DR09_E_rel_totVis_RMS_d1_cosT_0_to_0_10);
  hist_vec_1500_CT.push_back(h_1500_CT_DR09_E_rel_totVis_RMS_d1_cosT_0_10_to_0_20);
  hist_vec_1500_CT.push_back(h_1500_CT_DR09_E_rel_totVis_RMS_d1_cosT_0_20_to_0_30);
  hist_vec_1500_CT.push_back(h_1500_CT_DR09_E_rel_totVis_RMS_d1_cosT_0_30_to_0_40);
  hist_vec_1500_CT.push_back(h_1500_CT_DR09_E_rel_totVis_RMS_d1_cosT_0_40_to_0_50);
  hist_vec_1500_CT.push_back(h_1500_CT_DR09_E_rel_totVis_RMS_d1_cosT_0_50_to_0_60);
  hist_vec_1500_CT.push_back(h_1500_CT_DR09_E_rel_totVis_RMS_d1_cosT_0_60_to_0_70);
  hist_vec_1500_CT.push_back(h_1500_CT_DR09_E_rel_totVis_RMS_d1_cosT_0_70_to_0_80);
  hist_vec_1500_CT.push_back(h_1500_CT_DR09_E_rel_totVis_RMS_d1_cosT_0_80_to_0_90);
  hist_vec_1500_CT.push_back(h_1500_CT_DR09_E_rel_totVis_RMS_d1_cosT_0_900_to_0_925);
  hist_vec_1500_CT.push_back(h_1500_CT_DR09_E_rel_totVis_RMS_d1_cosT_0_925_to_0_950);
  hist_vec_1500_CT.push_back(h_1500_CT_DR09_E_rel_totVis_RMS_d1_cosT_0_950_to_0_975);
  hist_vec_1500_CT.push_back(h_1500_CT_DR09_E_rel_totVis_RMS_d1_cosT_0_975_to_1_00); //123

  hist_vec_1500_CT.push_back(h_1500_CT_DR10_E_rel_totVis_RMS_d1_cosT_0_to_0_10);
  hist_vec_1500_CT.push_back(h_1500_CT_DR10_E_rel_totVis_RMS_d1_cosT_0_10_to_0_20);
  hist_vec_1500_CT.push_back(h_1500_CT_DR10_E_rel_totVis_RMS_d1_cosT_0_20_to_0_30);
  hist_vec_1500_CT.push_back(h_1500_CT_DR10_E_rel_totVis_RMS_d1_cosT_0_30_to_0_40);
  hist_vec_1500_CT.push_back(h_1500_CT_DR10_E_rel_totVis_RMS_d1_cosT_0_40_to_0_50);
  hist_vec_1500_CT.push_back(h_1500_CT_DR10_E_rel_totVis_RMS_d1_cosT_0_50_to_0_60);
  hist_vec_1500_CT.push_back(h_1500_CT_DR10_E_rel_totVis_RMS_d1_cosT_0_60_to_0_70);
  hist_vec_1500_CT.push_back(h_1500_CT_DR10_E_rel_totVis_RMS_d1_cosT_0_70_to_0_80);
  hist_vec_1500_CT.push_back(h_1500_CT_DR10_E_rel_totVis_RMS_d1_cosT_0_80_to_0_90);
  hist_vec_1500_CT.push_back(h_1500_CT_DR10_E_rel_totVis_RMS_d1_cosT_0_900_to_0_925);
  hist_vec_1500_CT.push_back(h_1500_CT_DR10_E_rel_totVis_RMS_d1_cosT_0_925_to_0_950);
  hist_vec_1500_CT.push_back(h_1500_CT_DR10_E_rel_totVis_RMS_d1_cosT_0_950_to_0_975);
  hist_vec_1500_CT.push_back(h_1500_CT_DR10_E_rel_totVis_RMS_d1_cosT_0_975_to_1_00); //136

  hist_vec_1500_CT.push_back(h_1500_CT_DR05_dphi_reco_gen_cosTheta_0_65);//137
  hist_vec_1500_CT.push_back(h_1500_CT_DR05_dphi_reco_gen_cosTheta_0_65_to_0_80);
  hist_vec_1500_CT.push_back(h_1500_CT_DR05_dphi_reco_gen_cosTheta_0_80_to_0_925);
  hist_vec_1500_CT.push_back(h_1500_CT_DR05_dphi_reco_gen_cosTheta_0_925_to_0_975);
  hist_vec_1500_CT.push_back(h_1500_CT_DR05_dtheta_reco_gen_cosTheta_0_65);
  hist_vec_1500_CT.push_back(h_1500_CT_DR05_dtheta_reco_gen_cosTheta_0_65_to_0_80);
  hist_vec_1500_CT.push_back(h_1500_CT_DR05_dtheta_reco_gen_cosTheta_0_80_to_0_925);
  hist_vec_1500_CT.push_back(h_1500_CT_DR05_dtheta_reco_gen_cosTheta_0_925_to_0_975);

  hist_vec_1500_CT.push_back(h_1500_CT_DR07_dphi_reco_gen_cosTheta_0_65);//145
  hist_vec_1500_CT.push_back(h_1500_CT_DR07_dphi_reco_gen_cosTheta_0_65_to_0_80);
  hist_vec_1500_CT.push_back(h_1500_CT_DR07_dphi_reco_gen_cosTheta_0_80_to_0_925);
  hist_vec_1500_CT.push_back(h_1500_CT_DR07_dphi_reco_gen_cosTheta_0_925_to_0_975);
  hist_vec_1500_CT.push_back(h_1500_CT_DR07_dtheta_reco_gen_cosTheta_0_65);
  hist_vec_1500_CT.push_back(h_1500_CT_DR07_dtheta_reco_gen_cosTheta_0_65_to_0_80);
  hist_vec_1500_CT.push_back(h_1500_CT_DR07_dtheta_reco_gen_cosTheta_0_80_to_0_925);
  hist_vec_1500_CT.push_back(h_1500_CT_DR07_dtheta_reco_gen_cosTheta_0_925_to_0_975);

  hist_vec_1500_CT.push_back(h_1500_CT_DR10_dphi_reco_gen_cosTheta_0_65);//153
  hist_vec_1500_CT.push_back(h_1500_CT_DR10_dphi_reco_gen_cosTheta_0_65_to_0_80);
  hist_vec_1500_CT.push_back(h_1500_CT_DR10_dphi_reco_gen_cosTheta_0_80_to_0_925);
  hist_vec_1500_CT.push_back(h_1500_CT_DR10_dphi_reco_gen_cosTheta_0_925_to_0_975);
  hist_vec_1500_CT.push_back(h_1500_CT_DR10_dtheta_reco_gen_cosTheta_0_65);
  hist_vec_1500_CT.push_back(h_1500_CT_DR10_dtheta_reco_gen_cosTheta_0_65_to_0_80);
  hist_vec_1500_CT.push_back(h_1500_CT_DR10_dtheta_reco_gen_cosTheta_0_80_to_0_925);
  hist_vec_1500_CT.push_back(h_1500_CT_DR10_dtheta_reco_gen_cosTheta_0_925_to_0_975);

  for(unsigned int i=0;i<hist_vec_1500_CT.size();i++){
    hist_vec_1500_CT[i]->Sumw2();
  }
  fill_jet_histograms(file_CLIC_1500_CT,hist_vec_1500_CT);

  TH1F* h_1500_CT_DR05_dphi_SigmaCB_summary_histogram=new TH1F("dphiRes_SigmaCBVsCosTheta_CT_DR05_1500", "#sigma#Delta#phi(j_{reco},j_{true}) vs |cos#theta|", nRegionBinsAngles, pRegionBinEdgesAngles);
  h_1500_CT_DR05_dphi_SigmaCB_summary_histogram ->SetYTitle("#sigma#Delta#phi(j_{reco},j_{true})");
  h_1500_CT_DR05_dphi_SigmaCB_summary_histogram->SetXTitle("|cos#theta|");
  h_1500_CT_DR05_dphi_SigmaCB_summary_histogram->SetLineWidth(2);
  h_1500_CT_DR05_dphi_SigmaCB_summary_histogram->SetLineColor(kCyan+1);
  h_1500_CT_DR05_dphi_SigmaCB_summary_histogram->SetLineStyle(2);

  TH1F* h_1500_CT_DR05_dphi_RMS90_summary_histogram=new TH1F("dphiRes_RMS90VsCosTheta_CT_DR05_1500", "RMS_{90} #Delta#phi(j_{reco},j_{true}) vs |cos#theta|", nRegionBinsAngles, pRegionBinEdgesAngles);
  h_1500_CT_DR05_dphi_RMS90_summary_histogram ->SetYTitle("RMS_{90}#Delta#phi(j_{reco},j_{true})");
  h_1500_CT_DR05_dphi_RMS90_summary_histogram->SetXTitle("|cos#theta|");
  h_1500_CT_DR05_dphi_RMS90_summary_histogram->SetLineWidth(2);
  h_1500_CT_DR05_dphi_RMS90_summary_histogram->SetLineColor(kCyan+1);
  h_1500_CT_DR05_dphi_RMS90_summary_histogram->SetLineStyle(2);

  TH1F* h_1500_CT_DR07_dphi_SigmaCB_summary_histogram=new TH1F("dphiRes_SigmaCBVsCosTheta_CT_DR07_1500", "#sigma#Delta#phi(j_{reco},j_{true}) vs |cos#theta|", nRegionBinsAngles, pRegionBinEdgesAngles);
  h_1500_CT_DR07_dphi_SigmaCB_summary_histogram ->SetYTitle("#sigma#Delta#phi(j_{reco},j_{true})");
  h_1500_CT_DR07_dphi_SigmaCB_summary_histogram->SetXTitle("|cos#theta|");
  h_1500_CT_DR07_dphi_SigmaCB_summary_histogram->SetLineWidth(2);
  h_1500_CT_DR07_dphi_SigmaCB_summary_histogram->SetLineColor(kCyan+1);
  h_1500_CT_DR07_dphi_SigmaCB_summary_histogram->SetLineStyle(2);

  TH1F* h_1500_CT_DR07_dphi_RMS90_summary_histogram=new TH1F("dphiRes_RMS90VsCosTheta_CT_DR07_1500", "RMS_{90} #Delta#phi(j_{reco},j_{true}) vs |cos#theta|", nRegionBinsAngles, pRegionBinEdgesAngles);
  h_1500_CT_DR07_dphi_RMS90_summary_histogram ->SetYTitle("RMS_{90}#Delta#phi(j_{reco},j_{true})");
  h_1500_CT_DR07_dphi_RMS90_summary_histogram->SetXTitle("|cos#theta|");
  h_1500_CT_DR07_dphi_RMS90_summary_histogram->SetLineWidth(2);
  h_1500_CT_DR07_dphi_RMS90_summary_histogram->SetLineColor(kCyan+1);
  h_1500_CT_DR07_dphi_RMS90_summary_histogram->SetLineStyle(2);

  TH1F* h_1500_CT_DR10_dphi_SigmaCB_summary_histogram=new TH1F("dphiRes_SigmaCBVsCosTheta_CT_DR10_1500", "#sigma#Delta#phi(j_{reco},j_{true}) vs |cos#theta|", nRegionBinsAngles, pRegionBinEdgesAngles);
  h_1500_CT_DR10_dphi_SigmaCB_summary_histogram ->SetYTitle("#sigma#Delta#phi(j_{reco},j_{true})");
  h_1500_CT_DR10_dphi_SigmaCB_summary_histogram->SetXTitle("|cos#theta|");
  h_1500_CT_DR10_dphi_SigmaCB_summary_histogram->SetLineWidth(2);
  h_1500_CT_DR10_dphi_SigmaCB_summary_histogram->SetLineColor(kCyan+1);
  h_1500_CT_DR10_dphi_SigmaCB_summary_histogram->SetLineStyle(2);

  TH1F* h_1500_CT_DR10_dphi_RMS90_summary_histogram=new TH1F("dphiRes_RMS90VsCosTheta_CT_DR10_1500", "RMS_{90} #Delta#phi(j_{reco},j_{true}) vs |cos#theta|", nRegionBinsAngles, pRegionBinEdgesAngles);
  h_1500_CT_DR10_dphi_RMS90_summary_histogram ->SetYTitle("RMS_{90}#Delta#phi(j_{reco},j_{true})");
  h_1500_CT_DR10_dphi_RMS90_summary_histogram->SetXTitle("|cos#theta|");
  h_1500_CT_DR10_dphi_RMS90_summary_histogram->SetLineWidth(2);
  h_1500_CT_DR10_dphi_RMS90_summary_histogram->SetLineColor(kCyan+1);
  h_1500_CT_DR10_dphi_RMS90_summary_histogram->SetLineStyle(2);

  TH1F* h_1500_CT_DR05_dtheta_SigmaCB_summary_histogram=new TH1F("dthetaRes_SigmaCBVsCosTheta_CT_DR05_1500", "#sigma#Delta#theta(j_{reco},j_{true}) vs |cos#theta|", nRegionBinsAngles, pRegionBinEdgesAngles);
  h_1500_CT_DR05_dtheta_SigmaCB_summary_histogram ->SetYTitle("#sigma#Delta#theta(j_{reco},j_{true})");
  h_1500_CT_DR05_dtheta_SigmaCB_summary_histogram->SetXTitle("|cos#theta|");
  h_1500_CT_DR05_dtheta_SigmaCB_summary_histogram->SetLineWidth(2);
  h_1500_CT_DR05_dtheta_SigmaCB_summary_histogram->SetLineColor(kCyan+1);
  h_1500_CT_DR05_dtheta_SigmaCB_summary_histogram->SetLineStyle(2);

  TH1F* h_1500_CT_DR05_dtheta_RMS90_summary_histogram=new TH1F("dthetaRes_RMS90VsCosTheta_CT_DR05_1500", "RMS_{90} #Delta#theta(j_{reco},j_{true}) vs |cos#theta|", nRegionBinsAngles, pRegionBinEdgesAngles);
  h_1500_CT_DR05_dtheta_RMS90_summary_histogram ->SetYTitle("RMS_{90}#Delta#theta(j_{reco},j_{true})");
  h_1500_CT_DR05_dtheta_RMS90_summary_histogram->SetXTitle("|cos#theta|");
  h_1500_CT_DR05_dtheta_RMS90_summary_histogram->SetLineWidth(2);
  h_1500_CT_DR05_dtheta_RMS90_summary_histogram->SetLineColor(kCyan+1);
  h_1500_CT_DR05_dtheta_RMS90_summary_histogram->SetLineStyle(2);

  TH1F* h_1500_CT_DR07_dtheta_SigmaCB_summary_histogram=new TH1F("dthetaRes_SigmaCBVsCosTheta_CT_DR07_1500", "#sigma#Delta#theta(j_{reco},j_{true}) vs |cos#theta|", nRegionBinsAngles, pRegionBinEdgesAngles);
  h_1500_CT_DR07_dtheta_SigmaCB_summary_histogram ->SetYTitle("#sigma#Delta#theta(j_{reco},j_{true})");
  h_1500_CT_DR07_dtheta_SigmaCB_summary_histogram->SetXTitle("|cos#theta|");
  h_1500_CT_DR07_dtheta_SigmaCB_summary_histogram->SetLineWidth(2);
  h_1500_CT_DR07_dtheta_SigmaCB_summary_histogram->SetLineColor(kCyan+1);
  h_1500_CT_DR07_dtheta_SigmaCB_summary_histogram->SetLineStyle(2);

  TH1F* h_1500_CT_DR07_dtheta_RMS90_summary_histogram=new TH1F("dthetaRes_RMS90VsCosTheta_CT_DR07_1500", "RMS_{90} #Delta#theta(j_{reco},j_{true}) vs |cos#theta|", nRegionBinsAngles, pRegionBinEdgesAngles);
  h_1500_CT_DR07_dtheta_RMS90_summary_histogram ->SetYTitle("RMS_{90}#Delta#theta(j_{reco},j_{true})");
  h_1500_CT_DR07_dtheta_RMS90_summary_histogram->SetXTitle("|cos#theta|");
  h_1500_CT_DR07_dtheta_RMS90_summary_histogram->SetLineWidth(2);
  h_1500_CT_DR07_dtheta_RMS90_summary_histogram->SetLineColor(kCyan+1);
  h_1500_CT_DR07_dtheta_RMS90_summary_histogram->SetLineStyle(2);

  TH1F* h_1500_CT_DR10_dtheta_SigmaCB_summary_histogram=new TH1F("dthetaRes_SigmaCBVsCosTheta_CT_DR10_1500", "#sigma#Delta#theta(j_{reco},j_{true}) vs |cos#theta|", nRegionBinsAngles, pRegionBinEdgesAngles);
  h_1500_CT_DR10_dtheta_SigmaCB_summary_histogram ->SetYTitle("#sigma#Delta#theta(j_{reco},j_{true})");
  h_1500_CT_DR10_dtheta_SigmaCB_summary_histogram->SetXTitle("|cos#theta|");
  h_1500_CT_DR10_dtheta_SigmaCB_summary_histogram->SetLineWidth(2);
  h_1500_CT_DR10_dtheta_SigmaCB_summary_histogram->SetLineColor(kCyan+1);
  h_1500_CT_DR10_dtheta_SigmaCB_summary_histogram->SetLineStyle(2);

  TH1F* h_1500_CT_DR10_dtheta_RMS90_summary_histogram=new TH1F("dthetaRes_RMS90VsCosTheta_CT_DR10_1500", "RMS_{90} #Delta#theta(j_{reco},j_{true}) vs |cos#theta|", nRegionBinsAngles, pRegionBinEdgesAngles);
  h_1500_CT_DR10_dtheta_RMS90_summary_histogram ->SetYTitle("RMS_{90}#Delta#theta(j_{reco},j_{true})");
  h_1500_CT_DR10_dtheta_RMS90_summary_histogram->SetXTitle("|cos#theta|");
  h_1500_CT_DR10_dtheta_RMS90_summary_histogram->SetLineWidth(2);
  h_1500_CT_DR10_dtheta_RMS90_summary_histogram->SetLineColor(kCyan+1);
  h_1500_CT_DR10_dtheta_RMS90_summary_histogram->SetLineStyle(2);

  for(int i=137;i<161;i++){
//continue;
    std::cout<<"ang histo 1500 "<<i<<"]"<<std::endl;
   //double sided crystal ball
    TF1* fit_gaus_tmp = new TF1("fit_gaus_tmp", "gaus",-5.,5.);
    hist_vec_1500_CT[i]->Fit("fit_gaus_tmp","R");
    hist_vec_1500_CT[i]->GetFunction("fit_gaus_tmp");
    TF1* fdscb_tmp = new TF1("fdscb_tmp",fnc_dscb,-lim_angleDeg,lim_angleDeg,7);
   fdscb_tmp->SetNpx(2000);
    fdscb_tmp->SetParameter(0,fit_gaus_tmp->GetParameter(0));
    //norm
    fdscb_tmp->SetParLimits (0,0.5*fit_gaus_tmp->GetParameter(0),1.5*fit_gaus_tmp->GetParameter(0));
    fdscb_tmp->SetParameter(1,fit_gaus_tmp->GetParameter(1));
    //gaussian mean
    fdscb_tmp->SetParLimits (1,-2.,2.);
    fdscb_tmp->SetParameter(2,fit_gaus_tmp->GetParameter(2));
    fdscb_tmp->SetParLimits(2,fit_gaus_tmp->GetParameter(2)*0.50,1.50*fit_gaus_tmp->GetParameter(2));
    //std::vector<float>sigma2SFit=sigmaGaussianFits2Sigma(hist_vec_1500_CT[i]);
    //fdscb_tmp->SetParameter(2,sigma2SFit[0]);
    //fdscb_tmp->SetParLimits(2,sigma2SFit[0]*0.50,1.50*sigma2SFit[0]);
    //-a1: parameter, from when the gaussian core should count
    //fdscb_tmp->SetParameter(2,fit_gaus_tmp->GetParameter(2));
    fdscb_tmp->SetParameter (3,3.0);
    fdscb_tmp->SetParLimits (3,0.0,10.0);
    //a2 parameter, up to when the gaussian core should count
    fdscb_tmp->SetParameter (5,3.0);
    fdscb_tmp->SetParLimits (5,0.0,10.0);
    fdscb_tmp->SetParameter(4,5.);
    fdscb_tmp->SetParLimits(4,0.,25.);
    fdscb_tmp->SetParameter(6,5.);
    fdscb_tmp->SetParLimits(6,0.,25.);
    int fitstatus(0); 
    fitstatus = hist_vec_1500_CT[i]->Fit(fdscb_tmp,"R");
    fdscb_tmp = hist_vec_1500_CT[i]->GetFunction("fdscb_tmp");
    resolutionTH1=0; 
    resolutionErrorTH1=0;
    meanTH1=0;
    meanErrorTH1=0;
    CalculatePerformanceNoMean( hist_vec_1500_CT[i], resolutionTH1, resolutionErrorTH1,meanTH1,meanErrorTH1);
    int first_bin_ang=137;
    if(i<141){//dphi DR05
      first_bin_ang=137;
      h_1500_CT_DR05_dphi_SigmaCB_summary_histogram->SetBinContent(i-first_bin_ang+1,fdscb_tmp->GetParameter(2));
      h_1500_CT_DR05_dphi_SigmaCB_summary_histogram->SetBinError(i-first_bin_ang+1,fdscb_tmp->GetParError(2));
      h_1500_CT_DR05_dphi_RMS90_summary_histogram->SetBinContent(i-first_bin_ang+1,resolutionTH1);
      h_1500_CT_DR05_dphi_RMS90_summary_histogram->SetBinError(i-first_bin_ang+1, resolutionErrorTH1);
    }else if(i<145){//dtheta DR05
      first_bin_ang=141;
      h_1500_CT_DR05_dtheta_SigmaCB_summary_histogram->SetBinContent(i-first_bin_ang+1,fdscb_tmp->GetParameter(2));
      h_1500_CT_DR05_dtheta_SigmaCB_summary_histogram->SetBinError(i-first_bin_ang+1,fdscb_tmp->GetParError(2));
      h_1500_CT_DR05_dtheta_RMS90_summary_histogram->SetBinContent(i-first_bin_ang+1,resolutionTH1);
      h_1500_CT_DR05_dtheta_RMS90_summary_histogram->SetBinError(i-first_bin_ang+1, resolutionErrorTH1);
    }else if(i<149){//dphi DR07
      first_bin_ang=145;
      h_1500_CT_DR07_dphi_SigmaCB_summary_histogram->SetBinContent(i-first_bin_ang+1,fdscb_tmp->GetParameter(2));
      h_1500_CT_DR07_dphi_SigmaCB_summary_histogram->SetBinError(i-first_bin_ang+1,fdscb_tmp->GetParError(2));
      h_1500_CT_DR07_dphi_RMS90_summary_histogram->SetBinContent(i-first_bin_ang+1,resolutionTH1);
      h_1500_CT_DR07_dphi_RMS90_summary_histogram->SetBinError(i-first_bin_ang+1, resolutionErrorTH1);
    }else if(i<153){//dtheta DR07
      first_bin_ang=149;
      h_1500_CT_DR07_dtheta_SigmaCB_summary_histogram->SetBinContent(i-first_bin_ang+1,fdscb_tmp->GetParameter(2));
      h_1500_CT_DR07_dtheta_SigmaCB_summary_histogram->SetBinError(i-first_bin_ang+1,fdscb_tmp->GetParError(2));
      h_1500_CT_DR07_dtheta_RMS90_summary_histogram->SetBinContent(i-first_bin_ang+1,resolutionTH1);
      h_1500_CT_DR07_dtheta_RMS90_summary_histogram->SetBinError(i-first_bin_ang+1, resolutionErrorTH1);
    }else if(i<157){//dphi DR07
      first_bin_ang=153;
      h_1500_CT_DR10_dphi_SigmaCB_summary_histogram->SetBinContent(i-first_bin_ang+1,fdscb_tmp->GetParameter(2));
      h_1500_CT_DR10_dphi_SigmaCB_summary_histogram->SetBinError(i-first_bin_ang+1,fdscb_tmp->GetParError(2));
      h_1500_CT_DR10_dphi_RMS90_summary_histogram->SetBinContent(i-first_bin_ang+1,resolutionTH1);
      h_1500_CT_DR10_dphi_RMS90_summary_histogram->SetBinError(i-first_bin_ang+1, resolutionErrorTH1);
    }else if(i<161){//dtheta DR07
      first_bin_ang=157;
      h_1500_CT_DR10_dtheta_SigmaCB_summary_histogram->SetBinContent(i-first_bin_ang+1,fdscb_tmp->GetParameter(2));
      h_1500_CT_DR10_dtheta_SigmaCB_summary_histogram->SetBinError(i-first_bin_ang+1,fdscb_tmp->GetParError(2));
      h_1500_CT_DR10_dtheta_RMS90_summary_histogram->SetBinContent(i-first_bin_ang+1,resolutionTH1);
      h_1500_CT_DR10_dtheta_RMS90_summary_histogram->SetBinError(i-first_bin_ang+1, resolutionErrorTH1);
    }
  }

  TH1F* h_1500_CT_DR05_E_SigmaCB_summary_histogram=new TH1F("JER_SigmaCBVsCosTheta_CT_DR05_1500", "#sigma (E_{j}^{reco} / E_{j}^{true}) vs |cos#theta|", nRegionBins, pRegionBinEdges);
  h_1500_CT_DR05_E_SigmaCB_summary_histogram ->SetYTitle("#sigma(E_{j}) / E_{j} [%]");
  h_1500_CT_DR05_E_SigmaCB_summary_histogram->SetXTitle("|cos#theta|");
  h_1500_CT_DR05_E_SigmaCB_summary_histogram->SetLineWidth(2);
  h_1500_CT_DR05_E_SigmaCB_summary_histogram->SetLineColor(kBlue);
  h_1500_CT_DR05_E_SigmaCB_summary_histogram->SetLineStyle(2);

  TH1F* h_1500_CT_DR05_E_RMS90_summary_histogram=new TH1F("JER_RMS90VsCosTheta_CT_DR05_1500", "RMS_{90}(E_{j}^{reco}/E_{j}^{gen}) / Mean_{90}(E_{j}^{reco}/E_{j}^{gen}) vs |cos#theta|", nRegionBins, pRegionBinEdges);
  h_1500_CT_DR05_E_RMS90_summary_histogram ->SetYTitle("RMS_{90}(E_{j}^{reco}/E_{j}^{gen}) / Mean_{90}(E_{j}^{reco}/E_{j}^{gen}) [%]");
  h_1500_CT_DR05_E_RMS90_summary_histogram->SetXTitle("|cos#theta|");
  h_1500_CT_DR05_E_RMS90_summary_histogram->SetLineWidth(2);
  h_1500_CT_DR05_E_RMS90_summary_histogram->SetLineColor(kBlue);
  h_1500_CT_DR05_E_RMS90_summary_histogram->SetLineStyle(2);

  TH1F* h_1500_CT_DR05_E_RMS_summary_histogram=new TH1F("JER_RMSVsCosTheta_CT_DR05_1500", "RMS(E_{j}) / Mean(E_{j}) vs |cos#theta|", nRegionBins, pRegionBinEdges);
  h_1500_CT_DR05_E_RMS_summary_histogram ->SetYTitle("RMS(E_{j}) / Mean(E_{j}) [%]");
  h_1500_CT_DR05_E_RMS_summary_histogram->SetXTitle("|cos#theta|");
  h_1500_CT_DR05_E_RMS_summary_histogram->SetLineWidth(2);
  h_1500_CT_DR05_E_RMS_summary_histogram->SetLineColor(kBlue);
  h_1500_CT_DR05_E_RMS_summary_histogram->SetLineStyle(2);

  TH1F* h_1500_CT_DR05_E_JER_Mean_summary_histogram=new TH1F("JER_MeanVsCosTheta_CT_DR05_1500", "Mean(E_{tot}^{RECO}/E_{tot}^{true}) vs |cos#theta|", nRegionBins, pRegionBinEdges);
  h_1500_CT_DR05_E_JER_Mean_summary_histogram->SetYTitle("Mean(E_{tot}^{RECO}/E_{tot}^{true})");
  h_1500_CT_DR05_E_JER_Mean_summary_histogram->SetXTitle("|cos#theta|");
  h_1500_CT_DR05_E_JER_Mean_summary_histogram->SetLineWidth(2);
  h_1500_CT_DR05_E_JER_Mean_summary_histogram->SetLineColor(kBlue);
  h_1500_CT_DR05_E_JER_Mean_summary_histogram->SetLineStyle(2);


  firstbin=59;
  for(int i=firstbin;i<(firstbin+13);i++){
//continue;
    resolutionTH1=0; 
    resolutionErrorTH1=0;
    meanTH1=0;
    meanErrorTH1=0;
    CalculatePerformance( hist_vec_1500_CT[i], resolutionTH1, resolutionErrorTH1,meanTH1,meanErrorTH1);
    h_1500_CT_DR05_E_RMS90_summary_histogram->SetBinContent(i-firstbin+1,resolutionTH1/sqrt(2.));
    h_1500_CT_DR05_E_RMS90_summary_histogram ->SetBinError(i-firstbin+1, resolutionErrorTH1/sqrt(2.));
    h_1500_CT_DR05_E_RMS_summary_histogram->SetBinContent(i-firstbin+1,hist_vec_1500_CT[i]->GetRMS()*100. );
    h_1500_CT_DR05_E_RMS_summary_histogram ->SetBinError(i-firstbin+1, hist_vec_1500_CT[i]->GetRMSError()*100.);
    h_1500_CT_DR05_E_JER_Mean_summary_histogram->SetBinContent(i-firstbin+1,hist_vec_1500_CT[i]->GetMean());
    h_1500_CT_DR05_E_JER_Mean_summary_histogram->SetBinError(i-firstbin+1,hist_vec_1500_CT[i]->GetMeanError());
    //double sided crystal ball
    TF1* fit_gaus_tmp = new TF1("fit_gaus_tmp", "gaus",0.50,1.50);
    hist_vec_1500_CT[i]->Fit("fit_gaus_tmp","R");
    hist_vec_1500_CT[i]->GetFunction("fit_gaus_tmp");
    TF1* fdscb_tmp = new TF1("fdscb_tmp",fnc_dscb,0.,3.,7);
    fdscb_tmp->SetNpx(1000);
    fdscb_tmp->SetParameter(0,fit_gaus_tmp->GetParameter(0));
    //norm
    fdscb_tmp->SetParLimits (0,0.5*fit_gaus_tmp->GetParameter(0),1.5*fit_gaus_tmp->GetParameter(0));
    fdscb_tmp->SetParameter(1,fit_gaus_tmp->GetParameter(1));
    //gaussian mean
    fdscb_tmp->SetParLimits (1,0.8,1.2);
    //fdscb_tmp->SetParameter(2,fit_gaus_tmp->GetParameter(2));
    //fdscb_tmp->SetParLimits(2,fit_gaus_tmp->GetParameter(2)*0.50,1.50*fit_gaus_tmp->GetParameter(2));
    std::vector<float>sigma2SFit=sigmaGaussianFits2Sigma(hist_vec_1500_CT[i]);
    fdscb_tmp->SetParameter(2,sigma2SFit[0]);
    fdscb_tmp->SetParLimits(2,sigma2SFit[0]*0.50,1.50*sigma2SFit[0]);
    //-a1: parameter, from when the gaussian core should count
    fdscb_tmp->SetParameter(2,fit_gaus_tmp->GetParameter(2));
    fdscb_tmp->SetParameter (3,3.0);
    fdscb_tmp->SetParLimits (3,0.0,10.0);
    //a2 parameter, up to when the gaussian core should count
    fdscb_tmp->SetParameter (5,3.0);
    fdscb_tmp->SetParLimits (5,0.0,10.0);
    fdscb_tmp->SetParameter(4,5.);
    fdscb_tmp->SetParLimits(4,0.,25.);
    fdscb_tmp->SetParameter(6,5.);
    fdscb_tmp->SetParLimits(6,0.,25.);
    int fitstatus(0); 
    fitstatus = hist_vec_1500_CT[i]->Fit(fdscb_tmp,"R");
    fdscb_tmp = hist_vec_1500_CT[i]->GetFunction("fdscb_tmp");
    h_1500_CT_DR05_E_SigmaCB_summary_histogram->SetBinContent(i-firstbin+1,fdscb_tmp->GetParameter(2)*100. );
    h_1500_CT_DR05_E_SigmaCB_summary_histogram->SetBinError(i-firstbin+1,fdscb_tmp->GetParError(2)*100. );
  }  
  TH1F* h_1500_CT_DR06_E_SigmaCB_summary_histogram=new TH1F("JER_SigmaCBVsCosTheta_CT_DR06_1500", "#sigma (E_{j}^{reco} / E_{j}^{true}) vs |cos#theta|", nRegionBins, pRegionBinEdges);
  h_1500_CT_DR06_E_SigmaCB_summary_histogram ->SetYTitle("#sigma(E_{j}) / E_{j} [%]");
  h_1500_CT_DR06_E_SigmaCB_summary_histogram->SetXTitle("|cos#theta|");
  h_1500_CT_DR06_E_SigmaCB_summary_histogram->SetLineWidth(2);
  h_1500_CT_DR06_E_SigmaCB_summary_histogram->SetLineColor(kBlue);
  h_1500_CT_DR06_E_SigmaCB_summary_histogram->SetLineStyle(2);
  TH1F* h_1500_CT_DR06_E_RMS90_summary_histogram=new TH1F("JER_RMS90VsCosTheta_CT_DR06_1500", "RMS_{90}(E_{j}^{reco}/E_{j}^{gen}) / Mean_{90}(E_{j}^{reco}/E_{j}^{gen}) vs |cos#theta|", nRegionBins, pRegionBinEdges);
  h_1500_CT_DR06_E_RMS90_summary_histogram ->SetYTitle("RMS_{90}(E_{j}^{reco}/E_{j}^{gen}) / Mean_{90}(E_{j}^{reco}/E_{j}^{gen}) [%]");
  h_1500_CT_DR06_E_RMS90_summary_histogram->SetXTitle("|cos#theta|");
  h_1500_CT_DR06_E_RMS90_summary_histogram->SetLineWidth(2);
  h_1500_CT_DR06_E_RMS90_summary_histogram->SetLineColor(kBlue);
  h_1500_CT_DR06_E_RMS90_summary_histogram->SetLineStyle(2);

  TH1F* h_1500_CT_DR06_E_RMS_summary_histogram=new TH1F("JER_RMSVsCosTheta_CT_DR06_1500", "RMS(E_{j}) / Mean(E_{j}) vs |cos#theta|", nRegionBins, pRegionBinEdges);
  h_1500_CT_DR06_E_RMS_summary_histogram ->SetYTitle("RMS(E_{j}) / Mean(E_{j}) [%]");
  h_1500_CT_DR06_E_RMS_summary_histogram->SetXTitle("|cos#theta|");
  h_1500_CT_DR06_E_RMS_summary_histogram->SetLineWidth(2);
  h_1500_CT_DR06_E_RMS_summary_histogram->SetLineColor(kBlue);
  h_1500_CT_DR06_E_RMS_summary_histogram->SetLineStyle(2);

  TH1F* h_1500_CT_DR06_E_JER_Mean_summary_histogram=new TH1F("JER_MeanVsCosTheta_CT_DR06_1500", "Mean(E_{tot}^{RECO}/E_{tot}^{true}) vs |cos#theta|", nRegionBins, pRegionBinEdges);
  h_1500_CT_DR06_E_JER_Mean_summary_histogram->SetYTitle("Mean(E_{tot}^{RECO}/E_{tot}^{true})");
  h_1500_CT_DR06_E_JER_Mean_summary_histogram->SetXTitle("|cos#theta|");
  h_1500_CT_DR06_E_JER_Mean_summary_histogram->SetLineWidth(2);
  h_1500_CT_DR06_E_JER_Mean_summary_histogram->SetLineColor(kBlue);
  h_1500_CT_DR06_E_JER_Mean_summary_histogram->SetLineStyle(2);
  firstbin=72;
  for(int i=firstbin;i<(firstbin+13);i++){
//continue;
    resolutionTH1=0; 
    resolutionErrorTH1=0;
    meanTH1=0;
    meanErrorTH1=0;
    CalculatePerformance( hist_vec_1500_CT[i], resolutionTH1, resolutionErrorTH1,meanTH1,meanErrorTH1);
    h_1500_CT_DR06_E_RMS90_summary_histogram->SetBinContent(i-firstbin+1,resolutionTH1/sqrt(2.));
    h_1500_CT_DR06_E_RMS90_summary_histogram ->SetBinError(i-firstbin+1, resolutionErrorTH1/sqrt(2.));
    h_1500_CT_DR06_E_RMS_summary_histogram->SetBinContent(i-firstbin+1,hist_vec_1500_CT[i]->GetRMS()*100. );
    h_1500_CT_DR06_E_RMS_summary_histogram ->SetBinError(i-firstbin+1, hist_vec_1500_CT[i]->GetRMSError()*100.);
    h_1500_CT_DR06_E_JER_Mean_summary_histogram->SetBinContent(i-firstbin+1,hist_vec_1500_CT[i]->GetMean());
    h_1500_CT_DR06_E_JER_Mean_summary_histogram->SetBinError(i-firstbin+1,hist_vec_1500_CT[i]->GetMeanError());
    //double sided crystal ball
    TF1* fit_gaus_tmp = new TF1("fit_gaus_tmp", "gaus",0.50,1.50);
    hist_vec_1500_CT[i]->Fit("fit_gaus_tmp","R");
    hist_vec_1500_CT[i]->GetFunction("fit_gaus_tmp");
    TF1* fdscb_tmp = new TF1("fdscb_tmp",fnc_dscb,0.,3.,7);
    fdscb_tmp->SetNpx(1000);
    fdscb_tmp->SetParameter(0,fit_gaus_tmp->GetParameter(0));
    //norm
    fdscb_tmp->SetParLimits (0,0.5*fit_gaus_tmp->GetParameter(0),1.5*fit_gaus_tmp->GetParameter(0));
    fdscb_tmp->SetParameter(1,fit_gaus_tmp->GetParameter(1));
    //gaussian mean
    fdscb_tmp->SetParLimits (1,0.8,1.2);
    //fdscb_tmp->SetParameter(2,fit_gaus_tmp->GetParameter(2));
    //fdscb_tmp->SetParLimits(2,fit_gaus_tmp->GetParameter(2)*0.50,1.50*fit_gaus_tmp->GetParameter(2));
    std::vector<float>sigma2SFit=sigmaGaussianFits2Sigma(hist_vec_1500_CT[i]);
    fdscb_tmp->SetParameter(2,sigma2SFit[0]);
    fdscb_tmp->SetParLimits(2,sigma2SFit[0]*0.50,1.50*sigma2SFit[0]);
    //-a1: parameter, from when the gaussian core should count
    fdscb_tmp->SetParameter(2,fit_gaus_tmp->GetParameter(2));
    fdscb_tmp->SetParameter (3,3.0);
    fdscb_tmp->SetParLimits (3,0.0,10.0);
    //a2 parameter, up to when the gaussian core should count
    fdscb_tmp->SetParameter (5,3.0);
    fdscb_tmp->SetParLimits (5,0.0,10.0);
    fdscb_tmp->SetParameter(4,5.);
    fdscb_tmp->SetParLimits(4,0.,25.);
    fdscb_tmp->SetParameter(6,5.);
    fdscb_tmp->SetParLimits(6,0.,25.);
    int fitstatus(0); 
    fitstatus = hist_vec_1500_CT[i]->Fit(fdscb_tmp,"R");
    fdscb_tmp = hist_vec_1500_CT[i]->GetFunction("fdscb_tmp");
    h_1500_CT_DR06_E_SigmaCB_summary_histogram->SetBinContent(i-firstbin+1,fdscb_tmp->GetParameter(2)*100. );
    h_1500_CT_DR06_E_SigmaCB_summary_histogram->SetBinError(i-firstbin+1,fdscb_tmp->GetParError(2)*100. );
  }  
  TH1F* h_1500_CT_DR07_E_SigmaCB_summary_histogram=new TH1F("JER_SigmaCBVsCosTheta_CT_DR07_1500", "#sigma (E_{j}^{reco} / E_{j}^{true}) vs |cos#theta|", nRegionBins, pRegionBinEdges);
  h_1500_CT_DR07_E_SigmaCB_summary_histogram ->SetYTitle("#sigma(E_{j}) / E_{j} [%]");
  h_1500_CT_DR07_E_SigmaCB_summary_histogram->SetXTitle("|cos#theta|");
  h_1500_CT_DR07_E_SigmaCB_summary_histogram->SetLineWidth(2);
  h_1500_CT_DR07_E_SigmaCB_summary_histogram->SetLineColor(kBlue);
  h_1500_CT_DR07_E_SigmaCB_summary_histogram->SetLineStyle(2);
  TH1F* h_1500_CT_DR07_E_RMS90_summary_histogram=new TH1F("JER_RMS90VsCosTheta_CT_DR07_1500", "RMS_{90}(E_{j}^{reco}/E_{j}^{gen}) / Mean_{90}(E_{j}^{reco}/E_{j}^{gen}) vs |cos#theta|", nRegionBins, pRegionBinEdges);
  h_1500_CT_DR07_E_RMS90_summary_histogram ->SetYTitle("RMS_{90}(E_{j}^{reco}/E_{j}^{gen}) / Mean_{90}(E_{j}^{reco}/E_{j}^{gen}) [%]");
  h_1500_CT_DR07_E_RMS90_summary_histogram->SetXTitle("|cos#theta|");
  h_1500_CT_DR07_E_RMS90_summary_histogram->SetLineWidth(2);
  h_1500_CT_DR07_E_RMS90_summary_histogram->SetLineColor(kBlue);
  h_1500_CT_DR07_E_RMS90_summary_histogram->SetLineStyle(2);

  TH1F* h_1500_CT_DR07_E_RMS_summary_histogram=new TH1F("JER_RMSVsCosTheta_CT_DR07_1500", "RMS(E_{j}) / Mean(E_{j}) vs |cos#theta|", nRegionBins, pRegionBinEdges);
  h_1500_CT_DR07_E_RMS_summary_histogram ->SetYTitle("RMS(E_{j}) / Mean(E_{j}) [%]");
  h_1500_CT_DR07_E_RMS_summary_histogram->SetXTitle("|cos#theta|");
  h_1500_CT_DR07_E_RMS_summary_histogram->SetLineWidth(2);
  h_1500_CT_DR07_E_RMS_summary_histogram->SetLineColor(kBlue);
  h_1500_CT_DR07_E_RMS_summary_histogram->SetLineStyle(2);

  TH1F* h_1500_CT_DR07_E_JER_Mean_summary_histogram=new TH1F("JER_MeanVsCosTheta_CT_DR07_1500", "Mean(E_{tot}^{RECO}/E_{tot}^{true}) vs |cos#theta|", nRegionBins, pRegionBinEdges);
  h_1500_CT_DR07_E_JER_Mean_summary_histogram->SetYTitle("Mean(E_{tot}^{RECO}/E_{tot}^{true})");
  h_1500_CT_DR07_E_JER_Mean_summary_histogram->SetXTitle("|cos#theta|");
  h_1500_CT_DR07_E_JER_Mean_summary_histogram->SetLineWidth(2);
  h_1500_CT_DR07_E_JER_Mean_summary_histogram->SetLineColor(kBlue);
  h_1500_CT_DR07_E_JER_Mean_summary_histogram->SetLineStyle(2);
  firstbin=85;
  for(int i=firstbin;i<(firstbin+13);i++){
//continue;
    resolutionTH1=0; 
    resolutionErrorTH1=0;
    meanTH1=0;
    meanErrorTH1=0;
    CalculatePerformance( hist_vec_1500_CT[i], resolutionTH1, resolutionErrorTH1,meanTH1,meanErrorTH1);
    h_1500_CT_DR07_E_RMS90_summary_histogram->SetBinContent(i-firstbin+1,resolutionTH1/sqrt(2.));
    h_1500_CT_DR07_E_RMS90_summary_histogram ->SetBinError(i-firstbin+1, resolutionErrorTH1/sqrt(2.));
    h_1500_CT_DR07_E_RMS_summary_histogram->SetBinContent(i-firstbin+1,hist_vec_1500_CT[i]->GetRMS()*100. );
    h_1500_CT_DR07_E_RMS_summary_histogram ->SetBinError(i-firstbin+1, hist_vec_1500_CT[i]->GetRMSError()*100.);
    h_1500_CT_DR07_E_JER_Mean_summary_histogram->SetBinContent(i-firstbin+1,hist_vec_1500_CT[i]->GetMean());
    h_1500_CT_DR07_E_JER_Mean_summary_histogram->SetBinError(i-firstbin+1,hist_vec_1500_CT[i]->GetMeanError());
    //double sided crystal ball
    TF1* fit_gaus_tmp = new TF1("fit_gaus_tmp", "gaus",0.50,1.50);
    hist_vec_1500_CT[i]->Fit("fit_gaus_tmp","R");
    hist_vec_1500_CT[i]->GetFunction("fit_gaus_tmp");
    TF1* fdscb_tmp = new TF1("fdscb_tmp",fnc_dscb,0.,3.,7);
    fdscb_tmp->SetNpx(1000);
    fdscb_tmp->SetParameter(0,fit_gaus_tmp->GetParameter(0));
    //norm
    fdscb_tmp->SetParLimits (0,0.5*fit_gaus_tmp->GetParameter(0),4.0*fit_gaus_tmp->GetParameter(0));
    fdscb_tmp->SetParameter(1,fit_gaus_tmp->GetParameter(1));
    //gaussian mean
    fdscb_tmp->SetParLimits (1,0.8,1.2);
    //fdscb_tmp->SetParameter(2,fit_gaus_tmp->GetParameter(2));
    //fdscb_tmp->SetParLimits(2,fit_gaus_tmp->GetParameter(2)*0.50,1.50*fit_gaus_tmp->GetParameter(2));
    std::vector<float>sigma2SFit=sigmaGaussianFits2Sigma(hist_vec_1500_CT[i]);
    fdscb_tmp->SetParameter(2,sigma2SFit[0]);
    fdscb_tmp->SetParLimits(2,sigma2SFit[0]*0.50,1.50*sigma2SFit[0]);
    //-a1: parameter, from when the gaussian core should count
    //fdscb_tmp->SetParameter(2,fit_gaus_tmp->GetParameter(2));
    fdscb_tmp->SetParameter (3,3.0);
    fdscb_tmp->SetParLimits (3,0.0,10.0);
    //a2 parameter, up to when the gaussian core should count
    fdscb_tmp->SetParameter (5,3.0);
    fdscb_tmp->SetParLimits (5,0.0,10.0);
    fdscb_tmp->SetParameter(4,5.);
    fdscb_tmp->SetParLimits(4,0.,25.);
    fdscb_tmp->SetParameter(6,5.);
    fdscb_tmp->SetParLimits(6,0.,25.);
    int fitstatus(0); 
    fitstatus = hist_vec_1500_CT[i]->Fit(fdscb_tmp,"R");
    fdscb_tmp = hist_vec_1500_CT[i]->GetFunction("fdscb_tmp");
    h_1500_CT_DR07_E_SigmaCB_summary_histogram->SetBinContent(i-firstbin+1,fdscb_tmp->GetParameter(2)*100. );
    h_1500_CT_DR07_E_SigmaCB_summary_histogram->SetBinError(i-firstbin+1,fdscb_tmp->GetParError(2)*100. );
  }  


  TH1F* h_1500_CT_DR08_E_SigmaCB_summary_histogram=new TH1F("JER_SigmaCBVsCosTheta_CT_DR08_1500", "#sigma (E_{j}^{reco} / E_{j}^{true}) vs |cos#theta|", nRegionBins, pRegionBinEdges);
  h_1500_CT_DR08_E_SigmaCB_summary_histogram ->SetYTitle("#sigma(E_{j}) / E_{j} [%]");
  h_1500_CT_DR08_E_SigmaCB_summary_histogram->SetXTitle("|cos#theta|");
  h_1500_CT_DR08_E_SigmaCB_summary_histogram->SetLineWidth(2);
  h_1500_CT_DR08_E_SigmaCB_summary_histogram->SetLineColor(kBlue);
  h_1500_CT_DR08_E_SigmaCB_summary_histogram->SetLineStyle(2);
  TH1F* h_1500_CT_DR08_E_RMS90_summary_histogram=new TH1F("JER_RMS90VsCosTheta_CT_DR08_1500", "RMS_{90}(E_{j}^{reco}/E_{j}^{gen}) / Mean_{90}(E_{j}^{reco}/E_{j}^{gen}) vs |cos#theta|", nRegionBins, pRegionBinEdges);
  h_1500_CT_DR08_E_RMS90_summary_histogram ->SetYTitle("RMS_{90}(E_{j}^{reco}/E_{j}^{gen}) / Mean_{90}(E_{j}^{reco}/E_{j}^{gen}) [%]");
  h_1500_CT_DR08_E_RMS90_summary_histogram->SetXTitle("|cos#theta|");
  h_1500_CT_DR08_E_RMS90_summary_histogram->SetLineWidth(2);
  h_1500_CT_DR08_E_RMS90_summary_histogram->SetLineColor(kBlue);
  h_1500_CT_DR08_E_RMS90_summary_histogram->SetLineStyle(2);

  TH1F* h_1500_CT_DR08_E_RMS_summary_histogram=new TH1F("JER_RMSVsCosTheta_CT_DR08_1500", "RMS(E_{j}) / Mean(E_{j}) vs |cos#theta|", nRegionBins, pRegionBinEdges);
  h_1500_CT_DR08_E_RMS_summary_histogram ->SetYTitle("RMS(E_{j}) / Mean(E_{j}) [%]");
  h_1500_CT_DR08_E_RMS_summary_histogram->SetXTitle("|cos#theta|");
  h_1500_CT_DR08_E_RMS_summary_histogram->SetLineWidth(2);
  h_1500_CT_DR08_E_RMS_summary_histogram->SetLineColor(kBlue);
  h_1500_CT_DR08_E_RMS_summary_histogram->SetLineStyle(2);

  TH1F* h_1500_CT_DR08_E_JER_Mean_summary_histogram=new TH1F("JER_MeanVsCosTheta_CT_DR08_1500", "Mean(E_{tot}^{RECO}/E_{tot}^{true}) vs |cos#theta|", nRegionBins, pRegionBinEdges);
  h_1500_CT_DR08_E_JER_Mean_summary_histogram->SetYTitle("Mean(E_{tot}^{RECO}/E_{tot}^{true})");
  h_1500_CT_DR08_E_JER_Mean_summary_histogram->SetXTitle("|cos#theta|");
  h_1500_CT_DR08_E_JER_Mean_summary_histogram->SetLineWidth(2);
  h_1500_CT_DR08_E_JER_Mean_summary_histogram->SetLineColor(kBlue);
  h_1500_CT_DR08_E_JER_Mean_summary_histogram->SetLineStyle(2);
  firstbin=98;
  for(int i=firstbin;i<(firstbin+13);i++){
//continue;
    resolutionTH1=0; 
    resolutionErrorTH1=0;
    meanTH1=0;
    meanErrorTH1=0;
    CalculatePerformance( hist_vec_1500_CT[i], resolutionTH1, resolutionErrorTH1,meanTH1,meanErrorTH1);
    h_1500_CT_DR08_E_RMS90_summary_histogram->SetBinContent(i-firstbin+1,resolutionTH1/sqrt(2.));
    h_1500_CT_DR08_E_RMS90_summary_histogram ->SetBinError(i-firstbin+1, resolutionErrorTH1/sqrt(2.));
    h_1500_CT_DR08_E_RMS_summary_histogram->SetBinContent(i-firstbin+1,hist_vec_1500_CT[i]->GetRMS()*100. );
    h_1500_CT_DR08_E_RMS_summary_histogram ->SetBinError(i-firstbin+1, hist_vec_1500_CT[i]->GetRMSError()*100.);
    h_1500_CT_DR08_E_JER_Mean_summary_histogram->SetBinContent(i-firstbin+1,hist_vec_1500_CT[i]->GetMean());
    h_1500_CT_DR08_E_JER_Mean_summary_histogram->SetBinError(i-firstbin+1,hist_vec_1500_CT[i]->GetMeanError());
    //double sided crystal ball
    TF1* fit_gaus_tmp = new TF1("fit_gaus_tmp", "gaus",0.50,1.50);
    hist_vec_1500_CT[i]->Fit("fit_gaus_tmp","R");
    hist_vec_1500_CT[i]->GetFunction("fit_gaus_tmp");
    TF1* fdscb_tmp = new TF1("fdscb_tmp",fnc_dscb,0.,3.,7);
    fdscb_tmp->SetNpx(1000);
    fdscb_tmp->SetParameter(0,fit_gaus_tmp->GetParameter(0));
    //norm
    fdscb_tmp->SetParLimits (0,0.5*fit_gaus_tmp->GetParameter(0),1.5*fit_gaus_tmp->GetParameter(0));
    fdscb_tmp->SetParameter(1,fit_gaus_tmp->GetParameter(1));
    //gaussian mean
    fdscb_tmp->SetParLimits (1,0.8,1.2);
    //fdscb_tmp->SetParameter(2,fit_gaus_tmp->GetParameter(2));
    //fdscb_tmp->SetParLimits(2,fit_gaus_tmp->GetParameter(2)*0.50,1.50*fit_gaus_tmp->GetParameter(2));
    std::vector<float>sigma2SFit=sigmaGaussianFits2Sigma(hist_vec_1500_CT[i]);
    fdscb_tmp->SetParameter(2,sigma2SFit[0]);
    fdscb_tmp->SetParLimits(2,sigma2SFit[0]*0.50,1.50*sigma2SFit[0]);
    //-a1: parameter, from when the gaussian core should count
    fdscb_tmp->SetParameter(2,fit_gaus_tmp->GetParameter(2));
    fdscb_tmp->SetParameter (3,3.0);
    fdscb_tmp->SetParLimits (3,0.0,10.0);
    //a2 parameter, up to when the gaussian core should count
    fdscb_tmp->SetParameter (5,3.0);
    fdscb_tmp->SetParLimits (5,0.0,10.0);
    fdscb_tmp->SetParameter(4,5.);
    fdscb_tmp->SetParLimits(4,0.,25.);
    fdscb_tmp->SetParameter(6,5.);
    fdscb_tmp->SetParLimits(6,0.,25.);
    int fitstatus(0); 
    fitstatus = hist_vec_1500_CT[i]->Fit(fdscb_tmp,"R");
    fdscb_tmp = hist_vec_1500_CT[i]->GetFunction("fdscb_tmp");
    h_1500_CT_DR08_E_SigmaCB_summary_histogram->SetBinContent(i-firstbin+1,fdscb_tmp->GetParameter(2)*100. );
    h_1500_CT_DR08_E_SigmaCB_summary_histogram->SetBinError(i-firstbin+1,fdscb_tmp->GetParError(2)*100. );
  }  
  TH1F* h_1500_CT_DR09_E_SigmaCB_summary_histogram=new TH1F("JER_SigmaCBVsCosTheta_CT_DR09_1500", "#sigma (E_{j}^{reco} / E_{j}^{true}) vs |cos#theta|", nRegionBins, pRegionBinEdges);
  h_1500_CT_DR09_E_SigmaCB_summary_histogram ->SetYTitle("#sigma(E_{j}) / E_{j} [%]");
  h_1500_CT_DR09_E_SigmaCB_summary_histogram->SetXTitle("|cos#theta|");
  h_1500_CT_DR09_E_SigmaCB_summary_histogram->SetLineWidth(2);
  h_1500_CT_DR09_E_SigmaCB_summary_histogram->SetLineColor(kBlue);
  h_1500_CT_DR09_E_SigmaCB_summary_histogram->SetLineStyle(2);
  TH1F* h_1500_CT_DR09_E_RMS90_summary_histogram=new TH1F("JER_RMS90VsCosTheta_CT_DR09_1500", "RMS_{90}(E_{j}^{reco}/E_{j}^{gen}) / Mean_{90}(E_{j}^{reco}/E_{j}^{gen}) vs |cos#theta|", nRegionBins, pRegionBinEdges);
  h_1500_CT_DR09_E_RMS90_summary_histogram ->SetYTitle("RMS_{90}(E_{j}^{reco}/E_{j}^{gen}) / Mean_{90}(E_{j}^{reco}/E_{j}^{gen}) [%]");
  h_1500_CT_DR09_E_RMS90_summary_histogram->SetXTitle("|cos#theta|");
  h_1500_CT_DR09_E_RMS90_summary_histogram->SetLineWidth(2);
  h_1500_CT_DR09_E_RMS90_summary_histogram->SetLineColor(kBlue);
  h_1500_CT_DR09_E_RMS90_summary_histogram->SetLineStyle(2);

  TH1F* h_1500_CT_DR09_E_RMS_summary_histogram=new TH1F("JER_RMSVsCosTheta_CT_DR09_1500", "RMS(E_{j}) / Mean(E_{j}) vs |cos#theta|", nRegionBins, pRegionBinEdges);
  h_1500_CT_DR09_E_RMS_summary_histogram ->SetYTitle("RMS(E_{j}) / Mean(E_{j}) [%]");
  h_1500_CT_DR09_E_RMS_summary_histogram->SetXTitle("|cos#theta|");
  h_1500_CT_DR09_E_RMS_summary_histogram->SetLineWidth(2);
  h_1500_CT_DR09_E_RMS_summary_histogram->SetLineColor(kBlue);
  h_1500_CT_DR09_E_RMS_summary_histogram->SetLineStyle(2);

  TH1F* h_1500_CT_DR09_E_JER_Mean_summary_histogram=new TH1F("JER_MeanVsCosTheta_CT_DR09_1500", "Mean(E_{tot}^{RECO}/E_{tot}^{true}) vs |cos#theta|", nRegionBins, pRegionBinEdges);
  h_1500_CT_DR09_E_JER_Mean_summary_histogram->SetYTitle("Mean(E_{tot}^{RECO}/E_{tot}^{true})");
  h_1500_CT_DR09_E_JER_Mean_summary_histogram->SetXTitle("|cos#theta|");
  h_1500_CT_DR09_E_JER_Mean_summary_histogram->SetLineWidth(2);
  h_1500_CT_DR09_E_JER_Mean_summary_histogram->SetLineColor(kBlue);
  h_1500_CT_DR09_E_JER_Mean_summary_histogram->SetLineStyle(2);
  firstbin=111;
  for(int i=firstbin;i<(firstbin+13);i++){
//continue;
    resolutionTH1=0; 
    resolutionErrorTH1=0;
    meanTH1=0;
    meanErrorTH1=0;
    CalculatePerformance( hist_vec_1500_CT[i], resolutionTH1, resolutionErrorTH1,meanTH1,meanErrorTH1);
    h_1500_CT_DR09_E_RMS90_summary_histogram->SetBinContent(i-firstbin+1,resolutionTH1/sqrt(2.));
    h_1500_CT_DR09_E_RMS90_summary_histogram ->SetBinError(i-firstbin+1, resolutionErrorTH1/sqrt(2.));
    h_1500_CT_DR09_E_RMS_summary_histogram->SetBinContent(i-firstbin+1,hist_vec_1500_CT[i]->GetRMS()*100. );
    h_1500_CT_DR09_E_RMS_summary_histogram ->SetBinError(i-firstbin+1, hist_vec_1500_CT[i]->GetRMSError()*100.);
    h_1500_CT_DR09_E_JER_Mean_summary_histogram->SetBinContent(i-firstbin+1,hist_vec_1500_CT[i]->GetMean());
    h_1500_CT_DR09_E_JER_Mean_summary_histogram->SetBinError(i-firstbin+1,hist_vec_1500_CT[i]->GetMeanError());
    //double sided crystal ball
    TF1* fit_gaus_tmp = new TF1("fit_gaus_tmp", "gaus",0.50,1.50);
    hist_vec_1500_CT[i]->Fit("fit_gaus_tmp","R");
    hist_vec_1500_CT[i]->GetFunction("fit_gaus_tmp");
    TF1* fdscb_tmp = new TF1("fdscb_tmp",fnc_dscb,0.,3.,7);
    fdscb_tmp->SetNpx(1000);
    fdscb_tmp->SetParameter(0,fit_gaus_tmp->GetParameter(0));
    //norm
    fdscb_tmp->SetParLimits (0,0.5*fit_gaus_tmp->GetParameter(0),1.5*fit_gaus_tmp->GetParameter(0));
    fdscb_tmp->SetParameter(1,fit_gaus_tmp->GetParameter(1));
    //gaussian mean
    fdscb_tmp->SetParLimits (1,0.8,1.2);
    //fdscb_tmp->SetParameter(2,fit_gaus_tmp->GetParameter(2));
    //fdscb_tmp->SetParLimits(2,fit_gaus_tmp->GetParameter(2)*0.50,1.50*fit_gaus_tmp->GetParameter(2));
    std::vector<float>sigma2SFit=sigmaGaussianFits2Sigma(hist_vec_1500_CT[i]);
    fdscb_tmp->SetParameter(2,sigma2SFit[0]);
    fdscb_tmp->SetParLimits(2,sigma2SFit[0]*0.50,1.50*sigma2SFit[0]);
    //-a1: parameter, from when the gaussian core should count
    fdscb_tmp->SetParameter(2,fit_gaus_tmp->GetParameter(2));
    fdscb_tmp->SetParameter (3,3.0);
    fdscb_tmp->SetParLimits (3,0.0,10.0);
    //a2 parameter, up to when the gaussian core should count
    fdscb_tmp->SetParameter (5,3.0);
    fdscb_tmp->SetParLimits (5,0.0,10.0);
    fdscb_tmp->SetParameter(4,5.);
    fdscb_tmp->SetParLimits(4,0.,25.);
    fdscb_tmp->SetParameter(6,5.);
    fdscb_tmp->SetParLimits(6,0.,25.);
    int fitstatus(0); 
    fitstatus = hist_vec_1500_CT[i]->Fit(fdscb_tmp,"R");
    fdscb_tmp = hist_vec_1500_CT[i]->GetFunction("fdscb_tmp");
    h_1500_CT_DR09_E_SigmaCB_summary_histogram->SetBinContent(i-firstbin+1,fdscb_tmp->GetParameter(2)*100. );
    h_1500_CT_DR09_E_SigmaCB_summary_histogram->SetBinError(i-firstbin+1,fdscb_tmp->GetParError(2)*100. );
  }  
  TH1F* h_1500_CT_DR10_E_SigmaCB_summary_histogram=new TH1F("JER_SigmaCBVsCosTheta_CT_DR10_1500", "#sigma (E_{j}^{reco} / E_{j}^{true}) vs |cos#theta|", nRegionBins, pRegionBinEdges);
  h_1500_CT_DR10_E_SigmaCB_summary_histogram ->SetYTitle("#sigma(E_{j}) / E_{j} [%]");
  h_1500_CT_DR10_E_SigmaCB_summary_histogram->SetXTitle("|cos#theta|");
  h_1500_CT_DR10_E_SigmaCB_summary_histogram->SetLineWidth(2);
  h_1500_CT_DR10_E_SigmaCB_summary_histogram->SetLineColor(kBlue);
  h_1500_CT_DR10_E_SigmaCB_summary_histogram->SetLineStyle(2);
  TH1F* h_1500_CT_DR10_E_RMS90_summary_histogram=new TH1F("JER_RMS90VsCosTheta_CT_DR10_1500", "RMS_{90}(E_{j}^{reco}/E_{j}^{gen}) / Mean_{90}(E_{j}^{reco}/E_{j}^{gen}) vs |cos#theta|", nRegionBins, pRegionBinEdges);
  h_1500_CT_DR10_E_RMS90_summary_histogram ->SetYTitle("RMS_{90}(E_{j}^{reco}/E_{j}^{gen}) / Mean_{90}(E_{j}^{reco}/E_{j}^{gen}) [%]");
  h_1500_CT_DR10_E_RMS90_summary_histogram->SetXTitle("|cos#theta|");
  h_1500_CT_DR10_E_RMS90_summary_histogram->SetLineWidth(2);
  h_1500_CT_DR10_E_RMS90_summary_histogram->SetLineColor(kBlue);
  h_1500_CT_DR10_E_RMS90_summary_histogram->SetLineStyle(2);

  TH1F* h_1500_CT_DR10_E_RMS_summary_histogram=new TH1F("JER_RMSVsCosTheta_CT_DR10_1500", "RMS(E_{j}) / Mean(E_{j}) vs |cos#theta|", nRegionBins, pRegionBinEdges);
  h_1500_CT_DR10_E_RMS_summary_histogram ->SetYTitle("RMS(E_{j}) / Mean(E_{j}) [%]");
  h_1500_CT_DR10_E_RMS_summary_histogram->SetXTitle("|cos#theta|");
  h_1500_CT_DR10_E_RMS_summary_histogram->SetLineWidth(2);
  h_1500_CT_DR10_E_RMS_summary_histogram->SetLineColor(kBlue);
  h_1500_CT_DR10_E_RMS_summary_histogram->SetLineStyle(2);

  TH1F* h_1500_CT_DR10_E_JER_Mean_summary_histogram=new TH1F("JER_MeanVsCosTheta_CT_DR10_1500", "Mean(E_{tot}^{RECO}/E_{tot}^{true}) vs |cos#theta|", nRegionBins, pRegionBinEdges);
  h_1500_CT_DR10_E_JER_Mean_summary_histogram->SetYTitle("Mean(E_{tot}^{RECO}/E_{tot}^{true})");
  h_1500_CT_DR10_E_JER_Mean_summary_histogram->SetXTitle("|cos#theta|");
  h_1500_CT_DR10_E_JER_Mean_summary_histogram->SetLineWidth(2);
  h_1500_CT_DR10_E_JER_Mean_summary_histogram->SetLineColor(kBlue);
  h_1500_CT_DR10_E_JER_Mean_summary_histogram->SetLineStyle(2);
  firstbin=124;
  for(int i=firstbin;i<(firstbin+13);i++){
//continue;
    resolutionTH1=0; 
    resolutionErrorTH1=0;
    meanTH1=0;
    meanErrorTH1=0;
    CalculatePerformance( hist_vec_1500_CT[i], resolutionTH1, resolutionErrorTH1,meanTH1,meanErrorTH1);
    h_1500_CT_DR10_E_RMS90_summary_histogram->SetBinContent(i-firstbin+1,resolutionTH1/sqrt(2.));
    h_1500_CT_DR10_E_RMS90_summary_histogram ->SetBinError(i-firstbin+1, resolutionErrorTH1/sqrt(2.));
    h_1500_CT_DR10_E_RMS_summary_histogram->SetBinContent(i-firstbin+1,hist_vec_1500_CT[i]->GetRMS()*100. );
    h_1500_CT_DR10_E_RMS_summary_histogram ->SetBinError(i-firstbin+1, hist_vec_1500_CT[i]->GetRMSError()*100.);
    h_1500_CT_DR10_E_JER_Mean_summary_histogram->SetBinContent(i-firstbin+1,hist_vec_1500_CT[i]->GetMean());
    h_1500_CT_DR10_E_JER_Mean_summary_histogram->SetBinError(i-firstbin+1,hist_vec_1500_CT[i]->GetMeanError());
    //double sided crystal ball
    TF1* fit_gaus_tmp = new TF1("fit_gaus_tmp", "gaus",0.50,1.50);
    hist_vec_1500_CT[i]->Fit("fit_gaus_tmp","R");
    hist_vec_1500_CT[i]->GetFunction("fit_gaus_tmp");
    TF1* fdscb_tmp = new TF1("fdscb_tmp",fnc_dscb,0.,3.,7);
    fdscb_tmp->SetNpx(1000);
    fdscb_tmp->SetParameter(0,fit_gaus_tmp->GetParameter(0));
    //norm
    fdscb_tmp->SetParLimits (0,0.5*fit_gaus_tmp->GetParameter(0),1.5*fit_gaus_tmp->GetParameter(0));
    fdscb_tmp->SetParameter(1,fit_gaus_tmp->GetParameter(1));
    //gaussian mean
    fdscb_tmp->SetParLimits (1,0.8,1.2);
    //fdscb_tmp->SetParameter(2,fit_gaus_tmp->GetParameter(2));
    //fdscb_tmp->SetParLimits(2,fit_gaus_tmp->GetParameter(2)*0.50,1.50*fit_gaus_tmp->GetParameter(2));
    std::vector<float>sigma2SFit=sigmaGaussianFits2Sigma(hist_vec_1500_CT[i]);
    fdscb_tmp->SetParameter(2,sigma2SFit[0]);
    fdscb_tmp->SetParLimits(2,sigma2SFit[0]*0.50,1.50*sigma2SFit[0]);
    //-a1: parameter, from when the gaussian core should count
    fdscb_tmp->SetParameter(2,fit_gaus_tmp->GetParameter(2));
    fdscb_tmp->SetParameter (3,3.0);
    fdscb_tmp->SetParLimits (3,0.0,10.0);
    //a2 parameter, up to when the gaussian core should count
    fdscb_tmp->SetParameter (5,3.0);
    fdscb_tmp->SetParLimits (5,0.0,10.0);
    fdscb_tmp->SetParameter(4,5.);
    fdscb_tmp->SetParLimits(4,0.,25.);
    fdscb_tmp->SetParameter(6,5.);
    fdscb_tmp->SetParLimits(6,0.,25.);
    int fitstatus(0); 
    fitstatus = hist_vec_1500_CT[i]->Fit(fdscb_tmp,"R");
    fdscb_tmp = hist_vec_1500_CT[i]->GetFunction("fdscb_tmp");
  }  

  std::cout<<"1500 03/04/05/06 "<< calculate_over90(h_1500_CT_recojet03_E1_E2_over_E_True)<<"/"<< calculate_over90(h_1500_CT_recojet04_E1_E2_over_E_True)<<"/"<< calculate_over90(h_1500_CT_recojet05_E1_E2_over_E_True)<<"/"<<calculate_over90(h_1500_CT_recojet06_E1_E2_over_E_True)<<" 07/08/09/10 "<< calculate_over90(h_1500_CT_recojet07_E1_E2_over_E_True)<<"/"<< calculate_over90(h_1500_CT_recojet08_E1_E2_over_E_True)<<"/"<< calculate_over90(h_1500_CT_recojet09_E1_E2_over_E_True)<<"/"<<calculate_over90(h_1500_CT_recojet10_E1_E2_over_E_True)<<std::endl;
  std::cout<<"jet histos 1500 CT filled"<<std::endl;

  TH1F* h_1500_CT_wO_genjet03_dphi_j1j2 =  new TH1F("h_1500_CT_wO_genjet03_dphi_j1j2","", n_bins100, 0.5,TMath::Pi());
  TH1F* h_1500_CT_wO_genjet03_E1_E2_over_E_True =  new TH1F("h_1500_CT_wO_genjet03_E1_E2_over_E_True","", n_bins100, 0.5,1.00);
  TH1F* h_1500_CT_wO_genjet03_Delta_E1_E2_over_E12 =  new TH1F("h_1500_CT_wO_genjet03_Delta_E1_E2_over_E12","", n_bins100, -0.5,0.5);
  TH1F* h_1500_CT_wO_genjet04_dphi_j1j2 =  new TH1F("h_1500_CT_wO_genjet04_dphi_j1j2","", n_bins100, 0.5,TMath::Pi());
  TH1F* h_1500_CT_wO_genjet04_E1_E2_over_E_True =  new TH1F("h_1500_CT_wO_genjet04_E1_E2_over_E_True","", n_bins100, 0.5,1.00);
  TH1F* h_1500_CT_wO_genjet04_Delta_E1_E2_over_E12 =  new TH1F("h_1500_CT_wO_genjet04_Delta_E1_E2_over_E12","", n_bins100, -0.5,0.5);
  TH1F* h_1500_CT_wO_genjet05_dphi_j1j2 =  new TH1F("h_1500_CT_wO_genjet05_dphi_j1j2","", n_bins100, 0.5,TMath::Pi());
  TH1F* h_1500_CT_wO_genjet05_E1_E2_over_E_True =  new TH1F("h_1500_CT_wO_genjet05_E1_E2_over_E_True","", n_bins100, 0.5,1.00);
  TH1F* h_1500_CT_wO_genjet05_Delta_E1_E2_over_E12 =  new TH1F("h_1500_CT_wO_genjet05_Delta_E1_E2_over_E12","", n_bins100, -0.5,0.5);
  TH1F* h_1500_CT_wO_genjet06_dphi_j1j2 =  new TH1F("h_1500_CT_wO_genjet06_dphi_j1j2","", n_bins100, 0.5,TMath::Pi());
  TH1F* h_1500_CT_wO_genjet06_E1_E2_over_E_True =  new TH1F("h_1500_CT_wO_genjet06_E1_E2_over_E_True","", n_bins100, 0.5,1.00);
  TH1F* h_1500_CT_wO_genjet06_Delta_E1_E2_over_E12 =  new TH1F("h_1500_CT_wO_genjet06_Delta_E1_E2_over_E12","", n_bins100, -0.5,0.5);
  TH1F* h_1500_CT_wO_genjet07_dphi_j1j2 =  new TH1F("h_1500_CT_wO_genjet07_dphi_j1j2","", n_bins100, 0.5,TMath::Pi());
  TH1F* h_1500_CT_wO_genjet07_E1_E2_over_E_True =  new TH1F("h_1500_CT_wO_genjet07_E1_E2_over_E_True","", n_bins100, 0.5,1.00);
  TH1F* h_1500_CT_wO_genjet07_Delta_E1_E2_over_E12 =  new TH1F("h_1500_CT_wO_genjet07_Delta_E1_E2_over_E12","", n_bins100, -0.5,0.5);
  TH1F* h_1500_CT_wO_genjet08_dphi_j1j2 =  new TH1F("h_1500_CT_wO_genjet08_dphi_j1j2","", n_bins100, 0.5,TMath::Pi());
  TH1F* h_1500_CT_wO_genjet08_E1_E2_over_E_True =  new TH1F("h_1500_CT_wO_genjet08_E1_E2_over_E_True","", n_bins100, 0.5,1.00);
  TH1F* h_1500_CT_wO_genjet08_Delta_E1_E2_over_E12 =  new TH1F("h_1500_CT_wO_genjet08_Delta_E1_E2_over_E12","", n_bins100, -0.5,0.5);
  TH1F* h_1500_CT_wO_genjet09_dphi_j1j2 =  new TH1F("h_1500_CT_wO_genjet09_dphi_j1j2","", n_bins100, 0.5,TMath::Pi());
  TH1F* h_1500_CT_wO_genjet09_E1_E2_over_E_True =  new TH1F("h_1500_CT_wO_genjet09_E1_E2_over_E_True","", n_bins100, 0.5,1.00);
  TH1F* h_1500_CT_wO_genjet09_Delta_E1_E2_over_E12 =  new TH1F("h_1500_CT_wO_genjet09_Delta_E1_E2_over_E12","", n_bins100, -0.5,0.5);
  TH1F* h_1500_CT_wO_genjet10_dphi_j1j2 =  new TH1F("h_1500_CT_wO_genjet10_dphi_j1j2","", n_bins100, 0.5,TMath::Pi());
  TH1F* h_1500_CT_wO_genjet10_E1_E2_over_E_True =  new TH1F("h_1500_CT_wO_genjet10_E1_E2_over_E_True","", n_bins100, 0.5,1.00);
  TH1F* h_1500_CT_wO_genjet10_Delta_E1_E2_over_E12 =  new TH1F("h_1500_CT_wO_genjet10_Delta_E1_E2_over_E12","", n_bins100, -0.5,0.5);

  TH1F* h_1500_CT_wO_recojet03_dphi_j1j2 =  new TH1F("h_1500_CT_wO_recojet03_dphi_j1j2","", n_bins100, 0.5,TMath::Pi());
  TH1F* h_1500_CT_wO_recojet03_E1_E2_over_E_True =  new TH1F("h_1500_CT_wO_recojet03_E1_E2_over_E_True","", n_bins100, 0.5,1.00);
  TH1F* h_1500_CT_wO_recojet03_Delta_E1_E2_over_E12 =  new TH1F("h_1500_CT_wO_recojet03_Delta_E1_E2_over_E12","", n_bins100, -0.5,0.5);
  TH1F* h_1500_CT_wO_recojet04_dphi_j1j2 =  new TH1F("h_1500_CT_wO_recojet04_dphi_j1j2","", n_bins100, 0.5,TMath::Pi());
  TH1F* h_1500_CT_wO_recojet04_E1_E2_over_E_True =  new TH1F("h_1500_CT_wO_recojet04_E1_E2_over_E_True","", n_bins100, 0.5,1.00);
  TH1F* h_1500_CT_wO_recojet04_Delta_E1_E2_over_E12 =  new TH1F("h_1500_CT_wO_recojet04_Delta_E1_E2_over_E12","", n_bins100, -0.5,0.5);
  TH1F* h_1500_CT_wO_recojet05_dphi_j1j2 =  new TH1F("h_1500_CT_wO_recojet05_dphi_j1j2","", n_bins100, 0.5,TMath::Pi());
  TH1F* h_1500_CT_wO_recojet05_E1_E2_over_E_True =  new TH1F("h_1500_CT_wO_recojet05_E1_E2_over_E_True","", n_bins100, 0.5,1.00);
  TH1F* h_1500_CT_wO_recojet05_Delta_E1_E2_over_E12 =  new TH1F("h_1500_CT_wO_recojet05_Delta_E1_E2_over_E12","", n_bins100, -0.5,0.5);
  TH1F* h_1500_CT_wO_recojet06_dphi_j1j2 =  new TH1F("h_1500_CT_wO_recojet06_dphi_j1j2","", n_bins100, 0.5,TMath::Pi());
  TH1F* h_1500_CT_wO_recojet06_E1_E2_over_E_True =  new TH1F("h_1500_CT_wO_recojet06_E1_E2_over_E_True","", n_bins100, 0.5,1.00);
  TH1F* h_1500_CT_wO_recojet06_Delta_E1_E2_over_E12 =  new TH1F("h_1500_CT_wO_recojet06_Delta_E1_E2_over_E12","", n_bins100, -0.5,0.5);
  TH1F* h_1500_CT_wO_recojet07_dphi_j1j2 =  new TH1F("h_1500_CT_wO_recojet07_dphi_j1j2","", n_bins100, 0.5,TMath::Pi());
  TH1F* h_1500_CT_wO_recojet07_E1_E2_over_E_True =  new TH1F("h_1500_CT_wO_recojet07_E1_E2_over_E_True","", n_bins100, 0.5,1.00);
  TH1F* h_1500_CT_wO_recojet07_Delta_E1_E2_over_E12 =  new TH1F("h_1500_CT_wO_recojet07_Delta_E1_E2_over_E12","", n_bins100, -0.5,0.5);
  TH1F* h_1500_CT_wO_recojet08_dphi_j1j2 =  new TH1F("h_1500_CT_wO_recojet08_dphi_j1j2","", n_bins100, 0.5,TMath::Pi());
  TH1F* h_1500_CT_wO_recojet08_E1_E2_over_E_True =  new TH1F("h_1500_CT_wO_recojet08_E1_E2_over_E_True","", n_bins100, 0.5,1.00);
  TH1F* h_1500_CT_wO_recojet08_Delta_E1_E2_over_E12 =  new TH1F("h_1500_CT_wO_recojet08_Delta_E1_E2_over_E12","", n_bins100, -0.5,0.5);
  TH1F* h_1500_CT_wO_recojet09_dphi_j1j2 =  new TH1F("h_1500_CT_wO_recojet09_dphi_j1j2","", n_bins100, 0.5,TMath::Pi());
  TH1F* h_1500_CT_wO_recojet09_E1_E2_over_E_True =  new TH1F("h_1500_CT_wO_recojet09_E1_E2_over_E_True","", n_bins100, 0.5,1.00);
  TH1F* h_1500_CT_wO_recojet09_Delta_E1_E2_over_E12 =  new TH1F("h_1500_CT_wO_recojet09_Delta_E1_E2_over_E12","", n_bins100, -0.5,0.5);
  TH1F* h_1500_CT_wO_recojet10_dphi_j1j2 =  new TH1F("h_1500_CT_wO_recojet10_dphi_j1j2","", n_bins100, 0.5,TMath::Pi());
  TH1F* h_1500_CT_wO_recojet10_E1_E2_over_E_True =  new TH1F("h_1500_CT_wO_recojet10_E1_E2_over_E_True","", n_bins100, 0.5,1.00);
  TH1F* h_1500_CT_wO_recojet10_Delta_E1_E2_over_E12 =  new TH1F("h_1500_CT_wO_recojet10_Delta_E1_E2_over_E12","", n_bins100, -0.5,0.5);

  TH1F* h_1500_CT_wO_recojetE_over_genjetE_DR03 =  new TH1F("h_1500_CT_wO_recojetE_over_genjetE_DR03","", n_bins100, 0.5,1.5);
  TH1F* h_1500_CT_wO_recojetE_over_genjetE_DR04 =  new TH1F("h_1500_CT_wO_recojetE_over_genjetE_DR04","", n_bins100, 0.5,1.5);
  TH1F* h_1500_CT_wO_recojetE_over_genjetE_DR05 =  new TH1F("h_1500_CT_wO_recojetE_over_genjetE_DR05","", n_bins100, 0.5,1.5);
  TH1F* h_1500_CT_wO_recojetE_over_genjetE_DR06 =  new TH1F("h_1500_CT_wO_recojetE_over_genjetE_DR06","", n_bins100, 0.5,1.5);
  TH1F* h_1500_CT_wO_recojetE_over_genjetE_DR07 =  new TH1F("h_1500_CT_wO_recojetE_over_genjetE_DR07","", n_bins100, 0.5,1.5);
  TH1F* h_1500_CT_wO_recojetE_over_genjetE_DR08 =  new TH1F("h_1500_CT_wO_recojetE_over_genjetE_DR08","", n_bins100, 0.5,1.5);
  TH1F* h_1500_CT_wO_recojetE_over_genjetE_DR09 =  new TH1F("h_1500_CT_wO_recojetE_over_genjetE_DR09","", n_bins100, 0.5,1.5);
  TH1F* h_1500_CT_wO_recojetE_over_genjetE_DR10 =  new TH1F("h_1500_CT_wO_recojetE_over_genjetE_DR10","", n_bins100, 0.5,1.5);

  TH1F* h_1500_CT_wO_dphi_gen_reco_DR05 =  new TH1F("h_1500_CT_wO_dphi_gen_reco_DR05","", n_bins100, -0.1,9.9);
  TH1F* h_1500_CT_wO_dphi_gen_reco_DR06 =  new TH1F("h_1500_CT_wO_dphi_gen_reco_DR06","", n_bins100, -0.1,9.9);
  TH1F* h_1500_CT_wO_dphi_gen_reco_DR07 =  new TH1F("h_1500_CT_wO_dphi_gen_reco_DR07","", n_bins100, -0.1,9.9);

  TH1F* h_1500_CT_wO_DR05_E_rel_totVis_RMS_d1_cosT_0_to_0_10 =  new TH1F("h_1500_CT_wO_DR05_E_rel_totVis_RMS_d1_cosT_0_to_0_10","", n_binsJER, lim_E_rel_low,lim_E_rel_high);
  TH1F* h_1500_CT_wO_DR05_E_rel_totVis_RMS_d1_cosT_0_10_to_0_20 =  new TH1F("h_1500_CT_wO_DR05_E_rel_totVis_RMS_d1_cosT_0_10_to_0_20","", n_binsJER, lim_E_rel_low,lim_E_rel_high);
  TH1F* h_1500_CT_wO_DR05_E_rel_totVis_RMS_d1_cosT_0_20_to_0_30 =  new TH1F("h_1500_CT_wO_DR05_E_rel_totVis_RMS_d1_cosT_0_20_to_0_30","", n_binsJER, lim_E_rel_low,lim_E_rel_high);
  TH1F* h_1500_CT_wO_DR05_E_rel_totVis_RMS_d1_cosT_0_30_to_0_40 =  new TH1F("h_1500_CT_wO_DR05_E_rel_totVis_RMS_d1_cosT_0_30_to_0_40","", n_binsJER, lim_E_rel_low,lim_E_rel_high);
  TH1F* h_1500_CT_wO_DR05_E_rel_totVis_RMS_d1_cosT_0_40_to_0_50 =  new TH1F("h_1500_CT_wO_DR05_E_rel_totVis_RMS_d1_cosT_0_40_to_0_50","", n_binsJER, lim_E_rel_low,lim_E_rel_high);
  TH1F* h_1500_CT_wO_DR05_E_rel_totVis_RMS_d1_cosT_0_50_to_0_60 =  new TH1F("h_1500_CT_wO_DR05_E_rel_totVis_RMS_d1_cosT_0_50_to_0_60","", n_binsJER, lim_E_rel_low,lim_E_rel_high);
  TH1F* h_1500_CT_wO_DR05_E_rel_totVis_RMS_d1_cosT_0_60_to_0_70 =  new TH1F("h_1500_CT_wO_DR05_E_rel_totVis_RMS_d1_cosT_0_60_to_0_70","", n_binsJER, lim_E_rel_low,lim_E_rel_high);
  TH1F* h_1500_CT_wO_DR05_E_rel_totVis_RMS_d1_cosT_0_70_to_0_80 =  new TH1F("h_1500_CT_wO_DR05_E_rel_totVis_RMS_d1_cosT_0_70_to_0_80","", n_binsJER, lim_E_rel_low,lim_E_rel_high);
  TH1F* h_1500_CT_wO_DR05_E_rel_totVis_RMS_d1_cosT_0_80_to_0_90 =  new TH1F("h_1500_CT_wO_DR05_E_rel_totVis_RMS_d1_cosT_0_80_to_0_90","", n_binsJER, lim_E_rel_low,lim_E_rel_high);
  TH1F* h_1500_CT_wO_DR05_E_rel_totVis_RMS_d1_cosT_0_900_to_0_925 =  new TH1F("h_1500_CT_wO_DR05_E_rel_totVis_RMS_d1_cosT_0_900_to_0_925","", n_binsJER, lim_E_rel_low,lim_E_rel_high);
  TH1F* h_1500_CT_wO_DR05_E_rel_totVis_RMS_d1_cosT_0_925_to_0_950 =  new TH1F("h_1500_CT_wO_DR05_E_rel_totVis_RMS_d1_cosT_0_925_to_0_950","", n_binsJER, lim_E_rel_low,lim_E_rel_high);
  TH1F* h_1500_CT_wO_DR05_E_rel_totVis_RMS_d1_cosT_0_950_to_0_975 =  new TH1F("h_1500_CT_wO_DR05_E_rel_totVis_RMS_d1_cosT_0_950_to_0_975","", n_binsJER, lim_E_rel_low,lim_E_rel_high);
  TH1F* h_1500_CT_wO_DR05_E_rel_totVis_RMS_d1_cosT_0_975_to_1_00 =  new TH1F("h_1500_CT_wO_DR05_E_rel_totVis_RMS_d1_cosT_0_975_to_1_00","", n_binsJER, lim_E_rel_low,lim_E_rel_high);

  TH1F* h_1500_CT_wO_DR06_E_rel_totVis_RMS_d1_cosT_0_to_0_10 =  new TH1F("h_1500_CT_wO_DR06_E_rel_totVis_RMS_d1_cosT_0_to_0_10","", n_binsJER, lim_E_rel_low,lim_E_rel_high);
  TH1F* h_1500_CT_wO_DR06_E_rel_totVis_RMS_d1_cosT_0_10_to_0_20 =  new TH1F("h_1500_CT_wO_DR06_E_rel_totVis_RMS_d1_cosT_0_10_to_0_20","", n_binsJER, lim_E_rel_low,lim_E_rel_high);
  TH1F* h_1500_CT_wO_DR06_E_rel_totVis_RMS_d1_cosT_0_20_to_0_30 =  new TH1F("h_1500_CT_wO_DR06_E_rel_totVis_RMS_d1_cosT_0_20_to_0_30","", n_binsJER, lim_E_rel_low,lim_E_rel_high);
  TH1F* h_1500_CT_wO_DR06_E_rel_totVis_RMS_d1_cosT_0_30_to_0_40 =  new TH1F("h_1500_CT_wO_DR06_E_rel_totVis_RMS_d1_cosT_0_30_to_0_40","", n_binsJER, lim_E_rel_low,lim_E_rel_high);
  TH1F* h_1500_CT_wO_DR06_E_rel_totVis_RMS_d1_cosT_0_40_to_0_50 =  new TH1F("h_1500_CT_wO_DR06_E_rel_totVis_RMS_d1_cosT_0_40_to_0_50","", n_binsJER, lim_E_rel_low,lim_E_rel_high);
  TH1F* h_1500_CT_wO_DR06_E_rel_totVis_RMS_d1_cosT_0_50_to_0_60 =  new TH1F("h_1500_CT_wO_DR06_E_rel_totVis_RMS_d1_cosT_0_50_to_0_60","", n_binsJER, lim_E_rel_low,lim_E_rel_high);
  TH1F* h_1500_CT_wO_DR06_E_rel_totVis_RMS_d1_cosT_0_60_to_0_70 =  new TH1F("h_1500_CT_wO_DR06_E_rel_totVis_RMS_d1_cosT_0_60_to_0_70","", n_binsJER, lim_E_rel_low,lim_E_rel_high);
  TH1F* h_1500_CT_wO_DR06_E_rel_totVis_RMS_d1_cosT_0_70_to_0_80 =  new TH1F("h_1500_CT_wO_DR06_E_rel_totVis_RMS_d1_cosT_0_70_to_0_80","", n_binsJER, lim_E_rel_low,lim_E_rel_high);
  TH1F* h_1500_CT_wO_DR06_E_rel_totVis_RMS_d1_cosT_0_80_to_0_90 =  new TH1F("h_1500_CT_wO_DR06_E_rel_totVis_RMS_d1_cosT_0_80_to_0_90","", n_binsJER, lim_E_rel_low,lim_E_rel_high);
  TH1F* h_1500_CT_wO_DR06_E_rel_totVis_RMS_d1_cosT_0_900_to_0_925 =  new TH1F("h_1500_CT_wO_DR06_E_rel_totVis_RMS_d1_cosT_0_900_to_0_925","", n_binsJER, lim_E_rel_low,lim_E_rel_high);
  TH1F* h_1500_CT_wO_DR06_E_rel_totVis_RMS_d1_cosT_0_925_to_0_950 =  new TH1F("h_1500_CT_wO_DR06_E_rel_totVis_RMS_d1_cosT_0_925_to_0_950","", n_binsJER, lim_E_rel_low,lim_E_rel_high);
  TH1F* h_1500_CT_wO_DR06_E_rel_totVis_RMS_d1_cosT_0_950_to_0_975 =  new TH1F("h_1500_CT_wO_DR06_E_rel_totVis_RMS_d1_cosT_0_950_to_0_975","", n_binsJER, lim_E_rel_low,lim_E_rel_high);
  TH1F* h_1500_CT_wO_DR06_E_rel_totVis_RMS_d1_cosT_0_975_to_1_00 =  new TH1F("h_1500_CT_wO_DR06_E_rel_totVis_RMS_d1_cosT_0_975_to_1_00","", n_binsJER, lim_E_rel_low,lim_E_rel_high);

  TH1F* h_1500_CT_wO_DR07_E_rel_totVis_RMS_d1_cosT_0_to_0_10 =  new TH1F("h_1500_CT_wO_DR07_E_rel_totVis_RMS_d1_cosT_0_to_0_10","", n_binsJER, lim_E_rel_low,lim_E_rel_high);
  TH1F* h_1500_CT_wO_DR07_E_rel_totVis_RMS_d1_cosT_0_10_to_0_20 =  new TH1F("h_1500_CT_wO_DR07_E_rel_totVis_RMS_d1_cosT_0_10_to_0_20","", n_binsJER, lim_E_rel_low,lim_E_rel_high);
  TH1F* h_1500_CT_wO_DR07_E_rel_totVis_RMS_d1_cosT_0_20_to_0_30 =  new TH1F("h_1500_CT_wO_DR07_E_rel_totVis_RMS_d1_cosT_0_20_to_0_30","", n_binsJER, lim_E_rel_low,lim_E_rel_high);
  TH1F* h_1500_CT_wO_DR07_E_rel_totVis_RMS_d1_cosT_0_30_to_0_40 =  new TH1F("h_1500_CT_wO_DR07_E_rel_totVis_RMS_d1_cosT_0_30_to_0_40","", n_binsJER, lim_E_rel_low,lim_E_rel_high);
  TH1F* h_1500_CT_wO_DR07_E_rel_totVis_RMS_d1_cosT_0_40_to_0_50 =  new TH1F("h_1500_CT_wO_DR07_E_rel_totVis_RMS_d1_cosT_0_40_to_0_50","", n_binsJER, lim_E_rel_low,lim_E_rel_high);
  TH1F* h_1500_CT_wO_DR07_E_rel_totVis_RMS_d1_cosT_0_50_to_0_60 =  new TH1F("h_1500_CT_wO_DR07_E_rel_totVis_RMS_d1_cosT_0_50_to_0_60","", n_binsJER, lim_E_rel_low,lim_E_rel_high);
  TH1F* h_1500_CT_wO_DR07_E_rel_totVis_RMS_d1_cosT_0_60_to_0_70 =  new TH1F("h_1500_CT_wO_DR07_E_rel_totVis_RMS_d1_cosT_0_60_to_0_70","", n_binsJER, lim_E_rel_low,lim_E_rel_high);
  TH1F* h_1500_CT_wO_DR07_E_rel_totVis_RMS_d1_cosT_0_70_to_0_80 =  new TH1F("h_1500_CT_wO_DR07_E_rel_totVis_RMS_d1_cosT_0_70_to_0_80","", n_binsJER, lim_E_rel_low,lim_E_rel_high);
  TH1F* h_1500_CT_wO_DR07_E_rel_totVis_RMS_d1_cosT_0_80_to_0_90 =  new TH1F("h_1500_CT_wO_DR07_E_rel_totVis_RMS_d1_cosT_0_80_to_0_90","", n_binsJER, lim_E_rel_low,lim_E_rel_high);
  TH1F* h_1500_CT_wO_DR07_E_rel_totVis_RMS_d1_cosT_0_900_to_0_925 =  new TH1F("h_1500_CT_wO_DR07_E_rel_totVis_RMS_d1_cosT_0_900_to_0_925","", n_binsJER, lim_E_rel_low,lim_E_rel_high);
  TH1F* h_1500_CT_wO_DR07_E_rel_totVis_RMS_d1_cosT_0_925_to_0_950 =  new TH1F("h_1500_CT_wO_DR07_E_rel_totVis_RMS_d1_cosT_0_925_to_0_950","", n_binsJER, lim_E_rel_low,lim_E_rel_high);
  TH1F* h_1500_CT_wO_DR07_E_rel_totVis_RMS_d1_cosT_0_950_to_0_975 =  new TH1F("h_1500_CT_wO_DR07_E_rel_totVis_RMS_d1_cosT_0_950_to_0_975","", n_binsJER, lim_E_rel_low,lim_E_rel_high);
  TH1F* h_1500_CT_wO_DR07_E_rel_totVis_RMS_d1_cosT_0_975_to_1_00 =  new TH1F("h_1500_CT_wO_DR07_E_rel_totVis_RMS_d1_cosT_0_975_to_1_00","", n_binsJER, lim_E_rel_low,lim_E_rel_high);

  TH1F* h_1500_CT_wO_DR08_E_rel_totVis_RMS_d1_cosT_0_to_0_10 =  new TH1F("h_1500_CT_wO_DR08_E_rel_totVis_RMS_d1_cosT_0_to_0_10","", n_binsJER, lim_E_rel_low,lim_E_rel_high);
  TH1F* h_1500_CT_wO_DR08_E_rel_totVis_RMS_d1_cosT_0_10_to_0_20 =  new TH1F("h_1500_CT_wO_DR08_E_rel_totVis_RMS_d1_cosT_0_10_to_0_20","", n_binsJER, lim_E_rel_low,lim_E_rel_high);
  TH1F* h_1500_CT_wO_DR08_E_rel_totVis_RMS_d1_cosT_0_20_to_0_30 =  new TH1F("h_1500_CT_wO_DR08_E_rel_totVis_RMS_d1_cosT_0_20_to_0_30","", n_binsJER, lim_E_rel_low,lim_E_rel_high);
  TH1F* h_1500_CT_wO_DR08_E_rel_totVis_RMS_d1_cosT_0_30_to_0_40 =  new TH1F("h_1500_CT_wO_DR08_E_rel_totVis_RMS_d1_cosT_0_30_to_0_40","", n_binsJER, lim_E_rel_low,lim_E_rel_high);
  TH1F* h_1500_CT_wO_DR08_E_rel_totVis_RMS_d1_cosT_0_40_to_0_50 =  new TH1F("h_1500_CT_wO_DR08_E_rel_totVis_RMS_d1_cosT_0_40_to_0_50","", n_binsJER, lim_E_rel_low,lim_E_rel_high);
  TH1F* h_1500_CT_wO_DR08_E_rel_totVis_RMS_d1_cosT_0_50_to_0_60 =  new TH1F("h_1500_CT_wO_DR08_E_rel_totVis_RMS_d1_cosT_0_50_to_0_60","", n_binsJER, lim_E_rel_low,lim_E_rel_high);
  TH1F* h_1500_CT_wO_DR08_E_rel_totVis_RMS_d1_cosT_0_60_to_0_70 =  new TH1F("h_1500_CT_wO_DR08_E_rel_totVis_RMS_d1_cosT_0_60_to_0_70","", n_binsJER, lim_E_rel_low,lim_E_rel_high);
  TH1F* h_1500_CT_wO_DR08_E_rel_totVis_RMS_d1_cosT_0_70_to_0_80 =  new TH1F("h_1500_CT_wO_DR08_E_rel_totVis_RMS_d1_cosT_0_70_to_0_80","", n_binsJER, lim_E_rel_low,lim_E_rel_high);
  TH1F* h_1500_CT_wO_DR08_E_rel_totVis_RMS_d1_cosT_0_80_to_0_90 =  new TH1F("h_1500_CT_wO_DR08_E_rel_totVis_RMS_d1_cosT_0_80_to_0_90","", n_binsJER, lim_E_rel_low,lim_E_rel_high);
  TH1F* h_1500_CT_wO_DR08_E_rel_totVis_RMS_d1_cosT_0_900_to_0_925 =  new TH1F("h_1500_CT_wO_DR08_E_rel_totVis_RMS_d1_cosT_0_900_to_0_925","", n_binsJER, lim_E_rel_low,lim_E_rel_high);
  TH1F* h_1500_CT_wO_DR08_E_rel_totVis_RMS_d1_cosT_0_925_to_0_950 =  new TH1F("h_1500_CT_wO_DR08_E_rel_totVis_RMS_d1_cosT_0_925_to_0_950","", n_binsJER, lim_E_rel_low,lim_E_rel_high);
  TH1F* h_1500_CT_wO_DR08_E_rel_totVis_RMS_d1_cosT_0_950_to_0_975 =  new TH1F("h_1500_CT_wO_DR08_E_rel_totVis_RMS_d1_cosT_0_950_to_0_975","", n_binsJER, lim_E_rel_low,lim_E_rel_high);
  TH1F* h_1500_CT_wO_DR08_E_rel_totVis_RMS_d1_cosT_0_975_to_1_00 =  new TH1F("h_1500_CT_wO_DR08_E_rel_totVis_RMS_d1_cosT_0_975_to_1_00","", n_binsJER, lim_E_rel_low,lim_E_rel_high);

  TH1F* h_1500_CT_wO_DR09_E_rel_totVis_RMS_d1_cosT_0_to_0_10 =  new TH1F("h_1500_CT_wO_DR09_E_rel_totVis_RMS_d1_cosT_0_to_0_10","", n_binsJER, lim_E_rel_low,lim_E_rel_high);
  TH1F* h_1500_CT_wO_DR09_E_rel_totVis_RMS_d1_cosT_0_10_to_0_20 =  new TH1F("h_1500_CT_wO_DR09_E_rel_totVis_RMS_d1_cosT_0_10_to_0_20","", n_binsJER, lim_E_rel_low,lim_E_rel_high);
  TH1F* h_1500_CT_wO_DR09_E_rel_totVis_RMS_d1_cosT_0_20_to_0_30 =  new TH1F("h_1500_CT_wO_DR09_E_rel_totVis_RMS_d1_cosT_0_20_to_0_30","", n_binsJER, lim_E_rel_low,lim_E_rel_high);
  TH1F* h_1500_CT_wO_DR09_E_rel_totVis_RMS_d1_cosT_0_30_to_0_40 =  new TH1F("h_1500_CT_wO_DR09_E_rel_totVis_RMS_d1_cosT_0_30_to_0_40","", n_binsJER, lim_E_rel_low,lim_E_rel_high);
  TH1F* h_1500_CT_wO_DR09_E_rel_totVis_RMS_d1_cosT_0_40_to_0_50 =  new TH1F("h_1500_CT_wO_DR09_E_rel_totVis_RMS_d1_cosT_0_40_to_0_50","", n_binsJER, lim_E_rel_low,lim_E_rel_high);
  TH1F* h_1500_CT_wO_DR09_E_rel_totVis_RMS_d1_cosT_0_50_to_0_60 =  new TH1F("h_1500_CT_wO_DR09_E_rel_totVis_RMS_d1_cosT_0_50_to_0_60","", n_binsJER, lim_E_rel_low,lim_E_rel_high);
  TH1F* h_1500_CT_wO_DR09_E_rel_totVis_RMS_d1_cosT_0_60_to_0_70 =  new TH1F("h_1500_CT_wO_DR09_E_rel_totVis_RMS_d1_cosT_0_60_to_0_70","", n_binsJER, lim_E_rel_low,lim_E_rel_high);
  TH1F* h_1500_CT_wO_DR09_E_rel_totVis_RMS_d1_cosT_0_70_to_0_80 =  new TH1F("h_1500_CT_wO_DR09_E_rel_totVis_RMS_d1_cosT_0_70_to_0_80","", n_binsJER, lim_E_rel_low,lim_E_rel_high);
  TH1F* h_1500_CT_wO_DR09_E_rel_totVis_RMS_d1_cosT_0_80_to_0_90 =  new TH1F("h_1500_CT_wO_DR09_E_rel_totVis_RMS_d1_cosT_0_80_to_0_90","", n_binsJER, lim_E_rel_low,lim_E_rel_high);
  TH1F* h_1500_CT_wO_DR09_E_rel_totVis_RMS_d1_cosT_0_900_to_0_925 =  new TH1F("h_1500_CT_wO_DR09_E_rel_totVis_RMS_d1_cosT_0_900_to_0_925","", n_binsJER, lim_E_rel_low,lim_E_rel_high);
  TH1F* h_1500_CT_wO_DR09_E_rel_totVis_RMS_d1_cosT_0_925_to_0_950 =  new TH1F("h_1500_CT_wO_DR09_E_rel_totVis_RMS_d1_cosT_0_925_to_0_950","", n_binsJER, lim_E_rel_low,lim_E_rel_high);
  TH1F* h_1500_CT_wO_DR09_E_rel_totVis_RMS_d1_cosT_0_950_to_0_975 =  new TH1F("h_1500_CT_wO_DR09_E_rel_totVis_RMS_d1_cosT_0_950_to_0_975","", n_binsJER, lim_E_rel_low,lim_E_rel_high);
  TH1F* h_1500_CT_wO_DR09_E_rel_totVis_RMS_d1_cosT_0_975_to_1_00 =  new TH1F("h_1500_CT_wO_DR09_E_rel_totVis_RMS_d1_cosT_0_975_to_1_00","", n_binsJER, lim_E_rel_low,lim_E_rel_high);

  TH1F* h_1500_CT_wO_DR10_E_rel_totVis_RMS_d1_cosT_0_to_0_10 =  new TH1F("h_1500_CT_wO_DR10_E_rel_totVis_RMS_d1_cosT_0_to_0_10","", n_binsJER, lim_E_rel_low,lim_E_rel_high);
  TH1F* h_1500_CT_wO_DR10_E_rel_totVis_RMS_d1_cosT_0_10_to_0_20 =  new TH1F("h_1500_CT_wO_DR10_E_rel_totVis_RMS_d1_cosT_0_10_to_0_20","", n_binsJER, lim_E_rel_low,lim_E_rel_high);
  TH1F* h_1500_CT_wO_DR10_E_rel_totVis_RMS_d1_cosT_0_20_to_0_30 =  new TH1F("h_1500_CT_wO_DR10_E_rel_totVis_RMS_d1_cosT_0_20_to_0_30","", n_binsJER, lim_E_rel_low,lim_E_rel_high);
  TH1F* h_1500_CT_wO_DR10_E_rel_totVis_RMS_d1_cosT_0_30_to_0_40 =  new TH1F("h_1500_CT_wO_DR10_E_rel_totVis_RMS_d1_cosT_0_30_to_0_40","", n_binsJER, lim_E_rel_low,lim_E_rel_high);
  TH1F* h_1500_CT_wO_DR10_E_rel_totVis_RMS_d1_cosT_0_40_to_0_50 =  new TH1F("h_1500_CT_wO_DR10_E_rel_totVis_RMS_d1_cosT_0_40_to_0_50","", n_binsJER, lim_E_rel_low,lim_E_rel_high);
  TH1F* h_1500_CT_wO_DR10_E_rel_totVis_RMS_d1_cosT_0_50_to_0_60 =  new TH1F("h_1500_CT_wO_DR10_E_rel_totVis_RMS_d1_cosT_0_50_to_0_60","", n_binsJER, lim_E_rel_low,lim_E_rel_high);
  TH1F* h_1500_CT_wO_DR10_E_rel_totVis_RMS_d1_cosT_0_60_to_0_70 =  new TH1F("h_1500_CT_wO_DR10_E_rel_totVis_RMS_d1_cosT_0_60_to_0_70","", n_binsJER, lim_E_rel_low,lim_E_rel_high);
  TH1F* h_1500_CT_wO_DR10_E_rel_totVis_RMS_d1_cosT_0_70_to_0_80 =  new TH1F("h_1500_CT_wO_DR10_E_rel_totVis_RMS_d1_cosT_0_70_to_0_80","", n_binsJER, lim_E_rel_low,lim_E_rel_high);
  TH1F* h_1500_CT_wO_DR10_E_rel_totVis_RMS_d1_cosT_0_80_to_0_90 =  new TH1F("h_1500_CT_wO_DR10_E_rel_totVis_RMS_d1_cosT_0_80_to_0_90","", n_binsJER, lim_E_rel_low,lim_E_rel_high);
  TH1F* h_1500_CT_wO_DR10_E_rel_totVis_RMS_d1_cosT_0_900_to_0_925 =  new TH1F("h_1500_CT_wO_DR10_E_rel_totVis_RMS_d1_cosT_0_900_to_0_925","", n_binsJER, lim_E_rel_low,lim_E_rel_high);
  TH1F* h_1500_CT_wO_DR10_E_rel_totVis_RMS_d1_cosT_0_925_to_0_950 =  new TH1F("h_1500_CT_wO_DR10_E_rel_totVis_RMS_d1_cosT_0_925_to_0_950","", n_binsJER, lim_E_rel_low,lim_E_rel_high);
  TH1F* h_1500_CT_wO_DR10_E_rel_totVis_RMS_d1_cosT_0_950_to_0_975 =  new TH1F("h_1500_CT_wO_DR10_E_rel_totVis_RMS_d1_cosT_0_950_to_0_975","", n_binsJER, lim_E_rel_low,lim_E_rel_high);
  TH1F* h_1500_CT_wO_DR10_E_rel_totVis_RMS_d1_cosT_0_975_to_1_00 =  new TH1F("h_1500_CT_wO_DR10_E_rel_totVis_RMS_d1_cosT_0_975_to_1_00","", n_binsJER, lim_E_rel_low,lim_E_rel_high);

  TH1F* h_1500_CT_wO_DR05_dphi_reco_gen_cosTheta_0_65 =  new TH1F("h_1500_CT_wO_DR05_dphi_reco_gen_cosTheta_0_65","", n_bins100, -lim_angleDeg,lim_angleDeg);
  TH1F* h_1500_CT_wO_DR05_dtheta_reco_gen_cosTheta_0_65 =  new TH1F("h_1500_CT_wO_DR05_dtheta_reco_gen_cosTheta_0_65","", n_bins100, -lim_angleDeg,lim_angleDeg);
  TH1F* h_1500_CT_wO_DR05_dphi_reco_gen_cosTheta_0_65_to_0_80 =  new TH1F("h_1500_CT_wO_DR05_dphi_reco_gen_cosTheta_0_65_to_0_80","", n_bins100, -lim_angleDeg,lim_angleDeg);
  TH1F* h_1500_CT_wO_DR05_dtheta_reco_gen_cosTheta_0_65_to_0_80 =  new TH1F("h_1500_CT_wO_DR05_dtheta_reco_gen_cosTheta_0_65_to_0_80","", n_bins100, -lim_angleDeg,lim_angleDeg);
  TH1F* h_1500_CT_wO_DR05_dphi_reco_gen_cosTheta_0_80_to_0_925 =  new TH1F("h_1500_CT_wO_DR05_dphi_reco_gen_cosTheta_0_80_to_0_925","", n_bins100, -lim_angleDeg,lim_angleDeg);
  TH1F* h_1500_CT_wO_DR05_dtheta_reco_gen_cosTheta_0_80_to_0_925 =  new TH1F("h_1500_CT_wO_DR05_dtheta_reco_gen_cosTheta_0_80_to_0_925","", n_bins100, -lim_angleDeg,lim_angleDeg);
  TH1F* h_1500_CT_wO_DR05_dphi_reco_gen_cosTheta_0_925_to_0_975 =  new TH1F("h_1500_CT_wO_DR05_dphi_reco_gen_cosTheta_0_925_to_0_975","", n_bins100, -lim_angleDeg,lim_angleDeg);
  TH1F* h_1500_CT_wO_DR05_dtheta_reco_gen_cosTheta_0_925_to_0_975 =  new TH1F("h_1500_CT_wO_DR05_dtheta_reco_gen_cosTheta_0_925_to_0_975","", n_bins100, -lim_angleDeg,lim_angleDeg);

  TH1F* h_1500_CT_wO_DR07_dphi_reco_gen_cosTheta_0_65 =  new TH1F("h_1500_CT_wO_DR07_dphi_reco_gen_cosTheta_0_65","", n_bins100, -lim_angleDeg,lim_angleDeg);
  TH1F* h_1500_CT_wO_DR07_dtheta_reco_gen_cosTheta_0_65 =  new TH1F("h_1500_CT_wO_DR07_dtheta_reco_gen_cosTheta_0_65","", n_bins100, -lim_angleDeg,lim_angleDeg);
  TH1F* h_1500_CT_wO_DR07_dphi_reco_gen_cosTheta_0_65_to_0_80 =  new TH1F("h_1500_CT_wO_DR07_dphi_reco_gen_cosTheta_0_65_to_0_80","", n_bins100, -lim_angleDeg,lim_angleDeg);
  TH1F* h_1500_CT_wO_DR07_dtheta_reco_gen_cosTheta_0_65_to_0_80 =  new TH1F("h_1500_CT_wO_DR07_dtheta_reco_gen_cosTheta_0_65_to_0_80","", n_bins100, -lim_angleDeg,lim_angleDeg);
  TH1F* h_1500_CT_wO_DR07_dphi_reco_gen_cosTheta_0_80_to_0_925 =  new TH1F("h_1500_CT_wO_DR07_dphi_reco_gen_cosTheta_0_80_to_0_925","", n_bins100, -lim_angleDeg,lim_angleDeg);
  TH1F* h_1500_CT_wO_DR07_dtheta_reco_gen_cosTheta_0_80_to_0_925 =  new TH1F("h_1500_CT_wO_DR07_dtheta_reco_gen_cosTheta_0_80_to_0_925","", n_bins100, -lim_angleDeg,lim_angleDeg);
  TH1F* h_1500_CT_wO_DR07_dphi_reco_gen_cosTheta_0_925_to_0_975 =  new TH1F("h_1500_CT_wO_DR07_dphi_reco_gen_cosTheta_0_925_to_0_975","", n_bins100, -lim_angleDeg,lim_angleDeg);
  TH1F* h_1500_CT_wO_DR07_dtheta_reco_gen_cosTheta_0_925_to_0_975 =  new TH1F("h_1500_CT_wO_DR07_dtheta_reco_gen_cosTheta_0_925_to_0_975","", n_bins100, -lim_angleDeg,lim_angleDeg);

  TH1F* h_1500_CT_wO_DR10_dphi_reco_gen_cosTheta_0_65 =  new TH1F("h_1500_CT_wO_DR10_dphi_reco_gen_cosTheta_0_65","", n_bins100, -lim_angleDeg,lim_angleDeg);
  TH1F* h_1500_CT_wO_DR10_dtheta_reco_gen_cosTheta_0_65 =  new TH1F("h_1500_CT_wO_DR10_dtheta_reco_gen_cosTheta_0_65","", n_bins100, -lim_angleDeg,lim_angleDeg);
  TH1F* h_1500_CT_wO_DR10_dphi_reco_gen_cosTheta_0_65_to_0_80 =  new TH1F("h_1500_CT_wO_DR10_dphi_reco_gen_cosTheta_0_65_to_0_80","", n_bins100, -lim_angleDeg,lim_angleDeg);
  TH1F* h_1500_CT_wO_DR10_dtheta_reco_gen_cosTheta_0_65_to_0_80 =  new TH1F("h_1500_CT_wO_DR10_dtheta_reco_gen_cosTheta_0_65_to_0_80","", n_bins100, -lim_angleDeg,lim_angleDeg);
  TH1F* h_1500_CT_wO_DR10_dphi_reco_gen_cosTheta_0_80_to_0_925 =  new TH1F("h_1500_CT_wO_DR10_dphi_reco_gen_cosTheta_0_80_to_0_925","", n_bins100, -lim_angleDeg,lim_angleDeg);
  TH1F* h_1500_CT_wO_DR10_dtheta_reco_gen_cosTheta_0_80_to_0_925 =  new TH1F("h_1500_CT_wO_DR10_dtheta_reco_gen_cosTheta_0_80_to_0_925","", n_bins100, -lim_angleDeg,lim_angleDeg);
  TH1F* h_1500_CT_wO_DR10_dphi_reco_gen_cosTheta_0_925_to_0_975 =  new TH1F("h_1500_CT_wO_DR10_dphi_reco_gen_cosTheta_0_925_to_0_975","", n_bins100, -lim_angleDeg,lim_angleDeg);
  TH1F* h_1500_CT_wO_DR10_dtheta_reco_gen_cosTheta_0_925_to_0_975 =  new TH1F("h_1500_CT_wO_DR10_dtheta_reco_gen_cosTheta_0_925_to_0_975","", n_bins100, -lim_angleDeg,lim_angleDeg);

  std::vector<TH1F*> hist_vec_1500_CT_wO;
  hist_vec_1500_CT_wO.push_back(h_1500_CT_wO_genjet03_dphi_j1j2);
  hist_vec_1500_CT_wO.push_back(h_1500_CT_wO_genjet03_E1_E2_over_E_True);
  hist_vec_1500_CT_wO.push_back(h_1500_CT_wO_genjet03_Delta_E1_E2_over_E12);
  hist_vec_1500_CT_wO.push_back(h_1500_CT_wO_genjet04_dphi_j1j2);
  hist_vec_1500_CT_wO.push_back(h_1500_CT_wO_genjet04_E1_E2_over_E_True);
  hist_vec_1500_CT_wO.push_back(h_1500_CT_wO_genjet04_Delta_E1_E2_over_E12);
  hist_vec_1500_CT_wO.push_back(h_1500_CT_wO_genjet05_dphi_j1j2);
  hist_vec_1500_CT_wO.push_back(h_1500_CT_wO_genjet05_E1_E2_over_E_True);
  hist_vec_1500_CT_wO.push_back(h_1500_CT_wO_genjet05_Delta_E1_E2_over_E12);
  hist_vec_1500_CT_wO.push_back(h_1500_CT_wO_genjet06_dphi_j1j2);
  hist_vec_1500_CT_wO.push_back(h_1500_CT_wO_genjet06_E1_E2_over_E_True);
  hist_vec_1500_CT_wO.push_back(h_1500_CT_wO_genjet06_Delta_E1_E2_over_E12);
  hist_vec_1500_CT_wO.push_back(h_1500_CT_wO_genjet07_dphi_j1j2);
  hist_vec_1500_CT_wO.push_back(h_1500_CT_wO_genjet07_E1_E2_over_E_True);
  hist_vec_1500_CT_wO.push_back(h_1500_CT_wO_genjet07_Delta_E1_E2_over_E12);
  hist_vec_1500_CT_wO.push_back(h_1500_CT_wO_genjet08_dphi_j1j2);
  hist_vec_1500_CT_wO.push_back(h_1500_CT_wO_genjet08_E1_E2_over_E_True);
  hist_vec_1500_CT_wO.push_back(h_1500_CT_wO_genjet08_Delta_E1_E2_over_E12);
  hist_vec_1500_CT_wO.push_back(h_1500_CT_wO_genjet09_dphi_j1j2);
  hist_vec_1500_CT_wO.push_back(h_1500_CT_wO_genjet09_E1_E2_over_E_True);
  hist_vec_1500_CT_wO.push_back(h_1500_CT_wO_genjet09_Delta_E1_E2_over_E12);
  hist_vec_1500_CT_wO.push_back(h_1500_CT_wO_genjet10_dphi_j1j2);
  hist_vec_1500_CT_wO.push_back(h_1500_CT_wO_genjet10_E1_E2_over_E_True);
  hist_vec_1500_CT_wO.push_back(h_1500_CT_wO_genjet10_Delta_E1_E2_over_E12);

  hist_vec_1500_CT_wO.push_back(h_1500_CT_wO_recojet03_dphi_j1j2);
  hist_vec_1500_CT_wO.push_back(h_1500_CT_wO_recojet03_E1_E2_over_E_True);
  hist_vec_1500_CT_wO.push_back(h_1500_CT_wO_recojet03_Delta_E1_E2_over_E12);
  hist_vec_1500_CT_wO.push_back(h_1500_CT_wO_recojet04_dphi_j1j2);
  hist_vec_1500_CT_wO.push_back(h_1500_CT_wO_recojet04_E1_E2_over_E_True);
  hist_vec_1500_CT_wO.push_back(h_1500_CT_wO_recojet04_Delta_E1_E2_over_E12);
  hist_vec_1500_CT_wO.push_back(h_1500_CT_wO_recojet05_dphi_j1j2);
  hist_vec_1500_CT_wO.push_back(h_1500_CT_wO_recojet05_E1_E2_over_E_True);
  hist_vec_1500_CT_wO.push_back(h_1500_CT_wO_recojet05_Delta_E1_E2_over_E12);
  hist_vec_1500_CT_wO.push_back(h_1500_CT_wO_recojet06_dphi_j1j2);
  hist_vec_1500_CT_wO.push_back(h_1500_CT_wO_recojet06_E1_E2_over_E_True);
  hist_vec_1500_CT_wO.push_back(h_1500_CT_wO_recojet06_Delta_E1_E2_over_E12);
  hist_vec_1500_CT_wO.push_back(h_1500_CT_wO_recojet07_dphi_j1j2);
  hist_vec_1500_CT_wO.push_back(h_1500_CT_wO_recojet07_E1_E2_over_E_True);
  hist_vec_1500_CT_wO.push_back(h_1500_CT_wO_recojet07_Delta_E1_E2_over_E12);
  hist_vec_1500_CT_wO.push_back(h_1500_CT_wO_recojet08_dphi_j1j2);
  hist_vec_1500_CT_wO.push_back(h_1500_CT_wO_recojet08_E1_E2_over_E_True);
  hist_vec_1500_CT_wO.push_back(h_1500_CT_wO_recojet08_Delta_E1_E2_over_E12);
  hist_vec_1500_CT_wO.push_back(h_1500_CT_wO_recojet09_dphi_j1j2);
  hist_vec_1500_CT_wO.push_back(h_1500_CT_wO_recojet09_E1_E2_over_E_True);
  hist_vec_1500_CT_wO.push_back(h_1500_CT_wO_recojet09_Delta_E1_E2_over_E12);
  hist_vec_1500_CT_wO.push_back(h_1500_CT_wO_recojet10_dphi_j1j2);
  hist_vec_1500_CT_wO.push_back(h_1500_CT_wO_recojet10_E1_E2_over_E_True);
  hist_vec_1500_CT_wO.push_back(h_1500_CT_wO_recojet10_Delta_E1_E2_over_E12);

  hist_vec_1500_CT_wO.push_back(h_1500_CT_wO_recojetE_over_genjetE_DR03);
  hist_vec_1500_CT_wO.push_back(h_1500_CT_wO_recojetE_over_genjetE_DR04);
  hist_vec_1500_CT_wO.push_back(h_1500_CT_wO_recojetE_over_genjetE_DR05);
  hist_vec_1500_CT_wO.push_back(h_1500_CT_wO_recojetE_over_genjetE_DR06);
  hist_vec_1500_CT_wO.push_back(h_1500_CT_wO_recojetE_over_genjetE_DR07);
  hist_vec_1500_CT_wO.push_back(h_1500_CT_wO_recojetE_over_genjetE_DR08);
  hist_vec_1500_CT_wO.push_back(h_1500_CT_wO_recojetE_over_genjetE_DR09);
  hist_vec_1500_CT_wO.push_back(h_1500_CT_wO_recojetE_over_genjetE_DR10);

  hist_vec_1500_CT_wO.push_back(h_1500_CT_wO_dphi_gen_reco_DR05);
  hist_vec_1500_CT_wO.push_back(h_1500_CT_wO_dphi_gen_reco_DR06);
  hist_vec_1500_CT_wO.push_back(h_1500_CT_wO_dphi_gen_reco_DR07);

  hist_vec_1500_CT_wO.push_back(h_1500_CT_wO_DR05_E_rel_totVis_RMS_d1_cosT_0_to_0_10);
  hist_vec_1500_CT_wO.push_back(h_1500_CT_wO_DR05_E_rel_totVis_RMS_d1_cosT_0_10_to_0_20);
  hist_vec_1500_CT_wO.push_back(h_1500_CT_wO_DR05_E_rel_totVis_RMS_d1_cosT_0_20_to_0_30);
  hist_vec_1500_CT_wO.push_back(h_1500_CT_wO_DR05_E_rel_totVis_RMS_d1_cosT_0_30_to_0_40);
  hist_vec_1500_CT_wO.push_back(h_1500_CT_wO_DR05_E_rel_totVis_RMS_d1_cosT_0_40_to_0_50);
  hist_vec_1500_CT_wO.push_back(h_1500_CT_wO_DR05_E_rel_totVis_RMS_d1_cosT_0_50_to_0_60);
  hist_vec_1500_CT_wO.push_back(h_1500_CT_wO_DR05_E_rel_totVis_RMS_d1_cosT_0_60_to_0_70);
  hist_vec_1500_CT_wO.push_back(h_1500_CT_wO_DR05_E_rel_totVis_RMS_d1_cosT_0_70_to_0_80);
  hist_vec_1500_CT_wO.push_back(h_1500_CT_wO_DR05_E_rel_totVis_RMS_d1_cosT_0_80_to_0_90);
  hist_vec_1500_CT_wO.push_back(h_1500_CT_wO_DR05_E_rel_totVis_RMS_d1_cosT_0_900_to_0_925);
  hist_vec_1500_CT_wO.push_back(h_1500_CT_wO_DR05_E_rel_totVis_RMS_d1_cosT_0_925_to_0_950);
  hist_vec_1500_CT_wO.push_back(h_1500_CT_wO_DR05_E_rel_totVis_RMS_d1_cosT_0_950_to_0_975);
  hist_vec_1500_CT_wO.push_back(h_1500_CT_wO_DR05_E_rel_totVis_RMS_d1_cosT_0_975_to_1_00);

  hist_vec_1500_CT_wO.push_back(h_1500_CT_wO_DR06_E_rel_totVis_RMS_d1_cosT_0_to_0_10);
  hist_vec_1500_CT_wO.push_back(h_1500_CT_wO_DR06_E_rel_totVis_RMS_d1_cosT_0_10_to_0_20);
  hist_vec_1500_CT_wO.push_back(h_1500_CT_wO_DR06_E_rel_totVis_RMS_d1_cosT_0_20_to_0_30);
  hist_vec_1500_CT_wO.push_back(h_1500_CT_wO_DR06_E_rel_totVis_RMS_d1_cosT_0_30_to_0_40);
  hist_vec_1500_CT_wO.push_back(h_1500_CT_wO_DR06_E_rel_totVis_RMS_d1_cosT_0_40_to_0_50);
  hist_vec_1500_CT_wO.push_back(h_1500_CT_wO_DR06_E_rel_totVis_RMS_d1_cosT_0_50_to_0_60);
  hist_vec_1500_CT_wO.push_back(h_1500_CT_wO_DR06_E_rel_totVis_RMS_d1_cosT_0_60_to_0_70);
  hist_vec_1500_CT_wO.push_back(h_1500_CT_wO_DR06_E_rel_totVis_RMS_d1_cosT_0_70_to_0_80);
  hist_vec_1500_CT_wO.push_back(h_1500_CT_wO_DR06_E_rel_totVis_RMS_d1_cosT_0_80_to_0_90);
  hist_vec_1500_CT_wO.push_back(h_1500_CT_wO_DR06_E_rel_totVis_RMS_d1_cosT_0_900_to_0_925);
  hist_vec_1500_CT_wO.push_back(h_1500_CT_wO_DR06_E_rel_totVis_RMS_d1_cosT_0_925_to_0_950);
  hist_vec_1500_CT_wO.push_back(h_1500_CT_wO_DR06_E_rel_totVis_RMS_d1_cosT_0_950_to_0_975);
  hist_vec_1500_CT_wO.push_back(h_1500_CT_wO_DR06_E_rel_totVis_RMS_d1_cosT_0_975_to_1_00); 

  hist_vec_1500_CT_wO.push_back(h_1500_CT_wO_DR07_E_rel_totVis_RMS_d1_cosT_0_to_0_10);
  hist_vec_1500_CT_wO.push_back(h_1500_CT_wO_DR07_E_rel_totVis_RMS_d1_cosT_0_10_to_0_20);
  hist_vec_1500_CT_wO.push_back(h_1500_CT_wO_DR07_E_rel_totVis_RMS_d1_cosT_0_20_to_0_30);
  hist_vec_1500_CT_wO.push_back(h_1500_CT_wO_DR07_E_rel_totVis_RMS_d1_cosT_0_30_to_0_40);
  hist_vec_1500_CT_wO.push_back(h_1500_CT_wO_DR07_E_rel_totVis_RMS_d1_cosT_0_40_to_0_50);
  hist_vec_1500_CT_wO.push_back(h_1500_CT_wO_DR07_E_rel_totVis_RMS_d1_cosT_0_50_to_0_60);
  hist_vec_1500_CT_wO.push_back(h_1500_CT_wO_DR07_E_rel_totVis_RMS_d1_cosT_0_60_to_0_70);
  hist_vec_1500_CT_wO.push_back(h_1500_CT_wO_DR07_E_rel_totVis_RMS_d1_cosT_0_70_to_0_80);
  hist_vec_1500_CT_wO.push_back(h_1500_CT_wO_DR07_E_rel_totVis_RMS_d1_cosT_0_80_to_0_90);
  hist_vec_1500_CT_wO.push_back(h_1500_CT_wO_DR07_E_rel_totVis_RMS_d1_cosT_0_900_to_0_925);
  hist_vec_1500_CT_wO.push_back(h_1500_CT_wO_DR07_E_rel_totVis_RMS_d1_cosT_0_925_to_0_950);
  hist_vec_1500_CT_wO.push_back(h_1500_CT_wO_DR07_E_rel_totVis_RMS_d1_cosT_0_950_to_0_975);
  hist_vec_1500_CT_wO.push_back(h_1500_CT_wO_DR07_E_rel_totVis_RMS_d1_cosT_0_975_to_1_00); 

  hist_vec_1500_CT_wO.push_back(h_1500_CT_wO_DR08_E_rel_totVis_RMS_d1_cosT_0_to_0_10);
  hist_vec_1500_CT_wO.push_back(h_1500_CT_wO_DR08_E_rel_totVis_RMS_d1_cosT_0_10_to_0_20);
  hist_vec_1500_CT_wO.push_back(h_1500_CT_wO_DR08_E_rel_totVis_RMS_d1_cosT_0_20_to_0_30);
  hist_vec_1500_CT_wO.push_back(h_1500_CT_wO_DR08_E_rel_totVis_RMS_d1_cosT_0_30_to_0_40);
  hist_vec_1500_CT_wO.push_back(h_1500_CT_wO_DR08_E_rel_totVis_RMS_d1_cosT_0_40_to_0_50);
  hist_vec_1500_CT_wO.push_back(h_1500_CT_wO_DR08_E_rel_totVis_RMS_d1_cosT_0_50_to_0_60);
  hist_vec_1500_CT_wO.push_back(h_1500_CT_wO_DR08_E_rel_totVis_RMS_d1_cosT_0_60_to_0_70);
  hist_vec_1500_CT_wO.push_back(h_1500_CT_wO_DR08_E_rel_totVis_RMS_d1_cosT_0_70_to_0_80);
  hist_vec_1500_CT_wO.push_back(h_1500_CT_wO_DR08_E_rel_totVis_RMS_d1_cosT_0_80_to_0_90);
  hist_vec_1500_CT_wO.push_back(h_1500_CT_wO_DR08_E_rel_totVis_RMS_d1_cosT_0_900_to_0_925);
  hist_vec_1500_CT_wO.push_back(h_1500_CT_wO_DR08_E_rel_totVis_RMS_d1_cosT_0_925_to_0_950);
  hist_vec_1500_CT_wO.push_back(h_1500_CT_wO_DR08_E_rel_totVis_RMS_d1_cosT_0_950_to_0_975);
  hist_vec_1500_CT_wO.push_back(h_1500_CT_wO_DR08_E_rel_totVis_RMS_d1_cosT_0_975_to_1_00); //110

  hist_vec_1500_CT_wO.push_back(h_1500_CT_wO_DR09_E_rel_totVis_RMS_d1_cosT_0_to_0_10);
  hist_vec_1500_CT_wO.push_back(h_1500_CT_wO_DR09_E_rel_totVis_RMS_d1_cosT_0_10_to_0_20);
  hist_vec_1500_CT_wO.push_back(h_1500_CT_wO_DR09_E_rel_totVis_RMS_d1_cosT_0_20_to_0_30);
  hist_vec_1500_CT_wO.push_back(h_1500_CT_wO_DR09_E_rel_totVis_RMS_d1_cosT_0_30_to_0_40);
  hist_vec_1500_CT_wO.push_back(h_1500_CT_wO_DR09_E_rel_totVis_RMS_d1_cosT_0_40_to_0_50);
  hist_vec_1500_CT_wO.push_back(h_1500_CT_wO_DR09_E_rel_totVis_RMS_d1_cosT_0_50_to_0_60);
  hist_vec_1500_CT_wO.push_back(h_1500_CT_wO_DR09_E_rel_totVis_RMS_d1_cosT_0_60_to_0_70);
  hist_vec_1500_CT_wO.push_back(h_1500_CT_wO_DR09_E_rel_totVis_RMS_d1_cosT_0_70_to_0_80);
  hist_vec_1500_CT_wO.push_back(h_1500_CT_wO_DR09_E_rel_totVis_RMS_d1_cosT_0_80_to_0_90);
  hist_vec_1500_CT_wO.push_back(h_1500_CT_wO_DR09_E_rel_totVis_RMS_d1_cosT_0_900_to_0_925);
  hist_vec_1500_CT_wO.push_back(h_1500_CT_wO_DR09_E_rel_totVis_RMS_d1_cosT_0_925_to_0_950);
  hist_vec_1500_CT_wO.push_back(h_1500_CT_wO_DR09_E_rel_totVis_RMS_d1_cosT_0_950_to_0_975);
  hist_vec_1500_CT_wO.push_back(h_1500_CT_wO_DR09_E_rel_totVis_RMS_d1_cosT_0_975_to_1_00); //123

  hist_vec_1500_CT_wO.push_back(h_1500_CT_wO_DR10_E_rel_totVis_RMS_d1_cosT_0_to_0_10);
  hist_vec_1500_CT_wO.push_back(h_1500_CT_wO_DR10_E_rel_totVis_RMS_d1_cosT_0_10_to_0_20);
  hist_vec_1500_CT_wO.push_back(h_1500_CT_wO_DR10_E_rel_totVis_RMS_d1_cosT_0_20_to_0_30);
  hist_vec_1500_CT_wO.push_back(h_1500_CT_wO_DR10_E_rel_totVis_RMS_d1_cosT_0_30_to_0_40);
  hist_vec_1500_CT_wO.push_back(h_1500_CT_wO_DR10_E_rel_totVis_RMS_d1_cosT_0_40_to_0_50);
  hist_vec_1500_CT_wO.push_back(h_1500_CT_wO_DR10_E_rel_totVis_RMS_d1_cosT_0_50_to_0_60);
  hist_vec_1500_CT_wO.push_back(h_1500_CT_wO_DR10_E_rel_totVis_RMS_d1_cosT_0_60_to_0_70);
  hist_vec_1500_CT_wO.push_back(h_1500_CT_wO_DR10_E_rel_totVis_RMS_d1_cosT_0_70_to_0_80);
  hist_vec_1500_CT_wO.push_back(h_1500_CT_wO_DR10_E_rel_totVis_RMS_d1_cosT_0_80_to_0_90);
  hist_vec_1500_CT_wO.push_back(h_1500_CT_wO_DR10_E_rel_totVis_RMS_d1_cosT_0_900_to_0_925);
  hist_vec_1500_CT_wO.push_back(h_1500_CT_wO_DR10_E_rel_totVis_RMS_d1_cosT_0_925_to_0_950);
  hist_vec_1500_CT_wO.push_back(h_1500_CT_wO_DR10_E_rel_totVis_RMS_d1_cosT_0_950_to_0_975);
  hist_vec_1500_CT_wO.push_back(h_1500_CT_wO_DR10_E_rel_totVis_RMS_d1_cosT_0_975_to_1_00); //136

  hist_vec_1500_CT_wO.push_back(h_1500_CT_wO_DR05_dphi_reco_gen_cosTheta_0_65);//137
  hist_vec_1500_CT_wO.push_back(h_1500_CT_wO_DR05_dphi_reco_gen_cosTheta_0_65_to_0_80);
  hist_vec_1500_CT_wO.push_back(h_1500_CT_wO_DR05_dphi_reco_gen_cosTheta_0_80_to_0_925);
  hist_vec_1500_CT_wO.push_back(h_1500_CT_wO_DR05_dphi_reco_gen_cosTheta_0_925_to_0_975);
  hist_vec_1500_CT_wO.push_back(h_1500_CT_wO_DR05_dtheta_reco_gen_cosTheta_0_65);
  hist_vec_1500_CT_wO.push_back(h_1500_CT_wO_DR05_dtheta_reco_gen_cosTheta_0_65_to_0_80);
  hist_vec_1500_CT_wO.push_back(h_1500_CT_wO_DR05_dtheta_reco_gen_cosTheta_0_80_to_0_925);
  hist_vec_1500_CT_wO.push_back(h_1500_CT_wO_DR05_dtheta_reco_gen_cosTheta_0_925_to_0_975);

  hist_vec_1500_CT_wO.push_back(h_1500_CT_wO_DR07_dphi_reco_gen_cosTheta_0_65);//145
  hist_vec_1500_CT_wO.push_back(h_1500_CT_wO_DR07_dphi_reco_gen_cosTheta_0_65_to_0_80);
  hist_vec_1500_CT_wO.push_back(h_1500_CT_wO_DR07_dphi_reco_gen_cosTheta_0_80_to_0_925);
  hist_vec_1500_CT_wO.push_back(h_1500_CT_wO_DR07_dphi_reco_gen_cosTheta_0_925_to_0_975);
  hist_vec_1500_CT_wO.push_back(h_1500_CT_wO_DR07_dtheta_reco_gen_cosTheta_0_65);
  hist_vec_1500_CT_wO.push_back(h_1500_CT_wO_DR07_dtheta_reco_gen_cosTheta_0_65_to_0_80);
  hist_vec_1500_CT_wO.push_back(h_1500_CT_wO_DR07_dtheta_reco_gen_cosTheta_0_80_to_0_925);
  hist_vec_1500_CT_wO.push_back(h_1500_CT_wO_DR07_dtheta_reco_gen_cosTheta_0_925_to_0_975);

  hist_vec_1500_CT_wO.push_back(h_1500_CT_wO_DR10_dphi_reco_gen_cosTheta_0_65);//153
  hist_vec_1500_CT_wO.push_back(h_1500_CT_wO_DR10_dphi_reco_gen_cosTheta_0_65_to_0_80);
  hist_vec_1500_CT_wO.push_back(h_1500_CT_wO_DR10_dphi_reco_gen_cosTheta_0_80_to_0_925);
  hist_vec_1500_CT_wO.push_back(h_1500_CT_wO_DR10_dphi_reco_gen_cosTheta_0_925_to_0_975);
  hist_vec_1500_CT_wO.push_back(h_1500_CT_wO_DR10_dtheta_reco_gen_cosTheta_0_65);
  hist_vec_1500_CT_wO.push_back(h_1500_CT_wO_DR10_dtheta_reco_gen_cosTheta_0_65_to_0_80);
  hist_vec_1500_CT_wO.push_back(h_1500_CT_wO_DR10_dtheta_reco_gen_cosTheta_0_80_to_0_925);
  hist_vec_1500_CT_wO.push_back(h_1500_CT_wO_DR10_dtheta_reco_gen_cosTheta_0_925_to_0_975);

  for(unsigned int i=0;i<hist_vec_1500_CT_wO.size();i++){
    hist_vec_1500_CT_wO[i]->Sumw2();
  }
  fill_jet_histograms(file_CLIC_1500_CT_wO,hist_vec_1500_CT_wO);



  TH1F* h_1500_CT_wO_DR05_dphi_SigmaCB_summary_histogram=new TH1F("dphiRes_SigmaCBVsCosTheta_CT_wO_DR05_1500", "#sigma#Delta#phi(j_{reco},j_{true}) vs |cos#theta|", nRegionBinsAngles, pRegionBinEdgesAngles);
  h_1500_CT_wO_DR05_dphi_SigmaCB_summary_histogram ->SetYTitle("#sigma#Delta#phi(j_{reco},j_{true})");
  h_1500_CT_wO_DR05_dphi_SigmaCB_summary_histogram->SetXTitle("|cos#theta|");
  h_1500_CT_wO_DR05_dphi_SigmaCB_summary_histogram->SetLineWidth(2);
  h_1500_CT_wO_DR05_dphi_SigmaCB_summary_histogram->SetLineColor(kCyan+1);
  h_1500_CT_wO_DR05_dphi_SigmaCB_summary_histogram->SetLineStyle(2);

  TH1F* h_1500_CT_wO_DR05_dphi_RMS90_summary_histogram=new TH1F("dphiRes_RMS90VsCosTheta_CT_wO_DR05_1500", "RMS_{90} #Delta#phi(j_{reco},j_{true}) vs |cos#theta|", nRegionBinsAngles, pRegionBinEdgesAngles);
  h_1500_CT_wO_DR05_dphi_RMS90_summary_histogram ->SetYTitle("RMS_{90}#Delta#phi(j_{reco},j_{true})");
  h_1500_CT_wO_DR05_dphi_RMS90_summary_histogram->SetXTitle("|cos#theta|");
  h_1500_CT_wO_DR05_dphi_RMS90_summary_histogram->SetLineWidth(2);
  h_1500_CT_wO_DR05_dphi_RMS90_summary_histogram->SetLineColor(kCyan+1);
  h_1500_CT_wO_DR05_dphi_RMS90_summary_histogram->SetLineStyle(2);

  TH1F* h_1500_CT_wO_DR07_dphi_SigmaCB_summary_histogram=new TH1F("dphiRes_SigmaCBVsCosTheta_CT_wO_DR07_1500", "#sigma#Delta#phi(j_{reco},j_{true}) vs |cos#theta|", nRegionBinsAngles, pRegionBinEdgesAngles);
  h_1500_CT_wO_DR07_dphi_SigmaCB_summary_histogram ->SetYTitle("#sigma#Delta#phi(j_{reco},j_{true})");
  h_1500_CT_wO_DR07_dphi_SigmaCB_summary_histogram->SetXTitle("|cos#theta|");
  h_1500_CT_wO_DR07_dphi_SigmaCB_summary_histogram->SetLineWidth(2);
  h_1500_CT_wO_DR07_dphi_SigmaCB_summary_histogram->SetLineColor(kCyan+1);
  h_1500_CT_wO_DR07_dphi_SigmaCB_summary_histogram->SetLineStyle(2);

  TH1F* h_1500_CT_wO_DR07_dphi_RMS90_summary_histogram=new TH1F("dphiRes_RMS90VsCosTheta_CT_wO_DR07_1500", "RMS_{90} #Delta#phi(j_{reco},j_{true}) vs |cos#theta|", nRegionBinsAngles, pRegionBinEdgesAngles);
  h_1500_CT_wO_DR07_dphi_RMS90_summary_histogram ->SetYTitle("RMS_{90}#Delta#phi(j_{reco},j_{true})");
  h_1500_CT_wO_DR07_dphi_RMS90_summary_histogram->SetXTitle("|cos#theta|");
  h_1500_CT_wO_DR07_dphi_RMS90_summary_histogram->SetLineWidth(2);
  h_1500_CT_wO_DR07_dphi_RMS90_summary_histogram->SetLineColor(kCyan+1);
  h_1500_CT_wO_DR07_dphi_RMS90_summary_histogram->SetLineStyle(2);

  TH1F* h_1500_CT_wO_DR10_dphi_SigmaCB_summary_histogram=new TH1F("dphiRes_SigmaCBVsCosTheta_CT_wO_DR10_1500", "#sigma#Delta#phi(j_{reco},j_{true}) vs |cos#theta|", nRegionBinsAngles, pRegionBinEdgesAngles);
  h_1500_CT_wO_DR10_dphi_SigmaCB_summary_histogram ->SetYTitle("#sigma#Delta#phi(j_{reco},j_{true})");
  h_1500_CT_wO_DR10_dphi_SigmaCB_summary_histogram->SetXTitle("|cos#theta|");
  h_1500_CT_wO_DR10_dphi_SigmaCB_summary_histogram->SetLineWidth(2);
  h_1500_CT_wO_DR10_dphi_SigmaCB_summary_histogram->SetLineColor(kCyan+1);
  h_1500_CT_wO_DR10_dphi_SigmaCB_summary_histogram->SetLineStyle(2);

  TH1F* h_1500_CT_wO_DR10_dphi_RMS90_summary_histogram=new TH1F("dphiRes_RMS90VsCosTheta_CT_wO_DR10_1500", "RMS_{90} #Delta#phi(j_{reco},j_{true}) vs |cos#theta|", nRegionBinsAngles, pRegionBinEdgesAngles);
  h_1500_CT_wO_DR10_dphi_RMS90_summary_histogram ->SetYTitle("RMS_{90}#Delta#phi(j_{reco},j_{true})");
  h_1500_CT_wO_DR10_dphi_RMS90_summary_histogram->SetXTitle("|cos#theta|");
  h_1500_CT_wO_DR10_dphi_RMS90_summary_histogram->SetLineWidth(2);
  h_1500_CT_wO_DR10_dphi_RMS90_summary_histogram->SetLineColor(kCyan+1);
  h_1500_CT_wO_DR10_dphi_RMS90_summary_histogram->SetLineStyle(2);

  TH1F* h_1500_CT_wO_DR05_dtheta_SigmaCB_summary_histogram=new TH1F("dthetaRes_SigmaCBVsCosTheta_CT_wO_DR05_1500", "#sigma#Delta#theta(j_{reco},j_{true}) vs |cos#theta|", nRegionBinsAngles, pRegionBinEdgesAngles);
  h_1500_CT_wO_DR05_dtheta_SigmaCB_summary_histogram ->SetYTitle("#sigma#Delta#theta(j_{reco},j_{true})");
  h_1500_CT_wO_DR05_dtheta_SigmaCB_summary_histogram->SetXTitle("|cos#theta|");
  h_1500_CT_wO_DR05_dtheta_SigmaCB_summary_histogram->SetLineWidth(2);
  h_1500_CT_wO_DR05_dtheta_SigmaCB_summary_histogram->SetLineColor(kCyan+1);
  h_1500_CT_wO_DR05_dtheta_SigmaCB_summary_histogram->SetLineStyle(2);

  TH1F* h_1500_CT_wO_DR05_dtheta_RMS90_summary_histogram=new TH1F("dthetaRes_RMS90VsCosTheta_CT_wO_DR05_1500", "RMS_{90} #Delta#theta(j_{reco},j_{true}) vs |cos#theta|", nRegionBinsAngles, pRegionBinEdgesAngles);
  h_1500_CT_wO_DR05_dtheta_RMS90_summary_histogram ->SetYTitle("RMS_{90}#Delta#theta(j_{reco},j_{true})");
  h_1500_CT_wO_DR05_dtheta_RMS90_summary_histogram->SetXTitle("|cos#theta|");
  h_1500_CT_wO_DR05_dtheta_RMS90_summary_histogram->SetLineWidth(2);
  h_1500_CT_wO_DR05_dtheta_RMS90_summary_histogram->SetLineColor(kCyan+1);
  h_1500_CT_wO_DR05_dtheta_RMS90_summary_histogram->SetLineStyle(2);

  TH1F* h_1500_CT_wO_DR07_dtheta_SigmaCB_summary_histogram=new TH1F("dthetaRes_SigmaCBVsCosTheta_CT_wO_DR07_1500", "#sigma#Delta#theta(j_{reco},j_{true}) vs |cos#theta|", nRegionBinsAngles, pRegionBinEdgesAngles);
  h_1500_CT_wO_DR07_dtheta_SigmaCB_summary_histogram ->SetYTitle("#sigma#Delta#theta(j_{reco},j_{true})");
  h_1500_CT_wO_DR07_dtheta_SigmaCB_summary_histogram->SetXTitle("|cos#theta|");
  h_1500_CT_wO_DR07_dtheta_SigmaCB_summary_histogram->SetLineWidth(2);
  h_1500_CT_wO_DR07_dtheta_SigmaCB_summary_histogram->SetLineColor(kCyan+1);
  h_1500_CT_wO_DR07_dtheta_SigmaCB_summary_histogram->SetLineStyle(2);

  TH1F* h_1500_CT_wO_DR07_dtheta_RMS90_summary_histogram=new TH1F("dthetaRes_RMS90VsCosTheta_CT_wO_DR07_1500", "RMS_{90} #Delta#theta(j_{reco},j_{true}) vs |cos#theta|", nRegionBinsAngles, pRegionBinEdgesAngles);
  h_1500_CT_wO_DR07_dtheta_RMS90_summary_histogram ->SetYTitle("RMS_{90}#Delta#theta(j_{reco},j_{true})");
  h_1500_CT_wO_DR07_dtheta_RMS90_summary_histogram->SetXTitle("|cos#theta|");
  h_1500_CT_wO_DR07_dtheta_RMS90_summary_histogram->SetLineWidth(2);
  h_1500_CT_wO_DR07_dtheta_RMS90_summary_histogram->SetLineColor(kCyan+1);
  h_1500_CT_wO_DR07_dtheta_RMS90_summary_histogram->SetLineStyle(2);

  TH1F* h_1500_CT_wO_DR10_dtheta_SigmaCB_summary_histogram=new TH1F("dthetaRes_SigmaCBVsCosTheta_CT_wO_DR10_1500", "#sigma#Delta#theta(j_{reco},j_{true}) vs |cos#theta|", nRegionBinsAngles, pRegionBinEdgesAngles);
  h_1500_CT_wO_DR10_dtheta_SigmaCB_summary_histogram ->SetYTitle("#sigma#Delta#theta(j_{reco},j_{true})");
  h_1500_CT_wO_DR10_dtheta_SigmaCB_summary_histogram->SetXTitle("|cos#theta|");
  h_1500_CT_wO_DR10_dtheta_SigmaCB_summary_histogram->SetLineWidth(2);
  h_1500_CT_wO_DR10_dtheta_SigmaCB_summary_histogram->SetLineColor(kCyan+1);
  h_1500_CT_wO_DR10_dtheta_SigmaCB_summary_histogram->SetLineStyle(2);

  TH1F* h_1500_CT_wO_DR10_dtheta_RMS90_summary_histogram=new TH1F("dthetaRes_RMS90VsCosTheta_CT_wO_DR10_1500", "RMS_{90} #Delta#theta(j_{reco},j_{true}) vs |cos#theta|", nRegionBinsAngles, pRegionBinEdgesAngles);
  h_1500_CT_wO_DR10_dtheta_RMS90_summary_histogram ->SetYTitle("RMS_{90}#Delta#theta(j_{reco},j_{true})");
  h_1500_CT_wO_DR10_dtheta_RMS90_summary_histogram->SetXTitle("|cos#theta|");
  h_1500_CT_wO_DR10_dtheta_RMS90_summary_histogram->SetLineWidth(2);
  h_1500_CT_wO_DR10_dtheta_RMS90_summary_histogram->SetLineColor(kCyan+1);
  h_1500_CT_wO_DR10_dtheta_RMS90_summary_histogram->SetLineStyle(2);

  for(int i=137;i<161;i++){
//continue;
    std::cout<<"ang histo 1500 "<<i<<"]"<<std::endl;
   //double sided crystal ball
    TF1* fit_gaus_tmp = new TF1("fit_gaus_tmp", "gaus",-5.,5.);
    hist_vec_1500_CT_wO[i]->Fit("fit_gaus_tmp","R");
    hist_vec_1500_CT_wO[i]->GetFunction("fit_gaus_tmp");
    TF1* fdscb_tmp = new TF1("fdscb_tmp",fnc_dscb,-lim_angleDeg,lim_angleDeg,7);
   fdscb_tmp->SetNpx(2000);
    fdscb_tmp->SetParameter(0,fit_gaus_tmp->GetParameter(0));
    //norm
    fdscb_tmp->SetParLimits (0,0.5*fit_gaus_tmp->GetParameter(0),1.5*fit_gaus_tmp->GetParameter(0));
    fdscb_tmp->SetParameter(1,fit_gaus_tmp->GetParameter(1));
    //gaussian mean
    fdscb_tmp->SetParLimits (1,-2.,2.);
    fdscb_tmp->SetParameter(2,fit_gaus_tmp->GetParameter(2));
    fdscb_tmp->SetParLimits(2,fit_gaus_tmp->GetParameter(2)*0.50,1.50*fit_gaus_tmp->GetParameter(2));
    //std::vector<float>sigma2SFit=sigmaGaussianFits2Sigma(hist_vec_1500_CT_wO[i]);
    //fdscb_tmp->SetParameter(2,sigma2SFit[0]);
    //fdscb_tmp->SetParLimits(2,sigma2SFit[0]*0.50,1.50*sigma2SFit[0]);
    //-a1: parameter, from when the gaussian core should count
    //fdscb_tmp->SetParameter(2,fit_gaus_tmp->GetParameter(2));
    fdscb_tmp->SetParameter (3,3.0);
    fdscb_tmp->SetParLimits (3,0.0,10.0);
    //a2 parameter, up to when the gaussian core should count
    fdscb_tmp->SetParameter (5,3.0);
    fdscb_tmp->SetParLimits (5,0.0,10.0);
    fdscb_tmp->SetParameter(4,5.);
    fdscb_tmp->SetParLimits(4,0.,25.);
    fdscb_tmp->SetParameter(6,5.);
    fdscb_tmp->SetParLimits(6,0.,25.);
    int fitstatus(0); 
    fitstatus = hist_vec_1500_CT_wO[i]->Fit(fdscb_tmp,"R");
    fdscb_tmp = hist_vec_1500_CT_wO[i]->GetFunction("fdscb_tmp");
    resolutionTH1=0; 
    resolutionErrorTH1=0;
    meanTH1=0;
    meanErrorTH1=0;
    CalculatePerformanceNoMean( hist_vec_1500_CT_wO[i], resolutionTH1, resolutionErrorTH1,meanTH1,meanErrorTH1);
    int first_bin_ang=137;
    if(i<141){//dphi DR05
      first_bin_ang=137;
      h_1500_CT_wO_DR05_dphi_SigmaCB_summary_histogram->SetBinContent(i-first_bin_ang+1,fdscb_tmp->GetParameter(2));
      h_1500_CT_wO_DR05_dphi_SigmaCB_summary_histogram->SetBinError(i-first_bin_ang+1,fdscb_tmp->GetParError(2));
      h_1500_CT_wO_DR05_dphi_RMS90_summary_histogram->SetBinContent(i-first_bin_ang+1,resolutionTH1);
      h_1500_CT_wO_DR05_dphi_RMS90_summary_histogram->SetBinError(i-first_bin_ang+1, resolutionErrorTH1);
    }else if(i<145){//dtheta DR05
      first_bin_ang=141;
      h_1500_CT_wO_DR05_dtheta_SigmaCB_summary_histogram->SetBinContent(i-first_bin_ang+1,fdscb_tmp->GetParameter(2));
      h_1500_CT_wO_DR05_dtheta_SigmaCB_summary_histogram->SetBinError(i-first_bin_ang+1,fdscb_tmp->GetParError(2));
      h_1500_CT_wO_DR05_dtheta_RMS90_summary_histogram->SetBinContent(i-first_bin_ang+1,resolutionTH1);
      h_1500_CT_wO_DR05_dtheta_RMS90_summary_histogram->SetBinError(i-first_bin_ang+1, resolutionErrorTH1);
    }else if(i<149){//dphi DR07
      first_bin_ang=145;
      h_1500_CT_wO_DR07_dphi_SigmaCB_summary_histogram->SetBinContent(i-first_bin_ang+1,fdscb_tmp->GetParameter(2));
      h_1500_CT_wO_DR07_dphi_SigmaCB_summary_histogram->SetBinError(i-first_bin_ang+1,fdscb_tmp->GetParError(2));
      h_1500_CT_wO_DR07_dphi_RMS90_summary_histogram->SetBinContent(i-first_bin_ang+1,resolutionTH1);
      h_1500_CT_wO_DR07_dphi_RMS90_summary_histogram->SetBinError(i-first_bin_ang+1, resolutionErrorTH1);
    }else if(i<153){//dtheta DR07
      first_bin_ang=149;
      h_1500_CT_wO_DR07_dtheta_SigmaCB_summary_histogram->SetBinContent(i-first_bin_ang+1,fdscb_tmp->GetParameter(2));
      h_1500_CT_wO_DR07_dtheta_SigmaCB_summary_histogram->SetBinError(i-first_bin_ang+1,fdscb_tmp->GetParError(2));
      h_1500_CT_wO_DR07_dtheta_RMS90_summary_histogram->SetBinContent(i-first_bin_ang+1,resolutionTH1);
      h_1500_CT_wO_DR07_dtheta_RMS90_summary_histogram->SetBinError(i-first_bin_ang+1, resolutionErrorTH1);
    }else if(i<157){//dphi DR07
      first_bin_ang=153;
      h_1500_CT_wO_DR10_dphi_SigmaCB_summary_histogram->SetBinContent(i-first_bin_ang+1,fdscb_tmp->GetParameter(2));
      h_1500_CT_wO_DR10_dphi_SigmaCB_summary_histogram->SetBinError(i-first_bin_ang+1,fdscb_tmp->GetParError(2));
      h_1500_CT_wO_DR10_dphi_RMS90_summary_histogram->SetBinContent(i-first_bin_ang+1,resolutionTH1);
      h_1500_CT_wO_DR10_dphi_RMS90_summary_histogram->SetBinError(i-first_bin_ang+1, resolutionErrorTH1);
    }else if(i<161){//dtheta DR07
      first_bin_ang=157;
      h_1500_CT_wO_DR10_dtheta_SigmaCB_summary_histogram->SetBinContent(i-first_bin_ang+1,fdscb_tmp->GetParameter(2));
      h_1500_CT_wO_DR10_dtheta_SigmaCB_summary_histogram->SetBinError(i-first_bin_ang+1,fdscb_tmp->GetParError(2));
      h_1500_CT_wO_DR10_dtheta_RMS90_summary_histogram->SetBinContent(i-first_bin_ang+1,resolutionTH1);
      h_1500_CT_wO_DR10_dtheta_RMS90_summary_histogram->SetBinError(i-first_bin_ang+1, resolutionErrorTH1);
    }
  }

  TH1F* h_1500_CT_wO_DR05_E_SigmaCB_summary_histogram=new TH1F("JER_SigmaCBVsCosTheta_CT_wO_DR05_1500", "RMS_{90}(E_{j}^{reco}/E_{j}^{gen}) / Mean_{90}(E_{j}^{reco}/E_{j}^{gen}) vs |cos#theta|", nRegionBins, pRegionBinEdges);
  h_1500_CT_wO_DR05_E_SigmaCB_summary_histogram ->SetYTitle("#sigma(E_{j}) / E_{j} [%]");
  h_1500_CT_wO_DR05_E_SigmaCB_summary_histogram->SetXTitle("|cos#theta|");
  h_1500_CT_wO_DR05_E_SigmaCB_summary_histogram->SetLineWidth(2);
  h_1500_CT_wO_DR05_E_SigmaCB_summary_histogram->SetLineColor(kBlue);
  h_1500_CT_wO_DR05_E_SigmaCB_summary_histogram->SetLineStyle(2);
  TH1F* h_1500_CT_wO_DR05_E_RMS90_summary_histogram=new TH1F("JER_RMS90VsCosTheta_CT_wO_DR05_1500", "RMS_{90}(E_{j}^{reco}/E_{j}^{gen}) / Mean_{90}(E_{j}^{reco}/E_{j}^{gen}) vs |cos#theta|", nRegionBins, pRegionBinEdges);
  h_1500_CT_wO_DR05_E_RMS90_summary_histogram ->SetYTitle("RMS_{90}(E_{j}^{reco}/E_{j}^{gen}) / Mean_{90}(E_{j}^{reco}/E_{j}^{gen}) [%]");
  h_1500_CT_wO_DR05_E_RMS90_summary_histogram->SetXTitle("|cos#theta|");
  h_1500_CT_wO_DR05_E_RMS90_summary_histogram->SetLineWidth(2);
  h_1500_CT_wO_DR05_E_RMS90_summary_histogram->SetLineColor(kBlue);
  h_1500_CT_wO_DR05_E_RMS90_summary_histogram->SetLineStyle(2);

  TH1F* h_1500_CT_wO_DR05_E_RMS_summary_histogram=new TH1F("JER_RMSVsCosTheta_CT_wO_DR05_1500", "RMS(E_{j}) / Mean(E_{j}) vs |cos#theta|", nRegionBins, pRegionBinEdges);
  h_1500_CT_wO_DR05_E_RMS_summary_histogram ->SetYTitle("RMS(E_{j}) / Mean(E_{j}) [%]");
  h_1500_CT_wO_DR05_E_RMS_summary_histogram->SetXTitle("|cos#theta|");
  h_1500_CT_wO_DR05_E_RMS_summary_histogram->SetLineWidth(2);
  h_1500_CT_wO_DR05_E_RMS_summary_histogram->SetLineColor(kBlue);
  h_1500_CT_wO_DR05_E_RMS_summary_histogram->SetLineStyle(2);

  TH1F* h_1500_CT_wO_DR05_E_JER_Mean_summary_histogram=new TH1F("JER_MeanVsCosTheta_CT_wO_DR05_1500", "Mean(E_{tot}^{RECO}/E_{tot}^{true}) vs |cos#theta|", nRegionBins, pRegionBinEdges);
  h_1500_CT_wO_DR05_E_JER_Mean_summary_histogram->SetYTitle("Mean(E_{tot}^{RECO}/E_{tot}^{true})");
  h_1500_CT_wO_DR05_E_JER_Mean_summary_histogram->SetXTitle("|cos#theta|");
  h_1500_CT_wO_DR05_E_JER_Mean_summary_histogram->SetLineWidth(2);
  h_1500_CT_wO_DR05_E_JER_Mean_summary_histogram->SetLineColor(kBlue);
  h_1500_CT_wO_DR05_E_JER_Mean_summary_histogram->SetLineStyle(2);


  firstbin=59;
  for(int i=firstbin;i<(firstbin+13);i++){
//continue;
    resolutionTH1=0; 
    resolutionErrorTH1=0;
    meanTH1=0;
    meanErrorTH1=0;
    CalculatePerformance( hist_vec_1500_CT_wO[i], resolutionTH1, resolutionErrorTH1,meanTH1,meanErrorTH1);
    h_1500_CT_wO_DR05_E_RMS90_summary_histogram->SetBinContent(i-firstbin+1,resolutionTH1/sqrt(2.));
    h_1500_CT_wO_DR05_E_RMS90_summary_histogram ->SetBinError(i-firstbin+1, resolutionErrorTH1/sqrt(2.));
    h_1500_CT_wO_DR05_E_RMS_summary_histogram->SetBinContent(i-firstbin+1,hist_vec_1500_CT_wO[i]->GetRMS()*100. );
    h_1500_CT_wO_DR05_E_RMS_summary_histogram ->SetBinError(i-firstbin+1, hist_vec_1500_CT_wO[i]->GetRMSError()*100.);
    h_1500_CT_wO_DR05_E_JER_Mean_summary_histogram->SetBinContent(i-firstbin+1,hist_vec_1500_CT_wO[i]->GetMean());
    h_1500_CT_wO_DR05_E_JER_Mean_summary_histogram->SetBinError(i-firstbin+1,hist_vec_1500_CT_wO[i]->GetMeanError());
    //double sided crystal ball
    TF1* fit_gaus_tmp = new TF1("fit_gaus_tmp", "gaus",0.50,1.50);
    hist_vec_1500_CT_wO[i]->Fit("fit_gaus_tmp","R");
    hist_vec_1500_CT_wO[i]->GetFunction("fit_gaus_tmp");
    //std::vector<float>sigma_tmp=sigmaGaussianFits2Sigma(hist_vec_1500_CT[i]);
    TF1* fdscb_tmp = new TF1("fdscb_tmp",fnc_dscb,0.,3.,7);
    fdscb_tmp->SetNpx(1000);
    fdscb_tmp->SetParameter(0,fit_gaus_tmp->GetParameter(0));
    //norm
    fdscb_tmp->SetParLimits (0,0.5*fit_gaus_tmp->GetParameter(0),4.0*fit_gaus_tmp->GetParameter(0));
    fdscb_tmp->SetParameter(1,fit_gaus_tmp->GetParameter(1));
    //gaussian mean
    fdscb_tmp->SetParLimits (1,0.8,1.2);
    //fdscb_tmp->SetParameter(2,sigma_tmp[0]);
    //fdscb_tmp->SetParLimits(2,sigma_tmp[0]*0.20,5.*sigma_tmp[0]);
    fdscb_tmp->SetParLimits(2,fit_gaus_tmp->GetParameter(2)*0.50,1.50*fit_gaus_tmp->GetParameter(2));
    //-a1: parameter, from when the gaussian core should count
    fdscb_tmp->SetParameter(2,fit_gaus_tmp->GetParameter(2));
    fdscb_tmp->SetParameter (3,3.0);
    fdscb_tmp->SetParLimits (3,0.0,10.0);
    //a2 parameter, up to when the gaussian core should count
    fdscb_tmp->SetParameter (5,3.0);
    fdscb_tmp->SetParLimits (5,0.0,10.0);
    fdscb_tmp->SetParameter(4,5.);
    fdscb_tmp->SetParLimits(4,0.,25.);
    fdscb_tmp->SetParameter(6,5.);
    fdscb_tmp->SetParLimits(6,0.,25.);
    int fitstatus(0); 
    fitstatus = hist_vec_1500_CT_wO[i]->Fit(fdscb_tmp,"R");
    fdscb_tmp = hist_vec_1500_CT_wO[i]->GetFunction("fdscb_tmp");
    h_1500_CT_wO_DR05_E_SigmaCB_summary_histogram->SetBinContent(i-firstbin+1,fdscb_tmp->GetParameter(2)*100. );
    h_1500_CT_wO_DR05_E_SigmaCB_summary_histogram->SetBinError(i-firstbin+1,fdscb_tmp->GetParError(2)*100. );
  }  
  TH1F* h_1500_CT_wO_DR06_E_SigmaCB_summary_histogram=new TH1F("JER_SigmaCBVsCosTheta_CT_wO_DR06_1500", "RMS_{90}(E_{j}^{reco}/E_{j}^{gen}) / Mean_{90}(E_{j}^{reco}/E_{j}^{gen}) vs |cos#theta|", nRegionBins, pRegionBinEdges);
  h_1500_CT_wO_DR06_E_SigmaCB_summary_histogram ->SetYTitle("#sigma(E_{j}) / E_{j} [%]");
  h_1500_CT_wO_DR06_E_SigmaCB_summary_histogram->SetXTitle("|cos#theta|");
  h_1500_CT_wO_DR06_E_SigmaCB_summary_histogram->SetLineWidth(2);
  h_1500_CT_wO_DR06_E_SigmaCB_summary_histogram->SetLineColor(kBlue);
  h_1500_CT_wO_DR06_E_SigmaCB_summary_histogram->SetLineStyle(2);
  TH1F* h_1500_CT_wO_DR06_E_RMS90_summary_histogram=new TH1F("JER_RMS90VsCosTheta_CT_wO_DR06_1500", "RMS_{90}(E_{j}^{reco}/E_{j}^{gen}) / Mean_{90}(E_{j}^{reco}/E_{j}^{gen}) vs |cos#theta|", nRegionBins, pRegionBinEdges);
  h_1500_CT_wO_DR06_E_RMS90_summary_histogram ->SetYTitle("RMS_{90}(E_{j}^{reco}/E_{j}^{gen}) / Mean_{90}(E_{j}^{reco}/E_{j}^{gen}) [%]");
  h_1500_CT_wO_DR06_E_RMS90_summary_histogram->SetXTitle("|cos#theta|");
  h_1500_CT_wO_DR06_E_RMS90_summary_histogram->SetLineWidth(2);
  h_1500_CT_wO_DR06_E_RMS90_summary_histogram->SetLineColor(kBlue);
  h_1500_CT_wO_DR06_E_RMS90_summary_histogram->SetLineStyle(2);

  TH1F* h_1500_CT_wO_DR06_E_RMS_summary_histogram=new TH1F("JER_RMSVsCosTheta_CT_wO_DR06_1500", "RMS(E_{j}) / Mean(E_{j}) vs |cos#theta|", nRegionBins, pRegionBinEdges);
  h_1500_CT_wO_DR06_E_RMS_summary_histogram ->SetYTitle("RMS(E_{j}) / Mean(E_{j}) [%]");
  h_1500_CT_wO_DR06_E_RMS_summary_histogram->SetXTitle("|cos#theta|");
  h_1500_CT_wO_DR06_E_RMS_summary_histogram->SetLineWidth(2);
  h_1500_CT_wO_DR06_E_RMS_summary_histogram->SetLineColor(kBlue);
  h_1500_CT_wO_DR06_E_RMS_summary_histogram->SetLineStyle(2);

  TH1F* h_1500_CT_wO_DR06_E_JER_Mean_summary_histogram=new TH1F("JER_MeanVsCosTheta_CT_wO_DR06_1500", "Mean(E_{tot}^{RECO}/E_{tot}^{true}) vs |cos#theta|", nRegionBins, pRegionBinEdges);
  h_1500_CT_wO_DR06_E_JER_Mean_summary_histogram->SetYTitle("Mean(E_{tot}^{RECO}/E_{tot}^{true})");
  h_1500_CT_wO_DR06_E_JER_Mean_summary_histogram->SetXTitle("|cos#theta|");
  h_1500_CT_wO_DR06_E_JER_Mean_summary_histogram->SetLineWidth(2);
  h_1500_CT_wO_DR06_E_JER_Mean_summary_histogram->SetLineColor(kBlue);
  h_1500_CT_wO_DR06_E_JER_Mean_summary_histogram->SetLineStyle(2);
  firstbin=72;
  for(int i=firstbin;i<(firstbin+13);i++){
//continue;
    resolutionTH1=0; 
    resolutionErrorTH1=0;
    meanTH1=0;
    meanErrorTH1=0;
    CalculatePerformance( hist_vec_1500_CT_wO[i], resolutionTH1, resolutionErrorTH1,meanTH1,meanErrorTH1);
    h_1500_CT_wO_DR06_E_RMS90_summary_histogram->SetBinContent(i-firstbin+1,resolutionTH1/sqrt(2.));
    h_1500_CT_wO_DR06_E_RMS90_summary_histogram ->SetBinError(i-firstbin+1, resolutionErrorTH1/sqrt(2.));
    h_1500_CT_wO_DR06_E_RMS_summary_histogram->SetBinContent(i-firstbin+1,hist_vec_1500_CT_wO[i]->GetRMS()*100. );
    h_1500_CT_wO_DR06_E_RMS_summary_histogram ->SetBinError(i-firstbin+1, hist_vec_1500_CT_wO[i]->GetRMSError()*100.);
    h_1500_CT_wO_DR06_E_JER_Mean_summary_histogram->SetBinContent(i-firstbin+1,hist_vec_1500_CT_wO[i]->GetMean());
    h_1500_CT_wO_DR06_E_JER_Mean_summary_histogram->SetBinError(i-firstbin+1,hist_vec_1500_CT_wO[i]->GetMeanError());
    //double sided crystal ball
    TF1* fit_gaus_tmp = new TF1("fit_gaus_tmp", "gaus",0.50,1.50);
    hist_vec_1500_CT_wO[i]->Fit("fit_gaus_tmp","R");
    hist_vec_1500_CT_wO[i]->GetFunction("fit_gaus_tmp");

    TF1* fdscb_tmp = new TF1("fdscb_tmp",fnc_dscb,0.,3.,7);
    fdscb_tmp->SetNpx(1000);
    fdscb_tmp->SetParameter(0,fit_gaus_tmp->GetParameter(0));
    //norm
    fdscb_tmp->SetParLimits (0,0.5*fit_gaus_tmp->GetParameter(0),1.5*fit_gaus_tmp->GetParameter(0));
    fdscb_tmp->SetParameter(1,fit_gaus_tmp->GetParameter(1));
    //gaussian mean
    fdscb_tmp->SetParLimits (1,0.8,1.2);
    //fdscb_tmp->SetParameter(2,fit_gaus_tmp->GetParameter(2));
    //fdscb_tmp->SetParLimits(2,fit_gaus_tmp->GetParameter(2)*0.50,1.50*fit_gaus_tmp->GetParameter(2));
    std::vector<float>sigma2SFit=sigmaGaussianFits2Sigma(hist_vec_1500_CT_wO[i]);
    fdscb_tmp->SetParameter(2,sigma2SFit[0]);
    fdscb_tmp->SetParLimits(2,sigma2SFit[0]*0.50,1.50*sigma2SFit[0]);
    //-a1: parameter, from when the gaussian core should count
    fdscb_tmp->SetParameter(2,fit_gaus_tmp->GetParameter(2));
    fdscb_tmp->SetParameter (3,3.0);
    fdscb_tmp->SetParLimits (3,0.0,10.0);
    //a2 parameter, up to when the gaussian core should count
    fdscb_tmp->SetParameter (5,3.0);
    fdscb_tmp->SetParLimits (5,0.0,10.0);
    fdscb_tmp->SetParameter(4,5.);
    fdscb_tmp->SetParLimits(4,0.,25.);
    fdscb_tmp->SetParameter(6,5.);
    fdscb_tmp->SetParLimits(6,0.,25.);
    int fitstatus(0); 
    fitstatus = hist_vec_1500_CT_wO[i]->Fit(fdscb_tmp,"R");
    fdscb_tmp = hist_vec_1500_CT_wO[i]->GetFunction("fdscb_tmp");
    h_1500_CT_wO_DR06_E_SigmaCB_summary_histogram->SetBinContent(i-firstbin+1,fdscb_tmp->GetParameter(2)*100. );
    h_1500_CT_wO_DR06_E_SigmaCB_summary_histogram->SetBinError(i-firstbin+1,fdscb_tmp->GetParError(2)*100. );
  }  
  TH1F* h_1500_CT_wO_DR07_E_SigmaCB_summary_histogram=new TH1F("JER_SigmaCBVsCosTheta_CT_wO_DR07_1500", "RMS_{90}(E_{j}^{reco}/E_{j}^{gen}) / Mean_{90}(E_{j}^{reco}/E_{j}^{gen}) vs |cos#theta|", nRegionBins, pRegionBinEdges);
  h_1500_CT_wO_DR07_E_SigmaCB_summary_histogram ->SetYTitle("#sigma(E_{j}) / E_{j} [%]");
  h_1500_CT_wO_DR07_E_SigmaCB_summary_histogram->SetXTitle("|cos#theta|");
  h_1500_CT_wO_DR07_E_SigmaCB_summary_histogram->SetLineWidth(2);
  h_1500_CT_wO_DR07_E_SigmaCB_summary_histogram->SetLineColor(kBlue);
  h_1500_CT_wO_DR07_E_SigmaCB_summary_histogram->SetLineStyle(2);
  TH1F* h_1500_CT_wO_DR07_E_RMS90_summary_histogram=new TH1F("JER_RMS90VsCosTheta_CT_wO_DR07_1500", "RMS_{90}(E_{j}^{reco}/E_{j}^{gen}) / Mean_{90}(E_{j}^{reco}/E_{j}^{gen}) vs |cos#theta|", nRegionBins, pRegionBinEdges);
  h_1500_CT_wO_DR07_E_RMS90_summary_histogram ->SetYTitle("RMS_{90}(E_{j}^{reco}/E_{j}^{gen}) / Mean_{90}(E_{j}^{reco}/E_{j}^{gen}) [%]");
  h_1500_CT_wO_DR07_E_RMS90_summary_histogram->SetXTitle("|cos#theta|");
  h_1500_CT_wO_DR07_E_RMS90_summary_histogram->SetLineWidth(2);
  h_1500_CT_wO_DR07_E_RMS90_summary_histogram->SetLineColor(kBlue);
  h_1500_CT_wO_DR07_E_RMS90_summary_histogram->SetLineStyle(2);

  TH1F* h_1500_CT_wO_DR07_E_RMS_summary_histogram=new TH1F("JER_RMSVsCosTheta_CT_wO_DR07_1500", "RMS(E_{j}) / Mean(E_{j}) vs |cos#theta|", nRegionBins, pRegionBinEdges);
  h_1500_CT_wO_DR07_E_RMS_summary_histogram ->SetYTitle("RMS(E_{j}) / Mean(E_{j}) [%]");
  h_1500_CT_wO_DR07_E_RMS_summary_histogram->SetXTitle("|cos#theta|");
  h_1500_CT_wO_DR07_E_RMS_summary_histogram->SetLineWidth(2);
  h_1500_CT_wO_DR07_E_RMS_summary_histogram->SetLineColor(kBlue);
  h_1500_CT_wO_DR07_E_RMS_summary_histogram->SetLineStyle(2);

  TH1F* h_1500_CT_wO_DR07_E_JER_Mean_summary_histogram=new TH1F("JER_MeanVsCosTheta_CT_wO_DR07_1500", "Mean(E_{tot}^{RECO}/E_{tot}^{true}) vs |cos#theta|", nRegionBins, pRegionBinEdges);
  h_1500_CT_wO_DR07_E_JER_Mean_summary_histogram->SetYTitle("Mean(E_{tot}^{RECO}/E_{tot}^{true})");
  h_1500_CT_wO_DR07_E_JER_Mean_summary_histogram->SetXTitle("|cos#theta|");
  h_1500_CT_wO_DR07_E_JER_Mean_summary_histogram->SetLineWidth(2);
  h_1500_CT_wO_DR07_E_JER_Mean_summary_histogram->SetLineColor(kBlue);
  h_1500_CT_wO_DR07_E_JER_Mean_summary_histogram->SetLineStyle(2);
  firstbin=85;
  for(int i=firstbin;i<(firstbin+13);i++){
//continue;
    resolutionTH1=0; 
    resolutionErrorTH1=0;
    meanTH1=0;
    meanErrorTH1=0;
    CalculatePerformance( hist_vec_1500_CT_wO[i], resolutionTH1, resolutionErrorTH1,meanTH1,meanErrorTH1);
    h_1500_CT_wO_DR07_E_RMS90_summary_histogram->SetBinContent(i-firstbin+1,resolutionTH1/sqrt(2.));
    h_1500_CT_wO_DR07_E_RMS90_summary_histogram ->SetBinError(i-firstbin+1, resolutionErrorTH1/sqrt(2.));
    h_1500_CT_wO_DR07_E_RMS_summary_histogram->SetBinContent(i-firstbin+1,hist_vec_1500_CT_wO[i]->GetRMS()*100. );
    h_1500_CT_wO_DR07_E_RMS_summary_histogram ->SetBinError(i-firstbin+1, hist_vec_1500_CT_wO[i]->GetRMSError()*100.);
    h_1500_CT_wO_DR07_E_JER_Mean_summary_histogram->SetBinContent(i-firstbin+1,hist_vec_1500_CT_wO[i]->GetMean());
    h_1500_CT_wO_DR07_E_JER_Mean_summary_histogram->SetBinError(i-firstbin+1,hist_vec_1500_CT_wO[i]->GetMeanError());
    //double sided crystal ball
    //double sided crystal ball
    TF1* fit_gaus_tmp = new TF1("fit_gaus_tmp", "gaus",0.50,1.50);
    hist_vec_1500_CT_wO[i]->Fit("fit_gaus_tmp","R");
    hist_vec_1500_CT_wO[i]->GetFunction("fit_gaus_tmp");
    //std::vector<float>sigma_tmp=sigmaGaussianFits2Sigma(hist_vec_1500_CT_wO[i]);
    TF1* fdscb_tmp = new TF1("fdscb_tmp",fnc_dscb,0.,3.,7);
    fdscb_tmp->SetNpx(1000);
    fdscb_tmp->SetParameter(0,fit_gaus_tmp->GetParameter(0));
    //norm
    fdscb_tmp->SetParLimits (0,0.5*fit_gaus_tmp->GetParameter(0),1.5*fit_gaus_tmp->GetParameter(0));
    fdscb_tmp->SetParameter(1,fit_gaus_tmp->GetParameter(1));
    //gaussian mean
    fdscb_tmp->SetParLimits (1,0.8,1.2);
    //fdscb_tmp->SetParameter(2,sigma_tmp[0]);
    //fdscb_tmp->SetParLimits(2,sigma_tmp[0]*0.20,5.*sigma_tmp[0]);
    fdscb_tmp->SetParameter(2,fit_gaus_tmp->GetParameter(2));
    fdscb_tmp->SetParLimits(2,fit_gaus_tmp->GetParameter(2)*0.20,1.*fit_gaus_tmp->GetParameter(2));
    //-a1: parameter, from when the gaussian core should count
    fdscb_tmp->SetParameter (3,3.0);
    fdscb_tmp->SetParLimits (3,0.0,10.0);
    //a2 parameter, up to when the gaussian core should count
    fdscb_tmp->SetParameter (5,3.0);
    fdscb_tmp->SetParLimits (5,0.0,10.0);
    fdscb_tmp->SetParameter(4,5.);
    fdscb_tmp->SetParLimits(4,0.,25.);
    fdscb_tmp->SetParameter(6,5.);
    fdscb_tmp->SetParLimits(6,0.,25.);
    int fitstatus(0); 
    fitstatus = hist_vec_1500_CT_wO[i]->Fit(fdscb_tmp,"R");
    fdscb_tmp = hist_vec_1500_CT_wO[i]->GetFunction("fdscb_tmp");
    h_1500_CT_wO_DR07_E_SigmaCB_summary_histogram->SetBinContent(i-firstbin+1,fdscb_tmp->GetParameter(2)*100. );
    h_1500_CT_wO_DR07_E_SigmaCB_summary_histogram->SetBinError(i-firstbin+1,fdscb_tmp->GetParError(2)*100. );
  }  

  TH1F* h_1500_CT_wO_DR08_E_SigmaCB_summary_histogram=new TH1F("JER_SigmaCBVsCosTheta_CT_wO_DR08_1500", "RMS_{90}(E_{j}^{reco}/E_{j}^{gen}) / Mean_{90}(E_{j}^{reco}/E_{j}^{gen}) vs |cos#theta|", nRegionBins, pRegionBinEdges);
  h_1500_CT_wO_DR08_E_SigmaCB_summary_histogram ->SetYTitle("#sigma(E_{j}) / E_{j} [%]");
  h_1500_CT_wO_DR08_E_SigmaCB_summary_histogram->SetXTitle("|cos#theta|");
  h_1500_CT_wO_DR08_E_SigmaCB_summary_histogram->SetLineWidth(2);
  h_1500_CT_wO_DR08_E_SigmaCB_summary_histogram->SetLineColor(kBlue);
  h_1500_CT_wO_DR08_E_SigmaCB_summary_histogram->SetLineStyle(2);
  TH1F* h_1500_CT_wO_DR08_E_RMS90_summary_histogram=new TH1F("JER_RMS90VsCosTheta_CT_wO_DR08_1500", "RMS_{90}(E_{j}^{reco}/E_{j}^{gen}) / Mean_{90}(E_{j}^{reco}/E_{j}^{gen}) vs |cos#theta|", nRegionBins, pRegionBinEdges);
  h_1500_CT_wO_DR08_E_RMS90_summary_histogram ->SetYTitle("RMS_{90}(E_{j}^{reco}/E_{j}^{gen}) / Mean_{90}(E_{j}^{reco}/E_{j}^{gen}) [%]");
  h_1500_CT_wO_DR08_E_RMS90_summary_histogram->SetXTitle("|cos#theta|");
  h_1500_CT_wO_DR08_E_RMS90_summary_histogram->SetLineWidth(2);
  h_1500_CT_wO_DR08_E_RMS90_summary_histogram->SetLineColor(kBlue);
  h_1500_CT_wO_DR08_E_RMS90_summary_histogram->SetLineStyle(2);

  TH1F* h_1500_CT_wO_DR08_E_RMS_summary_histogram=new TH1F("JER_RMSVsCosTheta_CT_wO_DR08_1500", "RMS(E_{j}) / Mean(E_{j}) vs |cos#theta|", nRegionBins, pRegionBinEdges);
  h_1500_CT_wO_DR08_E_RMS_summary_histogram ->SetYTitle("RMS(E_{j}) / Mean(E_{j}) [%]");
  h_1500_CT_wO_DR08_E_RMS_summary_histogram->SetXTitle("|cos#theta|");
  h_1500_CT_wO_DR08_E_RMS_summary_histogram->SetLineWidth(2);
  h_1500_CT_wO_DR08_E_RMS_summary_histogram->SetLineColor(kBlue);
  h_1500_CT_wO_DR08_E_RMS_summary_histogram->SetLineStyle(2);

  TH1F* h_1500_CT_wO_DR08_E_JER_Mean_summary_histogram=new TH1F("JER_MeanVsCosTheta_CT_wO_DR08_1500", "Mean(E_{tot}^{RECO}/E_{tot}^{true}) vs |cos#theta|", nRegionBins, pRegionBinEdges);
  h_1500_CT_wO_DR08_E_JER_Mean_summary_histogram->SetYTitle("Mean(E_{tot}^{RECO}/E_{tot}^{true})");
  h_1500_CT_wO_DR08_E_JER_Mean_summary_histogram->SetXTitle("|cos#theta|");
  h_1500_CT_wO_DR08_E_JER_Mean_summary_histogram->SetLineWidth(2);
  h_1500_CT_wO_DR08_E_JER_Mean_summary_histogram->SetLineColor(kBlue);
  h_1500_CT_wO_DR08_E_JER_Mean_summary_histogram->SetLineStyle(2);
  firstbin=98;
  for(int i=firstbin;i<(firstbin+13);i++){
//continue;
    resolutionTH1=0; 
    resolutionErrorTH1=0;
    meanTH1=0;
    meanErrorTH1=0;
    CalculatePerformance( hist_vec_1500_CT_wO[i], resolutionTH1, resolutionErrorTH1,meanTH1,meanErrorTH1);
    h_1500_CT_wO_DR08_E_RMS90_summary_histogram->SetBinContent(i-firstbin+1,resolutionTH1/sqrt(2.));
    h_1500_CT_wO_DR08_E_RMS90_summary_histogram ->SetBinError(i-firstbin+1, resolutionErrorTH1/sqrt(2.));
    h_1500_CT_wO_DR08_E_RMS_summary_histogram->SetBinContent(i-firstbin+1,hist_vec_1500_CT_wO[i]->GetRMS()*100. );
    h_1500_CT_wO_DR08_E_RMS_summary_histogram ->SetBinError(i-firstbin+1, hist_vec_1500_CT_wO[i]->GetRMSError()*100.);
    h_1500_CT_wO_DR08_E_JER_Mean_summary_histogram->SetBinContent(i-firstbin+1,hist_vec_1500_CT_wO[i]->GetMean());
    h_1500_CT_wO_DR08_E_JER_Mean_summary_histogram->SetBinError(i-firstbin+1,hist_vec_1500_CT_wO[i]->GetMeanError());
    //double sided crystal ball
    TF1* fit_gaus_tmp = new TF1("fit_gaus_tmp", "gaus",0.50,1.50);
    hist_vec_1500_CT_wO[i]->Fit("fit_gaus_tmp","R");
    hist_vec_1500_CT_wO[i]->GetFunction("fit_gaus_tmp");
    //std::vector<float>sigma_tmp=sigmaGaussianFits2Sigma(hist_vec_1500_CT_wO[i]);
    TF1* fdscb_tmp = new TF1("fdscb_tmp",fnc_dscb,0.,3.,7);
    fdscb_tmp->SetNpx(1000);
    fdscb_tmp->SetParameter(0,fit_gaus_tmp->GetParameter(0));
    //norm
    fdscb_tmp->SetParLimits (0,0.1*fit_gaus_tmp->GetParameter(0),5.0*fit_gaus_tmp->GetParameter(0));
    fdscb_tmp->SetParameter(1,fit_gaus_tmp->GetParameter(1));
    //gaussian mean
    fdscb_tmp->SetParLimits (1,0.8,1.2);
    //fdscb_tmp->SetParameter(2,sigma_tmp[0]);
    //fdscb_tmp->SetParLimits(2,sigma_tmp[0]*0.10,1.*sigma_tmp[0]);
    fdscb_tmp->SetParLimits(2,fit_gaus_tmp->GetParameter(2)*0.50,1.50*fit_gaus_tmp->GetParameter(2));
    //-a1: parameter, from when the gaussian core should count
    fdscb_tmp->SetParameter(2,fit_gaus_tmp->GetParameter(2));
    fdscb_tmp->SetParameter (3,3.0);
    fdscb_tmp->SetParLimits (3,0.0,10.0);
    //a2 parameter, up to when the gaussian core should count
    fdscb_tmp->SetParameter (5,3.0);
    fdscb_tmp->SetParLimits (5,0.0,10.0);
    fdscb_tmp->SetParameter(4,5.);
    fdscb_tmp->SetParLimits(4,0.,25.);
    fdscb_tmp->SetParameter(6,5.);
    fdscb_tmp->SetParLimits(6,0.,25.);
    int fitstatus(0); 
    fitstatus = hist_vec_1500_CT_wO[i]->Fit(fdscb_tmp,"R");
    fdscb_tmp = hist_vec_1500_CT_wO[i]->GetFunction("fdscb_tmp");
    h_1500_CT_wO_DR08_E_SigmaCB_summary_histogram->SetBinContent(i-firstbin+1,fdscb_tmp->GetParameter(2)*100. );
    h_1500_CT_wO_DR08_E_SigmaCB_summary_histogram->SetBinError(i-firstbin+1,fdscb_tmp->GetParError(2)*100. );
  }  
  TH1F* h_1500_CT_wO_DR09_E_SigmaCB_summary_histogram=new TH1F("JER_SigmaCBVsCosTheta_CT_wO_DR09_1500", "RMS_{90}(E_{j}^{reco}/E_{j}^{gen}) / Mean_{90}(E_{j}^{reco}/E_{j}^{gen}) vs |cos#theta|", nRegionBins, pRegionBinEdges);
  h_1500_CT_wO_DR09_E_SigmaCB_summary_histogram ->SetYTitle("#sigma(E_{j}) / E_{j} [%]");
  h_1500_CT_wO_DR09_E_SigmaCB_summary_histogram->SetXTitle("|cos#theta|");
  h_1500_CT_wO_DR09_E_SigmaCB_summary_histogram->SetLineWidth(2);
  h_1500_CT_wO_DR09_E_SigmaCB_summary_histogram->SetLineColor(kBlue);
  h_1500_CT_wO_DR09_E_SigmaCB_summary_histogram->SetLineStyle(2);
  TH1F* h_1500_CT_wO_DR09_E_RMS90_summary_histogram=new TH1F("JER_RMS90VsCosTheta_CT_wO_DR09_1500", "RMS_{90}(E_{j}^{reco}/E_{j}^{gen}) / Mean_{90}(E_{j}^{reco}/E_{j}^{gen}) vs |cos#theta|", nRegionBins, pRegionBinEdges);
  h_1500_CT_wO_DR09_E_RMS90_summary_histogram ->SetYTitle("RMS_{90}(E_{j}^{reco}/E_{j}^{gen}) / Mean_{90}(E_{j}^{reco}/E_{j}^{gen}) [%]");
  h_1500_CT_wO_DR09_E_RMS90_summary_histogram->SetXTitle("|cos#theta|");
  h_1500_CT_wO_DR09_E_RMS90_summary_histogram->SetLineWidth(2);
  h_1500_CT_wO_DR09_E_RMS90_summary_histogram->SetLineColor(kBlue);
  h_1500_CT_wO_DR09_E_RMS90_summary_histogram->SetLineStyle(2);

  TH1F* h_1500_CT_wO_DR09_E_RMS_summary_histogram=new TH1F("JER_RMSVsCosTheta_CT_wO_DR09_1500", "RMS(E_{j}) / Mean(E_{j}) vs |cos#theta|", nRegionBins, pRegionBinEdges);
  h_1500_CT_wO_DR09_E_RMS_summary_histogram ->SetYTitle("RMS(E_{j}) / Mean(E_{j}) [%]");
  h_1500_CT_wO_DR09_E_RMS_summary_histogram->SetXTitle("|cos#theta|");
  h_1500_CT_wO_DR09_E_RMS_summary_histogram->SetLineWidth(2);
  h_1500_CT_wO_DR09_E_RMS_summary_histogram->SetLineColor(kBlue);
  h_1500_CT_wO_DR09_E_RMS_summary_histogram->SetLineStyle(2);

  TH1F* h_1500_CT_wO_DR09_E_JER_Mean_summary_histogram=new TH1F("JER_MeanVsCosTheta_CT_wO_DR09_1500", "Mean(E_{tot}^{RECO}/E_{tot}^{true}) vs |cos#theta|", nRegionBins, pRegionBinEdges);
  h_1500_CT_wO_DR09_E_JER_Mean_summary_histogram->SetYTitle("Mean(E_{tot}^{RECO}/E_{tot}^{true})");
  h_1500_CT_wO_DR09_E_JER_Mean_summary_histogram->SetXTitle("|cos#theta|");
  h_1500_CT_wO_DR09_E_JER_Mean_summary_histogram->SetLineWidth(2);
  h_1500_CT_wO_DR09_E_JER_Mean_summary_histogram->SetLineColor(kBlue);
  h_1500_CT_wO_DR09_E_JER_Mean_summary_histogram->SetLineStyle(2);
  firstbin=111;
  for(int i=firstbin;i<(firstbin+13);i++){
//continue;
    resolutionTH1=0; 
    resolutionErrorTH1=0;
    meanTH1=0;
    meanErrorTH1=0;
    CalculatePerformance( hist_vec_1500_CT_wO[i], resolutionTH1, resolutionErrorTH1,meanTH1,meanErrorTH1);
    h_1500_CT_wO_DR09_E_RMS90_summary_histogram->SetBinContent(i-firstbin+1,resolutionTH1/sqrt(2.));
    h_1500_CT_wO_DR09_E_RMS90_summary_histogram ->SetBinError(i-firstbin+1, resolutionErrorTH1/sqrt(2.));
    h_1500_CT_wO_DR09_E_RMS_summary_histogram->SetBinContent(i-firstbin+1,hist_vec_1500_CT_wO[i]->GetRMS()*100. );
    h_1500_CT_wO_DR09_E_RMS_summary_histogram ->SetBinError(i-firstbin+1, hist_vec_1500_CT_wO[i]->GetRMSError()*100.);
    h_1500_CT_wO_DR09_E_JER_Mean_summary_histogram->SetBinContent(i-firstbin+1,hist_vec_1500_CT_wO[i]->GetMean());
    h_1500_CT_wO_DR09_E_JER_Mean_summary_histogram->SetBinError(i-firstbin+1,hist_vec_1500_CT_wO[i]->GetMeanError());
    //double sided crystal ball
    TF1* fit_gaus_tmp = new TF1("fit_gaus_tmp", "gaus",0.50,1.50);
    hist_vec_1500_CT_wO[i]->Fit("fit_gaus_tmp","R");
    hist_vec_1500_CT_wO[i]->GetFunction("fit_gaus_tmp");

    TF1* fdscb_tmp = new TF1("fdscb_tmp",fnc_dscb,0.,3.,7);
   fdscb_tmp->SetNpx(1000);
    fdscb_tmp->SetParameter(0,fit_gaus_tmp->GetParameter(0));
    //norm
    fdscb_tmp->SetParLimits (0,0.5*fit_gaus_tmp->GetParameter(0),5.0*fit_gaus_tmp->GetParameter(0));
    fdscb_tmp->SetParameter(1,fit_gaus_tmp->GetParameter(1));
    //gaussian mean
    fdscb_tmp->SetParLimits (1,0.8,1.2);
    fdscb_tmp->SetParameter(2,fit_gaus_tmp->GetParameter(2));
    fdscb_tmp->SetParLimits(2,fit_gaus_tmp->GetParameter(2)*0.20,1.*fit_gaus_tmp->GetParameter(2));
    //-a1: parameter, from when the gaussian core should count
    fdscb_tmp->SetParameter(2,fit_gaus_tmp->GetParameter(2));
    fdscb_tmp->SetParameter (3,3.0);
    fdscb_tmp->SetParLimits (3,0.0,10.0);
    //a2 parameter, up to when the gaussian core should count
    fdscb_tmp->SetParameter (5,3.0);
    fdscb_tmp->SetParLimits (5,0.0,10.0);
    fdscb_tmp->SetParameter(4,5.);
    fdscb_tmp->SetParLimits(4,0.,25.);
    fdscb_tmp->SetParameter(6,5.);
    fdscb_tmp->SetParLimits(6,0.,25.);
    int fitstatus(0); 
    fitstatus = hist_vec_1500_CT_wO[i]->Fit(fdscb_tmp,"R");
    fdscb_tmp = hist_vec_1500_CT_wO[i]->GetFunction("fdscb_tmp");
    h_1500_CT_wO_DR09_E_SigmaCB_summary_histogram->SetBinContent(i-firstbin+1,fdscb_tmp->GetParameter(2)*100. );
    h_1500_CT_wO_DR09_E_SigmaCB_summary_histogram->SetBinError(i-firstbin+1,fdscb_tmp->GetParError(2)*100. );
  }  
  TH1F* h_1500_CT_wO_DR10_E_SigmaCB_summary_histogram=new TH1F("JER_SigmaCBVsCosTheta_CT_wO_DR10_1500", "RMS_{90}(E_{j}^{reco}/E_{j}^{gen}) / Mean_{90}(E_{j}^{reco}/E_{j}^{gen}) vs |cos#theta|", nRegionBins, pRegionBinEdges);
  h_1500_CT_wO_DR10_E_SigmaCB_summary_histogram ->SetYTitle("#sigma(E_{j}) / E_{j} [%]");
  h_1500_CT_wO_DR10_E_SigmaCB_summary_histogram->SetXTitle("|cos#theta|");
  h_1500_CT_wO_DR10_E_SigmaCB_summary_histogram->SetLineWidth(2);
  h_1500_CT_wO_DR10_E_SigmaCB_summary_histogram->SetLineColor(kBlue);
  h_1500_CT_wO_DR10_E_SigmaCB_summary_histogram->SetLineStyle(2);
  TH1F* h_1500_CT_wO_DR10_E_RMS90_summary_histogram=new TH1F("JER_RMS90VsCosTheta_CT_wO_DR10_1500", "RMS_{90}(E_{j}^{reco}/E_{j}^{gen}) / Mean_{90}(E_{j}^{reco}/E_{j}^{gen}) vs |cos#theta|", nRegionBins, pRegionBinEdges);
  h_1500_CT_wO_DR10_E_RMS90_summary_histogram ->SetYTitle("RMS_{90}(E_{j}^{reco}/E_{j}^{gen}) / Mean_{90}(E_{j}^{reco}/E_{j}^{gen}) [%]");
  h_1500_CT_wO_DR10_E_RMS90_summary_histogram->SetXTitle("|cos#theta|");
  h_1500_CT_wO_DR10_E_RMS90_summary_histogram->SetLineWidth(2);
  h_1500_CT_wO_DR10_E_RMS90_summary_histogram->SetLineColor(kBlue);
  h_1500_CT_wO_DR10_E_RMS90_summary_histogram->SetLineStyle(2);

  TH1F* h_1500_CT_wO_DR10_E_RMS_summary_histogram=new TH1F("JER_RMSVsCosTheta_CT_wO_DR10_1500", "RMS(E_{j}) / Mean(E_{j}) vs |cos#theta|", nRegionBins, pRegionBinEdges);
  h_1500_CT_wO_DR10_E_RMS_summary_histogram ->SetYTitle("RMS(E_{j}) / Mean(E_{j}) [%]");
  h_1500_CT_wO_DR10_E_RMS_summary_histogram->SetXTitle("|cos#theta|");
  h_1500_CT_wO_DR10_E_RMS_summary_histogram->SetLineWidth(2);
  h_1500_CT_wO_DR10_E_RMS_summary_histogram->SetLineColor(kBlue);
  h_1500_CT_wO_DR10_E_RMS_summary_histogram->SetLineStyle(2);

  TH1F* h_1500_CT_wO_DR10_E_JER_Mean_summary_histogram=new TH1F("JER_MeanVsCosTheta_CT_wO_DR10_1500", "Mean(E_{tot}^{RECO}/E_{tot}^{true}) vs |cos#theta|", nRegionBins, pRegionBinEdges);
  h_1500_CT_wO_DR10_E_JER_Mean_summary_histogram->SetYTitle("Mean(E_{tot}^{RECO}/E_{tot}^{true})");
  h_1500_CT_wO_DR10_E_JER_Mean_summary_histogram->SetXTitle("|cos#theta|");
  h_1500_CT_wO_DR10_E_JER_Mean_summary_histogram->SetLineWidth(2);
  h_1500_CT_wO_DR10_E_JER_Mean_summary_histogram->SetLineColor(kBlue);
  h_1500_CT_wO_DR10_E_JER_Mean_summary_histogram->SetLineStyle(2);
  firstbin=124;
  for(int i=firstbin;i<(firstbin+13);i++){
//continue;
    resolutionTH1=0; 
    resolutionErrorTH1=0;
    meanTH1=0;
    meanErrorTH1=0;
    CalculatePerformance( hist_vec_1500_CT_wO[i], resolutionTH1, resolutionErrorTH1,meanTH1,meanErrorTH1);
    h_1500_CT_wO_DR10_E_RMS90_summary_histogram->SetBinContent(i-firstbin+1,resolutionTH1/sqrt(2.));
    h_1500_CT_wO_DR10_E_RMS90_summary_histogram ->SetBinError(i-firstbin+1, resolutionErrorTH1/sqrt(2.));
    h_1500_CT_wO_DR10_E_RMS_summary_histogram->SetBinContent(i-firstbin+1,hist_vec_1500_CT_wO[i]->GetRMS()*100. );
    h_1500_CT_wO_DR10_E_RMS_summary_histogram ->SetBinError(i-firstbin+1, hist_vec_1500_CT_wO[i]->GetRMSError()*100.);
    h_1500_CT_wO_DR10_E_JER_Mean_summary_histogram->SetBinContent(i-firstbin+1,hist_vec_1500_CT_wO[i]->GetMean());
    h_1500_CT_wO_DR10_E_JER_Mean_summary_histogram->SetBinError(i-firstbin+1,hist_vec_1500_CT_wO[i]->GetMeanError());
    //double sided crystal ball
    TF1* fit_gaus_tmp = new TF1("fit_gaus_tmp", "gaus",0.50,1.50);
    hist_vec_1500_CT_wO[i]->Fit("fit_gaus_tmp","R");
    hist_vec_1500_CT_wO[i]->GetFunction("fit_gaus_tmp");

    TF1* fdscb_tmp = new TF1("fdscb_tmp",fnc_dscb,0.,3.,7);
    fdscb_tmp->SetNpx(1000);
    fdscb_tmp->SetParameter(0,fit_gaus_tmp->GetParameter(0));
    //norm
    fdscb_tmp->SetParLimits (0,0.5*fit_gaus_tmp->GetParameter(0),1.5*fit_gaus_tmp->GetParameter(0));
    fdscb_tmp->SetParameter(1,fit_gaus_tmp->GetParameter(1));
    //gaussian mean
    fdscb_tmp->SetParLimits (1,0.8,1.2);
    //fdscb_tmp->SetParameter(2,fit_gaus_tmp->GetParameter(2));
    //fdscb_tmp->SetParLimits(2,fit_gaus_tmp->GetParameter(2)*0.50,1.50*fit_gaus_tmp->GetParameter(2));
    std::vector<float>sigma2SFit=sigmaGaussianFits2Sigma(hist_vec_1500_CT_wO[i]);
    fdscb_tmp->SetParameter(2,sigma2SFit[0]);
    fdscb_tmp->SetParLimits(2,sigma2SFit[0]*0.50,1.50*sigma2SFit[0]);
    //-a1: parameter, from when the gaussian core should count
    fdscb_tmp->SetParameter(2,fit_gaus_tmp->GetParameter(2));
    fdscb_tmp->SetParameter (3,3.0);
    fdscb_tmp->SetParLimits (3,0.0,10.0);
    //a2 parameter, up to when the gaussian core should count
    fdscb_tmp->SetParameter (5,3.0);
    fdscb_tmp->SetParLimits (5,0.0,10.0);
    fdscb_tmp->SetParameter(4,5.);
    fdscb_tmp->SetParLimits(4,0.,25.);
    fdscb_tmp->SetParameter(6,5.);
    fdscb_tmp->SetParLimits(6,0.,25.);
    int fitstatus(0); 
    fitstatus = hist_vec_1500_CT_wO[i]->Fit(fdscb_tmp,"R");
    fdscb_tmp = hist_vec_1500_CT_wO[i]->GetFunction("fdscb_tmp");
    h_1500_CT_wO_DR10_E_SigmaCB_summary_histogram->SetBinContent(i-firstbin+1,fdscb_tmp->GetParameter(2)*100. );
    h_1500_CT_wO_DR10_E_SigmaCB_summary_histogram->SetBinError(i-firstbin+1,fdscb_tmp->GetParError(2)*100. );
  }  

  std::cout<<"1500 wO 03/04/05/06 "<< calculate_over90(h_1500_CT_wO_recojet03_E1_E2_over_E_True)<<"/"<< calculate_over90(h_1500_CT_wO_recojet04_E1_E2_over_E_True)<<"/"<< calculate_over90(h_1500_CT_wO_recojet05_E1_E2_over_E_True)<<"/"<<calculate_over90(h_1500_CT_wO_recojet06_E1_E2_over_E_True)<<" 07/08/09/10 "<< calculate_over90(h_1500_CT_wO_recojet07_E1_E2_over_E_True)<<"/"<< calculate_over90(h_1500_CT_wO_recojet08_E1_E2_over_E_True)<<"/"<< calculate_over90(h_1500_CT_wO_recojet09_E1_E2_over_E_True)<<"/"<<calculate_over90(h_1500_CT_wO_recojet10_E1_E2_over_E_True)<<std::endl;
  std::cout<<"jet histos 1500 CT_wO filled"<<std::endl;

  TH1F* h_3000_CT_genjet03_dphi_j1j2 =  new TH1F("h_3000_CT_genjet03_dphi_j1j2","", n_bins100, 0.5,TMath::Pi());
  TH1F* h_3000_CT_genjet03_E1_E2_over_E_True =  new TH1F("h_3000_CT_genjet03_E1_E2_over_E_True","", n_bins100, 0.5,1.00);
  TH1F* h_3000_CT_genjet03_Delta_E1_E2_over_E12 =  new TH1F("h_3000_CT_genjet03_Delta_E1_E2_over_E12","", n_bins100, -0.5,0.5);
  TH1F* h_3000_CT_genjet04_dphi_j1j2 =  new TH1F("h_3000_CT_genjet04_dphi_j1j2","", n_bins100, 0.5,TMath::Pi());
  TH1F* h_3000_CT_genjet04_E1_E2_over_E_True =  new TH1F("h_3000_CT_genjet04_E1_E2_over_E_True","", n_bins100, 0.5,1.00);
  TH1F* h_3000_CT_genjet04_Delta_E1_E2_over_E12 =  new TH1F("h_3000_CT_genjet04_Delta_E1_E2_over_E12","", n_bins100, -0.5,0.5);
  TH1F* h_3000_CT_genjet05_dphi_j1j2 =  new TH1F("h_3000_CT_genjet05_dphi_j1j2","", n_bins100, 0.5,TMath::Pi());
  TH1F* h_3000_CT_genjet05_E1_E2_over_E_True =  new TH1F("h_3000_CT_genjet05_E1_E2_over_E_True","", n_bins100, 0.5,1.00);
  TH1F* h_3000_CT_genjet05_Delta_E1_E2_over_E12 =  new TH1F("h_3000_CT_genjet05_Delta_E1_E2_over_E12","", n_bins100, -0.5,0.5);
  TH1F* h_3000_CT_genjet06_dphi_j1j2 =  new TH1F("h_3000_CT_genjet06_dphi_j1j2","", n_bins100, 0.5,TMath::Pi());
  TH1F* h_3000_CT_genjet06_E1_E2_over_E_True =  new TH1F("h_3000_CT_genjet06_E1_E2_over_E_True","", n_bins100, 0.5,1.00);
  TH1F* h_3000_CT_genjet06_Delta_E1_E2_over_E12 =  new TH1F("h_3000_CT_genjet06_Delta_E1_E2_over_E12","", n_bins100, -0.5,0.5);
  TH1F* h_3000_CT_genjet07_dphi_j1j2 =  new TH1F("h_3000_CT_genjet07_dphi_j1j2","", n_bins100, 0.5,TMath::Pi());
  TH1F* h_3000_CT_genjet07_E1_E2_over_E_True =  new TH1F("h_3000_CT_genjet07_E1_E2_over_E_True","", n_bins100, 0.5,1.00);
  TH1F* h_3000_CT_genjet07_Delta_E1_E2_over_E12 =  new TH1F("h_3000_CT_genjet07_Delta_E1_E2_over_E12","", n_bins100, -0.5,0.5);
  TH1F* h_3000_CT_genjet08_dphi_j1j2 =  new TH1F("h_3000_CT_genjet08_dphi_j1j2","", n_bins100, 0.5,TMath::Pi());
  TH1F* h_3000_CT_genjet08_E1_E2_over_E_True =  new TH1F("h_3000_CT_genjet08_E1_E2_over_E_True","", n_bins100, 0.5,1.00);
  TH1F* h_3000_CT_genjet08_Delta_E1_E2_over_E12 =  new TH1F("h_3000_CT_genjet08_Delta_E1_E2_over_E12","", n_bins100, -0.5,0.5);
  TH1F* h_3000_CT_genjet09_dphi_j1j2 =  new TH1F("h_3000_CT_genjet09_dphi_j1j2","", n_bins100, 0.5,TMath::Pi());
  TH1F* h_3000_CT_genjet09_E1_E2_over_E_True =  new TH1F("h_3000_CT_genjet09_E1_E2_over_E_True","", n_bins100, 0.5,1.00);
  TH1F* h_3000_CT_genjet09_Delta_E1_E2_over_E12 =  new TH1F("h_3000_CT_genjet09_Delta_E1_E2_over_E12","", n_bins100, -0.5,0.5);
  TH1F* h_3000_CT_genjet10_dphi_j1j2 =  new TH1F("h_3000_CT_genjet10_dphi_j1j2","", n_bins100, 0.5,TMath::Pi());
  TH1F* h_3000_CT_genjet10_E1_E2_over_E_True =  new TH1F("h_3000_CT_genjet10_E1_E2_over_E_True","", n_bins100, 0.5,1.00);
  TH1F* h_3000_CT_genjet10_Delta_E1_E2_over_E12 =  new TH1F("h_3000_CT_genjet10_Delta_E1_E2_over_E12","", n_bins100, -0.5,0.5);

  TH1F* h_3000_CT_recojet03_dphi_j1j2 =  new TH1F("h_3000_CT_recojet03_dphi_j1j2","", n_bins100, 0.5,TMath::Pi());
  TH1F* h_3000_CT_recojet03_E1_E2_over_E_True =  new TH1F("h_3000_CT_recojet03_E1_E2_over_E_True","", n_bins100, 0.5,1.00);
  TH1F* h_3000_CT_recojet03_Delta_E1_E2_over_E12 =  new TH1F("h_3000_CT_recojet03_Delta_E1_E2_over_E12","", n_bins100, -0.5,0.5);
  TH1F* h_3000_CT_recojet04_dphi_j1j2 =  new TH1F("h_3000_CT_recojet04_dphi_j1j2","", n_bins100, 0.5,TMath::Pi());
  TH1F* h_3000_CT_recojet04_E1_E2_over_E_True =  new TH1F("h_3000_CT_recojet04_E1_E2_over_E_True","", n_bins100, 0.5,1.00);
  TH1F* h_3000_CT_recojet04_Delta_E1_E2_over_E12 =  new TH1F("h_3000_CT_recojet04_Delta_E1_E2_over_E12","", n_bins100, -0.5,0.5);
  TH1F* h_3000_CT_recojet05_dphi_j1j2 =  new TH1F("h_3000_CT_recojet05_dphi_j1j2","", n_bins100, 0.5,TMath::Pi());
  TH1F* h_3000_CT_recojet05_E1_E2_over_E_True =  new TH1F("h_3000_CT_recojet05_E1_E2_over_E_True","", n_bins100, 0.5,1.00);
  TH1F* h_3000_CT_recojet05_Delta_E1_E2_over_E12 =  new TH1F("h_3000_CT_recojet05_Delta_E1_E2_over_E12","", n_bins100, -0.5,0.5);
  TH1F* h_3000_CT_recojet06_dphi_j1j2 =  new TH1F("h_3000_CT_recojet06_dphi_j1j2","", n_bins100, 0.5,TMath::Pi());
  TH1F* h_3000_CT_recojet06_E1_E2_over_E_True =  new TH1F("h_3000_CT_recojet06_E1_E2_over_E_True","", n_bins100, 0.5,1.00);
  TH1F* h_3000_CT_recojet06_Delta_E1_E2_over_E12 =  new TH1F("h_3000_CT_recojet06_Delta_E1_E2_over_E12","", n_bins100, -0.5,0.5);
  TH1F* h_3000_CT_recojet07_dphi_j1j2 =  new TH1F("h_3000_CT_recojet07_dphi_j1j2","", n_bins100, 0.5,TMath::Pi());
  TH1F* h_3000_CT_recojet07_E1_E2_over_E_True =  new TH1F("h_3000_CT_recojet07_E1_E2_over_E_True","", n_bins100, 0.5,1.00);
  TH1F* h_3000_CT_recojet07_Delta_E1_E2_over_E12 =  new TH1F("h_3000_CT_recojet07_Delta_E1_E2_over_E12","", n_bins100, -0.5,0.5);
  TH1F* h_3000_CT_recojet08_dphi_j1j2 =  new TH1F("h_3000_CT_recojet08_dphi_j1j2","", n_bins100, 0.5,TMath::Pi());
  TH1F* h_3000_CT_recojet08_E1_E2_over_E_True =  new TH1F("h_3000_CT_recojet08_E1_E2_over_E_True","", n_bins100, 0.5,1.00);
  TH1F* h_3000_CT_recojet08_Delta_E1_E2_over_E12 =  new TH1F("h_3000_CT_recojet08_Delta_E1_E2_over_E12","", n_bins100, -0.5,0.5);
  TH1F* h_3000_CT_recojet09_dphi_j1j2 =  new TH1F("h_3000_CT_recojet09_dphi_j1j2","", n_bins100, 0.5,TMath::Pi());
  TH1F* h_3000_CT_recojet09_E1_E2_over_E_True =  new TH1F("h_3000_CT_recojet09_E1_E2_over_E_True","", n_bins100, 0.5,1.00);
  TH1F* h_3000_CT_recojet09_Delta_E1_E2_over_E12 =  new TH1F("h_3000_CT_recojet09_Delta_E1_E2_over_E12","", n_bins100, -0.5,0.5);
  TH1F* h_3000_CT_recojet10_dphi_j1j2 =  new TH1F("h_3000_CT_recojet10_dphi_j1j2","", n_bins100, 0.5,TMath::Pi());
  TH1F* h_3000_CT_recojet10_E1_E2_over_E_True =  new TH1F("h_3000_CT_recojet10_E1_E2_over_E_True","", n_bins100, 0.5,1.00);
  TH1F* h_3000_CT_recojet10_Delta_E1_E2_over_E12 =  new TH1F("h_3000_CT_recojet10_Delta_E1_E2_over_E12","", n_bins100, -0.5,0.5);

  TH1F* h_3000_CT_recojetE_over_genjetE_DR03 =  new TH1F("h_3000_CT_recojetE_over_genjetE_DR03","", n_bins100, 0.5,1.5);
  TH1F* h_3000_CT_recojetE_over_genjetE_DR04 =  new TH1F("h_3000_CT_recojetE_over_genjetE_DR04","", n_bins100, 0.5,1.5);
  TH1F* h_3000_CT_recojetE_over_genjetE_DR05 =  new TH1F("h_3000_CT_recojetE_over_genjetE_DR05","", n_bins100, 0.5,1.5);
  TH1F* h_3000_CT_recojetE_over_genjetE_DR06 =  new TH1F("h_3000_CT_recojetE_over_genjetE_DR06","", n_bins100, 0.5,1.5);
  TH1F* h_3000_CT_recojetE_over_genjetE_DR07 =  new TH1F("h_3000_CT_recojetE_over_genjetE_DR07","", n_bins100, 0.5,1.5);
  TH1F* h_3000_CT_recojetE_over_genjetE_DR08 =  new TH1F("h_3000_CT_recojetE_over_genjetE_DR08","", n_bins100, 0.5,1.5);
  TH1F* h_3000_CT_recojetE_over_genjetE_DR09 =  new TH1F("h_3000_CT_recojetE_over_genjetE_DR09","", n_bins100, 0.5,1.5);
  TH1F* h_3000_CT_recojetE_over_genjetE_DR10 =  new TH1F("h_3000_CT_recojetE_over_genjetE_DR10","", n_bins100, 0.5,1.5);

  TH1F* h_3000_CT_dphi_gen_reco_DR05 =  new TH1F("h_3000_CT_dphi_gen_reco_DR05","", n_bins100, -0.1,9.9);
  TH1F* h_3000_CT_dphi_gen_reco_DR06 =  new TH1F("h_3000_CT_dphi_gen_reco_DR06","", n_bins100, -0.1,9.9);
  TH1F* h_3000_CT_dphi_gen_reco_DR07 =  new TH1F("h_3000_CT_dphi_gen_reco_DR07","", n_bins100, -0.1,9.9);

  TH1F* h_3000_CT_DR05_E_rel_totVis_RMS_d1_cosT_0_to_0_10 =  new TH1F("h_3000_CT_DR05_E_rel_totVis_RMS_d1_cosT_0_to_0_10","", n_binsJER, lim_E_rel_low,lim_E_rel_high);
  TH1F* h_3000_CT_DR05_E_rel_totVis_RMS_d1_cosT_0_10_to_0_20 =  new TH1F("h_3000_CT_DR05_E_rel_totVis_RMS_d1_cosT_0_10_to_0_20","", n_binsJER, lim_E_rel_low,lim_E_rel_high);
  TH1F* h_3000_CT_DR05_E_rel_totVis_RMS_d1_cosT_0_20_to_0_30 =  new TH1F("h_3000_CT_DR05_E_rel_totVis_RMS_d1_cosT_0_20_to_0_30","", n_binsJER, lim_E_rel_low,lim_E_rel_high);
  TH1F* h_3000_CT_DR05_E_rel_totVis_RMS_d1_cosT_0_30_to_0_40 =  new TH1F("h_3000_CT_DR05_E_rel_totVis_RMS_d1_cosT_0_30_to_0_40","", n_binsJER, lim_E_rel_low,lim_E_rel_high);
  TH1F* h_3000_CT_DR05_E_rel_totVis_RMS_d1_cosT_0_40_to_0_50 =  new TH1F("h_3000_CT_DR05_E_rel_totVis_RMS_d1_cosT_0_40_to_0_50","", n_binsJER, lim_E_rel_low,lim_E_rel_high);
  TH1F* h_3000_CT_DR05_E_rel_totVis_RMS_d1_cosT_0_50_to_0_60 =  new TH1F("h_3000_CT_DR05_E_rel_totVis_RMS_d1_cosT_0_50_to_0_60","", n_binsJER, lim_E_rel_low,lim_E_rel_high);
  TH1F* h_3000_CT_DR05_E_rel_totVis_RMS_d1_cosT_0_60_to_0_70 =  new TH1F("h_3000_CT_DR05_E_rel_totVis_RMS_d1_cosT_0_60_to_0_70","", n_binsJER, lim_E_rel_low,lim_E_rel_high);
  TH1F* h_3000_CT_DR05_E_rel_totVis_RMS_d1_cosT_0_70_to_0_80 =  new TH1F("h_3000_CT_DR05_E_rel_totVis_RMS_d1_cosT_0_70_to_0_80","", n_binsJER, lim_E_rel_low,lim_E_rel_high);
  TH1F* h_3000_CT_DR05_E_rel_totVis_RMS_d1_cosT_0_80_to_0_90 =  new TH1F("h_3000_CT_DR05_E_rel_totVis_RMS_d1_cosT_0_80_to_0_90","", n_binsJER, lim_E_rel_low,lim_E_rel_high);
  TH1F* h_3000_CT_DR05_E_rel_totVis_RMS_d1_cosT_0_900_to_0_925 =  new TH1F("h_3000_CT_DR05_E_rel_totVis_RMS_d1_cosT_0_900_to_0_925","", n_binsJER, lim_E_rel_low,lim_E_rel_high);
  TH1F* h_3000_CT_DR05_E_rel_totVis_RMS_d1_cosT_0_925_to_0_950 =  new TH1F("h_3000_CT_DR05_E_rel_totVis_RMS_d1_cosT_0_925_to_0_950","", n_binsJER, lim_E_rel_low,lim_E_rel_high);
  TH1F* h_3000_CT_DR05_E_rel_totVis_RMS_d1_cosT_0_950_to_0_975 =  new TH1F("h_3000_CT_DR05_E_rel_totVis_RMS_d1_cosT_0_950_to_0_975","", n_binsJER, lim_E_rel_low,lim_E_rel_high);
  TH1F* h_3000_CT_DR05_E_rel_totVis_RMS_d1_cosT_0_975_to_1_00 =  new TH1F("h_3000_CT_DR05_E_rel_totVis_RMS_d1_cosT_0_975_to_1_00","", n_binsJER_FW, lim_E_rel_low,lim_E_rel_high);

  TH1F* h_3000_CT_DR06_E_rel_totVis_RMS_d1_cosT_0_to_0_10 =  new TH1F("h_3000_CT_DR06_E_rel_totVis_RMS_d1_cosT_0_to_0_10","", n_binsJER, lim_E_rel_low,lim_E_rel_high);
  TH1F* h_3000_CT_DR06_E_rel_totVis_RMS_d1_cosT_0_10_to_0_20 =  new TH1F("h_3000_CT_DR06_E_rel_totVis_RMS_d1_cosT_0_10_to_0_20","", n_binsJER, lim_E_rel_low,lim_E_rel_high);
  TH1F* h_3000_CT_DR06_E_rel_totVis_RMS_d1_cosT_0_20_to_0_30 =  new TH1F("h_3000_CT_DR06_E_rel_totVis_RMS_d1_cosT_0_20_to_0_30","", n_binsJER, lim_E_rel_low,lim_E_rel_high);
  TH1F* h_3000_CT_DR06_E_rel_totVis_RMS_d1_cosT_0_30_to_0_40 =  new TH1F("h_3000_CT_DR06_E_rel_totVis_RMS_d1_cosT_0_30_to_0_40","", n_binsJER, lim_E_rel_low,lim_E_rel_high);
  TH1F* h_3000_CT_DR06_E_rel_totVis_RMS_d1_cosT_0_40_to_0_50 =  new TH1F("h_3000_CT_DR06_E_rel_totVis_RMS_d1_cosT_0_40_to_0_50","", n_binsJER, lim_E_rel_low,lim_E_rel_high);
  TH1F* h_3000_CT_DR06_E_rel_totVis_RMS_d1_cosT_0_50_to_0_60 =  new TH1F("h_3000_CT_DR06_E_rel_totVis_RMS_d1_cosT_0_50_to_0_60","", n_binsJER, lim_E_rel_low,lim_E_rel_high);
  TH1F* h_3000_CT_DR06_E_rel_totVis_RMS_d1_cosT_0_60_to_0_70 =  new TH1F("h_3000_CT_DR06_E_rel_totVis_RMS_d1_cosT_0_60_to_0_70","", n_binsJER, lim_E_rel_low,lim_E_rel_high);
  TH1F* h_3000_CT_DR06_E_rel_totVis_RMS_d1_cosT_0_70_to_0_80 =  new TH1F("h_3000_CT_DR06_E_rel_totVis_RMS_d1_cosT_0_70_to_0_80","", n_binsJER, lim_E_rel_low,lim_E_rel_high);
  TH1F* h_3000_CT_DR06_E_rel_totVis_RMS_d1_cosT_0_80_to_0_90 =  new TH1F("h_3000_CT_DR06_E_rel_totVis_RMS_d1_cosT_0_80_to_0_90","", n_binsJER, lim_E_rel_low,lim_E_rel_high);
  TH1F* h_3000_CT_DR06_E_rel_totVis_RMS_d1_cosT_0_900_to_0_925 =  new TH1F("h_3000_CT_DR06_E_rel_totVis_RMS_d1_cosT_0_900_to_0_925","", n_binsJER, lim_E_rel_low,lim_E_rel_high);
  TH1F* h_3000_CT_DR06_E_rel_totVis_RMS_d1_cosT_0_925_to_0_950 =  new TH1F("h_3000_CT_DR06_E_rel_totVis_RMS_d1_cosT_0_925_to_0_950","", n_binsJER, lim_E_rel_low,lim_E_rel_high);
  TH1F* h_3000_CT_DR06_E_rel_totVis_RMS_d1_cosT_0_950_to_0_975 =  new TH1F("h_3000_CT_DR06_E_rel_totVis_RMS_d1_cosT_0_950_to_0_975","", n_binsJER, lim_E_rel_low,lim_E_rel_high);
  TH1F* h_3000_CT_DR06_E_rel_totVis_RMS_d1_cosT_0_975_to_1_00 =  new TH1F("h_3000_CT_DR06_E_rel_totVis_RMS_d1_cosT_0_975_to_1_00","", n_binsJER_FW, lim_E_rel_low,lim_E_rel_high);

  TH1F* h_3000_CT_DR07_E_rel_totVis_RMS_d1_cosT_0_to_0_10 =  new TH1F("h_3000_CT_DR07_E_rel_totVis_RMS_d1_cosT_0_to_0_10","", n_binsJER, lim_E_rel_low,lim_E_rel_high);
  TH1F* h_3000_CT_DR07_E_rel_totVis_RMS_d1_cosT_0_10_to_0_20 =  new TH1F("h_3000_CT_DR07_E_rel_totVis_RMS_d1_cosT_0_10_to_0_20","", n_binsJER, lim_E_rel_low,lim_E_rel_high);
  TH1F* h_3000_CT_DR07_E_rel_totVis_RMS_d1_cosT_0_20_to_0_30 =  new TH1F("h_3000_CT_DR07_E_rel_totVis_RMS_d1_cosT_0_20_to_0_30","", n_binsJER, lim_E_rel_low,lim_E_rel_high);
  TH1F* h_3000_CT_DR07_E_rel_totVis_RMS_d1_cosT_0_30_to_0_40 =  new TH1F("h_3000_CT_DR07_E_rel_totVis_RMS_d1_cosT_0_30_to_0_40","", n_binsJER, lim_E_rel_low,lim_E_rel_high);
  TH1F* h_3000_CT_DR07_E_rel_totVis_RMS_d1_cosT_0_40_to_0_50 =  new TH1F("h_3000_CT_DR07_E_rel_totVis_RMS_d1_cosT_0_40_to_0_50","", n_binsJER, lim_E_rel_low,lim_E_rel_high);
  TH1F* h_3000_CT_DR07_E_rel_totVis_RMS_d1_cosT_0_50_to_0_60 =  new TH1F("h_3000_CT_DR07_E_rel_totVis_RMS_d1_cosT_0_50_to_0_60","", n_binsJER, lim_E_rel_low,lim_E_rel_high);
  TH1F* h_3000_CT_DR07_E_rel_totVis_RMS_d1_cosT_0_60_to_0_70 =  new TH1F("h_3000_CT_DR07_E_rel_totVis_RMS_d1_cosT_0_60_to_0_70","", n_binsJER, lim_E_rel_low,lim_E_rel_high);
  TH1F* h_3000_CT_DR07_E_rel_totVis_RMS_d1_cosT_0_70_to_0_80 =  new TH1F("h_3000_CT_DR07_E_rel_totVis_RMS_d1_cosT_0_70_to_0_80","", n_binsJER, lim_E_rel_low,lim_E_rel_high);
  TH1F* h_3000_CT_DR07_E_rel_totVis_RMS_d1_cosT_0_80_to_0_90 =  new TH1F("h_3000_CT_DR07_E_rel_totVis_RMS_d1_cosT_0_80_to_0_90","", n_binsJER, lim_E_rel_low,lim_E_rel_high);
  TH1F* h_3000_CT_DR07_E_rel_totVis_RMS_d1_cosT_0_900_to_0_925 =  new TH1F("h_3000_CT_DR07_E_rel_totVis_RMS_d1_cosT_0_900_to_0_925","", n_binsJER, lim_E_rel_low,lim_E_rel_high);
  TH1F* h_3000_CT_DR07_E_rel_totVis_RMS_d1_cosT_0_925_to_0_950 =  new TH1F("h_3000_CT_DR07_E_rel_totVis_RMS_d1_cosT_0_925_to_0_950","", n_binsJER, lim_E_rel_low,lim_E_rel_high);
  TH1F* h_3000_CT_DR07_E_rel_totVis_RMS_d1_cosT_0_950_to_0_975 =  new TH1F("h_3000_CT_DR07_E_rel_totVis_RMS_d1_cosT_0_950_to_0_975","", n_binsJER, lim_E_rel_low,lim_E_rel_high);
  TH1F* h_3000_CT_DR07_E_rel_totVis_RMS_d1_cosT_0_975_to_1_00 =  new TH1F("h_3000_CT_DR07_E_rel_totVis_RMS_d1_cosT_0_975_to_1_00","", n_binsJER_FW, lim_E_rel_low,lim_E_rel_high);

  TH1F* h_3000_CT_DR08_E_rel_totVis_RMS_d1_cosT_0_to_0_10 =  new TH1F("h_3000_CT_DR08_E_rel_totVis_RMS_d1_cosT_0_to_0_10","", n_binsJER, lim_E_rel_low,lim_E_rel_high);
  TH1F* h_3000_CT_DR08_E_rel_totVis_RMS_d1_cosT_0_10_to_0_20 =  new TH1F("h_3000_CT_DR08_E_rel_totVis_RMS_d1_cosT_0_10_to_0_20","", n_binsJER, lim_E_rel_low,lim_E_rel_high);
  TH1F* h_3000_CT_DR08_E_rel_totVis_RMS_d1_cosT_0_20_to_0_30 =  new TH1F("h_3000_CT_DR08_E_rel_totVis_RMS_d1_cosT_0_20_to_0_30","", n_binsJER, lim_E_rel_low,lim_E_rel_high);
  TH1F* h_3000_CT_DR08_E_rel_totVis_RMS_d1_cosT_0_30_to_0_40 =  new TH1F("h_3000_CT_DR08_E_rel_totVis_RMS_d1_cosT_0_30_to_0_40","", n_binsJER, lim_E_rel_low,lim_E_rel_high);
  TH1F* h_3000_CT_DR08_E_rel_totVis_RMS_d1_cosT_0_40_to_0_50 =  new TH1F("h_3000_CT_DR08_E_rel_totVis_RMS_d1_cosT_0_40_to_0_50","", n_binsJER, lim_E_rel_low,lim_E_rel_high);
  TH1F* h_3000_CT_DR08_E_rel_totVis_RMS_d1_cosT_0_50_to_0_60 =  new TH1F("h_3000_CT_DR08_E_rel_totVis_RMS_d1_cosT_0_50_to_0_60","", n_binsJER, lim_E_rel_low,lim_E_rel_high);
  TH1F* h_3000_CT_DR08_E_rel_totVis_RMS_d1_cosT_0_60_to_0_70 =  new TH1F("h_3000_CT_DR08_E_rel_totVis_RMS_d1_cosT_0_60_to_0_70","", n_binsJER, lim_E_rel_low,lim_E_rel_high);
  TH1F* h_3000_CT_DR08_E_rel_totVis_RMS_d1_cosT_0_70_to_0_80 =  new TH1F("h_3000_CT_DR08_E_rel_totVis_RMS_d1_cosT_0_70_to_0_80","", n_binsJER, lim_E_rel_low,lim_E_rel_high);
  TH1F* h_3000_CT_DR08_E_rel_totVis_RMS_d1_cosT_0_80_to_0_90 =  new TH1F("h_3000_CT_DR08_E_rel_totVis_RMS_d1_cosT_0_80_to_0_90","", n_binsJER, lim_E_rel_low,lim_E_rel_high);
  TH1F* h_3000_CT_DR08_E_rel_totVis_RMS_d1_cosT_0_900_to_0_925 =  new TH1F("h_3000_CT_DR08_E_rel_totVis_RMS_d1_cosT_0_900_to_0_925","", n_binsJER, lim_E_rel_low,lim_E_rel_high);
  TH1F* h_3000_CT_DR08_E_rel_totVis_RMS_d1_cosT_0_925_to_0_950 =  new TH1F("h_3000_CT_DR08_E_rel_totVis_RMS_d1_cosT_0_925_to_0_950","", n_binsJER, lim_E_rel_low,lim_E_rel_high);
  TH1F* h_3000_CT_DR08_E_rel_totVis_RMS_d1_cosT_0_950_to_0_975 =  new TH1F("h_3000_CT_DR08_E_rel_totVis_RMS_d1_cosT_0_950_to_0_975","", n_binsJER, lim_E_rel_low,lim_E_rel_high);
  TH1F* h_3000_CT_DR08_E_rel_totVis_RMS_d1_cosT_0_975_to_1_00 =  new TH1F("h_3000_CT_DR08_E_rel_totVis_RMS_d1_cosT_0_975_to_1_00","", n_binsJER_FW, lim_E_rel_low,lim_E_rel_high);

  TH1F* h_3000_CT_DR09_E_rel_totVis_RMS_d1_cosT_0_to_0_10 =  new TH1F("h_3000_CT_DR09_E_rel_totVis_RMS_d1_cosT_0_to_0_10","", n_binsJER, lim_E_rel_low,lim_E_rel_high);
  TH1F* h_3000_CT_DR09_E_rel_totVis_RMS_d1_cosT_0_10_to_0_20 =  new TH1F("h_3000_CT_DR09_E_rel_totVis_RMS_d1_cosT_0_10_to_0_20","", n_binsJER, lim_E_rel_low,lim_E_rel_high);
  TH1F* h_3000_CT_DR09_E_rel_totVis_RMS_d1_cosT_0_20_to_0_30 =  new TH1F("h_3000_CT_DR09_E_rel_totVis_RMS_d1_cosT_0_20_to_0_30","", n_binsJER, lim_E_rel_low,lim_E_rel_high);
  TH1F* h_3000_CT_DR09_E_rel_totVis_RMS_d1_cosT_0_30_to_0_40 =  new TH1F("h_3000_CT_DR09_E_rel_totVis_RMS_d1_cosT_0_30_to_0_40","", n_binsJER, lim_E_rel_low,lim_E_rel_high);
  TH1F* h_3000_CT_DR09_E_rel_totVis_RMS_d1_cosT_0_40_to_0_50 =  new TH1F("h_3000_CT_DR09_E_rel_totVis_RMS_d1_cosT_0_40_to_0_50","", n_binsJER, lim_E_rel_low,lim_E_rel_high);
  TH1F* h_3000_CT_DR09_E_rel_totVis_RMS_d1_cosT_0_50_to_0_60 =  new TH1F("h_3000_CT_DR09_E_rel_totVis_RMS_d1_cosT_0_50_to_0_60","", n_binsJER, lim_E_rel_low,lim_E_rel_high);
  TH1F* h_3000_CT_DR09_E_rel_totVis_RMS_d1_cosT_0_60_to_0_70 =  new TH1F("h_3000_CT_DR09_E_rel_totVis_RMS_d1_cosT_0_60_to_0_70","", n_binsJER, lim_E_rel_low,lim_E_rel_high);
  TH1F* h_3000_CT_DR09_E_rel_totVis_RMS_d1_cosT_0_70_to_0_80 =  new TH1F("h_3000_CT_DR09_E_rel_totVis_RMS_d1_cosT_0_70_to_0_80","", n_binsJER, lim_E_rel_low,lim_E_rel_high);
  TH1F* h_3000_CT_DR09_E_rel_totVis_RMS_d1_cosT_0_80_to_0_90 =  new TH1F("h_3000_CT_DR09_E_rel_totVis_RMS_d1_cosT_0_80_to_0_90","", n_binsJER, lim_E_rel_low,lim_E_rel_high);
  TH1F* h_3000_CT_DR09_E_rel_totVis_RMS_d1_cosT_0_900_to_0_925 =  new TH1F("h_3000_CT_DR09_E_rel_totVis_RMS_d1_cosT_0_900_to_0_925","", n_binsJER, lim_E_rel_low,lim_E_rel_high);
  TH1F* h_3000_CT_DR09_E_rel_totVis_RMS_d1_cosT_0_925_to_0_950 =  new TH1F("h_3000_CT_DR09_E_rel_totVis_RMS_d1_cosT_0_925_to_0_950","", n_binsJER, lim_E_rel_low,lim_E_rel_high);
  TH1F* h_3000_CT_DR09_E_rel_totVis_RMS_d1_cosT_0_950_to_0_975 =  new TH1F("h_3000_CT_DR09_E_rel_totVis_RMS_d1_cosT_0_950_to_0_975","", n_binsJER, lim_E_rel_low,lim_E_rel_high);
  TH1F* h_3000_CT_DR09_E_rel_totVis_RMS_d1_cosT_0_975_to_1_00 =  new TH1F("h_3000_CT_DR09_E_rel_totVis_RMS_d1_cosT_0_975_to_1_00","", n_binsJER_FW, lim_E_rel_low,lim_E_rel_high);

  TH1F* h_3000_CT_DR10_E_rel_totVis_RMS_d1_cosT_0_to_0_10 =  new TH1F("h_3000_CT_DR10_E_rel_totVis_RMS_d1_cosT_0_to_0_10","", n_binsJER, lim_E_rel_low,lim_E_rel_high);
  TH1F* h_3000_CT_DR10_E_rel_totVis_RMS_d1_cosT_0_10_to_0_20 =  new TH1F("h_3000_CT_DR10_E_rel_totVis_RMS_d1_cosT_0_10_to_0_20","", n_binsJER, lim_E_rel_low,lim_E_rel_high);
  TH1F* h_3000_CT_DR10_E_rel_totVis_RMS_d1_cosT_0_20_to_0_30 =  new TH1F("h_3000_CT_DR10_E_rel_totVis_RMS_d1_cosT_0_20_to_0_30","", n_binsJER, lim_E_rel_low,lim_E_rel_high);
  TH1F* h_3000_CT_DR10_E_rel_totVis_RMS_d1_cosT_0_30_to_0_40 =  new TH1F("h_3000_CT_DR10_E_rel_totVis_RMS_d1_cosT_0_30_to_0_40","", n_binsJER, lim_E_rel_low,lim_E_rel_high);
  TH1F* h_3000_CT_DR10_E_rel_totVis_RMS_d1_cosT_0_40_to_0_50 =  new TH1F("h_3000_CT_DR10_E_rel_totVis_RMS_d1_cosT_0_40_to_0_50","", n_binsJER, lim_E_rel_low,lim_E_rel_high);
  TH1F* h_3000_CT_DR10_E_rel_totVis_RMS_d1_cosT_0_50_to_0_60 =  new TH1F("h_3000_CT_DR10_E_rel_totVis_RMS_d1_cosT_0_50_to_0_60","", n_binsJER, lim_E_rel_low,lim_E_rel_high);
  TH1F* h_3000_CT_DR10_E_rel_totVis_RMS_d1_cosT_0_60_to_0_70 =  new TH1F("h_3000_CT_DR10_E_rel_totVis_RMS_d1_cosT_0_60_to_0_70","", n_binsJER, lim_E_rel_low,lim_E_rel_high);
  TH1F* h_3000_CT_DR10_E_rel_totVis_RMS_d1_cosT_0_70_to_0_80 =  new TH1F("h_3000_CT_DR10_E_rel_totVis_RMS_d1_cosT_0_70_to_0_80","", n_binsJER, lim_E_rel_low,lim_E_rel_high);
  TH1F* h_3000_CT_DR10_E_rel_totVis_RMS_d1_cosT_0_80_to_0_90 =  new TH1F("h_3000_CT_DR10_E_rel_totVis_RMS_d1_cosT_0_80_to_0_90","", n_binsJER, lim_E_rel_low,lim_E_rel_high);
  TH1F* h_3000_CT_DR10_E_rel_totVis_RMS_d1_cosT_0_900_to_0_925 =  new TH1F("h_3000_CT_DR10_E_rel_totVis_RMS_d1_cosT_0_900_to_0_925","", n_binsJER, lim_E_rel_low,lim_E_rel_high);
  TH1F* h_3000_CT_DR10_E_rel_totVis_RMS_d1_cosT_0_925_to_0_950 =  new TH1F("h_3000_CT_DR10_E_rel_totVis_RMS_d1_cosT_0_925_to_0_950","", n_binsJER, lim_E_rel_low,lim_E_rel_high);
  TH1F* h_3000_CT_DR10_E_rel_totVis_RMS_d1_cosT_0_950_to_0_975 =  new TH1F("h_3000_CT_DR10_E_rel_totVis_RMS_d1_cosT_0_950_to_0_975","", n_binsJER, lim_E_rel_low,lim_E_rel_high);
  TH1F* h_3000_CT_DR10_E_rel_totVis_RMS_d1_cosT_0_975_to_1_00 =  new TH1F("h_3000_CT_DR10_E_rel_totVis_RMS_d1_cosT_0_975_to_1_00","", n_binsJER_FW, lim_E_rel_low,lim_E_rel_high);

  TH1F* h_3000_CT_DR05_dphi_reco_gen_cosTheta_0_65 =  new TH1F("h_3000_CT_DR05_dphi_reco_gen_cosTheta_0_65","", n_bins100, -lim_angleDeg,lim_angleDeg);
  TH1F* h_3000_CT_DR05_dtheta_reco_gen_cosTheta_0_65 =  new TH1F("h_3000_CT_DR05_dtheta_reco_gen_cosTheta_0_65","", n_bins100, -lim_angleDeg,lim_angleDeg);
  TH1F* h_3000_CT_DR05_dphi_reco_gen_cosTheta_0_65_to_0_80 =  new TH1F("h_3000_CT_DR05_dphi_reco_gen_cosTheta_0_65_to_0_80","", n_bins100, -lim_angleDeg,lim_angleDeg);
  TH1F* h_3000_CT_DR05_dtheta_reco_gen_cosTheta_0_65_to_0_80 =  new TH1F("h_3000_CT_DR05_dtheta_reco_gen_cosTheta_0_65_to_0_80","", n_bins100, -lim_angleDeg,lim_angleDeg);
  TH1F* h_3000_CT_DR05_dphi_reco_gen_cosTheta_0_80_to_0_925 =  new TH1F("h_3000_CT_DR05_dphi_reco_gen_cosTheta_0_80_to_0_925","", n_bins100, -lim_angleDeg,lim_angleDeg);
  TH1F* h_3000_CT_DR05_dtheta_reco_gen_cosTheta_0_80_to_0_925 =  new TH1F("h_3000_CT_DR05_dtheta_reco_gen_cosTheta_0_80_to_0_925","", n_bins100, -lim_angleDeg,lim_angleDeg);
  TH1F* h_3000_CT_DR05_dphi_reco_gen_cosTheta_0_925_to_0_975 =  new TH1F("h_3000_CT_DR05_dphi_reco_gen_cosTheta_0_925_to_0_975","", n_bins100, -lim_angleDeg,lim_angleDeg);
  TH1F* h_3000_CT_DR05_dtheta_reco_gen_cosTheta_0_925_to_0_975 =  new TH1F("h_3000_CT_DR05_dtheta_reco_gen_cosTheta_0_925_to_0_975","", n_bins100, -lim_angleDeg,lim_angleDeg);

  TH1F* h_3000_CT_DR07_dphi_reco_gen_cosTheta_0_65 =  new TH1F("h_3000_CT_DR07_dphi_reco_gen_cosTheta_0_65","", n_bins100, -lim_angleDeg,lim_angleDeg);
  TH1F* h_3000_CT_DR07_dtheta_reco_gen_cosTheta_0_65 =  new TH1F("h_3000_CT_DR07_dtheta_reco_gen_cosTheta_0_65","", n_bins100, -lim_angleDeg,lim_angleDeg);
  TH1F* h_3000_CT_DR07_dphi_reco_gen_cosTheta_0_65_to_0_80 =  new TH1F("h_3000_CT_DR07_dphi_reco_gen_cosTheta_0_65_to_0_80","", n_bins100, -lim_angleDeg,lim_angleDeg);
  TH1F* h_3000_CT_DR07_dtheta_reco_gen_cosTheta_0_65_to_0_80 =  new TH1F("h_3000_CT_DR07_dtheta_reco_gen_cosTheta_0_65_to_0_80","", n_bins100, -lim_angleDeg,lim_angleDeg);
  TH1F* h_3000_CT_DR07_dphi_reco_gen_cosTheta_0_80_to_0_925 =  new TH1F("h_3000_CT_DR07_dphi_reco_gen_cosTheta_0_80_to_0_925","", n_bins100, -lim_angleDeg,lim_angleDeg);
  TH1F* h_3000_CT_DR07_dtheta_reco_gen_cosTheta_0_80_to_0_925 =  new TH1F("h_3000_CT_DR07_dtheta_reco_gen_cosTheta_0_80_to_0_925","", n_bins100, -lim_angleDeg,lim_angleDeg);
  TH1F* h_3000_CT_DR07_dphi_reco_gen_cosTheta_0_925_to_0_975 =  new TH1F("h_3000_CT_DR07_dphi_reco_gen_cosTheta_0_925_to_0_975","", n_bins100, -lim_angleDeg,lim_angleDeg);
  TH1F* h_3000_CT_DR07_dtheta_reco_gen_cosTheta_0_925_to_0_975 =  new TH1F("h_3000_CT_DR07_dtheta_reco_gen_cosTheta_0_925_to_0_975","", n_bins100, -lim_angleDeg,lim_angleDeg);

  TH1F* h_3000_CT_DR10_dphi_reco_gen_cosTheta_0_65 =  new TH1F("h_3000_CT_DR10_dphi_reco_gen_cosTheta_0_65","", n_bins100, -lim_angleDeg,lim_angleDeg);
  TH1F* h_3000_CT_DR10_dtheta_reco_gen_cosTheta_0_65 =  new TH1F("h_3000_CT_DR10_dtheta_reco_gen_cosTheta_0_65","", n_bins100, -lim_angleDeg,lim_angleDeg);
  TH1F* h_3000_CT_DR10_dphi_reco_gen_cosTheta_0_65_to_0_80 =  new TH1F("h_3000_CT_DR10_dphi_reco_gen_cosTheta_0_65_to_0_80","", n_bins100, -lim_angleDeg,lim_angleDeg);
  TH1F* h_3000_CT_DR10_dtheta_reco_gen_cosTheta_0_65_to_0_80 =  new TH1F("h_3000_CT_DR10_dtheta_reco_gen_cosTheta_0_65_to_0_80","", n_bins100, -lim_angleDeg,lim_angleDeg);
  TH1F* h_3000_CT_DR10_dphi_reco_gen_cosTheta_0_80_to_0_925 =  new TH1F("h_3000_CT_DR10_dphi_reco_gen_cosTheta_0_80_to_0_925","", n_bins100, -lim_angleDeg,lim_angleDeg);
  TH1F* h_3000_CT_DR10_dtheta_reco_gen_cosTheta_0_80_to_0_925 =  new TH1F("h_3000_CT_DR10_dtheta_reco_gen_cosTheta_0_80_to_0_925","", n_bins100, -lim_angleDeg,lim_angleDeg);
  TH1F* h_3000_CT_DR10_dphi_reco_gen_cosTheta_0_925_to_0_975 =  new TH1F("h_3000_CT_DR10_dphi_reco_gen_cosTheta_0_925_to_0_975","", n_bins100, -lim_angleDeg,lim_angleDeg);
  TH1F* h_3000_CT_DR10_dtheta_reco_gen_cosTheta_0_925_to_0_975 =  new TH1F("h_3000_CT_DR10_dtheta_reco_gen_cosTheta_0_925_to_0_975","", n_bins100, -lim_angleDeg,lim_angleDeg);

  std::vector<TH1F*> hist_vec_3000_CT;
  hist_vec_3000_CT.push_back(h_3000_CT_genjet03_dphi_j1j2);
  hist_vec_3000_CT.push_back(h_3000_CT_genjet03_E1_E2_over_E_True);
  hist_vec_3000_CT.push_back(h_3000_CT_genjet03_Delta_E1_E2_over_E12);
  hist_vec_3000_CT.push_back(h_3000_CT_genjet04_dphi_j1j2);
  hist_vec_3000_CT.push_back(h_3000_CT_genjet04_E1_E2_over_E_True);
  hist_vec_3000_CT.push_back(h_3000_CT_genjet04_Delta_E1_E2_over_E12);
  hist_vec_3000_CT.push_back(h_3000_CT_genjet05_dphi_j1j2);
  hist_vec_3000_CT.push_back(h_3000_CT_genjet05_E1_E2_over_E_True);
  hist_vec_3000_CT.push_back(h_3000_CT_genjet05_Delta_E1_E2_over_E12);
  hist_vec_3000_CT.push_back(h_3000_CT_genjet06_dphi_j1j2);
  hist_vec_3000_CT.push_back(h_3000_CT_genjet06_E1_E2_over_E_True);
  hist_vec_3000_CT.push_back(h_3000_CT_genjet06_Delta_E1_E2_over_E12);
  hist_vec_3000_CT.push_back(h_3000_CT_genjet07_dphi_j1j2);
  hist_vec_3000_CT.push_back(h_3000_CT_genjet07_E1_E2_over_E_True);
  hist_vec_3000_CT.push_back(h_3000_CT_genjet07_Delta_E1_E2_over_E12);
  hist_vec_3000_CT.push_back(h_3000_CT_genjet08_dphi_j1j2);
  hist_vec_3000_CT.push_back(h_3000_CT_genjet08_E1_E2_over_E_True);
  hist_vec_3000_CT.push_back(h_3000_CT_genjet08_Delta_E1_E2_over_E12);
  hist_vec_3000_CT.push_back(h_3000_CT_genjet09_dphi_j1j2);
  hist_vec_3000_CT.push_back(h_3000_CT_genjet09_E1_E2_over_E_True);
  hist_vec_3000_CT.push_back(h_3000_CT_genjet09_Delta_E1_E2_over_E12);
  hist_vec_3000_CT.push_back(h_3000_CT_genjet10_dphi_j1j2);
  hist_vec_3000_CT.push_back(h_3000_CT_genjet10_E1_E2_over_E_True);
  hist_vec_3000_CT.push_back(h_3000_CT_genjet10_Delta_E1_E2_over_E12);

  hist_vec_3000_CT.push_back(h_3000_CT_recojet03_dphi_j1j2);
  hist_vec_3000_CT.push_back(h_3000_CT_recojet03_E1_E2_over_E_True);
  hist_vec_3000_CT.push_back(h_3000_CT_recojet03_Delta_E1_E2_over_E12);
  hist_vec_3000_CT.push_back(h_3000_CT_recojet04_dphi_j1j2);
  hist_vec_3000_CT.push_back(h_3000_CT_recojet04_E1_E2_over_E_True);
  hist_vec_3000_CT.push_back(h_3000_CT_recojet04_Delta_E1_E2_over_E12);
  hist_vec_3000_CT.push_back(h_3000_CT_recojet05_dphi_j1j2);
  hist_vec_3000_CT.push_back(h_3000_CT_recojet05_E1_E2_over_E_True);
  hist_vec_3000_CT.push_back(h_3000_CT_recojet05_Delta_E1_E2_over_E12);
  hist_vec_3000_CT.push_back(h_3000_CT_recojet06_dphi_j1j2);
  hist_vec_3000_CT.push_back(h_3000_CT_recojet06_E1_E2_over_E_True);
  hist_vec_3000_CT.push_back(h_3000_CT_recojet06_Delta_E1_E2_over_E12);
  hist_vec_3000_CT.push_back(h_3000_CT_recojet07_dphi_j1j2);
  hist_vec_3000_CT.push_back(h_3000_CT_recojet07_E1_E2_over_E_True);
  hist_vec_3000_CT.push_back(h_3000_CT_recojet07_Delta_E1_E2_over_E12);
  hist_vec_3000_CT.push_back(h_3000_CT_recojet08_dphi_j1j2);
  hist_vec_3000_CT.push_back(h_3000_CT_recojet08_E1_E2_over_E_True);
  hist_vec_3000_CT.push_back(h_3000_CT_recojet08_Delta_E1_E2_over_E12);
  hist_vec_3000_CT.push_back(h_3000_CT_recojet09_dphi_j1j2);
  hist_vec_3000_CT.push_back(h_3000_CT_recojet09_E1_E2_over_E_True);
  hist_vec_3000_CT.push_back(h_3000_CT_recojet09_Delta_E1_E2_over_E12);
  hist_vec_3000_CT.push_back(h_3000_CT_recojet10_dphi_j1j2);
  hist_vec_3000_CT.push_back(h_3000_CT_recojet10_E1_E2_over_E_True);
  hist_vec_3000_CT.push_back(h_3000_CT_recojet10_Delta_E1_E2_over_E12);

  hist_vec_3000_CT.push_back(h_3000_CT_recojetE_over_genjetE_DR03);
  hist_vec_3000_CT.push_back(h_3000_CT_recojetE_over_genjetE_DR04);
  hist_vec_3000_CT.push_back(h_3000_CT_recojetE_over_genjetE_DR05);
  hist_vec_3000_CT.push_back(h_3000_CT_recojetE_over_genjetE_DR06);
  hist_vec_3000_CT.push_back(h_3000_CT_recojetE_over_genjetE_DR07);
  hist_vec_3000_CT.push_back(h_3000_CT_recojetE_over_genjetE_DR08);
  hist_vec_3000_CT.push_back(h_3000_CT_recojetE_over_genjetE_DR09);
  hist_vec_3000_CT.push_back(h_3000_CT_recojetE_over_genjetE_DR10);

  hist_vec_3000_CT.push_back(h_3000_CT_dphi_gen_reco_DR05);
  hist_vec_3000_CT.push_back(h_3000_CT_dphi_gen_reco_DR06);
  hist_vec_3000_CT.push_back(h_3000_CT_dphi_gen_reco_DR07);

  hist_vec_3000_CT.push_back(h_3000_CT_DR05_E_rel_totVis_RMS_d1_cosT_0_to_0_10);
  hist_vec_3000_CT.push_back(h_3000_CT_DR05_E_rel_totVis_RMS_d1_cosT_0_10_to_0_20);
  hist_vec_3000_CT.push_back(h_3000_CT_DR05_E_rel_totVis_RMS_d1_cosT_0_20_to_0_30);
  hist_vec_3000_CT.push_back(h_3000_CT_DR05_E_rel_totVis_RMS_d1_cosT_0_30_to_0_40);
  hist_vec_3000_CT.push_back(h_3000_CT_DR05_E_rel_totVis_RMS_d1_cosT_0_40_to_0_50);
  hist_vec_3000_CT.push_back(h_3000_CT_DR05_E_rel_totVis_RMS_d1_cosT_0_50_to_0_60);
  hist_vec_3000_CT.push_back(h_3000_CT_DR05_E_rel_totVis_RMS_d1_cosT_0_60_to_0_70);
  hist_vec_3000_CT.push_back(h_3000_CT_DR05_E_rel_totVis_RMS_d1_cosT_0_70_to_0_80);
  hist_vec_3000_CT.push_back(h_3000_CT_DR05_E_rel_totVis_RMS_d1_cosT_0_80_to_0_90);
  hist_vec_3000_CT.push_back(h_3000_CT_DR05_E_rel_totVis_RMS_d1_cosT_0_900_to_0_925);
  hist_vec_3000_CT.push_back(h_3000_CT_DR05_E_rel_totVis_RMS_d1_cosT_0_925_to_0_950);
  hist_vec_3000_CT.push_back(h_3000_CT_DR05_E_rel_totVis_RMS_d1_cosT_0_950_to_0_975);
  hist_vec_3000_CT.push_back(h_3000_CT_DR05_E_rel_totVis_RMS_d1_cosT_0_975_to_1_00);

  hist_vec_3000_CT.push_back(h_3000_CT_DR06_E_rel_totVis_RMS_d1_cosT_0_to_0_10);
  hist_vec_3000_CT.push_back(h_3000_CT_DR06_E_rel_totVis_RMS_d1_cosT_0_10_to_0_20);
  hist_vec_3000_CT.push_back(h_3000_CT_DR06_E_rel_totVis_RMS_d1_cosT_0_20_to_0_30);
  hist_vec_3000_CT.push_back(h_3000_CT_DR06_E_rel_totVis_RMS_d1_cosT_0_30_to_0_40);
  hist_vec_3000_CT.push_back(h_3000_CT_DR06_E_rel_totVis_RMS_d1_cosT_0_40_to_0_50);
  hist_vec_3000_CT.push_back(h_3000_CT_DR06_E_rel_totVis_RMS_d1_cosT_0_50_to_0_60);
  hist_vec_3000_CT.push_back(h_3000_CT_DR06_E_rel_totVis_RMS_d1_cosT_0_60_to_0_70);
  hist_vec_3000_CT.push_back(h_3000_CT_DR06_E_rel_totVis_RMS_d1_cosT_0_70_to_0_80);
  hist_vec_3000_CT.push_back(h_3000_CT_DR06_E_rel_totVis_RMS_d1_cosT_0_80_to_0_90);
  hist_vec_3000_CT.push_back(h_3000_CT_DR06_E_rel_totVis_RMS_d1_cosT_0_900_to_0_925);
  hist_vec_3000_CT.push_back(h_3000_CT_DR06_E_rel_totVis_RMS_d1_cosT_0_925_to_0_950);
  hist_vec_3000_CT.push_back(h_3000_CT_DR06_E_rel_totVis_RMS_d1_cosT_0_950_to_0_975);
  hist_vec_3000_CT.push_back(h_3000_CT_DR06_E_rel_totVis_RMS_d1_cosT_0_975_to_1_00); 

  hist_vec_3000_CT.push_back(h_3000_CT_DR07_E_rel_totVis_RMS_d1_cosT_0_to_0_10);
  hist_vec_3000_CT.push_back(h_3000_CT_DR07_E_rel_totVis_RMS_d1_cosT_0_10_to_0_20);
  hist_vec_3000_CT.push_back(h_3000_CT_DR07_E_rel_totVis_RMS_d1_cosT_0_20_to_0_30);
  hist_vec_3000_CT.push_back(h_3000_CT_DR07_E_rel_totVis_RMS_d1_cosT_0_30_to_0_40);
  hist_vec_3000_CT.push_back(h_3000_CT_DR07_E_rel_totVis_RMS_d1_cosT_0_40_to_0_50);
  hist_vec_3000_CT.push_back(h_3000_CT_DR07_E_rel_totVis_RMS_d1_cosT_0_50_to_0_60);
  hist_vec_3000_CT.push_back(h_3000_CT_DR07_E_rel_totVis_RMS_d1_cosT_0_60_to_0_70);
  hist_vec_3000_CT.push_back(h_3000_CT_DR07_E_rel_totVis_RMS_d1_cosT_0_70_to_0_80);
  hist_vec_3000_CT.push_back(h_3000_CT_DR07_E_rel_totVis_RMS_d1_cosT_0_80_to_0_90);
  hist_vec_3000_CT.push_back(h_3000_CT_DR07_E_rel_totVis_RMS_d1_cosT_0_900_to_0_925);
  hist_vec_3000_CT.push_back(h_3000_CT_DR07_E_rel_totVis_RMS_d1_cosT_0_925_to_0_950);
  hist_vec_3000_CT.push_back(h_3000_CT_DR07_E_rel_totVis_RMS_d1_cosT_0_950_to_0_975);
  hist_vec_3000_CT.push_back(h_3000_CT_DR07_E_rel_totVis_RMS_d1_cosT_0_975_to_1_00); 

  hist_vec_3000_CT.push_back(h_3000_CT_DR08_E_rel_totVis_RMS_d1_cosT_0_to_0_10);
  hist_vec_3000_CT.push_back(h_3000_CT_DR08_E_rel_totVis_RMS_d1_cosT_0_10_to_0_20);
  hist_vec_3000_CT.push_back(h_3000_CT_DR08_E_rel_totVis_RMS_d1_cosT_0_20_to_0_30);
  hist_vec_3000_CT.push_back(h_3000_CT_DR08_E_rel_totVis_RMS_d1_cosT_0_30_to_0_40);
  hist_vec_3000_CT.push_back(h_3000_CT_DR08_E_rel_totVis_RMS_d1_cosT_0_40_to_0_50);
  hist_vec_3000_CT.push_back(h_3000_CT_DR08_E_rel_totVis_RMS_d1_cosT_0_50_to_0_60);
  hist_vec_3000_CT.push_back(h_3000_CT_DR08_E_rel_totVis_RMS_d1_cosT_0_60_to_0_70);
  hist_vec_3000_CT.push_back(h_3000_CT_DR08_E_rel_totVis_RMS_d1_cosT_0_70_to_0_80);
  hist_vec_3000_CT.push_back(h_3000_CT_DR08_E_rel_totVis_RMS_d1_cosT_0_80_to_0_90);
  hist_vec_3000_CT.push_back(h_3000_CT_DR08_E_rel_totVis_RMS_d1_cosT_0_900_to_0_925);
  hist_vec_3000_CT.push_back(h_3000_CT_DR08_E_rel_totVis_RMS_d1_cosT_0_925_to_0_950);
  hist_vec_3000_CT.push_back(h_3000_CT_DR08_E_rel_totVis_RMS_d1_cosT_0_950_to_0_975);
  hist_vec_3000_CT.push_back(h_3000_CT_DR08_E_rel_totVis_RMS_d1_cosT_0_975_to_1_00); //110

  hist_vec_3000_CT.push_back(h_3000_CT_DR09_E_rel_totVis_RMS_d1_cosT_0_to_0_10);
  hist_vec_3000_CT.push_back(h_3000_CT_DR09_E_rel_totVis_RMS_d1_cosT_0_10_to_0_20);
  hist_vec_3000_CT.push_back(h_3000_CT_DR09_E_rel_totVis_RMS_d1_cosT_0_20_to_0_30);
  hist_vec_3000_CT.push_back(h_3000_CT_DR09_E_rel_totVis_RMS_d1_cosT_0_30_to_0_40);
  hist_vec_3000_CT.push_back(h_3000_CT_DR09_E_rel_totVis_RMS_d1_cosT_0_40_to_0_50);
  hist_vec_3000_CT.push_back(h_3000_CT_DR09_E_rel_totVis_RMS_d1_cosT_0_50_to_0_60);
  hist_vec_3000_CT.push_back(h_3000_CT_DR09_E_rel_totVis_RMS_d1_cosT_0_60_to_0_70);
  hist_vec_3000_CT.push_back(h_3000_CT_DR09_E_rel_totVis_RMS_d1_cosT_0_70_to_0_80);
  hist_vec_3000_CT.push_back(h_3000_CT_DR09_E_rel_totVis_RMS_d1_cosT_0_80_to_0_90);
  hist_vec_3000_CT.push_back(h_3000_CT_DR09_E_rel_totVis_RMS_d1_cosT_0_900_to_0_925);
  hist_vec_3000_CT.push_back(h_3000_CT_DR09_E_rel_totVis_RMS_d1_cosT_0_925_to_0_950);
  hist_vec_3000_CT.push_back(h_3000_CT_DR09_E_rel_totVis_RMS_d1_cosT_0_950_to_0_975);
  hist_vec_3000_CT.push_back(h_3000_CT_DR09_E_rel_totVis_RMS_d1_cosT_0_975_to_1_00); //123

  hist_vec_3000_CT.push_back(h_3000_CT_DR10_E_rel_totVis_RMS_d1_cosT_0_to_0_10);
  hist_vec_3000_CT.push_back(h_3000_CT_DR10_E_rel_totVis_RMS_d1_cosT_0_10_to_0_20);
  hist_vec_3000_CT.push_back(h_3000_CT_DR10_E_rel_totVis_RMS_d1_cosT_0_20_to_0_30);
  hist_vec_3000_CT.push_back(h_3000_CT_DR10_E_rel_totVis_RMS_d1_cosT_0_30_to_0_40);
  hist_vec_3000_CT.push_back(h_3000_CT_DR10_E_rel_totVis_RMS_d1_cosT_0_40_to_0_50);
  hist_vec_3000_CT.push_back(h_3000_CT_DR10_E_rel_totVis_RMS_d1_cosT_0_50_to_0_60);
  hist_vec_3000_CT.push_back(h_3000_CT_DR10_E_rel_totVis_RMS_d1_cosT_0_60_to_0_70);
  hist_vec_3000_CT.push_back(h_3000_CT_DR10_E_rel_totVis_RMS_d1_cosT_0_70_to_0_80);
  hist_vec_3000_CT.push_back(h_3000_CT_DR10_E_rel_totVis_RMS_d1_cosT_0_80_to_0_90);
  hist_vec_3000_CT.push_back(h_3000_CT_DR10_E_rel_totVis_RMS_d1_cosT_0_900_to_0_925);
  hist_vec_3000_CT.push_back(h_3000_CT_DR10_E_rel_totVis_RMS_d1_cosT_0_925_to_0_950);
  hist_vec_3000_CT.push_back(h_3000_CT_DR10_E_rel_totVis_RMS_d1_cosT_0_950_to_0_975);
  hist_vec_3000_CT.push_back(h_3000_CT_DR10_E_rel_totVis_RMS_d1_cosT_0_975_to_1_00); //136

  hist_vec_3000_CT.push_back(h_3000_CT_DR05_dphi_reco_gen_cosTheta_0_65);//137
  hist_vec_3000_CT.push_back(h_3000_CT_DR05_dphi_reco_gen_cosTheta_0_65_to_0_80);
  hist_vec_3000_CT.push_back(h_3000_CT_DR05_dphi_reco_gen_cosTheta_0_80_to_0_925);
  hist_vec_3000_CT.push_back(h_3000_CT_DR05_dphi_reco_gen_cosTheta_0_925_to_0_975);
  hist_vec_3000_CT.push_back(h_3000_CT_DR05_dtheta_reco_gen_cosTheta_0_65);
  hist_vec_3000_CT.push_back(h_3000_CT_DR05_dtheta_reco_gen_cosTheta_0_65_to_0_80);
  hist_vec_3000_CT.push_back(h_3000_CT_DR05_dtheta_reco_gen_cosTheta_0_80_to_0_925);
  hist_vec_3000_CT.push_back(h_3000_CT_DR05_dtheta_reco_gen_cosTheta_0_925_to_0_975);

  hist_vec_3000_CT.push_back(h_3000_CT_DR07_dphi_reco_gen_cosTheta_0_65);//145
  hist_vec_3000_CT.push_back(h_3000_CT_DR07_dphi_reco_gen_cosTheta_0_65_to_0_80);
  hist_vec_3000_CT.push_back(h_3000_CT_DR07_dphi_reco_gen_cosTheta_0_80_to_0_925);
  hist_vec_3000_CT.push_back(h_3000_CT_DR07_dphi_reco_gen_cosTheta_0_925_to_0_975);
  hist_vec_3000_CT.push_back(h_3000_CT_DR07_dtheta_reco_gen_cosTheta_0_65);
  hist_vec_3000_CT.push_back(h_3000_CT_DR07_dtheta_reco_gen_cosTheta_0_65_to_0_80);
  hist_vec_3000_CT.push_back(h_3000_CT_DR07_dtheta_reco_gen_cosTheta_0_80_to_0_925);
  hist_vec_3000_CT.push_back(h_3000_CT_DR07_dtheta_reco_gen_cosTheta_0_925_to_0_975);

  hist_vec_3000_CT.push_back(h_3000_CT_DR10_dphi_reco_gen_cosTheta_0_65);//153
  hist_vec_3000_CT.push_back(h_3000_CT_DR10_dphi_reco_gen_cosTheta_0_65_to_0_80);
  hist_vec_3000_CT.push_back(h_3000_CT_DR10_dphi_reco_gen_cosTheta_0_80_to_0_925);
  hist_vec_3000_CT.push_back(h_3000_CT_DR10_dphi_reco_gen_cosTheta_0_925_to_0_975);
  hist_vec_3000_CT.push_back(h_3000_CT_DR10_dtheta_reco_gen_cosTheta_0_65);
  hist_vec_3000_CT.push_back(h_3000_CT_DR10_dtheta_reco_gen_cosTheta_0_65_to_0_80);
  hist_vec_3000_CT.push_back(h_3000_CT_DR10_dtheta_reco_gen_cosTheta_0_80_to_0_925);
  hist_vec_3000_CT.push_back(h_3000_CT_DR10_dtheta_reco_gen_cosTheta_0_925_to_0_975);

  for(unsigned int i=0;i<hist_vec_3000_CT.size();i++){
    hist_vec_3000_CT[i]->Sumw2();
  }
  fill_jet_histograms(file_CLIC_3000_CT,hist_vec_3000_CT);

  TH1F* h_3000_CT_DR05_dphi_SigmaCB_summary_histogram=new TH1F("dphiRes_SigmaCBVsCosTheta_CT_DR05_3000", "#sigma#Delta#phi(j_{reco},j_{true}) vs |cos#theta|", nRegionBinsAngles, pRegionBinEdgesAngles);
  h_3000_CT_DR05_dphi_SigmaCB_summary_histogram ->SetYTitle("#sigma#Delta#phi(j_{reco},j_{true})");
  h_3000_CT_DR05_dphi_SigmaCB_summary_histogram->SetXTitle("|cos#theta|");
  h_3000_CT_DR05_dphi_SigmaCB_summary_histogram->SetLineWidth(2);
  h_3000_CT_DR05_dphi_SigmaCB_summary_histogram->SetLineColor(kCyan+1);
  h_3000_CT_DR05_dphi_SigmaCB_summary_histogram->SetLineStyle(2);

  TH1F* h_3000_CT_DR05_dphi_RMS90_summary_histogram=new TH1F("dphiRes_RMS90VsCosTheta_CT_DR05_3000", "RMS_{90} #Delta#phi(j_{reco},j_{true}) vs |cos#theta|", nRegionBinsAngles, pRegionBinEdgesAngles);
  h_3000_CT_DR05_dphi_RMS90_summary_histogram ->SetYTitle("RMS_{90}#Delta#phi(j_{reco},j_{true})");
  h_3000_CT_DR05_dphi_RMS90_summary_histogram->SetXTitle("|cos#theta|");
  h_3000_CT_DR05_dphi_RMS90_summary_histogram->SetLineWidth(2);
  h_3000_CT_DR05_dphi_RMS90_summary_histogram->SetLineColor(kCyan+1);
  h_3000_CT_DR05_dphi_RMS90_summary_histogram->SetLineStyle(2);

  TH1F* h_3000_CT_DR07_dphi_SigmaCB_summary_histogram=new TH1F("dphiRes_SigmaCBVsCosTheta_CT_DR07_3000", "#sigma#Delta#phi(j_{reco},j_{true}) vs |cos#theta|", nRegionBinsAngles, pRegionBinEdgesAngles);
  h_3000_CT_DR07_dphi_SigmaCB_summary_histogram ->SetYTitle("#sigma#Delta#phi(j_{reco},j_{true})");
  h_3000_CT_DR07_dphi_SigmaCB_summary_histogram->SetXTitle("|cos#theta|");
  h_3000_CT_DR07_dphi_SigmaCB_summary_histogram->SetLineWidth(2);
  h_3000_CT_DR07_dphi_SigmaCB_summary_histogram->SetLineColor(kCyan+1);
  h_3000_CT_DR07_dphi_SigmaCB_summary_histogram->SetLineStyle(2);

  TH1F* h_3000_CT_DR07_dphi_RMS90_summary_histogram=new TH1F("dphiRes_RMS90VsCosTheta_CT_DR07_3000", "RMS_{90} #Delta#phi(j_{reco},j_{true}) vs |cos#theta|", nRegionBinsAngles, pRegionBinEdgesAngles);
  h_3000_CT_DR07_dphi_RMS90_summary_histogram ->SetYTitle("RMS_{90}#Delta#phi(j_{reco},j_{true})");
  h_3000_CT_DR07_dphi_RMS90_summary_histogram->SetXTitle("|cos#theta|");
  h_3000_CT_DR07_dphi_RMS90_summary_histogram->SetLineWidth(2);
  h_3000_CT_DR07_dphi_RMS90_summary_histogram->SetLineColor(kCyan+1);
  h_3000_CT_DR07_dphi_RMS90_summary_histogram->SetLineStyle(2);

  TH1F* h_3000_CT_DR10_dphi_SigmaCB_summary_histogram=new TH1F("dphiRes_SigmaCBVsCosTheta_CT_DR10_3000", "#sigma#Delta#phi(j_{reco},j_{true}) vs |cos#theta|", nRegionBinsAngles, pRegionBinEdgesAngles);
  h_3000_CT_DR10_dphi_SigmaCB_summary_histogram ->SetYTitle("#sigma#Delta#phi(j_{reco},j_{true})");
  h_3000_CT_DR10_dphi_SigmaCB_summary_histogram->SetXTitle("|cos#theta|");
  h_3000_CT_DR10_dphi_SigmaCB_summary_histogram->SetLineWidth(2);
  h_3000_CT_DR10_dphi_SigmaCB_summary_histogram->SetLineColor(kCyan+1);
  h_3000_CT_DR10_dphi_SigmaCB_summary_histogram->SetLineStyle(2);

  TH1F* h_3000_CT_DR10_dphi_RMS90_summary_histogram=new TH1F("dphiRes_RMS90VsCosTheta_CT_DR10_3000", "RMS_{90} #Delta#phi(j_{reco},j_{true}) vs |cos#theta|", nRegionBinsAngles, pRegionBinEdgesAngles);
  h_3000_CT_DR10_dphi_RMS90_summary_histogram ->SetYTitle("RMS_{90}#Delta#phi(j_{reco},j_{true})");
  h_3000_CT_DR10_dphi_RMS90_summary_histogram->SetXTitle("|cos#theta|");
  h_3000_CT_DR10_dphi_RMS90_summary_histogram->SetLineWidth(2);
  h_3000_CT_DR10_dphi_RMS90_summary_histogram->SetLineColor(kCyan+1);
  h_3000_CT_DR10_dphi_RMS90_summary_histogram->SetLineStyle(2);

  TH1F* h_3000_CT_DR05_dtheta_SigmaCB_summary_histogram=new TH1F("dthetaRes_SigmaCBVsCosTheta_CT_DR05_3000", "#sigma#Delta#theta(j_{reco},j_{true}) vs |cos#theta|", nRegionBinsAngles, pRegionBinEdgesAngles);
  h_3000_CT_DR05_dtheta_SigmaCB_summary_histogram ->SetYTitle("#sigma#Delta#theta(j_{reco},j_{true})");
  h_3000_CT_DR05_dtheta_SigmaCB_summary_histogram->SetXTitle("|cos#theta|");
  h_3000_CT_DR05_dtheta_SigmaCB_summary_histogram->SetLineWidth(2);
  h_3000_CT_DR05_dtheta_SigmaCB_summary_histogram->SetLineColor(kCyan+1);
  h_3000_CT_DR05_dtheta_SigmaCB_summary_histogram->SetLineStyle(2);

  TH1F* h_3000_CT_DR05_dtheta_RMS90_summary_histogram=new TH1F("dthetaRes_RMS90VsCosTheta_CT_DR05_3000", "RMS_{90} #Delta#theta(j_{reco},j_{true}) vs |cos#theta|", nRegionBinsAngles, pRegionBinEdgesAngles);
  h_3000_CT_DR05_dtheta_RMS90_summary_histogram ->SetYTitle("RMS_{90}#Delta#theta(j_{reco},j_{true})");
  h_3000_CT_DR05_dtheta_RMS90_summary_histogram->SetXTitle("|cos#theta|");
  h_3000_CT_DR05_dtheta_RMS90_summary_histogram->SetLineWidth(2);
  h_3000_CT_DR05_dtheta_RMS90_summary_histogram->SetLineColor(kCyan+1);
  h_3000_CT_DR05_dtheta_RMS90_summary_histogram->SetLineStyle(2);

  TH1F* h_3000_CT_DR07_dtheta_SigmaCB_summary_histogram=new TH1F("dthetaRes_SigmaCBVsCosTheta_CT_DR07_3000", "#sigma#Delta#theta(j_{reco},j_{true}) vs |cos#theta|", nRegionBinsAngles, pRegionBinEdgesAngles);
  h_3000_CT_DR07_dtheta_SigmaCB_summary_histogram ->SetYTitle("#sigma#Delta#theta(j_{reco},j_{true})");
  h_3000_CT_DR07_dtheta_SigmaCB_summary_histogram->SetXTitle("|cos#theta|");
  h_3000_CT_DR07_dtheta_SigmaCB_summary_histogram->SetLineWidth(2);
  h_3000_CT_DR07_dtheta_SigmaCB_summary_histogram->SetLineColor(kCyan+1);
  h_3000_CT_DR07_dtheta_SigmaCB_summary_histogram->SetLineStyle(2);

  TH1F* h_3000_CT_DR07_dtheta_RMS90_summary_histogram=new TH1F("dthetaRes_RMS90VsCosTheta_CT_DR07_3000", "RMS_{90} #Delta#theta(j_{reco},j_{true}) vs |cos#theta|", nRegionBinsAngles, pRegionBinEdgesAngles);
  h_3000_CT_DR07_dtheta_RMS90_summary_histogram ->SetYTitle("RMS_{90}#Delta#theta(j_{reco},j_{true})");
  h_3000_CT_DR07_dtheta_RMS90_summary_histogram->SetXTitle("|cos#theta|");
  h_3000_CT_DR07_dtheta_RMS90_summary_histogram->SetLineWidth(2);
  h_3000_CT_DR07_dtheta_RMS90_summary_histogram->SetLineColor(kCyan+1);
  h_3000_CT_DR07_dtheta_RMS90_summary_histogram->SetLineStyle(2);

  TH1F* h_3000_CT_DR10_dtheta_SigmaCB_summary_histogram=new TH1F("dthetaRes_SigmaCBVsCosTheta_CT_DR10_3000", "#sigma#Delta#theta(j_{reco},j_{true}) vs |cos#theta|", nRegionBinsAngles, pRegionBinEdgesAngles);
  h_3000_CT_DR10_dtheta_SigmaCB_summary_histogram ->SetYTitle("#sigma#Delta#theta(j_{reco},j_{true})");
  h_3000_CT_DR10_dtheta_SigmaCB_summary_histogram->SetXTitle("|cos#theta|");
  h_3000_CT_DR10_dtheta_SigmaCB_summary_histogram->SetLineWidth(2);
  h_3000_CT_DR10_dtheta_SigmaCB_summary_histogram->SetLineColor(kCyan+1);
  h_3000_CT_DR10_dtheta_SigmaCB_summary_histogram->SetLineStyle(2);

  TH1F* h_3000_CT_DR10_dtheta_RMS90_summary_histogram=new TH1F("dthetaRes_RMS90VsCosTheta_CT_DR10_3000", "RMS_{90} #Delta#theta(j_{reco},j_{true}) vs |cos#theta|", nRegionBinsAngles, pRegionBinEdgesAngles);
  h_3000_CT_DR10_dtheta_RMS90_summary_histogram ->SetYTitle("RMS_{90}#Delta#theta(j_{reco},j_{true})");
  h_3000_CT_DR10_dtheta_RMS90_summary_histogram->SetXTitle("|cos#theta|");
  h_3000_CT_DR10_dtheta_RMS90_summary_histogram->SetLineWidth(2);
  h_3000_CT_DR10_dtheta_RMS90_summary_histogram->SetLineColor(kCyan+1);
  h_3000_CT_DR10_dtheta_RMS90_summary_histogram->SetLineStyle(2);

  for(int i=137;i<161;i++){
//continue;
    std::cout<<"ang histo 3000 "<<i<<"]"<<std::endl;
   //double sided crystal ball
    TF1* fit_gaus_tmp = new TF1("fit_gaus_tmp", "gaus",-5.,5.);
    hist_vec_3000_CT[i]->Fit("fit_gaus_tmp","R");
    hist_vec_3000_CT[i]->GetFunction("fit_gaus_tmp");
    TF1* fdscb_tmp = new TF1("fdscb_tmp",fnc_dscb,-lim_angleDeg,lim_angleDeg,7);
   fdscb_tmp->SetNpx(2000);
    fdscb_tmp->SetParameter(0,fit_gaus_tmp->GetParameter(0));
    //norm
    fdscb_tmp->SetParLimits (0,0.5*fit_gaus_tmp->GetParameter(0),1.5*fit_gaus_tmp->GetParameter(0));
    fdscb_tmp->SetParameter(1,fit_gaus_tmp->GetParameter(1));
    //gaussian mean
    fdscb_tmp->SetParLimits (1,-2.,2.);
    fdscb_tmp->SetParameter(2,fit_gaus_tmp->GetParameter(2));
    fdscb_tmp->SetParLimits(2,fit_gaus_tmp->GetParameter(2)*0.50,1.50*fit_gaus_tmp->GetParameter(2));
    //std::vector<float>sigma2SFit=sigmaGaussianFits2Sigma(hist_vec_1500_CT_wO[i]);
    //fdscb_tmp->SetParameter(2,sigma2SFit[0]);
    //fdscb_tmp->SetParLimits(2,sigma2SFit[0]*0.50,1.50*sigma2SFit[0]);
    //-a1: parameter, from when the gaussian core should count
    //fdscb_tmp->SetParameter(2,fit_gaus_tmp->GetParameter(2));
    fdscb_tmp->SetParameter (3,3.0);
    fdscb_tmp->SetParLimits (3,0.0,10.0);
    //a2 parameter, up to when the gaussian core should count
    fdscb_tmp->SetParameter (5,3.0);
    fdscb_tmp->SetParLimits (5,0.0,10.0);
    fdscb_tmp->SetParameter(4,5.);
    fdscb_tmp->SetParLimits(4,0.,25.);
    fdscb_tmp->SetParameter(6,5.);
    fdscb_tmp->SetParLimits(6,0.,25.);
    int fitstatus(0); 
    fitstatus = hist_vec_3000_CT[i]->Fit(fdscb_tmp,"R");
    fdscb_tmp = hist_vec_3000_CT[i]->GetFunction("fdscb_tmp");
    resolutionTH1=0; 
    resolutionErrorTH1=0;
    meanTH1=0;
    meanErrorTH1=0;
    CalculatePerformanceNoMean( hist_vec_3000_CT[i], resolutionTH1, resolutionErrorTH1,meanTH1,meanErrorTH1);
    int first_bin_ang=137;
    if(i<141){//dphi DR05
      first_bin_ang=137;
      h_3000_CT_DR05_dphi_SigmaCB_summary_histogram->SetBinContent(i-first_bin_ang+1,fdscb_tmp->GetParameter(2));
      h_3000_CT_DR05_dphi_SigmaCB_summary_histogram->SetBinError(i-first_bin_ang+1,fdscb_tmp->GetParError(2));
      h_3000_CT_DR05_dphi_RMS90_summary_histogram->SetBinContent(i-first_bin_ang+1,resolutionTH1);
      h_3000_CT_DR05_dphi_RMS90_summary_histogram->SetBinError(i-first_bin_ang+1, resolutionErrorTH1);
    }else if(i<145){//dtheta DR05
      first_bin_ang=141;
      h_3000_CT_DR05_dtheta_SigmaCB_summary_histogram->SetBinContent(i-first_bin_ang+1,fdscb_tmp->GetParameter(2));
      h_3000_CT_DR05_dtheta_SigmaCB_summary_histogram->SetBinError(i-first_bin_ang+1,fdscb_tmp->GetParError(2));
      h_3000_CT_DR05_dtheta_RMS90_summary_histogram->SetBinContent(i-first_bin_ang+1,resolutionTH1);
      h_3000_CT_DR05_dtheta_RMS90_summary_histogram->SetBinError(i-first_bin_ang+1, resolutionErrorTH1);
    }else if(i<149){//dphi DR07
      first_bin_ang=145;
      h_3000_CT_DR07_dphi_SigmaCB_summary_histogram->SetBinContent(i-first_bin_ang+1,fdscb_tmp->GetParameter(2));
      h_3000_CT_DR07_dphi_SigmaCB_summary_histogram->SetBinError(i-first_bin_ang+1,fdscb_tmp->GetParError(2));
      h_3000_CT_DR07_dphi_RMS90_summary_histogram->SetBinContent(i-first_bin_ang+1,resolutionTH1);
      h_3000_CT_DR07_dphi_RMS90_summary_histogram->SetBinError(i-first_bin_ang+1, resolutionErrorTH1);
    }else if(i<153){//dtheta DR07
      first_bin_ang=149;
      h_3000_CT_DR07_dtheta_SigmaCB_summary_histogram->SetBinContent(i-first_bin_ang+1,fdscb_tmp->GetParameter(2));
      h_3000_CT_DR07_dtheta_SigmaCB_summary_histogram->SetBinError(i-first_bin_ang+1,fdscb_tmp->GetParError(2));
      h_3000_CT_DR07_dtheta_RMS90_summary_histogram->SetBinContent(i-first_bin_ang+1,resolutionTH1);
      h_3000_CT_DR07_dtheta_RMS90_summary_histogram->SetBinError(i-first_bin_ang+1, resolutionErrorTH1);
    }else if(i<157){//dphi DR07
      first_bin_ang=153;
      h_3000_CT_DR10_dphi_SigmaCB_summary_histogram->SetBinContent(i-first_bin_ang+1,fdscb_tmp->GetParameter(2));
      h_3000_CT_DR10_dphi_SigmaCB_summary_histogram->SetBinError(i-first_bin_ang+1,fdscb_tmp->GetParError(2));
      h_3000_CT_DR10_dphi_RMS90_summary_histogram->SetBinContent(i-first_bin_ang+1,resolutionTH1);
      h_3000_CT_DR10_dphi_RMS90_summary_histogram->SetBinError(i-first_bin_ang+1, resolutionErrorTH1);
    }else if(i<161){//dtheta DR07
      first_bin_ang=157;
      h_3000_CT_DR10_dtheta_SigmaCB_summary_histogram->SetBinContent(i-first_bin_ang+1,fdscb_tmp->GetParameter(2));
      h_3000_CT_DR10_dtheta_SigmaCB_summary_histogram->SetBinError(i-first_bin_ang+1,fdscb_tmp->GetParError(2));
      h_3000_CT_DR10_dtheta_RMS90_summary_histogram->SetBinContent(i-first_bin_ang+1,resolutionTH1);
      h_3000_CT_DR10_dtheta_RMS90_summary_histogram->SetBinError(i-first_bin_ang+1, resolutionErrorTH1);
    }
  }

  TH1F* h_3000_CT_DR05_E_SigmaCB_summary_histogram=new TH1F("JERSigmaCBVsCosTheta_CT_DR05_3000", "#sigma (E_{j}^{reco} / E_{j}^{true}) vs |cos#theta|", nRegionBins, pRegionBinEdges);
  h_3000_CT_DR05_E_SigmaCB_summary_histogram ->SetYTitle("#sigma(E_{j}) / E_{j} [%]");
  h_3000_CT_DR05_E_SigmaCB_summary_histogram->SetXTitle("|cos#theta|");
  h_3000_CT_DR05_E_SigmaCB_summary_histogram->SetLineWidth(2);
  h_3000_CT_DR05_E_SigmaCB_summary_histogram->SetLineColor(kRed);
  h_3000_CT_DR05_E_SigmaCB_summary_histogram->SetLineStyle(2);
  TH1F* h_3000_CT_DR05_E_RMS90_summary_histogram=new TH1F("JER_RMS90VsCosTheta_CT_DR05_3000", "RMS_{90}(E_{j}^{reco}/E_{j}^{gen}) / Mean_{90}(E_{j}^{reco}/E_{j}^{gen}) vs |cos#theta|", nRegionBins, pRegionBinEdges);
  h_3000_CT_DR05_E_RMS90_summary_histogram ->SetYTitle("RMS_{90}(E_{j}^{reco}/E_{j}^{gen}) / Mean_{90}(E_{j}^{reco}/E_{j}^{gen}) [%]");
  h_3000_CT_DR05_E_RMS90_summary_histogram->SetXTitle("|cos#theta|");
  h_3000_CT_DR05_E_RMS90_summary_histogram->SetLineWidth(2);
  h_3000_CT_DR05_E_RMS90_summary_histogram->SetLineColor(kRed);
  h_3000_CT_DR05_E_RMS90_summary_histogram->SetLineStyle(2);

  TH1F* h_3000_CT_DR05_E_RMS_summary_histogram=new TH1F("JER_RMSVsCosTheta_CT_DR05_3000", "RMS(E_{j}) / Mean(E_{j}) vs |cos#theta|", nRegionBins, pRegionBinEdges);
  h_3000_CT_DR05_E_RMS_summary_histogram ->SetYTitle("RMS(E_{j}) / Mean(E_{j}) [%]");
  h_3000_CT_DR05_E_RMS_summary_histogram->SetXTitle("|cos#theta|");
  h_3000_CT_DR05_E_RMS_summary_histogram->SetLineWidth(2);
  h_3000_CT_DR05_E_RMS_summary_histogram->SetLineColor(kRed);
  h_3000_CT_DR05_E_RMS_summary_histogram->SetLineStyle(2);

  TH1F* h_3000_CT_DR05_E_JER_Mean_summary_histogram=new TH1F("JER_MeanVsCosTheta_CT_DR05_3000", "Mean(E_{tot}^{RECO}/E_{tot}^{true}) vs |cos#theta|", nRegionBins, pRegionBinEdges);
  h_3000_CT_DR05_E_JER_Mean_summary_histogram->SetYTitle("Mean(E_{tot}^{RECO}/E_{tot}^{true})");
  h_3000_CT_DR05_E_JER_Mean_summary_histogram->SetXTitle("|cos#theta|");
  h_3000_CT_DR05_E_JER_Mean_summary_histogram->SetLineWidth(2);
  h_3000_CT_DR05_E_JER_Mean_summary_histogram->SetLineColor(kRed);
  h_3000_CT_DR05_E_JER_Mean_summary_histogram->SetLineStyle(2);

  firstbin=59;
  for(int i=firstbin;i<(firstbin+13);i++){
//continue;
    resolutionTH1=0; 
    resolutionErrorTH1=0;
    meanTH1=0;
    meanErrorTH1=0;
    CalculatePerformance( hist_vec_3000_CT[i], resolutionTH1, resolutionErrorTH1,meanTH1,meanErrorTH1);
    h_3000_CT_DR05_E_RMS90_summary_histogram->SetBinContent(i-firstbin+1,resolutionTH1/sqrt(2.));
    h_3000_CT_DR05_E_RMS90_summary_histogram ->SetBinError(i-firstbin+1, resolutionErrorTH1/sqrt(2.));
    h_3000_CT_DR05_E_RMS_summary_histogram->SetBinContent(i-firstbin+1,hist_vec_3000_CT[i]->GetRMS()*100. );
    h_3000_CT_DR05_E_RMS_summary_histogram ->SetBinError(i-firstbin+1, hist_vec_3000_CT[i]->GetRMSError()*100.);
    h_3000_CT_DR05_E_JER_Mean_summary_histogram->SetBinContent(i-firstbin+1,hist_vec_3000_CT[i]->GetMean());
    h_3000_CT_DR05_E_JER_Mean_summary_histogram->SetBinError(i-firstbin+1,hist_vec_3000_CT[i]->GetMeanError());
    //double sided crystal ball
    TF1* fit_gaus_tmp = new TF1("fit_gaus_tmp", "gaus",0.50,1.50);
    hist_vec_3000_CT[i]->Fit("fit_gaus_tmp","R");
    hist_vec_3000_CT[i]->GetFunction("fit_gaus_tmp");
    TF1* fdscb_tmp = new TF1("fdscb_tmp",fnc_dscb,0.,3.,7);
    fdscb_tmp->SetNpx(1000);
    fdscb_tmp->SetParameter(0,fit_gaus_tmp->GetParameter(0));
    //norm
    fdscb_tmp->SetParLimits (0,0.5*fit_gaus_tmp->GetParameter(0),1.5*fit_gaus_tmp->GetParameter(0));
    fdscb_tmp->SetParameter(1,fit_gaus_tmp->GetParameter(1));
    //gaussian mean
    fdscb_tmp->SetParLimits (1,0.8,1.2);
    //fdscb_tmp->SetParameter(2,fit_gaus_tmp->GetParameter(2));
    //fdscb_tmp->SetParLimits(2,fit_gaus_tmp->GetParameter(2)*0.50,1.50*fit_gaus_tmp->GetParameter(2));
    std::vector<float>sigma2SFit=sigmaGaussianFits2Sigma(hist_vec_3000_CT[i]);
    fdscb_tmp->SetParameter(2,sigma2SFit[0]);
    fdscb_tmp->SetParLimits(2,sigma2SFit[0]*0.50,1.50*sigma2SFit[0]);
    //-a1: parameter, from when the gaussian core should count
    fdscb_tmp->SetParameter(2,fit_gaus_tmp->GetParameter(2));
    fdscb_tmp->SetParameter (3,3.0);
    fdscb_tmp->SetParLimits (3,0.0,10.0);
    //a2 parameter, up to when the gaussian core should count
    fdscb_tmp->SetParameter (5,3.0);
    fdscb_tmp->SetParLimits (5,0.0,10.0);
    fdscb_tmp->SetParameter(4,5.);
    fdscb_tmp->SetParLimits(4,0.,25.);
    fdscb_tmp->SetParameter(6,5.);
    fdscb_tmp->SetParLimits(6,0.,25.);
    int fitstatus(0); 
    fitstatus = hist_vec_3000_CT[i]->Fit(fdscb_tmp,"R");
    fdscb_tmp = hist_vec_3000_CT[i]->GetFunction("fdscb_tmp");
    h_3000_CT_DR05_E_SigmaCB_summary_histogram->SetBinContent(i-firstbin+1,fdscb_tmp->GetParameter(2)*100. );
    h_3000_CT_DR05_E_SigmaCB_summary_histogram->SetBinError(i-firstbin+1,fdscb_tmp->GetParError(2)*100. );
  }  
  TH1F* h_3000_CT_DR06_E_SigmaCB_summary_histogram=new TH1F("JER_SigmaCBVsCosTheta_CT_DR06_3000", "#sigma (E_{j}^{reco} / E_{j}^{true}) vs |cos#theta|", nRegionBins, pRegionBinEdges);
  h_3000_CT_DR06_E_SigmaCB_summary_histogram ->SetYTitle("#sigma(E_{j}) / E_{j} [%]");
  h_3000_CT_DR06_E_SigmaCB_summary_histogram->SetXTitle("|cos#theta|");
  h_3000_CT_DR06_E_SigmaCB_summary_histogram->SetLineWidth(2);
  h_3000_CT_DR06_E_SigmaCB_summary_histogram->SetLineColor(kRed);
  h_3000_CT_DR06_E_SigmaCB_summary_histogram->SetLineStyle(2);
  TH1F* h_3000_CT_DR06_E_RMS90_summary_histogram=new TH1F("JER_RMS90VsCosTheta_CT_DR06_3000", "RMS_{90}(E_{j}^{reco}/E_{j}^{gen}) / Mean_{90}(E_{j}^{reco}/E_{j}^{gen}) vs |cos#theta|", nRegionBins, pRegionBinEdges);
  h_3000_CT_DR06_E_RMS90_summary_histogram ->SetYTitle("RMS_{90}(E_{j}^{reco}/E_{j}^{gen}) / Mean_{90}(E_{j}^{reco}/E_{j}^{gen}) [%]");
  h_3000_CT_DR06_E_RMS90_summary_histogram->SetXTitle("|cos#theta|");
  h_3000_CT_DR06_E_RMS90_summary_histogram->SetLineWidth(2);
  h_3000_CT_DR06_E_RMS90_summary_histogram->SetLineColor(kRed);
  h_3000_CT_DR06_E_RMS90_summary_histogram->SetLineStyle(2);

  TH1F* h_3000_CT_DR06_E_RMS_summary_histogram=new TH1F("JER_RMSVsCosTheta_CT_DR06_3000", "RMS(E_{j}) / Mean(E_{j}) vs |cos#theta|", nRegionBins, pRegionBinEdges);
  h_3000_CT_DR06_E_RMS_summary_histogram ->SetYTitle("RMS(E_{j}) / Mean(E_{j}) [%]");
  h_3000_CT_DR06_E_RMS_summary_histogram->SetXTitle("|cos#theta|");
  h_3000_CT_DR06_E_RMS_summary_histogram->SetLineWidth(2);
  h_3000_CT_DR06_E_RMS_summary_histogram->SetLineColor(kRed);
  h_3000_CT_DR06_E_RMS_summary_histogram->SetLineStyle(2);

  TH1F* h_3000_CT_DR06_E_JER_Mean_summary_histogram=new TH1F("JER_MeanVsCosTheta_CT_DR06_3000", "Mean(E_{tot}^{RECO}/E_{tot}^{true}) vs |cos#theta|", nRegionBins, pRegionBinEdges);
  h_3000_CT_DR06_E_JER_Mean_summary_histogram->SetYTitle("Mean(E_{tot}^{RECO}/E_{tot}^{true})");
  h_3000_CT_DR06_E_JER_Mean_summary_histogram->SetXTitle("|cos#theta|");
  h_3000_CT_DR06_E_JER_Mean_summary_histogram->SetLineWidth(2);
  h_3000_CT_DR06_E_JER_Mean_summary_histogram->SetLineColor(kRed);
  h_3000_CT_DR06_E_JER_Mean_summary_histogram->SetLineStyle(2);
  firstbin=72;
  for(int i=firstbin;i<(firstbin+13);i++){
//continue;
    resolutionTH1=0; 
    resolutionErrorTH1=0;
    meanTH1=0;
    meanErrorTH1=0;
    CalculatePerformance( hist_vec_3000_CT[i], resolutionTH1, resolutionErrorTH1,meanTH1,meanErrorTH1);
    h_3000_CT_DR06_E_RMS90_summary_histogram->SetBinContent(i-firstbin+1,resolutionTH1/sqrt(2.));
    h_3000_CT_DR06_E_RMS90_summary_histogram ->SetBinError(i-firstbin+1, resolutionErrorTH1/sqrt(2.));
    h_3000_CT_DR06_E_RMS_summary_histogram->SetBinContent(i-firstbin+1,hist_vec_3000_CT[i]->GetRMS()*100. );
    h_3000_CT_DR06_E_RMS_summary_histogram ->SetBinError(i-firstbin+1, hist_vec_3000_CT[i]->GetRMSError()*100.);
    h_3000_CT_DR06_E_JER_Mean_summary_histogram->SetBinContent(i-firstbin+1,hist_vec_3000_CT[i]->GetMean());
    h_3000_CT_DR06_E_JER_Mean_summary_histogram->SetBinError(i-firstbin+1,hist_vec_3000_CT[i]->GetMeanError());
    //double sided crystal ball
    TF1* fit_gaus_tmp = new TF1("fit_gaus_tmp", "gaus",0.50,1.50);
    hist_vec_3000_CT[i]->Fit("fit_gaus_tmp","R");
    hist_vec_3000_CT[i]->GetFunction("fit_gaus_tmp");
    TF1* fdscb_tmp = new TF1("fdscb_tmp",fnc_dscb,0.,3.,7);
   fdscb_tmp->SetNpx(1000);
    fdscb_tmp->SetParameter(0,fit_gaus_tmp->GetParameter(0));
    //norm
    fdscb_tmp->SetParLimits (0,0.5*fit_gaus_tmp->GetParameter(0),1.5*fit_gaus_tmp->GetParameter(0));
    fdscb_tmp->SetParameter(1,fit_gaus_tmp->GetParameter(1));
    //gaussian mean
    fdscb_tmp->SetParLimits (1,0.8,1.2);
    //fdscb_tmp->SetParameter(2,fit_gaus_tmp->GetParameter(2));
    //fdscb_tmp->SetParLimits(2,fit_gaus_tmp->GetParameter(2)*0.50,1.50*fit_gaus_tmp->GetParameter(2));
    std::vector<float>sigma2SFit=sigmaGaussianFits2Sigma(hist_vec_3000_CT[i]);
    fdscb_tmp->SetParameter(2,sigma2SFit[0]);
    fdscb_tmp->SetParLimits(2,sigma2SFit[0]*0.50,1.50*sigma2SFit[0]);
    //-a1: parameter, from when the gaussian core should count
    fdscb_tmp->SetParameter(2,fit_gaus_tmp->GetParameter(2));
    fdscb_tmp->SetParameter (3,3.0);
    fdscb_tmp->SetParLimits (3,0.0,10.0);
    //a2 parameter, up to when the gaussian core should count
    fdscb_tmp->SetParameter (5,3.0);
    fdscb_tmp->SetParLimits (5,0.0,10.0);
    fdscb_tmp->SetParameter(4,5.);
    fdscb_tmp->SetParLimits(4,0.,25.);
    fdscb_tmp->SetParameter(6,5.);
    fdscb_tmp->SetParLimits(6,0.,25.);
    int fitstatus(0); 
    fitstatus = hist_vec_3000_CT[i]->Fit(fdscb_tmp,"R");
    fdscb_tmp = hist_vec_3000_CT[i]->GetFunction("fdscb_tmp");
    h_3000_CT_DR06_E_SigmaCB_summary_histogram->SetBinContent(i-firstbin+1,fdscb_tmp->GetParameter(2)*100. );
    h_3000_CT_DR06_E_SigmaCB_summary_histogram->SetBinError(i-firstbin+1,fdscb_tmp->GetParError(2)*100. );
  }  
  TH1F* h_3000_CT_DR07_E_SigmaCB_summary_histogram=new TH1F("JER_SigmaCBVsCosTheta_CT_DR07_3000", "#sigma (E_{j}^{reco} / E_{j}^{true}) vs |cos#theta|", nRegionBins, pRegionBinEdges);
  h_3000_CT_DR07_E_SigmaCB_summary_histogram ->SetYTitle("#sigma(E_{j}) / E_{j} [%]");
  h_3000_CT_DR07_E_SigmaCB_summary_histogram->SetXTitle("|cos#theta|");
  h_3000_CT_DR07_E_SigmaCB_summary_histogram->SetLineWidth(2);
  h_3000_CT_DR07_E_SigmaCB_summary_histogram->SetLineColor(kRed);
  h_3000_CT_DR07_E_SigmaCB_summary_histogram->SetLineStyle(2);
  TH1F* h_3000_CT_DR07_E_RMS90_summary_histogram=new TH1F("JER_RMS90VsCosTheta_CT_DR07_3000", "RMS_{90}(E_{j}^{reco}/E_{j}^{gen}) / Mean_{90}(E_{j}^{reco}/E_{j}^{gen}) vs |cos#theta|", nRegionBins, pRegionBinEdges);
  h_3000_CT_DR07_E_RMS90_summary_histogram ->SetYTitle("RMS_{90}(E_{j}^{reco}/E_{j}^{gen}) / Mean_{90}(E_{j}^{reco}/E_{j}^{gen}) [%]");
  h_3000_CT_DR07_E_RMS90_summary_histogram->SetXTitle("|cos#theta|");
  h_3000_CT_DR07_E_RMS90_summary_histogram->SetLineWidth(2);
  h_3000_CT_DR07_E_RMS90_summary_histogram->SetLineColor(kRed);
  h_3000_CT_DR07_E_RMS90_summary_histogram->SetLineStyle(2);

  TH1F* h_3000_CT_DR07_E_RMS_summary_histogram=new TH1F("JER_RMSVsCosTheta_CT_DR07_3000", "RMS(E_{j}) / Mean(E_{j}) vs |cos#theta|", nRegionBins, pRegionBinEdges);
  h_3000_CT_DR07_E_RMS_summary_histogram ->SetYTitle("RMS(E_{j}) / Mean(E_{j}) [%]");
  h_3000_CT_DR07_E_RMS_summary_histogram->SetXTitle("|cos#theta|");
  h_3000_CT_DR07_E_RMS_summary_histogram->SetLineWidth(2);
  h_3000_CT_DR07_E_RMS_summary_histogram->SetLineColor(kRed);
  h_3000_CT_DR07_E_RMS_summary_histogram->SetLineStyle(2);

  TH1F* h_3000_CT_DR07_E_JER_Mean_summary_histogram=new TH1F("JER_MeanVsCosTheta_CT_DR07_3000", "Mean(E_{tot}^{RECO}/E_{tot}^{true}) vs |cos#theta|", nRegionBins, pRegionBinEdges);
  h_3000_CT_DR07_E_JER_Mean_summary_histogram->SetYTitle("Mean(E_{tot}^{RECO}/E_{tot}^{true})");
  h_3000_CT_DR07_E_JER_Mean_summary_histogram->SetXTitle("|cos#theta|");
  h_3000_CT_DR07_E_JER_Mean_summary_histogram->SetLineWidth(2);
  h_3000_CT_DR07_E_JER_Mean_summary_histogram->SetLineColor(kRed);
  h_3000_CT_DR07_E_JER_Mean_summary_histogram->SetLineStyle(2);
  firstbin=85;
 std::cout<<"start DR07 3000"<<std::endl;
  for(int i=firstbin;i<(firstbin+13);i++){
    //continue;
    resolutionTH1=0; 
    resolutionErrorTH1=0;
    meanTH1=0;
    meanErrorTH1=0;
    CalculatePerformance( hist_vec_3000_CT[i], resolutionTH1, resolutionErrorTH1,meanTH1,meanErrorTH1);
    h_3000_CT_DR07_E_RMS90_summary_histogram->SetBinContent(i-firstbin+1,resolutionTH1/sqrt(2.));
    h_3000_CT_DR07_E_RMS90_summary_histogram ->SetBinError(i-firstbin+1, resolutionErrorTH1/sqrt(2.));
    h_3000_CT_DR07_E_RMS_summary_histogram->SetBinContent(i-firstbin+1,hist_vec_3000_CT[i]->GetRMS()*100. );
    h_3000_CT_DR07_E_RMS_summary_histogram ->SetBinError(i-firstbin+1, hist_vec_3000_CT[i]->GetRMSError()*100.);
    h_3000_CT_DR07_E_JER_Mean_summary_histogram->SetBinContent(i-firstbin+1,hist_vec_3000_CT[i]->GetMean());
    h_3000_CT_DR07_E_JER_Mean_summary_histogram->SetBinError(i-firstbin+1,hist_vec_3000_CT[i]->GetMeanError());
    //double sided crystal ball
    TF1* fit_gaus_tmp = new TF1("fit_gaus_tmp", "gaus",0.50,1.50);
    hist_vec_3000_CT[i]->Fit("fit_gaus_tmp","R");
    hist_vec_3000_CT[i]->GetFunction("fit_gaus_tmp");
    TF1* fdscb_tmp = new TF1("fdscb_tmp",fnc_dscb,0.,3.,7);
    fdscb_tmp->SetNpx(1000);
    fdscb_tmp->SetParameter(0,fit_gaus_tmp->GetParameter(0));
    //norm
    fdscb_tmp->SetParLimits (0,0.5*fit_gaus_tmp->GetParameter(0),1.5*fit_gaus_tmp->GetParameter(0));
    fdscb_tmp->SetParameter(1,fit_gaus_tmp->GetParameter(1));
    //gaussian mean
    fdscb_tmp->SetParLimits (1,0.8,1.2);
    //fdscb_tmp->SetParameter(2,fit_gaus_tmp->GetParameter(2));
    //fdscb_tmp->SetParLimits(2,fit_gaus_tmp->GetParameter(2)*0.50,1.50*fit_gaus_tmp->GetParameter(2));
    std::vector<float>sigma2SFit=sigmaGaussianFits2Sigma(hist_vec_3000_CT[i]);
    fdscb_tmp->SetParameter(2,sigma2SFit[0]);
    fdscb_tmp->SetParLimits(2,sigma2SFit[0]*0.50,1.50*sigma2SFit[0]);
    //-a1: parameter, from when the gaussian core should count
    //fdscb_tmp->SetParameter(2,fit_gaus_tmp->GetParameter(2));
    fdscb_tmp->SetParameter (3,3.0);
    fdscb_tmp->SetParLimits (3,0.0,10.0);
    //a2 parameter, up to when the gaussian core should count
    fdscb_tmp->SetParameter (5,3.0);
    fdscb_tmp->SetParLimits (5,0.0,10.0);
    fdscb_tmp->SetParameter(4,5.);
    fdscb_tmp->SetParLimits(4,0.,25.);
    fdscb_tmp->SetParameter(6,5.);
    fdscb_tmp->SetParLimits(6,0.,25.);
    int fitstatus(0); 
    fitstatus = hist_vec_3000_CT[i]->Fit(fdscb_tmp,"R");
    fdscb_tmp = hist_vec_3000_CT[i]->GetFunction("fdscb_tmp");
    h_3000_CT_DR07_E_SigmaCB_summary_histogram->SetBinContent(i-firstbin+1,fdscb_tmp->GetParameter(2)*100. );
    h_3000_CT_DR07_E_SigmaCB_summary_histogram->SetBinError(i-firstbin+1,fdscb_tmp->GetParError(2)*100. );
  }  
 std::cout<<"end DR07 3000"<<std::endl;

  TH1F* h_3000_CT_DR08_E_SigmaCB_summary_histogram=new TH1F("JER_SigmaCBVsCosTheta_CT_DR08_3000", "#sigma (E_{j}^{reco} / E_{j}^{true}) vs |cos#theta|", nRegionBins, pRegionBinEdges);
  h_3000_CT_DR08_E_SigmaCB_summary_histogram ->SetYTitle("#sigma(E_{j}) / E_{j} [%]");
  h_3000_CT_DR08_E_SigmaCB_summary_histogram->SetXTitle("|cos#theta|");
  h_3000_CT_DR08_E_SigmaCB_summary_histogram->SetLineWidth(2);
  h_3000_CT_DR08_E_SigmaCB_summary_histogram->SetLineColor(kRed);
  h_3000_CT_DR08_E_SigmaCB_summary_histogram->SetLineStyle(2);
  TH1F* h_3000_CT_DR08_E_RMS90_summary_histogram=new TH1F("JER_RMS90VsCosTheta_CT_DR08_3000", "RMS_{90}(E_{j}^{reco}/E_{j}^{gen}) / Mean_{90}(E_{j}^{reco}/E_{j}^{gen}) vs |cos#theta|", nRegionBins, pRegionBinEdges);
  h_3000_CT_DR08_E_RMS90_summary_histogram ->SetYTitle("RMS_{90}(E_{j}^{reco}/E_{j}^{gen}) / Mean_{90}(E_{j}^{reco}/E_{j}^{gen}) [%]");
  h_3000_CT_DR08_E_RMS90_summary_histogram->SetXTitle("|cos#theta|");
  h_3000_CT_DR08_E_RMS90_summary_histogram->SetLineWidth(2);
  h_3000_CT_DR08_E_RMS90_summary_histogram->SetLineColor(kRed);
  h_3000_CT_DR08_E_RMS90_summary_histogram->SetLineStyle(2);

  TH1F* h_3000_CT_DR08_E_RMS_summary_histogram=new TH1F("JER_RMSVsCosTheta_CT_DR08_3000", "RMS(E_{j}) / Mean(E_{j}) vs |cos#theta|", nRegionBins, pRegionBinEdges);
  h_3000_CT_DR08_E_RMS_summary_histogram ->SetYTitle("RMS(E_{j}) / Mean(E_{j}) [%]");
  h_3000_CT_DR08_E_RMS_summary_histogram->SetXTitle("|cos#theta|");
  h_3000_CT_DR08_E_RMS_summary_histogram->SetLineWidth(2);
  h_3000_CT_DR08_E_RMS_summary_histogram->SetLineColor(kRed);
  h_3000_CT_DR08_E_RMS_summary_histogram->SetLineStyle(2);

  TH1F* h_3000_CT_DR08_E_JER_Mean_summary_histogram=new TH1F("JER_MeanVsCosTheta_CT_DR08_3000", "Mean(E_{tot}^{RECO}/E_{tot}^{true}) vs |cos#theta|", nRegionBins, pRegionBinEdges);
  h_3000_CT_DR08_E_JER_Mean_summary_histogram->SetYTitle("Mean(E_{tot}^{RECO}/E_{tot}^{true})");
  h_3000_CT_DR08_E_JER_Mean_summary_histogram->SetXTitle("|cos#theta|");
  h_3000_CT_DR08_E_JER_Mean_summary_histogram->SetLineWidth(2);
  h_3000_CT_DR08_E_JER_Mean_summary_histogram->SetLineColor(kRed);
  h_3000_CT_DR08_E_JER_Mean_summary_histogram->SetLineStyle(2);
  firstbin=98;
  for(int i=firstbin;i<(firstbin+13);i++){
//continue;
    resolutionTH1=0; 
    resolutionErrorTH1=0;
    meanTH1=0;
    meanErrorTH1=0;
    CalculatePerformance( hist_vec_3000_CT[i], resolutionTH1, resolutionErrorTH1,meanTH1,meanErrorTH1);
    h_3000_CT_DR08_E_RMS90_summary_histogram->SetBinContent(i-firstbin+1,resolutionTH1/sqrt(2.));
    h_3000_CT_DR08_E_RMS90_summary_histogram ->SetBinError(i-firstbin+1, resolutionErrorTH1/sqrt(2.));
    h_3000_CT_DR08_E_RMS_summary_histogram->SetBinContent(i-firstbin+1,hist_vec_3000_CT[i]->GetRMS()*100. );
    h_3000_CT_DR08_E_RMS_summary_histogram ->SetBinError(i-firstbin+1, hist_vec_3000_CT[i]->GetRMSError()*100.);
    h_3000_CT_DR08_E_JER_Mean_summary_histogram->SetBinContent(i-firstbin+1,hist_vec_3000_CT[i]->GetMean());
    h_3000_CT_DR08_E_JER_Mean_summary_histogram->SetBinError(i-firstbin+1,hist_vec_3000_CT[i]->GetMeanError());
    //double sided crystal ball
    TF1* fit_gaus_tmp = new TF1("fit_gaus_tmp", "gaus",0.50,1.50);
    hist_vec_3000_CT[i]->Fit("fit_gaus_tmp","R");
    hist_vec_3000_CT[i]->GetFunction("fit_gaus_tmp");
    TF1* fdscb_tmp = new TF1("fdscb_tmp",fnc_dscb,0.,3.,7);
   fdscb_tmp->SetNpx(1000);
    fdscb_tmp->SetParameter(0,fit_gaus_tmp->GetParameter(0));
    //norm
    fdscb_tmp->SetParLimits (0,0.5*fit_gaus_tmp->GetParameter(0),1.5*fit_gaus_tmp->GetParameter(0));
    fdscb_tmp->SetParameter(1,fit_gaus_tmp->GetParameter(1));
    //gaussian mean
    fdscb_tmp->SetParLimits (1,0.8,1.2);
    //fdscb_tmp->SetParameter(2,fit_gaus_tmp->GetParameter(2));
    //fdscb_tmp->SetParLimits(2,fit_gaus_tmp->GetParameter(2)*0.50,1.50*fit_gaus_tmp->GetParameter(2));
    std::vector<float>sigma2SFit=sigmaGaussianFits2Sigma(hist_vec_3000_CT[i]);
    fdscb_tmp->SetParameter(2,sigma2SFit[0]);
    fdscb_tmp->SetParLimits(2,sigma2SFit[0]*0.50,1.50*sigma2SFit[0]);
    //-a1: parameter, from when the gaussian core should count
    fdscb_tmp->SetParameter(2,fit_gaus_tmp->GetParameter(2));
    fdscb_tmp->SetParameter (3,3.0);
    fdscb_tmp->SetParLimits (3,0.0,10.0);
    //a2 parameter, up to when the gaussian core should count
    fdscb_tmp->SetParameter (5,3.0);
    fdscb_tmp->SetParLimits (5,0.0,10.0);
    fdscb_tmp->SetParameter(4,5.);
    fdscb_tmp->SetParLimits(4,0.,25.);
    fdscb_tmp->SetParameter(6,5.);
    fdscb_tmp->SetParLimits(6,0.,25.);
    int fitstatus(0); 
    fitstatus = hist_vec_3000_CT[i]->Fit(fdscb_tmp,"R");
    fdscb_tmp = hist_vec_3000_CT[i]->GetFunction("fdscb_tmp");
    h_3000_CT_DR08_E_SigmaCB_summary_histogram->SetBinContent(i-firstbin+1,fdscb_tmp->GetParameter(2)*100. );
    h_3000_CT_DR08_E_SigmaCB_summary_histogram->SetBinError(i-firstbin+1,fdscb_tmp->GetParError(2)*100. );
  }  
  TH1F* h_3000_CT_DR09_E_SigmaCB_summary_histogram=new TH1F("JER_SigmaCBVsCosTheta_CT_DR09_3000", "#sigma (E_{j}^{reco} / E_{j}^{true}) vs |cos#theta|", nRegionBins, pRegionBinEdges);
  h_3000_CT_DR09_E_SigmaCB_summary_histogram ->SetYTitle("#sigma(E_{j}) / E_{j} [%]");
  h_3000_CT_DR09_E_SigmaCB_summary_histogram->SetXTitle("|cos#theta|");
  h_3000_CT_DR09_E_SigmaCB_summary_histogram->SetLineWidth(2);
  h_3000_CT_DR09_E_SigmaCB_summary_histogram->SetLineColor(kRed);
  h_3000_CT_DR09_E_SigmaCB_summary_histogram->SetLineStyle(2);
  TH1F* h_3000_CT_DR09_E_RMS90_summary_histogram=new TH1F("JER_RMS90VsCosTheta_CT_DR09_3000", "RMS_{90}(E_{j}^{reco}/E_{j}^{gen}) / Mean_{90}(E_{j}^{reco}/E_{j}^{gen}) vs |cos#theta|", nRegionBins, pRegionBinEdges);
  h_3000_CT_DR09_E_RMS90_summary_histogram ->SetYTitle("RMS_{90}(E_{j}^{reco}/E_{j}^{gen}) / Mean_{90}(E_{j}^{reco}/E_{j}^{gen}) [%]");
  h_3000_CT_DR09_E_RMS90_summary_histogram->SetXTitle("|cos#theta|");
  h_3000_CT_DR09_E_RMS90_summary_histogram->SetLineWidth(2);
  h_3000_CT_DR09_E_RMS90_summary_histogram->SetLineColor(kRed);
  h_3000_CT_DR09_E_RMS90_summary_histogram->SetLineStyle(2);

  TH1F* h_3000_CT_DR09_E_RMS_summary_histogram=new TH1F("JER_RMSVsCosTheta_CT_DR09_3000", "RMS(E_{j}) / Mean(E_{j}) vs |cos#theta|", nRegionBins, pRegionBinEdges);
  h_3000_CT_DR09_E_RMS_summary_histogram ->SetYTitle("RMS(E_{j}) / Mean(E_{j}) [%]");
  h_3000_CT_DR09_E_RMS_summary_histogram->SetXTitle("|cos#theta|");
  h_3000_CT_DR09_E_RMS_summary_histogram->SetLineWidth(2);
  h_3000_CT_DR09_E_RMS_summary_histogram->SetLineColor(kRed);
  h_3000_CT_DR09_E_RMS_summary_histogram->SetLineStyle(2);

  TH1F* h_3000_CT_DR09_E_JER_Mean_summary_histogram=new TH1F("JER_MeanVsCosTheta_CT_DR09_3000", "Mean(E_{tot}^{RECO}/E_{tot}^{true}) vs |cos#theta|", nRegionBins, pRegionBinEdges);
  h_3000_CT_DR09_E_JER_Mean_summary_histogram->SetYTitle("Mean(E_{tot}^{RECO}/E_{tot}^{true})");
  h_3000_CT_DR09_E_JER_Mean_summary_histogram->SetXTitle("|cos#theta|");
  h_3000_CT_DR09_E_JER_Mean_summary_histogram->SetLineWidth(2);
  h_3000_CT_DR09_E_JER_Mean_summary_histogram->SetLineColor(kRed);
  h_3000_CT_DR09_E_JER_Mean_summary_histogram->SetLineStyle(2);
  firstbin=111;
  for(int i=firstbin;i<(firstbin+13);i++){
//continue;
    resolutionTH1=0; 
    resolutionErrorTH1=0;
    meanTH1=0;
    meanErrorTH1=0;
    CalculatePerformance( hist_vec_3000_CT[i], resolutionTH1, resolutionErrorTH1,meanTH1,meanErrorTH1);
    h_3000_CT_DR09_E_RMS90_summary_histogram->SetBinContent(i-firstbin+1,resolutionTH1/sqrt(2.));
    h_3000_CT_DR09_E_RMS90_summary_histogram ->SetBinError(i-firstbin+1, resolutionErrorTH1/sqrt(2.));
    h_3000_CT_DR09_E_RMS_summary_histogram->SetBinContent(i-firstbin+1,hist_vec_3000_CT[i]->GetRMS()*100. );
    h_3000_CT_DR09_E_RMS_summary_histogram ->SetBinError(i-firstbin+1, hist_vec_3000_CT[i]->GetRMSError()*100.);
    h_3000_CT_DR09_E_JER_Mean_summary_histogram->SetBinContent(i-firstbin+1,hist_vec_3000_CT[i]->GetMean());
    h_3000_CT_DR09_E_JER_Mean_summary_histogram->SetBinError(i-firstbin+1,hist_vec_3000_CT[i]->GetMeanError());
    //double sided crystal ball
    TF1* fit_gaus_tmp = new TF1("fit_gaus_tmp", "gaus",0.50,1.50);
    hist_vec_3000_CT[i]->Fit("fit_gaus_tmp","R");
    hist_vec_3000_CT[i]->GetFunction("fit_gaus_tmp");
    TF1* fdscb_tmp = new TF1("fdscb_tmp",fnc_dscb,0.,3.,7);
   fdscb_tmp->SetNpx(1000);
    fdscb_tmp->SetParameter(0,fit_gaus_tmp->GetParameter(0));
    //norm
    fdscb_tmp->SetParLimits (0,0.5*fit_gaus_tmp->GetParameter(0),1.5*fit_gaus_tmp->GetParameter(0));
    fdscb_tmp->SetParameter(1,fit_gaus_tmp->GetParameter(1));
    //gaussian mean
    fdscb_tmp->SetParLimits (1,0.8,1.2);
    //fdscb_tmp->SetParameter(2,fit_gaus_tmp->GetParameter(2));
    //fdscb_tmp->SetParLimits(2,fit_gaus_tmp->GetParameter(2)*0.50,1.50*fit_gaus_tmp->GetParameter(2));
    std::vector<float>sigma2SFit=sigmaGaussianFits2Sigma(hist_vec_3000_CT[i]);
    fdscb_tmp->SetParameter(2,sigma2SFit[0]);
    fdscb_tmp->SetParLimits(2,sigma2SFit[0]*0.50,1.50*sigma2SFit[0]);
    //-a1: parameter, from when the gaussian core should count
    fdscb_tmp->SetParameter(2,fit_gaus_tmp->GetParameter(2));
    fdscb_tmp->SetParameter (3,3.0);
    fdscb_tmp->SetParLimits (3,0.0,10.0);
    //a2 parameter, up to when the gaussian core should count
    fdscb_tmp->SetParameter (5,3.0);
    fdscb_tmp->SetParLimits (5,0.0,10.0);
    fdscb_tmp->SetParameter(4,5.);
    fdscb_tmp->SetParLimits(4,0.,25.);
    fdscb_tmp->SetParameter(6,5.);
    fdscb_tmp->SetParLimits(6,0.,25.);
    int fitstatus(0); 
    fitstatus = hist_vec_3000_CT[i]->Fit(fdscb_tmp,"R");
    fdscb_tmp = hist_vec_3000_CT[i]->GetFunction("fdscb_tmp");
    h_3000_CT_DR09_E_SigmaCB_summary_histogram->SetBinContent(i-firstbin+1,fdscb_tmp->GetParameter(2)*100. );
    h_3000_CT_DR09_E_SigmaCB_summary_histogram->SetBinError(i-firstbin+1,fdscb_tmp->GetParError(2)*100. );
  }  
  TH1F* h_3000_CT_DR10_E_SigmaCB_summary_histogram=new TH1F("JER_SigmaCBVsCosTheta_CT_DR10_3000", "#sigma (E_{j}^{reco} / E_{j}^{true}) vs |cos#theta|", nRegionBins, pRegionBinEdges);
  h_3000_CT_DR10_E_SigmaCB_summary_histogram ->SetYTitle("#sigma(E_{j}) / E_{j} [%]");
  h_3000_CT_DR10_E_SigmaCB_summary_histogram->SetXTitle("|cos#theta|");
  h_3000_CT_DR10_E_SigmaCB_summary_histogram->SetLineWidth(2);
  h_3000_CT_DR10_E_SigmaCB_summary_histogram->SetLineColor(kRed);
  h_3000_CT_DR10_E_SigmaCB_summary_histogram->SetLineStyle(2);
  TH1F* h_3000_CT_DR10_E_RMS90_summary_histogram=new TH1F("JER_RMS90VsCosTheta_CT_DR10_3000", "RMS_{90}(E_{j}^{reco}/E_{j}^{gen}) / Mean_{90}(E_{j}^{reco}/E_{j}^{gen}) vs |cos#theta|", nRegionBins, pRegionBinEdges);
  h_3000_CT_DR10_E_RMS90_summary_histogram ->SetYTitle("RMS_{90}(E_{j}^{reco}/E_{j}^{gen}) / Mean_{90}(E_{j}^{reco}/E_{j}^{gen}) [%]");
  h_3000_CT_DR10_E_RMS90_summary_histogram->SetXTitle("|cos#theta|");
  h_3000_CT_DR10_E_RMS90_summary_histogram->SetLineWidth(2);
  h_3000_CT_DR10_E_RMS90_summary_histogram->SetLineColor(kRed);
  h_3000_CT_DR10_E_RMS90_summary_histogram->SetLineStyle(2);

  TH1F* h_3000_CT_DR10_E_RMS_summary_histogram=new TH1F("JER_RMSVsCosTheta_CT_DR10_3000", "RMS(E_{j}) / Mean(E_{j}) vs |cos#theta|", nRegionBins, pRegionBinEdges);
  h_3000_CT_DR10_E_RMS_summary_histogram ->SetYTitle("RMS(E_{j}) / Mean(E_{j}) [%]");
  h_3000_CT_DR10_E_RMS_summary_histogram->SetXTitle("|cos#theta|");
  h_3000_CT_DR10_E_RMS_summary_histogram->SetLineWidth(2);
  h_3000_CT_DR10_E_RMS_summary_histogram->SetLineColor(kRed);
  h_3000_CT_DR10_E_RMS_summary_histogram->SetLineStyle(2);

  TH1F* h_3000_CT_DR10_E_JER_Mean_summary_histogram=new TH1F("JER_MeanVsCosTheta_CT_DR10_3000", "Mean(E_{tot}^{RECO}/E_{tot}^{true}) vs |cos#theta|", nRegionBins, pRegionBinEdges);
  h_3000_CT_DR10_E_JER_Mean_summary_histogram->SetYTitle("Mean(E_{tot}^{RECO}/E_{tot}^{true})");
  h_3000_CT_DR10_E_JER_Mean_summary_histogram->SetXTitle("|cos#theta|");
  h_3000_CT_DR10_E_JER_Mean_summary_histogram->SetLineWidth(2);
  h_3000_CT_DR10_E_JER_Mean_summary_histogram->SetLineColor(kRed);
  h_3000_CT_DR10_E_JER_Mean_summary_histogram->SetLineStyle(2);
  firstbin=124;
  for(int i=firstbin;i<(firstbin+13);i++){
//continue;
    resolutionTH1=0; 
    resolutionErrorTH1=0;
    meanTH1=0;
    meanErrorTH1=0;
    CalculatePerformance( hist_vec_3000_CT[i], resolutionTH1, resolutionErrorTH1,meanTH1,meanErrorTH1);
    h_3000_CT_DR10_E_RMS90_summary_histogram->SetBinContent(i-firstbin+1,resolutionTH1/sqrt(2.));
    h_3000_CT_DR10_E_RMS90_summary_histogram ->SetBinError(i-firstbin+1, resolutionErrorTH1/sqrt(2.));
    h_3000_CT_DR10_E_RMS_summary_histogram->SetBinContent(i-firstbin+1,hist_vec_3000_CT[i]->GetRMS()*100. );
    h_3000_CT_DR10_E_RMS_summary_histogram ->SetBinError(i-firstbin+1, hist_vec_3000_CT[i]->GetRMSError()*100.);
    h_3000_CT_DR10_E_JER_Mean_summary_histogram->SetBinContent(i-firstbin+1,hist_vec_3000_CT[i]->GetMean());
    h_3000_CT_DR10_E_JER_Mean_summary_histogram->SetBinError(i-firstbin+1,hist_vec_3000_CT[i]->GetMeanError());
    //double sided crystal ball
    TF1* fit_gaus_tmp = new TF1("fit_gaus_tmp", "gaus",0.50,1.50);
    hist_vec_3000_CT[i]->Fit("fit_gaus_tmp","R");
    hist_vec_3000_CT[i]->GetFunction("fit_gaus_tmp");
    TF1* fdscb_tmp = new TF1("fdscb_tmp",fnc_dscb,0.,3.,7);
   fdscb_tmp->SetNpx(1000);
    fdscb_tmp->SetParameter(0,fit_gaus_tmp->GetParameter(0));
    //norm
    fdscb_tmp->SetParLimits (0,0.5*fit_gaus_tmp->GetParameter(0),1.5*fit_gaus_tmp->GetParameter(0));
    fdscb_tmp->SetParameter(1,fit_gaus_tmp->GetParameter(1));
    //gaussian mean
    fdscb_tmp->SetParLimits (1,0.8,1.2);
    //fdscb_tmp->SetParameter(2,fit_gaus_tmp->GetParameter(2));
    //fdscb_tmp->SetParLimits(2,fit_gaus_tmp->GetParameter(2)*0.50,1.50*fit_gaus_tmp->GetParameter(2));
    std::vector<float>sigma2SFit=sigmaGaussianFits2Sigma(hist_vec_3000_CT[i]);
    fdscb_tmp->SetParameter(2,sigma2SFit[0]);
    fdscb_tmp->SetParLimits(2,sigma2SFit[0]*0.50,1.50*sigma2SFit[0]);
    //-a1: parameter, from when the gaussian core should count
    fdscb_tmp->SetParameter(2,fit_gaus_tmp->GetParameter(2));
    fdscb_tmp->SetParameter (3,3.0);
    fdscb_tmp->SetParLimits (3,0.0,10.0);
    //a2 parameter, up to when the gaussian core should count
    fdscb_tmp->SetParameter (5,3.0);
    fdscb_tmp->SetParLimits (5,0.0,10.0);
    fdscb_tmp->SetParameter(4,5.);
    fdscb_tmp->SetParLimits(4,0.,25.);
    fdscb_tmp->SetParameter(6,5.);
    fdscb_tmp->SetParLimits(6,0.,25.);
    int fitstatus(0); 
    fitstatus = hist_vec_3000_CT[i]->Fit(fdscb_tmp,"R");
    fdscb_tmp = hist_vec_3000_CT[i]->GetFunction("fdscb_tmp");
    h_3000_CT_DR10_E_SigmaCB_summary_histogram->SetBinContent(i-firstbin+1,fdscb_tmp->GetParameter(2)*100. );
    h_3000_CT_DR10_E_SigmaCB_summary_histogram->SetBinError(i-firstbin+1,fdscb_tmp->GetParError(2)*100. );
  }  


  std::cout<<"3000 03/04/05/06 "<< calculate_over90(h_3000_CT_recojet03_E1_E2_over_E_True)<<"/"<< calculate_over90(h_3000_CT_recojet04_E1_E2_over_E_True)<<"/"<< calculate_over90(h_3000_CT_recojet05_E1_E2_over_E_True)<<"/"<<calculate_over90(h_3000_CT_recojet06_E1_E2_over_E_True)<<" 07/08/09/10 "<< calculate_over90(h_3000_CT_recojet07_E1_E2_over_E_True)<<"/"<< calculate_over90(h_3000_CT_recojet08_E1_E2_over_E_True)<<"/"<< calculate_over90(h_3000_CT_recojet09_E1_E2_over_E_True)<<"/"<<calculate_over90(h_3000_CT_recojet10_E1_E2_over_E_True)<<std::endl;
  std::cout<<"jet histos 3000 CT filled"<<std::endl;

  TH1F* h_3000_CT_wO_genjet03_dphi_j1j2 =  new TH1F("h_3000_CT_wO_genjet03_dphi_j1j2","", n_bins100, 0.5,TMath::Pi());
  TH1F* h_3000_CT_wO_genjet03_E1_E2_over_E_True =  new TH1F("h_3000_CT_wO_genjet03_E1_E2_over_E_True","", n_bins100, 0.5,1.00);
  TH1F* h_3000_CT_wO_genjet03_Delta_E1_E2_over_E12 =  new TH1F("h_3000_CT_wO_genjet03_Delta_E1_E2_over_E12","", n_bins100, -0.5,0.5);
  TH1F* h_3000_CT_wO_genjet04_dphi_j1j2 =  new TH1F("h_3000_CT_wO_genjet04_dphi_j1j2","", n_bins100, 0.5,TMath::Pi());
  TH1F* h_3000_CT_wO_genjet04_E1_E2_over_E_True =  new TH1F("h_3000_CT_wO_genjet04_E1_E2_over_E_True","", n_bins100, 0.5,1.00);
  TH1F* h_3000_CT_wO_genjet04_Delta_E1_E2_over_E12 =  new TH1F("h_3000_CT_wO_genjet04_Delta_E1_E2_over_E12","", n_bins100, -0.5,0.5);
  TH1F* h_3000_CT_wO_genjet05_dphi_j1j2 =  new TH1F("h_3000_CT_wO_genjet05_dphi_j1j2","", n_bins100, 0.5,TMath::Pi());
  TH1F* h_3000_CT_wO_genjet05_E1_E2_over_E_True =  new TH1F("h_3000_CT_wO_genjet05_E1_E2_over_E_True","", n_bins100, 0.5,1.00);
  TH1F* h_3000_CT_wO_genjet05_Delta_E1_E2_over_E12 =  new TH1F("h_3000_CT_wO_genjet05_Delta_E1_E2_over_E12","", n_bins100, -0.5,0.5);
  TH1F* h_3000_CT_wO_genjet06_dphi_j1j2 =  new TH1F("h_3000_CT_wO_genjet06_dphi_j1j2","", n_bins100, 0.5,TMath::Pi());
  TH1F* h_3000_CT_wO_genjet06_E1_E2_over_E_True =  new TH1F("h_3000_CT_wO_genjet06_E1_E2_over_E_True","", n_bins100, 0.5,1.00);
  TH1F* h_3000_CT_wO_genjet06_Delta_E1_E2_over_E12 =  new TH1F("h_3000_CT_wO_genjet06_Delta_E1_E2_over_E12","", n_bins100, -0.5,0.5);
  TH1F* h_3000_CT_wO_genjet07_dphi_j1j2 =  new TH1F("h_3000_CT_wO_genjet07_dphi_j1j2","", n_bins100, 0.5,TMath::Pi());
  TH1F* h_3000_CT_wO_genjet07_E1_E2_over_E_True =  new TH1F("h_3000_CT_wO_genjet07_E1_E2_over_E_True","", n_bins100, 0.5,1.00);
  TH1F* h_3000_CT_wO_genjet07_Delta_E1_E2_over_E12 =  new TH1F("h_3000_CT_wO_genjet07_Delta_E1_E2_over_E12","", n_bins100, -0.5,0.5);
  TH1F* h_3000_CT_wO_genjet08_dphi_j1j2 =  new TH1F("h_3000_CT_wO_genjet08_dphi_j1j2","", n_bins100, 0.5,TMath::Pi());
  TH1F* h_3000_CT_wO_genjet08_E1_E2_over_E_True =  new TH1F("h_3000_CT_wO_genjet08_E1_E2_over_E_True","", n_bins100, 0.5,1.00);
  TH1F* h_3000_CT_wO_genjet08_Delta_E1_E2_over_E12 =  new TH1F("h_3000_CT_wO_genjet08_Delta_E1_E2_over_E12","", n_bins100, -0.5,0.5);
  TH1F* h_3000_CT_wO_genjet09_dphi_j1j2 =  new TH1F("h_3000_CT_wO_genjet09_dphi_j1j2","", n_bins100, 0.5,TMath::Pi());
  TH1F* h_3000_CT_wO_genjet09_E1_E2_over_E_True =  new TH1F("h_3000_CT_wO_genjet09_E1_E2_over_E_True","", n_bins100, 0.5,1.00);
  TH1F* h_3000_CT_wO_genjet09_Delta_E1_E2_over_E12 =  new TH1F("h_3000_CT_wO_genjet09_Delta_E1_E2_over_E12","", n_bins100, -0.5,0.5);
  TH1F* h_3000_CT_wO_genjet10_dphi_j1j2 =  new TH1F("h_3000_CT_wO_genjet10_dphi_j1j2","", n_bins100, 0.5,TMath::Pi());
  TH1F* h_3000_CT_wO_genjet10_E1_E2_over_E_True =  new TH1F("h_3000_CT_wO_genjet10_E1_E2_over_E_True","", n_bins100, 0.5,1.00);
  TH1F* h_3000_CT_wO_genjet10_Delta_E1_E2_over_E12 =  new TH1F("h_3000_CT_wO_genjet10_Delta_E1_E2_over_E12","", n_bins100, -0.5,0.5);

  TH1F* h_3000_CT_wO_recojet03_dphi_j1j2 =  new TH1F("h_3000_CT_wO_recojet03_dphi_j1j2","", n_bins100, 0.5,TMath::Pi());
  TH1F* h_3000_CT_wO_recojet03_E1_E2_over_E_True =  new TH1F("h_3000_CT_wO_recojet03_E1_E2_over_E_True","", n_bins100, 0.5,1.00);
  TH1F* h_3000_CT_wO_recojet03_Delta_E1_E2_over_E12 =  new TH1F("h_3000_CT_wO_recojet03_Delta_E1_E2_over_E12","", n_bins100, -0.5,0.5);
  TH1F* h_3000_CT_wO_recojet04_dphi_j1j2 =  new TH1F("h_3000_CT_wO_recojet04_dphi_j1j2","", n_bins100, 0.5,TMath::Pi());
  TH1F* h_3000_CT_wO_recojet04_E1_E2_over_E_True =  new TH1F("h_3000_CT_wO_recojet04_E1_E2_over_E_True","", n_bins100, 0.5,1.00);
  TH1F* h_3000_CT_wO_recojet04_Delta_E1_E2_over_E12 =  new TH1F("h_3000_CT_wO_recojet04_Delta_E1_E2_over_E12","", n_bins100, -0.5,0.5);
  TH1F* h_3000_CT_wO_recojet05_dphi_j1j2 =  new TH1F("h_3000_CT_wO_recojet05_dphi_j1j2","", n_bins100, 0.5,TMath::Pi());
  TH1F* h_3000_CT_wO_recojet05_E1_E2_over_E_True =  new TH1F("h_3000_CT_wO_recojet05_E1_E2_over_E_True","", n_bins100, 0.5,1.00);
  TH1F* h_3000_CT_wO_recojet05_Delta_E1_E2_over_E12 =  new TH1F("h_3000_CT_wO_recojet05_Delta_E1_E2_over_E12","", n_bins100, -0.5,0.5);
  TH1F* h_3000_CT_wO_recojet06_dphi_j1j2 =  new TH1F("h_3000_CT_wO_recojet06_dphi_j1j2","", n_bins100, 0.5,TMath::Pi());
  TH1F* h_3000_CT_wO_recojet06_E1_E2_over_E_True =  new TH1F("h_3000_CT_wO_recojet06_E1_E2_over_E_True","", n_bins100, 0.5,1.00);
  TH1F* h_3000_CT_wO_recojet06_Delta_E1_E2_over_E12 =  new TH1F("h_3000_CT_wO_recojet06_Delta_E1_E2_over_E12","", n_bins100, -0.5,0.5);
  TH1F* h_3000_CT_wO_recojet07_dphi_j1j2 =  new TH1F("h_3000_CT_wO_recojet07_dphi_j1j2","", n_bins100, 0.5,TMath::Pi());
  TH1F* h_3000_CT_wO_recojet07_E1_E2_over_E_True =  new TH1F("h_3000_CT_wO_recojet07_E1_E2_over_E_True","", n_bins100, 0.5,1.00);
  TH1F* h_3000_CT_wO_recojet07_Delta_E1_E2_over_E12 =  new TH1F("h_3000_CT_wO_recojet07_Delta_E1_E2_over_E12","", n_bins100, -0.5,0.5);
  TH1F* h_3000_CT_wO_recojet08_dphi_j1j2 =  new TH1F("h_3000_CT_wO_recojet08_dphi_j1j2","", n_bins100, 0.5,TMath::Pi());
  TH1F* h_3000_CT_wO_recojet08_E1_E2_over_E_True =  new TH1F("h_3000_CT_wO_recojet08_E1_E2_over_E_True","", n_bins100, 0.5,1.00);
  TH1F* h_3000_CT_wO_recojet08_Delta_E1_E2_over_E12 =  new TH1F("h_3000_CT_wO_recojet08_Delta_E1_E2_over_E12","", n_bins100, -0.5,0.5);
  TH1F* h_3000_CT_wO_recojet09_dphi_j1j2 =  new TH1F("h_3000_CT_wO_recojet09_dphi_j1j2","", n_bins100, 0.5,TMath::Pi());
  TH1F* h_3000_CT_wO_recojet09_E1_E2_over_E_True =  new TH1F("h_3000_CT_wO_recojet09_E1_E2_over_E_True","", n_bins100, 0.5,1.00);
  TH1F* h_3000_CT_wO_recojet09_Delta_E1_E2_over_E12 =  new TH1F("h_3000_CT_wO_recojet09_Delta_E1_E2_over_E12","", n_bins100, -0.5,0.5);
  TH1F* h_3000_CT_wO_recojet10_dphi_j1j2 =  new TH1F("h_3000_CT_wO_recojet10_dphi_j1j2","", n_bins100, 0.5,TMath::Pi());
  TH1F* h_3000_CT_wO_recojet10_E1_E2_over_E_True =  new TH1F("h_3000_CT_wO_recojet10_E1_E2_over_E_True","", n_bins100, 0.5,1.00);
  TH1F* h_3000_CT_wO_recojet10_Delta_E1_E2_over_E12 =  new TH1F("h_3000_CT_wO_recojet10_Delta_E1_E2_over_E12","", n_bins100, -0.5,0.5);

  TH1F* h_3000_CT_wO_recojetE_over_genjetE_DR03 =  new TH1F("h_3000_CT_wO_recojetE_over_genjetE_DR03","", n_bins100, 0.5,1.5);
  TH1F* h_3000_CT_wO_recojetE_over_genjetE_DR04 =  new TH1F("h_3000_CT_wO_recojetE_over_genjetE_DR04","", n_bins100, 0.5,1.5);
  TH1F* h_3000_CT_wO_recojetE_over_genjetE_DR05 =  new TH1F("h_3000_CT_wO_recojetE_over_genjetE_DR05","", n_bins100, 0.5,1.5);
  TH1F* h_3000_CT_wO_recojetE_over_genjetE_DR06 =  new TH1F("h_3000_CT_wO_recojetE_over_genjetE_DR06","", n_bins100, 0.5,1.5);
  TH1F* h_3000_CT_wO_recojetE_over_genjetE_DR07 =  new TH1F("h_3000_CT_wO_recojetE_over_genjetE_DR07","", n_bins100, 0.5,1.5);
  TH1F* h_3000_CT_wO_recojetE_over_genjetE_DR08 =  new TH1F("h_3000_CT_wO_recojetE_over_genjetE_DR08","", n_bins100, 0.5,1.5);
  TH1F* h_3000_CT_wO_recojetE_over_genjetE_DR09 =  new TH1F("h_3000_CT_wO_recojetE_over_genjetE_DR09","", n_bins100, 0.5,1.5);
  TH1F* h_3000_CT_wO_recojetE_over_genjetE_DR10 =  new TH1F("h_3000_CT_wO_recojetE_over_genjetE_DR10","", n_bins100, 0.5,1.5);

  TH1F* h_3000_CT_wO_dphi_gen_reco_DR05 =  new TH1F("h_3000_CT_wO_dphi_gen_reco_DR05","", n_bins100, -0.1,9.9);
  TH1F* h_3000_CT_wO_dphi_gen_reco_DR06 =  new TH1F("h_3000_CT_wO_dphi_gen_reco_DR06","", n_bins100, -0.1,9.9);
  TH1F* h_3000_CT_wO_dphi_gen_reco_DR07 =  new TH1F("h_3000_CT_wO_dphi_gen_reco_DR07","", n_bins100, -0.1,9.9);

  TH1F* h_3000_CT_wO_DR05_E_rel_totVis_RMS_d1_cosT_0_to_0_10 =  new TH1F("h_3000_CT_wO_DR05_E_rel_totVis_RMS_d1_cosT_0_to_0_10","", n_binsJER, lim_E_rel_low,lim_E_rel_high);
  TH1F* h_3000_CT_wO_DR05_E_rel_totVis_RMS_d1_cosT_0_10_to_0_20 =  new TH1F("h_3000_CT_wO_DR05_E_rel_totVis_RMS_d1_cosT_0_10_to_0_20","", n_binsJER, lim_E_rel_low,lim_E_rel_high);
  TH1F* h_3000_CT_wO_DR05_E_rel_totVis_RMS_d1_cosT_0_20_to_0_30 =  new TH1F("h_3000_CT_wO_DR05_E_rel_totVis_RMS_d1_cosT_0_20_to_0_30","", n_binsJER, lim_E_rel_low,lim_E_rel_high);
  TH1F* h_3000_CT_wO_DR05_E_rel_totVis_RMS_d1_cosT_0_30_to_0_40 =  new TH1F("h_3000_CT_wO_DR05_E_rel_totVis_RMS_d1_cosT_0_30_to_0_40","", n_binsJER, lim_E_rel_low,lim_E_rel_high);
  TH1F* h_3000_CT_wO_DR05_E_rel_totVis_RMS_d1_cosT_0_40_to_0_50 =  new TH1F("h_3000_CT_wO_DR05_E_rel_totVis_RMS_d1_cosT_0_40_to_0_50","", n_binsJER, lim_E_rel_low,lim_E_rel_high);
  TH1F* h_3000_CT_wO_DR05_E_rel_totVis_RMS_d1_cosT_0_50_to_0_60 =  new TH1F("h_3000_CT_wO_DR05_E_rel_totVis_RMS_d1_cosT_0_50_to_0_60","", n_binsJER, lim_E_rel_low,lim_E_rel_high);
  TH1F* h_3000_CT_wO_DR05_E_rel_totVis_RMS_d1_cosT_0_60_to_0_70 =  new TH1F("h_3000_CT_wO_DR05_E_rel_totVis_RMS_d1_cosT_0_60_to_0_70","", n_binsJER, lim_E_rel_low,lim_E_rel_high);
  TH1F* h_3000_CT_wO_DR05_E_rel_totVis_RMS_d1_cosT_0_70_to_0_80 =  new TH1F("h_3000_CT_wO_DR05_E_rel_totVis_RMS_d1_cosT_0_70_to_0_80","", n_binsJER, lim_E_rel_low,lim_E_rel_high);
  TH1F* h_3000_CT_wO_DR05_E_rel_totVis_RMS_d1_cosT_0_80_to_0_90 =  new TH1F("h_3000_CT_wO_DR05_E_rel_totVis_RMS_d1_cosT_0_80_to_0_90","", n_binsJER, lim_E_rel_low,lim_E_rel_high);
  TH1F* h_3000_CT_wO_DR05_E_rel_totVis_RMS_d1_cosT_0_900_to_0_925 =  new TH1F("h_3000_CT_wO_DR05_E_rel_totVis_RMS_d1_cosT_0_900_to_0_925","", n_binsJER, lim_E_rel_low,lim_E_rel_high);
  TH1F* h_3000_CT_wO_DR05_E_rel_totVis_RMS_d1_cosT_0_925_to_0_950 =  new TH1F("h_3000_CT_wO_DR05_E_rel_totVis_RMS_d1_cosT_0_925_to_0_950","", n_binsJER, lim_E_rel_low,lim_E_rel_high);
  TH1F* h_3000_CT_wO_DR05_E_rel_totVis_RMS_d1_cosT_0_950_to_0_975 =  new TH1F("h_3000_CT_wO_DR05_E_rel_totVis_RMS_d1_cosT_0_950_to_0_975","", n_binsJER, lim_E_rel_low,lim_E_rel_high);
  TH1F* h_3000_CT_wO_DR05_E_rel_totVis_RMS_d1_cosT_0_975_to_1_00 =  new TH1F("h_3000_CT_wO_DR05_E_rel_totVis_RMS_d1_cosT_0_975_to_1_00","", n_binsJER_FW, lim_E_rel_low,lim_E_rel_high);

  TH1F* h_3000_CT_wO_DR06_E_rel_totVis_RMS_d1_cosT_0_to_0_10 =  new TH1F("h_3000_CT_wO_DR06_E_rel_totVis_RMS_d1_cosT_0_to_0_10","", n_binsJER, lim_E_rel_low,lim_E_rel_high);
  TH1F* h_3000_CT_wO_DR06_E_rel_totVis_RMS_d1_cosT_0_10_to_0_20 =  new TH1F("h_3000_CT_wO_DR06_E_rel_totVis_RMS_d1_cosT_0_10_to_0_20","", n_binsJER, lim_E_rel_low,lim_E_rel_high);
  TH1F* h_3000_CT_wO_DR06_E_rel_totVis_RMS_d1_cosT_0_20_to_0_30 =  new TH1F("h_3000_CT_wO_DR06_E_rel_totVis_RMS_d1_cosT_0_20_to_0_30","", n_binsJER, lim_E_rel_low,lim_E_rel_high);
  TH1F* h_3000_CT_wO_DR06_E_rel_totVis_RMS_d1_cosT_0_30_to_0_40 =  new TH1F("h_3000_CT_wO_DR06_E_rel_totVis_RMS_d1_cosT_0_30_to_0_40","", n_binsJER, lim_E_rel_low,lim_E_rel_high);
  TH1F* h_3000_CT_wO_DR06_E_rel_totVis_RMS_d1_cosT_0_40_to_0_50 =  new TH1F("h_3000_CT_wO_DR06_E_rel_totVis_RMS_d1_cosT_0_40_to_0_50","", n_binsJER, lim_E_rel_low,lim_E_rel_high);
  TH1F* h_3000_CT_wO_DR06_E_rel_totVis_RMS_d1_cosT_0_50_to_0_60 =  new TH1F("h_3000_CT_wO_DR06_E_rel_totVis_RMS_d1_cosT_0_50_to_0_60","", n_binsJER, lim_E_rel_low,lim_E_rel_high);
  TH1F* h_3000_CT_wO_DR06_E_rel_totVis_RMS_d1_cosT_0_60_to_0_70 =  new TH1F("h_3000_CT_wO_DR06_E_rel_totVis_RMS_d1_cosT_0_60_to_0_70","", n_binsJER, lim_E_rel_low,lim_E_rel_high);
  TH1F* h_3000_CT_wO_DR06_E_rel_totVis_RMS_d1_cosT_0_70_to_0_80 =  new TH1F("h_3000_CT_wO_DR06_E_rel_totVis_RMS_d1_cosT_0_70_to_0_80","", n_binsJER, lim_E_rel_low,lim_E_rel_high);
  TH1F* h_3000_CT_wO_DR06_E_rel_totVis_RMS_d1_cosT_0_80_to_0_90 =  new TH1F("h_3000_CT_wO_DR06_E_rel_totVis_RMS_d1_cosT_0_80_to_0_90","", n_binsJER, lim_E_rel_low,lim_E_rel_high);
  TH1F* h_3000_CT_wO_DR06_E_rel_totVis_RMS_d1_cosT_0_900_to_0_925 =  new TH1F("h_3000_CT_wO_DR06_E_rel_totVis_RMS_d1_cosT_0_900_to_0_925","", n_binsJER, lim_E_rel_low,lim_E_rel_high);
  TH1F* h_3000_CT_wO_DR06_E_rel_totVis_RMS_d1_cosT_0_925_to_0_950 =  new TH1F("h_3000_CT_wO_DR06_E_rel_totVis_RMS_d1_cosT_0_925_to_0_950","", n_binsJER, lim_E_rel_low,lim_E_rel_high);
  TH1F* h_3000_CT_wO_DR06_E_rel_totVis_RMS_d1_cosT_0_950_to_0_975 =  new TH1F("h_3000_CT_wO_DR06_E_rel_totVis_RMS_d1_cosT_0_950_to_0_975","", n_binsJER, lim_E_rel_low,lim_E_rel_high);
  TH1F* h_3000_CT_wO_DR06_E_rel_totVis_RMS_d1_cosT_0_975_to_1_00 =  new TH1F("h_3000_CT_wO_DR06_E_rel_totVis_RMS_d1_cosT_0_975_to_1_00","", n_binsJER_FW, lim_E_rel_low,lim_E_rel_high);

  TH1F* h_3000_CT_wO_DR07_E_rel_totVis_RMS_d1_cosT_0_to_0_10 =  new TH1F("h_3000_CT_wO_DR07_E_rel_totVis_RMS_d1_cosT_0_to_0_10","", n_binsJER, lim_E_rel_low,lim_E_rel_high);
  TH1F* h_3000_CT_wO_DR07_E_rel_totVis_RMS_d1_cosT_0_10_to_0_20 =  new TH1F("h_3000_CT_wO_DR07_E_rel_totVis_RMS_d1_cosT_0_10_to_0_20","", n_binsJER, lim_E_rel_low,lim_E_rel_high);
  TH1F* h_3000_CT_wO_DR07_E_rel_totVis_RMS_d1_cosT_0_20_to_0_30 =  new TH1F("h_3000_CT_wO_DR07_E_rel_totVis_RMS_d1_cosT_0_20_to_0_30","", n_binsJER, lim_E_rel_low,lim_E_rel_high);
  TH1F* h_3000_CT_wO_DR07_E_rel_totVis_RMS_d1_cosT_0_30_to_0_40 =  new TH1F("h_3000_CT_wO_DR07_E_rel_totVis_RMS_d1_cosT_0_30_to_0_40","", n_binsJER, lim_E_rel_low,lim_E_rel_high);
  TH1F* h_3000_CT_wO_DR07_E_rel_totVis_RMS_d1_cosT_0_40_to_0_50 =  new TH1F("h_3000_CT_wO_DR07_E_rel_totVis_RMS_d1_cosT_0_40_to_0_50","", n_binsJER, lim_E_rel_low,lim_E_rel_high);
  TH1F* h_3000_CT_wO_DR07_E_rel_totVis_RMS_d1_cosT_0_50_to_0_60 =  new TH1F("h_3000_CT_wO_DR07_E_rel_totVis_RMS_d1_cosT_0_50_to_0_60","", n_binsJER, lim_E_rel_low,lim_E_rel_high);
  TH1F* h_3000_CT_wO_DR07_E_rel_totVis_RMS_d1_cosT_0_60_to_0_70 =  new TH1F("h_3000_CT_wO_DR07_E_rel_totVis_RMS_d1_cosT_0_60_to_0_70","", n_binsJER, lim_E_rel_low,lim_E_rel_high);
  TH1F* h_3000_CT_wO_DR07_E_rel_totVis_RMS_d1_cosT_0_70_to_0_80 =  new TH1F("h_3000_CT_wO_DR07_E_rel_totVis_RMS_d1_cosT_0_70_to_0_80","", n_binsJER, lim_E_rel_low,lim_E_rel_high);
  TH1F* h_3000_CT_wO_DR07_E_rel_totVis_RMS_d1_cosT_0_80_to_0_90 =  new TH1F("h_3000_CT_wO_DR07_E_rel_totVis_RMS_d1_cosT_0_80_to_0_90","", n_binsJER, lim_E_rel_low,lim_E_rel_high);
  TH1F* h_3000_CT_wO_DR07_E_rel_totVis_RMS_d1_cosT_0_900_to_0_925 =  new TH1F("h_3000_CT_wO_DR07_E_rel_totVis_RMS_d1_cosT_0_900_to_0_925","", n_binsJER, lim_E_rel_low,lim_E_rel_high);
  TH1F* h_3000_CT_wO_DR07_E_rel_totVis_RMS_d1_cosT_0_925_to_0_950 =  new TH1F("h_3000_CT_wO_DR07_E_rel_totVis_RMS_d1_cosT_0_925_to_0_950","", n_binsJER, lim_E_rel_low,lim_E_rel_high);
  TH1F* h_3000_CT_wO_DR07_E_rel_totVis_RMS_d1_cosT_0_950_to_0_975 =  new TH1F("h_3000_CT_wO_DR07_E_rel_totVis_RMS_d1_cosT_0_950_to_0_975","", n_binsJER, lim_E_rel_low,lim_E_rel_high);
  TH1F* h_3000_CT_wO_DR07_E_rel_totVis_RMS_d1_cosT_0_975_to_1_00 =  new TH1F("h_3000_CT_wO_DR07_E_rel_totVis_RMS_d1_cosT_0_975_to_1_00","", n_binsJER_FW, lim_E_rel_low,lim_E_rel_high);

  TH1F* h_3000_CT_wO_DR08_E_rel_totVis_RMS_d1_cosT_0_to_0_10 =  new TH1F("h_3000_CT_wO_DR08_E_rel_totVis_RMS_d1_cosT_0_to_0_10","", n_binsJER, lim_E_rel_low,lim_E_rel_high);
  TH1F* h_3000_CT_wO_DR08_E_rel_totVis_RMS_d1_cosT_0_10_to_0_20 =  new TH1F("h_3000_CT_wO_DR08_E_rel_totVis_RMS_d1_cosT_0_10_to_0_20","", n_binsJER, lim_E_rel_low,lim_E_rel_high);
  TH1F* h_3000_CT_wO_DR08_E_rel_totVis_RMS_d1_cosT_0_20_to_0_30 =  new TH1F("h_3000_CT_wO_DR08_E_rel_totVis_RMS_d1_cosT_0_20_to_0_30","", n_binsJER, lim_E_rel_low,lim_E_rel_high);
  TH1F* h_3000_CT_wO_DR08_E_rel_totVis_RMS_d1_cosT_0_30_to_0_40 =  new TH1F("h_3000_CT_wO_DR08_E_rel_totVis_RMS_d1_cosT_0_30_to_0_40","", n_binsJER, lim_E_rel_low,lim_E_rel_high);
  TH1F* h_3000_CT_wO_DR08_E_rel_totVis_RMS_d1_cosT_0_40_to_0_50 =  new TH1F("h_3000_CT_wO_DR08_E_rel_totVis_RMS_d1_cosT_0_40_to_0_50","", n_binsJER, lim_E_rel_low,lim_E_rel_high);
  TH1F* h_3000_CT_wO_DR08_E_rel_totVis_RMS_d1_cosT_0_50_to_0_60 =  new TH1F("h_3000_CT_wO_DR08_E_rel_totVis_RMS_d1_cosT_0_50_to_0_60","", n_binsJER, lim_E_rel_low,lim_E_rel_high);
  TH1F* h_3000_CT_wO_DR08_E_rel_totVis_RMS_d1_cosT_0_60_to_0_70 =  new TH1F("h_3000_CT_wO_DR08_E_rel_totVis_RMS_d1_cosT_0_60_to_0_70","", n_binsJER, lim_E_rel_low,lim_E_rel_high);
  TH1F* h_3000_CT_wO_DR08_E_rel_totVis_RMS_d1_cosT_0_70_to_0_80 =  new TH1F("h_3000_CT_wO_DR08_E_rel_totVis_RMS_d1_cosT_0_70_to_0_80","", n_binsJER, lim_E_rel_low,lim_E_rel_high);
  TH1F* h_3000_CT_wO_DR08_E_rel_totVis_RMS_d1_cosT_0_80_to_0_90 =  new TH1F("h_3000_CT_wO_DR08_E_rel_totVis_RMS_d1_cosT_0_80_to_0_90","", n_binsJER, lim_E_rel_low,lim_E_rel_high);
  TH1F* h_3000_CT_wO_DR08_E_rel_totVis_RMS_d1_cosT_0_900_to_0_925 =  new TH1F("h_3000_CT_wO_DR08_E_rel_totVis_RMS_d1_cosT_0_900_to_0_925","", n_binsJER, lim_E_rel_low,lim_E_rel_high);
  TH1F* h_3000_CT_wO_DR08_E_rel_totVis_RMS_d1_cosT_0_925_to_0_950 =  new TH1F("h_3000_CT_wO_DR08_E_rel_totVis_RMS_d1_cosT_0_925_to_0_950","", n_binsJER, lim_E_rel_low,lim_E_rel_high);
  TH1F* h_3000_CT_wO_DR08_E_rel_totVis_RMS_d1_cosT_0_950_to_0_975 =  new TH1F("h_3000_CT_wO_DR08_E_rel_totVis_RMS_d1_cosT_0_950_to_0_975","", n_binsJER, lim_E_rel_low,lim_E_rel_high);
  TH1F* h_3000_CT_wO_DR08_E_rel_totVis_RMS_d1_cosT_0_975_to_1_00 =  new TH1F("h_3000_CT_wO_DR08_E_rel_totVis_RMS_d1_cosT_0_975_to_1_00","", n_binsJER_FW, lim_E_rel_low,lim_E_rel_high);

  TH1F* h_3000_CT_wO_DR09_E_rel_totVis_RMS_d1_cosT_0_to_0_10 =  new TH1F("h_3000_CT_wO_DR09_E_rel_totVis_RMS_d1_cosT_0_to_0_10","", n_binsJER, lim_E_rel_low,lim_E_rel_high);
  TH1F* h_3000_CT_wO_DR09_E_rel_totVis_RMS_d1_cosT_0_10_to_0_20 =  new TH1F("h_3000_CT_wO_DR09_E_rel_totVis_RMS_d1_cosT_0_10_to_0_20","", n_binsJER, lim_E_rel_low,lim_E_rel_high);
  TH1F* h_3000_CT_wO_DR09_E_rel_totVis_RMS_d1_cosT_0_20_to_0_30 =  new TH1F("h_3000_CT_wO_DR09_E_rel_totVis_RMS_d1_cosT_0_20_to_0_30","", n_binsJER, lim_E_rel_low,lim_E_rel_high);
  TH1F* h_3000_CT_wO_DR09_E_rel_totVis_RMS_d1_cosT_0_30_to_0_40 =  new TH1F("h_3000_CT_wO_DR09_E_rel_totVis_RMS_d1_cosT_0_30_to_0_40","", n_binsJER, lim_E_rel_low,lim_E_rel_high);
  TH1F* h_3000_CT_wO_DR09_E_rel_totVis_RMS_d1_cosT_0_40_to_0_50 =  new TH1F("h_3000_CT_wO_DR09_E_rel_totVis_RMS_d1_cosT_0_40_to_0_50","", n_binsJER, lim_E_rel_low,lim_E_rel_high);
  TH1F* h_3000_CT_wO_DR09_E_rel_totVis_RMS_d1_cosT_0_50_to_0_60 =  new TH1F("h_3000_CT_wO_DR09_E_rel_totVis_RMS_d1_cosT_0_50_to_0_60","", n_binsJER, lim_E_rel_low,lim_E_rel_high);
  TH1F* h_3000_CT_wO_DR09_E_rel_totVis_RMS_d1_cosT_0_60_to_0_70 =  new TH1F("h_3000_CT_wO_DR09_E_rel_totVis_RMS_d1_cosT_0_60_to_0_70","", n_binsJER, lim_E_rel_low,lim_E_rel_high);
  TH1F* h_3000_CT_wO_DR09_E_rel_totVis_RMS_d1_cosT_0_70_to_0_80 =  new TH1F("h_3000_CT_wO_DR09_E_rel_totVis_RMS_d1_cosT_0_70_to_0_80","", n_binsJER, lim_E_rel_low,lim_E_rel_high);
  TH1F* h_3000_CT_wO_DR09_E_rel_totVis_RMS_d1_cosT_0_80_to_0_90 =  new TH1F("h_3000_CT_wO_DR09_E_rel_totVis_RMS_d1_cosT_0_80_to_0_90","", n_binsJER, lim_E_rel_low,lim_E_rel_high);
  TH1F* h_3000_CT_wO_DR09_E_rel_totVis_RMS_d1_cosT_0_900_to_0_925 =  new TH1F("h_3000_CT_wO_DR09_E_rel_totVis_RMS_d1_cosT_0_900_to_0_925","", n_binsJER, lim_E_rel_low,lim_E_rel_high);
  TH1F* h_3000_CT_wO_DR09_E_rel_totVis_RMS_d1_cosT_0_925_to_0_950 =  new TH1F("h_3000_CT_wO_DR09_E_rel_totVis_RMS_d1_cosT_0_925_to_0_950","", n_binsJER, lim_E_rel_low,lim_E_rel_high);
  TH1F* h_3000_CT_wO_DR09_E_rel_totVis_RMS_d1_cosT_0_950_to_0_975 =  new TH1F("h_3000_CT_wO_DR09_E_rel_totVis_RMS_d1_cosT_0_950_to_0_975","", n_binsJER, lim_E_rel_low,lim_E_rel_high);
  TH1F* h_3000_CT_wO_DR09_E_rel_totVis_RMS_d1_cosT_0_975_to_1_00 =  new TH1F("h_3000_CT_wO_DR09_E_rel_totVis_RMS_d1_cosT_0_975_to_1_00","", n_binsJER_FW, lim_E_rel_low,lim_E_rel_high);

  TH1F* h_3000_CT_wO_DR10_E_rel_totVis_RMS_d1_cosT_0_to_0_10 =  new TH1F("h_3000_CT_wO_DR10_E_rel_totVis_RMS_d1_cosT_0_to_0_10","", n_binsJER, lim_E_rel_low,lim_E_rel_high);
  TH1F* h_3000_CT_wO_DR10_E_rel_totVis_RMS_d1_cosT_0_10_to_0_20 =  new TH1F("h_3000_CT_wO_DR10_E_rel_totVis_RMS_d1_cosT_0_10_to_0_20","", n_binsJER, lim_E_rel_low,lim_E_rel_high);
  TH1F* h_3000_CT_wO_DR10_E_rel_totVis_RMS_d1_cosT_0_20_to_0_30 =  new TH1F("h_3000_CT_wO_DR10_E_rel_totVis_RMS_d1_cosT_0_20_to_0_30","", n_binsJER, lim_E_rel_low,lim_E_rel_high);
  TH1F* h_3000_CT_wO_DR10_E_rel_totVis_RMS_d1_cosT_0_30_to_0_40 =  new TH1F("h_3000_CT_wO_DR10_E_rel_totVis_RMS_d1_cosT_0_30_to_0_40","", n_binsJER, lim_E_rel_low,lim_E_rel_high);
  TH1F* h_3000_CT_wO_DR10_E_rel_totVis_RMS_d1_cosT_0_40_to_0_50 =  new TH1F("h_3000_CT_wO_DR10_E_rel_totVis_RMS_d1_cosT_0_40_to_0_50","", n_binsJER, lim_E_rel_low,lim_E_rel_high);
  TH1F* h_3000_CT_wO_DR10_E_rel_totVis_RMS_d1_cosT_0_50_to_0_60 =  new TH1F("h_3000_CT_wO_DR10_E_rel_totVis_RMS_d1_cosT_0_50_to_0_60","", n_binsJER, lim_E_rel_low,lim_E_rel_high);
  TH1F* h_3000_CT_wO_DR10_E_rel_totVis_RMS_d1_cosT_0_60_to_0_70 =  new TH1F("h_3000_CT_wO_DR10_E_rel_totVis_RMS_d1_cosT_0_60_to_0_70","", n_binsJER, lim_E_rel_low,lim_E_rel_high);
  TH1F* h_3000_CT_wO_DR10_E_rel_totVis_RMS_d1_cosT_0_70_to_0_80 =  new TH1F("h_3000_CT_wO_DR10_E_rel_totVis_RMS_d1_cosT_0_70_to_0_80","", n_binsJER, lim_E_rel_low,lim_E_rel_high);
  TH1F* h_3000_CT_wO_DR10_E_rel_totVis_RMS_d1_cosT_0_80_to_0_90 =  new TH1F("h_3000_CT_wO_DR10_E_rel_totVis_RMS_d1_cosT_0_80_to_0_90","", n_binsJER, lim_E_rel_low,lim_E_rel_high);
  TH1F* h_3000_CT_wO_DR10_E_rel_totVis_RMS_d1_cosT_0_900_to_0_925 =  new TH1F("h_3000_CT_wO_DR10_E_rel_totVis_RMS_d1_cosT_0_900_to_0_925","", n_binsJER, lim_E_rel_low,lim_E_rel_high);
  TH1F* h_3000_CT_wO_DR10_E_rel_totVis_RMS_d1_cosT_0_925_to_0_950 =  new TH1F("h_3000_CT_wO_DR10_E_rel_totVis_RMS_d1_cosT_0_925_to_0_950","", n_binsJER, lim_E_rel_low,lim_E_rel_high);
  TH1F* h_3000_CT_wO_DR10_E_rel_totVis_RMS_d1_cosT_0_950_to_0_975 =  new TH1F("h_3000_CT_wO_DR10_E_rel_totVis_RMS_d1_cosT_0_950_to_0_975","", n_binsJER, lim_E_rel_low,lim_E_rel_high);
  TH1F* h_3000_CT_wO_DR10_E_rel_totVis_RMS_d1_cosT_0_975_to_1_00 =  new TH1F("h_3000_CT_wO_DR10_E_rel_totVis_RMS_d1_cosT_0_975_to_1_00","", n_binsJER_FW, lim_E_rel_low,lim_E_rel_high);

  TH1F* h_3000_CT_wO_DR05_dphi_reco_gen_cosTheta_0_65 =  new TH1F("h_3000_CT_wO_DR05_dphi_reco_gen_cosTheta_0_65","", n_bins100, -lim_angleDeg,lim_angleDeg);
  TH1F* h_3000_CT_wO_DR05_dtheta_reco_gen_cosTheta_0_65 =  new TH1F("h_3000_CT_wO_DR05_dtheta_reco_gen_cosTheta_0_65","", n_bins100, -lim_angleDeg,lim_angleDeg);
  TH1F* h_3000_CT_wO_DR05_dphi_reco_gen_cosTheta_0_65_to_0_80 =  new TH1F("h_3000_CT_wO_DR05_dphi_reco_gen_cosTheta_0_65_to_0_80","", n_bins100, -lim_angleDeg,lim_angleDeg);
  TH1F* h_3000_CT_wO_DR05_dtheta_reco_gen_cosTheta_0_65_to_0_80 =  new TH1F("h_3000_CT_wO_DR05_dtheta_reco_gen_cosTheta_0_65_to_0_80","", n_bins100, -lim_angleDeg,lim_angleDeg);
  TH1F* h_3000_CT_wO_DR05_dphi_reco_gen_cosTheta_0_80_to_0_925 =  new TH1F("h_3000_CT_wO_DR05_dphi_reco_gen_cosTheta_0_80_to_0_925","", n_bins100, -lim_angleDeg,lim_angleDeg);
  TH1F* h_3000_CT_wO_DR05_dtheta_reco_gen_cosTheta_0_80_to_0_925 =  new TH1F("h_3000_CT_wO_DR05_dtheta_reco_gen_cosTheta_0_80_to_0_925","", n_bins100, -lim_angleDeg,lim_angleDeg);
  TH1F* h_3000_CT_wO_DR05_dphi_reco_gen_cosTheta_0_925_to_0_975 =  new TH1F("h_3000_CT_wO_DR05_dphi_reco_gen_cosTheta_0_925_to_0_975","", n_bins100, -lim_angleDeg,lim_angleDeg);
  TH1F* h_3000_CT_wO_DR05_dtheta_reco_gen_cosTheta_0_925_to_0_975 =  new TH1F("h_3000_CT_wO_DR05_dtheta_reco_gen_cosTheta_0_925_to_0_975","", n_bins100, -lim_angleDeg,lim_angleDeg);

  TH1F* h_3000_CT_wO_DR07_dphi_reco_gen_cosTheta_0_65 =  new TH1F("h_3000_CT_wO_DR07_dphi_reco_gen_cosTheta_0_65","", n_bins100, -lim_angleDeg,lim_angleDeg);
  TH1F* h_3000_CT_wO_DR07_dtheta_reco_gen_cosTheta_0_65 =  new TH1F("h_3000_CT_wO_DR07_dtheta_reco_gen_cosTheta_0_65","", n_bins100, -lim_angleDeg,lim_angleDeg);
  TH1F* h_3000_CT_wO_DR07_dphi_reco_gen_cosTheta_0_65_to_0_80 =  new TH1F("h_3000_CT_wO_DR07_dphi_reco_gen_cosTheta_0_65_to_0_80","", n_bins100, -lim_angleDeg,lim_angleDeg);
  TH1F* h_3000_CT_wO_DR07_dtheta_reco_gen_cosTheta_0_65_to_0_80 =  new TH1F("h_3000_CT_wO_DR07_dtheta_reco_gen_cosTheta_0_65_to_0_80","", n_bins100, -lim_angleDeg,lim_angleDeg);
  TH1F* h_3000_CT_wO_DR07_dphi_reco_gen_cosTheta_0_80_to_0_925 =  new TH1F("h_3000_CT_wO_DR07_dphi_reco_gen_cosTheta_0_80_to_0_925","", n_bins100, -lim_angleDeg,lim_angleDeg);
  TH1F* h_3000_CT_wO_DR07_dtheta_reco_gen_cosTheta_0_80_to_0_925 =  new TH1F("h_3000_CT_wO_DR07_dtheta_reco_gen_cosTheta_0_80_to_0_925","", n_bins100, -lim_angleDeg,lim_angleDeg);
  TH1F* h_3000_CT_wO_DR07_dphi_reco_gen_cosTheta_0_925_to_0_975 =  new TH1F("h_3000_CT_wO_DR07_dphi_reco_gen_cosTheta_0_925_to_0_975","", n_bins100, -lim_angleDeg,lim_angleDeg);
  TH1F* h_3000_CT_wO_DR07_dtheta_reco_gen_cosTheta_0_925_to_0_975 =  new TH1F("h_3000_CT_wO_DR07_dtheta_reco_gen_cosTheta_0_925_to_0_975","", n_bins100, -lim_angleDeg,lim_angleDeg);

  TH1F* h_3000_CT_wO_DR10_dphi_reco_gen_cosTheta_0_65 =  new TH1F("h_3000_CT_wO_DR10_dphi_reco_gen_cosTheta_0_65","", n_bins100, -lim_angleDeg,lim_angleDeg);
  TH1F* h_3000_CT_wO_DR10_dtheta_reco_gen_cosTheta_0_65 =  new TH1F("h_3000_CT_wO_DR10_dtheta_reco_gen_cosTheta_0_65","", n_bins100, -lim_angleDeg,lim_angleDeg);
  TH1F* h_3000_CT_wO_DR10_dphi_reco_gen_cosTheta_0_65_to_0_80 =  new TH1F("h_3000_CT_wO_DR10_dphi_reco_gen_cosTheta_0_65_to_0_80","", n_bins100, -lim_angleDeg,lim_angleDeg);
  TH1F* h_3000_CT_wO_DR10_dtheta_reco_gen_cosTheta_0_65_to_0_80 =  new TH1F("h_3000_CT_wO_DR10_dtheta_reco_gen_cosTheta_0_65_to_0_80","", n_bins100, -lim_angleDeg,lim_angleDeg);
  TH1F* h_3000_CT_wO_DR10_dphi_reco_gen_cosTheta_0_80_to_0_925 =  new TH1F("h_3000_CT_wO_DR10_dphi_reco_gen_cosTheta_0_80_to_0_925","", n_bins100, -lim_angleDeg,lim_angleDeg);
  TH1F* h_3000_CT_wO_DR10_dtheta_reco_gen_cosTheta_0_80_to_0_925 =  new TH1F("h_3000_CT_wO_DR10_dtheta_reco_gen_cosTheta_0_80_to_0_925","", n_bins100, -lim_angleDeg,lim_angleDeg);
  TH1F* h_3000_CT_wO_DR10_dphi_reco_gen_cosTheta_0_925_to_0_975 =  new TH1F("h_3000_CT_wO_DR10_dphi_reco_gen_cosTheta_0_925_to_0_975","", n_bins100, -lim_angleDeg,lim_angleDeg);
  TH1F* h_3000_CT_wO_DR10_dtheta_reco_gen_cosTheta_0_925_to_0_975 =  new TH1F("h_3000_CT_wO_DR10_dtheta_reco_gen_cosTheta_0_925_to_0_975","", n_bins100, -lim_angleDeg,lim_angleDeg);

  std::vector<TH1F*> hist_vec_3000_CT_wO;
  hist_vec_3000_CT_wO.push_back(h_3000_CT_wO_genjet03_dphi_j1j2);
  hist_vec_3000_CT_wO.push_back(h_3000_CT_wO_genjet03_E1_E2_over_E_True);
  hist_vec_3000_CT_wO.push_back(h_3000_CT_wO_genjet03_Delta_E1_E2_over_E12);
  hist_vec_3000_CT_wO.push_back(h_3000_CT_wO_genjet04_dphi_j1j2);
  hist_vec_3000_CT_wO.push_back(h_3000_CT_wO_genjet04_E1_E2_over_E_True);
  hist_vec_3000_CT_wO.push_back(h_3000_CT_wO_genjet04_Delta_E1_E2_over_E12);
  hist_vec_3000_CT_wO.push_back(h_3000_CT_wO_genjet05_dphi_j1j2);
  hist_vec_3000_CT_wO.push_back(h_3000_CT_wO_genjet05_E1_E2_over_E_True);
  hist_vec_3000_CT_wO.push_back(h_3000_CT_wO_genjet05_Delta_E1_E2_over_E12);
  hist_vec_3000_CT_wO.push_back(h_3000_CT_wO_genjet06_dphi_j1j2);
  hist_vec_3000_CT_wO.push_back(h_3000_CT_wO_genjet06_E1_E2_over_E_True);
  hist_vec_3000_CT_wO.push_back(h_3000_CT_wO_genjet06_Delta_E1_E2_over_E12);
  hist_vec_3000_CT_wO.push_back(h_3000_CT_wO_genjet07_dphi_j1j2);
  hist_vec_3000_CT_wO.push_back(h_3000_CT_wO_genjet07_E1_E2_over_E_True);
  hist_vec_3000_CT_wO.push_back(h_3000_CT_wO_genjet07_Delta_E1_E2_over_E12);
  hist_vec_3000_CT_wO.push_back(h_3000_CT_wO_genjet08_dphi_j1j2);
  hist_vec_3000_CT_wO.push_back(h_3000_CT_wO_genjet08_E1_E2_over_E_True);
  hist_vec_3000_CT_wO.push_back(h_3000_CT_wO_genjet08_Delta_E1_E2_over_E12);
  hist_vec_3000_CT_wO.push_back(h_3000_CT_wO_genjet09_dphi_j1j2);
  hist_vec_3000_CT_wO.push_back(h_3000_CT_wO_genjet09_E1_E2_over_E_True);
  hist_vec_3000_CT_wO.push_back(h_3000_CT_wO_genjet09_Delta_E1_E2_over_E12);
  hist_vec_3000_CT_wO.push_back(h_3000_CT_wO_genjet10_dphi_j1j2);
  hist_vec_3000_CT_wO.push_back(h_3000_CT_wO_genjet10_E1_E2_over_E_True);
  hist_vec_3000_CT_wO.push_back(h_3000_CT_wO_genjet10_Delta_E1_E2_over_E12);

  hist_vec_3000_CT_wO.push_back(h_3000_CT_wO_recojet03_dphi_j1j2);
  hist_vec_3000_CT_wO.push_back(h_3000_CT_wO_recojet03_E1_E2_over_E_True);
  hist_vec_3000_CT_wO.push_back(h_3000_CT_wO_recojet03_Delta_E1_E2_over_E12);
  hist_vec_3000_CT_wO.push_back(h_3000_CT_wO_recojet04_dphi_j1j2);
  hist_vec_3000_CT_wO.push_back(h_3000_CT_wO_recojet04_E1_E2_over_E_True);
  hist_vec_3000_CT_wO.push_back(h_3000_CT_wO_recojet04_Delta_E1_E2_over_E12);
  hist_vec_3000_CT_wO.push_back(h_3000_CT_wO_recojet05_dphi_j1j2);
  hist_vec_3000_CT_wO.push_back(h_3000_CT_wO_recojet05_E1_E2_over_E_True);
  hist_vec_3000_CT_wO.push_back(h_3000_CT_wO_recojet05_Delta_E1_E2_over_E12);
  hist_vec_3000_CT_wO.push_back(h_3000_CT_wO_recojet06_dphi_j1j2);
  hist_vec_3000_CT_wO.push_back(h_3000_CT_wO_recojet06_E1_E2_over_E_True);
  hist_vec_3000_CT_wO.push_back(h_3000_CT_wO_recojet06_Delta_E1_E2_over_E12);
  hist_vec_3000_CT_wO.push_back(h_3000_CT_wO_recojet07_dphi_j1j2);
  hist_vec_3000_CT_wO.push_back(h_3000_CT_wO_recojet07_E1_E2_over_E_True);
  hist_vec_3000_CT_wO.push_back(h_3000_CT_wO_recojet07_Delta_E1_E2_over_E12);
  hist_vec_3000_CT_wO.push_back(h_3000_CT_wO_recojet08_dphi_j1j2);
  hist_vec_3000_CT_wO.push_back(h_3000_CT_wO_recojet08_E1_E2_over_E_True);
  hist_vec_3000_CT_wO.push_back(h_3000_CT_wO_recojet08_Delta_E1_E2_over_E12);
  hist_vec_3000_CT_wO.push_back(h_3000_CT_wO_recojet09_dphi_j1j2);
  hist_vec_3000_CT_wO.push_back(h_3000_CT_wO_recojet09_E1_E2_over_E_True);
  hist_vec_3000_CT_wO.push_back(h_3000_CT_wO_recojet09_Delta_E1_E2_over_E12);
  hist_vec_3000_CT_wO.push_back(h_3000_CT_wO_recojet10_dphi_j1j2);
  hist_vec_3000_CT_wO.push_back(h_3000_CT_wO_recojet10_E1_E2_over_E_True);
  hist_vec_3000_CT_wO.push_back(h_3000_CT_wO_recojet10_Delta_E1_E2_over_E12);

  hist_vec_3000_CT_wO.push_back(h_3000_CT_wO_recojetE_over_genjetE_DR03);
  hist_vec_3000_CT_wO.push_back(h_3000_CT_wO_recojetE_over_genjetE_DR04);
  hist_vec_3000_CT_wO.push_back(h_3000_CT_wO_recojetE_over_genjetE_DR05);
  hist_vec_3000_CT_wO.push_back(h_3000_CT_wO_recojetE_over_genjetE_DR06);
  hist_vec_3000_CT_wO.push_back(h_3000_CT_wO_recojetE_over_genjetE_DR07);
  hist_vec_3000_CT_wO.push_back(h_3000_CT_wO_recojetE_over_genjetE_DR08);
  hist_vec_3000_CT_wO.push_back(h_3000_CT_wO_recojetE_over_genjetE_DR09);
  hist_vec_3000_CT_wO.push_back(h_3000_CT_wO_recojetE_over_genjetE_DR10);

  hist_vec_3000_CT_wO.push_back(h_3000_CT_wO_dphi_gen_reco_DR05);
  hist_vec_3000_CT_wO.push_back(h_3000_CT_wO_dphi_gen_reco_DR06);
  hist_vec_3000_CT_wO.push_back(h_3000_CT_wO_dphi_gen_reco_DR07);

  hist_vec_3000_CT_wO.push_back(h_3000_CT_wO_DR05_E_rel_totVis_RMS_d1_cosT_0_to_0_10);
  hist_vec_3000_CT_wO.push_back(h_3000_CT_wO_DR05_E_rel_totVis_RMS_d1_cosT_0_10_to_0_20);
  hist_vec_3000_CT_wO.push_back(h_3000_CT_wO_DR05_E_rel_totVis_RMS_d1_cosT_0_20_to_0_30);
  hist_vec_3000_CT_wO.push_back(h_3000_CT_wO_DR05_E_rel_totVis_RMS_d1_cosT_0_30_to_0_40);
  hist_vec_3000_CT_wO.push_back(h_3000_CT_wO_DR05_E_rel_totVis_RMS_d1_cosT_0_40_to_0_50);
  hist_vec_3000_CT_wO.push_back(h_3000_CT_wO_DR05_E_rel_totVis_RMS_d1_cosT_0_50_to_0_60);
  hist_vec_3000_CT_wO.push_back(h_3000_CT_wO_DR05_E_rel_totVis_RMS_d1_cosT_0_60_to_0_70);
  hist_vec_3000_CT_wO.push_back(h_3000_CT_wO_DR05_E_rel_totVis_RMS_d1_cosT_0_70_to_0_80);
  hist_vec_3000_CT_wO.push_back(h_3000_CT_wO_DR05_E_rel_totVis_RMS_d1_cosT_0_80_to_0_90);
  hist_vec_3000_CT_wO.push_back(h_3000_CT_wO_DR05_E_rel_totVis_RMS_d1_cosT_0_900_to_0_925);
  hist_vec_3000_CT_wO.push_back(h_3000_CT_wO_DR05_E_rel_totVis_RMS_d1_cosT_0_925_to_0_950);
  hist_vec_3000_CT_wO.push_back(h_3000_CT_wO_DR05_E_rel_totVis_RMS_d1_cosT_0_950_to_0_975);
  hist_vec_3000_CT_wO.push_back(h_3000_CT_wO_DR05_E_rel_totVis_RMS_d1_cosT_0_975_to_1_00);

  hist_vec_3000_CT_wO.push_back(h_3000_CT_wO_DR06_E_rel_totVis_RMS_d1_cosT_0_to_0_10);
  hist_vec_3000_CT_wO.push_back(h_3000_CT_wO_DR06_E_rel_totVis_RMS_d1_cosT_0_10_to_0_20);
  hist_vec_3000_CT_wO.push_back(h_3000_CT_wO_DR06_E_rel_totVis_RMS_d1_cosT_0_20_to_0_30);
  hist_vec_3000_CT_wO.push_back(h_3000_CT_wO_DR06_E_rel_totVis_RMS_d1_cosT_0_30_to_0_40);
  hist_vec_3000_CT_wO.push_back(h_3000_CT_wO_DR06_E_rel_totVis_RMS_d1_cosT_0_40_to_0_50);
  hist_vec_3000_CT_wO.push_back(h_3000_CT_wO_DR06_E_rel_totVis_RMS_d1_cosT_0_50_to_0_60);
  hist_vec_3000_CT_wO.push_back(h_3000_CT_wO_DR06_E_rel_totVis_RMS_d1_cosT_0_60_to_0_70);
  hist_vec_3000_CT_wO.push_back(h_3000_CT_wO_DR06_E_rel_totVis_RMS_d1_cosT_0_70_to_0_80);
  hist_vec_3000_CT_wO.push_back(h_3000_CT_wO_DR06_E_rel_totVis_RMS_d1_cosT_0_80_to_0_90);
  hist_vec_3000_CT_wO.push_back(h_3000_CT_wO_DR06_E_rel_totVis_RMS_d1_cosT_0_900_to_0_925);
  hist_vec_3000_CT_wO.push_back(h_3000_CT_wO_DR06_E_rel_totVis_RMS_d1_cosT_0_925_to_0_950);
  hist_vec_3000_CT_wO.push_back(h_3000_CT_wO_DR06_E_rel_totVis_RMS_d1_cosT_0_950_to_0_975);
  hist_vec_3000_CT_wO.push_back(h_3000_CT_wO_DR06_E_rel_totVis_RMS_d1_cosT_0_975_to_1_00); 

  hist_vec_3000_CT_wO.push_back(h_3000_CT_wO_DR07_E_rel_totVis_RMS_d1_cosT_0_to_0_10);
  hist_vec_3000_CT_wO.push_back(h_3000_CT_wO_DR07_E_rel_totVis_RMS_d1_cosT_0_10_to_0_20);
  hist_vec_3000_CT_wO.push_back(h_3000_CT_wO_DR07_E_rel_totVis_RMS_d1_cosT_0_20_to_0_30);
  hist_vec_3000_CT_wO.push_back(h_3000_CT_wO_DR07_E_rel_totVis_RMS_d1_cosT_0_30_to_0_40);
  hist_vec_3000_CT_wO.push_back(h_3000_CT_wO_DR07_E_rel_totVis_RMS_d1_cosT_0_40_to_0_50);
  hist_vec_3000_CT_wO.push_back(h_3000_CT_wO_DR07_E_rel_totVis_RMS_d1_cosT_0_50_to_0_60);
  hist_vec_3000_CT_wO.push_back(h_3000_CT_wO_DR07_E_rel_totVis_RMS_d1_cosT_0_60_to_0_70);
  hist_vec_3000_CT_wO.push_back(h_3000_CT_wO_DR07_E_rel_totVis_RMS_d1_cosT_0_70_to_0_80);
  hist_vec_3000_CT_wO.push_back(h_3000_CT_wO_DR07_E_rel_totVis_RMS_d1_cosT_0_80_to_0_90);
  hist_vec_3000_CT_wO.push_back(h_3000_CT_wO_DR07_E_rel_totVis_RMS_d1_cosT_0_900_to_0_925);
  hist_vec_3000_CT_wO.push_back(h_3000_CT_wO_DR07_E_rel_totVis_RMS_d1_cosT_0_925_to_0_950);
  hist_vec_3000_CT_wO.push_back(h_3000_CT_wO_DR07_E_rel_totVis_RMS_d1_cosT_0_950_to_0_975);
  hist_vec_3000_CT_wO.push_back(h_3000_CT_wO_DR07_E_rel_totVis_RMS_d1_cosT_0_975_to_1_00); 

  hist_vec_3000_CT_wO.push_back(h_3000_CT_wO_DR08_E_rel_totVis_RMS_d1_cosT_0_to_0_10);
  hist_vec_3000_CT_wO.push_back(h_3000_CT_wO_DR08_E_rel_totVis_RMS_d1_cosT_0_10_to_0_20);
  hist_vec_3000_CT_wO.push_back(h_3000_CT_wO_DR08_E_rel_totVis_RMS_d1_cosT_0_20_to_0_30);
  hist_vec_3000_CT_wO.push_back(h_3000_CT_wO_DR08_E_rel_totVis_RMS_d1_cosT_0_30_to_0_40);
  hist_vec_3000_CT_wO.push_back(h_3000_CT_wO_DR08_E_rel_totVis_RMS_d1_cosT_0_40_to_0_50);
  hist_vec_3000_CT_wO.push_back(h_3000_CT_wO_DR08_E_rel_totVis_RMS_d1_cosT_0_50_to_0_60);
  hist_vec_3000_CT_wO.push_back(h_3000_CT_wO_DR08_E_rel_totVis_RMS_d1_cosT_0_60_to_0_70);
  hist_vec_3000_CT_wO.push_back(h_3000_CT_wO_DR08_E_rel_totVis_RMS_d1_cosT_0_70_to_0_80);
  hist_vec_3000_CT_wO.push_back(h_3000_CT_wO_DR08_E_rel_totVis_RMS_d1_cosT_0_80_to_0_90);
  hist_vec_3000_CT_wO.push_back(h_3000_CT_wO_DR08_E_rel_totVis_RMS_d1_cosT_0_900_to_0_925);
  hist_vec_3000_CT_wO.push_back(h_3000_CT_wO_DR08_E_rel_totVis_RMS_d1_cosT_0_925_to_0_950);
  hist_vec_3000_CT_wO.push_back(h_3000_CT_wO_DR08_E_rel_totVis_RMS_d1_cosT_0_950_to_0_975);
  hist_vec_3000_CT_wO.push_back(h_3000_CT_wO_DR08_E_rel_totVis_RMS_d1_cosT_0_975_to_1_00); //110

  hist_vec_3000_CT_wO.push_back(h_3000_CT_wO_DR09_E_rel_totVis_RMS_d1_cosT_0_to_0_10);
  hist_vec_3000_CT_wO.push_back(h_3000_CT_wO_DR09_E_rel_totVis_RMS_d1_cosT_0_10_to_0_20);
  hist_vec_3000_CT_wO.push_back(h_3000_CT_wO_DR09_E_rel_totVis_RMS_d1_cosT_0_20_to_0_30);
  hist_vec_3000_CT_wO.push_back(h_3000_CT_wO_DR09_E_rel_totVis_RMS_d1_cosT_0_30_to_0_40);
  hist_vec_3000_CT_wO.push_back(h_3000_CT_wO_DR09_E_rel_totVis_RMS_d1_cosT_0_40_to_0_50);
  hist_vec_3000_CT_wO.push_back(h_3000_CT_wO_DR09_E_rel_totVis_RMS_d1_cosT_0_50_to_0_60);
  hist_vec_3000_CT_wO.push_back(h_3000_CT_wO_DR09_E_rel_totVis_RMS_d1_cosT_0_60_to_0_70);
  hist_vec_3000_CT_wO.push_back(h_3000_CT_wO_DR09_E_rel_totVis_RMS_d1_cosT_0_70_to_0_80);
  hist_vec_3000_CT_wO.push_back(h_3000_CT_wO_DR09_E_rel_totVis_RMS_d1_cosT_0_80_to_0_90);
  hist_vec_3000_CT_wO.push_back(h_3000_CT_wO_DR09_E_rel_totVis_RMS_d1_cosT_0_900_to_0_925);
  hist_vec_3000_CT_wO.push_back(h_3000_CT_wO_DR09_E_rel_totVis_RMS_d1_cosT_0_925_to_0_950);
  hist_vec_3000_CT_wO.push_back(h_3000_CT_wO_DR09_E_rel_totVis_RMS_d1_cosT_0_950_to_0_975);
  hist_vec_3000_CT_wO.push_back(h_3000_CT_wO_DR09_E_rel_totVis_RMS_d1_cosT_0_975_to_1_00); //123

  hist_vec_3000_CT_wO.push_back(h_3000_CT_wO_DR10_E_rel_totVis_RMS_d1_cosT_0_to_0_10);
  hist_vec_3000_CT_wO.push_back(h_3000_CT_wO_DR10_E_rel_totVis_RMS_d1_cosT_0_10_to_0_20);
  hist_vec_3000_CT_wO.push_back(h_3000_CT_wO_DR10_E_rel_totVis_RMS_d1_cosT_0_20_to_0_30);
  hist_vec_3000_CT_wO.push_back(h_3000_CT_wO_DR10_E_rel_totVis_RMS_d1_cosT_0_30_to_0_40);
  hist_vec_3000_CT_wO.push_back(h_3000_CT_wO_DR10_E_rel_totVis_RMS_d1_cosT_0_40_to_0_50);
  hist_vec_3000_CT_wO.push_back(h_3000_CT_wO_DR10_E_rel_totVis_RMS_d1_cosT_0_50_to_0_60);
  hist_vec_3000_CT_wO.push_back(h_3000_CT_wO_DR10_E_rel_totVis_RMS_d1_cosT_0_60_to_0_70);
  hist_vec_3000_CT_wO.push_back(h_3000_CT_wO_DR10_E_rel_totVis_RMS_d1_cosT_0_70_to_0_80);
  hist_vec_3000_CT_wO.push_back(h_3000_CT_wO_DR10_E_rel_totVis_RMS_d1_cosT_0_80_to_0_90);
  hist_vec_3000_CT_wO.push_back(h_3000_CT_wO_DR10_E_rel_totVis_RMS_d1_cosT_0_900_to_0_925);
  hist_vec_3000_CT_wO.push_back(h_3000_CT_wO_DR10_E_rel_totVis_RMS_d1_cosT_0_925_to_0_950);
  hist_vec_3000_CT_wO.push_back(h_3000_CT_wO_DR10_E_rel_totVis_RMS_d1_cosT_0_950_to_0_975);
  hist_vec_3000_CT_wO.push_back(h_3000_CT_wO_DR10_E_rel_totVis_RMS_d1_cosT_0_975_to_1_00); //136

  hist_vec_3000_CT_wO.push_back(h_3000_CT_wO_DR05_dphi_reco_gen_cosTheta_0_65);//137
  hist_vec_3000_CT_wO.push_back(h_3000_CT_wO_DR05_dphi_reco_gen_cosTheta_0_65_to_0_80);
  hist_vec_3000_CT_wO.push_back(h_3000_CT_wO_DR05_dphi_reco_gen_cosTheta_0_80_to_0_925);
  hist_vec_3000_CT_wO.push_back(h_3000_CT_wO_DR05_dphi_reco_gen_cosTheta_0_925_to_0_975);
  hist_vec_3000_CT_wO.push_back(h_3000_CT_wO_DR05_dtheta_reco_gen_cosTheta_0_65);
  hist_vec_3000_CT_wO.push_back(h_3000_CT_wO_DR05_dtheta_reco_gen_cosTheta_0_65_to_0_80);
  hist_vec_3000_CT_wO.push_back(h_3000_CT_wO_DR05_dtheta_reco_gen_cosTheta_0_80_to_0_925);
  hist_vec_3000_CT_wO.push_back(h_3000_CT_wO_DR05_dtheta_reco_gen_cosTheta_0_925_to_0_975);

  hist_vec_3000_CT_wO.push_back(h_3000_CT_wO_DR07_dphi_reco_gen_cosTheta_0_65);//145
  hist_vec_3000_CT_wO.push_back(h_3000_CT_wO_DR07_dphi_reco_gen_cosTheta_0_65_to_0_80);
  hist_vec_3000_CT_wO.push_back(h_3000_CT_wO_DR07_dphi_reco_gen_cosTheta_0_80_to_0_925);
  hist_vec_3000_CT_wO.push_back(h_3000_CT_wO_DR07_dphi_reco_gen_cosTheta_0_925_to_0_975);
  hist_vec_3000_CT_wO.push_back(h_3000_CT_wO_DR07_dtheta_reco_gen_cosTheta_0_65);
  hist_vec_3000_CT_wO.push_back(h_3000_CT_wO_DR07_dtheta_reco_gen_cosTheta_0_65_to_0_80);
  hist_vec_3000_CT_wO.push_back(h_3000_CT_wO_DR07_dtheta_reco_gen_cosTheta_0_80_to_0_925);
  hist_vec_3000_CT_wO.push_back(h_3000_CT_wO_DR07_dtheta_reco_gen_cosTheta_0_925_to_0_975);

  hist_vec_3000_CT_wO.push_back(h_3000_CT_wO_DR10_dphi_reco_gen_cosTheta_0_65);//153
  hist_vec_3000_CT_wO.push_back(h_3000_CT_wO_DR10_dphi_reco_gen_cosTheta_0_65_to_0_80);
  hist_vec_3000_CT_wO.push_back(h_3000_CT_wO_DR10_dphi_reco_gen_cosTheta_0_80_to_0_925);
  hist_vec_3000_CT_wO.push_back(h_3000_CT_wO_DR10_dphi_reco_gen_cosTheta_0_925_to_0_975);
  hist_vec_3000_CT_wO.push_back(h_3000_CT_wO_DR10_dtheta_reco_gen_cosTheta_0_65);
  hist_vec_3000_CT_wO.push_back(h_3000_CT_wO_DR10_dtheta_reco_gen_cosTheta_0_65_to_0_80);
  hist_vec_3000_CT_wO.push_back(h_3000_CT_wO_DR10_dtheta_reco_gen_cosTheta_0_80_to_0_925);
  hist_vec_3000_CT_wO.push_back(h_3000_CT_wO_DR10_dtheta_reco_gen_cosTheta_0_925_to_0_975);

  for(unsigned int i=0;i<hist_vec_3000_CT_wO.size();i++){
    hist_vec_3000_CT_wO[i]->Sumw2();
  }
  fill_jet_histograms(file_CLIC_3000_CT_wO,hist_vec_3000_CT_wO);

  TH1F* h_3000_CT_wO_DR05_dphi_SigmaCB_summary_histogram=new TH1F("dphiRes_SigmaCBVsCosTheta_CT_wO_DR05_3000", "#sigma#Delta#phi(j_{reco},j_{true}) vs |cos#theta|", nRegionBinsAngles, pRegionBinEdgesAngles);
  h_3000_CT_wO_DR05_dphi_SigmaCB_summary_histogram ->SetYTitle("#sigma#Delta#phi(j_{reco},j_{true})");
  h_3000_CT_wO_DR05_dphi_SigmaCB_summary_histogram->SetXTitle("|cos#theta|");
  h_3000_CT_wO_DR05_dphi_SigmaCB_summary_histogram->SetLineWidth(2);
  h_3000_CT_wO_DR05_dphi_SigmaCB_summary_histogram->SetLineColor(kCyan+1);
  h_3000_CT_wO_DR05_dphi_SigmaCB_summary_histogram->SetLineStyle(2);

  TH1F* h_3000_CT_wO_DR05_dphi_RMS90_summary_histogram=new TH1F("dphiRes_RMS90VsCosTheta_CT_wO_DR05_3000", "RMS_{90} #Delta#phi(j_{reco},j_{true}) vs |cos#theta|", nRegionBinsAngles, pRegionBinEdgesAngles);
  h_3000_CT_wO_DR05_dphi_RMS90_summary_histogram ->SetYTitle("RMS_{90}#Delta#phi(j_{reco},j_{true})");
  h_3000_CT_wO_DR05_dphi_RMS90_summary_histogram->SetXTitle("|cos#theta|");
  h_3000_CT_wO_DR05_dphi_RMS90_summary_histogram->SetLineWidth(2);
  h_3000_CT_wO_DR05_dphi_RMS90_summary_histogram->SetLineColor(kCyan+1);
  h_3000_CT_wO_DR05_dphi_RMS90_summary_histogram->SetLineStyle(2);

  TH1F* h_3000_CT_wO_DR07_dphi_SigmaCB_summary_histogram=new TH1F("dphiRes_SigmaCBVsCosTheta_CT_wO_DR07_3000", "#sigma#Delta#phi(j_{reco},j_{true}) vs |cos#theta|", nRegionBinsAngles, pRegionBinEdgesAngles);
  h_3000_CT_wO_DR07_dphi_SigmaCB_summary_histogram ->SetYTitle("#sigma#Delta#phi(j_{reco},j_{true})");
  h_3000_CT_wO_DR07_dphi_SigmaCB_summary_histogram->SetXTitle("|cos#theta|");
  h_3000_CT_wO_DR07_dphi_SigmaCB_summary_histogram->SetLineWidth(2);
  h_3000_CT_wO_DR07_dphi_SigmaCB_summary_histogram->SetLineColor(kCyan+1);
  h_3000_CT_wO_DR07_dphi_SigmaCB_summary_histogram->SetLineStyle(2);

  TH1F* h_3000_CT_wO_DR07_dphi_RMS90_summary_histogram=new TH1F("dphiRes_RMS90VsCosTheta_CT_wO_DR07_3000", "RMS_{90} #Delta#phi(j_{reco},j_{true}) vs |cos#theta|", nRegionBinsAngles, pRegionBinEdgesAngles);
  h_3000_CT_wO_DR07_dphi_RMS90_summary_histogram ->SetYTitle("RMS_{90}#Delta#phi(j_{reco},j_{true})");
  h_3000_CT_wO_DR07_dphi_RMS90_summary_histogram->SetXTitle("|cos#theta|");
  h_3000_CT_wO_DR07_dphi_RMS90_summary_histogram->SetLineWidth(2);
  h_3000_CT_wO_DR07_dphi_RMS90_summary_histogram->SetLineColor(kCyan+1);
  h_3000_CT_wO_DR07_dphi_RMS90_summary_histogram->SetLineStyle(2);

  TH1F* h_3000_CT_wO_DR10_dphi_SigmaCB_summary_histogram=new TH1F("dphiRes_SigmaCBVsCosTheta_CT_wO_DR10_3000", "#sigma#Delta#phi(j_{reco},j_{true}) vs |cos#theta|", nRegionBinsAngles, pRegionBinEdgesAngles);
  h_3000_CT_wO_DR10_dphi_SigmaCB_summary_histogram ->SetYTitle("#sigma#Delta#phi(j_{reco},j_{true})");
  h_3000_CT_wO_DR10_dphi_SigmaCB_summary_histogram->SetXTitle("|cos#theta|");
  h_3000_CT_wO_DR10_dphi_SigmaCB_summary_histogram->SetLineWidth(2);
  h_3000_CT_wO_DR10_dphi_SigmaCB_summary_histogram->SetLineColor(kCyan+1);
  h_3000_CT_wO_DR10_dphi_SigmaCB_summary_histogram->SetLineStyle(2);

  TH1F* h_3000_CT_wO_DR10_dphi_RMS90_summary_histogram=new TH1F("dphiRes_RMS90VsCosTheta_CT_wO_DR10_3000", "RMS_{90} #Delta#phi(j_{reco},j_{true}) vs |cos#theta|", nRegionBinsAngles, pRegionBinEdgesAngles);
  h_3000_CT_wO_DR10_dphi_RMS90_summary_histogram ->SetYTitle("RMS_{90}#Delta#phi(j_{reco},j_{true})");
  h_3000_CT_wO_DR10_dphi_RMS90_summary_histogram->SetXTitle("|cos#theta|");
  h_3000_CT_wO_DR10_dphi_RMS90_summary_histogram->SetLineWidth(2);
  h_3000_CT_wO_DR10_dphi_RMS90_summary_histogram->SetLineColor(kCyan+1);
  h_3000_CT_wO_DR10_dphi_RMS90_summary_histogram->SetLineStyle(2);

  TH1F* h_3000_CT_wO_DR05_dtheta_SigmaCB_summary_histogram=new TH1F("dthetaRes_SigmaCBVsCosTheta_CT_wO_DR05_3000", "#sigma#Delta#theta(j_{reco},j_{true}) vs |cos#theta|", nRegionBinsAngles, pRegionBinEdgesAngles);
  h_3000_CT_wO_DR05_dtheta_SigmaCB_summary_histogram ->SetYTitle("#sigma#Delta#theta(j_{reco},j_{true})");
  h_3000_CT_wO_DR05_dtheta_SigmaCB_summary_histogram->SetXTitle("|cos#theta|");
  h_3000_CT_wO_DR05_dtheta_SigmaCB_summary_histogram->SetLineWidth(2);
  h_3000_CT_wO_DR05_dtheta_SigmaCB_summary_histogram->SetLineColor(kCyan+1);
  h_3000_CT_wO_DR05_dtheta_SigmaCB_summary_histogram->SetLineStyle(2);

  TH1F* h_3000_CT_wO_DR05_dtheta_RMS90_summary_histogram=new TH1F("dthetaRes_RMS90VsCosTheta_CT_wO_DR05_3000", "RMS_{90} #Delta#theta(j_{reco},j_{true}) vs |cos#theta|", nRegionBinsAngles, pRegionBinEdgesAngles);
  h_3000_CT_wO_DR05_dtheta_RMS90_summary_histogram ->SetYTitle("RMS_{90}#Delta#theta(j_{reco},j_{true})");
  h_3000_CT_wO_DR05_dtheta_RMS90_summary_histogram->SetXTitle("|cos#theta|");
  h_3000_CT_wO_DR05_dtheta_RMS90_summary_histogram->SetLineWidth(2);
  h_3000_CT_wO_DR05_dtheta_RMS90_summary_histogram->SetLineColor(kCyan+1);
  h_3000_CT_wO_DR05_dtheta_RMS90_summary_histogram->SetLineStyle(2);

  TH1F* h_3000_CT_wO_DR07_dtheta_SigmaCB_summary_histogram=new TH1F("dthetaRes_SigmaCBVsCosTheta_CT_wO_DR07_3000", "#sigma#Delta#theta(j_{reco},j_{true}) vs |cos#theta|", nRegionBinsAngles, pRegionBinEdgesAngles);
  h_3000_CT_wO_DR07_dtheta_SigmaCB_summary_histogram ->SetYTitle("#sigma#Delta#theta(j_{reco},j_{true})");
  h_3000_CT_wO_DR07_dtheta_SigmaCB_summary_histogram->SetXTitle("|cos#theta|");
  h_3000_CT_wO_DR07_dtheta_SigmaCB_summary_histogram->SetLineWidth(2);
  h_3000_CT_wO_DR07_dtheta_SigmaCB_summary_histogram->SetLineColor(kCyan+1);
  h_3000_CT_wO_DR07_dtheta_SigmaCB_summary_histogram->SetLineStyle(2);

  TH1F* h_3000_CT_wO_DR07_dtheta_RMS90_summary_histogram=new TH1F("dthetaRes_RMS90VsCosTheta_CT_wO_DR07_3000", "RMS_{90} #Delta#theta(j_{reco},j_{true}) vs |cos#theta|", nRegionBinsAngles, pRegionBinEdgesAngles);
  h_3000_CT_wO_DR07_dtheta_RMS90_summary_histogram ->SetYTitle("RMS_{90}#Delta#theta(j_{reco},j_{true})");
  h_3000_CT_wO_DR07_dtheta_RMS90_summary_histogram->SetXTitle("|cos#theta|");
  h_3000_CT_wO_DR07_dtheta_RMS90_summary_histogram->SetLineWidth(2);
  h_3000_CT_wO_DR07_dtheta_RMS90_summary_histogram->SetLineColor(kCyan+1);
  h_3000_CT_wO_DR07_dtheta_RMS90_summary_histogram->SetLineStyle(2);

  TH1F* h_3000_CT_wO_DR10_dtheta_SigmaCB_summary_histogram=new TH1F("dthetaRes_SigmaCBVsCosTheta_CT_wO_DR10_3000", "#sigma#Delta#theta(j_{reco},j_{true}) vs |cos#theta|", nRegionBinsAngles, pRegionBinEdgesAngles);
  h_3000_CT_wO_DR10_dtheta_SigmaCB_summary_histogram ->SetYTitle("#sigma#Delta#theta(j_{reco},j_{true})");
  h_3000_CT_wO_DR10_dtheta_SigmaCB_summary_histogram->SetXTitle("|cos#theta|");
  h_3000_CT_wO_DR10_dtheta_SigmaCB_summary_histogram->SetLineWidth(2);
  h_3000_CT_wO_DR10_dtheta_SigmaCB_summary_histogram->SetLineColor(kCyan+1);
  h_3000_CT_wO_DR10_dtheta_SigmaCB_summary_histogram->SetLineStyle(2);

  TH1F* h_3000_CT_wO_DR10_dtheta_RMS90_summary_histogram=new TH1F("dthetaRes_RMS90VsCosTheta_CT_wO_DR10_3000", "RMS_{90} #Delta#theta(j_{reco},j_{true}) vs |cos#theta|", nRegionBinsAngles, pRegionBinEdgesAngles);
  h_3000_CT_wO_DR10_dtheta_RMS90_summary_histogram ->SetYTitle("RMS_{90}#Delta#theta(j_{reco},j_{true})");
  h_3000_CT_wO_DR10_dtheta_RMS90_summary_histogram->SetXTitle("|cos#theta|");
  h_3000_CT_wO_DR10_dtheta_RMS90_summary_histogram->SetLineWidth(2);
  h_3000_CT_wO_DR10_dtheta_RMS90_summary_histogram->SetLineColor(kCyan+1);
  h_3000_CT_wO_DR10_dtheta_RMS90_summary_histogram->SetLineStyle(2);

  for(int i=137;i<161;i++){
//continue;
    std::cout<<"ang histo 3000 "<<i<<"]"<<std::endl;
   //double sided crystal ball
    TF1* fit_gaus_tmp = new TF1("fit_gaus_tmp", "gaus",-5.,5.);
    hist_vec_3000_CT_wO[i]->Fit("fit_gaus_tmp","R");
    hist_vec_3000_CT_wO[i]->GetFunction("fit_gaus_tmp");
    TF1* fdscb_tmp = new TF1("fdscb_tmp",fnc_dscb,-lim_angleDeg,lim_angleDeg,7);
   fdscb_tmp->SetNpx(2000);
    fdscb_tmp->SetParameter(0,fit_gaus_tmp->GetParameter(0));
    //norm
    fdscb_tmp->SetParLimits (0,0.5*fit_gaus_tmp->GetParameter(0),1.5*fit_gaus_tmp->GetParameter(0));
    fdscb_tmp->SetParameter(1,fit_gaus_tmp->GetParameter(1));
    //gaussian mean
    fdscb_tmp->SetParLimits (1,-2.,2.);
    fdscb_tmp->SetParameter(2,fit_gaus_tmp->GetParameter(2));
    fdscb_tmp->SetParLimits(2,fit_gaus_tmp->GetParameter(2)*0.50,1.50*fit_gaus_tmp->GetParameter(2));
    //std::vector<float>sigma2SFit=sigmaGaussianFits2Sigma(hist_vec_3000_CT_wO[i]);
    //fdscb_tmp->SetParameter(2,sigma2SFit[0]);
    //fdscb_tmp->SetParLimits(2,sigma2SFit[0]*0.50,1.50*sigma2SFit[0]);
    //-a1: parameter, from when the gaussian core should count
    //fdscb_tmp->SetParameter(2,fit_gaus_tmp->GetParameter(2));
    fdscb_tmp->SetParameter (3,3.0);
    fdscb_tmp->SetParLimits (3,0.0,10.0);
    //a2 parameter, up to when the gaussian core should count
    fdscb_tmp->SetParameter (5,3.0);
    fdscb_tmp->SetParLimits (5,0.0,10.0);
    fdscb_tmp->SetParameter(4,5.);
    fdscb_tmp->SetParLimits(4,0.,25.);
    fdscb_tmp->SetParameter(6,5.);
    fdscb_tmp->SetParLimits(6,0.,25.);
    int fitstatus(0); 
    fitstatus = hist_vec_3000_CT_wO[i]->Fit(fdscb_tmp,"R");
    fdscb_tmp = hist_vec_3000_CT_wO[i]->GetFunction("fdscb_tmp");
    resolutionTH1=0; 
    resolutionErrorTH1=0;
    meanTH1=0;
    meanErrorTH1=0;
    CalculatePerformanceNoMean( hist_vec_3000_CT_wO[i], resolutionTH1, resolutionErrorTH1,meanTH1,meanErrorTH1);
    int first_bin_ang=137;
    if(i<141){//dphi DR05
      first_bin_ang=137;
      h_3000_CT_wO_DR05_dphi_SigmaCB_summary_histogram->SetBinContent(i-first_bin_ang+1,fdscb_tmp->GetParameter(2));
      h_3000_CT_wO_DR05_dphi_SigmaCB_summary_histogram->SetBinError(i-first_bin_ang+1,fdscb_tmp->GetParError(2));
      h_3000_CT_wO_DR05_dphi_RMS90_summary_histogram->SetBinContent(i-first_bin_ang+1,resolutionTH1);
      h_3000_CT_wO_DR05_dphi_RMS90_summary_histogram->SetBinError(i-first_bin_ang+1, resolutionErrorTH1);
    }else if(i<145){//dtheta DR05
      first_bin_ang=141;
      h_3000_CT_wO_DR05_dtheta_SigmaCB_summary_histogram->SetBinContent(i-first_bin_ang+1,fdscb_tmp->GetParameter(2));
      h_3000_CT_wO_DR05_dtheta_SigmaCB_summary_histogram->SetBinError(i-first_bin_ang+1,fdscb_tmp->GetParError(2));
      h_3000_CT_wO_DR05_dtheta_RMS90_summary_histogram->SetBinContent(i-first_bin_ang+1,resolutionTH1);
      h_3000_CT_wO_DR05_dtheta_RMS90_summary_histogram->SetBinError(i-first_bin_ang+1, resolutionErrorTH1);
    }else if(i<149){//dphi DR07
      first_bin_ang=145;
      h_3000_CT_wO_DR07_dphi_SigmaCB_summary_histogram->SetBinContent(i-first_bin_ang+1,fdscb_tmp->GetParameter(2));
      h_3000_CT_wO_DR07_dphi_SigmaCB_summary_histogram->SetBinError(i-first_bin_ang+1,fdscb_tmp->GetParError(2));
      h_3000_CT_wO_DR07_dphi_RMS90_summary_histogram->SetBinContent(i-first_bin_ang+1,resolutionTH1);
      h_3000_CT_wO_DR07_dphi_RMS90_summary_histogram->SetBinError(i-first_bin_ang+1, resolutionErrorTH1);
    }else if(i<153){//dtheta DR07
      first_bin_ang=149;
      h_3000_CT_wO_DR07_dtheta_SigmaCB_summary_histogram->SetBinContent(i-first_bin_ang+1,fdscb_tmp->GetParameter(2));
      h_3000_CT_wO_DR07_dtheta_SigmaCB_summary_histogram->SetBinError(i-first_bin_ang+1,fdscb_tmp->GetParError(2));
      h_3000_CT_wO_DR07_dtheta_RMS90_summary_histogram->SetBinContent(i-first_bin_ang+1,resolutionTH1);
      h_3000_CT_wO_DR07_dtheta_RMS90_summary_histogram->SetBinError(i-first_bin_ang+1, resolutionErrorTH1);
    }else if(i<157){//dphi DR07
      first_bin_ang=153;
      h_3000_CT_wO_DR10_dphi_SigmaCB_summary_histogram->SetBinContent(i-first_bin_ang+1,fdscb_tmp->GetParameter(2));
      h_3000_CT_wO_DR10_dphi_SigmaCB_summary_histogram->SetBinError(i-first_bin_ang+1,fdscb_tmp->GetParError(2));
      h_3000_CT_wO_DR10_dphi_RMS90_summary_histogram->SetBinContent(i-first_bin_ang+1,resolutionTH1);
      h_3000_CT_wO_DR10_dphi_RMS90_summary_histogram->SetBinError(i-first_bin_ang+1, resolutionErrorTH1);
    }else if(i<161){//dtheta DR07
      first_bin_ang=157;
      h_3000_CT_wO_DR10_dtheta_SigmaCB_summary_histogram->SetBinContent(i-first_bin_ang+1,fdscb_tmp->GetParameter(2));
      h_3000_CT_wO_DR10_dtheta_SigmaCB_summary_histogram->SetBinError(i-first_bin_ang+1,fdscb_tmp->GetParError(2));
      h_3000_CT_wO_DR10_dtheta_RMS90_summary_histogram->SetBinContent(i-first_bin_ang+1,resolutionTH1);
      h_3000_CT_wO_DR10_dtheta_RMS90_summary_histogram->SetBinError(i-first_bin_ang+1, resolutionErrorTH1);
    }
  }

  TH1F* h_3000_CT_wO_DR05_E_SigmaCB_summary_histogram=new TH1F("JER_SigmaCBVsCosTheta_CT_wO_DR05_3000", "RMS_{90}(E_{j}^{reco}/E_{j}^{gen}) / Mean_{90}(E_{j}^{reco}/E_{j}^{gen}) vs |cos#theta|", nRegionBins, pRegionBinEdges);
  h_3000_CT_wO_DR05_E_SigmaCB_summary_histogram ->SetYTitle("#sigma(E_{j}) / E_{j} [%]");
  h_3000_CT_wO_DR05_E_SigmaCB_summary_histogram->SetXTitle("|cos#theta|");
  h_3000_CT_wO_DR05_E_SigmaCB_summary_histogram->SetLineWidth(2);
  h_3000_CT_wO_DR05_E_SigmaCB_summary_histogram->SetLineColor(kRed);
  h_3000_CT_wO_DR05_E_SigmaCB_summary_histogram->SetLineStyle(2);
  TH1F* h_3000_CT_wO_DR05_E_RMS90_summary_histogram=new TH1F("JER_RMS90VsCosTheta_CT_wO_DR05_3000", "RMS_{90}(E_{j}^{reco}/E_{j}^{gen}) / Mean_{90}(E_{j}^{reco}/E_{j}^{gen}) vs |cos#theta|", nRegionBins, pRegionBinEdges);
  h_3000_CT_wO_DR05_E_RMS90_summary_histogram ->SetYTitle("RMS_{90}(E_{j}^{reco}/E_{j}^{gen}) / Mean_{90}(E_{j}^{reco}/E_{j}^{gen}) [%]");
  h_3000_CT_wO_DR05_E_RMS90_summary_histogram->SetXTitle("|cos#theta|");
  h_3000_CT_wO_DR05_E_RMS90_summary_histogram->SetLineWidth(2);
  h_3000_CT_wO_DR05_E_RMS90_summary_histogram->SetLineColor(kRed);
  h_3000_CT_wO_DR05_E_RMS90_summary_histogram->SetLineStyle(2);

  TH1F* h_3000_CT_wO_DR05_E_RMS_summary_histogram=new TH1F("JER_RMSVsCosTheta_CT_wO_DR05_3000", "RMS(E_{j}) / Mean(E_{j}) vs |cos#theta|", nRegionBins, pRegionBinEdges);
  h_3000_CT_wO_DR05_E_RMS_summary_histogram ->SetYTitle("RMS(E_{j}) / Mean(E_{j}) [%]");
  h_3000_CT_wO_DR05_E_RMS_summary_histogram->SetXTitle("|cos#theta|");
  h_3000_CT_wO_DR05_E_RMS_summary_histogram->SetLineWidth(2);
  h_3000_CT_wO_DR05_E_RMS_summary_histogram->SetLineColor(kRed);
  h_3000_CT_wO_DR05_E_RMS_summary_histogram->SetLineStyle(2);

  TH1F* h_3000_CT_wO_DR05_E_JER_Mean_summary_histogram=new TH1F("JER_MeanVsCosTheta_CT_wO_DR05_3000", "Mean(E_{tot}^{RECO}/E_{tot}^{true}) vs |cos#theta|", nRegionBins, pRegionBinEdges);
  h_3000_CT_wO_DR05_E_JER_Mean_summary_histogram->SetYTitle("Mean(E_{tot}^{RECO}/E_{tot}^{true})");
  h_3000_CT_wO_DR05_E_JER_Mean_summary_histogram->SetXTitle("|cos#theta|");
  h_3000_CT_wO_DR05_E_JER_Mean_summary_histogram->SetLineWidth(2);
  h_3000_CT_wO_DR05_E_JER_Mean_summary_histogram->SetLineColor(kRed);
  h_3000_CT_wO_DR05_E_JER_Mean_summary_histogram->SetLineStyle(2);

  firstbin=59;
  for(int i=firstbin;i<(firstbin+13);i++){
//continue;
    resolutionTH1=0; 
    resolutionErrorTH1=0;
    meanTH1=0;
    meanErrorTH1=0;
    CalculatePerformance( hist_vec_3000_CT_wO[i], resolutionTH1, resolutionErrorTH1,meanTH1,meanErrorTH1);
    h_3000_CT_wO_DR05_E_RMS90_summary_histogram->SetBinContent(i-firstbin+1,resolutionTH1/sqrt(2.));
    h_3000_CT_wO_DR05_E_RMS90_summary_histogram ->SetBinError(i-firstbin+1, resolutionErrorTH1/sqrt(2.));
    h_3000_CT_wO_DR05_E_RMS_summary_histogram->SetBinContent(i-firstbin+1,hist_vec_3000_CT_wO[i]->GetRMS()*100. );
    h_3000_CT_wO_DR05_E_RMS_summary_histogram ->SetBinError(i-firstbin+1, hist_vec_3000_CT_wO[i]->GetRMSError()*100.);
    h_3000_CT_wO_DR05_E_JER_Mean_summary_histogram->SetBinContent(i-firstbin+1,hist_vec_3000_CT_wO[i]->GetMean());
    h_3000_CT_wO_DR05_E_JER_Mean_summary_histogram->SetBinError(i-firstbin+1,hist_vec_3000_CT_wO[i]->GetMeanError());
    //double sided crystal ball
    TF1* fit_gaus_tmp = new TF1("fit_gaus_tmp", "gaus",0.50,1.50);
    hist_vec_3000_CT_wO[i]->Fit("fit_gaus_tmp","R");
    hist_vec_3000_CT_wO[i]->GetFunction("fit_gaus_tmp");

    TF1* fdscb_tmp = new TF1("fdscb_tmp",fnc_dscb,0.,3.,7);
    fdscb_tmp->SetNpx(1000);
    fdscb_tmp->SetParameter(0,fit_gaus_tmp->GetParameter(0));
    //norm
    fdscb_tmp->SetParLimits (0,0.5*fit_gaus_tmp->GetParameter(0),1.5*fit_gaus_tmp->GetParameter(0));
    fdscb_tmp->SetParameter(1,fit_gaus_tmp->GetParameter(1));
    //gaussian mean
    fdscb_tmp->SetParLimits (1,0.8,1.2);
    //fdscb_tmp->SetParameter(2,fit_gaus_tmp->GetParameter(2));
    //fdscb_tmp->SetParLimits(2,fit_gaus_tmp->GetParameter(2)*0.50,1.50*fit_gaus_tmp->GetParameter(2));
    std::vector<float>sigma2SFit=sigmaGaussianFits2Sigma(hist_vec_3000_CT_wO[i]);
    fdscb_tmp->SetParameter(2,sigma2SFit[0]);
    fdscb_tmp->SetParLimits(2,sigma2SFit[0]*0.50,1.50*sigma2SFit[0]);
    //-a1: parameter, from when the gaussian core should count
    fdscb_tmp->SetParameter(2,fit_gaus_tmp->GetParameter(2));
    fdscb_tmp->SetParameter (3,3.0);
    fdscb_tmp->SetParLimits (3,0.0,10.0);
    //a2 parameter, up to when the gaussian core should count
    fdscb_tmp->SetParameter (5,3.0);
    fdscb_tmp->SetParLimits (5,0.0,10.0);
    fdscb_tmp->SetParameter(4,5.);
    fdscb_tmp->SetParLimits(4,0.,25.);
    fdscb_tmp->SetParameter(6,5.);
    fdscb_tmp->SetParLimits(6,0.,25.);
    int fitstatus(0); 
    fitstatus = hist_vec_3000_CT_wO[i]->Fit(fdscb_tmp,"R");
    fdscb_tmp = hist_vec_3000_CT_wO[i]->GetFunction("fdscb_tmp");
    h_3000_CT_wO_DR05_E_SigmaCB_summary_histogram->SetBinContent(i-firstbin+1,fdscb_tmp->GetParameter(2)*100. );
    h_3000_CT_wO_DR05_E_SigmaCB_summary_histogram->SetBinError(i-firstbin+1,fdscb_tmp->GetParError(2)*100. );
  }  
  TH1F* h_3000_CT_wO_DR06_E_SigmaCB_summary_histogram=new TH1F("JER_SigmaCBVsCosTheta_CT_wO_DR06_3000", "RMS_{90}(E_{j}^{reco}/E_{j}^{gen}) / Mean_{90}(E_{j}^{reco}/E_{j}^{gen}) vs |cos#theta|", nRegionBins, pRegionBinEdges);
  h_3000_CT_wO_DR06_E_SigmaCB_summary_histogram ->SetYTitle("#sigma(E_{j}) / E_{j} [%]");
  h_3000_CT_wO_DR06_E_SigmaCB_summary_histogram->SetXTitle("|cos#theta|");
  h_3000_CT_wO_DR06_E_SigmaCB_summary_histogram->SetLineWidth(2);
  h_3000_CT_wO_DR06_E_SigmaCB_summary_histogram->SetLineColor(kRed);
  h_3000_CT_wO_DR06_E_SigmaCB_summary_histogram->SetLineStyle(2);
  TH1F* h_3000_CT_wO_DR06_E_RMS90_summary_histogram=new TH1F("JER_RMS90VsCosTheta_CT_wO_DR06_3000", "RMS_{90}(E_{j}^{reco}/E_{j}^{gen}) / Mean_{90}(E_{j}^{reco}/E_{j}^{gen}) vs |cos#theta|", nRegionBins, pRegionBinEdges);
  h_3000_CT_wO_DR06_E_RMS90_summary_histogram ->SetYTitle("RMS_{90}(E_{j}^{reco}/E_{j}^{gen}) / Mean_{90}(E_{j}^{reco}/E_{j}^{gen}) [%]");
  h_3000_CT_wO_DR06_E_RMS90_summary_histogram->SetXTitle("|cos#theta|");
  h_3000_CT_wO_DR06_E_RMS90_summary_histogram->SetLineWidth(2);
  h_3000_CT_wO_DR06_E_RMS90_summary_histogram->SetLineColor(kRed);
  h_3000_CT_wO_DR06_E_RMS90_summary_histogram->SetLineStyle(2);

  TH1F* h_3000_CT_wO_DR06_E_RMS_summary_histogram=new TH1F("JER_RMSVsCosTheta_CT_wO_DR06_3000", "RMS(E_{j}) / Mean(E_{j}) vs |cos#theta|", nRegionBins, pRegionBinEdges);
  h_3000_CT_wO_DR06_E_RMS_summary_histogram ->SetYTitle("RMS(E_{j}) / Mean(E_{j}) [%]");
  h_3000_CT_wO_DR06_E_RMS_summary_histogram->SetXTitle("|cos#theta|");
  h_3000_CT_wO_DR06_E_RMS_summary_histogram->SetLineWidth(2);
  h_3000_CT_wO_DR06_E_RMS_summary_histogram->SetLineColor(kRed);
  h_3000_CT_wO_DR06_E_RMS_summary_histogram->SetLineStyle(2);

  TH1F* h_3000_CT_wO_DR06_E_JER_Mean_summary_histogram=new TH1F("JER_MeanVsCosTheta_CT_wO_DR06_3000", "Mean(E_{tot}^{RECO}/E_{tot}^{true}) vs |cos#theta|", nRegionBins, pRegionBinEdges);
  h_3000_CT_wO_DR06_E_JER_Mean_summary_histogram->SetYTitle("Mean(E_{tot}^{RECO}/E_{tot}^{true})");
  h_3000_CT_wO_DR06_E_JER_Mean_summary_histogram->SetXTitle("|cos#theta|");
  h_3000_CT_wO_DR06_E_JER_Mean_summary_histogram->SetLineWidth(2);
  h_3000_CT_wO_DR06_E_JER_Mean_summary_histogram->SetLineColor(kRed);
  h_3000_CT_wO_DR06_E_JER_Mean_summary_histogram->SetLineStyle(2);
  firstbin=72;
  for(int i=firstbin;i<(firstbin+13);i++){
//continue;
    resolutionTH1=0; 
    resolutionErrorTH1=0;
    meanTH1=0;
    meanErrorTH1=0;
    CalculatePerformance( hist_vec_3000_CT_wO[i], resolutionTH1, resolutionErrorTH1,meanTH1,meanErrorTH1);
    h_3000_CT_wO_DR06_E_RMS90_summary_histogram->SetBinContent(i-firstbin+1,resolutionTH1/sqrt(2.));
    h_3000_CT_wO_DR06_E_RMS90_summary_histogram ->SetBinError(i-firstbin+1, resolutionErrorTH1/sqrt(2.));
    h_3000_CT_wO_DR06_E_RMS_summary_histogram->SetBinContent(i-firstbin+1,hist_vec_3000_CT_wO[i]->GetRMS()*100. );
    h_3000_CT_wO_DR06_E_RMS_summary_histogram ->SetBinError(i-firstbin+1, hist_vec_3000_CT_wO[i]->GetRMSError()*100.);
    h_3000_CT_wO_DR06_E_JER_Mean_summary_histogram->SetBinContent(i-firstbin+1,hist_vec_3000_CT_wO[i]->GetMean());
    h_3000_CT_wO_DR06_E_JER_Mean_summary_histogram->SetBinError(i-firstbin+1,hist_vec_3000_CT_wO[i]->GetMeanError());
    //double sided crystal ball
    TF1* fit_gaus_tmp = new TF1("fit_gaus_tmp", "gaus",0.50,1.50);
    hist_vec_3000_CT_wO[i]->Fit("fit_gaus_tmp","R");
    hist_vec_3000_CT_wO[i]->GetFunction("fit_gaus_tmp");

    TF1* fdscb_tmp = new TF1("fdscb_tmp",fnc_dscb,0.,3.,7);
   fdscb_tmp->SetNpx(1000);
    fdscb_tmp->SetParameter(0,fit_gaus_tmp->GetParameter(0));
    //norm
    fdscb_tmp->SetParLimits (0,0.5*fit_gaus_tmp->GetParameter(0),1.5*fit_gaus_tmp->GetParameter(0));
    fdscb_tmp->SetParameter(1,fit_gaus_tmp->GetParameter(1));
    //gaussian mean
    fdscb_tmp->SetParLimits (1,0.8,1.2);
    //fdscb_tmp->SetParameter(2,fit_gaus_tmp->GetParameter(2));
    //fdscb_tmp->SetParLimits(2,fit_gaus_tmp->GetParameter(2)*0.50,1.50*fit_gaus_tmp->GetParameter(2));
    std::vector<float>sigma2SFit=sigmaGaussianFits2Sigma(hist_vec_3000_CT_wO[i]);
    fdscb_tmp->SetParameter(2,sigma2SFit[0]);
    fdscb_tmp->SetParLimits(2,sigma2SFit[0]*0.50,1.50*sigma2SFit[0]);
    //-a1: parameter, from when the gaussian core should count
    fdscb_tmp->SetParameter(2,fit_gaus_tmp->GetParameter(2));
    fdscb_tmp->SetParameter (3,3.0);
    fdscb_tmp->SetParLimits (3,0.0,10.0);
    //a2 parameter, up to when the gaussian core should count
    fdscb_tmp->SetParameter (5,3.0);
    fdscb_tmp->SetParLimits (5,0.0,10.0);
    fdscb_tmp->SetParameter(4,5.);
    fdscb_tmp->SetParLimits(4,0.,25.);
    fdscb_tmp->SetParameter(6,5.);
    fdscb_tmp->SetParLimits(6,0.,25.);
    int fitstatus(0); 
    fitstatus = hist_vec_3000_CT_wO[i]->Fit(fdscb_tmp,"R");
    fdscb_tmp = hist_vec_3000_CT_wO[i]->GetFunction("fdscb_tmp");
    h_3000_CT_wO_DR06_E_SigmaCB_summary_histogram->SetBinContent(i-firstbin+1,fdscb_tmp->GetParameter(2)*100. );
    h_3000_CT_wO_DR06_E_SigmaCB_summary_histogram->SetBinError(i-firstbin+1,fdscb_tmp->GetParError(2)*100. );
  }  
  TH1F* h_3000_CT_wO_DR07_E_SigmaCB_summary_histogram=new TH1F("JER_SigmaCBVsCosTheta_CT_wO_DR07_3000", "RMS_{90}(E_{j}^{reco}/E_{j}^{gen}) / Mean_{90}(E_{j}^{reco}/E_{j}^{gen}) vs |cos#theta|", nRegionBins, pRegionBinEdges);
  h_3000_CT_wO_DR07_E_SigmaCB_summary_histogram ->SetYTitle("#sigma(E_{j}) / E_{j} [%]");
  h_3000_CT_wO_DR07_E_SigmaCB_summary_histogram->SetXTitle("|cos#theta|");
  h_3000_CT_wO_DR07_E_SigmaCB_summary_histogram->SetLineWidth(2);
  h_3000_CT_wO_DR07_E_SigmaCB_summary_histogram->SetLineColor(kRed);
  h_3000_CT_wO_DR07_E_SigmaCB_summary_histogram->SetLineStyle(2);
  TH1F* h_3000_CT_wO_DR07_E_RMS90_summary_histogram=new TH1F("JER_RMS90VsCosTheta_CT_wO_DR07_3000", "RMS_{90}(E_{j}^{reco}/E_{j}^{gen}) / Mean_{90}(E_{j}^{reco}/E_{j}^{gen}) vs |cos#theta|", nRegionBins, pRegionBinEdges);
  h_3000_CT_wO_DR07_E_RMS90_summary_histogram ->SetYTitle("RMS_{90}(E_{j}^{reco}/E_{j}^{gen}) / Mean_{90}(E_{j}^{reco}/E_{j}^{gen}) [%]");
  h_3000_CT_wO_DR07_E_RMS90_summary_histogram->SetXTitle("|cos#theta|");
  h_3000_CT_wO_DR07_E_RMS90_summary_histogram->SetLineWidth(2);
  h_3000_CT_wO_DR07_E_RMS90_summary_histogram->SetLineColor(kRed);
  h_3000_CT_wO_DR07_E_RMS90_summary_histogram->SetLineStyle(2);

  TH1F* h_3000_CT_wO_DR07_E_RMS_summary_histogram=new TH1F("JER_RMSVsCosTheta_CT_wO_DR07_3000", "RMS(E_{j}) / Mean(E_{j}) vs |cos#theta|", nRegionBins, pRegionBinEdges);
  h_3000_CT_wO_DR07_E_RMS_summary_histogram ->SetYTitle("RMS(E_{j}) / Mean(E_{j}) [%]");
  h_3000_CT_wO_DR07_E_RMS_summary_histogram->SetXTitle("|cos#theta|");
  h_3000_CT_wO_DR07_E_RMS_summary_histogram->SetLineWidth(2);
  h_3000_CT_wO_DR07_E_RMS_summary_histogram->SetLineColor(kRed);
  h_3000_CT_wO_DR07_E_RMS_summary_histogram->SetLineStyle(2);

  TH1F* h_3000_CT_wO_DR07_E_JER_Mean_summary_histogram=new TH1F("JER_MeanVsCosTheta_CT_wO_DR07_3000", "Mean(E_{tot}^{RECO}/E_{tot}^{true}) vs |cos#theta|", nRegionBins, pRegionBinEdges);
  h_3000_CT_wO_DR07_E_JER_Mean_summary_histogram->SetYTitle("Mean(E_{tot}^{RECO}/E_{tot}^{true})");
  h_3000_CT_wO_DR07_E_JER_Mean_summary_histogram->SetXTitle("|cos#theta|");
  h_3000_CT_wO_DR07_E_JER_Mean_summary_histogram->SetLineWidth(2);
  h_3000_CT_wO_DR07_E_JER_Mean_summary_histogram->SetLineColor(kRed);
  h_3000_CT_wO_DR07_E_JER_Mean_summary_histogram->SetLineStyle(2);
  firstbin=85;
  std::cout<<"start DR07 wO 3000"<<std::endl;
  for(int i=firstbin;i<(firstbin+13);i++){
//continue;
    resolutionTH1=0; 
    resolutionErrorTH1=0;
    meanTH1=0;
    meanErrorTH1=0;
    CalculatePerformance( hist_vec_3000_CT_wO[i], resolutionTH1, resolutionErrorTH1,meanTH1,meanErrorTH1);
    h_3000_CT_wO_DR07_E_RMS90_summary_histogram->SetBinContent(i-firstbin+1,resolutionTH1/sqrt(2.));
    h_3000_CT_wO_DR07_E_RMS90_summary_histogram ->SetBinError(i-firstbin+1, resolutionErrorTH1/sqrt(2.));
    h_3000_CT_wO_DR07_E_RMS_summary_histogram->SetBinContent(i-firstbin+1,hist_vec_3000_CT_wO[i]->GetRMS()*100. );
    h_3000_CT_wO_DR07_E_RMS_summary_histogram ->SetBinError(i-firstbin+1, hist_vec_3000_CT_wO[i]->GetRMSError()*100.);
    h_3000_CT_wO_DR07_E_JER_Mean_summary_histogram->SetBinContent(i-firstbin+1,hist_vec_3000_CT_wO[i]->GetMean());
    h_3000_CT_wO_DR07_E_JER_Mean_summary_histogram->SetBinError(i-firstbin+1,hist_vec_3000_CT_wO[i]->GetMeanError());
    //double sided crystal ball
    TF1* fit_gaus_tmp = new TF1("fit_gaus_tmp", "gaus",0.50,1.50);
    hist_vec_3000_CT_wO[i]->Fit("fit_gaus_tmp","R");
    hist_vec_3000_CT_wO[i]->GetFunction("fit_gaus_tmp");

    TF1* fdscb_tmp = new TF1("fdscb_tmp",fnc_dscb,0.,3.,7);
   fdscb_tmp->SetNpx(1000);
    fdscb_tmp->SetParameter(0,fit_gaus_tmp->GetParameter(0));
    //norm
    fdscb_tmp->SetParLimits (0,0.5*fit_gaus_tmp->GetParameter(0),1.5*fit_gaus_tmp->GetParameter(0));
    fdscb_tmp->SetParameter(1,fit_gaus_tmp->GetParameter(1));
    //gaussian mean
    fdscb_tmp->SetParLimits (1,0.8,1.2);
    //fdscb_tmp->SetParameter(2,fit_gaus_tmp->GetParameter(2));
    //fdscb_tmp->SetParLimits(2,fit_gaus_tmp->GetParameter(2)*0.0,1.10*fit_gaus_tmp->GetParameter(2));
    std::vector<float>sigma2SFit=sigmaGaussianFits2Sigma(hist_vec_3000_CT_wO[i]);
    fdscb_tmp->SetParameter(2,sigma2SFit[0]);
    fdscb_tmp->SetParLimits(2,sigma2SFit[0]*0.50,1.50*sigma2SFit[0]);
    //-a1: parameter, from when the gaussian core should count
    fdscb_tmp->SetParameter(2,fit_gaus_tmp->GetParameter(2));
    fdscb_tmp->SetParameter (3,3.0);
    fdscb_tmp->SetParLimits (3,0.0,10.0);
    //a2 parameter, up to when the gaussian core should count
    fdscb_tmp->SetParameter (5,3.0);
    fdscb_tmp->SetParLimits (5,0.0,10.0);
    fdscb_tmp->SetParameter(4,5.);
    fdscb_tmp->SetParLimits(4,0.,25.);
    fdscb_tmp->SetParameter(6,5.);
    fdscb_tmp->SetParLimits(6,0.,25.);
    int fitstatus(0); 
    fitstatus = hist_vec_3000_CT_wO[i]->Fit(fdscb_tmp,"R");
    fdscb_tmp = hist_vec_3000_CT_wO[i]->GetFunction("fdscb_tmp");
    h_3000_CT_wO_DR07_E_SigmaCB_summary_histogram->SetBinContent(i-firstbin+1,fdscb_tmp->GetParameter(2)*100. );
    h_3000_CT_wO_DR07_E_SigmaCB_summary_histogram->SetBinError(i-firstbin+1,fdscb_tmp->GetParError(2)*100. );
  }  
std::cout<<"end DR07 wO 3000"<<std::endl;

  TH1F* h_3000_CT_wO_DR08_E_SigmaCB_summary_histogram=new TH1F("JER_SigmaCBVsCosTheta_CT_wO_DR08_3000", "RMS_{90}(E_{j}^{reco}/E_{j}^{gen}) / Mean_{90}(E_{j}^{reco}/E_{j}^{gen}) vs |cos#theta|", nRegionBins, pRegionBinEdges);
  h_3000_CT_wO_DR08_E_SigmaCB_summary_histogram ->SetYTitle("#sigma(E_{j}) / E_{j} [%]");
  h_3000_CT_wO_DR08_E_SigmaCB_summary_histogram->SetXTitle("|cos#theta|");
  h_3000_CT_wO_DR08_E_SigmaCB_summary_histogram->SetLineWidth(2);
  h_3000_CT_wO_DR08_E_SigmaCB_summary_histogram->SetLineColor(kRed);
  h_3000_CT_wO_DR08_E_SigmaCB_summary_histogram->SetLineStyle(2);
  TH1F* h_3000_CT_wO_DR08_E_RMS90_summary_histogram=new TH1F("JER_RMS90VsCosTheta_CT_wO_DR08_3000", "RMS_{90}(E_{j}^{reco}/E_{j}^{gen}) / Mean_{90}(E_{j}^{reco}/E_{j}^{gen}) vs |cos#theta|", nRegionBins, pRegionBinEdges);
  h_3000_CT_wO_DR08_E_RMS90_summary_histogram ->SetYTitle("RMS_{90}(E_{j}^{reco}/E_{j}^{gen}) / Mean_{90}(E_{j}^{reco}/E_{j}^{gen}) [%]");
  h_3000_CT_wO_DR08_E_RMS90_summary_histogram->SetXTitle("|cos#theta|");
  h_3000_CT_wO_DR08_E_RMS90_summary_histogram->SetLineWidth(2);
  h_3000_CT_wO_DR08_E_RMS90_summary_histogram->SetLineColor(kRed);
  h_3000_CT_wO_DR08_E_RMS90_summary_histogram->SetLineStyle(2);

  TH1F* h_3000_CT_wO_DR08_E_RMS_summary_histogram=new TH1F("JER_RMSVsCosTheta_CT_wO_DR08_3000", "RMS(E_{j}) / Mean(E_{j}) vs |cos#theta|", nRegionBins, pRegionBinEdges);
  h_3000_CT_wO_DR08_E_RMS_summary_histogram ->SetYTitle("RMS(E_{j}) / Mean(E_{j}) [%]");
  h_3000_CT_wO_DR08_E_RMS_summary_histogram->SetXTitle("|cos#theta|");
  h_3000_CT_wO_DR08_E_RMS_summary_histogram->SetLineWidth(2);
  h_3000_CT_wO_DR08_E_RMS_summary_histogram->SetLineColor(kRed);
  h_3000_CT_wO_DR08_E_RMS_summary_histogram->SetLineStyle(2);

  TH1F* h_3000_CT_wO_DR08_E_JER_Mean_summary_histogram=new TH1F("JER_MeanVsCosTheta_CT_wO_DR08_3000", "Mean(E_{tot}^{RECO}/E_{tot}^{true}) vs |cos#theta|", nRegionBins, pRegionBinEdges);
  h_3000_CT_wO_DR08_E_JER_Mean_summary_histogram->SetYTitle("Mean(E_{tot}^{RECO}/E_{tot}^{true})");
  h_3000_CT_wO_DR08_E_JER_Mean_summary_histogram->SetXTitle("|cos#theta|");
  h_3000_CT_wO_DR08_E_JER_Mean_summary_histogram->SetLineWidth(2);
  h_3000_CT_wO_DR08_E_JER_Mean_summary_histogram->SetLineColor(kRed);
  h_3000_CT_wO_DR08_E_JER_Mean_summary_histogram->SetLineStyle(2);
  firstbin=98;
  for(int i=firstbin;i<(firstbin+13);i++){
//continue;
    resolutionTH1=0; 
    resolutionErrorTH1=0;
    meanTH1=0;
    meanErrorTH1=0;
    CalculatePerformance( hist_vec_3000_CT_wO[i], resolutionTH1, resolutionErrorTH1,meanTH1,meanErrorTH1);
    h_3000_CT_wO_DR08_E_RMS90_summary_histogram->SetBinContent(i-firstbin+1,resolutionTH1/sqrt(2.));
    h_3000_CT_wO_DR08_E_RMS90_summary_histogram ->SetBinError(i-firstbin+1, resolutionErrorTH1/sqrt(2.));
    h_3000_CT_wO_DR08_E_RMS_summary_histogram->SetBinContent(i-firstbin+1,hist_vec_3000_CT_wO[i]->GetRMS()*100. );
    h_3000_CT_wO_DR08_E_RMS_summary_histogram ->SetBinError(i-firstbin+1, hist_vec_3000_CT_wO[i]->GetRMSError()*100.);
    h_3000_CT_wO_DR08_E_JER_Mean_summary_histogram->SetBinContent(i-firstbin+1,hist_vec_3000_CT_wO[i]->GetMean());
    h_3000_CT_wO_DR08_E_JER_Mean_summary_histogram->SetBinError(i-firstbin+1,hist_vec_3000_CT_wO[i]->GetMeanError());
    //double sided crystal ball
    TF1* fit_gaus_tmp = new TF1("fit_gaus_tmp", "gaus",0.50,1.50);
    hist_vec_3000_CT_wO[i]->Fit("fit_gaus_tmp","R");
    hist_vec_3000_CT_wO[i]->GetFunction("fit_gaus_tmp");

    TF1* fdscb_tmp = new TF1("fdscb_tmp",fnc_dscb,0.,3.,7);
   fdscb_tmp->SetNpx(1000);
    fdscb_tmp->SetParameter(0,fit_gaus_tmp->GetParameter(0));
    //norm
    fdscb_tmp->SetParLimits (0,0.5*fit_gaus_tmp->GetParameter(0),1.5*fit_gaus_tmp->GetParameter(0));
    fdscb_tmp->SetParameter(1,fit_gaus_tmp->GetParameter(1));
    //gaussian mean
    fdscb_tmp->SetParLimits (1,0.8,1.2);
    //fdscb_tmp->SetParameter(2,fit_gaus_tmp->GetParameter(2));
    //fdscb_tmp->SetParLimits(2,fit_gaus_tmp->GetParameter(2)*0.50,1.50*fit_gaus_tmp->GetParameter(2));
    std::vector<float>sigma2SFit=sigmaGaussianFits2Sigma(hist_vec_3000_CT_wO[i]);
    fdscb_tmp->SetParameter(2,sigma2SFit[0]);
    fdscb_tmp->SetParLimits(2,sigma2SFit[0]*0.50,1.50*sigma2SFit[0]);
    //-a1: parameter, from when the gaussian core should count
    fdscb_tmp->SetParameter(2,fit_gaus_tmp->GetParameter(2));
    fdscb_tmp->SetParameter (3,3.0);
    fdscb_tmp->SetParLimits (3,0.0,10.0);
    //a2 parameter, up to when the gaussian core should count
    fdscb_tmp->SetParameter (5,3.0);
    fdscb_tmp->SetParLimits (5,0.0,10.0);
    fdscb_tmp->SetParameter(4,5.);
    fdscb_tmp->SetParLimits(4,0.,25.);
    fdscb_tmp->SetParameter(6,5.);
    fdscb_tmp->SetParLimits(6,0.,25.);
    int fitstatus(0); 
    fitstatus = hist_vec_3000_CT_wO[i]->Fit(fdscb_tmp,"R");
    fdscb_tmp = hist_vec_3000_CT_wO[i]->GetFunction("fdscb_tmp");
    h_3000_CT_wO_DR08_E_SigmaCB_summary_histogram->SetBinContent(i-firstbin+1,fdscb_tmp->GetParameter(2)*100. );
    h_3000_CT_wO_DR08_E_SigmaCB_summary_histogram->SetBinError(i-firstbin+1,fdscb_tmp->GetParError(2)*100. );
  }  
  TH1F* h_3000_CT_wO_DR09_E_SigmaCB_summary_histogram=new TH1F("JER_SigmaCBVsCosTheta_CT_wO_DR09_3000", "RMS_{90}(E_{j}^{reco}/E_{j}^{gen}) / Mean_{90}(E_{j}^{reco}/E_{j}^{gen}) vs |cos#theta|", nRegionBins, pRegionBinEdges);
  h_3000_CT_wO_DR09_E_SigmaCB_summary_histogram ->SetYTitle("#sigma(E_{j}) / E_{j} [%]");
  h_3000_CT_wO_DR09_E_SigmaCB_summary_histogram->SetXTitle("|cos#theta|");
  h_3000_CT_wO_DR09_E_SigmaCB_summary_histogram->SetLineWidth(2);
  h_3000_CT_wO_DR09_E_SigmaCB_summary_histogram->SetLineColor(kRed);
  h_3000_CT_wO_DR09_E_SigmaCB_summary_histogram->SetLineStyle(2);
  TH1F* h_3000_CT_wO_DR09_E_RMS90_summary_histogram=new TH1F("JER_RMS90VsCosTheta_CT_wO_DR09_3000", "RMS_{90}(E_{j}^{reco}/E_{j}^{gen}) / Mean_{90}(E_{j}^{reco}/E_{j}^{gen}) vs |cos#theta|", nRegionBins, pRegionBinEdges);
  h_3000_CT_wO_DR09_E_RMS90_summary_histogram ->SetYTitle("RMS_{90}(E_{j}^{reco}/E_{j}^{gen}) / Mean_{90}(E_{j}^{reco}/E_{j}^{gen}) [%]");
  h_3000_CT_wO_DR09_E_RMS90_summary_histogram->SetXTitle("|cos#theta|");
  h_3000_CT_wO_DR09_E_RMS90_summary_histogram->SetLineWidth(2);
  h_3000_CT_wO_DR09_E_RMS90_summary_histogram->SetLineColor(kRed);
  h_3000_CT_wO_DR09_E_RMS90_summary_histogram->SetLineStyle(2);

  TH1F* h_3000_CT_wO_DR09_E_RMS_summary_histogram=new TH1F("JER_RMSVsCosTheta_CT_wO_DR09_3000", "RMS(E_{j}) / Mean(E_{j}) vs |cos#theta|", nRegionBins, pRegionBinEdges);
  h_3000_CT_wO_DR09_E_RMS_summary_histogram ->SetYTitle("RMS(E_{j}) / Mean(E_{j}) [%]");
  h_3000_CT_wO_DR09_E_RMS_summary_histogram->SetXTitle("|cos#theta|");
  h_3000_CT_wO_DR09_E_RMS_summary_histogram->SetLineWidth(2);
  h_3000_CT_wO_DR09_E_RMS_summary_histogram->SetLineColor(kRed);
  h_3000_CT_wO_DR09_E_RMS_summary_histogram->SetLineStyle(2);

  TH1F* h_3000_CT_wO_DR09_E_JER_Mean_summary_histogram=new TH1F("JER_MeanVsCosTheta_CT_wO_DR09_3000", "Mean(E_{tot}^{RECO}/E_{tot}^{true}) vs |cos#theta|", nRegionBins, pRegionBinEdges);
  h_3000_CT_wO_DR09_E_JER_Mean_summary_histogram->SetYTitle("Mean(E_{tot}^{RECO}/E_{tot}^{true})");
  h_3000_CT_wO_DR09_E_JER_Mean_summary_histogram->SetXTitle("|cos#theta|");
  h_3000_CT_wO_DR09_E_JER_Mean_summary_histogram->SetLineWidth(2);
  h_3000_CT_wO_DR09_E_JER_Mean_summary_histogram->SetLineColor(kRed);
  h_3000_CT_wO_DR09_E_JER_Mean_summary_histogram->SetLineStyle(2);
  firstbin=111;
  for(int i=firstbin;i<(firstbin+13);i++){
//continue;
    resolutionTH1=0; 
    resolutionErrorTH1=0;
    meanTH1=0;
    meanErrorTH1=0;
    CalculatePerformance( hist_vec_3000_CT_wO[i], resolutionTH1, resolutionErrorTH1,meanTH1,meanErrorTH1);
    h_3000_CT_wO_DR09_E_RMS90_summary_histogram->SetBinContent(i-firstbin+1,resolutionTH1/sqrt(2.));
    h_3000_CT_wO_DR09_E_RMS90_summary_histogram ->SetBinError(i-firstbin+1, resolutionErrorTH1/sqrt(2.));
    h_3000_CT_wO_DR09_E_RMS_summary_histogram->SetBinContent(i-firstbin+1,hist_vec_3000_CT_wO[i]->GetRMS()*100. );
    h_3000_CT_wO_DR09_E_RMS_summary_histogram ->SetBinError(i-firstbin+1, hist_vec_3000_CT_wO[i]->GetRMSError()*100.);
    h_3000_CT_wO_DR09_E_JER_Mean_summary_histogram->SetBinContent(i-firstbin+1,hist_vec_3000_CT_wO[i]->GetMean());
    h_3000_CT_wO_DR09_E_JER_Mean_summary_histogram->SetBinError(i-firstbin+1,hist_vec_3000_CT_wO[i]->GetMeanError());
    //double sided crystal ball
    TF1* fit_gaus_tmp = new TF1("fit_gaus_tmp", "gaus",0.50,1.50);
    hist_vec_3000_CT_wO[i]->Fit("fit_gaus_tmp","R");
    hist_vec_3000_CT_wO[i]->GetFunction("fit_gaus_tmp");

    TF1* fdscb_tmp = new TF1("fdscb_tmp",fnc_dscb,0.,3.,7);
   fdscb_tmp->SetNpx(1000);
    fdscb_tmp->SetParameter(0,fit_gaus_tmp->GetParameter(0));
    //norm
    fdscb_tmp->SetParLimits (0,0.5*fit_gaus_tmp->GetParameter(0),1.5*fit_gaus_tmp->GetParameter(0));
    fdscb_tmp->SetParameter(1,fit_gaus_tmp->GetParameter(1));
    //gaussian mean
    fdscb_tmp->SetParLimits (1,0.8,1.2);
    //fdscb_tmp->SetParameter(2,fit_gaus_tmp->GetParameter(2));
    //fdscb_tmp->SetParLimits(2,fit_gaus_tmp->GetParameter(2)*0.50,1.50*fit_gaus_tmp->GetParameter(2));
    std::vector<float>sigma2SFit=sigmaGaussianFits2Sigma(hist_vec_3000_CT_wO[i]);
    fdscb_tmp->SetParameter(2,sigma2SFit[0]);
    fdscb_tmp->SetParLimits(2,sigma2SFit[0]*0.50,1.50*sigma2SFit[0]);
    //-a1: parameter, from when the gaussian core should count
    fdscb_tmp->SetParameter(2,fit_gaus_tmp->GetParameter(2));
    fdscb_tmp->SetParameter (3,3.0);
    fdscb_tmp->SetParLimits (3,0.0,10.0);
    //a2 parameter, up to when the gaussian core should count
    fdscb_tmp->SetParameter (5,3.0);
    fdscb_tmp->SetParLimits (5,0.0,10.0);
    fdscb_tmp->SetParameter(4,5.);
    fdscb_tmp->SetParLimits(4,0.,25.);
    fdscb_tmp->SetParameter(6,5.);
    fdscb_tmp->SetParLimits(6,0.,25.);
    int fitstatus(0); 
    fitstatus = hist_vec_3000_CT_wO[i]->Fit(fdscb_tmp,"R");
    fdscb_tmp = hist_vec_3000_CT_wO[i]->GetFunction("fdscb_tmp");
    h_3000_CT_wO_DR09_E_SigmaCB_summary_histogram->SetBinContent(i-firstbin+1,fdscb_tmp->GetParameter(2)*100. );
    h_3000_CT_wO_DR09_E_SigmaCB_summary_histogram->SetBinError(i-firstbin+1,fdscb_tmp->GetParError(2)*100. );
  }  
  TH1F* h_3000_CT_wO_DR10_E_SigmaCB_summary_histogram=new TH1F("JER_SigmaCBVsCosTheta_CT_wO_DR10_3000", "RMS_{90}(E_{j}^{reco}/E_{j}^{gen}) / Mean_{90}(E_{j}^{reco}/E_{j}^{gen}) vs |cos#theta|", nRegionBins, pRegionBinEdges);
  h_3000_CT_wO_DR10_E_SigmaCB_summary_histogram ->SetYTitle("#sigma(E_{j}) / E_{j} [%]");
  h_3000_CT_wO_DR10_E_SigmaCB_summary_histogram->SetXTitle("|cos#theta|");
  h_3000_CT_wO_DR10_E_SigmaCB_summary_histogram->SetLineWidth(2);
  h_3000_CT_wO_DR10_E_SigmaCB_summary_histogram->SetLineColor(kRed);
  h_3000_CT_wO_DR10_E_SigmaCB_summary_histogram->SetLineStyle(2);
  TH1F* h_3000_CT_wO_DR10_E_RMS90_summary_histogram=new TH1F("JER_RMS90VsCosTheta_CT_wO_DR10_3000", "RMS_{90}(E_{j}^{reco}/E_{j}^{gen}) / Mean_{90}(E_{j}^{reco}/E_{j}^{gen}) vs |cos#theta|", nRegionBins, pRegionBinEdges);
  h_3000_CT_wO_DR10_E_RMS90_summary_histogram ->SetYTitle("RMS_{90}(E_{j}^{reco}/E_{j}^{gen}) / Mean_{90}(E_{j}^{reco}/E_{j}^{gen}) [%]");
  h_3000_CT_wO_DR10_E_RMS90_summary_histogram->SetXTitle("|cos#theta|");
  h_3000_CT_wO_DR10_E_RMS90_summary_histogram->SetLineWidth(2);
  h_3000_CT_wO_DR10_E_RMS90_summary_histogram->SetLineColor(kRed);
  h_3000_CT_wO_DR10_E_RMS90_summary_histogram->SetLineStyle(2);

  TH1F* h_3000_CT_wO_DR10_E_RMS_summary_histogram=new TH1F("JER_RMSVsCosTheta_CT_wO_DR10_3000", "RMS(E_{j}) / Mean(E_{j}) vs |cos#theta|", nRegionBins, pRegionBinEdges);
  h_3000_CT_wO_DR10_E_RMS_summary_histogram ->SetYTitle("RMS(E_{j}) / Mean(E_{j}) [%]");
  h_3000_CT_wO_DR10_E_RMS_summary_histogram->SetXTitle("|cos#theta|");
  h_3000_CT_wO_DR10_E_RMS_summary_histogram->SetLineWidth(2);
  h_3000_CT_wO_DR10_E_RMS_summary_histogram->SetLineColor(kRed);
  h_3000_CT_wO_DR10_E_RMS_summary_histogram->SetLineStyle(2);

  TH1F* h_3000_CT_wO_DR10_E_JER_Mean_summary_histogram=new TH1F("JER_MeanVsCosTheta_CT_wO_DR10_3000", "Mean(E_{tot}^{RECO}/E_{tot}^{true}) vs |cos#theta|", nRegionBins, pRegionBinEdges);
  h_3000_CT_wO_DR10_E_JER_Mean_summary_histogram->SetYTitle("Mean(E_{tot}^{RECO}/E_{tot}^{true})");
  h_3000_CT_wO_DR10_E_JER_Mean_summary_histogram->SetXTitle("|cos#theta|");
  h_3000_CT_wO_DR10_E_JER_Mean_summary_histogram->SetLineWidth(2);
  h_3000_CT_wO_DR10_E_JER_Mean_summary_histogram->SetLineColor(kRed);
  h_3000_CT_wO_DR10_E_JER_Mean_summary_histogram->SetLineStyle(2);
  firstbin=124;
  for(int i=firstbin;i<(firstbin+13);i++){
    //continue; 
    resolutionTH1=0; 
    resolutionErrorTH1=0;
    meanTH1=0;
    meanErrorTH1=0;
    CalculatePerformance( hist_vec_3000_CT_wO[i], resolutionTH1, resolutionErrorTH1,meanTH1,meanErrorTH1);
    h_3000_CT_wO_DR10_E_RMS90_summary_histogram->SetBinContent(i-firstbin+1,resolutionTH1/sqrt(2.));
    h_3000_CT_wO_DR10_E_RMS90_summary_histogram ->SetBinError(i-firstbin+1, resolutionErrorTH1/sqrt(2.));
    h_3000_CT_wO_DR10_E_RMS_summary_histogram->SetBinContent(i-firstbin+1,hist_vec_3000_CT_wO[i]->GetRMS()*100. );
    h_3000_CT_wO_DR10_E_RMS_summary_histogram ->SetBinError(i-firstbin+1, hist_vec_3000_CT_wO[i]->GetRMSError()*100.);
    h_3000_CT_wO_DR10_E_JER_Mean_summary_histogram->SetBinContent(i-firstbin+1,hist_vec_3000_CT_wO[i]->GetMean());
    h_3000_CT_wO_DR10_E_JER_Mean_summary_histogram->SetBinError(i-firstbin+1,hist_vec_3000_CT_wO[i]->GetMeanError());
    //double sided crystal ball
    TF1* fit_gaus_tmp = new TF1("fit_gaus_tmp", "gaus",0.50,1.50);
    hist_vec_3000_CT_wO[i]->Fit("fit_gaus_tmp","R");
    hist_vec_3000_CT_wO[i]->GetFunction("fit_gaus_tmp");

    TF1* fdscb_tmp = new TF1("fdscb_tmp",fnc_dscb,0.,3.,7);
   fdscb_tmp->SetNpx(1000);
    fdscb_tmp->SetParameter(0,fit_gaus_tmp->GetParameter(0));
    //norm
    fdscb_tmp->SetParLimits (0,0.5*fit_gaus_tmp->GetParameter(0),1.5*fit_gaus_tmp->GetParameter(0));
    fdscb_tmp->SetParameter(1,fit_gaus_tmp->GetParameter(1));
    //gaussian mean
    fdscb_tmp->SetParLimits (1,0.8,1.2);
    //fdscb_tmp->SetParameter(2,fit_gaus_tmp->GetParameter(2));
    //fdscb_tmp->SetParLimits(2,fit_gaus_tmp->GetParameter(2)*0.50,1.50*fit_gaus_tmp->GetParameter(2));
    std::vector<float>sigma2SFit=sigmaGaussianFits2Sigma(hist_vec_3000_CT_wO[i]);
    fdscb_tmp->SetParameter(2,sigma2SFit[0]);
    fdscb_tmp->SetParLimits(2,sigma2SFit[0]*0.50,1.50*sigma2SFit[0]);
    //-a1: parameter, from when the gaussian core should count
    fdscb_tmp->SetParameter(2,fit_gaus_tmp->GetParameter(2));
    fdscb_tmp->SetParameter (3,3.0);
    fdscb_tmp->SetParLimits (3,0.0,10.0);
    //a2 parameter, up to when the gaussian core should count
    fdscb_tmp->SetParameter (5,3.0);
    fdscb_tmp->SetParLimits (5,0.0,10.0);
    fdscb_tmp->SetParameter(4,5.);
    fdscb_tmp->SetParLimits(4,0.,25.);
    fdscb_tmp->SetParameter(6,5.);
    fdscb_tmp->SetParLimits(6,0.,25.);
    int fitstatus(0); 
    fitstatus = hist_vec_3000_CT_wO[i]->Fit(fdscb_tmp,"R");
    fdscb_tmp = hist_vec_3000_CT_wO[i]->GetFunction("fdscb_tmp");
    h_3000_CT_wO_DR10_E_SigmaCB_summary_histogram->SetBinContent(i-firstbin+1,fdscb_tmp->GetParameter(2)*100. );
    h_3000_CT_wO_DR10_E_SigmaCB_summary_histogram->SetBinError(i-firstbin+1,fdscb_tmp->GetParError(2)*100. );
  }  

  std::cout<<"3000 wO 03/04/05/06 "<< calculate_over90(h_3000_CT_wO_recojet03_E1_E2_over_E_True)<<"/"<< calculate_over90(h_3000_CT_wO_recojet04_E1_E2_over_E_True)<<"/"<< calculate_over90(h_3000_CT_wO_recojet05_E1_E2_over_E_True)<<"/"<<calculate_over90(h_3000_CT_wO_recojet06_E1_E2_over_E_True)<<" 07/08/09/10 "<< calculate_over90(h_3000_CT_wO_recojet07_E1_E2_over_E_True)<<"/"<< calculate_over90(h_3000_CT_wO_recojet08_E1_E2_over_E_True)<<"/"<< calculate_over90(h_3000_CT_wO_recojet09_E1_E2_over_E_True)<<"/"<<calculate_over90(h_3000_CT_wO_recojet10_E1_E2_over_E_True)<<std::endl;
  std::cout<<"jet histos 3000 CT_wO filled"<<std::endl;
 
  /*



  TH1F* h_ZZ_250_CT_genjet_E1_plus_E2 =  new TH1F("h_ZZ_250_CT_genjet_E1_plus_E2","", n_binsJER, 50,250);
  TH1F* h_ZZ_250_CT_recojet_E1_plus_E2 =  new TH1F("h_ZZ_250_CT_recojet_E1_plus_E2","", n_binsJER, 50,250);
  TH1F* h_ZZ_250_CT_genjet_M_jj =  new TH1F("h_ZZ_250_CT_genjet_M_jj","", n_binsJER, 20.,200.);
  TH1F* h_ZZ_250_CT_recojet_M_jj =  new TH1F("h_ZZ_250_CT_recojet_M_jj","", n_binsJER, 20.,200.);
  TH1F* h_ZZ_250_CT_M_ZBoson =  new TH1F("h_ZZ_250_CT_parton_M_ZBoson","", 10*n_binsJER, 20.,250.);
  TH1F* h_ZZ_250_CT_M_qq =  new TH1F("h_ZZ_250_CT_parton_M_qq","", 10*n_binsJER, 20.,250.);

  std::vector<TH1F*> hist_vec_ZZ_250_CT;
  hist_vec_ZZ_250_CT.push_back(h_ZZ_250_CT_genjet_E1_plus_E2);
  hist_vec_ZZ_250_CT.push_back(h_ZZ_250_CT_recojet_E1_plus_E2);
  hist_vec_ZZ_250_CT.push_back(h_ZZ_250_CT_genjet_M_jj);
  hist_vec_ZZ_250_CT.push_back(h_ZZ_250_CT_recojet_M_jj);
  hist_vec_ZZ_250_CT.push_back(h_ZZ_250_CT_M_ZBoson);
  hist_vec_ZZ_250_CT.push_back(h_ZZ_250_CT_M_qq);

  for(unsigned int i=0;i<hist_vec_ZZ_250_CT.size();i++){
    hist_vec_ZZ_250_CT[i]->Sumw2();
  }
  fill_mass_histograms(file_CLIC_ZZ_250_CT,hist_vec_ZZ_250_CT);

  TH1F* h_ZZ_250_CT_wO_genjet_E1_plus_E2 =  new TH1F("h_ZZ_250_CT_wO_genjet_E1_plus_E2","", n_binsJER, 50,250);
  TH1F* h_ZZ_250_CT_wO_recojet_E1_plus_E2 =  new TH1F("h_ZZ_250_CT_wO_recojet_E1_plus_E2","", n_binsJER, 50,250);
  TH1F* h_ZZ_250_CT_wO_genjet_M_jj =  new TH1F("h_ZZ_250_CT_wO_genjet_M_jj","", n_binsJER, 20.,200.);
  TH1F* h_ZZ_250_CT_wO_recojet_M_jj =  new TH1F("h_ZZ_250_CT_wO_recojet_M_jj","", n_binsJER, 20.,200.);
  TH1F* h_ZZ_250_CT_wO_M_ZBoson =  new TH1F("h_ZZ_250_CT_wO_parton_M_ZBoson","", 10*n_binsJER, 20.,250.);
  TH1F* h_ZZ_250_CT_wO_M_qq =  new TH1F("h_ZZ_250_CT_wO_parton_M_qq","", 10*n_binsJER, 20.,250.);

  std::vector<TH1F*> hist_vec_ZZ_250_CT_wO;
  hist_vec_ZZ_250_CT_wO.push_back(h_ZZ_250_CT_wO_genjet_E1_plus_E2);
  hist_vec_ZZ_250_CT_wO.push_back(h_ZZ_250_CT_wO_recojet_E1_plus_E2);
  hist_vec_ZZ_250_CT_wO.push_back(h_ZZ_250_CT_wO_genjet_M_jj);
  hist_vec_ZZ_250_CT_wO.push_back(h_ZZ_250_CT_wO_recojet_M_jj);
  hist_vec_ZZ_250_CT_wO.push_back(h_ZZ_250_CT_wO_M_ZBoson);
  hist_vec_ZZ_250_CT_wO.push_back(h_ZZ_250_CT_wO_M_qq);

  for(unsigned int i=0;i<hist_vec_ZZ_250_CT_wO.size();i++){
    hist_vec_ZZ_250_CT_wO[i]->Sumw2();
  }
  fill_mass_histograms(file_CLIC_ZZ_250_CT_wO,hist_vec_ZZ_250_CT_wO);
  std::cout<<"ZZ 250 done"<<std::endl;
 
  TH1F* h_ZZ_500_CT_genjet_E1_plus_E2 =  new TH1F("h_ZZ_500_CT_genjet_E1_plus_E2","", n_binsJER, 50,500);
  TH1F* h_ZZ_500_CT_recojet_E1_plus_E2 =  new TH1F("h_ZZ_500_CT_recojet_E1_plus_E2","", n_binsJER, 50,500);
  TH1F* h_ZZ_500_CT_genjet_M_jj =  new TH1F("h_ZZ_500_CT_genjet_M_jj","", n_binsJER, 20.,200.);
  TH1F* h_ZZ_500_CT_recojet_M_jj =  new TH1F("h_ZZ_500_CT_recojet_M_jj","", n_binsJER, 20.,200.);
  TH1F* h_ZZ_500_CT_M_ZBoson =  new TH1F("h_ZZ_500_CT_parton_M_ZBoson","", 10*n_binsJER, 20.,500.);
  TH1F* h_ZZ_500_CT_M_qq =  new TH1F("h_ZZ_500_CT_parton_M_qq","", 10*n_binsJER, 20.,500.);

  std::vector<TH1F*> hist_vec_ZZ_500_CT;
  hist_vec_ZZ_500_CT.push_back(h_ZZ_500_CT_genjet_E1_plus_E2);
  hist_vec_ZZ_500_CT.push_back(h_ZZ_500_CT_recojet_E1_plus_E2);
  hist_vec_ZZ_500_CT.push_back(h_ZZ_500_CT_genjet_M_jj);
  hist_vec_ZZ_500_CT.push_back(h_ZZ_500_CT_recojet_M_jj);
  hist_vec_ZZ_500_CT.push_back(h_ZZ_500_CT_M_ZBoson);
  hist_vec_ZZ_500_CT.push_back(h_ZZ_500_CT_M_qq);

  for(unsigned int i=0;i<hist_vec_ZZ_500_CT.size();i++){
    hist_vec_ZZ_500_CT[i]->Sumw2();
  }
  fill_mass_histograms(file_CLIC_ZZ_500_CT,hist_vec_ZZ_500_CT);

  TH1F* h_ZZ_500_CT_wO_genjet_E1_plus_E2 =  new TH1F("h_ZZ_500_CT_wO_genjet_E1_plus_E2","", n_binsJER, 50,500);
  TH1F* h_ZZ_500_CT_wO_recojet_E1_plus_E2 =  new TH1F("h_ZZ_500_CT_wO_recojet_E1_plus_E2","", n_binsJER, 50,500);
  TH1F* h_ZZ_500_CT_wO_genjet_M_jj =  new TH1F("h_ZZ_500_CT_wO_genjet_M_jj","", n_binsJER, 20.,200.);
  TH1F* h_ZZ_500_CT_wO_recojet_M_jj =  new TH1F("h_ZZ_500_CT_wO_recojet_M_jj","", n_binsJER, 20.,200.);
  TH1F* h_ZZ_500_CT_wO_M_ZBoson =  new TH1F("h_ZZ_500_CT_wO_parton_M_ZBoson","", 10*n_binsJER, 20.,500.);
  TH1F* h_ZZ_500_CT_wO_M_qq =  new TH1F("h_ZZ_500_CT_wO_parton_M_qq","", 10*n_binsJER, 20.,500.);

  std::vector<TH1F*> hist_vec_ZZ_500_CT_wO;
  hist_vec_ZZ_500_CT_wO.push_back(h_ZZ_500_CT_wO_genjet_E1_plus_E2);
  hist_vec_ZZ_500_CT_wO.push_back(h_ZZ_500_CT_wO_recojet_E1_plus_E2);
  hist_vec_ZZ_500_CT_wO.push_back(h_ZZ_500_CT_wO_genjet_M_jj);
  hist_vec_ZZ_500_CT_wO.push_back(h_ZZ_500_CT_wO_recojet_M_jj);
  hist_vec_ZZ_500_CT_wO.push_back(h_ZZ_500_CT_wO_M_ZBoson);
  hist_vec_ZZ_500_CT_wO.push_back(h_ZZ_500_CT_wO_M_qq);

  for(unsigned int i=0;i<hist_vec_ZZ_500_CT_wO.size();i++){
    hist_vec_ZZ_500_CT_wO[i]->Sumw2();
  }
  fill_mass_histograms(file_CLIC_ZZ_500_CT_wO,hist_vec_ZZ_500_CT_wO);
  std::cout<<"ZZ 500 done"<<std::endl;
 
  TH1F* h_ZZ_1000_CT_genjet_E1_plus_E2 =  new TH1F("h_ZZ_1000_CT_genjet_E1_plus_E2","", n_binsJER, 50,1000);
  TH1F* h_ZZ_1000_CT_recojet_E1_plus_E2 =  new TH1F("h_ZZ_1000_CT_recojet_E1_plus_E2","", n_binsJER, 50,1000);
  TH1F* h_ZZ_1000_CT_genjet_M_jj =  new TH1F("h_ZZ_1000_CT_genjet_M_jj","", n_binsJER, 20.,200.);
  TH1F* h_ZZ_1000_CT_recojet_M_jj =  new TH1F("h_ZZ_1000_CT_recojet_M_jj","", n_binsJER, 20.,200.);
  TH1F* h_ZZ_1000_CT_M_ZBoson =  new TH1F("h_ZZ_1000_CT_parton_M_ZBoson","", 10*n_binsJER, 20.,1000.);
  TH1F* h_ZZ_1000_CT_M_qq =  new TH1F("h_ZZ_1000_CT_parton_M_qq","", 10*n_binsJER, 20.,1000.);

  std::vector<TH1F*> hist_vec_ZZ_1000_CT;
  hist_vec_ZZ_1000_CT.push_back(h_ZZ_1000_CT_genjet_E1_plus_E2);
  hist_vec_ZZ_1000_CT.push_back(h_ZZ_1000_CT_recojet_E1_plus_E2);
  hist_vec_ZZ_1000_CT.push_back(h_ZZ_1000_CT_genjet_M_jj);
  hist_vec_ZZ_1000_CT.push_back(h_ZZ_1000_CT_recojet_M_jj);
  hist_vec_ZZ_1000_CT.push_back(h_ZZ_1000_CT_M_ZBoson);
  hist_vec_ZZ_1000_CT.push_back(h_ZZ_1000_CT_M_qq);

  for(unsigned int i=0;i<hist_vec_ZZ_1000_CT.size();i++){
    hist_vec_ZZ_1000_CT[i]->Sumw2();
  }
  fill_mass_histograms(file_CLIC_ZZ_1000_CT,hist_vec_ZZ_1000_CT);

  TH1F* h_ZZ_1000_CT_wO_genjet_E1_plus_E2 =  new TH1F("h_ZZ_1000_CT_wO_genjet_E1_plus_E2","", n_binsJER, 50,1000);
  TH1F* h_ZZ_1000_CT_wO_recojet_E1_plus_E2 =  new TH1F("h_ZZ_1000_CT_wO_recojet_E1_plus_E2","", n_binsJER, 50,1000);
  TH1F* h_ZZ_1000_CT_wO_genjet_M_jj =  new TH1F("h_ZZ_1000_CT_wO_genjet_M_jj","", n_binsJER, 20.,200.);
  TH1F* h_ZZ_1000_CT_wO_recojet_M_jj =  new TH1F("h_ZZ_1000_CT_wO_recojet_M_jj","", n_binsJER, 20.,200.);
  TH1F* h_ZZ_1000_CT_wO_M_ZBoson =  new TH1F("h_ZZ_1000_CT_wO_parton_M_ZBoson","", 10*n_binsJER, 20.,1000.);
  TH1F* h_ZZ_1000_CT_wO_M_qq =  new TH1F("h_ZZ_1000_CT_wO_parton_M_qq","", 10*n_binsJER, 20.,1000.);

  std::vector<TH1F*> hist_vec_ZZ_1000_CT_wO;
  hist_vec_ZZ_1000_CT_wO.push_back(h_ZZ_1000_CT_wO_genjet_E1_plus_E2);
  hist_vec_ZZ_1000_CT_wO.push_back(h_ZZ_1000_CT_wO_recojet_E1_plus_E2);
  hist_vec_ZZ_1000_CT_wO.push_back(h_ZZ_1000_CT_wO_genjet_M_jj);
  hist_vec_ZZ_1000_CT_wO.push_back(h_ZZ_1000_CT_wO_recojet_M_jj);
  hist_vec_ZZ_1000_CT_wO.push_back(h_ZZ_1000_CT_wO_M_ZBoson);
  hist_vec_ZZ_1000_CT_wO.push_back(h_ZZ_1000_CT_wO_M_qq);

  for(unsigned int i=0;i<hist_vec_ZZ_1000_CT_wO.size();i++){
    hist_vec_ZZ_1000_CT_wO[i]->Sumw2();
  }
  fill_mass_histograms(file_CLIC_ZZ_1000_CT_wO,hist_vec_ZZ_1000_CT_wO);
  std::cout<<"ZZ 1000 done"<<std::endl;
 
  TH1F* h_ZZ_2000_CT_genjet_E1_plus_E2 =  new TH1F("h_ZZ_2000_CT_genjet_E1_plus_E2","", n_binsJER, 50,2000);
  TH1F* h_ZZ_2000_CT_recojet_E1_plus_E2 =  new TH1F("h_ZZ_2000_CT_recojet_E1_plus_E2","", n_binsJER, 50,2000);
  TH1F* h_ZZ_2000_CT_genjet_M_jj =  new TH1F("h_ZZ_2000_CT_genjet_M_jj","", n_binsJER, 20.,200.);
  TH1F* h_ZZ_2000_CT_recojet_M_jj =  new TH1F("h_ZZ_2000_CT_recojet_M_jj","", n_binsJER, 20.,200.);
  TH1F* h_ZZ_2000_CT_M_ZBoson =  new TH1F("h_ZZ_2000_CT_parton_M_ZBoson","", 10*n_binsJER, 20.,2000.);
  TH1F* h_ZZ_2000_CT_M_qq =  new TH1F("h_ZZ_2000_CT_parton_M_qq","", 10*n_binsJER, 20.,2000.);

  std::vector<TH1F*> hist_vec_ZZ_2000_CT;
  hist_vec_ZZ_2000_CT.push_back(h_ZZ_2000_CT_genjet_E1_plus_E2);
  hist_vec_ZZ_2000_CT.push_back(h_ZZ_2000_CT_recojet_E1_plus_E2);
  hist_vec_ZZ_2000_CT.push_back(h_ZZ_2000_CT_genjet_M_jj);
  hist_vec_ZZ_2000_CT.push_back(h_ZZ_2000_CT_recojet_M_jj);
  hist_vec_ZZ_2000_CT.push_back(h_ZZ_2000_CT_M_ZBoson);
  hist_vec_ZZ_2000_CT.push_back(h_ZZ_2000_CT_M_qq);

  for(unsigned int i=0;i<hist_vec_ZZ_2000_CT.size();i++){
    hist_vec_ZZ_2000_CT[i]->Sumw2();
  }
  fill_mass_histograms(file_CLIC_ZZ_2000_CT,hist_vec_ZZ_2000_CT);

  TH1F* h_ZZ_2000_CT_wO_genjet_E1_plus_E2 =  new TH1F("h_ZZ_2000_CT_wO_genjet_E1_plus_E2","", n_binsJER, 50,2000);
  TH1F* h_ZZ_2000_CT_wO_recojet_E1_plus_E2 =  new TH1F("h_ZZ_2000_CT_wO_recojet_E1_plus_E2","", n_binsJER, 50,2000);
  TH1F* h_ZZ_2000_CT_wO_genjet_M_jj =  new TH1F("h_ZZ_2000_CT_wO_genjet_M_jj","", n_binsJER, 20.,200.);
  TH1F* h_ZZ_2000_CT_wO_recojet_M_jj =  new TH1F("h_ZZ_2000_CT_wO_recojet_M_jj","", n_binsJER, 20.,200.);
 TH1F* h_ZZ_2000_CT_wO_M_ZBoson =  new TH1F("h_ZZ_2000_CT_wO_parton_M_ZBoson","", 10*n_binsJER, 20.,2000.);
  TH1F* h_ZZ_2000_CT_wO_M_qq =  new TH1F("h_ZZ_2000_CT_wO_parton_M_qq","", 10*n_binsJER, 20.,2000.);

  std::vector<TH1F*> hist_vec_ZZ_2000_CT_wO;
  hist_vec_ZZ_2000_CT_wO.push_back(h_ZZ_2000_CT_wO_genjet_E1_plus_E2);
  hist_vec_ZZ_2000_CT_wO.push_back(h_ZZ_2000_CT_wO_recojet_E1_plus_E2);
  hist_vec_ZZ_2000_CT_wO.push_back(h_ZZ_2000_CT_wO_genjet_M_jj);
  hist_vec_ZZ_2000_CT_wO.push_back(h_ZZ_2000_CT_wO_recojet_M_jj);
  hist_vec_ZZ_2000_CT_wO.push_back(h_ZZ_2000_CT_wO_M_ZBoson);
  hist_vec_ZZ_2000_CT_wO.push_back(h_ZZ_2000_CT_wO_M_qq);

  for(unsigned int i=0;i<hist_vec_ZZ_2000_CT_wO.size();i++){
    hist_vec_ZZ_2000_CT_wO[i]->Sumw2();
  }
  fill_mass_histograms(file_CLIC_ZZ_2000_CT_wO,hist_vec_ZZ_2000_CT_wO);
  std::cout<<"ZZ 2000 done"<<std::endl;
  TH1F* h_WW_250_CT_genjet_E1_plus_E2 =  new TH1F("h_WW_250_CT_genjet_E1_plus_E2","", n_binsJER, 50,2250);
  TH1F* h_WW_250_CT_recojet_E1_plus_E2 =  new TH1F("h_WW_250_CT_recojet_E1_plus_E2","", n_binsJER, 50,2250);
  TH1F* h_WW_250_CT_genjet_M_jj =  new TH1F("h_WW_250_CT_genjet_M_jj","", n_binsJER, 20.,200.);
  TH1F* h_WW_250_CT_recojet_M_jj =  new TH1F("h_WW_250_CT_recojet_M_jj","", n_binsJER, 20.,200.);
  TH1F* h_WW_250_CT_M_WBoson =  new TH1F("h_WW_250_CT_parton_M_WBoson","", 10*n_binsJER, 20.,250.);
  TH1F* h_WW_250_CT_M_qq =  new TH1F("h_WW_250_CT_parton_M_qq","", 10*n_binsJER, 20.,250.);

  std::vector<TH1F*> hist_vec_WW_250_CT;
  hist_vec_WW_250_CT.push_back(h_WW_250_CT_genjet_E1_plus_E2);
  hist_vec_WW_250_CT.push_back(h_WW_250_CT_recojet_E1_plus_E2);
  hist_vec_WW_250_CT.push_back(h_WW_250_CT_genjet_M_jj);
  hist_vec_WW_250_CT.push_back(h_WW_250_CT_recojet_M_jj);
  hist_vec_WW_250_CT.push_back(h_WW_250_CT_M_WBoson);
  hist_vec_WW_250_CT.push_back(h_WW_250_CT_M_qq);

  for(unsigned int i=0;i<hist_vec_WW_250_CT.size();i++){
    hist_vec_WW_250_CT[i]->Sumw2();
  }
  fill_mass_histograms(file_CLIC_WW_250_CT,hist_vec_WW_250_CT);

  TH1F* h_WW_250_CT_wO_genjet_E1_plus_E2 =  new TH1F("h_WW_250_CT_wO_genjet_E1_plus_E2","", n_binsJER, 50,2250);
  TH1F* h_WW_250_CT_wO_recojet_E1_plus_E2 =  new TH1F("h_WW_250_CT_wO_recojet_E1_plus_E2","", n_binsJER, 50,2250);
  TH1F* h_WW_250_CT_wO_genjet_M_jj =  new TH1F("h_WW_250_CT_wO_genjet_M_jj","", n_binsJER, 20.,200.);
  TH1F* h_WW_250_CT_wO_recojet_M_jj =  new TH1F("h_WW_250_CT_wO_recojet_M_jj","", n_binsJER, 20.,200.);
  TH1F* h_WW_250_CT_wO_M_WBoson =  new TH1F("h_WW_250_CT_wO_parton_M_WBoson","", 10*n_binsJER, 20.,250.);
  TH1F* h_WW_250_CT_wO_M_qq =  new TH1F("h_WW_250_CT_wO_parton_M_qq","", 10*n_binsJER, 20.,250.);

  std::vector<TH1F*> hist_vec_WW_250_CT_wO;
  hist_vec_WW_250_CT_wO.push_back(h_WW_250_CT_wO_genjet_E1_plus_E2);
  hist_vec_WW_250_CT_wO.push_back(h_WW_250_CT_wO_recojet_E1_plus_E2);
  hist_vec_WW_250_CT_wO.push_back(h_WW_250_CT_wO_genjet_M_jj);
  hist_vec_WW_250_CT_wO.push_back(h_WW_250_CT_wO_recojet_M_jj);
  hist_vec_WW_250_CT_wO.push_back(h_WW_250_CT_wO_M_WBoson);
  hist_vec_WW_250_CT_wO.push_back(h_WW_250_CT_wO_M_qq);

  for(unsigned int i=0;i<hist_vec_WW_250_CT_wO.size();i++){
    hist_vec_WW_250_CT_wO[i]->Sumw2();
  }
  fill_mass_histograms(file_CLIC_WW_250_CT_wO,hist_vec_WW_250_CT_wO);

  TH1F* h_WW_250_CT_wO_Loose_genjet_E1_plus_E2 =  new TH1F("h_WW_250_CT_wO_Loose_genjet_E1_plus_E2","", n_binsJER, 50,2250);
  TH1F* h_WW_250_CT_wO_Loose_recojet_E1_plus_E2 =  new TH1F("h_WW_250_CT_wO_Loose_recojet_E1_plus_E2","", n_binsJER, 50,2250);
  TH1F* h_WW_250_CT_wO_Loose_genjet_M_jj =  new TH1F("h_WW_250_CT_wO_Loose_genjet_M_jj","", n_binsJER, 20.,200.);
  TH1F* h_WW_250_CT_wO_Loose_recojet_M_jj =  new TH1F("h_WW_250_CT_wO_Loose_recojet_M_jj","", n_binsJER, 20.,200.);
  TH1F* h_WW_250_CT_wO_Loose_M_WBoson =  new TH1F("h_WW_250_CT_wO_Loose_parton_M_WBoson","", 10*n_binsJER, 20.,250.);
  TH1F* h_WW_250_CT_wO_Loose_M_qq =  new TH1F("h_WW_250_CT_wO_Loose_parton_M_qq","", 10*n_binsJER, 20.,250.);

  std::vector<TH1F*> hist_vec_WW_250_CT_wO_Loose;
  hist_vec_WW_250_CT_wO_Loose.push_back(h_WW_250_CT_wO_Loose_genjet_E1_plus_E2);
  hist_vec_WW_250_CT_wO_Loose.push_back(h_WW_250_CT_wO_Loose_recojet_E1_plus_E2);
  hist_vec_WW_250_CT_wO_Loose.push_back(h_WW_250_CT_wO_Loose_genjet_M_jj);
  hist_vec_WW_250_CT_wO_Loose.push_back(h_WW_250_CT_wO_Loose_recojet_M_jj);
  hist_vec_WW_250_CT_wO_Loose.push_back(h_WW_250_CT_wO_Loose_M_WBoson);
  hist_vec_WW_250_CT_wO_Loose.push_back(h_WW_250_CT_wO_Loose_M_qq);

  for(unsigned int i=0;i<hist_vec_WW_250_CT_wO_Loose.size();i++){
    hist_vec_WW_250_CT_wO_Loose[i]->Sumw2();
  }
  fill_mass_histograms(file_CLIC_WW_250_CT_wO_Loose,hist_vec_WW_250_CT_wO_Loose);

  TH1F* h_WW_250_CT_wO_Selected_genjet_E1_plus_E2 =  new TH1F("h_WW_250_CT_wO_Selected_genjet_E1_plus_E2","", n_binsJER, 50,2250);
  TH1F* h_WW_250_CT_wO_Selected_recojet_E1_plus_E2 =  new TH1F("h_WW_250_CT_wO_Selected_recojet_E1_plus_E2","", n_binsJER, 50,2250);
  TH1F* h_WW_250_CT_wO_Selected_genjet_M_jj =  new TH1F("h_WW_250_CT_wO_Selected_genjet_M_jj","", n_binsJER, 20.,200.);
  TH1F* h_WW_250_CT_wO_Selected_recojet_M_jj =  new TH1F("h_WW_250_CT_wO_Selected_recojet_M_jj","", n_binsJER, 20.,200.);
  TH1F* h_WW_250_CT_wO_Selected_M_WBoson =  new TH1F("h_WW_250_CT_wO_Selected_parton_M_WBoson","", 10*n_binsJER, 20.,250.);
  TH1F* h_WW_250_CT_wO_Selected_M_qq =  new TH1F("h_WW_250_CT_wO_Selected_parton_M_qq","", 10*n_binsJER, 20.,250.);

  std::vector<TH1F*> hist_vec_WW_250_CT_wO_Selected;
  hist_vec_WW_250_CT_wO_Selected.push_back(h_WW_250_CT_wO_Selected_genjet_E1_plus_E2);
  hist_vec_WW_250_CT_wO_Selected.push_back(h_WW_250_CT_wO_Selected_recojet_E1_plus_E2);
  hist_vec_WW_250_CT_wO_Selected.push_back(h_WW_250_CT_wO_Selected_genjet_M_jj);
  hist_vec_WW_250_CT_wO_Selected.push_back(h_WW_250_CT_wO_Selected_recojet_M_jj);
  hist_vec_WW_250_CT_wO_Selected.push_back(h_WW_250_CT_wO_Selected_M_WBoson);
  hist_vec_WW_250_CT_wO_Selected.push_back(h_WW_250_CT_wO_Selected_M_qq);

  for(unsigned int i=0;i<hist_vec_WW_250_CT_wO_Selected.size();i++){
    hist_vec_WW_250_CT_wO_Selected[i]->Sumw2();
  }
  fill_mass_histograms(file_CLIC_WW_250_CT_wO_Selected,hist_vec_WW_250_CT_wO_Selected);

  TH1F* h_WW_250_CT_wO_allPFOs_genjet_E1_plus_E2 =  new TH1F("h_WW_250_CT_wO_allPFOs_genjet_E1_plus_E2","", n_binsJER, 50,2250);
  TH1F* h_WW_250_CT_wO_allPFOs_recojet_E1_plus_E2 =  new TH1F("h_WW_250_CT_wO_allPFOs_recojet_E1_plus_E2","", n_binsJER, 50,2250);
  TH1F* h_WW_250_CT_wO_allPFOs_genjet_M_jj =  new TH1F("h_WW_250_CT_wO_allPFOs_genjet_M_jj","", n_binsJER, 20.,200.);
  TH1F* h_WW_250_CT_wO_allPFOs_recojet_M_jj =  new TH1F("h_WW_250_CT_wO_allPFOs_recojet_M_jj","", n_binsJER, 20.,200.);
  TH1F* h_WW_250_CT_wO_allPFOs_M_WBoson =  new TH1F("h_WW_250_CT_wO_allPFOs_parton_M_WBoson","", 10*n_binsJER, 20.,250.);
  TH1F* h_WW_250_CT_wO_allPFOs_M_qq =  new TH1F("h_WW_250_CT_wO_allPFOs_parton_M_qq","", 10*n_binsJER, 20.,250.);

  std::vector<TH1F*> hist_vec_WW_250_CT_wO_allPFOs;
  hist_vec_WW_250_CT_wO_allPFOs.push_back(h_WW_250_CT_wO_allPFOs_genjet_E1_plus_E2);
  hist_vec_WW_250_CT_wO_allPFOs.push_back(h_WW_250_CT_wO_allPFOs_recojet_E1_plus_E2);
  hist_vec_WW_250_CT_wO_allPFOs.push_back(h_WW_250_CT_wO_allPFOs_genjet_M_jj);
  hist_vec_WW_250_CT_wO_allPFOs.push_back(h_WW_250_CT_wO_allPFOs_recojet_M_jj);
  hist_vec_WW_250_CT_wO_allPFOs.push_back(h_WW_250_CT_wO_allPFOs_M_WBoson);
  hist_vec_WW_250_CT_wO_allPFOs.push_back(h_WW_250_CT_wO_allPFOs_M_qq);

  for(unsigned int i=0;i<hist_vec_WW_250_CT_wO_allPFOs.size();i++){
    hist_vec_WW_250_CT_wO_allPFOs[i]->Sumw2();
  }
  fill_mass_histograms(file_CLIC_WW_250_CT_wO_allPFOs,hist_vec_WW_250_CT_wO_allPFOs);
  std::cout<<"WW_250 done"<<std::endl;
  TH1F* h_WW_500_CT_genjet_E1_plus_E2 =  new TH1F("h_WW_500_CT_genjet_E1_plus_E2","", n_binsJER, 50,2250);
  TH1F* h_WW_500_CT_recojet_E1_plus_E2 =  new TH1F("h_WW_500_CT_recojet_E1_plus_E2","", n_binsJER, 50,2250);
  TH1F* h_WW_500_CT_genjet_M_jj =  new TH1F("h_WW_500_CT_genjet_M_jj","", n_binsJER, 20.,200.);
  TH1F* h_WW_500_CT_recojet_M_jj =  new TH1F("h_WW_500_CT_recojet_M_jj","", n_binsJER, 20.,200.);
  TH1F* h_WW_500_CT_M_WBoson =  new TH1F("h_WW_500_CT_parton_M_WBoson","", 10*n_binsJER, 20.,500.);
  TH1F* h_WW_500_CT_M_qq =  new TH1F("h_WW_500_CT_parton_M_qq","", 10*n_binsJER, 20.,500.);

  std::vector<TH1F*> hist_vec_WW_500_CT;
  hist_vec_WW_500_CT.push_back(h_WW_500_CT_genjet_E1_plus_E2);
  hist_vec_WW_500_CT.push_back(h_WW_500_CT_recojet_E1_plus_E2);
  hist_vec_WW_500_CT.push_back(h_WW_500_CT_genjet_M_jj);
  hist_vec_WW_500_CT.push_back(h_WW_500_CT_recojet_M_jj);
  hist_vec_WW_500_CT.push_back(h_WW_500_CT_M_WBoson);
  hist_vec_WW_500_CT.push_back(h_WW_500_CT_M_qq);

  for(unsigned int i=0;i<hist_vec_WW_500_CT.size();i++){
    hist_vec_WW_500_CT[i]->Sumw2();
  }
  fill_mass_histograms(file_CLIC_WW_500_CT,hist_vec_WW_500_CT);

  TH1F* h_WW_500_CT_wO_genjet_E1_plus_E2 =  new TH1F("h_WW_500_CT_wO_genjet_E1_plus_E2","", n_binsJER, 50,2250);
  TH1F* h_WW_500_CT_wO_recojet_E1_plus_E2 =  new TH1F("h_WW_500_CT_wO_recojet_E1_plus_E2","", n_binsJER, 50,2250);
  TH1F* h_WW_500_CT_wO_genjet_M_jj =  new TH1F("h_WW_500_CT_wO_genjet_M_jj","", n_binsJER, 20.,200.);
  TH1F* h_WW_500_CT_wO_recojet_M_jj =  new TH1F("h_WW_500_CT_wO_recojet_M_jj","", n_binsJER, 20.,200.);
  TH1F* h_WW_500_CT_wO_M_WBoson =  new TH1F("h_WW_500_CT_wO_parton_M_WBoson","", 10*n_binsJER, 20.,500.);
  TH1F* h_WW_500_CT_wO_M_qq =  new TH1F("h_WW_500_CT_wO_parton_M_qq","", 10*n_binsJER, 20.,500.);

  std::vector<TH1F*> hist_vec_WW_500_CT_wO;
  hist_vec_WW_500_CT_wO.push_back(h_WW_500_CT_wO_genjet_E1_plus_E2);
  hist_vec_WW_500_CT_wO.push_back(h_WW_500_CT_wO_recojet_E1_plus_E2);
  hist_vec_WW_500_CT_wO.push_back(h_WW_500_CT_wO_genjet_M_jj);
  hist_vec_WW_500_CT_wO.push_back(h_WW_500_CT_wO_recojet_M_jj);
  hist_vec_WW_500_CT_wO.push_back(h_WW_500_CT_wO_M_WBoson);
  hist_vec_WW_500_CT_wO.push_back(h_WW_500_CT_wO_M_qq);

  for(unsigned int i=0;i<hist_vec_WW_500_CT_wO.size();i++){
    hist_vec_WW_500_CT_wO[i]->Sumw2();
  }
  fill_mass_histograms(file_CLIC_WW_500_CT_wO,hist_vec_WW_500_CT_wO);

  TH1F* h_WW_500_CT_wO_Loose_genjet_E1_plus_E2 =  new TH1F("h_WW_500_CT_wO_Loose_genjet_E1_plus_E2","", n_binsJER, 50,2250);
  TH1F* h_WW_500_CT_wO_Loose_recojet_E1_plus_E2 =  new TH1F("h_WW_500_CT_wO_Loose_recojet_E1_plus_E2","", n_binsJER, 50,2250);
  TH1F* h_WW_500_CT_wO_Loose_genjet_M_jj =  new TH1F("h_WW_500_CT_wO_Loose_genjet_M_jj","", n_binsJER, 20.,200.);
  TH1F* h_WW_500_CT_wO_Loose_recojet_M_jj =  new TH1F("h_WW_500_CT_wO_Loose_recojet_M_jj","", n_binsJER, 20.,200.);
  TH1F* h_WW_500_CT_wO_Loose_M_WBoson =  new TH1F("h_WW_500_CT_wO_Loose_parton_M_WBoson","", 10*n_binsJER, 20.,500.);
  TH1F* h_WW_500_CT_wO_Loose_M_qq =  new TH1F("h_WW_500_CT_wO_Loose_parton_M_qq","", 10*n_binsJER, 20.,500.);

  std::vector<TH1F*> hist_vec_WW_500_CT_wO_Loose;
  hist_vec_WW_500_CT_wO_Loose.push_back(h_WW_500_CT_wO_Loose_genjet_E1_plus_E2);
  hist_vec_WW_500_CT_wO_Loose.push_back(h_WW_500_CT_wO_Loose_recojet_E1_plus_E2);
  hist_vec_WW_500_CT_wO_Loose.push_back(h_WW_500_CT_wO_Loose_genjet_M_jj);
  hist_vec_WW_500_CT_wO_Loose.push_back(h_WW_500_CT_wO_Loose_recojet_M_jj);
  hist_vec_WW_500_CT_wO_Loose.push_back(h_WW_500_CT_wO_Loose_M_WBoson);
  hist_vec_WW_500_CT_wO_Loose.push_back(h_WW_500_CT_wO_Loose_M_qq);

  for(unsigned int i=0;i<hist_vec_WW_500_CT_wO_Loose.size();i++){
    hist_vec_WW_500_CT_wO_Loose[i]->Sumw2();
  }
  fill_mass_histograms(file_CLIC_WW_500_CT_wO_Loose,hist_vec_WW_500_CT_wO_Loose);

  TH1F* h_WW_500_CT_wO_Selected_genjet_E1_plus_E2 =  new TH1F("h_WW_500_CT_wO_Selected_genjet_E1_plus_E2","", n_binsJER, 50,2250);
  TH1F* h_WW_500_CT_wO_Selected_recojet_E1_plus_E2 =  new TH1F("h_WW_500_CT_wO_Selected_recojet_E1_plus_E2","", n_binsJER, 50,2250);
  TH1F* h_WW_500_CT_wO_Selected_genjet_M_jj =  new TH1F("h_WW_500_CT_wO_Selected_genjet_M_jj","", n_binsJER, 20.,200.);
  TH1F* h_WW_500_CT_wO_Selected_recojet_M_jj =  new TH1F("h_WW_500_CT_wO_Selected_recojet_M_jj","", n_binsJER, 20.,200.);
  TH1F* h_WW_500_CT_wO_Selected_M_WBoson =  new TH1F("h_WW_500_CT_wO_Selected_parton_M_WBoson","", 10*n_binsJER, 20.,500.);
  TH1F* h_WW_500_CT_wO_Selected_M_qq =  new TH1F("h_WW_500_CT_wO_Selected_parton_M_qq","", 10*n_binsJER, 20.,500.);

  std::vector<TH1F*> hist_vec_WW_500_CT_wO_Selected;
  hist_vec_WW_500_CT_wO_Selected.push_back(h_WW_500_CT_wO_Selected_genjet_E1_plus_E2);
  hist_vec_WW_500_CT_wO_Selected.push_back(h_WW_500_CT_wO_Selected_recojet_E1_plus_E2);
  hist_vec_WW_500_CT_wO_Selected.push_back(h_WW_500_CT_wO_Selected_genjet_M_jj);
  hist_vec_WW_500_CT_wO_Selected.push_back(h_WW_500_CT_wO_Selected_recojet_M_jj);
  hist_vec_WW_500_CT_wO_Selected.push_back(h_WW_500_CT_wO_Selected_M_WBoson);
  hist_vec_WW_500_CT_wO_Selected.push_back(h_WW_500_CT_wO_Selected_M_qq);

  for(unsigned int i=0;i<hist_vec_WW_500_CT_wO_Selected.size();i++){
    hist_vec_WW_500_CT_wO_Selected[i]->Sumw2();
  }
  fill_mass_histograms(file_CLIC_WW_500_CT_wO_Selected,hist_vec_WW_500_CT_wO_Selected);

  TH1F* h_WW_500_CT_wO_allPFOs_genjet_E1_plus_E2 =  new TH1F("h_WW_500_CT_wO_allPFOs_genjet_E1_plus_E2","", n_binsJER, 50,2250);
  TH1F* h_WW_500_CT_wO_allPFOs_recojet_E1_plus_E2 =  new TH1F("h_WW_500_CT_wO_allPFOs_recojet_E1_plus_E2","", n_binsJER, 50,2250);
  TH1F* h_WW_500_CT_wO_allPFOs_genjet_M_jj =  new TH1F("h_WW_500_CT_wO_allPFOs_genjet_M_jj","", n_binsJER, 20.,200.);
  TH1F* h_WW_500_CT_wO_allPFOs_recojet_M_jj =  new TH1F("h_WW_500_CT_wO_allPFOs_recojet_M_jj","", n_binsJER, 20.,200.);
  TH1F* h_WW_500_CT_wO_allPFOs_M_WBoson =  new TH1F("h_WW_500_CT_wO_allPFOs_parton_M_WBoson","", 10*n_binsJER, 20.,500.);
  TH1F* h_WW_500_CT_wO_allPFOs_M_qq =  new TH1F("h_WW_500_CT_wO_allPFOs_parton_M_qq","", 10*n_binsJER, 20.,500.);

  std::vector<TH1F*> hist_vec_WW_500_CT_wO_allPFOs;
  hist_vec_WW_500_CT_wO_allPFOs.push_back(h_WW_500_CT_wO_allPFOs_genjet_E1_plus_E2);
  hist_vec_WW_500_CT_wO_allPFOs.push_back(h_WW_500_CT_wO_allPFOs_recojet_E1_plus_E2);
  hist_vec_WW_500_CT_wO_allPFOs.push_back(h_WW_500_CT_wO_allPFOs_genjet_M_jj);
  hist_vec_WW_500_CT_wO_allPFOs.push_back(h_WW_500_CT_wO_allPFOs_recojet_M_jj);
  hist_vec_WW_500_CT_wO_allPFOs.push_back(h_WW_500_CT_wO_allPFOs_M_WBoson);
  hist_vec_WW_500_CT_wO_allPFOs.push_back(h_WW_500_CT_wO_allPFOs_M_qq);

  for(unsigned int i=0;i<hist_vec_WW_500_CT_wO_allPFOs.size();i++){
    hist_vec_WW_500_CT_wO_allPFOs[i]->Sumw2();
  }
  fill_mass_histograms(file_CLIC_WW_500_CT_wO_allPFOs,hist_vec_WW_500_CT_wO_allPFOs);
  std::cout<<"WW_500 done"<<std::endl;
  TH1F* h_WW_1000_CT_genjet_E1_plus_E2 =  new TH1F("h_WW_1000_CT_genjet_E1_plus_E2","", n_binsJER, 50,2250);
  TH1F* h_WW_1000_CT_recojet_E1_plus_E2 =  new TH1F("h_WW_1000_CT_recojet_E1_plus_E2","", n_binsJER, 50,2250);
  TH1F* h_WW_1000_CT_genjet_M_jj =  new TH1F("h_WW_1000_CT_genjet_M_jj","", n_binsJER, 20.,200.);
  TH1F* h_WW_1000_CT_recojet_M_jj =  new TH1F("h_WW_1000_CT_recojet_M_jj","", n_binsJER, 20.,200.);
  TH1F* h_WW_1000_CT_M_WBoson =  new TH1F("h_WW_1000_CT_parton_M_WBoson","", 10*n_binsJER, 20.,1000.);
  TH1F* h_WW_1000_CT_M_qq =  new TH1F("h_WW_1000_CT_parton_M_qq","", 10*n_binsJER, 20.,1000.);

  std::vector<TH1F*> hist_vec_WW_1000_CT;
  hist_vec_WW_1000_CT.push_back(h_WW_1000_CT_genjet_E1_plus_E2);
  hist_vec_WW_1000_CT.push_back(h_WW_1000_CT_recojet_E1_plus_E2);
  hist_vec_WW_1000_CT.push_back(h_WW_1000_CT_genjet_M_jj);
  hist_vec_WW_1000_CT.push_back(h_WW_1000_CT_recojet_M_jj);
  hist_vec_WW_1000_CT.push_back(h_WW_1000_CT_M_WBoson);
  hist_vec_WW_1000_CT.push_back(h_WW_1000_CT_M_qq);

  for(unsigned int i=0;i<hist_vec_WW_1000_CT.size();i++){
    hist_vec_WW_1000_CT[i]->Sumw2();
  }
  fill_mass_histograms(file_CLIC_WW_1000_CT,hist_vec_WW_1000_CT);

  TH1F* h_WW_1000_CT_wO_genjet_E1_plus_E2 =  new TH1F("h_WW_1000_CT_wO_genjet_E1_plus_E2","", n_binsJER, 50,2250);
  TH1F* h_WW_1000_CT_wO_recojet_E1_plus_E2 =  new TH1F("h_WW_1000_CT_wO_recojet_E1_plus_E2","", n_binsJER, 50,2250);
  TH1F* h_WW_1000_CT_wO_genjet_M_jj =  new TH1F("h_WW_1000_CT_wO_genjet_M_jj","", n_binsJER, 20.,200.);
  TH1F* h_WW_1000_CT_wO_recojet_M_jj =  new TH1F("h_WW_1000_CT_wO_recojet_M_jj","", n_binsJER, 20.,200.);
  TH1F* h_WW_1000_CT_wO_M_WBoson =  new TH1F("h_WW_1000_CT_wO_parton_M_WBoson","", 10*n_binsJER, 20.,1000.);
  TH1F* h_WW_1000_CT_wO_M_qq =  new TH1F("h_WW_1000_CT_wO_parton_M_qq","", 10*n_binsJER, 20.,1000.);

  std::vector<TH1F*> hist_vec_WW_1000_CT_wO;
  hist_vec_WW_1000_CT_wO.push_back(h_WW_1000_CT_wO_genjet_E1_plus_E2);
  hist_vec_WW_1000_CT_wO.push_back(h_WW_1000_CT_wO_recojet_E1_plus_E2);
  hist_vec_WW_1000_CT_wO.push_back(h_WW_1000_CT_wO_genjet_M_jj);
  hist_vec_WW_1000_CT_wO.push_back(h_WW_1000_CT_wO_recojet_M_jj);
  hist_vec_WW_1000_CT_wO.push_back(h_WW_1000_CT_wO_M_WBoson);
  hist_vec_WW_1000_CT_wO.push_back(h_WW_1000_CT_wO_M_qq);

  for(unsigned int i=0;i<hist_vec_WW_1000_CT_wO.size();i++){
    hist_vec_WW_1000_CT_wO[i]->Sumw2();
  }
  fill_mass_histograms(file_CLIC_WW_1000_CT_wO,hist_vec_WW_1000_CT_wO);

  TH1F* h_WW_1000_CT_wO_Loose_genjet_E1_plus_E2 =  new TH1F("h_WW_1000_CT_wO_Loose_genjet_E1_plus_E2","", n_binsJER, 50,2250);
  TH1F* h_WW_1000_CT_wO_Loose_recojet_E1_plus_E2 =  new TH1F("h_WW_1000_CT_wO_Loose_recojet_E1_plus_E2","", n_binsJER, 50,2250);
  TH1F* h_WW_1000_CT_wO_Loose_genjet_M_jj =  new TH1F("h_WW_1000_CT_wO_Loose_genjet_M_jj","", n_binsJER, 20.,200.);
  TH1F* h_WW_1000_CT_wO_Loose_recojet_M_jj =  new TH1F("h_WW_1000_CT_wO_Loose_recojet_M_jj","", n_binsJER, 20.,200.);
  TH1F* h_WW_1000_CT_wO_Loose_M_WBoson =  new TH1F("h_WW_1000_CT_wO_Loose_parton_M_WBoson","", 10*n_binsJER, 20.,1000.);
  TH1F* h_WW_1000_CT_wO_Loose_M_qq =  new TH1F("h_WW_1000_CT_wO_Loose_parton_M_qq","", 10*n_binsJER, 20.,1000.);

  std::vector<TH1F*> hist_vec_WW_1000_CT_wO_Loose;
  hist_vec_WW_1000_CT_wO_Loose.push_back(h_WW_1000_CT_wO_Loose_genjet_E1_plus_E2);
  hist_vec_WW_1000_CT_wO_Loose.push_back(h_WW_1000_CT_wO_Loose_recojet_E1_plus_E2);
  hist_vec_WW_1000_CT_wO_Loose.push_back(h_WW_1000_CT_wO_Loose_genjet_M_jj);
  hist_vec_WW_1000_CT_wO_Loose.push_back(h_WW_1000_CT_wO_Loose_recojet_M_jj);
  hist_vec_WW_1000_CT_wO_Loose.push_back(h_WW_1000_CT_wO_Loose_M_WBoson);
  hist_vec_WW_1000_CT_wO_Loose.push_back(h_WW_1000_CT_wO_Loose_M_qq);

  for(unsigned int i=0;i<hist_vec_WW_1000_CT_wO_Loose.size();i++){
    hist_vec_WW_1000_CT_wO_Loose[i]->Sumw2();
  }
  fill_mass_histograms(file_CLIC_WW_1000_CT_wO_Loose,hist_vec_WW_1000_CT_wO_Loose);

  TH1F* h_WW_1000_CT_wO_Selected_genjet_E1_plus_E2 =  new TH1F("h_WW_1000_CT_wO_Selected_genjet_E1_plus_E2","", n_binsJER, 50,2250);
  TH1F* h_WW_1000_CT_wO_Selected_recojet_E1_plus_E2 =  new TH1F("h_WW_1000_CT_wO_Selected_recojet_E1_plus_E2","", n_binsJER, 50,2250);
  TH1F* h_WW_1000_CT_wO_Selected_genjet_M_jj =  new TH1F("h_WW_1000_CT_wO_Selected_genjet_M_jj","", n_binsJER, 20.,200.);
  TH1F* h_WW_1000_CT_wO_Selected_recojet_M_jj =  new TH1F("h_WW_1000_CT_wO_Selected_recojet_M_jj","", n_binsJER, 20.,200.);
  TH1F* h_WW_1000_CT_wO_Selected_M_WBoson =  new TH1F("h_WW_1000_CT_wO_Selected_parton_M_WBoson","", 10*n_binsJER, 20.,1000.);
  TH1F* h_WW_1000_CT_wO_Selected_M_qq =  new TH1F("h_WW_1000_CT_wO_Selected_parton_M_qq","", 10*n_binsJER, 20.,1000.);

  std::vector<TH1F*> hist_vec_WW_1000_CT_wO_Selected;
  hist_vec_WW_1000_CT_wO_Selected.push_back(h_WW_1000_CT_wO_Selected_genjet_E1_plus_E2);
  hist_vec_WW_1000_CT_wO_Selected.push_back(h_WW_1000_CT_wO_Selected_recojet_E1_plus_E2);
  hist_vec_WW_1000_CT_wO_Selected.push_back(h_WW_1000_CT_wO_Selected_genjet_M_jj);
  hist_vec_WW_1000_CT_wO_Selected.push_back(h_WW_1000_CT_wO_Selected_recojet_M_jj);
  hist_vec_WW_1000_CT_wO_Selected.push_back(h_WW_1000_CT_wO_Selected_M_WBoson);
  hist_vec_WW_1000_CT_wO_Selected.push_back(h_WW_1000_CT_wO_Selected_M_qq);

  for(unsigned int i=0;i<hist_vec_WW_1000_CT_wO_Selected.size();i++){
    hist_vec_WW_1000_CT_wO_Selected[i]->Sumw2();
  }
  fill_mass_histograms(file_CLIC_WW_1000_CT_wO_Selected,hist_vec_WW_1000_CT_wO_Selected);

  TH1F* h_WW_1000_CT_wO_allPFOs_genjet_E1_plus_E2 =  new TH1F("h_WW_1000_CT_wO_allPFOs_genjet_E1_plus_E2","", n_binsJER, 50,2250);
  TH1F* h_WW_1000_CT_wO_allPFOs_recojet_E1_plus_E2 =  new TH1F("h_WW_1000_CT_wO_allPFOs_recojet_E1_plus_E2","", n_binsJER, 50,2250);
  TH1F* h_WW_1000_CT_wO_allPFOs_genjet_M_jj =  new TH1F("h_WW_1000_CT_wO_allPFOs_genjet_M_jj","", n_binsJER, 20.,200.);
  TH1F* h_WW_1000_CT_wO_allPFOs_recojet_M_jj =  new TH1F("h_WW_1000_CT_wO_allPFOs_recojet_M_jj","", n_binsJER, 20.,200.);
  TH1F* h_WW_1000_CT_wO_allPFOs_M_WBoson =  new TH1F("h_WW_1000_CT_wO_allPFOs_parton_M_WBoson","", 10*n_binsJER, 20.,1000.);
  TH1F* h_WW_1000_CT_wO_allPFOs_M_qq =  new TH1F("h_WW_1000_CT_wO_allPFOs_parton_M_qq","", 10*n_binsJER, 20.,1000.);

  std::vector<TH1F*> hist_vec_WW_1000_CT_wO_allPFOs;
  hist_vec_WW_1000_CT_wO_allPFOs.push_back(h_WW_1000_CT_wO_allPFOs_genjet_E1_plus_E2);
  hist_vec_WW_1000_CT_wO_allPFOs.push_back(h_WW_1000_CT_wO_allPFOs_recojet_E1_plus_E2);
  hist_vec_WW_1000_CT_wO_allPFOs.push_back(h_WW_1000_CT_wO_allPFOs_genjet_M_jj);
  hist_vec_WW_1000_CT_wO_allPFOs.push_back(h_WW_1000_CT_wO_allPFOs_recojet_M_jj);
  hist_vec_WW_1000_CT_wO_allPFOs.push_back(h_WW_1000_CT_wO_allPFOs_M_WBoson);
  hist_vec_WW_1000_CT_wO_allPFOs.push_back(h_WW_1000_CT_wO_allPFOs_M_qq);

  for(unsigned int i=0;i<hist_vec_WW_1000_CT_wO_allPFOs.size();i++){
    hist_vec_WW_1000_CT_wO_allPFOs[i]->Sumw2();
  }
  fill_mass_histograms(file_CLIC_WW_1000_CT_wO_allPFOs,hist_vec_WW_1000_CT_wO_allPFOs);
  std::cout<<"WW_1000 done"<<std::endl;
  TH1F* h_WW_2000_CT_genjet_E1_plus_E2 =  new TH1F("h_WW_2000_CT_genjet_E1_plus_E2","", n_binsJER, 50,2250);
  TH1F* h_WW_2000_CT_recojet_E1_plus_E2 =  new TH1F("h_WW_2000_CT_recojet_E1_plus_E2","", n_binsJER, 50,2250);
  TH1F* h_WW_2000_CT_genjet_M_jj =  new TH1F("h_WW_2000_CT_genjet_M_jj","", n_binsJER, 20.,200.);
  TH1F* h_WW_2000_CT_recojet_M_jj =  new TH1F("h_WW_2000_CT_recojet_M_jj","", n_binsJER, 20.,200.);
  TH1F* h_WW_2000_CT_M_WBoson =  new TH1F("h_WW_2000_CT_parton_M_WBoson","", 10*n_binsJER, 20.,2000.);
  TH1F* h_WW_2000_CT_M_qq =  new TH1F("h_WW_2000_CT_parton_M_qq","", 10*n_binsJER, 20.,2000.);

  std::vector<TH1F*> hist_vec_WW_2000_CT;
  hist_vec_WW_2000_CT.push_back(h_WW_2000_CT_genjet_E1_plus_E2);
  hist_vec_WW_2000_CT.push_back(h_WW_2000_CT_recojet_E1_plus_E2);
  hist_vec_WW_2000_CT.push_back(h_WW_2000_CT_genjet_M_jj);
  hist_vec_WW_2000_CT.push_back(h_WW_2000_CT_recojet_M_jj);
  hist_vec_WW_2000_CT.push_back(h_WW_2000_CT_M_WBoson);
  hist_vec_WW_2000_CT.push_back(h_WW_2000_CT_M_qq);

  for(unsigned int i=0;i<hist_vec_WW_2000_CT.size();i++){
    hist_vec_WW_2000_CT[i]->Sumw2();
  }
  fill_mass_histograms(file_CLIC_WW_2000_CT,hist_vec_WW_2000_CT);

  TH1F* h_WW_2000_CT_wO_genjet_E1_plus_E2 =  new TH1F("h_WW_2000_CT_wO_genjet_E1_plus_E2","", n_binsJER, 50,2250);
  TH1F* h_WW_2000_CT_wO_recojet_E1_plus_E2 =  new TH1F("h_WW_2000_CT_wO_recojet_E1_plus_E2","", n_binsJER, 50,2250);
  TH1F* h_WW_2000_CT_wO_genjet_M_jj =  new TH1F("h_WW_2000_CT_wO_genjet_M_jj","", n_binsJER, 20.,200.);
  TH1F* h_WW_2000_CT_wO_recojet_M_jj =  new TH1F("h_WW_2000_CT_wO_recojet_M_jj","", n_binsJER, 20.,200.);
  TH1F* h_WW_2000_CT_wO_M_WBoson =  new TH1F("h_WW_2000_CT_wO_parton_M_WBoson","", 10*n_binsJER, 20.,2000.);
  TH1F* h_WW_2000_CT_wO_M_qq =  new TH1F("h_WW_2000_CT_wO_parton_M_qq","", 10*n_binsJER, 20.,2000.);

  std::vector<TH1F*> hist_vec_WW_2000_CT_wO;
  hist_vec_WW_2000_CT_wO.push_back(h_WW_2000_CT_wO_genjet_E1_plus_E2);
  hist_vec_WW_2000_CT_wO.push_back(h_WW_2000_CT_wO_recojet_E1_plus_E2);
  hist_vec_WW_2000_CT_wO.push_back(h_WW_2000_CT_wO_genjet_M_jj);
  hist_vec_WW_2000_CT_wO.push_back(h_WW_2000_CT_wO_recojet_M_jj);
  hist_vec_WW_2000_CT_wO.push_back(h_WW_2000_CT_wO_M_WBoson);
  hist_vec_WW_2000_CT_wO.push_back(h_WW_2000_CT_wO_M_qq);

  for(unsigned int i=0;i<hist_vec_WW_2000_CT_wO.size();i++){
    hist_vec_WW_2000_CT_wO[i]->Sumw2();
  }
  fill_mass_histograms(file_CLIC_WW_2000_CT_wO,hist_vec_WW_2000_CT_wO);

  TH1F* h_WW_2000_CT_wO_Loose_genjet_E1_plus_E2 =  new TH1F("h_WW_2000_CT_wO_Loose_genjet_E1_plus_E2","", n_binsJER, 50,2250);
  TH1F* h_WW_2000_CT_wO_Loose_recojet_E1_plus_E2 =  new TH1F("h_WW_2000_CT_wO_Loose_recojet_E1_plus_E2","", n_binsJER, 50,2250);
  TH1F* h_WW_2000_CT_wO_Loose_genjet_M_jj =  new TH1F("h_WW_2000_CT_wO_Loose_genjet_M_jj","", n_binsJER, 20.,200.);
  TH1F* h_WW_2000_CT_wO_Loose_recojet_M_jj =  new TH1F("h_WW_2000_CT_wO_Loose_recojet_M_jj","", n_binsJER, 20.,200.);
  TH1F* h_WW_2000_CT_wO_Loose_M_WBoson =  new TH1F("h_WW_2000_CT_wO_Loose_parton_M_WBoson","", 10*n_binsJER, 20.,2000.);
  TH1F* h_WW_2000_CT_wO_Loose_M_qq =  new TH1F("h_WW_2000_CT_wO_Loose_parton_M_qq","", 10*n_binsJER, 20.,2000.);

  std::vector<TH1F*> hist_vec_WW_2000_CT_wO_Loose;
  hist_vec_WW_2000_CT_wO_Loose.push_back(h_WW_2000_CT_wO_Loose_genjet_E1_plus_E2);
  hist_vec_WW_2000_CT_wO_Loose.push_back(h_WW_2000_CT_wO_Loose_recojet_E1_plus_E2);
  hist_vec_WW_2000_CT_wO_Loose.push_back(h_WW_2000_CT_wO_Loose_genjet_M_jj);
  hist_vec_WW_2000_CT_wO_Loose.push_back(h_WW_2000_CT_wO_Loose_recojet_M_jj);
  hist_vec_WW_2000_CT_wO_Loose.push_back(h_WW_2000_CT_wO_Loose_M_WBoson);
  hist_vec_WW_2000_CT_wO_Loose.push_back(h_WW_2000_CT_wO_Loose_M_qq);

  for(unsigned int i=0;i<hist_vec_WW_2000_CT_wO_Loose.size();i++){
    hist_vec_WW_2000_CT_wO_Loose[i]->Sumw2();
  }
  fill_mass_histograms(file_CLIC_WW_2000_CT_wO_Loose,hist_vec_WW_2000_CT_wO_Loose);

  TH1F* h_WW_2000_CT_wO_Selected_genjet_E1_plus_E2 =  new TH1F("h_WW_2000_CT_wO_Selected_genjet_E1_plus_E2","", n_binsJER, 50,2250);
  TH1F* h_WW_2000_CT_wO_Selected_recojet_E1_plus_E2 =  new TH1F("h_WW_2000_CT_wO_Selected_recojet_E1_plus_E2","", n_binsJER, 50,2250);
  TH1F* h_WW_2000_CT_wO_Selected_genjet_M_jj =  new TH1F("h_WW_2000_CT_wO_Selected_genjet_M_jj","", n_binsJER, 20.,200.);
  TH1F* h_WW_2000_CT_wO_Selected_recojet_M_jj =  new TH1F("h_WW_2000_CT_wO_Selected_recojet_M_jj","", n_binsJER, 20.,200.);
  TH1F* h_WW_2000_CT_wO_Selected_M_WBoson =  new TH1F("h_WW_2000_CT_wO_Selected_parton_M_WBoson","", 10*n_binsJER, 20.,2000.);
  TH1F* h_WW_2000_CT_wO_Selected_M_qq =  new TH1F("h_WW_2000_CT_wO_Selected_parton_M_qq","", 10*n_binsJER, 20.,2000.);

  std::vector<TH1F*> hist_vec_WW_2000_CT_wO_Selected;
  hist_vec_WW_2000_CT_wO_Selected.push_back(h_WW_2000_CT_wO_Selected_genjet_E1_plus_E2);
  hist_vec_WW_2000_CT_wO_Selected.push_back(h_WW_2000_CT_wO_Selected_recojet_E1_plus_E2);
  hist_vec_WW_2000_CT_wO_Selected.push_back(h_WW_2000_CT_wO_Selected_genjet_M_jj);
  hist_vec_WW_2000_CT_wO_Selected.push_back(h_WW_2000_CT_wO_Selected_recojet_M_jj);
  hist_vec_WW_2000_CT_wO_Selected.push_back(h_WW_2000_CT_wO_Selected_M_WBoson);
  hist_vec_WW_2000_CT_wO_Selected.push_back(h_WW_2000_CT_wO_Selected_M_qq);

  for(unsigned int i=0;i<hist_vec_WW_2000_CT_wO_Selected.size();i++){
    hist_vec_WW_2000_CT_wO_Selected[i]->Sumw2();
  }
  fill_mass_histograms(file_CLIC_WW_2000_CT_wO_Selected,hist_vec_WW_2000_CT_wO_Selected);

  TH1F* h_WW_2000_CT_wO_allPFOs_genjet_E1_plus_E2 =  new TH1F("h_WW_2000_CT_wO_allPFOs_genjet_E1_plus_E2","", n_binsJER, 50,2250);
  TH1F* h_WW_2000_CT_wO_allPFOs_recojet_E1_plus_E2 =  new TH1F("h_WW_2000_CT_wO_allPFOs_recojet_E1_plus_E2","", n_binsJER, 50,2250);
  TH1F* h_WW_2000_CT_wO_allPFOs_genjet_M_jj =  new TH1F("h_WW_2000_CT_wO_allPFOs_genjet_M_jj","", n_binsJER, 20.,200.);
  TH1F* h_WW_2000_CT_wO_allPFOs_recojet_M_jj =  new TH1F("h_WW_2000_CT_wO_allPFOs_recojet_M_jj","", n_binsJER, 20.,200.);
  TH1F* h_WW_2000_CT_wO_allPFOs_M_WBoson =  new TH1F("h_WW_2000_CT_wO_allPFOs_parton_M_WBoson","", 10*n_binsJER, 20.,2000.);
  TH1F* h_WW_2000_CT_wO_allPFOs_M_qq =  new TH1F("h_WW_2000_CT_wO_allPFOs_parton_M_qq","", 10*n_binsJER, 20.,2000.);

  std::vector<TH1F*> hist_vec_WW_2000_CT_wO_allPFOs;
  hist_vec_WW_2000_CT_wO_allPFOs.push_back(h_WW_2000_CT_wO_allPFOs_genjet_E1_plus_E2);
  hist_vec_WW_2000_CT_wO_allPFOs.push_back(h_WW_2000_CT_wO_allPFOs_recojet_E1_plus_E2);
  hist_vec_WW_2000_CT_wO_allPFOs.push_back(h_WW_2000_CT_wO_allPFOs_genjet_M_jj);
  hist_vec_WW_2000_CT_wO_allPFOs.push_back(h_WW_2000_CT_wO_allPFOs_recojet_M_jj);
  hist_vec_WW_2000_CT_wO_allPFOs.push_back(h_WW_2000_CT_wO_allPFOs_M_WBoson);
  hist_vec_WW_2000_CT_wO_allPFOs.push_back(h_WW_2000_CT_wO_allPFOs_M_qq);

  for(unsigned int i=0;i<hist_vec_WW_2000_CT_wO_allPFOs.size();i++){
    hist_vec_WW_2000_CT_wO_allPFOs[i]->Sumw2();
  }
  fill_mass_histograms(file_CLIC_WW_2000_CT_wO_allPFOs,hist_vec_WW_2000_CT_wO_allPFOs);
  std::cout<<"WW_2000 done"<<std::endl;
  */
  //380 GeV conditions overlay 380 GeV sample




  TH1F* h_380_CT_wO_380_genjet03_dphi_j1j2 =  new TH1F("h_380_CT_wO_380_genjet03_dphi_j1j2","", n_bins100, 0.5,TMath::Pi());
  TH1F* h_380_CT_wO_380_genjet03_E1_E2_over_E_True =  new TH1F("h_380_CT_wO_380_genjet03_E1_E2_over_E_True","", n_bins100, 0.5,1.00);
  TH1F* h_380_CT_wO_380_genjet03_Delta_E1_E2_over_E12 =  new TH1F("h_380_CT_wO_380_genjet03_Delta_E1_E2_over_E12","", n_bins100, -0.5,0.5);
  TH1F* h_380_CT_wO_380_genjet04_dphi_j1j2 =  new TH1F("h_380_CT_wO_380_genjet04_dphi_j1j2","", n_bins100, 0.5,TMath::Pi());
  TH1F* h_380_CT_wO_380_genjet04_E1_E2_over_E_True =  new TH1F("h_380_CT_wO_380_genjet04_E1_E2_over_E_True","", n_bins100, 0.5,1.00);
  TH1F* h_380_CT_wO_380_genjet04_Delta_E1_E2_over_E12 =  new TH1F("h_380_CT_wO_380_genjet04_Delta_E1_E2_over_E12","", n_bins100, -0.5,0.5);
  TH1F* h_380_CT_wO_380_genjet05_dphi_j1j2 =  new TH1F("h_380_CT_wO_380_genjet05_dphi_j1j2","", n_bins100, 0.5,TMath::Pi());
  TH1F* h_380_CT_wO_380_genjet05_E1_E2_over_E_True =  new TH1F("h_380_CT_wO_380_genjet05_E1_E2_over_E_True","", n_bins100, 0.5,1.00);
  TH1F* h_380_CT_wO_380_genjet05_Delta_E1_E2_over_E12 =  new TH1F("h_380_CT_wO_380_genjet05_Delta_E1_E2_over_E12","", n_bins100, -0.5,0.5);
  TH1F* h_380_CT_wO_380_genjet06_dphi_j1j2 =  new TH1F("h_380_CT_wO_380_genjet06_dphi_j1j2","", n_bins100, 0.5,TMath::Pi());
  TH1F* h_380_CT_wO_380_genjet06_E1_E2_over_E_True =  new TH1F("h_380_CT_wO_380_genjet06_E1_E2_over_E_True","", n_bins100, 0.5,1.00);
  TH1F* h_380_CT_wO_380_genjet06_Delta_E1_E2_over_E12 =  new TH1F("h_380_CT_wO_380_genjet06_Delta_E1_E2_over_E12","", n_bins100, -0.5,0.5);
  TH1F* h_380_CT_wO_380_genjet07_dphi_j1j2 =  new TH1F("h_380_CT_wO_380_genjet07_dphi_j1j2","", n_bins100, 0.5,TMath::Pi());
  TH1F* h_380_CT_wO_380_genjet07_E1_E2_over_E_True =  new TH1F("h_380_CT_wO_380_genjet07_E1_E2_over_E_True","", n_bins100, 0.5,1.00);
  TH1F* h_380_CT_wO_380_genjet07_Delta_E1_E2_over_E12 =  new TH1F("h_380_CT_wO_380_genjet07_Delta_E1_E2_over_E12","", n_bins100, -0.5,0.5);
  TH1F* h_380_CT_wO_380_genjet08_dphi_j1j2 =  new TH1F("h_380_CT_wO_380_genjet08_dphi_j1j2","", n_bins100, 0.5,TMath::Pi());
  TH1F* h_380_CT_wO_380_genjet08_E1_E2_over_E_True =  new TH1F("h_380_CT_wO_380_genjet08_E1_E2_over_E_True","", n_bins100, 0.5,1.00);
  TH1F* h_380_CT_wO_380_genjet08_Delta_E1_E2_over_E12 =  new TH1F("h_380_CT_wO_380_genjet08_Delta_E1_E2_over_E12","", n_bins100, -0.5,0.5);
  TH1F* h_380_CT_wO_380_genjet09_dphi_j1j2 =  new TH1F("h_380_CT_wO_380_genjet09_dphi_j1j2","", n_bins100, 0.5,TMath::Pi());
  TH1F* h_380_CT_wO_380_genjet09_E1_E2_over_E_True =  new TH1F("h_380_CT_wO_380_genjet09_E1_E2_over_E_True","", n_bins100, 0.5,1.00);
  TH1F* h_380_CT_wO_380_genjet09_Delta_E1_E2_over_E12 =  new TH1F("h_380_CT_wO_380_genjet09_Delta_E1_E2_over_E12","", n_bins100, -0.5,0.5);
  TH1F* h_380_CT_wO_380_genjet10_dphi_j1j2 =  new TH1F("h_380_CT_wO_380_genjet10_dphi_j1j2","", n_bins100, 0.5,TMath::Pi());
  TH1F* h_380_CT_wO_380_genjet10_E1_E2_over_E_True =  new TH1F("h_380_CT_wO_380_genjet10_E1_E2_over_E_True","", n_bins100, 0.5,1.00);
  TH1F* h_380_CT_wO_380_genjet10_Delta_E1_E2_over_E12 =  new TH1F("h_380_CT_wO_380_genjet10_Delta_E1_E2_over_E12","", n_bins100, -0.5,0.5);

  TH1F* h_380_CT_wO_380_recojet03_dphi_j1j2 =  new TH1F("h_380_CT_wO_380_recojet03_dphi_j1j2","", n_bins100, 0.5,TMath::Pi());
  TH1F* h_380_CT_wO_380_recojet03_E1_E2_over_E_True =  new TH1F("h_380_CT_wO_380_recojet03_E1_E2_over_E_True","", n_bins100, 0.5,1.00);
  TH1F* h_380_CT_wO_380_recojet03_Delta_E1_E2_over_E12 =  new TH1F("h_380_CT_wO_380_recojet03_Delta_E1_E2_over_E12","", n_bins100, -0.5,0.5);
  TH1F* h_380_CT_wO_380_recojet04_dphi_j1j2 =  new TH1F("h_380_CT_wO_380_recojet04_dphi_j1j2","", n_bins100, 0.5,TMath::Pi());
  TH1F* h_380_CT_wO_380_recojet04_E1_E2_over_E_True =  new TH1F("h_380_CT_wO_380_recojet04_E1_E2_over_E_True","", n_bins100, 0.5,1.00);
  TH1F* h_380_CT_wO_380_recojet04_Delta_E1_E2_over_E12 =  new TH1F("h_380_CT_wO_380_recojet04_Delta_E1_E2_over_E12","", n_bins100, -0.5,0.5);
  TH1F* h_380_CT_wO_380_recojet05_dphi_j1j2 =  new TH1F("h_380_CT_wO_380_recojet05_dphi_j1j2","", n_bins100, 0.5,TMath::Pi());
  TH1F* h_380_CT_wO_380_recojet05_E1_E2_over_E_True =  new TH1F("h_380_CT_wO_380_recojet05_E1_E2_over_E_True","", n_bins100, 0.5,1.00);
  TH1F* h_380_CT_wO_380_recojet05_Delta_E1_E2_over_E12 =  new TH1F("h_380_CT_wO_380_recojet05_Delta_E1_E2_over_E12","", n_bins100, -0.5,0.5);
  TH1F* h_380_CT_wO_380_recojet06_dphi_j1j2 =  new TH1F("h_380_CT_wO_380_recojet06_dphi_j1j2","", n_bins100, 0.5,TMath::Pi());
  TH1F* h_380_CT_wO_380_recojet06_E1_E2_over_E_True =  new TH1F("h_380_CT_wO_380_recojet06_E1_E2_over_E_True","", n_bins100, 0.5,1.00);
  TH1F* h_380_CT_wO_380_recojet06_Delta_E1_E2_over_E12 =  new TH1F("h_380_CT_wO_380_recojet06_Delta_E1_E2_over_E12","", n_bins100, -0.5,0.5);
  TH1F* h_380_CT_wO_380_recojet07_dphi_j1j2 =  new TH1F("h_380_CT_wO_380_recojet07_dphi_j1j2","", n_bins100, 0.5,TMath::Pi());
  TH1F* h_380_CT_wO_380_recojet07_E1_E2_over_E_True =  new TH1F("h_380_CT_wO_380_recojet07_E1_E2_over_E_True","", n_bins100, 0.5,1.00);
  TH1F* h_380_CT_wO_380_recojet07_Delta_E1_E2_over_E12 =  new TH1F("h_380_CT_wO_380_recojet07_Delta_E1_E2_over_E12","", n_bins100, -0.5,0.5);
  TH1F* h_380_CT_wO_380_recojet08_dphi_j1j2 =  new TH1F("h_380_CT_wO_380_recojet08_dphi_j1j2","", n_bins100, 0.5,TMath::Pi());
  TH1F* h_380_CT_wO_380_recojet08_E1_E2_over_E_True =  new TH1F("h_380_CT_wO_380_recojet08_E1_E2_over_E_True","", n_bins100, 0.5,1.00);
  TH1F* h_380_CT_wO_380_recojet08_Delta_E1_E2_over_E12 =  new TH1F("h_380_CT_wO_380_recojet08_Delta_E1_E2_over_E12","", n_bins100, -0.5,0.5);
  TH1F* h_380_CT_wO_380_recojet09_dphi_j1j2 =  new TH1F("h_380_CT_wO_380_recojet09_dphi_j1j2","", n_bins100, 0.5,TMath::Pi());
  TH1F* h_380_CT_wO_380_recojet09_E1_E2_over_E_True =  new TH1F("h_380_CT_wO_380_recojet09_E1_E2_over_E_True","", n_bins100, 0.5,1.00);
  TH1F* h_380_CT_wO_380_recojet09_Delta_E1_E2_over_E12 =  new TH1F("h_380_CT_wO_380_recojet09_Delta_E1_E2_over_E12","", n_bins100, -0.5,0.5);
  TH1F* h_380_CT_wO_380_recojet10_dphi_j1j2 =  new TH1F("h_380_CT_wO_380_recojet10_dphi_j1j2","", n_bins100, 0.5,TMath::Pi());
  TH1F* h_380_CT_wO_380_recojet10_E1_E2_over_E_True =  new TH1F("h_380_CT_wO_380_recojet10_E1_E2_over_E_True","", n_bins100, 0.5,1.00);
  TH1F* h_380_CT_wO_380_recojet10_Delta_E1_E2_over_E12 =  new TH1F("h_380_CT_wO_380_recojet10_Delta_E1_E2_over_E12","", n_bins100, -0.5,0.5);

  TH1F* h_380_CT_wO_380_recojetE_over_genjetE_DR03 =  new TH1F("h_380_CT_wO_380_recojetE_over_genjetE_DR03","", n_bins100, 0.5,1.5);
  TH1F* h_380_CT_wO_380_recojetE_over_genjetE_DR04 =  new TH1F("h_380_CT_wO_380_recojetE_over_genjetE_DR04","", n_bins100, 0.5,1.5);
  TH1F* h_380_CT_wO_380_recojetE_over_genjetE_DR05 =  new TH1F("h_380_CT_wO_380_recojetE_over_genjetE_DR05","", n_bins100, 0.5,1.5);
  TH1F* h_380_CT_wO_380_recojetE_over_genjetE_DR06 =  new TH1F("h_380_CT_wO_380_recojetE_over_genjetE_DR06","", n_bins100, 0.5,1.5);
  TH1F* h_380_CT_wO_380_recojetE_over_genjetE_DR07 =  new TH1F("h_380_CT_wO_380_recojetE_over_genjetE_DR07","", n_bins100, 0.5,1.5);
  TH1F* h_380_CT_wO_380_recojetE_over_genjetE_DR08 =  new TH1F("h_380_CT_wO_380_recojetE_over_genjetE_DR08","", n_bins100, 0.5,1.5);
  TH1F* h_380_CT_wO_380_recojetE_over_genjetE_DR09 =  new TH1F("h_380_CT_wO_380_recojetE_over_genjetE_DR09","", n_bins100, 0.5,1.5);
  TH1F* h_380_CT_wO_380_recojetE_over_genjetE_DR10 =  new TH1F("h_380_CT_wO_380_recojetE_over_genjetE_DR10","", n_bins100, 0.5,1.5);

  TH1F* h_380_CT_wO_380_dphi_gen_reco_DR05 =  new TH1F("h_380_CT_wO_380_dphi_gen_reco_DR05","", n_bins100, -0.1,9.9);
  TH1F* h_380_CT_wO_380_dphi_gen_reco_DR06 =  new TH1F("h_380_CT_wO_380_dphi_gen_reco_DR06","", n_bins100, -0.1,9.9);
  TH1F* h_380_CT_wO_380_dphi_gen_reco_DR07 =  new TH1F("h_380_CT_wO_380_dphi_gen_reco_DR07","", n_bins100, -0.1,9.9);

  TH1F* h_380_CT_wO_380_DR05_E_rel_totVis_RMS_d1_cosT_0_to_0_10 =  new TH1F("h_380_CT_wO_380_DR05_E_rel_totVis_RMS_d1_cosT_0_to_0_10","", n_binsJER, lim_E_rel_low,lim_E_rel_high);
  TH1F* h_380_CT_wO_380_DR05_E_rel_totVis_RMS_d1_cosT_0_10_to_0_20 =  new TH1F("h_380_CT_wO_380_DR05_E_rel_totVis_RMS_d1_cosT_0_10_to_0_20","", n_binsJER, lim_E_rel_low,lim_E_rel_high);
  TH1F* h_380_CT_wO_380_DR05_E_rel_totVis_RMS_d1_cosT_0_20_to_0_30 =  new TH1F("h_380_CT_wO_380_DR05_E_rel_totVis_RMS_d1_cosT_0_20_to_0_30","", n_binsJER, lim_E_rel_low,lim_E_rel_high);
  TH1F* h_380_CT_wO_380_DR05_E_rel_totVis_RMS_d1_cosT_0_30_to_0_40 =  new TH1F("h_380_CT_wO_380_DR05_E_rel_totVis_RMS_d1_cosT_0_30_to_0_40","", n_binsJER, lim_E_rel_low,lim_E_rel_high);
  TH1F* h_380_CT_wO_380_DR05_E_rel_totVis_RMS_d1_cosT_0_40_to_0_50 =  new TH1F("h_380_CT_wO_380_DR05_E_rel_totVis_RMS_d1_cosT_0_40_to_0_50","", n_binsJER, lim_E_rel_low,lim_E_rel_high);
  TH1F* h_380_CT_wO_380_DR05_E_rel_totVis_RMS_d1_cosT_0_50_to_0_60 =  new TH1F("h_380_CT_wO_380_DR05_E_rel_totVis_RMS_d1_cosT_0_50_to_0_60","", n_binsJER, lim_E_rel_low,lim_E_rel_high);
  TH1F* h_380_CT_wO_380_DR05_E_rel_totVis_RMS_d1_cosT_0_60_to_0_70 =  new TH1F("h_380_CT_wO_380_DR05_E_rel_totVis_RMS_d1_cosT_0_60_to_0_70","", n_binsJER, lim_E_rel_low,lim_E_rel_high);
  TH1F* h_380_CT_wO_380_DR05_E_rel_totVis_RMS_d1_cosT_0_70_to_0_80 =  new TH1F("h_380_CT_wO_380_DR05_E_rel_totVis_RMS_d1_cosT_0_70_to_0_80","", n_binsJER, lim_E_rel_low,lim_E_rel_high);
  TH1F* h_380_CT_wO_380_DR05_E_rel_totVis_RMS_d1_cosT_0_80_to_0_90 =  new TH1F("h_380_CT_wO_380_DR05_E_rel_totVis_RMS_d1_cosT_0_80_to_0_90","", n_binsJER, lim_E_rel_low,lim_E_rel_high);
  TH1F* h_380_CT_wO_380_DR05_E_rel_totVis_RMS_d1_cosT_0_900_to_0_925 =  new TH1F("h_380_CT_wO_380_DR05_E_rel_totVis_RMS_d1_cosT_0_900_to_0_925","", n_binsJER, lim_E_rel_low,lim_E_rel_high);
  TH1F* h_380_CT_wO_380_DR05_E_rel_totVis_RMS_d1_cosT_0_925_to_0_950 =  new TH1F("h_380_CT_wO_380_DR05_E_rel_totVis_RMS_d1_cosT_0_925_to_0_950","", n_binsJER, lim_E_rel_low,lim_E_rel_high);
  TH1F* h_380_CT_wO_380_DR05_E_rel_totVis_RMS_d1_cosT_0_950_to_0_975 =  new TH1F("h_380_CT_wO_380_DR05_E_rel_totVis_RMS_d1_cosT_0_950_to_0_975","", n_binsJER, lim_E_rel_low,lim_E_rel_high);
  TH1F* h_380_CT_wO_380_DR05_E_rel_totVis_RMS_d1_cosT_0_975_to_1_00 =  new TH1F("h_380_CT_wO_380_DR05_E_rel_totVis_RMS_d1_cosT_0_975_to_1_00","", n_binsJER, lim_E_rel_low,lim_E_rel_high);

  TH1F* h_380_CT_wO_380_DR06_E_rel_totVis_RMS_d1_cosT_0_to_0_10 =  new TH1F("h_380_CT_wO_380_DR06_E_rel_totVis_RMS_d1_cosT_0_to_0_10","", n_binsJER, lim_E_rel_low,lim_E_rel_high);
  TH1F* h_380_CT_wO_380_DR06_E_rel_totVis_RMS_d1_cosT_0_10_to_0_20 =  new TH1F("h_380_CT_wO_380_DR06_E_rel_totVis_RMS_d1_cosT_0_10_to_0_20","", n_binsJER, lim_E_rel_low,lim_E_rel_high);
  TH1F* h_380_CT_wO_380_DR06_E_rel_totVis_RMS_d1_cosT_0_20_to_0_30 =  new TH1F("h_380_CT_wO_380_DR06_E_rel_totVis_RMS_d1_cosT_0_20_to_0_30","", n_binsJER, lim_E_rel_low,lim_E_rel_high);
  TH1F* h_380_CT_wO_380_DR06_E_rel_totVis_RMS_d1_cosT_0_30_to_0_40 =  new TH1F("h_380_CT_wO_380_DR06_E_rel_totVis_RMS_d1_cosT_0_30_to_0_40","", n_binsJER, lim_E_rel_low,lim_E_rel_high);
  TH1F* h_380_CT_wO_380_DR06_E_rel_totVis_RMS_d1_cosT_0_40_to_0_50 =  new TH1F("h_380_CT_wO_380_DR06_E_rel_totVis_RMS_d1_cosT_0_40_to_0_50","", n_binsJER, lim_E_rel_low,lim_E_rel_high);
  TH1F* h_380_CT_wO_380_DR06_E_rel_totVis_RMS_d1_cosT_0_50_to_0_60 =  new TH1F("h_380_CT_wO_380_DR06_E_rel_totVis_RMS_d1_cosT_0_50_to_0_60","", n_binsJER, lim_E_rel_low,lim_E_rel_high);
  TH1F* h_380_CT_wO_380_DR06_E_rel_totVis_RMS_d1_cosT_0_60_to_0_70 =  new TH1F("h_380_CT_wO_380_DR06_E_rel_totVis_RMS_d1_cosT_0_60_to_0_70","", n_binsJER, lim_E_rel_low,lim_E_rel_high);
  TH1F* h_380_CT_wO_380_DR06_E_rel_totVis_RMS_d1_cosT_0_70_to_0_80 =  new TH1F("h_380_CT_wO_380_DR06_E_rel_totVis_RMS_d1_cosT_0_70_to_0_80","", n_binsJER, lim_E_rel_low,lim_E_rel_high);
  TH1F* h_380_CT_wO_380_DR06_E_rel_totVis_RMS_d1_cosT_0_80_to_0_90 =  new TH1F("h_380_CT_wO_380_DR06_E_rel_totVis_RMS_d1_cosT_0_80_to_0_90","", n_binsJER, lim_E_rel_low,lim_E_rel_high);
  TH1F* h_380_CT_wO_380_DR06_E_rel_totVis_RMS_d1_cosT_0_900_to_0_925 =  new TH1F("h_380_CT_wO_380_DR06_E_rel_totVis_RMS_d1_cosT_0_900_to_0_925","", n_binsJER, lim_E_rel_low,lim_E_rel_high);
  TH1F* h_380_CT_wO_380_DR06_E_rel_totVis_RMS_d1_cosT_0_925_to_0_950 =  new TH1F("h_380_CT_wO_380_DR06_E_rel_totVis_RMS_d1_cosT_0_925_to_0_950","", n_binsJER, lim_E_rel_low,lim_E_rel_high);
  TH1F* h_380_CT_wO_380_DR06_E_rel_totVis_RMS_d1_cosT_0_950_to_0_975 =  new TH1F("h_380_CT_wO_380_DR06_E_rel_totVis_RMS_d1_cosT_0_950_to_0_975","", n_binsJER, lim_E_rel_low,lim_E_rel_high);
  TH1F* h_380_CT_wO_380_DR06_E_rel_totVis_RMS_d1_cosT_0_975_to_1_00 =  new TH1F("h_380_CT_wO_380_DR06_E_rel_totVis_RMS_d1_cosT_0_975_to_1_00","", n_binsJER, lim_E_rel_low,lim_E_rel_high);

  TH1F* h_380_CT_wO_380_DR07_E_rel_totVis_RMS_d1_cosT_0_to_0_10 =  new TH1F("h_380_CT_wO_380_DR07_E_rel_totVis_RMS_d1_cosT_0_to_0_10","", n_binsJER, lim_E_rel_low,lim_E_rel_high);
  TH1F* h_380_CT_wO_380_DR07_E_rel_totVis_RMS_d1_cosT_0_10_to_0_20 =  new TH1F("h_380_CT_wO_380_DR07_E_rel_totVis_RMS_d1_cosT_0_10_to_0_20","", n_binsJER, lim_E_rel_low,lim_E_rel_high);
  TH1F* h_380_CT_wO_380_DR07_E_rel_totVis_RMS_d1_cosT_0_20_to_0_30 =  new TH1F("h_380_CT_wO_380_DR07_E_rel_totVis_RMS_d1_cosT_0_20_to_0_30","", n_binsJER, lim_E_rel_low,lim_E_rel_high);
  TH1F* h_380_CT_wO_380_DR07_E_rel_totVis_RMS_d1_cosT_0_30_to_0_40 =  new TH1F("h_380_CT_wO_380_DR07_E_rel_totVis_RMS_d1_cosT_0_30_to_0_40","", n_binsJER, lim_E_rel_low,lim_E_rel_high);
  TH1F* h_380_CT_wO_380_DR07_E_rel_totVis_RMS_d1_cosT_0_40_to_0_50 =  new TH1F("h_380_CT_wO_380_DR07_E_rel_totVis_RMS_d1_cosT_0_40_to_0_50","", n_binsJER, lim_E_rel_low,lim_E_rel_high);
  TH1F* h_380_CT_wO_380_DR07_E_rel_totVis_RMS_d1_cosT_0_50_to_0_60 =  new TH1F("h_380_CT_wO_380_DR07_E_rel_totVis_RMS_d1_cosT_0_50_to_0_60","", n_binsJER, lim_E_rel_low,lim_E_rel_high);
  TH1F* h_380_CT_wO_380_DR07_E_rel_totVis_RMS_d1_cosT_0_60_to_0_70 =  new TH1F("h_380_CT_wO_380_DR07_E_rel_totVis_RMS_d1_cosT_0_60_to_0_70","", n_binsJER, lim_E_rel_low,lim_E_rel_high);
  TH1F* h_380_CT_wO_380_DR07_E_rel_totVis_RMS_d1_cosT_0_70_to_0_80 =  new TH1F("h_380_CT_wO_380_DR07_E_rel_totVis_RMS_d1_cosT_0_70_to_0_80","", n_binsJER, lim_E_rel_low,lim_E_rel_high);
  TH1F* h_380_CT_wO_380_DR07_E_rel_totVis_RMS_d1_cosT_0_80_to_0_90 =  new TH1F("h_380_CT_wO_380_DR07_E_rel_totVis_RMS_d1_cosT_0_80_to_0_90","", n_binsJER, lim_E_rel_low,lim_E_rel_high);
  TH1F* h_380_CT_wO_380_DR07_E_rel_totVis_RMS_d1_cosT_0_900_to_0_925 =  new TH1F("h_380_CT_wO_380_DR07_E_rel_totVis_RMS_d1_cosT_0_900_to_0_925","", n_binsJER, lim_E_rel_low,lim_E_rel_high);
  TH1F* h_380_CT_wO_380_DR07_E_rel_totVis_RMS_d1_cosT_0_925_to_0_950 =  new TH1F("h_380_CT_wO_380_DR07_E_rel_totVis_RMS_d1_cosT_0_925_to_0_950","", n_binsJER, lim_E_rel_low,lim_E_rel_high);
  TH1F* h_380_CT_wO_380_DR07_E_rel_totVis_RMS_d1_cosT_0_950_to_0_975 =  new TH1F("h_380_CT_wO_380_DR07_E_rel_totVis_RMS_d1_cosT_0_950_to_0_975","", n_binsJER, lim_E_rel_low,lim_E_rel_high);
  TH1F* h_380_CT_wO_380_DR07_E_rel_totVis_RMS_d1_cosT_0_975_to_1_00 =  new TH1F("h_380_CT_wO_380_DR07_E_rel_totVis_RMS_d1_cosT_0_975_to_1_00","", n_binsJER, lim_E_rel_low,lim_E_rel_high);

  TH1F* h_380_CT_wO_380_DR08_E_rel_totVis_RMS_d1_cosT_0_to_0_10 =  new TH1F("h_380_CT_wO_380_DR08_E_rel_totVis_RMS_d1_cosT_0_to_0_10","", n_binsJER, lim_E_rel_low,lim_E_rel_high);
  TH1F* h_380_CT_wO_380_DR08_E_rel_totVis_RMS_d1_cosT_0_10_to_0_20 =  new TH1F("h_380_CT_wO_380_DR08_E_rel_totVis_RMS_d1_cosT_0_10_to_0_20","", n_binsJER, lim_E_rel_low,lim_E_rel_high);
  TH1F* h_380_CT_wO_380_DR08_E_rel_totVis_RMS_d1_cosT_0_20_to_0_30 =  new TH1F("h_380_CT_wO_380_DR08_E_rel_totVis_RMS_d1_cosT_0_20_to_0_30","", n_binsJER, lim_E_rel_low,lim_E_rel_high);
  TH1F* h_380_CT_wO_380_DR08_E_rel_totVis_RMS_d1_cosT_0_30_to_0_40 =  new TH1F("h_380_CT_wO_380_DR08_E_rel_totVis_RMS_d1_cosT_0_30_to_0_40","", n_binsJER, lim_E_rel_low,lim_E_rel_high);
  TH1F* h_380_CT_wO_380_DR08_E_rel_totVis_RMS_d1_cosT_0_40_to_0_50 =  new TH1F("h_380_CT_wO_380_DR08_E_rel_totVis_RMS_d1_cosT_0_40_to_0_50","", n_binsJER, lim_E_rel_low,lim_E_rel_high);
  TH1F* h_380_CT_wO_380_DR08_E_rel_totVis_RMS_d1_cosT_0_50_to_0_60 =  new TH1F("h_380_CT_wO_380_DR08_E_rel_totVis_RMS_d1_cosT_0_50_to_0_60","", n_binsJER, lim_E_rel_low,lim_E_rel_high);
  TH1F* h_380_CT_wO_380_DR08_E_rel_totVis_RMS_d1_cosT_0_60_to_0_70 =  new TH1F("h_380_CT_wO_380_DR08_E_rel_totVis_RMS_d1_cosT_0_60_to_0_70","", n_binsJER, lim_E_rel_low,lim_E_rel_high);
  TH1F* h_380_CT_wO_380_DR08_E_rel_totVis_RMS_d1_cosT_0_70_to_0_80 =  new TH1F("h_380_CT_wO_380_DR08_E_rel_totVis_RMS_d1_cosT_0_70_to_0_80","", n_binsJER, lim_E_rel_low,lim_E_rel_high);
  TH1F* h_380_CT_wO_380_DR08_E_rel_totVis_RMS_d1_cosT_0_80_to_0_90 =  new TH1F("h_380_CT_wO_380_DR08_E_rel_totVis_RMS_d1_cosT_0_80_to_0_90","", n_binsJER, lim_E_rel_low,lim_E_rel_high);
  TH1F* h_380_CT_wO_380_DR08_E_rel_totVis_RMS_d1_cosT_0_900_to_0_925 =  new TH1F("h_380_CT_wO_380_DR08_E_rel_totVis_RMS_d1_cosT_0_900_to_0_925","", n_binsJER, lim_E_rel_low,lim_E_rel_high);
  TH1F* h_380_CT_wO_380_DR08_E_rel_totVis_RMS_d1_cosT_0_925_to_0_950 =  new TH1F("h_380_CT_wO_380_DR08_E_rel_totVis_RMS_d1_cosT_0_925_to_0_950","", n_binsJER, lim_E_rel_low,lim_E_rel_high);
  TH1F* h_380_CT_wO_380_DR08_E_rel_totVis_RMS_d1_cosT_0_950_to_0_975 =  new TH1F("h_380_CT_wO_380_DR08_E_rel_totVis_RMS_d1_cosT_0_950_to_0_975","", n_binsJER, lim_E_rel_low,lim_E_rel_high);
  TH1F* h_380_CT_wO_380_DR08_E_rel_totVis_RMS_d1_cosT_0_975_to_1_00 =  new TH1F("h_380_CT_wO_380_DR08_E_rel_totVis_RMS_d1_cosT_0_975_to_1_00","", n_binsJER, lim_E_rel_low,lim_E_rel_high);

  TH1F* h_380_CT_wO_380_DR09_E_rel_totVis_RMS_d1_cosT_0_to_0_10 =  new TH1F("h_380_CT_wO_380_DR09_E_rel_totVis_RMS_d1_cosT_0_to_0_10","", n_binsJER, lim_E_rel_low,lim_E_rel_high);
  TH1F* h_380_CT_wO_380_DR09_E_rel_totVis_RMS_d1_cosT_0_10_to_0_20 =  new TH1F("h_380_CT_wO_380_DR09_E_rel_totVis_RMS_d1_cosT_0_10_to_0_20","", n_binsJER, lim_E_rel_low,lim_E_rel_high);
  TH1F* h_380_CT_wO_380_DR09_E_rel_totVis_RMS_d1_cosT_0_20_to_0_30 =  new TH1F("h_380_CT_wO_380_DR09_E_rel_totVis_RMS_d1_cosT_0_20_to_0_30","", n_binsJER, lim_E_rel_low,lim_E_rel_high);
  TH1F* h_380_CT_wO_380_DR09_E_rel_totVis_RMS_d1_cosT_0_30_to_0_40 =  new TH1F("h_380_CT_wO_380_DR09_E_rel_totVis_RMS_d1_cosT_0_30_to_0_40","", n_binsJER, lim_E_rel_low,lim_E_rel_high);
  TH1F* h_380_CT_wO_380_DR09_E_rel_totVis_RMS_d1_cosT_0_40_to_0_50 =  new TH1F("h_380_CT_wO_380_DR09_E_rel_totVis_RMS_d1_cosT_0_40_to_0_50","", n_binsJER, lim_E_rel_low,lim_E_rel_high);
  TH1F* h_380_CT_wO_380_DR09_E_rel_totVis_RMS_d1_cosT_0_50_to_0_60 =  new TH1F("h_380_CT_wO_380_DR09_E_rel_totVis_RMS_d1_cosT_0_50_to_0_60","", n_binsJER, lim_E_rel_low,lim_E_rel_high);
  TH1F* h_380_CT_wO_380_DR09_E_rel_totVis_RMS_d1_cosT_0_60_to_0_70 =  new TH1F("h_380_CT_wO_380_DR09_E_rel_totVis_RMS_d1_cosT_0_60_to_0_70","", n_binsJER, lim_E_rel_low,lim_E_rel_high);
  TH1F* h_380_CT_wO_380_DR09_E_rel_totVis_RMS_d1_cosT_0_70_to_0_80 =  new TH1F("h_380_CT_wO_380_DR09_E_rel_totVis_RMS_d1_cosT_0_70_to_0_80","", n_binsJER, lim_E_rel_low,lim_E_rel_high);
  TH1F* h_380_CT_wO_380_DR09_E_rel_totVis_RMS_d1_cosT_0_80_to_0_90 =  new TH1F("h_380_CT_wO_380_DR09_E_rel_totVis_RMS_d1_cosT_0_80_to_0_90","", n_binsJER, lim_E_rel_low,lim_E_rel_high);
  TH1F* h_380_CT_wO_380_DR09_E_rel_totVis_RMS_d1_cosT_0_900_to_0_925 =  new TH1F("h_380_CT_wO_380_DR09_E_rel_totVis_RMS_d1_cosT_0_900_to_0_925","", n_binsJER, lim_E_rel_low,lim_E_rel_high);
  TH1F* h_380_CT_wO_380_DR09_E_rel_totVis_RMS_d1_cosT_0_925_to_0_950 =  new TH1F("h_380_CT_wO_380_DR09_E_rel_totVis_RMS_d1_cosT_0_925_to_0_950","", n_binsJER, lim_E_rel_low,lim_E_rel_high);
  TH1F* h_380_CT_wO_380_DR09_E_rel_totVis_RMS_d1_cosT_0_950_to_0_975 =  new TH1F("h_380_CT_wO_380_DR09_E_rel_totVis_RMS_d1_cosT_0_950_to_0_975","", n_binsJER, lim_E_rel_low,lim_E_rel_high);
  TH1F* h_380_CT_wO_380_DR09_E_rel_totVis_RMS_d1_cosT_0_975_to_1_00 =  new TH1F("h_380_CT_wO_380_DR09_E_rel_totVis_RMS_d1_cosT_0_975_to_1_00","", n_binsJER, lim_E_rel_low,lim_E_rel_high);

  TH1F* h_380_CT_wO_380_DR10_E_rel_totVis_RMS_d1_cosT_0_to_0_10 =  new TH1F("h_380_CT_wO_380_DR10_E_rel_totVis_RMS_d1_cosT_0_to_0_10","", n_binsJER, lim_E_rel_low,lim_E_rel_high);
  TH1F* h_380_CT_wO_380_DR10_E_rel_totVis_RMS_d1_cosT_0_10_to_0_20 =  new TH1F("h_380_CT_wO_380_DR10_E_rel_totVis_RMS_d1_cosT_0_10_to_0_20","", n_binsJER, lim_E_rel_low,lim_E_rel_high);
  TH1F* h_380_CT_wO_380_DR10_E_rel_totVis_RMS_d1_cosT_0_20_to_0_30 =  new TH1F("h_380_CT_wO_380_DR10_E_rel_totVis_RMS_d1_cosT_0_20_to_0_30","", n_binsJER, lim_E_rel_low,lim_E_rel_high);
  TH1F* h_380_CT_wO_380_DR10_E_rel_totVis_RMS_d1_cosT_0_30_to_0_40 =  new TH1F("h_380_CT_wO_380_DR10_E_rel_totVis_RMS_d1_cosT_0_30_to_0_40","", n_binsJER, lim_E_rel_low,lim_E_rel_high);
  TH1F* h_380_CT_wO_380_DR10_E_rel_totVis_RMS_d1_cosT_0_40_to_0_50 =  new TH1F("h_380_CT_wO_380_DR10_E_rel_totVis_RMS_d1_cosT_0_40_to_0_50","", n_binsJER, lim_E_rel_low,lim_E_rel_high);
  TH1F* h_380_CT_wO_380_DR10_E_rel_totVis_RMS_d1_cosT_0_50_to_0_60 =  new TH1F("h_380_CT_wO_380_DR10_E_rel_totVis_RMS_d1_cosT_0_50_to_0_60","", n_binsJER, lim_E_rel_low,lim_E_rel_high);
  TH1F* h_380_CT_wO_380_DR10_E_rel_totVis_RMS_d1_cosT_0_60_to_0_70 =  new TH1F("h_380_CT_wO_380_DR10_E_rel_totVis_RMS_d1_cosT_0_60_to_0_70","", n_binsJER, lim_E_rel_low,lim_E_rel_high);
  TH1F* h_380_CT_wO_380_DR10_E_rel_totVis_RMS_d1_cosT_0_70_to_0_80 =  new TH1F("h_380_CT_wO_380_DR10_E_rel_totVis_RMS_d1_cosT_0_70_to_0_80","", n_binsJER, lim_E_rel_low,lim_E_rel_high);
  TH1F* h_380_CT_wO_380_DR10_E_rel_totVis_RMS_d1_cosT_0_80_to_0_90 =  new TH1F("h_380_CT_wO_380_DR10_E_rel_totVis_RMS_d1_cosT_0_80_to_0_90","", n_binsJER, lim_E_rel_low,lim_E_rel_high);
  TH1F* h_380_CT_wO_380_DR10_E_rel_totVis_RMS_d1_cosT_0_900_to_0_925 =  new TH1F("h_380_CT_wO_380_DR10_E_rel_totVis_RMS_d1_cosT_0_900_to_0_925","", n_binsJER, lim_E_rel_low,lim_E_rel_high);
  TH1F* h_380_CT_wO_380_DR10_E_rel_totVis_RMS_d1_cosT_0_925_to_0_950 =  new TH1F("h_380_CT_wO_380_DR10_E_rel_totVis_RMS_d1_cosT_0_925_to_0_950","", n_binsJER, lim_E_rel_low,lim_E_rel_high);
  TH1F* h_380_CT_wO_380_DR10_E_rel_totVis_RMS_d1_cosT_0_950_to_0_975 =  new TH1F("h_380_CT_wO_380_DR10_E_rel_totVis_RMS_d1_cosT_0_950_to_0_975","", n_binsJER, lim_E_rel_low,lim_E_rel_high);
  TH1F* h_380_CT_wO_380_DR10_E_rel_totVis_RMS_d1_cosT_0_975_to_1_00 =  new TH1F("h_380_CT_wO_380_DR10_E_rel_totVis_RMS_d1_cosT_0_975_to_1_00","", n_binsJER, lim_E_rel_low,lim_E_rel_high);

  TH1F* h_380_CT_wO_380_DR05_dphi_reco_gen_cosTheta_0_65 =  new TH1F("h_380_CT_wO_380_DR05_dphi_reco_gen_cosTheta_0_65","", n_bins100, -lim_angleDeg,lim_angleDeg);
  TH1F* h_380_CT_wO_380_DR05_dtheta_reco_gen_cosTheta_0_65 =  new TH1F("h_380_CT_wO_380_DR05_dtheta_reco_gen_cosTheta_0_65","", n_bins100, -lim_angleDeg,lim_angleDeg);
  TH1F* h_380_CT_wO_380_DR05_dphi_reco_gen_cosTheta_0_65_to_0_80 =  new TH1F("h_380_CT_wO_380_DR05_dphi_reco_gen_cosTheta_0_65_to_0_80","", n_bins100, -lim_angleDeg,lim_angleDeg);
  TH1F* h_380_CT_wO_380_DR05_dtheta_reco_gen_cosTheta_0_65_to_0_80 =  new TH1F("h_380_CT_wO_380_DR05_dtheta_reco_gen_cosTheta_0_65_to_0_80","", n_bins100, -lim_angleDeg,lim_angleDeg);
  TH1F* h_380_CT_wO_380_DR05_dphi_reco_gen_cosTheta_0_80_to_0_925 =  new TH1F("h_380_CT_wO_380_DR05_dphi_reco_gen_cosTheta_0_80_to_0_925","", n_bins100, -lim_angleDeg,lim_angleDeg);
  TH1F* h_380_CT_wO_380_DR05_dtheta_reco_gen_cosTheta_0_80_to_0_925 =  new TH1F("h_380_CT_wO_380_DR05_dtheta_reco_gen_cosTheta_0_80_to_0_925","", n_bins100, -lim_angleDeg,lim_angleDeg);
  TH1F* h_380_CT_wO_380_DR05_dphi_reco_gen_cosTheta_0_925_to_0_975 =  new TH1F("h_380_CT_wO_380_DR05_dphi_reco_gen_cosTheta_0_925_to_0_975","", n_bins100, -lim_angleDeg,lim_angleDeg);
  TH1F* h_380_CT_wO_380_DR05_dtheta_reco_gen_cosTheta_0_925_to_0_975 =  new TH1F("h_380_CT_wO_380_DR05_dtheta_reco_gen_cosTheta_0_925_to_0_975","", n_bins100, -lim_angleDeg,lim_angleDeg);

  TH1F* h_380_CT_wO_380_DR07_dphi_reco_gen_cosTheta_0_65 =  new TH1F("h_380_CT_wO_380_DR07_dphi_reco_gen_cosTheta_0_65","", n_bins100, -lim_angleDeg,lim_angleDeg);
  TH1F* h_380_CT_wO_380_DR07_dtheta_reco_gen_cosTheta_0_65 =  new TH1F("h_380_CT_wO_380_DR07_dtheta_reco_gen_cosTheta_0_65","", n_bins100, -lim_angleDeg,lim_angleDeg);
  TH1F* h_380_CT_wO_380_DR07_dphi_reco_gen_cosTheta_0_65_to_0_80 =  new TH1F("h_380_CT_wO_380_DR07_dphi_reco_gen_cosTheta_0_65_to_0_80","", n_bins100, -lim_angleDeg,lim_angleDeg);
  TH1F* h_380_CT_wO_380_DR07_dtheta_reco_gen_cosTheta_0_65_to_0_80 =  new TH1F("h_380_CT_wO_380_DR07_dtheta_reco_gen_cosTheta_0_65_to_0_80","", n_bins100, -lim_angleDeg,lim_angleDeg);
  TH1F* h_380_CT_wO_380_DR07_dphi_reco_gen_cosTheta_0_80_to_0_925 =  new TH1F("h_380_CT_wO_380_DR07_dphi_reco_gen_cosTheta_0_80_to_0_925","", n_bins100, -lim_angleDeg,lim_angleDeg);
  TH1F* h_380_CT_wO_380_DR07_dtheta_reco_gen_cosTheta_0_80_to_0_925 =  new TH1F("h_380_CT_wO_380_DR07_dtheta_reco_gen_cosTheta_0_80_to_0_925","", n_bins100, -lim_angleDeg,lim_angleDeg);
  TH1F* h_380_CT_wO_380_DR07_dphi_reco_gen_cosTheta_0_925_to_0_975 =  new TH1F("h_380_CT_wO_380_DR07_dphi_reco_gen_cosTheta_0_925_to_0_975","", n_bins100, -lim_angleDeg,lim_angleDeg);
  TH1F* h_380_CT_wO_380_DR07_dtheta_reco_gen_cosTheta_0_925_to_0_975 =  new TH1F("h_380_CT_wO_380_DR07_dtheta_reco_gen_cosTheta_0_925_to_0_975","", n_bins100, -lim_angleDeg,lim_angleDeg);

  TH1F* h_380_CT_wO_380_DR10_dphi_reco_gen_cosTheta_0_65 =  new TH1F("h_380_CT_wO_380_DR10_dphi_reco_gen_cosTheta_0_65","", n_bins100, -lim_angleDeg,lim_angleDeg);
  TH1F* h_380_CT_wO_380_DR10_dtheta_reco_gen_cosTheta_0_65 =  new TH1F("h_380_CT_wO_380_DR10_dtheta_reco_gen_cosTheta_0_65","", n_bins100, -lim_angleDeg,lim_angleDeg);
  TH1F* h_380_CT_wO_380_DR10_dphi_reco_gen_cosTheta_0_65_to_0_80 =  new TH1F("h_380_CT_wO_380_DR10_dphi_reco_gen_cosTheta_0_65_to_0_80","", n_bins100, -lim_angleDeg,lim_angleDeg);
  TH1F* h_380_CT_wO_380_DR10_dtheta_reco_gen_cosTheta_0_65_to_0_80 =  new TH1F("h_380_CT_wO_380_DR10_dtheta_reco_gen_cosTheta_0_65_to_0_80","", n_bins100, -lim_angleDeg,lim_angleDeg);
  TH1F* h_380_CT_wO_380_DR10_dphi_reco_gen_cosTheta_0_80_to_0_925 =  new TH1F("h_380_CT_wO_380_DR10_dphi_reco_gen_cosTheta_0_80_to_0_925","", n_bins100, -lim_angleDeg,lim_angleDeg);
  TH1F* h_380_CT_wO_380_DR10_dtheta_reco_gen_cosTheta_0_80_to_0_925 =  new TH1F("h_380_CT_wO_380_DR10_dtheta_reco_gen_cosTheta_0_80_to_0_925","", n_bins100, -lim_angleDeg,lim_angleDeg);
  TH1F* h_380_CT_wO_380_DR10_dphi_reco_gen_cosTheta_0_925_to_0_975 =  new TH1F("h_380_CT_wO_380_DR10_dphi_reco_gen_cosTheta_0_925_to_0_975","", n_bins100, -lim_angleDeg,lim_angleDeg);
  TH1F* h_380_CT_wO_380_DR10_dtheta_reco_gen_cosTheta_0_925_to_0_975 =  new TH1F("h_380_CT_wO_380_DR10_dtheta_reco_gen_cosTheta_0_925_to_0_975","", n_bins100, -lim_angleDeg,lim_angleDeg);

  std::vector<TH1F*> hist_vec_380_CT_wO_380;
  hist_vec_380_CT_wO_380.push_back(h_380_CT_wO_380_genjet03_dphi_j1j2);
  hist_vec_380_CT_wO_380.push_back(h_380_CT_wO_380_genjet03_E1_E2_over_E_True);
  hist_vec_380_CT_wO_380.push_back(h_380_CT_wO_380_genjet03_Delta_E1_E2_over_E12);
  hist_vec_380_CT_wO_380.push_back(h_380_CT_wO_380_genjet04_dphi_j1j2);
  hist_vec_380_CT_wO_380.push_back(h_380_CT_wO_380_genjet04_E1_E2_over_E_True);
  hist_vec_380_CT_wO_380.push_back(h_380_CT_wO_380_genjet04_Delta_E1_E2_over_E12);
  hist_vec_380_CT_wO_380.push_back(h_380_CT_wO_380_genjet05_dphi_j1j2);
  hist_vec_380_CT_wO_380.push_back(h_380_CT_wO_380_genjet05_E1_E2_over_E_True);
  hist_vec_380_CT_wO_380.push_back(h_380_CT_wO_380_genjet05_Delta_E1_E2_over_E12);
  hist_vec_380_CT_wO_380.push_back(h_380_CT_wO_380_genjet06_dphi_j1j2);
  hist_vec_380_CT_wO_380.push_back(h_380_CT_wO_380_genjet06_E1_E2_over_E_True);
  hist_vec_380_CT_wO_380.push_back(h_380_CT_wO_380_genjet06_Delta_E1_E2_over_E12);
  hist_vec_380_CT_wO_380.push_back(h_380_CT_wO_380_genjet07_dphi_j1j2);
  hist_vec_380_CT_wO_380.push_back(h_380_CT_wO_380_genjet07_E1_E2_over_E_True);
  hist_vec_380_CT_wO_380.push_back(h_380_CT_wO_380_genjet07_Delta_E1_E2_over_E12);
  hist_vec_380_CT_wO_380.push_back(h_380_CT_wO_380_genjet08_dphi_j1j2);
  hist_vec_380_CT_wO_380.push_back(h_380_CT_wO_380_genjet08_E1_E2_over_E_True);
  hist_vec_380_CT_wO_380.push_back(h_380_CT_wO_380_genjet08_Delta_E1_E2_over_E12);
  hist_vec_380_CT_wO_380.push_back(h_380_CT_wO_380_genjet09_dphi_j1j2);
  hist_vec_380_CT_wO_380.push_back(h_380_CT_wO_380_genjet09_E1_E2_over_E_True);
  hist_vec_380_CT_wO_380.push_back(h_380_CT_wO_380_genjet09_Delta_E1_E2_over_E12);
  hist_vec_380_CT_wO_380.push_back(h_380_CT_wO_380_genjet10_dphi_j1j2);
  hist_vec_380_CT_wO_380.push_back(h_380_CT_wO_380_genjet10_E1_E2_over_E_True);
  hist_vec_380_CT_wO_380.push_back(h_380_CT_wO_380_genjet10_Delta_E1_E2_over_E12);

  hist_vec_380_CT_wO_380.push_back(h_380_CT_wO_380_recojet03_dphi_j1j2);
  hist_vec_380_CT_wO_380.push_back(h_380_CT_wO_380_recojet03_E1_E2_over_E_True);
  hist_vec_380_CT_wO_380.push_back(h_380_CT_wO_380_recojet03_Delta_E1_E2_over_E12);
  hist_vec_380_CT_wO_380.push_back(h_380_CT_wO_380_recojet04_dphi_j1j2);
  hist_vec_380_CT_wO_380.push_back(h_380_CT_wO_380_recojet04_E1_E2_over_E_True);
  hist_vec_380_CT_wO_380.push_back(h_380_CT_wO_380_recojet04_Delta_E1_E2_over_E12);
  hist_vec_380_CT_wO_380.push_back(h_380_CT_wO_380_recojet05_dphi_j1j2);
  hist_vec_380_CT_wO_380.push_back(h_380_CT_wO_380_recojet05_E1_E2_over_E_True);
  hist_vec_380_CT_wO_380.push_back(h_380_CT_wO_380_recojet05_Delta_E1_E2_over_E12);
  hist_vec_380_CT_wO_380.push_back(h_380_CT_wO_380_recojet06_dphi_j1j2);
  hist_vec_380_CT_wO_380.push_back(h_380_CT_wO_380_recojet06_E1_E2_over_E_True);
  hist_vec_380_CT_wO_380.push_back(h_380_CT_wO_380_recojet06_Delta_E1_E2_over_E12);
  hist_vec_380_CT_wO_380.push_back(h_380_CT_wO_380_recojet07_dphi_j1j2);
  hist_vec_380_CT_wO_380.push_back(h_380_CT_wO_380_recojet07_E1_E2_over_E_True);
  hist_vec_380_CT_wO_380.push_back(h_380_CT_wO_380_recojet07_Delta_E1_E2_over_E12);
  hist_vec_380_CT_wO_380.push_back(h_380_CT_wO_380_recojet08_dphi_j1j2);
  hist_vec_380_CT_wO_380.push_back(h_380_CT_wO_380_recojet08_E1_E2_over_E_True);
  hist_vec_380_CT_wO_380.push_back(h_380_CT_wO_380_recojet08_Delta_E1_E2_over_E12);
  hist_vec_380_CT_wO_380.push_back(h_380_CT_wO_380_recojet09_dphi_j1j2);
  hist_vec_380_CT_wO_380.push_back(h_380_CT_wO_380_recojet09_E1_E2_over_E_True);
  hist_vec_380_CT_wO_380.push_back(h_380_CT_wO_380_recojet09_Delta_E1_E2_over_E12);
  hist_vec_380_CT_wO_380.push_back(h_380_CT_wO_380_recojet10_dphi_j1j2);
  hist_vec_380_CT_wO_380.push_back(h_380_CT_wO_380_recojet10_E1_E2_over_E_True);
  hist_vec_380_CT_wO_380.push_back(h_380_CT_wO_380_recojet10_Delta_E1_E2_over_E12);

  hist_vec_380_CT_wO_380.push_back(h_380_CT_wO_380_recojetE_over_genjetE_DR03);
  hist_vec_380_CT_wO_380.push_back(h_380_CT_wO_380_recojetE_over_genjetE_DR04);
  hist_vec_380_CT_wO_380.push_back(h_380_CT_wO_380_recojetE_over_genjetE_DR05);
  hist_vec_380_CT_wO_380.push_back(h_380_CT_wO_380_recojetE_over_genjetE_DR06);
  hist_vec_380_CT_wO_380.push_back(h_380_CT_wO_380_recojetE_over_genjetE_DR07);
  hist_vec_380_CT_wO_380.push_back(h_380_CT_wO_380_recojetE_over_genjetE_DR08);
  hist_vec_380_CT_wO_380.push_back(h_380_CT_wO_380_recojetE_over_genjetE_DR09);
  hist_vec_380_CT_wO_380.push_back(h_380_CT_wO_380_recojetE_over_genjetE_DR10);

  hist_vec_380_CT_wO_380.push_back(h_380_CT_wO_380_dphi_gen_reco_DR05);
  hist_vec_380_CT_wO_380.push_back(h_380_CT_wO_380_dphi_gen_reco_DR06);
  hist_vec_380_CT_wO_380.push_back(h_380_CT_wO_380_dphi_gen_reco_DR07);

  hist_vec_380_CT_wO_380.push_back(h_380_CT_wO_380_DR05_E_rel_totVis_RMS_d1_cosT_0_to_0_10);
  hist_vec_380_CT_wO_380.push_back(h_380_CT_wO_380_DR05_E_rel_totVis_RMS_d1_cosT_0_10_to_0_20);
  hist_vec_380_CT_wO_380.push_back(h_380_CT_wO_380_DR05_E_rel_totVis_RMS_d1_cosT_0_20_to_0_30);
  hist_vec_380_CT_wO_380.push_back(h_380_CT_wO_380_DR05_E_rel_totVis_RMS_d1_cosT_0_30_to_0_40);
  hist_vec_380_CT_wO_380.push_back(h_380_CT_wO_380_DR05_E_rel_totVis_RMS_d1_cosT_0_40_to_0_50);
  hist_vec_380_CT_wO_380.push_back(h_380_CT_wO_380_DR05_E_rel_totVis_RMS_d1_cosT_0_50_to_0_60);
  hist_vec_380_CT_wO_380.push_back(h_380_CT_wO_380_DR05_E_rel_totVis_RMS_d1_cosT_0_60_to_0_70);
  hist_vec_380_CT_wO_380.push_back(h_380_CT_wO_380_DR05_E_rel_totVis_RMS_d1_cosT_0_70_to_0_80);
  hist_vec_380_CT_wO_380.push_back(h_380_CT_wO_380_DR05_E_rel_totVis_RMS_d1_cosT_0_80_to_0_90);
  hist_vec_380_CT_wO_380.push_back(h_380_CT_wO_380_DR05_E_rel_totVis_RMS_d1_cosT_0_900_to_0_925);
  hist_vec_380_CT_wO_380.push_back(h_380_CT_wO_380_DR05_E_rel_totVis_RMS_d1_cosT_0_925_to_0_950);
  hist_vec_380_CT_wO_380.push_back(h_380_CT_wO_380_DR05_E_rel_totVis_RMS_d1_cosT_0_950_to_0_975);
  hist_vec_380_CT_wO_380.push_back(h_380_CT_wO_380_DR05_E_rel_totVis_RMS_d1_cosT_0_975_to_1_00);

  hist_vec_380_CT_wO_380.push_back(h_380_CT_wO_380_DR06_E_rel_totVis_RMS_d1_cosT_0_to_0_10);
  hist_vec_380_CT_wO_380.push_back(h_380_CT_wO_380_DR06_E_rel_totVis_RMS_d1_cosT_0_10_to_0_20);
  hist_vec_380_CT_wO_380.push_back(h_380_CT_wO_380_DR06_E_rel_totVis_RMS_d1_cosT_0_20_to_0_30);
  hist_vec_380_CT_wO_380.push_back(h_380_CT_wO_380_DR06_E_rel_totVis_RMS_d1_cosT_0_30_to_0_40);
  hist_vec_380_CT_wO_380.push_back(h_380_CT_wO_380_DR06_E_rel_totVis_RMS_d1_cosT_0_40_to_0_50);
  hist_vec_380_CT_wO_380.push_back(h_380_CT_wO_380_DR06_E_rel_totVis_RMS_d1_cosT_0_50_to_0_60);
  hist_vec_380_CT_wO_380.push_back(h_380_CT_wO_380_DR06_E_rel_totVis_RMS_d1_cosT_0_60_to_0_70);
  hist_vec_380_CT_wO_380.push_back(h_380_CT_wO_380_DR06_E_rel_totVis_RMS_d1_cosT_0_70_to_0_80);
  hist_vec_380_CT_wO_380.push_back(h_380_CT_wO_380_DR06_E_rel_totVis_RMS_d1_cosT_0_80_to_0_90);
  hist_vec_380_CT_wO_380.push_back(h_380_CT_wO_380_DR06_E_rel_totVis_RMS_d1_cosT_0_900_to_0_925);
  hist_vec_380_CT_wO_380.push_back(h_380_CT_wO_380_DR06_E_rel_totVis_RMS_d1_cosT_0_925_to_0_950);
  hist_vec_380_CT_wO_380.push_back(h_380_CT_wO_380_DR06_E_rel_totVis_RMS_d1_cosT_0_950_to_0_975);
  hist_vec_380_CT_wO_380.push_back(h_380_CT_wO_380_DR06_E_rel_totVis_RMS_d1_cosT_0_975_to_1_00); 

  hist_vec_380_CT_wO_380.push_back(h_380_CT_wO_380_DR07_E_rel_totVis_RMS_d1_cosT_0_to_0_10);
  hist_vec_380_CT_wO_380.push_back(h_380_CT_wO_380_DR07_E_rel_totVis_RMS_d1_cosT_0_10_to_0_20);
  hist_vec_380_CT_wO_380.push_back(h_380_CT_wO_380_DR07_E_rel_totVis_RMS_d1_cosT_0_20_to_0_30);
  hist_vec_380_CT_wO_380.push_back(h_380_CT_wO_380_DR07_E_rel_totVis_RMS_d1_cosT_0_30_to_0_40);
  hist_vec_380_CT_wO_380.push_back(h_380_CT_wO_380_DR07_E_rel_totVis_RMS_d1_cosT_0_40_to_0_50);
  hist_vec_380_CT_wO_380.push_back(h_380_CT_wO_380_DR07_E_rel_totVis_RMS_d1_cosT_0_50_to_0_60);
  hist_vec_380_CT_wO_380.push_back(h_380_CT_wO_380_DR07_E_rel_totVis_RMS_d1_cosT_0_60_to_0_70);
  hist_vec_380_CT_wO_380.push_back(h_380_CT_wO_380_DR07_E_rel_totVis_RMS_d1_cosT_0_70_to_0_80);
  hist_vec_380_CT_wO_380.push_back(h_380_CT_wO_380_DR07_E_rel_totVis_RMS_d1_cosT_0_80_to_0_90);
  hist_vec_380_CT_wO_380.push_back(h_380_CT_wO_380_DR07_E_rel_totVis_RMS_d1_cosT_0_900_to_0_925);
  hist_vec_380_CT_wO_380.push_back(h_380_CT_wO_380_DR07_E_rel_totVis_RMS_d1_cosT_0_925_to_0_950);
  hist_vec_380_CT_wO_380.push_back(h_380_CT_wO_380_DR07_E_rel_totVis_RMS_d1_cosT_0_950_to_0_975);
  hist_vec_380_CT_wO_380.push_back(h_380_CT_wO_380_DR07_E_rel_totVis_RMS_d1_cosT_0_975_to_1_00); 

  hist_vec_380_CT_wO_380.push_back(h_380_CT_wO_380_DR08_E_rel_totVis_RMS_d1_cosT_0_to_0_10);
  hist_vec_380_CT_wO_380.push_back(h_380_CT_wO_380_DR08_E_rel_totVis_RMS_d1_cosT_0_10_to_0_20);
  hist_vec_380_CT_wO_380.push_back(h_380_CT_wO_380_DR08_E_rel_totVis_RMS_d1_cosT_0_20_to_0_30);
  hist_vec_380_CT_wO_380.push_back(h_380_CT_wO_380_DR08_E_rel_totVis_RMS_d1_cosT_0_30_to_0_40);
  hist_vec_380_CT_wO_380.push_back(h_380_CT_wO_380_DR08_E_rel_totVis_RMS_d1_cosT_0_40_to_0_50);
  hist_vec_380_CT_wO_380.push_back(h_380_CT_wO_380_DR08_E_rel_totVis_RMS_d1_cosT_0_50_to_0_60);
  hist_vec_380_CT_wO_380.push_back(h_380_CT_wO_380_DR08_E_rel_totVis_RMS_d1_cosT_0_60_to_0_70);
  hist_vec_380_CT_wO_380.push_back(h_380_CT_wO_380_DR08_E_rel_totVis_RMS_d1_cosT_0_70_to_0_80);
  hist_vec_380_CT_wO_380.push_back(h_380_CT_wO_380_DR08_E_rel_totVis_RMS_d1_cosT_0_80_to_0_90);
  hist_vec_380_CT_wO_380.push_back(h_380_CT_wO_380_DR08_E_rel_totVis_RMS_d1_cosT_0_900_to_0_925);
  hist_vec_380_CT_wO_380.push_back(h_380_CT_wO_380_DR08_E_rel_totVis_RMS_d1_cosT_0_925_to_0_950);
  hist_vec_380_CT_wO_380.push_back(h_380_CT_wO_380_DR08_E_rel_totVis_RMS_d1_cosT_0_950_to_0_975);
  hist_vec_380_CT_wO_380.push_back(h_380_CT_wO_380_DR08_E_rel_totVis_RMS_d1_cosT_0_975_to_1_00); //110

  hist_vec_380_CT_wO_380.push_back(h_380_CT_wO_380_DR09_E_rel_totVis_RMS_d1_cosT_0_to_0_10);
  hist_vec_380_CT_wO_380.push_back(h_380_CT_wO_380_DR09_E_rel_totVis_RMS_d1_cosT_0_10_to_0_20);
  hist_vec_380_CT_wO_380.push_back(h_380_CT_wO_380_DR09_E_rel_totVis_RMS_d1_cosT_0_20_to_0_30);
  hist_vec_380_CT_wO_380.push_back(h_380_CT_wO_380_DR09_E_rel_totVis_RMS_d1_cosT_0_30_to_0_40);
  hist_vec_380_CT_wO_380.push_back(h_380_CT_wO_380_DR09_E_rel_totVis_RMS_d1_cosT_0_40_to_0_50);
  hist_vec_380_CT_wO_380.push_back(h_380_CT_wO_380_DR09_E_rel_totVis_RMS_d1_cosT_0_50_to_0_60);
  hist_vec_380_CT_wO_380.push_back(h_380_CT_wO_380_DR09_E_rel_totVis_RMS_d1_cosT_0_60_to_0_70);
  hist_vec_380_CT_wO_380.push_back(h_380_CT_wO_380_DR09_E_rel_totVis_RMS_d1_cosT_0_70_to_0_80);
  hist_vec_380_CT_wO_380.push_back(h_380_CT_wO_380_DR09_E_rel_totVis_RMS_d1_cosT_0_80_to_0_90);
  hist_vec_380_CT_wO_380.push_back(h_380_CT_wO_380_DR09_E_rel_totVis_RMS_d1_cosT_0_900_to_0_925);
  hist_vec_380_CT_wO_380.push_back(h_380_CT_wO_380_DR09_E_rel_totVis_RMS_d1_cosT_0_925_to_0_950);
  hist_vec_380_CT_wO_380.push_back(h_380_CT_wO_380_DR09_E_rel_totVis_RMS_d1_cosT_0_950_to_0_975);
  hist_vec_380_CT_wO_380.push_back(h_380_CT_wO_380_DR09_E_rel_totVis_RMS_d1_cosT_0_975_to_1_00); //123

  hist_vec_380_CT_wO_380.push_back(h_380_CT_wO_380_DR10_E_rel_totVis_RMS_d1_cosT_0_to_0_10);
  hist_vec_380_CT_wO_380.push_back(h_380_CT_wO_380_DR10_E_rel_totVis_RMS_d1_cosT_0_10_to_0_20);
  hist_vec_380_CT_wO_380.push_back(h_380_CT_wO_380_DR10_E_rel_totVis_RMS_d1_cosT_0_20_to_0_30);
  hist_vec_380_CT_wO_380.push_back(h_380_CT_wO_380_DR10_E_rel_totVis_RMS_d1_cosT_0_30_to_0_40);
  hist_vec_380_CT_wO_380.push_back(h_380_CT_wO_380_DR10_E_rel_totVis_RMS_d1_cosT_0_40_to_0_50);
  hist_vec_380_CT_wO_380.push_back(h_380_CT_wO_380_DR10_E_rel_totVis_RMS_d1_cosT_0_50_to_0_60);
  hist_vec_380_CT_wO_380.push_back(h_380_CT_wO_380_DR10_E_rel_totVis_RMS_d1_cosT_0_60_to_0_70);
  hist_vec_380_CT_wO_380.push_back(h_380_CT_wO_380_DR10_E_rel_totVis_RMS_d1_cosT_0_70_to_0_80);
  hist_vec_380_CT_wO_380.push_back(h_380_CT_wO_380_DR10_E_rel_totVis_RMS_d1_cosT_0_80_to_0_90);
  hist_vec_380_CT_wO_380.push_back(h_380_CT_wO_380_DR10_E_rel_totVis_RMS_d1_cosT_0_900_to_0_925);
  hist_vec_380_CT_wO_380.push_back(h_380_CT_wO_380_DR10_E_rel_totVis_RMS_d1_cosT_0_925_to_0_950);
  hist_vec_380_CT_wO_380.push_back(h_380_CT_wO_380_DR10_E_rel_totVis_RMS_d1_cosT_0_950_to_0_975);
  hist_vec_380_CT_wO_380.push_back(h_380_CT_wO_380_DR10_E_rel_totVis_RMS_d1_cosT_0_975_to_1_00); //136

  hist_vec_380_CT_wO_380.push_back(h_380_CT_wO_380_DR05_dphi_reco_gen_cosTheta_0_65);//137
  hist_vec_380_CT_wO_380.push_back(h_380_CT_wO_380_DR05_dphi_reco_gen_cosTheta_0_65_to_0_80);
  hist_vec_380_CT_wO_380.push_back(h_380_CT_wO_380_DR05_dphi_reco_gen_cosTheta_0_80_to_0_925);
  hist_vec_380_CT_wO_380.push_back(h_380_CT_wO_380_DR05_dphi_reco_gen_cosTheta_0_925_to_0_975);
  hist_vec_380_CT_wO_380.push_back(h_380_CT_wO_380_DR05_dtheta_reco_gen_cosTheta_0_65);
  hist_vec_380_CT_wO_380.push_back(h_380_CT_wO_380_DR05_dtheta_reco_gen_cosTheta_0_65_to_0_80);
  hist_vec_380_CT_wO_380.push_back(h_380_CT_wO_380_DR05_dtheta_reco_gen_cosTheta_0_80_to_0_925);
  hist_vec_380_CT_wO_380.push_back(h_380_CT_wO_380_DR05_dtheta_reco_gen_cosTheta_0_925_to_0_975);

  hist_vec_380_CT_wO_380.push_back(h_380_CT_wO_380_DR07_dphi_reco_gen_cosTheta_0_65);//145
  hist_vec_380_CT_wO_380.push_back(h_380_CT_wO_380_DR07_dphi_reco_gen_cosTheta_0_65_to_0_80);
  hist_vec_380_CT_wO_380.push_back(h_380_CT_wO_380_DR07_dphi_reco_gen_cosTheta_0_80_to_0_925);
  hist_vec_380_CT_wO_380.push_back(h_380_CT_wO_380_DR07_dphi_reco_gen_cosTheta_0_925_to_0_975);
  hist_vec_380_CT_wO_380.push_back(h_380_CT_wO_380_DR07_dtheta_reco_gen_cosTheta_0_65);
  hist_vec_380_CT_wO_380.push_back(h_380_CT_wO_380_DR07_dtheta_reco_gen_cosTheta_0_65_to_0_80);
  hist_vec_380_CT_wO_380.push_back(h_380_CT_wO_380_DR07_dtheta_reco_gen_cosTheta_0_80_to_0_925);
  hist_vec_380_CT_wO_380.push_back(h_380_CT_wO_380_DR07_dtheta_reco_gen_cosTheta_0_925_to_0_975);

  hist_vec_380_CT_wO_380.push_back(h_380_CT_wO_380_DR10_dphi_reco_gen_cosTheta_0_65);//153
  hist_vec_380_CT_wO_380.push_back(h_380_CT_wO_380_DR10_dphi_reco_gen_cosTheta_0_65_to_0_80);
  hist_vec_380_CT_wO_380.push_back(h_380_CT_wO_380_DR10_dphi_reco_gen_cosTheta_0_80_to_0_925);
  hist_vec_380_CT_wO_380.push_back(h_380_CT_wO_380_DR10_dphi_reco_gen_cosTheta_0_925_to_0_975);
  hist_vec_380_CT_wO_380.push_back(h_380_CT_wO_380_DR10_dtheta_reco_gen_cosTheta_0_65);
  hist_vec_380_CT_wO_380.push_back(h_380_CT_wO_380_DR10_dtheta_reco_gen_cosTheta_0_65_to_0_80);
  hist_vec_380_CT_wO_380.push_back(h_380_CT_wO_380_DR10_dtheta_reco_gen_cosTheta_0_80_to_0_925);
  hist_vec_380_CT_wO_380.push_back(h_380_CT_wO_380_DR10_dtheta_reco_gen_cosTheta_0_925_to_0_975);


  for(unsigned int i=0;i<hist_vec_380_CT.size();i++){
    hist_vec_380_CT_wO_380[i]->Sumw2();
  }
  fill_jet_histograms(file_CLIC_380_CT_wO_380,hist_vec_380_CT_wO_380);

  TH1F* h_380_CT_wO_380_DR05_dphi_SigmaCB_summary_histogram=new TH1F("dphiRes_SigmaCBVsCosTheta_CT_wO_380_DR05_380", "#sigma#Delta#phi(j_{reco},j_{true}) vs |cos#theta|", nRegionBinsAngles, pRegionBinEdgesAngles);
  h_380_CT_wO_380_DR05_dphi_SigmaCB_summary_histogram ->SetYTitle("#sigma#Delta#phi(j_{reco},j_{true})");
  h_380_CT_wO_380_DR05_dphi_SigmaCB_summary_histogram->SetXTitle("|cos#theta|");
  h_380_CT_wO_380_DR05_dphi_SigmaCB_summary_histogram->SetLineWidth(2);
  h_380_CT_wO_380_DR05_dphi_SigmaCB_summary_histogram->SetLineColor(kCyan+1);
  h_380_CT_wO_380_DR05_dphi_SigmaCB_summary_histogram->SetLineStyle(2);

  TH1F* h_380_CT_wO_380_DR05_dphi_RMS90_summary_histogram=new TH1F("dphiRes_RMS90VsCosTheta_CT_wO_380_DR05_380", "RMS_{90} #Delta#phi(j_{reco},j_{true}) vs |cos#theta|", nRegionBinsAngles, pRegionBinEdgesAngles);
  h_380_CT_wO_380_DR05_dphi_RMS90_summary_histogram ->SetYTitle("RMS_{90}#Delta#phi(j_{reco},j_{true})");
  h_380_CT_wO_380_DR05_dphi_RMS90_summary_histogram->SetXTitle("|cos#theta|");
  h_380_CT_wO_380_DR05_dphi_RMS90_summary_histogram->SetLineWidth(2);
  h_380_CT_wO_380_DR05_dphi_RMS90_summary_histogram->SetLineColor(kCyan+1);
  h_380_CT_wO_380_DR05_dphi_RMS90_summary_histogram->SetLineStyle(2);

  TH1F* h_380_CT_wO_380_DR07_dphi_SigmaCB_summary_histogram=new TH1F("dphiRes_SigmaCBVsCosTheta_CT_wO_380_DR07_380", "#sigma#Delta#phi(j_{reco},j_{true}) vs |cos#theta|", nRegionBinsAngles, pRegionBinEdgesAngles);
  h_380_CT_wO_380_DR07_dphi_SigmaCB_summary_histogram ->SetYTitle("#sigma#Delta#phi(j_{reco},j_{true})");
  h_380_CT_wO_380_DR07_dphi_SigmaCB_summary_histogram->SetXTitle("|cos#theta|");
  h_380_CT_wO_380_DR07_dphi_SigmaCB_summary_histogram->SetLineWidth(2);
  h_380_CT_wO_380_DR07_dphi_SigmaCB_summary_histogram->SetLineColor(kCyan+1);
  h_380_CT_wO_380_DR07_dphi_SigmaCB_summary_histogram->SetLineStyle(2);

  TH1F* h_380_CT_wO_380_DR07_dphi_RMS90_summary_histogram=new TH1F("dphiRes_RMS90VsCosTheta_CT_wO_380_DR07_380", "RMS_{90} #Delta#phi(j_{reco},j_{true}) vs |cos#theta|", nRegionBinsAngles, pRegionBinEdgesAngles);
  h_380_CT_wO_380_DR07_dphi_RMS90_summary_histogram ->SetYTitle("RMS_{90}#Delta#phi(j_{reco},j_{true})");
  h_380_CT_wO_380_DR07_dphi_RMS90_summary_histogram->SetXTitle("|cos#theta|");
  h_380_CT_wO_380_DR07_dphi_RMS90_summary_histogram->SetLineWidth(2);
  h_380_CT_wO_380_DR07_dphi_RMS90_summary_histogram->SetLineColor(kCyan+1);
  h_380_CT_wO_380_DR07_dphi_RMS90_summary_histogram->SetLineStyle(2);

  TH1F* h_380_CT_wO_380_DR10_dphi_SigmaCB_summary_histogram=new TH1F("dphiRes_SigmaCBVsCosTheta_CT_wO_380_DR10_380", "#sigma#Delta#phi(j_{reco},j_{true}) vs |cos#theta|", nRegionBinsAngles, pRegionBinEdgesAngles);
  h_380_CT_wO_380_DR10_dphi_SigmaCB_summary_histogram ->SetYTitle("#sigma#Delta#phi(j_{reco},j_{true})");
  h_380_CT_wO_380_DR10_dphi_SigmaCB_summary_histogram->SetXTitle("|cos#theta|");
  h_380_CT_wO_380_DR10_dphi_SigmaCB_summary_histogram->SetLineWidth(2);
  h_380_CT_wO_380_DR10_dphi_SigmaCB_summary_histogram->SetLineColor(kCyan+1);
  h_380_CT_wO_380_DR10_dphi_SigmaCB_summary_histogram->SetLineStyle(2);

  TH1F* h_380_CT_wO_380_DR10_dphi_RMS90_summary_histogram=new TH1F("dphiRes_RMS90VsCosTheta_CT_wO_380_DR10_380", "RMS_{90} #Delta#phi(j_{reco},j_{true}) vs |cos#theta|", nRegionBinsAngles, pRegionBinEdgesAngles);
  h_380_CT_wO_380_DR10_dphi_RMS90_summary_histogram ->SetYTitle("RMS_{90}#Delta#phi(j_{reco},j_{true})");
  h_380_CT_wO_380_DR10_dphi_RMS90_summary_histogram->SetXTitle("|cos#theta|");
  h_380_CT_wO_380_DR10_dphi_RMS90_summary_histogram->SetLineWidth(2);
  h_380_CT_wO_380_DR10_dphi_RMS90_summary_histogram->SetLineColor(kCyan+1);
  h_380_CT_wO_380_DR10_dphi_RMS90_summary_histogram->SetLineStyle(2);

  TH1F* h_380_CT_wO_380_DR05_dtheta_SigmaCB_summary_histogram=new TH1F("dthetaRes_SigmaCBVsCosTheta_CT_wO_380_DR05_380", "#sigma#Delta#theta(j_{reco},j_{true}) vs |cos#theta|", nRegionBinsAngles, pRegionBinEdgesAngles);
  h_380_CT_wO_380_DR05_dtheta_SigmaCB_summary_histogram ->SetYTitle("#sigma#Delta#theta(j_{reco},j_{true})");
  h_380_CT_wO_380_DR05_dtheta_SigmaCB_summary_histogram->SetXTitle("|cos#theta|");
  h_380_CT_wO_380_DR05_dtheta_SigmaCB_summary_histogram->SetLineWidth(2);
  h_380_CT_wO_380_DR05_dtheta_SigmaCB_summary_histogram->SetLineColor(kCyan+1);
  h_380_CT_wO_380_DR05_dtheta_SigmaCB_summary_histogram->SetLineStyle(2);

  TH1F* h_380_CT_wO_380_DR05_dtheta_RMS90_summary_histogram=new TH1F("dthetaRes_RMS90VsCosTheta_CT_wO_380_DR05_380", "RMS_{90} #Delta#theta(j_{reco},j_{true}) vs |cos#theta|", nRegionBinsAngles, pRegionBinEdgesAngles);
  h_380_CT_wO_380_DR05_dtheta_RMS90_summary_histogram ->SetYTitle("RMS_{90}#Delta#theta(j_{reco},j_{true})");
  h_380_CT_wO_380_DR05_dtheta_RMS90_summary_histogram->SetXTitle("|cos#theta|");
  h_380_CT_wO_380_DR05_dtheta_RMS90_summary_histogram->SetLineWidth(2);
  h_380_CT_wO_380_DR05_dtheta_RMS90_summary_histogram->SetLineColor(kCyan+1);
  h_380_CT_wO_380_DR05_dtheta_RMS90_summary_histogram->SetLineStyle(2);

  TH1F* h_380_CT_wO_380_DR07_dtheta_SigmaCB_summary_histogram=new TH1F("dthetaRes_SigmaCBVsCosTheta_CT_wO_380_DR07_380", "#sigma#Delta#theta(j_{reco},j_{true}) vs |cos#theta|", nRegionBinsAngles, pRegionBinEdgesAngles);
  h_380_CT_wO_380_DR07_dtheta_SigmaCB_summary_histogram ->SetYTitle("#sigma#Delta#theta(j_{reco},j_{true})");
  h_380_CT_wO_380_DR07_dtheta_SigmaCB_summary_histogram->SetXTitle("|cos#theta|");
  h_380_CT_wO_380_DR07_dtheta_SigmaCB_summary_histogram->SetLineWidth(2);
  h_380_CT_wO_380_DR07_dtheta_SigmaCB_summary_histogram->SetLineColor(kCyan+1);
  h_380_CT_wO_380_DR07_dtheta_SigmaCB_summary_histogram->SetLineStyle(2);

  TH1F* h_380_CT_wO_380_DR07_dtheta_RMS90_summary_histogram=new TH1F("dthetaRes_RMS90VsCosTheta_CT_wO_380_DR07_380", "RMS_{90} #Delta#theta(j_{reco},j_{true}) vs |cos#theta|", nRegionBinsAngles, pRegionBinEdgesAngles);
  h_380_CT_wO_380_DR07_dtheta_RMS90_summary_histogram ->SetYTitle("RMS_{90}#Delta#theta(j_{reco},j_{true})");
  h_380_CT_wO_380_DR07_dtheta_RMS90_summary_histogram->SetXTitle("|cos#theta|");
  h_380_CT_wO_380_DR07_dtheta_RMS90_summary_histogram->SetLineWidth(2);
  h_380_CT_wO_380_DR07_dtheta_RMS90_summary_histogram->SetLineColor(kCyan+1);
  h_380_CT_wO_380_DR07_dtheta_RMS90_summary_histogram->SetLineStyle(2);

  TH1F* h_380_CT_wO_380_DR10_dtheta_SigmaCB_summary_histogram=new TH1F("dthetaRes_SigmaCBVsCosTheta_CT_wO_380_DR10_380", "#sigma#Delta#theta(j_{reco},j_{true}) vs |cos#theta|", nRegionBinsAngles, pRegionBinEdgesAngles);
  h_380_CT_wO_380_DR10_dtheta_SigmaCB_summary_histogram ->SetYTitle("#sigma#Delta#theta(j_{reco},j_{true})");
  h_380_CT_wO_380_DR10_dtheta_SigmaCB_summary_histogram->SetXTitle("|cos#theta|");
  h_380_CT_wO_380_DR10_dtheta_SigmaCB_summary_histogram->SetLineWidth(2);
  h_380_CT_wO_380_DR10_dtheta_SigmaCB_summary_histogram->SetLineColor(kCyan+1);
  h_380_CT_wO_380_DR10_dtheta_SigmaCB_summary_histogram->SetLineStyle(2);

  TH1F* h_380_CT_wO_380_DR10_dtheta_RMS90_summary_histogram=new TH1F("dthetaRes_RMS90VsCosTheta_CT_wO_380_DR10_380", "RMS_{90} #Delta#theta(j_{reco},j_{true}) vs |cos#theta|", nRegionBinsAngles, pRegionBinEdgesAngles);
  h_380_CT_wO_380_DR10_dtheta_RMS90_summary_histogram ->SetYTitle("RMS_{90}#Delta#theta(j_{reco},j_{true})");
  h_380_CT_wO_380_DR10_dtheta_RMS90_summary_histogram->SetXTitle("|cos#theta|");
  h_380_CT_wO_380_DR10_dtheta_RMS90_summary_histogram->SetLineWidth(2);
  h_380_CT_wO_380_DR10_dtheta_RMS90_summary_histogram->SetLineColor(kCyan+1);
  h_380_CT_wO_380_DR10_dtheta_RMS90_summary_histogram->SetLineStyle(2);

  for(int i=137;i<161;i++){
    std::cout<<"ang histo 380 "<<i<<"]"<<std::endl;
   //double sided crystal ball
    TF1* fit_gaus_tmp = new TF1("fit_gaus_tmp", "gaus",-5.,5.);
    hist_vec_380_CT_wO_380[i]->Fit("fit_gaus_tmp","R");
    hist_vec_380_CT_wO_380[i]->GetFunction("fit_gaus_tmp");
    TF1* fdscb_tmp = new TF1("fdscb_tmp",fnc_dscb,-lim_angleDeg,lim_angleDeg,7);
   fdscb_tmp->SetNpx(2000);
    fdscb_tmp->SetParameter(0,fit_gaus_tmp->GetParameter(0));
    //norm
    fdscb_tmp->SetParLimits (0,0.5*fit_gaus_tmp->GetParameter(0),1.5*fit_gaus_tmp->GetParameter(0));
    fdscb_tmp->SetParameter(1,fit_gaus_tmp->GetParameter(1));
    //gaussian mean
    fdscb_tmp->SetParLimits (1,-2.,2.);
    fdscb_tmp->SetParameter(2,fit_gaus_tmp->GetParameter(2));
    fdscb_tmp->SetParLimits(2,fit_gaus_tmp->GetParameter(2)*0.50,1.50*fit_gaus_tmp->GetParameter(2));
    //std::vector<float>sigma2SFit=sigmaGaussianFits2Sigma(hist_vec_380_CT_wO_380[i]);
    //fdscb_tmp->SetParameter(2,sigma2SFit[0]);
    //fdscb_tmp->SetParLimits(2,sigma2SFit[0]*0.50,1.50*sigma2SFit[0]);
    //-a1: parameter, from when the gaussian core should count
    //fdscb_tmp->SetParameter(2,fit_gaus_tmp->GetParameter(2));
    fdscb_tmp->SetParameter (3,3.0);
    fdscb_tmp->SetParLimits (3,0.0,10.0);
    //a2 parameter, up to when the gaussian core should count
    fdscb_tmp->SetParameter (5,3.0);
    fdscb_tmp->SetParLimits (5,0.0,10.0);
    fdscb_tmp->SetParameter(4,5.);
    fdscb_tmp->SetParLimits(4,0.,25.);
    fdscb_tmp->SetParameter(6,5.);
    fdscb_tmp->SetParLimits(6,0.,25.);
    int fitstatus(0); 
    fitstatus = hist_vec_380_CT_wO_380[i]->Fit(fdscb_tmp,"R");
    fdscb_tmp = hist_vec_380_CT_wO_380[i]->GetFunction("fdscb_tmp");
    resolutionTH1=0; 
    resolutionErrorTH1=0;
    meanTH1=0;
    meanErrorTH1=0;
    CalculatePerformanceNoMean( hist_vec_380_CT_wO_380[i], resolutionTH1, resolutionErrorTH1,meanTH1,meanErrorTH1);
    int first_bin_ang=137;
    if(i<141){//dphi DR05
      first_bin_ang=137;
      h_380_CT_wO_380_DR05_dphi_SigmaCB_summary_histogram->SetBinContent(i-first_bin_ang+1,fdscb_tmp->GetParameter(2));
      h_380_CT_wO_380_DR05_dphi_SigmaCB_summary_histogram->SetBinError(i-first_bin_ang+1,fdscb_tmp->GetParError(2));
      h_380_CT_wO_380_DR05_dphi_RMS90_summary_histogram->SetBinContent(i-first_bin_ang+1,resolutionTH1);
      h_380_CT_wO_380_DR05_dphi_RMS90_summary_histogram->SetBinError(i-first_bin_ang+1, resolutionErrorTH1);
    }else if(i<145){//dtheta DR05
      first_bin_ang=141;
      h_380_CT_wO_380_DR05_dtheta_SigmaCB_summary_histogram->SetBinContent(i-first_bin_ang+1,fdscb_tmp->GetParameter(2));
      h_380_CT_wO_380_DR05_dtheta_SigmaCB_summary_histogram->SetBinError(i-first_bin_ang+1,fdscb_tmp->GetParError(2));
      h_380_CT_wO_380_DR05_dtheta_RMS90_summary_histogram->SetBinContent(i-first_bin_ang+1,resolutionTH1);
      h_380_CT_wO_380_DR05_dtheta_RMS90_summary_histogram->SetBinError(i-first_bin_ang+1, resolutionErrorTH1);
    }else if(i<149){//dphi DR07
      first_bin_ang=145;
      h_380_CT_wO_380_DR07_dphi_SigmaCB_summary_histogram->SetBinContent(i-first_bin_ang+1,fdscb_tmp->GetParameter(2));
      h_380_CT_wO_380_DR07_dphi_SigmaCB_summary_histogram->SetBinError(i-first_bin_ang+1,fdscb_tmp->GetParError(2));
      h_380_CT_wO_380_DR07_dphi_RMS90_summary_histogram->SetBinContent(i-first_bin_ang+1,resolutionTH1);
      h_380_CT_wO_380_DR07_dphi_RMS90_summary_histogram->SetBinError(i-first_bin_ang+1, resolutionErrorTH1);
    }else if(i<153){//dtheta DR07
      first_bin_ang=149;
      h_380_CT_wO_380_DR07_dtheta_SigmaCB_summary_histogram->SetBinContent(i-first_bin_ang+1,fdscb_tmp->GetParameter(2));
      h_380_CT_wO_380_DR07_dtheta_SigmaCB_summary_histogram->SetBinError(i-first_bin_ang+1,fdscb_tmp->GetParError(2));
      h_380_CT_wO_380_DR07_dtheta_RMS90_summary_histogram->SetBinContent(i-first_bin_ang+1,resolutionTH1);
      h_380_CT_wO_380_DR07_dtheta_RMS90_summary_histogram->SetBinError(i-first_bin_ang+1, resolutionErrorTH1);
    }else if(i<157){//dphi DR07
      first_bin_ang=153;
      h_380_CT_wO_380_DR10_dphi_SigmaCB_summary_histogram->SetBinContent(i-first_bin_ang+1,fdscb_tmp->GetParameter(2));
      h_380_CT_wO_380_DR10_dphi_SigmaCB_summary_histogram->SetBinError(i-first_bin_ang+1,fdscb_tmp->GetParError(2));
      h_380_CT_wO_380_DR10_dphi_RMS90_summary_histogram->SetBinContent(i-first_bin_ang+1,resolutionTH1);
      h_380_CT_wO_380_DR10_dphi_RMS90_summary_histogram->SetBinError(i-first_bin_ang+1, resolutionErrorTH1);
    }else if(i<161){//dtheta DR07
      first_bin_ang=157;
      h_380_CT_wO_380_DR10_dtheta_SigmaCB_summary_histogram->SetBinContent(i-first_bin_ang+1,fdscb_tmp->GetParameter(2));
      h_380_CT_wO_380_DR10_dtheta_SigmaCB_summary_histogram->SetBinError(i-first_bin_ang+1,fdscb_tmp->GetParError(2));
      h_380_CT_wO_380_DR10_dtheta_RMS90_summary_histogram->SetBinContent(i-first_bin_ang+1,resolutionTH1);
      h_380_CT_wO_380_DR10_dtheta_RMS90_summary_histogram->SetBinError(i-first_bin_ang+1, resolutionErrorTH1);
    }
  }

  TH1F* h_380_CT_wO_380_DR05_E_SigmaCB_summary_histogram=new TH1F("JER_SigmaCBVsCosTheta_CT_wO_380_DR05_380", "RMS_{90}(E_{j}^{reco}/E_{j}^{gen}) / Mean_{90}(E_{j}^{reco}/E_{j}^{gen}) vs |cos#theta|", nRegionBins, pRegionBinEdges);
  h_380_CT_wO_380_DR05_E_SigmaCB_summary_histogram ->SetYTitle("#sigma(E_{j}) / E_{j} [%]");
  h_380_CT_wO_380_DR05_E_SigmaCB_summary_histogram->SetXTitle("|cos#theta|");
  h_380_CT_wO_380_DR05_E_SigmaCB_summary_histogram->SetLineWidth(2);
  h_380_CT_wO_380_DR05_E_SigmaCB_summary_histogram->SetLineColor(kOrange);
  h_380_CT_wO_380_DR05_E_SigmaCB_summary_histogram->SetLineStyle(2);
  TH1F* h_380_CT_wO_380_DR05_E_RMS90_summary_histogram=new TH1F("JER_RMS90VsCosTheta_CT_wO_380_DR05_380", "RMS_{90}(E_{j}^{reco}/E_{j}^{gen}) / Mean_{90}(E_{j}^{reco}/E_{j}^{gen}) vs |cos#theta|", nRegionBins, pRegionBinEdges);
  h_380_CT_wO_380_DR05_E_RMS90_summary_histogram ->SetYTitle("RMS_{90}(E_{j}^{reco}/E_{j}^{gen}) / Mean_{90}(E_{j}^{reco}/E_{j}^{gen}) [%]");
  h_380_CT_wO_380_DR05_E_RMS90_summary_histogram->SetXTitle("|cos#theta|");
  h_380_CT_wO_380_DR05_E_RMS90_summary_histogram->SetLineWidth(2);
  h_380_CT_wO_380_DR05_E_RMS90_summary_histogram->SetLineColor(kRed);
  h_380_CT_wO_380_DR05_E_RMS90_summary_histogram->SetLineStyle(2);

  TH1F* h_380_CT_wO_380_DR05_E_RMS_summary_histogram=new TH1F("JER_RMSVsCosTheta_CT_wO_380_DR05_380", "RMS(E_{j}) / Mean(E_{j}) vs |cos#theta|", nRegionBins, pRegionBinEdges);
  h_380_CT_wO_380_DR05_E_RMS_summary_histogram ->SetYTitle("RMS(E_{j}) / Mean(E_{j}) [%]");
  h_380_CT_wO_380_DR05_E_RMS_summary_histogram->SetXTitle("|cos#theta|");
  h_380_CT_wO_380_DR05_E_RMS_summary_histogram->SetLineWidth(2);
  h_380_CT_wO_380_DR05_E_RMS_summary_histogram->SetLineColor(kRed);
  h_380_CT_wO_380_DR05_E_RMS_summary_histogram->SetLineStyle(2);

  TH1F* h_380_CT_wO_380_DR05_E_JER_Mean_summary_histogram=new TH1F("JER_MeanVsCosTheta_CT_wO_380_DR05_380", "Mean(E_{tot}^{RECO}/E_{tot}^{true}) vs |cos#theta|", nRegionBins, pRegionBinEdges);
  h_380_CT_wO_380_DR05_E_JER_Mean_summary_histogram->SetYTitle("Mean(E_{tot}^{RECO}/E_{tot}^{true})");
  h_380_CT_wO_380_DR05_E_JER_Mean_summary_histogram->SetXTitle("|cos#theta|");
  h_380_CT_wO_380_DR05_E_JER_Mean_summary_histogram->SetLineWidth(2);
  h_380_CT_wO_380_DR05_E_JER_Mean_summary_histogram->SetLineColor(kRed);
  h_380_CT_wO_380_DR05_E_JER_Mean_summary_histogram->SetLineStyle(2);

  firstbin=59;
  for(int i=firstbin;i<(firstbin+13);i++){
    resolutionTH1=0; 
    resolutionErrorTH1=0;
    meanTH1=0;
    meanErrorTH1=0;
    CalculatePerformance( hist_vec_380_CT_wO_380[i], resolutionTH1, resolutionErrorTH1,meanTH1,meanErrorTH1);
    h_380_CT_wO_380_DR05_E_RMS90_summary_histogram->SetBinContent(i-firstbin+1,resolutionTH1/sqrt(2.));
    h_380_CT_wO_380_DR05_E_RMS90_summary_histogram ->SetBinError(i-firstbin+1, resolutionErrorTH1/sqrt(2.));
    h_380_CT_wO_380_DR05_E_RMS_summary_histogram->SetBinContent(i-firstbin+1,hist_vec_380_CT_wO_380[i]->GetRMS()*100. );
    h_380_CT_wO_380_DR05_E_RMS_summary_histogram ->SetBinError(i-firstbin+1, hist_vec_380_CT_wO_380[i]->GetRMSError()*100.);
    h_380_CT_wO_380_DR05_E_JER_Mean_summary_histogram->SetBinContent(i-firstbin+1,hist_vec_380_CT_wO_380[i]->GetMean());
    h_380_CT_wO_380_DR05_E_JER_Mean_summary_histogram->SetBinError(i-firstbin+1,hist_vec_380_CT_wO_380[i]->GetMeanError());
    //double sided crystal ball
    TF1* fit_gaus_tmp = new TF1("fit_gaus_tmp", "gaus",0.50,1.50);
    hist_vec_380_CT_wO_380[i]->Fit("fit_gaus_tmp","R");
    hist_vec_380_CT_wO_380[i]->GetFunction("fit_gaus_tmp");

    TF1* fdscb_tmp = new TF1("fdscb_tmp",fnc_dscb,0.,3.,7);
   fdscb_tmp->SetNpx(1000);
    fdscb_tmp->SetParameter(0,fit_gaus_tmp->GetParameter(0));
    //norm
    fdscb_tmp->SetParLimits (0,0.5*fit_gaus_tmp->GetParameter(0),1.5*fit_gaus_tmp->GetParameter(0));
    fdscb_tmp->SetParameter(1,fit_gaus_tmp->GetParameter(1));
    //gaussian mean
    fdscb_tmp->SetParLimits (1,0.8,1.2);
    //fdscb_tmp->SetParameter(2,fit_gaus_tmp->GetParameter(2));
    //fdscb_tmp->SetParLimits(2,fit_gaus_tmp->GetParameter(2)*0.50,1.50*fit_gaus_tmp->GetParameter(2));
    std::vector<float>sigma2SFit=sigmaGaussianFits2Sigma(hist_vec_380_CT_wO_380[i]);
    fdscb_tmp->SetParameter(2,sigma2SFit[0]);
    fdscb_tmp->SetParLimits(2,sigma2SFit[0]*0.50,1.50*sigma2SFit[0]);
    //-a1: parameter, from when the gaussian core should count
    fdscb_tmp->SetParameter(2,fit_gaus_tmp->GetParameter(2));
    fdscb_tmp->SetParameter (3,3.0);
    fdscb_tmp->SetParLimits (3,0.0,10.0);
    //a2 parameter, up to when the gaussian core should count
    fdscb_tmp->SetParameter (5,3.0);
    fdscb_tmp->SetParLimits (5,0.0,10.0);
    fdscb_tmp->SetParameter(4,5.);
    fdscb_tmp->SetParLimits(4,0.,25.);
    fdscb_tmp->SetParameter(6,5.);
    fdscb_tmp->SetParLimits(6,0.,25.);
    int fitstatus(0); 
    fitstatus = hist_vec_380_CT_wO_380[i]->Fit(fdscb_tmp,"R");
    fdscb_tmp = hist_vec_380_CT_wO_380[i]->GetFunction("fdscb_tmp");
    h_380_CT_wO_380_DR05_E_SigmaCB_summary_histogram->SetBinContent(i-firstbin+1,fdscb_tmp->GetParameter(2)*100. );
    h_380_CT_wO_380_DR05_E_SigmaCB_summary_histogram->SetBinError(i-firstbin+1,fdscb_tmp->GetParError(2)*100. );
  }  
  TH1F* h_380_CT_wO_380_DR06_E_SigmaCB_summary_histogram=new TH1F("JER_SigmaCBVsCosTheta_CT_wO_380_DR06_380", "RMS_{90}(E_{j}^{reco}/E_{j}^{gen}) / Mean_{90}(E_{j}^{reco}/E_{j}^{gen}) vs |cos#theta|", nRegionBins, pRegionBinEdges);
  h_380_CT_wO_380_DR06_E_SigmaCB_summary_histogram ->SetYTitle("#sigma(E_{j}) / E_{j} [%]");
  h_380_CT_wO_380_DR06_E_SigmaCB_summary_histogram->SetXTitle("|cos#theta|");
  h_380_CT_wO_380_DR06_E_SigmaCB_summary_histogram->SetLineWidth(2);
  h_380_CT_wO_380_DR06_E_SigmaCB_summary_histogram->SetLineColor(kOrange);
  h_380_CT_wO_380_DR06_E_SigmaCB_summary_histogram->SetLineStyle(2);
  TH1F* h_380_CT_wO_380_DR06_E_RMS90_summary_histogram=new TH1F("JER_RMS90VsCosTheta_CT_wO_380_DR06_380", "RMS_{90}(E_{j}^{reco}/E_{j}^{gen}) / Mean_{90}(E_{j}^{reco}/E_{j}^{gen}) vs |cos#theta|", nRegionBins, pRegionBinEdges);
  h_380_CT_wO_380_DR06_E_RMS90_summary_histogram ->SetYTitle("RMS_{90}(E_{j}^{reco}/E_{j}^{gen}) / Mean_{90}(E_{j}^{reco}/E_{j}^{gen}) [%]");
  h_380_CT_wO_380_DR06_E_RMS90_summary_histogram->SetXTitle("|cos#theta|");
  h_380_CT_wO_380_DR06_E_RMS90_summary_histogram->SetLineWidth(2);
  h_380_CT_wO_380_DR06_E_RMS90_summary_histogram->SetLineColor(kRed);
  h_380_CT_wO_380_DR06_E_RMS90_summary_histogram->SetLineStyle(2);

  TH1F* h_380_CT_wO_380_DR06_E_RMS_summary_histogram=new TH1F("JER_RMSVsCosTheta_CT_wO_380_DR06_380", "RMS(E_{j}) / Mean(E_{j}) vs |cos#theta|", nRegionBins, pRegionBinEdges);
  h_380_CT_wO_380_DR06_E_RMS_summary_histogram ->SetYTitle("RMS(E_{j}) / Mean(E_{j}) [%]");
  h_380_CT_wO_380_DR06_E_RMS_summary_histogram->SetXTitle("|cos#theta|");
  h_380_CT_wO_380_DR06_E_RMS_summary_histogram->SetLineWidth(2);
  h_380_CT_wO_380_DR06_E_RMS_summary_histogram->SetLineColor(kRed);
  h_380_CT_wO_380_DR06_E_RMS_summary_histogram->SetLineStyle(2);

  TH1F* h_380_CT_wO_380_DR06_E_JER_Mean_summary_histogram=new TH1F("JER_MeanVsCosTheta_CT_wO_380_DR06_380", "Mean(E_{tot}^{RECO}/E_{tot}^{true}) vs |cos#theta|", nRegionBins, pRegionBinEdges);
  h_380_CT_wO_380_DR06_E_JER_Mean_summary_histogram->SetYTitle("Mean(E_{tot}^{RECO}/E_{tot}^{true})");
  h_380_CT_wO_380_DR06_E_JER_Mean_summary_histogram->SetXTitle("|cos#theta|");
  h_380_CT_wO_380_DR06_E_JER_Mean_summary_histogram->SetLineWidth(2);
  h_380_CT_wO_380_DR06_E_JER_Mean_summary_histogram->SetLineColor(kRed);
  h_380_CT_wO_380_DR06_E_JER_Mean_summary_histogram->SetLineStyle(2);
  firstbin=72;
  for(int i=firstbin;i<(firstbin+13);i++){
    resolutionTH1=0; 
    resolutionErrorTH1=0;
    meanTH1=0;
    meanErrorTH1=0;
    CalculatePerformance( hist_vec_380_CT_wO_380[i], resolutionTH1, resolutionErrorTH1,meanTH1,meanErrorTH1);
    h_380_CT_wO_380_DR06_E_RMS90_summary_histogram->SetBinContent(i-firstbin+1,resolutionTH1/sqrt(2.));
    h_380_CT_wO_380_DR06_E_RMS90_summary_histogram ->SetBinError(i-firstbin+1, resolutionErrorTH1/sqrt(2.));
    h_380_CT_wO_380_DR06_E_RMS_summary_histogram->SetBinContent(i-firstbin+1,hist_vec_380_CT_wO_380[i]->GetRMS()*100. );
    h_380_CT_wO_380_DR06_E_RMS_summary_histogram ->SetBinError(i-firstbin+1, hist_vec_380_CT_wO_380[i]->GetRMSError()*100.);
    h_380_CT_wO_380_DR06_E_JER_Mean_summary_histogram->SetBinContent(i-firstbin+1,hist_vec_380_CT_wO_380[i]->GetMean());
    h_380_CT_wO_380_DR06_E_JER_Mean_summary_histogram->SetBinError(i-firstbin+1,hist_vec_380_CT_wO_380[i]->GetMeanError());
    //double sided crystal ball
    TF1* fit_gaus_tmp = new TF1("fit_gaus_tmp", "gaus",0.50,1.50);
    hist_vec_380_CT_wO_380[i]->Fit("fit_gaus_tmp","R");
    hist_vec_380_CT_wO_380[i]->GetFunction("fit_gaus_tmp");

    TF1* fdscb_tmp = new TF1("fdscb_tmp",fnc_dscb,0.,3.,7);
   fdscb_tmp->SetNpx(1000);
    fdscb_tmp->SetParameter(0,fit_gaus_tmp->GetParameter(0));
    //norm
    fdscb_tmp->SetParLimits (0,0.5*fit_gaus_tmp->GetParameter(0),1.5*fit_gaus_tmp->GetParameter(0));
    fdscb_tmp->SetParameter(1,fit_gaus_tmp->GetParameter(1));
    //gaussian mean
    fdscb_tmp->SetParLimits (1,0.8,1.2);
    //fdscb_tmp->SetParameter(2,fit_gaus_tmp->GetParameter(2));
    //fdscb_tmp->SetParLimits(2,fit_gaus_tmp->GetParameter(2)*0.50,1.50*fit_gaus_tmp->GetParameter(2));
    std::vector<float>sigma2SFit=sigmaGaussianFits2Sigma(hist_vec_380_CT_wO_380[i]);
    fdscb_tmp->SetParameter(2,sigma2SFit[0]);
    fdscb_tmp->SetParLimits(2,sigma2SFit[0]*0.50,1.50*sigma2SFit[0]);
    //-a1: parameter, from when the gaussian core should count
    fdscb_tmp->SetParameter(2,fit_gaus_tmp->GetParameter(2));
    fdscb_tmp->SetParameter (3,3.0);
    fdscb_tmp->SetParLimits (3,0.0,10.0);
    //a2 parameter, up to when the gaussian core should count
    fdscb_tmp->SetParameter (5,3.0);
    fdscb_tmp->SetParLimits (5,0.0,10.0);
    fdscb_tmp->SetParameter(4,5.);
    fdscb_tmp->SetParLimits(4,0.,25.);
    fdscb_tmp->SetParameter(6,5.);
    fdscb_tmp->SetParLimits(6,0.,25.);
    int fitstatus(0); 
    fitstatus = hist_vec_380_CT_wO_380[i]->Fit(fdscb_tmp,"R");
    fdscb_tmp = hist_vec_380_CT_wO_380[i]->GetFunction("fdscb_tmp");
    h_380_CT_wO_380_DR06_E_SigmaCB_summary_histogram->SetBinContent(i-firstbin+1,fdscb_tmp->GetParameter(2)*100. );
    h_380_CT_wO_380_DR06_E_SigmaCB_summary_histogram->SetBinError(i-firstbin+1,fdscb_tmp->GetParError(2)*100. );
  }  
  TH1F* h_380_CT_wO_380_DR07_E_SigmaCB_summary_histogram=new TH1F("JER_SigmaCBVsCosTheta_CT_wO_380_DR07_380", "RMS_{90}(E_{j}^{reco}/E_{j}^{gen}) / Mean_{90}(E_{j}^{reco}/E_{j}^{gen}) vs |cos#theta|", nRegionBins, pRegionBinEdges);
  h_380_CT_wO_380_DR07_E_SigmaCB_summary_histogram ->SetYTitle("#sigma(E_{j}) / E_{j} [%]");
  h_380_CT_wO_380_DR07_E_SigmaCB_summary_histogram->SetXTitle("|cos#theta|");
  h_380_CT_wO_380_DR07_E_SigmaCB_summary_histogram->SetLineWidth(2);
  h_380_CT_wO_380_DR07_E_SigmaCB_summary_histogram->SetLineColor(kOrange);
  h_380_CT_wO_380_DR07_E_SigmaCB_summary_histogram->SetLineStyle(2);
  TH1F* h_380_CT_wO_380_DR07_E_RMS90_summary_histogram=new TH1F("JER_RMS90VsCosTheta_CT_wO_380_DR07_380", "RMS_{90}(E_{j}^{reco}/E_{j}^{gen}) / Mean_{90}(E_{j}^{reco}/E_{j}^{gen}) vs |cos#theta|", nRegionBins, pRegionBinEdges);
  h_380_CT_wO_380_DR07_E_RMS90_summary_histogram ->SetYTitle("RMS_{90}(E_{j}^{reco}/E_{j}^{gen}) / Mean_{90}(E_{j}^{reco}/E_{j}^{gen}) [%]");
  h_380_CT_wO_380_DR07_E_RMS90_summary_histogram->SetXTitle("|cos#theta|");
  h_380_CT_wO_380_DR07_E_RMS90_summary_histogram->SetLineWidth(2);
  h_380_CT_wO_380_DR07_E_RMS90_summary_histogram->SetLineColor(kRed);
  h_380_CT_wO_380_DR07_E_RMS90_summary_histogram->SetLineStyle(2);

  TH1F* h_380_CT_wO_380_DR07_E_RMS_summary_histogram=new TH1F("JER_RMSVsCosTheta_CT_wO_380_DR07_380", "RMS(E_{j}) / Mean(E_{j}) vs |cos#theta|", nRegionBins, pRegionBinEdges);
  h_380_CT_wO_380_DR07_E_RMS_summary_histogram ->SetYTitle("RMS(E_{j}) / Mean(E_{j}) [%]");
  h_380_CT_wO_380_DR07_E_RMS_summary_histogram->SetXTitle("|cos#theta|");
  h_380_CT_wO_380_DR07_E_RMS_summary_histogram->SetLineWidth(2);
  h_380_CT_wO_380_DR07_E_RMS_summary_histogram->SetLineColor(kRed);
  h_380_CT_wO_380_DR07_E_RMS_summary_histogram->SetLineStyle(2);

  TH1F* h_380_CT_wO_380_DR07_E_JER_Mean_summary_histogram=new TH1F("JER_MeanVsCosTheta_CT_wO_380_DR07_380", "Mean(E_{tot}^{RECO}/E_{tot}^{true}) vs |cos#theta|", nRegionBins, pRegionBinEdges);
  h_380_CT_wO_380_DR07_E_JER_Mean_summary_histogram->SetYTitle("Mean(E_{tot}^{RECO}/E_{tot}^{true})");
  h_380_CT_wO_380_DR07_E_JER_Mean_summary_histogram->SetXTitle("|cos#theta|");
  h_380_CT_wO_380_DR07_E_JER_Mean_summary_histogram->SetLineWidth(2);
  h_380_CT_wO_380_DR07_E_JER_Mean_summary_histogram->SetLineColor(kRed);
  h_380_CT_wO_380_DR07_E_JER_Mean_summary_histogram->SetLineStyle(2);
  firstbin=85;
  for(int i=firstbin;i<(firstbin+13);i++){
    resolutionTH1=0; 
    resolutionErrorTH1=0;
    meanTH1=0;
    meanErrorTH1=0;
    CalculatePerformance( hist_vec_380_CT_wO_380[i], resolutionTH1, resolutionErrorTH1,meanTH1,meanErrorTH1);
    h_380_CT_wO_380_DR07_E_RMS90_summary_histogram->SetBinContent(i-firstbin+1,resolutionTH1/sqrt(2.));
    h_380_CT_wO_380_DR07_E_RMS90_summary_histogram ->SetBinError(i-firstbin+1, resolutionErrorTH1/sqrt(2.));
    h_380_CT_wO_380_DR07_E_RMS_summary_histogram->SetBinContent(i-firstbin+1,hist_vec_380_CT_wO_380[i]->GetRMS()*100. );
    h_380_CT_wO_380_DR07_E_RMS_summary_histogram ->SetBinError(i-firstbin+1, hist_vec_380_CT_wO_380[i]->GetRMSError()*100.);
    h_380_CT_wO_380_DR07_E_JER_Mean_summary_histogram->SetBinContent(i-firstbin+1,hist_vec_380_CT_wO_380[i]->GetMean());
    h_380_CT_wO_380_DR07_E_JER_Mean_summary_histogram->SetBinError(i-firstbin+1,hist_vec_380_CT_wO_380[i]->GetMeanError());
    //double sided crystal ball
    TF1* fit_gaus_tmp = new TF1("fit_gaus_tmp", "gaus",0.50,1.50);
    hist_vec_380_CT_wO_380[i]->Fit("fit_gaus_tmp","R");
    hist_vec_380_CT_wO_380[i]->GetFunction("fit_gaus_tmp");

    TF1* fdscb_tmp = new TF1("fdscb_tmp",fnc_dscb,0.,3.,7);
   fdscb_tmp->SetNpx(1000);
    fdscb_tmp->SetParameter(0,fit_gaus_tmp->GetParameter(0));
    //norm
    fdscb_tmp->SetParLimits (0,0.5*fit_gaus_tmp->GetParameter(0),1.5*fit_gaus_tmp->GetParameter(0));
    fdscb_tmp->SetParameter(1,fit_gaus_tmp->GetParameter(1));
    //gaussian mean
    fdscb_tmp->SetParLimits (1,0.8,1.2);
    //fdscb_tmp->SetParameter(2,fit_gaus_tmp->GetParameter(2));
    //fdscb_tmp->SetParLimits(2,fit_gaus_tmp->GetParameter(2)*0.50,1.50*fit_gaus_tmp->GetParameter(2));
    std::vector<float>sigma2SFit=sigmaGaussianFits2Sigma(hist_vec_380_CT_wO_380[i]);
    fdscb_tmp->SetParameter(2,sigma2SFit[0]);
    fdscb_tmp->SetParLimits(2,sigma2SFit[0]*0.50,1.50*sigma2SFit[0]);
    //-a1: parameter, from when the gaussian core should count
    fdscb_tmp->SetParameter(2,fit_gaus_tmp->GetParameter(2));
    fdscb_tmp->SetParameter (3,3.0);
    fdscb_tmp->SetParLimits (3,0.0,10.0);
    //a2 parameter, up to when the gaussian core should count
    fdscb_tmp->SetParameter (5,3.0);
    fdscb_tmp->SetParLimits (5,0.0,10.0);
    fdscb_tmp->SetParameter(4,5.);
    fdscb_tmp->SetParLimits(4,0.,25.);
    fdscb_tmp->SetParameter(6,5.);
    fdscb_tmp->SetParLimits(6,0.,25.);
    int fitstatus(0); 
    fitstatus = hist_vec_380_CT_wO_380[i]->Fit(fdscb_tmp,"R");
    fdscb_tmp = hist_vec_380_CT_wO_380[i]->GetFunction("fdscb_tmp");
    h_380_CT_wO_380_DR07_E_SigmaCB_summary_histogram->SetBinContent(i-firstbin+1,fdscb_tmp->GetParameter(2)*100. );
    h_380_CT_wO_380_DR07_E_SigmaCB_summary_histogram->SetBinError(i-firstbin+1,fdscb_tmp->GetParError(2)*100. );
  }  

  TH1F* h_380_CT_wO_380_DR08_E_SigmaCB_summary_histogram=new TH1F("JER_SigmaCBVsCosTheta_CT_wO_380_DR08_380", "RMS_{90}(E_{j}^{reco}/E_{j}^{gen}) / Mean_{90}(E_{j}^{reco}/E_{j}^{gen}) vs |cos#theta|", nRegionBins, pRegionBinEdges);
  h_380_CT_wO_380_DR08_E_SigmaCB_summary_histogram ->SetYTitle("#sigma(E_{j}) / E_{j} [%]");
  h_380_CT_wO_380_DR08_E_SigmaCB_summary_histogram->SetXTitle("|cos#theta|");
  h_380_CT_wO_380_DR08_E_SigmaCB_summary_histogram->SetLineWidth(2);
  h_380_CT_wO_380_DR08_E_SigmaCB_summary_histogram->SetLineColor(kOrange);
  h_380_CT_wO_380_DR08_E_SigmaCB_summary_histogram->SetLineStyle(2);
  TH1F* h_380_CT_wO_380_DR08_E_RMS90_summary_histogram=new TH1F("JER_RMS90VsCosTheta_CT_wO_380_DR08_380", "RMS_{90}(E_{j}^{reco}/E_{j}^{gen}) / Mean_{90}(E_{j}^{reco}/E_{j}^{gen}) vs |cos#theta|", nRegionBins, pRegionBinEdges);
  h_380_CT_wO_380_DR08_E_RMS90_summary_histogram ->SetYTitle("RMS_{90}(E_{j}^{reco}/E_{j}^{gen}) / Mean_{90}(E_{j}^{reco}/E_{j}^{gen}) [%]");
  h_380_CT_wO_380_DR08_E_RMS90_summary_histogram->SetXTitle("|cos#theta|");
  h_380_CT_wO_380_DR08_E_RMS90_summary_histogram->SetLineWidth(2);
  h_380_CT_wO_380_DR08_E_RMS90_summary_histogram->SetLineColor(kRed);
  h_380_CT_wO_380_DR08_E_RMS90_summary_histogram->SetLineStyle(2);

  TH1F* h_380_CT_wO_380_DR08_E_RMS_summary_histogram=new TH1F("JER_RMSVsCosTheta_CT_wO_380_DR08_380", "RMS(E_{j}) / Mean(E_{j}) vs |cos#theta|", nRegionBins, pRegionBinEdges);
  h_380_CT_wO_380_DR08_E_RMS_summary_histogram ->SetYTitle("RMS(E_{j}) / Mean(E_{j}) [%]");
  h_380_CT_wO_380_DR08_E_RMS_summary_histogram->SetXTitle("|cos#theta|");
  h_380_CT_wO_380_DR08_E_RMS_summary_histogram->SetLineWidth(2);
  h_380_CT_wO_380_DR08_E_RMS_summary_histogram->SetLineColor(kRed);
  h_380_CT_wO_380_DR08_E_RMS_summary_histogram->SetLineStyle(2);

  TH1F* h_380_CT_wO_380_DR08_E_JER_Mean_summary_histogram=new TH1F("JER_MeanVsCosTheta_CT_wO_380_DR08_380", "Mean(E_{tot}^{RECO}/E_{tot}^{true}) vs |cos#theta|", nRegionBins, pRegionBinEdges);
  h_380_CT_wO_380_DR08_E_JER_Mean_summary_histogram->SetYTitle("Mean(E_{tot}^{RECO}/E_{tot}^{true})");
  h_380_CT_wO_380_DR08_E_JER_Mean_summary_histogram->SetXTitle("|cos#theta|");
  h_380_CT_wO_380_DR08_E_JER_Mean_summary_histogram->SetLineWidth(2);
  h_380_CT_wO_380_DR08_E_JER_Mean_summary_histogram->SetLineColor(kRed);
  h_380_CT_wO_380_DR08_E_JER_Mean_summary_histogram->SetLineStyle(2);
  firstbin=98;
  for(int i=firstbin;i<(firstbin+13);i++){
    resolutionTH1=0; 
    resolutionErrorTH1=0;
    meanTH1=0;
    meanErrorTH1=0;
    CalculatePerformance( hist_vec_380_CT_wO_380[i], resolutionTH1, resolutionErrorTH1,meanTH1,meanErrorTH1);
    h_380_CT_wO_380_DR08_E_RMS90_summary_histogram->SetBinContent(i-firstbin+1,resolutionTH1/sqrt(2.));
    h_380_CT_wO_380_DR08_E_RMS90_summary_histogram ->SetBinError(i-firstbin+1, resolutionErrorTH1/sqrt(2.));
    h_380_CT_wO_380_DR08_E_RMS_summary_histogram->SetBinContent(i-firstbin+1,hist_vec_380_CT_wO_380[i]->GetRMS()*100. );
    h_380_CT_wO_380_DR08_E_RMS_summary_histogram ->SetBinError(i-firstbin+1, hist_vec_380_CT_wO_380[i]->GetRMSError()*100.);
    h_380_CT_wO_380_DR08_E_JER_Mean_summary_histogram->SetBinContent(i-firstbin+1,hist_vec_380_CT_wO_380[i]->GetMean());
    h_380_CT_wO_380_DR08_E_JER_Mean_summary_histogram->SetBinError(i-firstbin+1,hist_vec_380_CT_wO_380[i]->GetMeanError());
    //double sided crystal ball
    TF1* fit_gaus_tmp = new TF1("fit_gaus_tmp", "gaus",0.50,1.50);
    hist_vec_380_CT_wO_380[i]->Fit("fit_gaus_tmp","R");
    hist_vec_380_CT_wO_380[i]->GetFunction("fit_gaus_tmp");

    TF1* fdscb_tmp = new TF1("fdscb_tmp",fnc_dscb,0.,3.,7);
   fdscb_tmp->SetNpx(1000);
    fdscb_tmp->SetParameter(0,fit_gaus_tmp->GetParameter(0));
    //norm
    fdscb_tmp->SetParLimits (0,0.5*fit_gaus_tmp->GetParameter(0),1.5*fit_gaus_tmp->GetParameter(0));
    fdscb_tmp->SetParameter(1,fit_gaus_tmp->GetParameter(1));
    //gaussian mean
    fdscb_tmp->SetParLimits (1,0.8,1.2);
    //fdscb_tmp->SetParameter(2,fit_gaus_tmp->GetParameter(2));
    //fdscb_tmp->SetParLimits(2,fit_gaus_tmp->GetParameter(2)*0.50,1.50*fit_gaus_tmp->GetParameter(2));
    std::vector<float>sigma2SFit=sigmaGaussianFits2Sigma(hist_vec_380_CT_wO_380[i]);
    fdscb_tmp->SetParameter(2,sigma2SFit[0]);
    fdscb_tmp->SetParLimits(2,sigma2SFit[0]*0.50,1.50*sigma2SFit[0]);
    //-a1: parameter, from when the gaussian core should count
    fdscb_tmp->SetParameter(2,fit_gaus_tmp->GetParameter(2));
    fdscb_tmp->SetParameter (3,3.0);
    fdscb_tmp->SetParLimits (3,0.0,10.0);
    //a2 parameter, up to when the gaussian core should count
    fdscb_tmp->SetParameter (5,3.0);
    fdscb_tmp->SetParLimits (5,0.0,10.0);
    fdscb_tmp->SetParameter(4,5.);
    fdscb_tmp->SetParLimits(4,0.,25.);
    fdscb_tmp->SetParameter(6,5.);
    fdscb_tmp->SetParLimits(6,0.,25.);
    int fitstatus(0); 
    fitstatus = hist_vec_380_CT_wO_380[i]->Fit(fdscb_tmp,"R");
    fdscb_tmp = hist_vec_380_CT_wO_380[i]->GetFunction("fdscb_tmp");
    h_380_CT_wO_380_DR08_E_SigmaCB_summary_histogram->SetBinContent(i-firstbin+1,fdscb_tmp->GetParameter(2)*100. );
    h_380_CT_wO_380_DR08_E_SigmaCB_summary_histogram->SetBinError(i-firstbin+1,fdscb_tmp->GetParError(2)*100. );
  }  
  TH1F* h_380_CT_wO_380_DR09_E_SigmaCB_summary_histogram=new TH1F("JER_SigmaCBVsCosTheta_CT_wO_380_DR09_380", "RMS_{90}(E_{j}^{reco}/E_{j}^{gen}) / Mean_{90}(E_{j}^{reco}/E_{j}^{gen}) vs |cos#theta|", nRegionBins, pRegionBinEdges);
  h_380_CT_wO_380_DR09_E_SigmaCB_summary_histogram ->SetYTitle("#sigma(E_{j}) / E_{j} [%]");
  h_380_CT_wO_380_DR09_E_SigmaCB_summary_histogram->SetXTitle("|cos#theta|");
  h_380_CT_wO_380_DR09_E_SigmaCB_summary_histogram->SetLineWidth(2);
  h_380_CT_wO_380_DR09_E_SigmaCB_summary_histogram->SetLineColor(kOrange);
  h_380_CT_wO_380_DR09_E_SigmaCB_summary_histogram->SetLineStyle(2);
  TH1F* h_380_CT_wO_380_DR09_E_RMS90_summary_histogram=new TH1F("JER_RMS90VsCosTheta_CT_wO_380_DR09_380", "RMS_{90}(E_{j}^{reco}/E_{j}^{gen}) / Mean_{90}(E_{j}^{reco}/E_{j}^{gen}) vs |cos#theta|", nRegionBins, pRegionBinEdges);
  h_380_CT_wO_380_DR09_E_RMS90_summary_histogram ->SetYTitle("RMS_{90}(E_{j}^{reco}/E_{j}^{gen}) / Mean_{90}(E_{j}^{reco}/E_{j}^{gen}) [%]");
  h_380_CT_wO_380_DR09_E_RMS90_summary_histogram->SetXTitle("|cos#theta|");
  h_380_CT_wO_380_DR09_E_RMS90_summary_histogram->SetLineWidth(2);
  h_380_CT_wO_380_DR09_E_RMS90_summary_histogram->SetLineColor(kRed);
  h_380_CT_wO_380_DR09_E_RMS90_summary_histogram->SetLineStyle(2);

  TH1F* h_380_CT_wO_380_DR09_E_RMS_summary_histogram=new TH1F("JER_RMSVsCosTheta_CT_wO_380_DR09_380", "RMS(E_{j}) / Mean(E_{j}) vs |cos#theta|", nRegionBins, pRegionBinEdges);
  h_380_CT_wO_380_DR09_E_RMS_summary_histogram ->SetYTitle("RMS(E_{j}) / Mean(E_{j}) [%]");
  h_380_CT_wO_380_DR09_E_RMS_summary_histogram->SetXTitle("|cos#theta|");
  h_380_CT_wO_380_DR09_E_RMS_summary_histogram->SetLineWidth(2);
  h_380_CT_wO_380_DR09_E_RMS_summary_histogram->SetLineColor(kRed);
  h_380_CT_wO_380_DR09_E_RMS_summary_histogram->SetLineStyle(2);

  TH1F* h_380_CT_wO_380_DR09_E_JER_Mean_summary_histogram=new TH1F("JER_MeanVsCosTheta_CT_wO_380_DR09_380", "Mean(E_{tot}^{RECO}/E_{tot}^{true}) vs |cos#theta|", nRegionBins, pRegionBinEdges);
  h_380_CT_wO_380_DR09_E_JER_Mean_summary_histogram->SetYTitle("Mean(E_{tot}^{RECO}/E_{tot}^{true})");
  h_380_CT_wO_380_DR09_E_JER_Mean_summary_histogram->SetXTitle("|cos#theta|");
  h_380_CT_wO_380_DR09_E_JER_Mean_summary_histogram->SetLineWidth(2);
  h_380_CT_wO_380_DR09_E_JER_Mean_summary_histogram->SetLineColor(kRed);
  h_380_CT_wO_380_DR09_E_JER_Mean_summary_histogram->SetLineStyle(2);
  firstbin=111;
  for(int i=firstbin;i<(firstbin+13);i++){
    resolutionTH1=0; 
    resolutionErrorTH1=0;
    meanTH1=0;
    meanErrorTH1=0;
    CalculatePerformance( hist_vec_380_CT_wO_380[i], resolutionTH1, resolutionErrorTH1,meanTH1,meanErrorTH1);
    h_380_CT_wO_380_DR09_E_RMS90_summary_histogram->SetBinContent(i-firstbin+1,resolutionTH1/sqrt(2.));
    h_380_CT_wO_380_DR09_E_RMS90_summary_histogram ->SetBinError(i-firstbin+1, resolutionErrorTH1/sqrt(2.));
    h_380_CT_wO_380_DR09_E_RMS_summary_histogram->SetBinContent(i-firstbin+1,hist_vec_380_CT_wO_380[i]->GetRMS()*100. );
    h_380_CT_wO_380_DR09_E_RMS_summary_histogram ->SetBinError(i-firstbin+1, hist_vec_380_CT_wO_380[i]->GetRMSError()*100.);
    h_380_CT_wO_380_DR09_E_JER_Mean_summary_histogram->SetBinContent(i-firstbin+1,hist_vec_380_CT_wO_380[i]->GetMean());
    h_380_CT_wO_380_DR09_E_JER_Mean_summary_histogram->SetBinError(i-firstbin+1,hist_vec_380_CT_wO_380[i]->GetMeanError());
    //double sided crystal ball
    TF1* fit_gaus_tmp = new TF1("fit_gaus_tmp", "gaus",0.50,1.50);
    hist_vec_380_CT_wO_380[i]->Fit("fit_gaus_tmp","R");
    hist_vec_380_CT_wO_380[i]->GetFunction("fit_gaus_tmp");

    TF1* fdscb_tmp = new TF1("fdscb_tmp",fnc_dscb,0.,3.,7);
   fdscb_tmp->SetNpx(1000);
    fdscb_tmp->SetParameter(0,fit_gaus_tmp->GetParameter(0));
    //norm
    fdscb_tmp->SetParLimits (0,0.5*fit_gaus_tmp->GetParameter(0),1.5*fit_gaus_tmp->GetParameter(0));
    fdscb_tmp->SetParameter(1,fit_gaus_tmp->GetParameter(1));
    //gaussian mean
    fdscb_tmp->SetParLimits (1,0.8,1.2);
    //fdscb_tmp->SetParameter(2,fit_gaus_tmp->GetParameter(2));
    //fdscb_tmp->SetParLimits(2,fit_gaus_tmp->GetParameter(2)*0.50,1.50*fit_gaus_tmp->GetParameter(2));
    std::vector<float>sigma2SFit=sigmaGaussianFits2Sigma(hist_vec_380_CT_wO_380[i]);
    fdscb_tmp->SetParameter(2,sigma2SFit[0]);
    fdscb_tmp->SetParLimits(2,sigma2SFit[0]*0.50,1.50*sigma2SFit[0]);
    //-a1: parameter, from when the gaussian core should count
    fdscb_tmp->SetParameter(2,fit_gaus_tmp->GetParameter(2));
    fdscb_tmp->SetParameter (3,3.0);
    fdscb_tmp->SetParLimits (3,0.0,10.0);
    //a2 parameter, up to when the gaussian core should count
    fdscb_tmp->SetParameter (5,3.0);
    fdscb_tmp->SetParLimits (5,0.0,10.0);
    fdscb_tmp->SetParameter(4,5.);
    fdscb_tmp->SetParLimits(4,0.,25.);
    fdscb_tmp->SetParameter(6,5.);
    fdscb_tmp->SetParLimits(6,0.,25.);
    int fitstatus(0); 
    fitstatus = hist_vec_380_CT_wO_380[i]->Fit(fdscb_tmp,"R");
    fdscb_tmp = hist_vec_380_CT_wO_380[i]->GetFunction("fdscb_tmp");
    h_380_CT_wO_380_DR09_E_SigmaCB_summary_histogram->SetBinContent(i-firstbin+1,fdscb_tmp->GetParameter(2)*100. );
    h_380_CT_wO_380_DR09_E_SigmaCB_summary_histogram->SetBinError(i-firstbin+1,fdscb_tmp->GetParError(2)*100. );
  }  
  TH1F* h_380_CT_wO_380_DR10_E_SigmaCB_summary_histogram=new TH1F("JER_SigmaCBVsCosTheta_CT_wO_380_DR10_380", "RMS_{90}(E_{j}^{reco}/E_{j}^{gen}) / Mean_{90}(E_{j}^{reco}/E_{j}^{gen}) vs |cos#theta|", nRegionBins, pRegionBinEdges);
  h_380_CT_wO_380_DR10_E_SigmaCB_summary_histogram ->SetYTitle("#sigma(E_{j}) / E_{j} [%]");
  h_380_CT_wO_380_DR10_E_SigmaCB_summary_histogram->SetXTitle("|cos#theta|");
  h_380_CT_wO_380_DR10_E_SigmaCB_summary_histogram->SetLineWidth(2);
  h_380_CT_wO_380_DR10_E_SigmaCB_summary_histogram->SetLineColor(kOrange);
  h_380_CT_wO_380_DR10_E_SigmaCB_summary_histogram->SetLineStyle(2);
  TH1F* h_380_CT_wO_380_DR10_E_RMS90_summary_histogram=new TH1F("JER_RMS90VsCosTheta_CT_wO_380_DR10_380", "RMS_{90}(E_{j}^{reco}/E_{j}^{gen}) / Mean_{90}(E_{j}^{reco}/E_{j}^{gen}) vs |cos#theta|", nRegionBins, pRegionBinEdges);
  h_380_CT_wO_380_DR10_E_RMS90_summary_histogram ->SetYTitle("RMS_{90}(E_{j}^{reco}/E_{j}^{gen}) / Mean_{90}(E_{j}^{reco}/E_{j}^{gen}) [%]");
  h_380_CT_wO_380_DR10_E_RMS90_summary_histogram->SetXTitle("|cos#theta|");
  h_380_CT_wO_380_DR10_E_RMS90_summary_histogram->SetLineWidth(2);
  h_380_CT_wO_380_DR10_E_RMS90_summary_histogram->SetLineColor(kRed);
  h_380_CT_wO_380_DR10_E_RMS90_summary_histogram->SetLineStyle(2);

  TH1F* h_380_CT_wO_380_DR10_E_RMS_summary_histogram=new TH1F("JER_RMSVsCosTheta_CT_wO_380_DR10_380", "RMS(E_{j}) / Mean(E_{j}) vs |cos#theta|", nRegionBins, pRegionBinEdges);
  h_380_CT_wO_380_DR10_E_RMS_summary_histogram ->SetYTitle("RMS(E_{j}) / Mean(E_{j}) [%]");
  h_380_CT_wO_380_DR10_E_RMS_summary_histogram->SetXTitle("|cos#theta|");
  h_380_CT_wO_380_DR10_E_RMS_summary_histogram->SetLineWidth(2);
  h_380_CT_wO_380_DR10_E_RMS_summary_histogram->SetLineColor(kRed);
  h_380_CT_wO_380_DR10_E_RMS_summary_histogram->SetLineStyle(2);

  TH1F* h_380_CT_wO_380_DR10_E_JER_Mean_summary_histogram=new TH1F("JER_MeanVsCosTheta_CT_wO_380_DR10_380", "Mean(E_{tot}^{RECO}/E_{tot}^{true}) vs |cos#theta|", nRegionBins, pRegionBinEdges);
  h_380_CT_wO_380_DR10_E_JER_Mean_summary_histogram->SetYTitle("Mean(E_{tot}^{RECO}/E_{tot}^{true})");
  h_380_CT_wO_380_DR10_E_JER_Mean_summary_histogram->SetXTitle("|cos#theta|");
  h_380_CT_wO_380_DR10_E_JER_Mean_summary_histogram->SetLineWidth(2);
  h_380_CT_wO_380_DR10_E_JER_Mean_summary_histogram->SetLineColor(kRed);
  h_380_CT_wO_380_DR10_E_JER_Mean_summary_histogram->SetLineStyle(2);
  firstbin=124;
  for(int i=firstbin;i<(firstbin+13);i++){
    resolutionTH1=0; 
    resolutionErrorTH1=0;
    meanTH1=0;
    meanErrorTH1=0;
    CalculatePerformance( hist_vec_380_CT_wO_380[i], resolutionTH1, resolutionErrorTH1,meanTH1,meanErrorTH1);
    h_380_CT_wO_380_DR10_E_RMS90_summary_histogram->SetBinContent(i-firstbin+1,resolutionTH1/sqrt(2.));
    h_380_CT_wO_380_DR10_E_RMS90_summary_histogram ->SetBinError(i-firstbin+1, resolutionErrorTH1/sqrt(2.));
    h_380_CT_wO_380_DR10_E_RMS_summary_histogram->SetBinContent(i-firstbin+1,hist_vec_380_CT_wO_380[i]->GetRMS()*100. );
    h_380_CT_wO_380_DR10_E_RMS_summary_histogram ->SetBinError(i-firstbin+1, hist_vec_380_CT_wO_380[i]->GetRMSError()*100.);
    h_380_CT_wO_380_DR10_E_JER_Mean_summary_histogram->SetBinContent(i-firstbin+1,hist_vec_380_CT_wO_380[i]->GetMean());
    h_380_CT_wO_380_DR10_E_JER_Mean_summary_histogram->SetBinError(i-firstbin+1,hist_vec_380_CT_wO_380[i]->GetMeanError());
    //double sided crystal ball
    TF1* fit_gaus_tmp = new TF1("fit_gaus_tmp", "gaus",0.50,1.50);
    hist_vec_380_CT_wO_380[i]->Fit("fit_gaus_tmp","R");
    hist_vec_380_CT_wO_380[i]->GetFunction("fit_gaus_tmp");

    TF1* fdscb_tmp = new TF1("fdscb_tmp",fnc_dscb,0.,3.,7);
   fdscb_tmp->SetNpx(1000);
    fdscb_tmp->SetParameter(0,fit_gaus_tmp->GetParameter(0));
    //norm
    fdscb_tmp->SetParLimits (0,0.5*fit_gaus_tmp->GetParameter(0),1.5*fit_gaus_tmp->GetParameter(0));
    fdscb_tmp->SetParameter(1,fit_gaus_tmp->GetParameter(1));
    //gaussian mean
    fdscb_tmp->SetParLimits (1,0.8,1.2);
    //fdscb_tmp->SetParameter(2,fit_gaus_tmp->GetParameter(2));
    //fdscb_tmp->SetParLimits(2,fit_gaus_tmp->GetParameter(2)*0.50,1.50*fit_gaus_tmp->GetParameter(2));
    std::vector<float>sigma2SFit=sigmaGaussianFits2Sigma(hist_vec_380_CT_wO_380[i]);
    fdscb_tmp->SetParameter(2,sigma2SFit[0]);
    fdscb_tmp->SetParLimits(2,sigma2SFit[0]*0.50,1.50*sigma2SFit[0]);
    //-a1: parameter, from when the gaussian core should count
    fdscb_tmp->SetParameter(2,fit_gaus_tmp->GetParameter(2));
    fdscb_tmp->SetParameter (3,3.0);
    fdscb_tmp->SetParLimits (3,0.0,10.0);
    //a2 parameter, up to when the gaussian core should count
    fdscb_tmp->SetParameter (5,3.0);
    fdscb_tmp->SetParLimits (5,0.0,10.0);
    fdscb_tmp->SetParameter(4,5.);
    fdscb_tmp->SetParLimits(4,0.,25.);
    fdscb_tmp->SetParameter(6,5.);
    fdscb_tmp->SetParLimits(6,0.,25.);
    int fitstatus(0); 
    fitstatus = hist_vec_380_CT_wO_380[i]->Fit(fdscb_tmp,"R");
    fdscb_tmp = hist_vec_380_CT_wO_380[i]->GetFunction("fdscb_tmp");
    h_380_CT_wO_380_DR10_E_SigmaCB_summary_histogram->SetBinContent(i-firstbin+1,fdscb_tmp->GetParameter(2)*100. );
    h_380_CT_wO_380_DR10_E_SigmaCB_summary_histogram->SetBinError(i-firstbin+1,fdscb_tmp->GetParError(2)*100. );
  }  

  //now 200 380 GeV conditions
  TH1F* h_200_CT_wO_380_genjet03_dphi_j1j2 =  new TH1F("h_200_CT_wO_380_genjet03_dphi_j1j2","", n_bins100, 0.5,TMath::Pi());
  TH1F* h_200_CT_wO_380_genjet03_E1_E2_over_E_True =  new TH1F("h_200_CT_wO_380_genjet03_E1_E2_over_E_True","", n_bins100, 0.5,1.00);
  TH1F* h_200_CT_wO_380_genjet03_Delta_E1_E2_over_E12 =  new TH1F("h_200_CT_wO_380_genjet03_Delta_E1_E2_over_E12","", n_bins100, -0.5,0.5);
  TH1F* h_200_CT_wO_380_genjet04_dphi_j1j2 =  new TH1F("h_200_CT_wO_380_genjet04_dphi_j1j2","", n_bins100, 0.5,TMath::Pi());
  TH1F* h_200_CT_wO_380_genjet04_E1_E2_over_E_True =  new TH1F("h_200_CT_wO_380_genjet04_E1_E2_over_E_True","", n_bins100, 0.5,1.00);
  TH1F* h_200_CT_wO_380_genjet04_Delta_E1_E2_over_E12 =  new TH1F("h_200_CT_wO_380_genjet04_Delta_E1_E2_over_E12","", n_bins100, -0.5,0.5);
  TH1F* h_200_CT_wO_380_genjet05_dphi_j1j2 =  new TH1F("h_200_CT_wO_380_genjet05_dphi_j1j2","", n_bins100, 0.5,TMath::Pi());
  TH1F* h_200_CT_wO_380_genjet05_E1_E2_over_E_True =  new TH1F("h_200_CT_wO_380_genjet05_E1_E2_over_E_True","", n_bins100, 0.5,1.00);
  TH1F* h_200_CT_wO_380_genjet05_Delta_E1_E2_over_E12 =  new TH1F("h_200_CT_wO_380_genjet05_Delta_E1_E2_over_E12","", n_bins100, -0.5,0.5);
  TH1F* h_200_CT_wO_380_genjet06_dphi_j1j2 =  new TH1F("h_200_CT_wO_380_genjet06_dphi_j1j2","", n_bins100, 0.5,TMath::Pi());
  TH1F* h_200_CT_wO_380_genjet06_E1_E2_over_E_True =  new TH1F("h_200_CT_wO_380_genjet06_E1_E2_over_E_True","", n_bins100, 0.5,1.00);
  TH1F* h_200_CT_wO_380_genjet06_Delta_E1_E2_over_E12 =  new TH1F("h_200_CT_wO_380_genjet06_Delta_E1_E2_over_E12","", n_bins100, -0.5,0.5);
  TH1F* h_200_CT_wO_380_genjet07_dphi_j1j2 =  new TH1F("h_200_CT_wO_380_genjet07_dphi_j1j2","", n_bins100, 0.5,TMath::Pi());
  TH1F* h_200_CT_wO_380_genjet07_E1_E2_over_E_True =  new TH1F("h_200_CT_wO_380_genjet07_E1_E2_over_E_True","", n_bins100, 0.5,1.00);
  TH1F* h_200_CT_wO_380_genjet07_Delta_E1_E2_over_E12 =  new TH1F("h_200_CT_wO_380_genjet07_Delta_E1_E2_over_E12","", n_bins100, -0.5,0.5);
  TH1F* h_200_CT_wO_380_genjet08_dphi_j1j2 =  new TH1F("h_200_CT_wO_380_genjet08_dphi_j1j2","", n_bins100, 0.5,TMath::Pi());
  TH1F* h_200_CT_wO_380_genjet08_E1_E2_over_E_True =  new TH1F("h_200_CT_wO_380_genjet08_E1_E2_over_E_True","", n_bins100, 0.5,1.00);
  TH1F* h_200_CT_wO_380_genjet08_Delta_E1_E2_over_E12 =  new TH1F("h_200_CT_wO_380_genjet08_Delta_E1_E2_over_E12","", n_bins100, -0.5,0.5);
  TH1F* h_200_CT_wO_380_genjet09_dphi_j1j2 =  new TH1F("h_200_CT_wO_380_genjet09_dphi_j1j2","", n_bins100, 0.5,TMath::Pi());
  TH1F* h_200_CT_wO_380_genjet09_E1_E2_over_E_True =  new TH1F("h_200_CT_wO_380_genjet09_E1_E2_over_E_True","", n_bins100, 0.5,1.00);
  TH1F* h_200_CT_wO_380_genjet09_Delta_E1_E2_over_E12 =  new TH1F("h_200_CT_wO_380_genjet09_Delta_E1_E2_over_E12","", n_bins100, -0.5,0.5);
  TH1F* h_200_CT_wO_380_genjet10_dphi_j1j2 =  new TH1F("h_200_CT_wO_380_genjet10_dphi_j1j2","", n_bins100, 0.5,TMath::Pi());
  TH1F* h_200_CT_wO_380_genjet10_E1_E2_over_E_True =  new TH1F("h_200_CT_wO_380_genjet10_E1_E2_over_E_True","", n_bins100, 0.5,1.00);
  TH1F* h_200_CT_wO_380_genjet10_Delta_E1_E2_over_E12 =  new TH1F("h_200_CT_wO_380_genjet10_Delta_E1_E2_over_E12","", n_bins100, -0.5,0.5);

  TH1F* h_200_CT_wO_380_recojet03_dphi_j1j2 =  new TH1F("h_200_CT_wO_380_recojet03_dphi_j1j2","", n_bins100, 0.5,TMath::Pi());
  TH1F* h_200_CT_wO_380_recojet03_E1_E2_over_E_True =  new TH1F("h_200_CT_wO_380_recojet03_E1_E2_over_E_True","", n_bins100, 0.5,1.00);
  TH1F* h_200_CT_wO_380_recojet03_Delta_E1_E2_over_E12 =  new TH1F("h_200_CT_wO_380_recojet03_Delta_E1_E2_over_E12","", n_bins100, -0.5,0.5);
  TH1F* h_200_CT_wO_380_recojet04_dphi_j1j2 =  new TH1F("h_200_CT_wO_380_recojet04_dphi_j1j2","", n_bins100, 0.5,TMath::Pi());
  TH1F* h_200_CT_wO_380_recojet04_E1_E2_over_E_True =  new TH1F("h_200_CT_wO_380_recojet04_E1_E2_over_E_True","", n_bins100, 0.5,1.00);
  TH1F* h_200_CT_wO_380_recojet04_Delta_E1_E2_over_E12 =  new TH1F("h_200_CT_wO_380_recojet04_Delta_E1_E2_over_E12","", n_bins100, -0.5,0.5);
  TH1F* h_200_CT_wO_380_recojet05_dphi_j1j2 =  new TH1F("h_200_CT_wO_380_recojet05_dphi_j1j2","", n_bins100, 0.5,TMath::Pi());
  TH1F* h_200_CT_wO_380_recojet05_E1_E2_over_E_True =  new TH1F("h_200_CT_wO_380_recojet05_E1_E2_over_E_True","", n_bins100, 0.5,1.00);
  TH1F* h_200_CT_wO_380_recojet05_Delta_E1_E2_over_E12 =  new TH1F("h_200_CT_wO_380_recojet05_Delta_E1_E2_over_E12","", n_bins100, -0.5,0.5);
  TH1F* h_200_CT_wO_380_recojet06_dphi_j1j2 =  new TH1F("h_200_CT_wO_380_recojet06_dphi_j1j2","", n_bins100, 0.5,TMath::Pi());
  TH1F* h_200_CT_wO_380_recojet06_E1_E2_over_E_True =  new TH1F("h_200_CT_wO_380_recojet06_E1_E2_over_E_True","", n_bins100, 0.5,1.00);
  TH1F* h_200_CT_wO_380_recojet06_Delta_E1_E2_over_E12 =  new TH1F("h_200_CT_wO_380_recojet06_Delta_E1_E2_over_E12","", n_bins100, -0.5,0.5);
  TH1F* h_200_CT_wO_380_recojet07_dphi_j1j2 =  new TH1F("h_200_CT_wO_380_recojet07_dphi_j1j2","", n_bins100, 0.5,TMath::Pi());
  TH1F* h_200_CT_wO_380_recojet07_E1_E2_over_E_True =  new TH1F("h_200_CT_wO_380_recojet07_E1_E2_over_E_True","", n_bins100, 0.5,1.00);
  TH1F* h_200_CT_wO_380_recojet07_Delta_E1_E2_over_E12 =  new TH1F("h_200_CT_wO_380_recojet07_Delta_E1_E2_over_E12","", n_bins100, -0.5,0.5);
  TH1F* h_200_CT_wO_380_recojet08_dphi_j1j2 =  new TH1F("h_200_CT_wO_380_recojet08_dphi_j1j2","", n_bins100, 0.5,TMath::Pi());
  TH1F* h_200_CT_wO_380_recojet08_E1_E2_over_E_True =  new TH1F("h_200_CT_wO_380_recojet08_E1_E2_over_E_True","", n_bins100, 0.5,1.00);
  TH1F* h_200_CT_wO_380_recojet08_Delta_E1_E2_over_E12 =  new TH1F("h_200_CT_wO_380_recojet08_Delta_E1_E2_over_E12","", n_bins100, -0.5,0.5);
  TH1F* h_200_CT_wO_380_recojet09_dphi_j1j2 =  new TH1F("h_200_CT_wO_380_recojet09_dphi_j1j2","", n_bins100, 0.5,TMath::Pi());
  TH1F* h_200_CT_wO_380_recojet09_E1_E2_over_E_True =  new TH1F("h_200_CT_wO_380_recojet09_E1_E2_over_E_True","", n_bins100, 0.5,1.00);
  TH1F* h_200_CT_wO_380_recojet09_Delta_E1_E2_over_E12 =  new TH1F("h_200_CT_wO_380_recojet09_Delta_E1_E2_over_E12","", n_bins100, -0.5,0.5);
  TH1F* h_200_CT_wO_380_recojet10_dphi_j1j2 =  new TH1F("h_200_CT_wO_380_recojet10_dphi_j1j2","", n_bins100, 0.5,TMath::Pi());
  TH1F* h_200_CT_wO_380_recojet10_E1_E2_over_E_True =  new TH1F("h_200_CT_wO_380_recojet10_E1_E2_over_E_True","", n_bins100, 0.5,1.00);
  TH1F* h_200_CT_wO_380_recojet10_Delta_E1_E2_over_E12 =  new TH1F("h_200_CT_wO_380_recojet10_Delta_E1_E2_over_E12","", n_bins100, -0.5,0.5);

  TH1F* h_200_CT_wO_380_recojetE_over_genjetE_DR03 =  new TH1F("h_200_CT_wO_380_recojetE_over_genjetE_DR03","", n_bins100, 0.5,1.5);
  TH1F* h_200_CT_wO_380_recojetE_over_genjetE_DR04 =  new TH1F("h_200_CT_wO_380_recojetE_over_genjetE_DR04","", n_bins100, 0.5,1.5);
  TH1F* h_200_CT_wO_380_recojetE_over_genjetE_DR05 =  new TH1F("h_200_CT_wO_380_recojetE_over_genjetE_DR05","", n_bins100, 0.5,1.5);
  TH1F* h_200_CT_wO_380_recojetE_over_genjetE_DR06 =  new TH1F("h_200_CT_wO_380_recojetE_over_genjetE_DR06","", n_bins100, 0.5,1.5);
  TH1F* h_200_CT_wO_380_recojetE_over_genjetE_DR07 =  new TH1F("h_200_CT_wO_380_recojetE_over_genjetE_DR07","", n_bins100, 0.5,1.5);
  TH1F* h_200_CT_wO_380_recojetE_over_genjetE_DR08 =  new TH1F("h_200_CT_wO_380_recojetE_over_genjetE_DR08","", n_bins100, 0.5,1.5);
  TH1F* h_200_CT_wO_380_recojetE_over_genjetE_DR09 =  new TH1F("h_200_CT_wO_380_recojetE_over_genjetE_DR09","", n_bins100, 0.5,1.5);
  TH1F* h_200_CT_wO_380_recojetE_over_genjetE_DR10 =  new TH1F("h_200_CT_wO_380_recojetE_over_genjetE_DR10","", n_bins100, 0.5,1.5);

  TH1F* h_200_CT_wO_380_dphi_gen_reco_DR05 =  new TH1F("h_200_CT_wO_380_dphi_gen_reco_DR05","", n_bins100, -0.1,9.9);
  TH1F* h_200_CT_wO_380_dphi_gen_reco_DR06 =  new TH1F("h_200_CT_wO_380_dphi_gen_reco_DR06","", n_bins100, -0.1,9.9);
  TH1F* h_200_CT_wO_380_dphi_gen_reco_DR07 =  new TH1F("h_200_CT_wO_380_dphi_gen_reco_DR07","", n_bins100, -0.1,9.9);

  TH1F* h_200_CT_wO_380_DR05_E_rel_totVis_RMS_d1_cosT_0_to_0_10 =  new TH1F("h_200_CT_wO_380_DR05_E_rel_totVis_RMS_d1_cosT_0_to_0_10","", n_binsJER, lim_E_rel_low,lim_E_rel_high);
  TH1F* h_200_CT_wO_380_DR05_E_rel_totVis_RMS_d1_cosT_0_10_to_0_20 =  new TH1F("h_200_CT_wO_380_DR05_E_rel_totVis_RMS_d1_cosT_0_10_to_0_20","", n_binsJER, lim_E_rel_low,lim_E_rel_high);
  TH1F* h_200_CT_wO_380_DR05_E_rel_totVis_RMS_d1_cosT_0_20_to_0_30 =  new TH1F("h_200_CT_wO_380_DR05_E_rel_totVis_RMS_d1_cosT_0_20_to_0_30","", n_binsJER, lim_E_rel_low,lim_E_rel_high);
  TH1F* h_200_CT_wO_380_DR05_E_rel_totVis_RMS_d1_cosT_0_30_to_0_40 =  new TH1F("h_200_CT_wO_380_DR05_E_rel_totVis_RMS_d1_cosT_0_30_to_0_40","", n_binsJER, lim_E_rel_low,lim_E_rel_high);
  TH1F* h_200_CT_wO_380_DR05_E_rel_totVis_RMS_d1_cosT_0_40_to_0_50 =  new TH1F("h_200_CT_wO_380_DR05_E_rel_totVis_RMS_d1_cosT_0_40_to_0_50","", n_binsJER, lim_E_rel_low,lim_E_rel_high);
  TH1F* h_200_CT_wO_380_DR05_E_rel_totVis_RMS_d1_cosT_0_50_to_0_60 =  new TH1F("h_200_CT_wO_380_DR05_E_rel_totVis_RMS_d1_cosT_0_50_to_0_60","", n_binsJER, lim_E_rel_low,lim_E_rel_high);
  TH1F* h_200_CT_wO_380_DR05_E_rel_totVis_RMS_d1_cosT_0_60_to_0_70 =  new TH1F("h_200_CT_wO_380_DR05_E_rel_totVis_RMS_d1_cosT_0_60_to_0_70","", n_binsJER, lim_E_rel_low,lim_E_rel_high);
  TH1F* h_200_CT_wO_380_DR05_E_rel_totVis_RMS_d1_cosT_0_70_to_0_80 =  new TH1F("h_200_CT_wO_380_DR05_E_rel_totVis_RMS_d1_cosT_0_70_to_0_80","", n_binsJER, lim_E_rel_low,lim_E_rel_high);
  TH1F* h_200_CT_wO_380_DR05_E_rel_totVis_RMS_d1_cosT_0_80_to_0_90 =  new TH1F("h_200_CT_wO_380_DR05_E_rel_totVis_RMS_d1_cosT_0_80_to_0_90","", n_binsJER, lim_E_rel_low,lim_E_rel_high);
  TH1F* h_200_CT_wO_380_DR05_E_rel_totVis_RMS_d1_cosT_0_900_to_0_925 =  new TH1F("h_200_CT_wO_380_DR05_E_rel_totVis_RMS_d1_cosT_0_900_to_0_925","", n_binsJER, lim_E_rel_low,lim_E_rel_high);
  TH1F* h_200_CT_wO_380_DR05_E_rel_totVis_RMS_d1_cosT_0_925_to_0_950 =  new TH1F("h_200_CT_wO_380_DR05_E_rel_totVis_RMS_d1_cosT_0_925_to_0_950","", n_binsJER, lim_E_rel_low,lim_E_rel_high);
  TH1F* h_200_CT_wO_380_DR05_E_rel_totVis_RMS_d1_cosT_0_950_to_0_975 =  new TH1F("h_200_CT_wO_380_DR05_E_rel_totVis_RMS_d1_cosT_0_950_to_0_975","", n_binsJER, lim_E_rel_low,lim_E_rel_high);
  TH1F* h_200_CT_wO_380_DR05_E_rel_totVis_RMS_d1_cosT_0_975_to_1_00 =  new TH1F("h_200_CT_wO_380_DR05_E_rel_totVis_RMS_d1_cosT_0_975_to_1_00","", n_binsJER, lim_E_rel_low,lim_E_rel_high);

  TH1F* h_200_CT_wO_380_DR06_E_rel_totVis_RMS_d1_cosT_0_to_0_10 =  new TH1F("h_200_CT_wO_380_DR06_E_rel_totVis_RMS_d1_cosT_0_to_0_10","", n_binsJER, lim_E_rel_low,lim_E_rel_high);
  TH1F* h_200_CT_wO_380_DR06_E_rel_totVis_RMS_d1_cosT_0_10_to_0_20 =  new TH1F("h_200_CT_wO_380_DR06_E_rel_totVis_RMS_d1_cosT_0_10_to_0_20","", n_binsJER, lim_E_rel_low,lim_E_rel_high);
  TH1F* h_200_CT_wO_380_DR06_E_rel_totVis_RMS_d1_cosT_0_20_to_0_30 =  new TH1F("h_200_CT_wO_380_DR06_E_rel_totVis_RMS_d1_cosT_0_20_to_0_30","", n_binsJER, lim_E_rel_low,lim_E_rel_high);
  TH1F* h_200_CT_wO_380_DR06_E_rel_totVis_RMS_d1_cosT_0_30_to_0_40 =  new TH1F("h_200_CT_wO_380_DR06_E_rel_totVis_RMS_d1_cosT_0_30_to_0_40","", n_binsJER, lim_E_rel_low,lim_E_rel_high);
  TH1F* h_200_CT_wO_380_DR06_E_rel_totVis_RMS_d1_cosT_0_40_to_0_50 =  new TH1F("h_200_CT_wO_380_DR06_E_rel_totVis_RMS_d1_cosT_0_40_to_0_50","", n_binsJER, lim_E_rel_low,lim_E_rel_high);
  TH1F* h_200_CT_wO_380_DR06_E_rel_totVis_RMS_d1_cosT_0_50_to_0_60 =  new TH1F("h_200_CT_wO_380_DR06_E_rel_totVis_RMS_d1_cosT_0_50_to_0_60","", n_binsJER, lim_E_rel_low,lim_E_rel_high);
  TH1F* h_200_CT_wO_380_DR06_E_rel_totVis_RMS_d1_cosT_0_60_to_0_70 =  new TH1F("h_200_CT_wO_380_DR06_E_rel_totVis_RMS_d1_cosT_0_60_to_0_70","", n_binsJER, lim_E_rel_low,lim_E_rel_high);
  TH1F* h_200_CT_wO_380_DR06_E_rel_totVis_RMS_d1_cosT_0_70_to_0_80 =  new TH1F("h_200_CT_wO_380_DR06_E_rel_totVis_RMS_d1_cosT_0_70_to_0_80","", n_binsJER, lim_E_rel_low,lim_E_rel_high);
  TH1F* h_200_CT_wO_380_DR06_E_rel_totVis_RMS_d1_cosT_0_80_to_0_90 =  new TH1F("h_200_CT_wO_380_DR06_E_rel_totVis_RMS_d1_cosT_0_80_to_0_90","", n_binsJER, lim_E_rel_low,lim_E_rel_high);
  TH1F* h_200_CT_wO_380_DR06_E_rel_totVis_RMS_d1_cosT_0_900_to_0_925 =  new TH1F("h_200_CT_wO_380_DR06_E_rel_totVis_RMS_d1_cosT_0_900_to_0_925","", n_binsJER, lim_E_rel_low,lim_E_rel_high);
  TH1F* h_200_CT_wO_380_DR06_E_rel_totVis_RMS_d1_cosT_0_925_to_0_950 =  new TH1F("h_200_CT_wO_380_DR06_E_rel_totVis_RMS_d1_cosT_0_925_to_0_950","", n_binsJER, lim_E_rel_low,lim_E_rel_high);
  TH1F* h_200_CT_wO_380_DR06_E_rel_totVis_RMS_d1_cosT_0_950_to_0_975 =  new TH1F("h_200_CT_wO_380_DR06_E_rel_totVis_RMS_d1_cosT_0_950_to_0_975","", n_binsJER, lim_E_rel_low,lim_E_rel_high);
  TH1F* h_200_CT_wO_380_DR06_E_rel_totVis_RMS_d1_cosT_0_975_to_1_00 =  new TH1F("h_200_CT_wO_380_DR06_E_rel_totVis_RMS_d1_cosT_0_975_to_1_00","", n_binsJER, lim_E_rel_low,lim_E_rel_high);

  TH1F* h_200_CT_wO_380_DR07_E_rel_totVis_RMS_d1_cosT_0_to_0_10 =  new TH1F("h_200_CT_wO_380_DR07_E_rel_totVis_RMS_d1_cosT_0_to_0_10","", n_binsJER, lim_E_rel_low,lim_E_rel_high);
  TH1F* h_200_CT_wO_380_DR07_E_rel_totVis_RMS_d1_cosT_0_10_to_0_20 =  new TH1F("h_200_CT_wO_380_DR07_E_rel_totVis_RMS_d1_cosT_0_10_to_0_20","", n_binsJER, lim_E_rel_low,lim_E_rel_high);
  TH1F* h_200_CT_wO_380_DR07_E_rel_totVis_RMS_d1_cosT_0_20_to_0_30 =  new TH1F("h_200_CT_wO_380_DR07_E_rel_totVis_RMS_d1_cosT_0_20_to_0_30","", n_binsJER, lim_E_rel_low,lim_E_rel_high);
  TH1F* h_200_CT_wO_380_DR07_E_rel_totVis_RMS_d1_cosT_0_30_to_0_40 =  new TH1F("h_200_CT_wO_380_DR07_E_rel_totVis_RMS_d1_cosT_0_30_to_0_40","", n_binsJER, lim_E_rel_low,lim_E_rel_high);
  TH1F* h_200_CT_wO_380_DR07_E_rel_totVis_RMS_d1_cosT_0_40_to_0_50 =  new TH1F("h_200_CT_wO_380_DR07_E_rel_totVis_RMS_d1_cosT_0_40_to_0_50","", n_binsJER, lim_E_rel_low,lim_E_rel_high);
  TH1F* h_200_CT_wO_380_DR07_E_rel_totVis_RMS_d1_cosT_0_50_to_0_60 =  new TH1F("h_200_CT_wO_380_DR07_E_rel_totVis_RMS_d1_cosT_0_50_to_0_60","", n_binsJER, lim_E_rel_low,lim_E_rel_high);
  TH1F* h_200_CT_wO_380_DR07_E_rel_totVis_RMS_d1_cosT_0_60_to_0_70 =  new TH1F("h_200_CT_wO_380_DR07_E_rel_totVis_RMS_d1_cosT_0_60_to_0_70","", n_binsJER, lim_E_rel_low,lim_E_rel_high);
  TH1F* h_200_CT_wO_380_DR07_E_rel_totVis_RMS_d1_cosT_0_70_to_0_80 =  new TH1F("h_200_CT_wO_380_DR07_E_rel_totVis_RMS_d1_cosT_0_70_to_0_80","", n_binsJER, lim_E_rel_low,lim_E_rel_high);
  TH1F* h_200_CT_wO_380_DR07_E_rel_totVis_RMS_d1_cosT_0_80_to_0_90 =  new TH1F("h_200_CT_wO_380_DR07_E_rel_totVis_RMS_d1_cosT_0_80_to_0_90","", n_binsJER, lim_E_rel_low,lim_E_rel_high);
  TH1F* h_200_CT_wO_380_DR07_E_rel_totVis_RMS_d1_cosT_0_900_to_0_925 =  new TH1F("h_200_CT_wO_380_DR07_E_rel_totVis_RMS_d1_cosT_0_900_to_0_925","", n_binsJER, lim_E_rel_low,lim_E_rel_high);
  TH1F* h_200_CT_wO_380_DR07_E_rel_totVis_RMS_d1_cosT_0_925_to_0_950 =  new TH1F("h_200_CT_wO_380_DR07_E_rel_totVis_RMS_d1_cosT_0_925_to_0_950","", n_binsJER, lim_E_rel_low,lim_E_rel_high);
  TH1F* h_200_CT_wO_380_DR07_E_rel_totVis_RMS_d1_cosT_0_950_to_0_975 =  new TH1F("h_200_CT_wO_380_DR07_E_rel_totVis_RMS_d1_cosT_0_950_to_0_975","", n_binsJER, lim_E_rel_low,lim_E_rel_high);
  TH1F* h_200_CT_wO_380_DR07_E_rel_totVis_RMS_d1_cosT_0_975_to_1_00 =  new TH1F("h_200_CT_wO_380_DR07_E_rel_totVis_RMS_d1_cosT_0_975_to_1_00","", n_binsJER, lim_E_rel_low,lim_E_rel_high);

  TH1F* h_200_CT_wO_380_DR08_E_rel_totVis_RMS_d1_cosT_0_to_0_10 =  new TH1F("h_200_CT_wO_380_DR08_E_rel_totVis_RMS_d1_cosT_0_to_0_10","", n_binsJER, lim_E_rel_low,lim_E_rel_high);
  TH1F* h_200_CT_wO_380_DR08_E_rel_totVis_RMS_d1_cosT_0_10_to_0_20 =  new TH1F("h_200_CT_wO_380_DR08_E_rel_totVis_RMS_d1_cosT_0_10_to_0_20","", n_binsJER, lim_E_rel_low,lim_E_rel_high);
  TH1F* h_200_CT_wO_380_DR08_E_rel_totVis_RMS_d1_cosT_0_20_to_0_30 =  new TH1F("h_200_CT_wO_380_DR08_E_rel_totVis_RMS_d1_cosT_0_20_to_0_30","", n_binsJER, lim_E_rel_low,lim_E_rel_high);
  TH1F* h_200_CT_wO_380_DR08_E_rel_totVis_RMS_d1_cosT_0_30_to_0_40 =  new TH1F("h_200_CT_wO_380_DR08_E_rel_totVis_RMS_d1_cosT_0_30_to_0_40","", n_binsJER, lim_E_rel_low,lim_E_rel_high);
  TH1F* h_200_CT_wO_380_DR08_E_rel_totVis_RMS_d1_cosT_0_40_to_0_50 =  new TH1F("h_200_CT_wO_380_DR08_E_rel_totVis_RMS_d1_cosT_0_40_to_0_50","", n_binsJER, lim_E_rel_low,lim_E_rel_high);
  TH1F* h_200_CT_wO_380_DR08_E_rel_totVis_RMS_d1_cosT_0_50_to_0_60 =  new TH1F("h_200_CT_wO_380_DR08_E_rel_totVis_RMS_d1_cosT_0_50_to_0_60","", n_binsJER, lim_E_rel_low,lim_E_rel_high);
  TH1F* h_200_CT_wO_380_DR08_E_rel_totVis_RMS_d1_cosT_0_60_to_0_70 =  new TH1F("h_200_CT_wO_380_DR08_E_rel_totVis_RMS_d1_cosT_0_60_to_0_70","", n_binsJER, lim_E_rel_low,lim_E_rel_high);
  TH1F* h_200_CT_wO_380_DR08_E_rel_totVis_RMS_d1_cosT_0_70_to_0_80 =  new TH1F("h_200_CT_wO_380_DR08_E_rel_totVis_RMS_d1_cosT_0_70_to_0_80","", n_binsJER, lim_E_rel_low,lim_E_rel_high);
  TH1F* h_200_CT_wO_380_DR08_E_rel_totVis_RMS_d1_cosT_0_80_to_0_90 =  new TH1F("h_200_CT_wO_380_DR08_E_rel_totVis_RMS_d1_cosT_0_80_to_0_90","", n_binsJER, lim_E_rel_low,lim_E_rel_high);
  TH1F* h_200_CT_wO_380_DR08_E_rel_totVis_RMS_d1_cosT_0_900_to_0_925 =  new TH1F("h_200_CT_wO_380_DR08_E_rel_totVis_RMS_d1_cosT_0_900_to_0_925","", n_binsJER, lim_E_rel_low,lim_E_rel_high);
  TH1F* h_200_CT_wO_380_DR08_E_rel_totVis_RMS_d1_cosT_0_925_to_0_950 =  new TH1F("h_200_CT_wO_380_DR08_E_rel_totVis_RMS_d1_cosT_0_925_to_0_950","", n_binsJER, lim_E_rel_low,lim_E_rel_high);
  TH1F* h_200_CT_wO_380_DR08_E_rel_totVis_RMS_d1_cosT_0_950_to_0_975 =  new TH1F("h_200_CT_wO_380_DR08_E_rel_totVis_RMS_d1_cosT_0_950_to_0_975","", n_binsJER, lim_E_rel_low,lim_E_rel_high);
  TH1F* h_200_CT_wO_380_DR08_E_rel_totVis_RMS_d1_cosT_0_975_to_1_00 =  new TH1F("h_200_CT_wO_380_DR08_E_rel_totVis_RMS_d1_cosT_0_975_to_1_00","", n_binsJER, lim_E_rel_low,lim_E_rel_high);

  TH1F* h_200_CT_wO_380_DR09_E_rel_totVis_RMS_d1_cosT_0_to_0_10 =  new TH1F("h_200_CT_wO_380_DR09_E_rel_totVis_RMS_d1_cosT_0_to_0_10","", n_binsJER, lim_E_rel_low,lim_E_rel_high);
  TH1F* h_200_CT_wO_380_DR09_E_rel_totVis_RMS_d1_cosT_0_10_to_0_20 =  new TH1F("h_200_CT_wO_380_DR09_E_rel_totVis_RMS_d1_cosT_0_10_to_0_20","", n_binsJER, lim_E_rel_low,lim_E_rel_high);
  TH1F* h_200_CT_wO_380_DR09_E_rel_totVis_RMS_d1_cosT_0_20_to_0_30 =  new TH1F("h_200_CT_wO_380_DR09_E_rel_totVis_RMS_d1_cosT_0_20_to_0_30","", n_binsJER, lim_E_rel_low,lim_E_rel_high);
  TH1F* h_200_CT_wO_380_DR09_E_rel_totVis_RMS_d1_cosT_0_30_to_0_40 =  new TH1F("h_200_CT_wO_380_DR09_E_rel_totVis_RMS_d1_cosT_0_30_to_0_40","", n_binsJER, lim_E_rel_low,lim_E_rel_high);
  TH1F* h_200_CT_wO_380_DR09_E_rel_totVis_RMS_d1_cosT_0_40_to_0_50 =  new TH1F("h_200_CT_wO_380_DR09_E_rel_totVis_RMS_d1_cosT_0_40_to_0_50","", n_binsJER, lim_E_rel_low,lim_E_rel_high);
  TH1F* h_200_CT_wO_380_DR09_E_rel_totVis_RMS_d1_cosT_0_50_to_0_60 =  new TH1F("h_200_CT_wO_380_DR09_E_rel_totVis_RMS_d1_cosT_0_50_to_0_60","", n_binsJER, lim_E_rel_low,lim_E_rel_high);
  TH1F* h_200_CT_wO_380_DR09_E_rel_totVis_RMS_d1_cosT_0_60_to_0_70 =  new TH1F("h_200_CT_wO_380_DR09_E_rel_totVis_RMS_d1_cosT_0_60_to_0_70","", n_binsJER, lim_E_rel_low,lim_E_rel_high);
  TH1F* h_200_CT_wO_380_DR09_E_rel_totVis_RMS_d1_cosT_0_70_to_0_80 =  new TH1F("h_200_CT_wO_380_DR09_E_rel_totVis_RMS_d1_cosT_0_70_to_0_80","", n_binsJER, lim_E_rel_low,lim_E_rel_high);
  TH1F* h_200_CT_wO_380_DR09_E_rel_totVis_RMS_d1_cosT_0_80_to_0_90 =  new TH1F("h_200_CT_wO_380_DR09_E_rel_totVis_RMS_d1_cosT_0_80_to_0_90","", n_binsJER, lim_E_rel_low,lim_E_rel_high);
  TH1F* h_200_CT_wO_380_DR09_E_rel_totVis_RMS_d1_cosT_0_900_to_0_925 =  new TH1F("h_200_CT_wO_380_DR09_E_rel_totVis_RMS_d1_cosT_0_900_to_0_925","", n_binsJER, lim_E_rel_low,lim_E_rel_high);
  TH1F* h_200_CT_wO_380_DR09_E_rel_totVis_RMS_d1_cosT_0_925_to_0_950 =  new TH1F("h_200_CT_wO_380_DR09_E_rel_totVis_RMS_d1_cosT_0_925_to_0_950","", n_binsJER, lim_E_rel_low,lim_E_rel_high);
  TH1F* h_200_CT_wO_380_DR09_E_rel_totVis_RMS_d1_cosT_0_950_to_0_975 =  new TH1F("h_200_CT_wO_380_DR09_E_rel_totVis_RMS_d1_cosT_0_950_to_0_975","", n_binsJER, lim_E_rel_low,lim_E_rel_high);
  TH1F* h_200_CT_wO_380_DR09_E_rel_totVis_RMS_d1_cosT_0_975_to_1_00 =  new TH1F("h_200_CT_wO_380_DR09_E_rel_totVis_RMS_d1_cosT_0_975_to_1_00","", n_binsJER, lim_E_rel_low,lim_E_rel_high);

  TH1F* h_200_CT_wO_380_DR10_E_rel_totVis_RMS_d1_cosT_0_to_0_10 =  new TH1F("h_200_CT_wO_380_DR10_E_rel_totVis_RMS_d1_cosT_0_to_0_10","", n_binsJER, lim_E_rel_low,lim_E_rel_high);
  TH1F* h_200_CT_wO_380_DR10_E_rel_totVis_RMS_d1_cosT_0_10_to_0_20 =  new TH1F("h_200_CT_wO_380_DR10_E_rel_totVis_RMS_d1_cosT_0_10_to_0_20","", n_binsJER, lim_E_rel_low,lim_E_rel_high);
  TH1F* h_200_CT_wO_380_DR10_E_rel_totVis_RMS_d1_cosT_0_20_to_0_30 =  new TH1F("h_200_CT_wO_380_DR10_E_rel_totVis_RMS_d1_cosT_0_20_to_0_30","", n_binsJER, lim_E_rel_low,lim_E_rel_high);
  TH1F* h_200_CT_wO_380_DR10_E_rel_totVis_RMS_d1_cosT_0_30_to_0_40 =  new TH1F("h_200_CT_wO_380_DR10_E_rel_totVis_RMS_d1_cosT_0_30_to_0_40","", n_binsJER, lim_E_rel_low,lim_E_rel_high);
  TH1F* h_200_CT_wO_380_DR10_E_rel_totVis_RMS_d1_cosT_0_40_to_0_50 =  new TH1F("h_200_CT_wO_380_DR10_E_rel_totVis_RMS_d1_cosT_0_40_to_0_50","", n_binsJER, lim_E_rel_low,lim_E_rel_high);
  TH1F* h_200_CT_wO_380_DR10_E_rel_totVis_RMS_d1_cosT_0_50_to_0_60 =  new TH1F("h_200_CT_wO_380_DR10_E_rel_totVis_RMS_d1_cosT_0_50_to_0_60","", n_binsJER, lim_E_rel_low,lim_E_rel_high);
  TH1F* h_200_CT_wO_380_DR10_E_rel_totVis_RMS_d1_cosT_0_60_to_0_70 =  new TH1F("h_200_CT_wO_380_DR10_E_rel_totVis_RMS_d1_cosT_0_60_to_0_70","", n_binsJER, lim_E_rel_low,lim_E_rel_high);
  TH1F* h_200_CT_wO_380_DR10_E_rel_totVis_RMS_d1_cosT_0_70_to_0_80 =  new TH1F("h_200_CT_wO_380_DR10_E_rel_totVis_RMS_d1_cosT_0_70_to_0_80","", n_binsJER, lim_E_rel_low,lim_E_rel_high);
  TH1F* h_200_CT_wO_380_DR10_E_rel_totVis_RMS_d1_cosT_0_80_to_0_90 =  new TH1F("h_200_CT_wO_380_DR10_E_rel_totVis_RMS_d1_cosT_0_80_to_0_90","", n_binsJER, lim_E_rel_low,lim_E_rel_high);
  TH1F* h_200_CT_wO_380_DR10_E_rel_totVis_RMS_d1_cosT_0_900_to_0_925 =  new TH1F("h_200_CT_wO_380_DR10_E_rel_totVis_RMS_d1_cosT_0_900_to_0_925","", n_binsJER, lim_E_rel_low,lim_E_rel_high);
  TH1F* h_200_CT_wO_380_DR10_E_rel_totVis_RMS_d1_cosT_0_925_to_0_950 =  new TH1F("h_200_CT_wO_380_DR10_E_rel_totVis_RMS_d1_cosT_0_925_to_0_950","", n_binsJER, lim_E_rel_low,lim_E_rel_high);
  TH1F* h_200_CT_wO_380_DR10_E_rel_totVis_RMS_d1_cosT_0_950_to_0_975 =  new TH1F("h_200_CT_wO_380_DR10_E_rel_totVis_RMS_d1_cosT_0_950_to_0_975","", n_binsJER, lim_E_rel_low,lim_E_rel_high);
  TH1F* h_200_CT_wO_380_DR10_E_rel_totVis_RMS_d1_cosT_0_975_to_1_00 =  new TH1F("h_200_CT_wO_380_DR10_E_rel_totVis_RMS_d1_cosT_0_975_to_1_00","", n_binsJER, lim_E_rel_low,lim_E_rel_high);

  TH1F* h_200_CT_wO_380_DR05_dphi_reco_gen_cosTheta_0_65 =  new TH1F("h_200_CT_wO_380_DR05_dphi_reco_gen_cosTheta_0_65","", n_bins100, -lim_angleDeg,lim_angleDeg);
  TH1F* h_200_CT_wO_380_DR05_dtheta_reco_gen_cosTheta_0_65 =  new TH1F("h_200_CT_wO_380_DR05_dtheta_reco_gen_cosTheta_0_65","", n_bins100, -lim_angleDeg,lim_angleDeg);
  TH1F* h_200_CT_wO_380_DR05_dphi_reco_gen_cosTheta_0_65_to_0_80 =  new TH1F("h_200_CT_wO_380_DR05_dphi_reco_gen_cosTheta_0_65_to_0_80","", n_bins100, -lim_angleDeg,lim_angleDeg);
  TH1F* h_200_CT_wO_380_DR05_dtheta_reco_gen_cosTheta_0_65_to_0_80 =  new TH1F("h_200_CT_wO_380_DR05_dtheta_reco_gen_cosTheta_0_65_to_0_80","", n_bins100, -lim_angleDeg,lim_angleDeg);
  TH1F* h_200_CT_wO_380_DR05_dphi_reco_gen_cosTheta_0_80_to_0_925 =  new TH1F("h_200_CT_wO_380_DR05_dphi_reco_gen_cosTheta_0_80_to_0_925","", n_bins100, -lim_angleDeg,lim_angleDeg);
  TH1F* h_200_CT_wO_380_DR05_dtheta_reco_gen_cosTheta_0_80_to_0_925 =  new TH1F("h_200_CT_wO_380_DR05_dtheta_reco_gen_cosTheta_0_80_to_0_925","", n_bins100, -lim_angleDeg,lim_angleDeg);
  TH1F* h_200_CT_wO_380_DR05_dphi_reco_gen_cosTheta_0_925_to_0_975 =  new TH1F("h_200_CT_wO_380_DR05_dphi_reco_gen_cosTheta_0_925_to_0_975","", n_bins100, -lim_angleDeg,lim_angleDeg);
  TH1F* h_200_CT_wO_380_DR05_dtheta_reco_gen_cosTheta_0_925_to_0_975 =  new TH1F("h_200_CT_wO_380_DR05_dtheta_reco_gen_cosTheta_0_925_to_0_975","", n_bins100, -lim_angleDeg,lim_angleDeg);

  TH1F* h_200_CT_wO_380_DR07_dphi_reco_gen_cosTheta_0_65 =  new TH1F("h_200_CT_wO_380_DR07_dphi_reco_gen_cosTheta_0_65","", n_bins100, -lim_angleDeg,lim_angleDeg);
  TH1F* h_200_CT_wO_380_DR07_dtheta_reco_gen_cosTheta_0_65 =  new TH1F("h_200_CT_wO_380_DR07_dtheta_reco_gen_cosTheta_0_65","", n_bins100, -lim_angleDeg,lim_angleDeg);
  TH1F* h_200_CT_wO_380_DR07_dphi_reco_gen_cosTheta_0_65_to_0_80 =  new TH1F("h_200_CT_wO_380_DR07_dphi_reco_gen_cosTheta_0_65_to_0_80","", n_bins100, -lim_angleDeg,lim_angleDeg);
  TH1F* h_200_CT_wO_380_DR07_dtheta_reco_gen_cosTheta_0_65_to_0_80 =  new TH1F("h_200_CT_wO_380_DR07_dtheta_reco_gen_cosTheta_0_65_to_0_80","", n_bins100, -lim_angleDeg,lim_angleDeg);
  TH1F* h_200_CT_wO_380_DR07_dphi_reco_gen_cosTheta_0_80_to_0_925 =  new TH1F("h_200_CT_wO_380_DR07_dphi_reco_gen_cosTheta_0_80_to_0_925","", n_bins100, -lim_angleDeg,lim_angleDeg);
  TH1F* h_200_CT_wO_380_DR07_dtheta_reco_gen_cosTheta_0_80_to_0_925 =  new TH1F("h_200_CT_wO_380_DR07_dtheta_reco_gen_cosTheta_0_80_to_0_925","", n_bins100, -lim_angleDeg,lim_angleDeg);
  TH1F* h_200_CT_wO_380_DR07_dphi_reco_gen_cosTheta_0_925_to_0_975 =  new TH1F("h_200_CT_wO_380_DR07_dphi_reco_gen_cosTheta_0_925_to_0_975","", n_bins100, -lim_angleDeg,lim_angleDeg);
  TH1F* h_200_CT_wO_380_DR07_dtheta_reco_gen_cosTheta_0_925_to_0_975 =  new TH1F("h_200_CT_wO_380_DR07_dtheta_reco_gen_cosTheta_0_925_to_0_975","", n_bins100, -lim_angleDeg,lim_angleDeg);

  TH1F* h_200_CT_wO_380_DR10_dphi_reco_gen_cosTheta_0_65 =  new TH1F("h_200_CT_wO_380_DR10_dphi_reco_gen_cosTheta_0_65","", n_bins100, -lim_angleDeg,lim_angleDeg);
  TH1F* h_200_CT_wO_380_DR10_dtheta_reco_gen_cosTheta_0_65 =  new TH1F("h_200_CT_wO_380_DR10_dtheta_reco_gen_cosTheta_0_65","", n_bins100, -lim_angleDeg,lim_angleDeg);
  TH1F* h_200_CT_wO_380_DR10_dphi_reco_gen_cosTheta_0_65_to_0_80 =  new TH1F("h_200_CT_wO_380_DR10_dphi_reco_gen_cosTheta_0_65_to_0_80","", n_bins100, -lim_angleDeg,lim_angleDeg);
  TH1F* h_200_CT_wO_380_DR10_dtheta_reco_gen_cosTheta_0_65_to_0_80 =  new TH1F("h_200_CT_wO_380_DR10_dtheta_reco_gen_cosTheta_0_65_to_0_80","", n_bins100, -lim_angleDeg,lim_angleDeg);
  TH1F* h_200_CT_wO_380_DR10_dphi_reco_gen_cosTheta_0_80_to_0_925 =  new TH1F("h_200_CT_wO_380_DR10_dphi_reco_gen_cosTheta_0_80_to_0_925","", n_bins100, -lim_angleDeg,lim_angleDeg);
  TH1F* h_200_CT_wO_380_DR10_dtheta_reco_gen_cosTheta_0_80_to_0_925 =  new TH1F("h_200_CT_wO_380_DR10_dtheta_reco_gen_cosTheta_0_80_to_0_925","", n_bins100, -lim_angleDeg,lim_angleDeg);
  TH1F* h_200_CT_wO_380_DR10_dphi_reco_gen_cosTheta_0_925_to_0_975 =  new TH1F("h_200_CT_wO_380_DR10_dphi_reco_gen_cosTheta_0_925_to_0_975","", n_bins100, -lim_angleDeg,lim_angleDeg);
  TH1F* h_200_CT_wO_380_DR10_dtheta_reco_gen_cosTheta_0_925_to_0_975 =  new TH1F("h_200_CT_wO_380_DR10_dtheta_reco_gen_cosTheta_0_925_to_0_975","", n_bins100, -lim_angleDeg,lim_angleDeg);

  std::vector<TH1F*> hist_vec_200_CT_wO_380;
  hist_vec_200_CT_wO_380.push_back(h_200_CT_wO_380_genjet03_dphi_j1j2);
  hist_vec_200_CT_wO_380.push_back(h_200_CT_wO_380_genjet03_E1_E2_over_E_True);
  hist_vec_200_CT_wO_380.push_back(h_200_CT_wO_380_genjet03_Delta_E1_E2_over_E12);
  hist_vec_200_CT_wO_380.push_back(h_200_CT_wO_380_genjet04_dphi_j1j2);
  hist_vec_200_CT_wO_380.push_back(h_200_CT_wO_380_genjet04_E1_E2_over_E_True);
  hist_vec_200_CT_wO_380.push_back(h_200_CT_wO_380_genjet04_Delta_E1_E2_over_E12);
  hist_vec_200_CT_wO_380.push_back(h_200_CT_wO_380_genjet05_dphi_j1j2);
  hist_vec_200_CT_wO_380.push_back(h_200_CT_wO_380_genjet05_E1_E2_over_E_True);
  hist_vec_200_CT_wO_380.push_back(h_200_CT_wO_380_genjet05_Delta_E1_E2_over_E12);
  hist_vec_200_CT_wO_380.push_back(h_200_CT_wO_380_genjet06_dphi_j1j2);
  hist_vec_200_CT_wO_380.push_back(h_200_CT_wO_380_genjet06_E1_E2_over_E_True);
  hist_vec_200_CT_wO_380.push_back(h_200_CT_wO_380_genjet06_Delta_E1_E2_over_E12);
  hist_vec_200_CT_wO_380.push_back(h_200_CT_wO_380_genjet07_dphi_j1j2);
  hist_vec_200_CT_wO_380.push_back(h_200_CT_wO_380_genjet07_E1_E2_over_E_True);
  hist_vec_200_CT_wO_380.push_back(h_200_CT_wO_380_genjet07_Delta_E1_E2_over_E12);
  hist_vec_200_CT_wO_380.push_back(h_200_CT_wO_380_genjet08_dphi_j1j2);
  hist_vec_200_CT_wO_380.push_back(h_200_CT_wO_380_genjet08_E1_E2_over_E_True);
  hist_vec_200_CT_wO_380.push_back(h_200_CT_wO_380_genjet08_Delta_E1_E2_over_E12);
  hist_vec_200_CT_wO_380.push_back(h_200_CT_wO_380_genjet09_dphi_j1j2);
  hist_vec_200_CT_wO_380.push_back(h_200_CT_wO_380_genjet09_E1_E2_over_E_True);
  hist_vec_200_CT_wO_380.push_back(h_200_CT_wO_380_genjet09_Delta_E1_E2_over_E12);
  hist_vec_200_CT_wO_380.push_back(h_200_CT_wO_380_genjet10_dphi_j1j2);
  hist_vec_200_CT_wO_380.push_back(h_200_CT_wO_380_genjet10_E1_E2_over_E_True);
  hist_vec_200_CT_wO_380.push_back(h_200_CT_wO_380_genjet10_Delta_E1_E2_over_E12);

  hist_vec_200_CT_wO_380.push_back(h_200_CT_wO_380_recojet03_dphi_j1j2);
  hist_vec_200_CT_wO_380.push_back(h_200_CT_wO_380_recojet03_E1_E2_over_E_True);
  hist_vec_200_CT_wO_380.push_back(h_200_CT_wO_380_recojet03_Delta_E1_E2_over_E12);
  hist_vec_200_CT_wO_380.push_back(h_200_CT_wO_380_recojet04_dphi_j1j2);
  hist_vec_200_CT_wO_380.push_back(h_200_CT_wO_380_recojet04_E1_E2_over_E_True);
  hist_vec_200_CT_wO_380.push_back(h_200_CT_wO_380_recojet04_Delta_E1_E2_over_E12);
  hist_vec_200_CT_wO_380.push_back(h_200_CT_wO_380_recojet05_dphi_j1j2);
  hist_vec_200_CT_wO_380.push_back(h_200_CT_wO_380_recojet05_E1_E2_over_E_True);
  hist_vec_200_CT_wO_380.push_back(h_200_CT_wO_380_recojet05_Delta_E1_E2_over_E12);
  hist_vec_200_CT_wO_380.push_back(h_200_CT_wO_380_recojet06_dphi_j1j2);
  hist_vec_200_CT_wO_380.push_back(h_200_CT_wO_380_recojet06_E1_E2_over_E_True);
  hist_vec_200_CT_wO_380.push_back(h_200_CT_wO_380_recojet06_Delta_E1_E2_over_E12);
  hist_vec_200_CT_wO_380.push_back(h_200_CT_wO_380_recojet07_dphi_j1j2);
  hist_vec_200_CT_wO_380.push_back(h_200_CT_wO_380_recojet07_E1_E2_over_E_True);
  hist_vec_200_CT_wO_380.push_back(h_200_CT_wO_380_recojet07_Delta_E1_E2_over_E12);
  hist_vec_200_CT_wO_380.push_back(h_200_CT_wO_380_recojet08_dphi_j1j2);
  hist_vec_200_CT_wO_380.push_back(h_200_CT_wO_380_recojet08_E1_E2_over_E_True);
  hist_vec_200_CT_wO_380.push_back(h_200_CT_wO_380_recojet08_Delta_E1_E2_over_E12);
  hist_vec_200_CT_wO_380.push_back(h_200_CT_wO_380_recojet09_dphi_j1j2);
  hist_vec_200_CT_wO_380.push_back(h_200_CT_wO_380_recojet09_E1_E2_over_E_True);
  hist_vec_200_CT_wO_380.push_back(h_200_CT_wO_380_recojet09_Delta_E1_E2_over_E12);
  hist_vec_200_CT_wO_380.push_back(h_200_CT_wO_380_recojet10_dphi_j1j2);
  hist_vec_200_CT_wO_380.push_back(h_200_CT_wO_380_recojet10_E1_E2_over_E_True);
  hist_vec_200_CT_wO_380.push_back(h_200_CT_wO_380_recojet10_Delta_E1_E2_over_E12);

  hist_vec_200_CT_wO_380.push_back(h_200_CT_wO_380_recojetE_over_genjetE_DR03);
  hist_vec_200_CT_wO_380.push_back(h_200_CT_wO_380_recojetE_over_genjetE_DR04);
  hist_vec_200_CT_wO_380.push_back(h_200_CT_wO_380_recojetE_over_genjetE_DR05);
  hist_vec_200_CT_wO_380.push_back(h_200_CT_wO_380_recojetE_over_genjetE_DR06);
  hist_vec_200_CT_wO_380.push_back(h_200_CT_wO_380_recojetE_over_genjetE_DR07);
  hist_vec_200_CT_wO_380.push_back(h_200_CT_wO_380_recojetE_over_genjetE_DR08);
  hist_vec_200_CT_wO_380.push_back(h_200_CT_wO_380_recojetE_over_genjetE_DR09);
  hist_vec_200_CT_wO_380.push_back(h_200_CT_wO_380_recojetE_over_genjetE_DR10);

  hist_vec_200_CT_wO_380.push_back(h_200_CT_wO_380_dphi_gen_reco_DR05);
  hist_vec_200_CT_wO_380.push_back(h_200_CT_wO_380_dphi_gen_reco_DR06);
  hist_vec_200_CT_wO_380.push_back(h_200_CT_wO_380_dphi_gen_reco_DR07);

  hist_vec_200_CT_wO_380.push_back(h_200_CT_wO_380_DR05_E_rel_totVis_RMS_d1_cosT_0_to_0_10);
  hist_vec_200_CT_wO_380.push_back(h_200_CT_wO_380_DR05_E_rel_totVis_RMS_d1_cosT_0_10_to_0_20);
  hist_vec_200_CT_wO_380.push_back(h_200_CT_wO_380_DR05_E_rel_totVis_RMS_d1_cosT_0_20_to_0_30);
  hist_vec_200_CT_wO_380.push_back(h_200_CT_wO_380_DR05_E_rel_totVis_RMS_d1_cosT_0_30_to_0_40);
  hist_vec_200_CT_wO_380.push_back(h_200_CT_wO_380_DR05_E_rel_totVis_RMS_d1_cosT_0_40_to_0_50);
  hist_vec_200_CT_wO_380.push_back(h_200_CT_wO_380_DR05_E_rel_totVis_RMS_d1_cosT_0_50_to_0_60);
  hist_vec_200_CT_wO_380.push_back(h_200_CT_wO_380_DR05_E_rel_totVis_RMS_d1_cosT_0_60_to_0_70);
  hist_vec_200_CT_wO_380.push_back(h_200_CT_wO_380_DR05_E_rel_totVis_RMS_d1_cosT_0_70_to_0_80);
  hist_vec_200_CT_wO_380.push_back(h_200_CT_wO_380_DR05_E_rel_totVis_RMS_d1_cosT_0_80_to_0_90);
  hist_vec_200_CT_wO_380.push_back(h_200_CT_wO_380_DR05_E_rel_totVis_RMS_d1_cosT_0_900_to_0_925);
  hist_vec_200_CT_wO_380.push_back(h_200_CT_wO_380_DR05_E_rel_totVis_RMS_d1_cosT_0_925_to_0_950);
  hist_vec_200_CT_wO_380.push_back(h_200_CT_wO_380_DR05_E_rel_totVis_RMS_d1_cosT_0_950_to_0_975);
  hist_vec_200_CT_wO_380.push_back(h_200_CT_wO_380_DR05_E_rel_totVis_RMS_d1_cosT_0_975_to_1_00);

  hist_vec_200_CT_wO_380.push_back(h_200_CT_wO_380_DR06_E_rel_totVis_RMS_d1_cosT_0_to_0_10);
  hist_vec_200_CT_wO_380.push_back(h_200_CT_wO_380_DR06_E_rel_totVis_RMS_d1_cosT_0_10_to_0_20);
  hist_vec_200_CT_wO_380.push_back(h_200_CT_wO_380_DR06_E_rel_totVis_RMS_d1_cosT_0_20_to_0_30);
  hist_vec_200_CT_wO_380.push_back(h_200_CT_wO_380_DR06_E_rel_totVis_RMS_d1_cosT_0_30_to_0_40);
  hist_vec_200_CT_wO_380.push_back(h_200_CT_wO_380_DR06_E_rel_totVis_RMS_d1_cosT_0_40_to_0_50);
  hist_vec_200_CT_wO_380.push_back(h_200_CT_wO_380_DR06_E_rel_totVis_RMS_d1_cosT_0_50_to_0_60);
  hist_vec_200_CT_wO_380.push_back(h_200_CT_wO_380_DR06_E_rel_totVis_RMS_d1_cosT_0_60_to_0_70);
  hist_vec_200_CT_wO_380.push_back(h_200_CT_wO_380_DR06_E_rel_totVis_RMS_d1_cosT_0_70_to_0_80);
  hist_vec_200_CT_wO_380.push_back(h_200_CT_wO_380_DR06_E_rel_totVis_RMS_d1_cosT_0_80_to_0_90);
  hist_vec_200_CT_wO_380.push_back(h_200_CT_wO_380_DR06_E_rel_totVis_RMS_d1_cosT_0_900_to_0_925);
  hist_vec_200_CT_wO_380.push_back(h_200_CT_wO_380_DR06_E_rel_totVis_RMS_d1_cosT_0_925_to_0_950);
  hist_vec_200_CT_wO_380.push_back(h_200_CT_wO_380_DR06_E_rel_totVis_RMS_d1_cosT_0_950_to_0_975);
  hist_vec_200_CT_wO_380.push_back(h_200_CT_wO_380_DR06_E_rel_totVis_RMS_d1_cosT_0_975_to_1_00); 

  hist_vec_200_CT_wO_380.push_back(h_200_CT_wO_380_DR07_E_rel_totVis_RMS_d1_cosT_0_to_0_10);
  hist_vec_200_CT_wO_380.push_back(h_200_CT_wO_380_DR07_E_rel_totVis_RMS_d1_cosT_0_10_to_0_20);
  hist_vec_200_CT_wO_380.push_back(h_200_CT_wO_380_DR07_E_rel_totVis_RMS_d1_cosT_0_20_to_0_30);
  hist_vec_200_CT_wO_380.push_back(h_200_CT_wO_380_DR07_E_rel_totVis_RMS_d1_cosT_0_30_to_0_40);
  hist_vec_200_CT_wO_380.push_back(h_200_CT_wO_380_DR07_E_rel_totVis_RMS_d1_cosT_0_40_to_0_50);
  hist_vec_200_CT_wO_380.push_back(h_200_CT_wO_380_DR07_E_rel_totVis_RMS_d1_cosT_0_50_to_0_60);
  hist_vec_200_CT_wO_380.push_back(h_200_CT_wO_380_DR07_E_rel_totVis_RMS_d1_cosT_0_60_to_0_70);
  hist_vec_200_CT_wO_380.push_back(h_200_CT_wO_380_DR07_E_rel_totVis_RMS_d1_cosT_0_70_to_0_80);
  hist_vec_200_CT_wO_380.push_back(h_200_CT_wO_380_DR07_E_rel_totVis_RMS_d1_cosT_0_80_to_0_90);
  hist_vec_200_CT_wO_380.push_back(h_200_CT_wO_380_DR07_E_rel_totVis_RMS_d1_cosT_0_900_to_0_925);
  hist_vec_200_CT_wO_380.push_back(h_200_CT_wO_380_DR07_E_rel_totVis_RMS_d1_cosT_0_925_to_0_950);
  hist_vec_200_CT_wO_380.push_back(h_200_CT_wO_380_DR07_E_rel_totVis_RMS_d1_cosT_0_950_to_0_975);
  hist_vec_200_CT_wO_380.push_back(h_200_CT_wO_380_DR07_E_rel_totVis_RMS_d1_cosT_0_975_to_1_00); 

  hist_vec_200_CT_wO_380.push_back(h_200_CT_wO_380_DR08_E_rel_totVis_RMS_d1_cosT_0_to_0_10);
  hist_vec_200_CT_wO_380.push_back(h_200_CT_wO_380_DR08_E_rel_totVis_RMS_d1_cosT_0_10_to_0_20);
  hist_vec_200_CT_wO_380.push_back(h_200_CT_wO_380_DR08_E_rel_totVis_RMS_d1_cosT_0_20_to_0_30);
  hist_vec_200_CT_wO_380.push_back(h_200_CT_wO_380_DR08_E_rel_totVis_RMS_d1_cosT_0_30_to_0_40);
  hist_vec_200_CT_wO_380.push_back(h_200_CT_wO_380_DR08_E_rel_totVis_RMS_d1_cosT_0_40_to_0_50);
  hist_vec_200_CT_wO_380.push_back(h_200_CT_wO_380_DR08_E_rel_totVis_RMS_d1_cosT_0_50_to_0_60);
  hist_vec_200_CT_wO_380.push_back(h_200_CT_wO_380_DR08_E_rel_totVis_RMS_d1_cosT_0_60_to_0_70);
  hist_vec_200_CT_wO_380.push_back(h_200_CT_wO_380_DR08_E_rel_totVis_RMS_d1_cosT_0_70_to_0_80);
  hist_vec_200_CT_wO_380.push_back(h_200_CT_wO_380_DR08_E_rel_totVis_RMS_d1_cosT_0_80_to_0_90);
  hist_vec_200_CT_wO_380.push_back(h_200_CT_wO_380_DR08_E_rel_totVis_RMS_d1_cosT_0_900_to_0_925);
  hist_vec_200_CT_wO_380.push_back(h_200_CT_wO_380_DR08_E_rel_totVis_RMS_d1_cosT_0_925_to_0_950);
  hist_vec_200_CT_wO_380.push_back(h_200_CT_wO_380_DR08_E_rel_totVis_RMS_d1_cosT_0_950_to_0_975);
  hist_vec_200_CT_wO_380.push_back(h_200_CT_wO_380_DR08_E_rel_totVis_RMS_d1_cosT_0_975_to_1_00); //110

  hist_vec_200_CT_wO_380.push_back(h_200_CT_wO_380_DR09_E_rel_totVis_RMS_d1_cosT_0_to_0_10);
  hist_vec_200_CT_wO_380.push_back(h_200_CT_wO_380_DR09_E_rel_totVis_RMS_d1_cosT_0_10_to_0_20);
  hist_vec_200_CT_wO_380.push_back(h_200_CT_wO_380_DR09_E_rel_totVis_RMS_d1_cosT_0_20_to_0_30);
  hist_vec_200_CT_wO_380.push_back(h_200_CT_wO_380_DR09_E_rel_totVis_RMS_d1_cosT_0_30_to_0_40);
  hist_vec_200_CT_wO_380.push_back(h_200_CT_wO_380_DR09_E_rel_totVis_RMS_d1_cosT_0_40_to_0_50);
  hist_vec_200_CT_wO_380.push_back(h_200_CT_wO_380_DR09_E_rel_totVis_RMS_d1_cosT_0_50_to_0_60);
  hist_vec_200_CT_wO_380.push_back(h_200_CT_wO_380_DR09_E_rel_totVis_RMS_d1_cosT_0_60_to_0_70);
  hist_vec_200_CT_wO_380.push_back(h_200_CT_wO_380_DR09_E_rel_totVis_RMS_d1_cosT_0_70_to_0_80);
  hist_vec_200_CT_wO_380.push_back(h_200_CT_wO_380_DR09_E_rel_totVis_RMS_d1_cosT_0_80_to_0_90);
  hist_vec_200_CT_wO_380.push_back(h_200_CT_wO_380_DR09_E_rel_totVis_RMS_d1_cosT_0_900_to_0_925);
  hist_vec_200_CT_wO_380.push_back(h_200_CT_wO_380_DR09_E_rel_totVis_RMS_d1_cosT_0_925_to_0_950);
  hist_vec_200_CT_wO_380.push_back(h_200_CT_wO_380_DR09_E_rel_totVis_RMS_d1_cosT_0_950_to_0_975);
  hist_vec_200_CT_wO_380.push_back(h_200_CT_wO_380_DR09_E_rel_totVis_RMS_d1_cosT_0_975_to_1_00); //123

  hist_vec_200_CT_wO_380.push_back(h_200_CT_wO_380_DR10_E_rel_totVis_RMS_d1_cosT_0_to_0_10);
  hist_vec_200_CT_wO_380.push_back(h_200_CT_wO_380_DR10_E_rel_totVis_RMS_d1_cosT_0_10_to_0_20);
  hist_vec_200_CT_wO_380.push_back(h_200_CT_wO_380_DR10_E_rel_totVis_RMS_d1_cosT_0_20_to_0_30);
  hist_vec_200_CT_wO_380.push_back(h_200_CT_wO_380_DR10_E_rel_totVis_RMS_d1_cosT_0_30_to_0_40);
  hist_vec_200_CT_wO_380.push_back(h_200_CT_wO_380_DR10_E_rel_totVis_RMS_d1_cosT_0_40_to_0_50);
  hist_vec_200_CT_wO_380.push_back(h_200_CT_wO_380_DR10_E_rel_totVis_RMS_d1_cosT_0_50_to_0_60);
  hist_vec_200_CT_wO_380.push_back(h_200_CT_wO_380_DR10_E_rel_totVis_RMS_d1_cosT_0_60_to_0_70);
  hist_vec_200_CT_wO_380.push_back(h_200_CT_wO_380_DR10_E_rel_totVis_RMS_d1_cosT_0_70_to_0_80);
  hist_vec_200_CT_wO_380.push_back(h_200_CT_wO_380_DR10_E_rel_totVis_RMS_d1_cosT_0_80_to_0_90);
  hist_vec_200_CT_wO_380.push_back(h_200_CT_wO_380_DR10_E_rel_totVis_RMS_d1_cosT_0_900_to_0_925);
  hist_vec_200_CT_wO_380.push_back(h_200_CT_wO_380_DR10_E_rel_totVis_RMS_d1_cosT_0_925_to_0_950);
  hist_vec_200_CT_wO_380.push_back(h_200_CT_wO_380_DR10_E_rel_totVis_RMS_d1_cosT_0_950_to_0_975);
  hist_vec_200_CT_wO_380.push_back(h_200_CT_wO_380_DR10_E_rel_totVis_RMS_d1_cosT_0_975_to_1_00); //136

  hist_vec_200_CT_wO_380.push_back(h_200_CT_wO_380_DR05_dphi_reco_gen_cosTheta_0_65);//137
  hist_vec_200_CT_wO_380.push_back(h_200_CT_wO_380_DR05_dphi_reco_gen_cosTheta_0_65_to_0_80);
  hist_vec_200_CT_wO_380.push_back(h_200_CT_wO_380_DR05_dphi_reco_gen_cosTheta_0_80_to_0_925);
  hist_vec_200_CT_wO_380.push_back(h_200_CT_wO_380_DR05_dphi_reco_gen_cosTheta_0_925_to_0_975);
  hist_vec_200_CT_wO_380.push_back(h_200_CT_wO_380_DR05_dtheta_reco_gen_cosTheta_0_65);
  hist_vec_200_CT_wO_380.push_back(h_200_CT_wO_380_DR05_dtheta_reco_gen_cosTheta_0_65_to_0_80);
  hist_vec_200_CT_wO_380.push_back(h_200_CT_wO_380_DR05_dtheta_reco_gen_cosTheta_0_80_to_0_925);
  hist_vec_200_CT_wO_380.push_back(h_200_CT_wO_380_DR05_dtheta_reco_gen_cosTheta_0_925_to_0_975);

  hist_vec_200_CT_wO_380.push_back(h_200_CT_wO_380_DR07_dphi_reco_gen_cosTheta_0_65);//145
  hist_vec_200_CT_wO_380.push_back(h_200_CT_wO_380_DR07_dphi_reco_gen_cosTheta_0_65_to_0_80);
  hist_vec_200_CT_wO_380.push_back(h_200_CT_wO_380_DR07_dphi_reco_gen_cosTheta_0_80_to_0_925);
  hist_vec_200_CT_wO_380.push_back(h_200_CT_wO_380_DR07_dphi_reco_gen_cosTheta_0_925_to_0_975);
  hist_vec_200_CT_wO_380.push_back(h_200_CT_wO_380_DR07_dtheta_reco_gen_cosTheta_0_65);
  hist_vec_200_CT_wO_380.push_back(h_200_CT_wO_380_DR07_dtheta_reco_gen_cosTheta_0_65_to_0_80);
  hist_vec_200_CT_wO_380.push_back(h_200_CT_wO_380_DR07_dtheta_reco_gen_cosTheta_0_80_to_0_925);
  hist_vec_200_CT_wO_380.push_back(h_200_CT_wO_380_DR07_dtheta_reco_gen_cosTheta_0_925_to_0_975);

  hist_vec_200_CT_wO_380.push_back(h_200_CT_wO_380_DR10_dphi_reco_gen_cosTheta_0_65);//153
  hist_vec_200_CT_wO_380.push_back(h_200_CT_wO_380_DR10_dphi_reco_gen_cosTheta_0_65_to_0_80);
  hist_vec_200_CT_wO_380.push_back(h_200_CT_wO_380_DR10_dphi_reco_gen_cosTheta_0_80_to_0_925);
  hist_vec_200_CT_wO_380.push_back(h_200_CT_wO_380_DR10_dphi_reco_gen_cosTheta_0_925_to_0_975);
  hist_vec_200_CT_wO_380.push_back(h_200_CT_wO_380_DR10_dtheta_reco_gen_cosTheta_0_65);
  hist_vec_200_CT_wO_380.push_back(h_200_CT_wO_380_DR10_dtheta_reco_gen_cosTheta_0_65_to_0_80);
  hist_vec_200_CT_wO_380.push_back(h_200_CT_wO_380_DR10_dtheta_reco_gen_cosTheta_0_80_to_0_925);
  hist_vec_200_CT_wO_380.push_back(h_200_CT_wO_380_DR10_dtheta_reco_gen_cosTheta_0_925_to_0_975);


  for(unsigned int i=0;i<hist_vec_200_CT.size();i++){
    hist_vec_200_CT_wO_380[i]->Sumw2();
  }
  fill_jet_histograms(file_CLIC_200_CT_wO_380,hist_vec_200_CT_wO_380);

  TH1F* h_200_CT_wO_380_DR05_dphi_SigmaCB_summary_histogram=new TH1F("dphiRes_SigmaCBVsCosTheta_CT_wO_380_DR05_200", "#sigma#Delta#phi(j_{reco},j_{true}) vs |cos#theta|", nRegionBinsAngles, pRegionBinEdgesAngles);
  h_200_CT_wO_380_DR05_dphi_SigmaCB_summary_histogram ->SetYTitle("#sigma#Delta#phi(j_{reco},j_{true})");
  h_200_CT_wO_380_DR05_dphi_SigmaCB_summary_histogram->SetXTitle("|cos#theta|");
  h_200_CT_wO_380_DR05_dphi_SigmaCB_summary_histogram->SetLineWidth(2);
  h_200_CT_wO_380_DR05_dphi_SigmaCB_summary_histogram->SetLineColor(kCyan+1);
  h_200_CT_wO_380_DR05_dphi_SigmaCB_summary_histogram->SetLineStyle(2);

  TH1F* h_200_CT_wO_380_DR05_dphi_RMS90_summary_histogram=new TH1F("dphiRes_RMS90VsCosTheta_CT_wO_380_DR05_200", "RMS_{90} #Delta#phi(j_{reco},j_{true}) vs |cos#theta|", nRegionBinsAngles, pRegionBinEdgesAngles);
  h_200_CT_wO_380_DR05_dphi_RMS90_summary_histogram ->SetYTitle("RMS_{90}#Delta#phi(j_{reco},j_{true})");
  h_200_CT_wO_380_DR05_dphi_RMS90_summary_histogram->SetXTitle("|cos#theta|");
  h_200_CT_wO_380_DR05_dphi_RMS90_summary_histogram->SetLineWidth(2);
  h_200_CT_wO_380_DR05_dphi_RMS90_summary_histogram->SetLineColor(kCyan+1);
  h_200_CT_wO_380_DR05_dphi_RMS90_summary_histogram->SetLineStyle(2);

  TH1F* h_200_CT_wO_380_DR07_dphi_SigmaCB_summary_histogram=new TH1F("dphiRes_SigmaCBVsCosTheta_CT_wO_380_DR07_200", "#sigma#Delta#phi(j_{reco},j_{true}) vs |cos#theta|", nRegionBinsAngles, pRegionBinEdgesAngles);
  h_200_CT_wO_380_DR07_dphi_SigmaCB_summary_histogram ->SetYTitle("#sigma#Delta#phi(j_{reco},j_{true})");
  h_200_CT_wO_380_DR07_dphi_SigmaCB_summary_histogram->SetXTitle("|cos#theta|");
  h_200_CT_wO_380_DR07_dphi_SigmaCB_summary_histogram->SetLineWidth(2);
  h_200_CT_wO_380_DR07_dphi_SigmaCB_summary_histogram->SetLineColor(kCyan+1);
  h_200_CT_wO_380_DR07_dphi_SigmaCB_summary_histogram->SetLineStyle(2);

  TH1F* h_200_CT_wO_380_DR07_dphi_RMS90_summary_histogram=new TH1F("dphiRes_RMS90VsCosTheta_CT_wO_380_DR07_200", "RMS_{90} #Delta#phi(j_{reco},j_{true}) vs |cos#theta|", nRegionBinsAngles, pRegionBinEdgesAngles);
  h_200_CT_wO_380_DR07_dphi_RMS90_summary_histogram ->SetYTitle("RMS_{90}#Delta#phi(j_{reco},j_{true})");
  h_200_CT_wO_380_DR07_dphi_RMS90_summary_histogram->SetXTitle("|cos#theta|");
  h_200_CT_wO_380_DR07_dphi_RMS90_summary_histogram->SetLineWidth(2);
  h_200_CT_wO_380_DR07_dphi_RMS90_summary_histogram->SetLineColor(kCyan+1);
  h_200_CT_wO_380_DR07_dphi_RMS90_summary_histogram->SetLineStyle(2);

  TH1F* h_200_CT_wO_380_DR10_dphi_SigmaCB_summary_histogram=new TH1F("dphiRes_SigmaCBVsCosTheta_CT_wO_380_DR10_200", "#sigma#Delta#phi(j_{reco},j_{true}) vs |cos#theta|", nRegionBinsAngles, pRegionBinEdgesAngles);
  h_200_CT_wO_380_DR10_dphi_SigmaCB_summary_histogram ->SetYTitle("#sigma#Delta#phi(j_{reco},j_{true})");
  h_200_CT_wO_380_DR10_dphi_SigmaCB_summary_histogram->SetXTitle("|cos#theta|");
  h_200_CT_wO_380_DR10_dphi_SigmaCB_summary_histogram->SetLineWidth(2);
  h_200_CT_wO_380_DR10_dphi_SigmaCB_summary_histogram->SetLineColor(kCyan+1);
  h_200_CT_wO_380_DR10_dphi_SigmaCB_summary_histogram->SetLineStyle(2);

  TH1F* h_200_CT_wO_380_DR10_dphi_RMS90_summary_histogram=new TH1F("dphiRes_RMS90VsCosTheta_CT_wO_380_DR10_200", "RMS_{90} #Delta#phi(j_{reco},j_{true}) vs |cos#theta|", nRegionBinsAngles, pRegionBinEdgesAngles);
  h_200_CT_wO_380_DR10_dphi_RMS90_summary_histogram ->SetYTitle("RMS_{90}#Delta#phi(j_{reco},j_{true})");
  h_200_CT_wO_380_DR10_dphi_RMS90_summary_histogram->SetXTitle("|cos#theta|");
  h_200_CT_wO_380_DR10_dphi_RMS90_summary_histogram->SetLineWidth(2);
  h_200_CT_wO_380_DR10_dphi_RMS90_summary_histogram->SetLineColor(kCyan+1);
  h_200_CT_wO_380_DR10_dphi_RMS90_summary_histogram->SetLineStyle(2);

  TH1F* h_200_CT_wO_380_DR05_dtheta_SigmaCB_summary_histogram=new TH1F("dthetaRes_SigmaCBVsCosTheta_CT_wO_380_DR05_200", "#sigma#Delta#theta(j_{reco},j_{true}) vs |cos#theta|", nRegionBinsAngles, pRegionBinEdgesAngles);
  h_200_CT_wO_380_DR05_dtheta_SigmaCB_summary_histogram ->SetYTitle("#sigma#Delta#theta(j_{reco},j_{true})");
  h_200_CT_wO_380_DR05_dtheta_SigmaCB_summary_histogram->SetXTitle("|cos#theta|");
  h_200_CT_wO_380_DR05_dtheta_SigmaCB_summary_histogram->SetLineWidth(2);
  h_200_CT_wO_380_DR05_dtheta_SigmaCB_summary_histogram->SetLineColor(kCyan+1);
  h_200_CT_wO_380_DR05_dtheta_SigmaCB_summary_histogram->SetLineStyle(2);

  TH1F* h_200_CT_wO_380_DR05_dtheta_RMS90_summary_histogram=new TH1F("dthetaRes_RMS90VsCosTheta_CT_wO_380_DR05_200", "RMS_{90} #Delta#theta(j_{reco},j_{true}) vs |cos#theta|", nRegionBinsAngles, pRegionBinEdgesAngles);
  h_200_CT_wO_380_DR05_dtheta_RMS90_summary_histogram ->SetYTitle("RMS_{90}#Delta#theta(j_{reco},j_{true})");
  h_200_CT_wO_380_DR05_dtheta_RMS90_summary_histogram->SetXTitle("|cos#theta|");
  h_200_CT_wO_380_DR05_dtheta_RMS90_summary_histogram->SetLineWidth(2);
  h_200_CT_wO_380_DR05_dtheta_RMS90_summary_histogram->SetLineColor(kCyan+1);
  h_200_CT_wO_380_DR05_dtheta_RMS90_summary_histogram->SetLineStyle(2);

  TH1F* h_200_CT_wO_380_DR07_dtheta_SigmaCB_summary_histogram=new TH1F("dthetaRes_SigmaCBVsCosTheta_CT_wO_380_DR07_200", "#sigma#Delta#theta(j_{reco},j_{true}) vs |cos#theta|", nRegionBinsAngles, pRegionBinEdgesAngles);
  h_200_CT_wO_380_DR07_dtheta_SigmaCB_summary_histogram ->SetYTitle("#sigma#Delta#theta(j_{reco},j_{true})");
  h_200_CT_wO_380_DR07_dtheta_SigmaCB_summary_histogram->SetXTitle("|cos#theta|");
  h_200_CT_wO_380_DR07_dtheta_SigmaCB_summary_histogram->SetLineWidth(2);
  h_200_CT_wO_380_DR07_dtheta_SigmaCB_summary_histogram->SetLineColor(kCyan+1);
  h_200_CT_wO_380_DR07_dtheta_SigmaCB_summary_histogram->SetLineStyle(2);

  TH1F* h_200_CT_wO_380_DR07_dtheta_RMS90_summary_histogram=new TH1F("dthetaRes_RMS90VsCosTheta_CT_wO_380_DR07_200", "RMS_{90} #Delta#theta(j_{reco},j_{true}) vs |cos#theta|", nRegionBinsAngles, pRegionBinEdgesAngles);
  h_200_CT_wO_380_DR07_dtheta_RMS90_summary_histogram ->SetYTitle("RMS_{90}#Delta#theta(j_{reco},j_{true})");
  h_200_CT_wO_380_DR07_dtheta_RMS90_summary_histogram->SetXTitle("|cos#theta|");
  h_200_CT_wO_380_DR07_dtheta_RMS90_summary_histogram->SetLineWidth(2);
  h_200_CT_wO_380_DR07_dtheta_RMS90_summary_histogram->SetLineColor(kCyan+1);
  h_200_CT_wO_380_DR07_dtheta_RMS90_summary_histogram->SetLineStyle(2);

  TH1F* h_200_CT_wO_380_DR10_dtheta_SigmaCB_summary_histogram=new TH1F("dthetaRes_SigmaCBVsCosTheta_CT_wO_380_DR10_200", "#sigma#Delta#theta(j_{reco},j_{true}) vs |cos#theta|", nRegionBinsAngles, pRegionBinEdgesAngles);
  h_200_CT_wO_380_DR10_dtheta_SigmaCB_summary_histogram ->SetYTitle("#sigma#Delta#theta(j_{reco},j_{true})");
  h_200_CT_wO_380_DR10_dtheta_SigmaCB_summary_histogram->SetXTitle("|cos#theta|");
  h_200_CT_wO_380_DR10_dtheta_SigmaCB_summary_histogram->SetLineWidth(2);
  h_200_CT_wO_380_DR10_dtheta_SigmaCB_summary_histogram->SetLineColor(kCyan+1);
  h_200_CT_wO_380_DR10_dtheta_SigmaCB_summary_histogram->SetLineStyle(2);

  TH1F* h_200_CT_wO_380_DR10_dtheta_RMS90_summary_histogram=new TH1F("dthetaRes_RMS90VsCosTheta_CT_wO_380_DR10_200", "RMS_{90} #Delta#theta(j_{reco},j_{true}) vs |cos#theta|", nRegionBinsAngles, pRegionBinEdgesAngles);
  h_200_CT_wO_380_DR10_dtheta_RMS90_summary_histogram ->SetYTitle("RMS_{90}#Delta#theta(j_{reco},j_{true})");
  h_200_CT_wO_380_DR10_dtheta_RMS90_summary_histogram->SetXTitle("|cos#theta|");
  h_200_CT_wO_380_DR10_dtheta_RMS90_summary_histogram->SetLineWidth(2);
  h_200_CT_wO_380_DR10_dtheta_RMS90_summary_histogram->SetLineColor(kCyan+1);
  h_200_CT_wO_380_DR10_dtheta_RMS90_summary_histogram->SetLineStyle(2);

  for(int i=137;i<161;i++){
    std::cout<<"ang histo 380 "<<i<<"]"<<std::endl;
   //double sided crystal ball
    TF1* fit_gaus_tmp = new TF1("fit_gaus_tmp", "gaus",-5.,5.);
    hist_vec_200_CT_wO_380[i]->Fit("fit_gaus_tmp","R");
    hist_vec_200_CT_wO_380[i]->GetFunction("fit_gaus_tmp");
    TF1* fdscb_tmp = new TF1("fdscb_tmp",fnc_dscb,-lim_angleDeg,lim_angleDeg,7);
   fdscb_tmp->SetNpx(2000);
    fdscb_tmp->SetParameter(0,fit_gaus_tmp->GetParameter(0));
    //norm
    fdscb_tmp->SetParLimits (0,0.5*fit_gaus_tmp->GetParameter(0),1.5*fit_gaus_tmp->GetParameter(0));
    fdscb_tmp->SetParameter(1,fit_gaus_tmp->GetParameter(1));
    //gaussian mean
    fdscb_tmp->SetParLimits (1,-2.,2.);
    fdscb_tmp->SetParameter(2,fit_gaus_tmp->GetParameter(2));
    fdscb_tmp->SetParLimits(2,fit_gaus_tmp->GetParameter(2)*0.50,1.50*fit_gaus_tmp->GetParameter(2));
    //std::vector<float>sigma2SFit=sigmaGaussianFits2Sigma(hist_vec_200_CT_wO_380[i]);
    //fdscb_tmp->SetParameter(2,sigma2SFit[0]);
    //fdscb_tmp->SetParLimits(2,sigma2SFit[0]*0.50,1.50*sigma2SFit[0]);
    //-a1: parameter, from when the gaussian core should count
    //fdscb_tmp->SetParameter(2,fit_gaus_tmp->GetParameter(2));
    fdscb_tmp->SetParameter (3,3.0);
    fdscb_tmp->SetParLimits (3,0.0,10.0);
    //a2 parameter, up to when the gaussian core should count
    fdscb_tmp->SetParameter (5,3.0);
    fdscb_tmp->SetParLimits (5,0.0,10.0);
    fdscb_tmp->SetParameter(4,5.);
    fdscb_tmp->SetParLimits(4,0.,25.);
    fdscb_tmp->SetParameter(6,5.);
    fdscb_tmp->SetParLimits(6,0.,25.);
    int fitstatus(0); 
    fitstatus = hist_vec_200_CT_wO_380[i]->Fit(fdscb_tmp,"R");
    fdscb_tmp = hist_vec_200_CT_wO_380[i]->GetFunction("fdscb_tmp");
    resolutionTH1=0; 
    resolutionErrorTH1=0;
    meanTH1=0;
    meanErrorTH1=0;
    CalculatePerformanceNoMean( hist_vec_200_CT_wO_380[i], resolutionTH1, resolutionErrorTH1,meanTH1,meanErrorTH1);
    int first_bin_ang=137;
    if(i<141){//dphi DR05
      first_bin_ang=137;
      h_200_CT_wO_380_DR05_dphi_SigmaCB_summary_histogram->SetBinContent(i-first_bin_ang+1,fdscb_tmp->GetParameter(2));
      h_200_CT_wO_380_DR05_dphi_SigmaCB_summary_histogram->SetBinError(i-first_bin_ang+1,fdscb_tmp->GetParError(2));
      h_200_CT_wO_380_DR05_dphi_RMS90_summary_histogram->SetBinContent(i-first_bin_ang+1,resolutionTH1);
      h_200_CT_wO_380_DR05_dphi_RMS90_summary_histogram->SetBinError(i-first_bin_ang+1, resolutionErrorTH1);
    }else if(i<145){//dtheta DR05
      first_bin_ang=141;
      h_200_CT_wO_380_DR05_dtheta_SigmaCB_summary_histogram->SetBinContent(i-first_bin_ang+1,fdscb_tmp->GetParameter(2));
      h_200_CT_wO_380_DR05_dtheta_SigmaCB_summary_histogram->SetBinError(i-first_bin_ang+1,fdscb_tmp->GetParError(2));
      h_200_CT_wO_380_DR05_dtheta_RMS90_summary_histogram->SetBinContent(i-first_bin_ang+1,resolutionTH1);
      h_200_CT_wO_380_DR05_dtheta_RMS90_summary_histogram->SetBinError(i-first_bin_ang+1, resolutionErrorTH1);
    }else if(i<149){//dphi DR07
      first_bin_ang=145;
      h_200_CT_wO_380_DR07_dphi_SigmaCB_summary_histogram->SetBinContent(i-first_bin_ang+1,fdscb_tmp->GetParameter(2));
      h_200_CT_wO_380_DR07_dphi_SigmaCB_summary_histogram->SetBinError(i-first_bin_ang+1,fdscb_tmp->GetParError(2));
      h_200_CT_wO_380_DR07_dphi_RMS90_summary_histogram->SetBinContent(i-first_bin_ang+1,resolutionTH1);
      h_200_CT_wO_380_DR07_dphi_RMS90_summary_histogram->SetBinError(i-first_bin_ang+1, resolutionErrorTH1);
    }else if(i<153){//dtheta DR07
      first_bin_ang=149;
      h_200_CT_wO_380_DR07_dtheta_SigmaCB_summary_histogram->SetBinContent(i-first_bin_ang+1,fdscb_tmp->GetParameter(2));
      h_200_CT_wO_380_DR07_dtheta_SigmaCB_summary_histogram->SetBinError(i-first_bin_ang+1,fdscb_tmp->GetParError(2));
      h_200_CT_wO_380_DR07_dtheta_RMS90_summary_histogram->SetBinContent(i-first_bin_ang+1,resolutionTH1);
      h_200_CT_wO_380_DR07_dtheta_RMS90_summary_histogram->SetBinError(i-first_bin_ang+1, resolutionErrorTH1);
    }else if(i<157){//dphi DR07
      first_bin_ang=153;
      h_200_CT_wO_380_DR10_dphi_SigmaCB_summary_histogram->SetBinContent(i-first_bin_ang+1,fdscb_tmp->GetParameter(2));
      h_200_CT_wO_380_DR10_dphi_SigmaCB_summary_histogram->SetBinError(i-first_bin_ang+1,fdscb_tmp->GetParError(2));
      h_200_CT_wO_380_DR10_dphi_RMS90_summary_histogram->SetBinContent(i-first_bin_ang+1,resolutionTH1);
      h_200_CT_wO_380_DR10_dphi_RMS90_summary_histogram->SetBinError(i-first_bin_ang+1, resolutionErrorTH1);
    }else if(i<161){//dtheta DR07
      first_bin_ang=157;
      h_200_CT_wO_380_DR10_dtheta_SigmaCB_summary_histogram->SetBinContent(i-first_bin_ang+1,fdscb_tmp->GetParameter(2));
      h_200_CT_wO_380_DR10_dtheta_SigmaCB_summary_histogram->SetBinError(i-first_bin_ang+1,fdscb_tmp->GetParError(2));
      h_200_CT_wO_380_DR10_dtheta_RMS90_summary_histogram->SetBinContent(i-first_bin_ang+1,resolutionTH1);
      h_200_CT_wO_380_DR10_dtheta_RMS90_summary_histogram->SetBinError(i-first_bin_ang+1, resolutionErrorTH1);
    }
  }

  TH1F* h_200_CT_wO_380_DR05_E_SigmaCB_summary_histogram=new TH1F("JER_SigmaCBVsCosTheta_CT_wO_380_DR05_200", "RMS_{90}(E_{j}^{reco}/E_{j}^{gen}) / Mean_{90}(E_{j}^{reco}/E_{j}^{gen}) vs |cos#theta|", nRegionBins, pRegionBinEdges);
  h_200_CT_wO_380_DR05_E_SigmaCB_summary_histogram ->SetYTitle("#sigma(E_{j}) / E_{j} [%]");
  h_200_CT_wO_380_DR05_E_SigmaCB_summary_histogram->SetXTitle("|cos#theta|");
  h_200_CT_wO_380_DR05_E_SigmaCB_summary_histogram->SetLineWidth(2);
  h_200_CT_wO_380_DR05_E_SigmaCB_summary_histogram->SetLineColor(kOrange);
  h_200_CT_wO_380_DR05_E_SigmaCB_summary_histogram->SetLineStyle(2);
  TH1F* h_200_CT_wO_380_DR05_E_RMS90_summary_histogram=new TH1F("JER_RMS90VsCosTheta_CT_wO_380_DR05_200", "RMS_{90}(E_{j}^{reco}/E_{j}^{gen}) / Mean_{90}(E_{j}^{reco}/E_{j}^{gen}) vs |cos#theta|", nRegionBins, pRegionBinEdges);
  h_200_CT_wO_380_DR05_E_RMS90_summary_histogram ->SetYTitle("RMS_{90}(E_{j}^{reco}/E_{j}^{gen}) / Mean_{90}(E_{j}^{reco}/E_{j}^{gen}) [%]");
  h_200_CT_wO_380_DR05_E_RMS90_summary_histogram->SetXTitle("|cos#theta|");
  h_200_CT_wO_380_DR05_E_RMS90_summary_histogram->SetLineWidth(2);
  h_200_CT_wO_380_DR05_E_RMS90_summary_histogram->SetLineColor(kRed);
  h_200_CT_wO_380_DR05_E_RMS90_summary_histogram->SetLineStyle(2);

  TH1F* h_200_CT_wO_380_DR05_E_RMS_summary_histogram=new TH1F("JER_RMSVsCosTheta_CT_wO_380_DR05_200", "RMS(E_{j}) / Mean(E_{j}) vs |cos#theta|", nRegionBins, pRegionBinEdges);
  h_200_CT_wO_380_DR05_E_RMS_summary_histogram ->SetYTitle("RMS(E_{j}) / Mean(E_{j}) [%]");
  h_200_CT_wO_380_DR05_E_RMS_summary_histogram->SetXTitle("|cos#theta|");
  h_200_CT_wO_380_DR05_E_RMS_summary_histogram->SetLineWidth(2);
  h_200_CT_wO_380_DR05_E_RMS_summary_histogram->SetLineColor(kRed);
  h_200_CT_wO_380_DR05_E_RMS_summary_histogram->SetLineStyle(2);

  TH1F* h_200_CT_wO_380_DR05_E_JER_Mean_summary_histogram=new TH1F("JER_MeanVsCosTheta_CT_wO_380_DR05_200", "Mean(E_{tot}^{RECO}/E_{tot}^{true}) vs |cos#theta|", nRegionBins, pRegionBinEdges);
  h_200_CT_wO_380_DR05_E_JER_Mean_summary_histogram->SetYTitle("Mean(E_{tot}^{RECO}/E_{tot}^{true})");
  h_200_CT_wO_380_DR05_E_JER_Mean_summary_histogram->SetXTitle("|cos#theta|");
  h_200_CT_wO_380_DR05_E_JER_Mean_summary_histogram->SetLineWidth(2);
  h_200_CT_wO_380_DR05_E_JER_Mean_summary_histogram->SetLineColor(kRed);
  h_200_CT_wO_380_DR05_E_JER_Mean_summary_histogram->SetLineStyle(2);

  firstbin=59;
  for(int i=firstbin;i<(firstbin+13);i++){
    resolutionTH1=0; 
    resolutionErrorTH1=0;
    meanTH1=0;
    meanErrorTH1=0;
    CalculatePerformance( hist_vec_200_CT_wO_380[i], resolutionTH1, resolutionErrorTH1,meanTH1,meanErrorTH1);
    h_200_CT_wO_380_DR05_E_RMS90_summary_histogram->SetBinContent(i-firstbin+1,resolutionTH1/sqrt(2.));
    h_200_CT_wO_380_DR05_E_RMS90_summary_histogram ->SetBinError(i-firstbin+1, resolutionErrorTH1/sqrt(2.));
    h_200_CT_wO_380_DR05_E_RMS_summary_histogram->SetBinContent(i-firstbin+1,hist_vec_200_CT_wO_380[i]->GetRMS()*100. );
    h_200_CT_wO_380_DR05_E_RMS_summary_histogram ->SetBinError(i-firstbin+1, hist_vec_200_CT_wO_380[i]->GetRMSError()*100.);
    h_200_CT_wO_380_DR05_E_JER_Mean_summary_histogram->SetBinContent(i-firstbin+1,hist_vec_200_CT_wO_380[i]->GetMean());
    h_200_CT_wO_380_DR05_E_JER_Mean_summary_histogram->SetBinError(i-firstbin+1,hist_vec_200_CT_wO_380[i]->GetMeanError());
    //double sided crystal ball
    TF1* fit_gaus_tmp = new TF1("fit_gaus_tmp", "gaus",0.50,1.50);
    hist_vec_200_CT_wO_380[i]->Fit("fit_gaus_tmp","R");
    hist_vec_200_CT_wO_380[i]->GetFunction("fit_gaus_tmp");

    TF1* fdscb_tmp = new TF1("fdscb_tmp",fnc_dscb,0.,3.,7);
   fdscb_tmp->SetNpx(1000);
    fdscb_tmp->SetParameter(0,fit_gaus_tmp->GetParameter(0));
    //norm
    fdscb_tmp->SetParLimits (0,0.5*fit_gaus_tmp->GetParameter(0),1.5*fit_gaus_tmp->GetParameter(0));
    fdscb_tmp->SetParameter(1,fit_gaus_tmp->GetParameter(1));
    //gaussian mean
    fdscb_tmp->SetParLimits (1,0.8,1.2);
    //fdscb_tmp->SetParameter(2,fit_gaus_tmp->GetParameter(2));
    //fdscb_tmp->SetParLimits(2,fit_gaus_tmp->GetParameter(2)*0.50,1.50*fit_gaus_tmp->GetParameter(2));
    std::vector<float>sigma2SFit=sigmaGaussianFits2Sigma(hist_vec_200_CT_wO[i]);
    fdscb_tmp->SetParameter(2,sigma2SFit[0]);
    fdscb_tmp->SetParLimits(2,sigma2SFit[0]*0.50,1.50*sigma2SFit[0]);
    //-a1: parameter, from when the gaussian core should count
    fdscb_tmp->SetParameter(2,fit_gaus_tmp->GetParameter(2));
    fdscb_tmp->SetParameter (3,3.0);
    fdscb_tmp->SetParLimits (3,0.0,10.0);
    //a2 parameter, up to when the gaussian core should count
    fdscb_tmp->SetParameter (5,3.0);
    fdscb_tmp->SetParLimits (5,0.0,10.0);
    fdscb_tmp->SetParameter(4,5.);
    fdscb_tmp->SetParLimits(4,0.,25.);
    fdscb_tmp->SetParameter(6,5.);
    fdscb_tmp->SetParLimits(6,0.,25.);
    int fitstatus(0); 
    fitstatus = hist_vec_200_CT_wO_380[i]->Fit(fdscb_tmp,"R");
    fdscb_tmp = hist_vec_200_CT_wO_380[i]->GetFunction("fdscb_tmp");
    h_200_CT_wO_380_DR05_E_SigmaCB_summary_histogram->SetBinContent(i-firstbin+1,fdscb_tmp->GetParameter(2)*100. );
    h_200_CT_wO_380_DR05_E_SigmaCB_summary_histogram->SetBinError(i-firstbin+1,fdscb_tmp->GetParError(2)*100. );
  }  
  TH1F* h_200_CT_wO_380_DR06_E_SigmaCB_summary_histogram=new TH1F("JER_SigmaCBVsCosTheta_CT_wO_380_DR06_200", "RMS_{90}(E_{j}^{reco}/E_{j}^{gen}) / Mean_{90}(E_{j}^{reco}/E_{j}^{gen}) vs |cos#theta|", nRegionBins, pRegionBinEdges);
  h_200_CT_wO_380_DR06_E_SigmaCB_summary_histogram ->SetYTitle("#sigma(E_{j}) / E_{j} [%]");
  h_200_CT_wO_380_DR06_E_SigmaCB_summary_histogram->SetXTitle("|cos#theta|");
  h_200_CT_wO_380_DR06_E_SigmaCB_summary_histogram->SetLineWidth(2);
  h_200_CT_wO_380_DR06_E_SigmaCB_summary_histogram->SetLineColor(kOrange);
  h_200_CT_wO_380_DR06_E_SigmaCB_summary_histogram->SetLineStyle(2);
  TH1F* h_200_CT_wO_380_DR06_E_RMS90_summary_histogram=new TH1F("JER_RMS90VsCosTheta_CT_wO_380_DR06_200", "RMS_{90}(E_{j}^{reco}/E_{j}^{gen}) / Mean_{90}(E_{j}^{reco}/E_{j}^{gen}) vs |cos#theta|", nRegionBins, pRegionBinEdges);
  h_200_CT_wO_380_DR06_E_RMS90_summary_histogram ->SetYTitle("RMS_{90}(E_{j}^{reco}/E_{j}^{gen}) / Mean_{90}(E_{j}^{reco}/E_{j}^{gen}) [%]");
  h_200_CT_wO_380_DR06_E_RMS90_summary_histogram->SetXTitle("|cos#theta|");
  h_200_CT_wO_380_DR06_E_RMS90_summary_histogram->SetLineWidth(2);
  h_200_CT_wO_380_DR06_E_RMS90_summary_histogram->SetLineColor(kRed);
  h_200_CT_wO_380_DR06_E_RMS90_summary_histogram->SetLineStyle(2);

  TH1F* h_200_CT_wO_380_DR06_E_RMS_summary_histogram=new TH1F("JER_RMSVsCosTheta_CT_wO_380_DR06_200", "RMS(E_{j}) / Mean(E_{j}) vs |cos#theta|", nRegionBins, pRegionBinEdges);
  h_200_CT_wO_380_DR06_E_RMS_summary_histogram ->SetYTitle("RMS(E_{j}) / Mean(E_{j}) [%]");
  h_200_CT_wO_380_DR06_E_RMS_summary_histogram->SetXTitle("|cos#theta|");
  h_200_CT_wO_380_DR06_E_RMS_summary_histogram->SetLineWidth(2);
  h_200_CT_wO_380_DR06_E_RMS_summary_histogram->SetLineColor(kRed);
  h_200_CT_wO_380_DR06_E_RMS_summary_histogram->SetLineStyle(2);

  TH1F* h_200_CT_wO_380_DR06_E_JER_Mean_summary_histogram=new TH1F("JER_MeanVsCosTheta_CT_wO_380_DR06_200", "Mean(E_{tot}^{RECO}/E_{tot}^{true}) vs |cos#theta|", nRegionBins, pRegionBinEdges);
  h_200_CT_wO_380_DR06_E_JER_Mean_summary_histogram->SetYTitle("Mean(E_{tot}^{RECO}/E_{tot}^{true})");
  h_200_CT_wO_380_DR06_E_JER_Mean_summary_histogram->SetXTitle("|cos#theta|");
  h_200_CT_wO_380_DR06_E_JER_Mean_summary_histogram->SetLineWidth(2);
  h_200_CT_wO_380_DR06_E_JER_Mean_summary_histogram->SetLineColor(kRed);
  h_200_CT_wO_380_DR06_E_JER_Mean_summary_histogram->SetLineStyle(2);
  firstbin=72;
  for(int i=firstbin;i<(firstbin+13);i++){
    resolutionTH1=0; 
    resolutionErrorTH1=0;
    meanTH1=0;
    meanErrorTH1=0;
    CalculatePerformance( hist_vec_200_CT_wO_380[i], resolutionTH1, resolutionErrorTH1,meanTH1,meanErrorTH1);
    h_200_CT_wO_380_DR06_E_RMS90_summary_histogram->SetBinContent(i-firstbin+1,resolutionTH1/sqrt(2.));
    h_200_CT_wO_380_DR06_E_RMS90_summary_histogram ->SetBinError(i-firstbin+1, resolutionErrorTH1/sqrt(2.));
    h_200_CT_wO_380_DR06_E_RMS_summary_histogram->SetBinContent(i-firstbin+1,hist_vec_200_CT_wO_380[i]->GetRMS()*100. );
    h_200_CT_wO_380_DR06_E_RMS_summary_histogram ->SetBinError(i-firstbin+1, hist_vec_200_CT_wO_380[i]->GetRMSError()*100.);
    h_200_CT_wO_380_DR06_E_JER_Mean_summary_histogram->SetBinContent(i-firstbin+1,hist_vec_200_CT_wO_380[i]->GetMean());
    h_200_CT_wO_380_DR06_E_JER_Mean_summary_histogram->SetBinError(i-firstbin+1,hist_vec_200_CT_wO_380[i]->GetMeanError());
    //double sided crystal ball
    TF1* fit_gaus_tmp = new TF1("fit_gaus_tmp", "gaus",0.50,1.50);
    hist_vec_200_CT_wO_380[i]->Fit("fit_gaus_tmp","R");
    hist_vec_200_CT_wO_380[i]->GetFunction("fit_gaus_tmp");

    TF1* fdscb_tmp = new TF1("fdscb_tmp",fnc_dscb,0.,3.,7);
   fdscb_tmp->SetNpx(1000);
    fdscb_tmp->SetParameter(0,fit_gaus_tmp->GetParameter(0));
    //norm
    fdscb_tmp->SetParLimits (0,0.5*fit_gaus_tmp->GetParameter(0),1.5*fit_gaus_tmp->GetParameter(0));
    fdscb_tmp->SetParameter(1,fit_gaus_tmp->GetParameter(1));
    //gaussian mean
    fdscb_tmp->SetParLimits (1,0.8,1.2);
    //fdscb_tmp->SetParameter(2,fit_gaus_tmp->GetParameter(2));
    //fdscb_tmp->SetParLimits(2,fit_gaus_tmp->GetParameter(2)*0.50,1.50*fit_gaus_tmp->GetParameter(2));
    std::vector<float>sigma2SFit=sigmaGaussianFits2Sigma(hist_vec_200_CT_wO_380[i]);
    fdscb_tmp->SetParameter(2,sigma2SFit[0]);
    fdscb_tmp->SetParLimits(2,sigma2SFit[0]*0.50,1.50*sigma2SFit[0]);
    //-a1: parameter, from when the gaussian core should count
    fdscb_tmp->SetParameter(2,fit_gaus_tmp->GetParameter(2));
    fdscb_tmp->SetParameter (3,3.0);
    fdscb_tmp->SetParLimits (3,0.0,10.0);
    //a2 parameter, up to when the gaussian core should count
    fdscb_tmp->SetParameter (5,3.0);
    fdscb_tmp->SetParLimits (5,0.0,10.0);
    fdscb_tmp->SetParameter(4,5.);
    fdscb_tmp->SetParLimits(4,0.,25.);
    fdscb_tmp->SetParameter(6,5.);
    fdscb_tmp->SetParLimits(6,0.,25.);
    int fitstatus(0); 
    fitstatus = hist_vec_200_CT_wO_380[i]->Fit(fdscb_tmp,"R");
    fdscb_tmp = hist_vec_200_CT_wO_380[i]->GetFunction("fdscb_tmp");
    h_200_CT_wO_380_DR06_E_SigmaCB_summary_histogram->SetBinContent(i-firstbin+1,fdscb_tmp->GetParameter(2)*100. );
    h_200_CT_wO_380_DR06_E_SigmaCB_summary_histogram->SetBinError(i-firstbin+1,fdscb_tmp->GetParError(2)*100. );
  }  
  TH1F* h_200_CT_wO_380_DR07_E_SigmaCB_summary_histogram=new TH1F("JER_SigmaCBVsCosTheta_CT_wO_380_DR07_200", "RMS_{90}(E_{j}^{reco}/E_{j}^{gen}) / Mean_{90}(E_{j}^{reco}/E_{j}^{gen}) vs |cos#theta|", nRegionBins, pRegionBinEdges);
  h_200_CT_wO_380_DR07_E_SigmaCB_summary_histogram ->SetYTitle("#sigma(E_{j}) / E_{j} [%]");
  h_200_CT_wO_380_DR07_E_SigmaCB_summary_histogram->SetXTitle("|cos#theta|");
  h_200_CT_wO_380_DR07_E_SigmaCB_summary_histogram->SetLineWidth(2);
  h_200_CT_wO_380_DR07_E_SigmaCB_summary_histogram->SetLineColor(kOrange);
  h_200_CT_wO_380_DR07_E_SigmaCB_summary_histogram->SetLineStyle(2);
  TH1F* h_200_CT_wO_380_DR07_E_RMS90_summary_histogram=new TH1F("JER_RMS90VsCosTheta_CT_wO_380_DR07_200", "RMS_{90}(E_{j}^{reco}/E_{j}^{gen}) / Mean_{90}(E_{j}^{reco}/E_{j}^{gen}) vs |cos#theta|", nRegionBins, pRegionBinEdges);
  h_200_CT_wO_380_DR07_E_RMS90_summary_histogram ->SetYTitle("RMS_{90}(E_{j}^{reco}/E_{j}^{gen}) / Mean_{90}(E_{j}^{reco}/E_{j}^{gen}) [%]");
  h_200_CT_wO_380_DR07_E_RMS90_summary_histogram->SetXTitle("|cos#theta|");
  h_200_CT_wO_380_DR07_E_RMS90_summary_histogram->SetLineWidth(2);
  h_200_CT_wO_380_DR07_E_RMS90_summary_histogram->SetLineColor(kRed);
  h_200_CT_wO_380_DR07_E_RMS90_summary_histogram->SetLineStyle(2);

  TH1F* h_200_CT_wO_380_DR07_E_RMS_summary_histogram=new TH1F("JER_RMSVsCosTheta_CT_wO_380_DR07_200", "RMS(E_{j}) / Mean(E_{j}) vs |cos#theta|", nRegionBins, pRegionBinEdges);
  h_200_CT_wO_380_DR07_E_RMS_summary_histogram ->SetYTitle("RMS(E_{j}) / Mean(E_{j}) [%]");
  h_200_CT_wO_380_DR07_E_RMS_summary_histogram->SetXTitle("|cos#theta|");
  h_200_CT_wO_380_DR07_E_RMS_summary_histogram->SetLineWidth(2);
  h_200_CT_wO_380_DR07_E_RMS_summary_histogram->SetLineColor(kRed);
  h_200_CT_wO_380_DR07_E_RMS_summary_histogram->SetLineStyle(2);

  TH1F* h_200_CT_wO_380_DR07_E_JER_Mean_summary_histogram=new TH1F("JER_MeanVsCosTheta_CT_wO_380_DR07_200", "Mean(E_{tot}^{RECO}/E_{tot}^{true}) vs |cos#theta|", nRegionBins, pRegionBinEdges);
  h_200_CT_wO_380_DR07_E_JER_Mean_summary_histogram->SetYTitle("Mean(E_{tot}^{RECO}/E_{tot}^{true})");
  h_200_CT_wO_380_DR07_E_JER_Mean_summary_histogram->SetXTitle("|cos#theta|");
  h_200_CT_wO_380_DR07_E_JER_Mean_summary_histogram->SetLineWidth(2);
  h_200_CT_wO_380_DR07_E_JER_Mean_summary_histogram->SetLineColor(kRed);
  h_200_CT_wO_380_DR07_E_JER_Mean_summary_histogram->SetLineStyle(2);
  firstbin=85;
  for(int i=firstbin;i<(firstbin+13);i++){
    resolutionTH1=0; 
    resolutionErrorTH1=0;
    meanTH1=0;
    meanErrorTH1=0;
    CalculatePerformance( hist_vec_200_CT_wO_380[i], resolutionTH1, resolutionErrorTH1,meanTH1,meanErrorTH1);
    h_200_CT_wO_380_DR07_E_RMS90_summary_histogram->SetBinContent(i-firstbin+1,resolutionTH1/sqrt(2.));
    h_200_CT_wO_380_DR07_E_RMS90_summary_histogram ->SetBinError(i-firstbin+1, resolutionErrorTH1/sqrt(2.));
    h_200_CT_wO_380_DR07_E_RMS_summary_histogram->SetBinContent(i-firstbin+1,hist_vec_200_CT_wO_380[i]->GetRMS()*100. );
    h_200_CT_wO_380_DR07_E_RMS_summary_histogram ->SetBinError(i-firstbin+1, hist_vec_200_CT_wO_380[i]->GetRMSError()*100.);
    h_200_CT_wO_380_DR07_E_JER_Mean_summary_histogram->SetBinContent(i-firstbin+1,hist_vec_200_CT_wO_380[i]->GetMean());
    h_200_CT_wO_380_DR07_E_JER_Mean_summary_histogram->SetBinError(i-firstbin+1,hist_vec_200_CT_wO_380[i]->GetMeanError());
    //double sided crystal ball
    TF1* fit_gaus_tmp = new TF1("fit_gaus_tmp", "gaus",0.50,1.50);
    hist_vec_200_CT_wO_380[i]->Fit("fit_gaus_tmp","R");
    hist_vec_200_CT_wO_380[i]->GetFunction("fit_gaus_tmp");

    TF1* fdscb_tmp = new TF1("fdscb_tmp",fnc_dscb,0.,3.,7);
   fdscb_tmp->SetNpx(1000);
    fdscb_tmp->SetParameter(0,fit_gaus_tmp->GetParameter(0));
    //norm
    fdscb_tmp->SetParLimits (0,0.5*fit_gaus_tmp->GetParameter(0),1.5*fit_gaus_tmp->GetParameter(0));
    fdscb_tmp->SetParameter(1,fit_gaus_tmp->GetParameter(1));
    //gaussian mean
    fdscb_tmp->SetParLimits (1,0.8,1.2);
    //fdscb_tmp->SetParameter(2,fit_gaus_tmp->GetParameter(2));
    //fdscb_tmp->SetParLimits(2,fit_gaus_tmp->GetParameter(2)*0.50,1.50*fit_gaus_tmp->GetParameter(2));
    std::vector<float>sigma2SFit=sigmaGaussianFits2Sigma(hist_vec_200_CT_wO_380[i]);
    fdscb_tmp->SetParameter(2,sigma2SFit[0]);
    fdscb_tmp->SetParLimits(2,sigma2SFit[0]*0.50,1.50*sigma2SFit[0]);
    //-a1: parameter, from when the gaussian core should count
    fdscb_tmp->SetParameter(2,fit_gaus_tmp->GetParameter(2));
    fdscb_tmp->SetParameter (3,3.0);
    fdscb_tmp->SetParLimits (3,0.0,10.0);
    //a2 parameter, up to when the gaussian core should count
    fdscb_tmp->SetParameter (5,3.0);
    fdscb_tmp->SetParLimits (5,0.0,10.0);
    fdscb_tmp->SetParameter(4,5.);
    fdscb_tmp->SetParLimits(4,0.,25.);
    fdscb_tmp->SetParameter(6,5.);
    fdscb_tmp->SetParLimits(6,0.,25.);
    int fitstatus(0); 
    fitstatus = hist_vec_200_CT_wO_380[i]->Fit(fdscb_tmp,"R");
    fdscb_tmp = hist_vec_200_CT_wO_380[i]->GetFunction("fdscb_tmp");
    h_200_CT_wO_380_DR07_E_SigmaCB_summary_histogram->SetBinContent(i-firstbin+1,fdscb_tmp->GetParameter(2)*100. );
    h_200_CT_wO_380_DR07_E_SigmaCB_summary_histogram->SetBinError(i-firstbin+1,fdscb_tmp->GetParError(2)*100. );
  }  

  TH1F* h_200_CT_wO_380_DR08_E_SigmaCB_summary_histogram=new TH1F("JER_SigmaCBVsCosTheta_CT_wO_380_DR08_200", "RMS_{90}(E_{j}^{reco}/E_{j}^{gen}) / Mean_{90}(E_{j}^{reco}/E_{j}^{gen}) vs |cos#theta|", nRegionBins, pRegionBinEdges);
  h_200_CT_wO_380_DR08_E_SigmaCB_summary_histogram ->SetYTitle("#sigma(E_{j}) / E_{j} [%]");
  h_200_CT_wO_380_DR08_E_SigmaCB_summary_histogram->SetXTitle("|cos#theta|");
  h_200_CT_wO_380_DR08_E_SigmaCB_summary_histogram->SetLineWidth(2);
  h_200_CT_wO_380_DR08_E_SigmaCB_summary_histogram->SetLineColor(kOrange);
  h_200_CT_wO_380_DR08_E_SigmaCB_summary_histogram->SetLineStyle(2);
  TH1F* h_200_CT_wO_380_DR08_E_RMS90_summary_histogram=new TH1F("JER_RMS90VsCosTheta_CT_wO_380_DR08_200", "RMS_{90}(E_{j}^{reco}/E_{j}^{gen}) / Mean_{90}(E_{j}^{reco}/E_{j}^{gen}) vs |cos#theta|", nRegionBins, pRegionBinEdges);
  h_200_CT_wO_380_DR08_E_RMS90_summary_histogram ->SetYTitle("RMS_{90}(E_{j}^{reco}/E_{j}^{gen}) / Mean_{90}(E_{j}^{reco}/E_{j}^{gen}) [%]");
  h_200_CT_wO_380_DR08_E_RMS90_summary_histogram->SetXTitle("|cos#theta|");
  h_200_CT_wO_380_DR08_E_RMS90_summary_histogram->SetLineWidth(2);
  h_200_CT_wO_380_DR08_E_RMS90_summary_histogram->SetLineColor(kRed);
  h_200_CT_wO_380_DR08_E_RMS90_summary_histogram->SetLineStyle(2);

  TH1F* h_200_CT_wO_380_DR08_E_RMS_summary_histogram=new TH1F("JER_RMSVsCosTheta_CT_wO_380_DR08_200", "RMS(E_{j}) / Mean(E_{j}) vs |cos#theta|", nRegionBins, pRegionBinEdges);
  h_200_CT_wO_380_DR08_E_RMS_summary_histogram ->SetYTitle("RMS(E_{j}) / Mean(E_{j}) [%]");
  h_200_CT_wO_380_DR08_E_RMS_summary_histogram->SetXTitle("|cos#theta|");
  h_200_CT_wO_380_DR08_E_RMS_summary_histogram->SetLineWidth(2);
  h_200_CT_wO_380_DR08_E_RMS_summary_histogram->SetLineColor(kRed);
  h_200_CT_wO_380_DR08_E_RMS_summary_histogram->SetLineStyle(2);

  TH1F* h_200_CT_wO_380_DR08_E_JER_Mean_summary_histogram=new TH1F("JER_MeanVsCosTheta_CT_wO_380_DR08_200", "Mean(E_{tot}^{RECO}/E_{tot}^{true}) vs |cos#theta|", nRegionBins, pRegionBinEdges);
  h_200_CT_wO_380_DR08_E_JER_Mean_summary_histogram->SetYTitle("Mean(E_{tot}^{RECO}/E_{tot}^{true})");
  h_200_CT_wO_380_DR08_E_JER_Mean_summary_histogram->SetXTitle("|cos#theta|");
  h_200_CT_wO_380_DR08_E_JER_Mean_summary_histogram->SetLineWidth(2);
  h_200_CT_wO_380_DR08_E_JER_Mean_summary_histogram->SetLineColor(kRed);
  h_200_CT_wO_380_DR08_E_JER_Mean_summary_histogram->SetLineStyle(2);
  firstbin=98;
  for(int i=firstbin;i<(firstbin+13);i++){
    resolutionTH1=0; 
    resolutionErrorTH1=0;
    meanTH1=0;
    meanErrorTH1=0;
    CalculatePerformance( hist_vec_200_CT_wO_380[i], resolutionTH1, resolutionErrorTH1,meanTH1,meanErrorTH1);
    h_200_CT_wO_380_DR08_E_RMS90_summary_histogram->SetBinContent(i-firstbin+1,resolutionTH1/sqrt(2.));
    h_200_CT_wO_380_DR08_E_RMS90_summary_histogram ->SetBinError(i-firstbin+1, resolutionErrorTH1/sqrt(2.));
    h_200_CT_wO_380_DR08_E_RMS_summary_histogram->SetBinContent(i-firstbin+1,hist_vec_200_CT_wO_380[i]->GetRMS()*100. );
    h_200_CT_wO_380_DR08_E_RMS_summary_histogram ->SetBinError(i-firstbin+1, hist_vec_200_CT_wO_380[i]->GetRMSError()*100.);
    h_200_CT_wO_380_DR08_E_JER_Mean_summary_histogram->SetBinContent(i-firstbin+1,hist_vec_200_CT_wO_380[i]->GetMean());
    h_200_CT_wO_380_DR08_E_JER_Mean_summary_histogram->SetBinError(i-firstbin+1,hist_vec_200_CT_wO_380[i]->GetMeanError());
    //double sided crystal ball
    TF1* fit_gaus_tmp = new TF1("fit_gaus_tmp", "gaus",0.50,1.50);
    hist_vec_200_CT_wO_380[i]->Fit("fit_gaus_tmp","R");
    hist_vec_200_CT_wO_380[i]->GetFunction("fit_gaus_tmp");

    TF1* fdscb_tmp = new TF1("fdscb_tmp",fnc_dscb,0.,3.,7);
   fdscb_tmp->SetNpx(1000);
    fdscb_tmp->SetParameter(0,fit_gaus_tmp->GetParameter(0));
    //norm
    fdscb_tmp->SetParLimits (0,0.5*fit_gaus_tmp->GetParameter(0),1.5*fit_gaus_tmp->GetParameter(0));
    fdscb_tmp->SetParameter(1,fit_gaus_tmp->GetParameter(1));
    //gaussian mean
    fdscb_tmp->SetParLimits (1,0.8,1.2);
    //fdscb_tmp->SetParameter(2,fit_gaus_tmp->GetParameter(2));
    //fdscb_tmp->SetParLimits(2,fit_gaus_tmp->GetParameter(2)*0.50,1.50*fit_gaus_tmp->GetParameter(2));
    std::vector<float>sigma2SFit=sigmaGaussianFits2Sigma(hist_vec_200_CT_wO_380[i]);
    fdscb_tmp->SetParameter(2,sigma2SFit[0]);
    fdscb_tmp->SetParLimits(2,sigma2SFit[0]*0.50,1.50*sigma2SFit[0]);
    //-a1: parameter, from when the gaussian core should count
    fdscb_tmp->SetParameter(2,fit_gaus_tmp->GetParameter(2));
    fdscb_tmp->SetParameter (3,3.0);
    fdscb_tmp->SetParLimits (3,0.0,10.0);
    //a2 parameter, up to when the gaussian core should count
    fdscb_tmp->SetParameter (5,3.0);
    fdscb_tmp->SetParLimits (5,0.0,10.0);
    fdscb_tmp->SetParameter(4,5.);
    fdscb_tmp->SetParLimits(4,0.,25.);
    fdscb_tmp->SetParameter(6,5.);
    fdscb_tmp->SetParLimits(6,0.,25.);
    int fitstatus(0); 
    fitstatus = hist_vec_200_CT_wO_380[i]->Fit(fdscb_tmp,"R");
    fdscb_tmp = hist_vec_200_CT_wO_380[i]->GetFunction("fdscb_tmp");
    h_200_CT_wO_380_DR08_E_SigmaCB_summary_histogram->SetBinContent(i-firstbin+1,fdscb_tmp->GetParameter(2)*100. );
    h_200_CT_wO_380_DR08_E_SigmaCB_summary_histogram->SetBinError(i-firstbin+1,fdscb_tmp->GetParError(2)*100. );
  }  
  TH1F* h_200_CT_wO_380_DR09_E_SigmaCB_summary_histogram=new TH1F("JER_SigmaCBVsCosTheta_CT_wO_380_DR09_200", "RMS_{90}(E_{j}^{reco}/E_{j}^{gen}) / Mean_{90}(E_{j}^{reco}/E_{j}^{gen}) vs |cos#theta|", nRegionBins, pRegionBinEdges);
  h_200_CT_wO_380_DR09_E_SigmaCB_summary_histogram ->SetYTitle("#sigma(E_{j}) / E_{j} [%]");
  h_200_CT_wO_380_DR09_E_SigmaCB_summary_histogram->SetXTitle("|cos#theta|");
  h_200_CT_wO_380_DR09_E_SigmaCB_summary_histogram->SetLineWidth(2);
  h_200_CT_wO_380_DR09_E_SigmaCB_summary_histogram->SetLineColor(kOrange);
  h_200_CT_wO_380_DR09_E_SigmaCB_summary_histogram->SetLineStyle(2);
  TH1F* h_200_CT_wO_380_DR09_E_RMS90_summary_histogram=new TH1F("JER_RMS90VsCosTheta_CT_wO_380_DR09_200", "RMS_{90}(E_{j}^{reco}/E_{j}^{gen}) / Mean_{90}(E_{j}^{reco}/E_{j}^{gen}) vs |cos#theta|", nRegionBins, pRegionBinEdges);
  h_200_CT_wO_380_DR09_E_RMS90_summary_histogram ->SetYTitle("RMS_{90}(E_{j}^{reco}/E_{j}^{gen}) / Mean_{90}(E_{j}^{reco}/E_{j}^{gen}) [%]");
  h_200_CT_wO_380_DR09_E_RMS90_summary_histogram->SetXTitle("|cos#theta|");
  h_200_CT_wO_380_DR09_E_RMS90_summary_histogram->SetLineWidth(2);
  h_200_CT_wO_380_DR09_E_RMS90_summary_histogram->SetLineColor(kRed);
  h_200_CT_wO_380_DR09_E_RMS90_summary_histogram->SetLineStyle(2);

  TH1F* h_200_CT_wO_380_DR09_E_RMS_summary_histogram=new TH1F("JER_RMSVsCosTheta_CT_wO_380_DR09_200", "RMS(E_{j}) / Mean(E_{j}) vs |cos#theta|", nRegionBins, pRegionBinEdges);
  h_200_CT_wO_380_DR09_E_RMS_summary_histogram ->SetYTitle("RMS(E_{j}) / Mean(E_{j}) [%]");
  h_200_CT_wO_380_DR09_E_RMS_summary_histogram->SetXTitle("|cos#theta|");
  h_200_CT_wO_380_DR09_E_RMS_summary_histogram->SetLineWidth(2);
  h_200_CT_wO_380_DR09_E_RMS_summary_histogram->SetLineColor(kRed);
  h_200_CT_wO_380_DR09_E_RMS_summary_histogram->SetLineStyle(2);

  TH1F* h_200_CT_wO_380_DR09_E_JER_Mean_summary_histogram=new TH1F("JER_MeanVsCosTheta_CT_wO_380_DR09_200", "Mean(E_{tot}^{RECO}/E_{tot}^{true}) vs |cos#theta|", nRegionBins, pRegionBinEdges);
  h_200_CT_wO_380_DR09_E_JER_Mean_summary_histogram->SetYTitle("Mean(E_{tot}^{RECO}/E_{tot}^{true})");
  h_200_CT_wO_380_DR09_E_JER_Mean_summary_histogram->SetXTitle("|cos#theta|");
  h_200_CT_wO_380_DR09_E_JER_Mean_summary_histogram->SetLineWidth(2);
  h_200_CT_wO_380_DR09_E_JER_Mean_summary_histogram->SetLineColor(kRed);
  h_200_CT_wO_380_DR09_E_JER_Mean_summary_histogram->SetLineStyle(2);
  firstbin=111;
  for(int i=firstbin;i<(firstbin+13);i++){
    resolutionTH1=0; 
    resolutionErrorTH1=0;
    meanTH1=0;
    meanErrorTH1=0;
    CalculatePerformance( hist_vec_200_CT_wO_380[i], resolutionTH1, resolutionErrorTH1,meanTH1,meanErrorTH1);
    h_200_CT_wO_380_DR09_E_RMS90_summary_histogram->SetBinContent(i-firstbin+1,resolutionTH1/sqrt(2.));
    h_200_CT_wO_380_DR09_E_RMS90_summary_histogram ->SetBinError(i-firstbin+1, resolutionErrorTH1/sqrt(2.));
    h_200_CT_wO_380_DR09_E_RMS_summary_histogram->SetBinContent(i-firstbin+1,hist_vec_200_CT_wO_380[i]->GetRMS()*100. );
    h_200_CT_wO_380_DR09_E_RMS_summary_histogram ->SetBinError(i-firstbin+1, hist_vec_200_CT_wO_380[i]->GetRMSError()*100.);
    h_200_CT_wO_380_DR09_E_JER_Mean_summary_histogram->SetBinContent(i-firstbin+1,hist_vec_200_CT_wO_380[i]->GetMean());
    h_200_CT_wO_380_DR09_E_JER_Mean_summary_histogram->SetBinError(i-firstbin+1,hist_vec_200_CT_wO_380[i]->GetMeanError());
    //double sided crystal ball
    TF1* fit_gaus_tmp = new TF1("fit_gaus_tmp", "gaus",0.50,1.50);
    hist_vec_200_CT_wO_380[i]->Fit("fit_gaus_tmp","R");
    hist_vec_200_CT_wO_380[i]->GetFunction("fit_gaus_tmp");

    TF1* fdscb_tmp = new TF1("fdscb_tmp",fnc_dscb,0.,3.,7);
   fdscb_tmp->SetNpx(1000);
    fdscb_tmp->SetParameter(0,fit_gaus_tmp->GetParameter(0));
    //norm
    fdscb_tmp->SetParLimits (0,0.5*fit_gaus_tmp->GetParameter(0),1.5*fit_gaus_tmp->GetParameter(0));
    fdscb_tmp->SetParameter(1,fit_gaus_tmp->GetParameter(1));
    //gaussian mean
    fdscb_tmp->SetParLimits (1,0.8,1.2);
    //fdscb_tmp->SetParameter(2,fit_gaus_tmp->GetParameter(2));
    //fdscb_tmp->SetParLimits(2,fit_gaus_tmp->GetParameter(2)*0.50,1.50*fit_gaus_tmp->GetParameter(2));
    std::vector<float>sigma2SFit=sigmaGaussianFits2Sigma(hist_vec_200_CT_wO_380[i]);
    fdscb_tmp->SetParameter(2,sigma2SFit[0]);
    fdscb_tmp->SetParLimits(2,sigma2SFit[0]*0.50,1.50*sigma2SFit[0]);
    //-a1: parameter, from when the gaussian core should count
    fdscb_tmp->SetParameter(2,fit_gaus_tmp->GetParameter(2));
    fdscb_tmp->SetParameter (3,3.0);
    fdscb_tmp->SetParLimits (3,0.0,10.0);
    //a2 parameter, up to when the gaussian core should count
    fdscb_tmp->SetParameter (5,3.0);
    fdscb_tmp->SetParLimits (5,0.0,10.0);
    fdscb_tmp->SetParameter(4,5.);
    fdscb_tmp->SetParLimits(4,0.,25.);
    fdscb_tmp->SetParameter(6,5.);
    fdscb_tmp->SetParLimits(6,0.,25.);
    int fitstatus(0); 
    fitstatus = hist_vec_200_CT_wO_380[i]->Fit(fdscb_tmp,"R");
    fdscb_tmp = hist_vec_200_CT_wO_380[i]->GetFunction("fdscb_tmp");
    h_200_CT_wO_380_DR09_E_SigmaCB_summary_histogram->SetBinContent(i-firstbin+1,fdscb_tmp->GetParameter(2)*100. );
    h_200_CT_wO_380_DR09_E_SigmaCB_summary_histogram->SetBinError(i-firstbin+1,fdscb_tmp->GetParError(2)*100. );
  }  
  TH1F* h_200_CT_wO_380_DR10_E_SigmaCB_summary_histogram=new TH1F("JER_SigmaCBVsCosTheta_CT_wO_380_DR10_200", "RMS_{90}(E_{j}^{reco}/E_{j}^{gen}) / Mean_{90}(E_{j}^{reco}/E_{j}^{gen}) vs |cos#theta|", nRegionBins, pRegionBinEdges);
  h_200_CT_wO_380_DR10_E_SigmaCB_summary_histogram ->SetYTitle("#sigma(E_{j}) / E_{j} [%]");
  h_200_CT_wO_380_DR10_E_SigmaCB_summary_histogram->SetXTitle("|cos#theta|");
  h_200_CT_wO_380_DR10_E_SigmaCB_summary_histogram->SetLineWidth(2);
  h_200_CT_wO_380_DR10_E_SigmaCB_summary_histogram->SetLineColor(kOrange);
  h_200_CT_wO_380_DR10_E_SigmaCB_summary_histogram->SetLineStyle(2);
  TH1F* h_200_CT_wO_380_DR10_E_RMS90_summary_histogram=new TH1F("JER_RMS90VsCosTheta_CT_wO_380_DR10_200", "RMS_{90}(E_{j}^{reco}/E_{j}^{gen}) / Mean_{90}(E_{j}^{reco}/E_{j}^{gen}) vs |cos#theta|", nRegionBins, pRegionBinEdges);
  h_200_CT_wO_380_DR10_E_RMS90_summary_histogram ->SetYTitle("RMS_{90}(E_{j}^{reco}/E_{j}^{gen}) / Mean_{90}(E_{j}^{reco}/E_{j}^{gen}) [%]");
  h_200_CT_wO_380_DR10_E_RMS90_summary_histogram->SetXTitle("|cos#theta|");
  h_200_CT_wO_380_DR10_E_RMS90_summary_histogram->SetLineWidth(2);
  h_200_CT_wO_380_DR10_E_RMS90_summary_histogram->SetLineColor(kRed);
  h_200_CT_wO_380_DR10_E_RMS90_summary_histogram->SetLineStyle(2);

  TH1F* h_200_CT_wO_380_DR10_E_RMS_summary_histogram=new TH1F("JER_RMSVsCosTheta_CT_wO_380_DR10_200", "RMS(E_{j}) / Mean(E_{j}) vs |cos#theta|", nRegionBins, pRegionBinEdges);
  h_200_CT_wO_380_DR10_E_RMS_summary_histogram ->SetYTitle("RMS(E_{j}) / Mean(E_{j}) [%]");
  h_200_CT_wO_380_DR10_E_RMS_summary_histogram->SetXTitle("|cos#theta|");
  h_200_CT_wO_380_DR10_E_RMS_summary_histogram->SetLineWidth(2);
  h_200_CT_wO_380_DR10_E_RMS_summary_histogram->SetLineColor(kRed);
  h_200_CT_wO_380_DR10_E_RMS_summary_histogram->SetLineStyle(2);

  TH1F* h_200_CT_wO_380_DR10_E_JER_Mean_summary_histogram=new TH1F("JER_MeanVsCosTheta_CT_wO_380_DR10_200", "Mean(E_{tot}^{RECO}/E_{tot}^{true}) vs |cos#theta|", nRegionBins, pRegionBinEdges);
  h_200_CT_wO_380_DR10_E_JER_Mean_summary_histogram->SetYTitle("Mean(E_{tot}^{RECO}/E_{tot}^{true})");
  h_200_CT_wO_380_DR10_E_JER_Mean_summary_histogram->SetXTitle("|cos#theta|");
  h_200_CT_wO_380_DR10_E_JER_Mean_summary_histogram->SetLineWidth(2);
  h_200_CT_wO_380_DR10_E_JER_Mean_summary_histogram->SetLineColor(kRed);
  h_200_CT_wO_380_DR10_E_JER_Mean_summary_histogram->SetLineStyle(2);
  firstbin=124;
  for(int i=firstbin;i<(firstbin+13);i++){
    resolutionTH1=0; 
    resolutionErrorTH1=0;
    meanTH1=0;
    meanErrorTH1=0;
    CalculatePerformance( hist_vec_200_CT_wO_380[i], resolutionTH1, resolutionErrorTH1,meanTH1,meanErrorTH1);
    h_200_CT_wO_380_DR10_E_RMS90_summary_histogram->SetBinContent(i-firstbin+1,resolutionTH1/sqrt(2.));
    h_200_CT_wO_380_DR10_E_RMS90_summary_histogram ->SetBinError(i-firstbin+1, resolutionErrorTH1/sqrt(2.));
    h_200_CT_wO_380_DR10_E_RMS_summary_histogram->SetBinContent(i-firstbin+1,hist_vec_200_CT_wO_380[i]->GetRMS()*100. );
    h_200_CT_wO_380_DR10_E_RMS_summary_histogram ->SetBinError(i-firstbin+1, hist_vec_200_CT_wO_380[i]->GetRMSError()*100.);
    h_200_CT_wO_380_DR10_E_JER_Mean_summary_histogram->SetBinContent(i-firstbin+1,hist_vec_200_CT_wO_380[i]->GetMean());
    h_200_CT_wO_380_DR10_E_JER_Mean_summary_histogram->SetBinError(i-firstbin+1,hist_vec_200_CT_wO_380[i]->GetMeanError());
    //double sided crystal ball
    TF1* fit_gaus_tmp = new TF1("fit_gaus_tmp", "gaus",0.50,1.50);
    hist_vec_200_CT_wO_380[i]->Fit("fit_gaus_tmp","R");
    hist_vec_200_CT_wO_380[i]->GetFunction("fit_gaus_tmp");

    TF1* fdscb_tmp = new TF1("fdscb_tmp",fnc_dscb,0.,3.,7);
   fdscb_tmp->SetNpx(1000);
    fdscb_tmp->SetParameter(0,fit_gaus_tmp->GetParameter(0));
    //norm
    fdscb_tmp->SetParLimits (0,0.5*fit_gaus_tmp->GetParameter(0),1.5*fit_gaus_tmp->GetParameter(0));
    fdscb_tmp->SetParameter(1,fit_gaus_tmp->GetParameter(1));
    //gaussian mean
    fdscb_tmp->SetParLimits (1,0.8,1.2);
    //fdscb_tmp->SetParameter(2,fit_gaus_tmp->GetParameter(2));
    //fdscb_tmp->SetParLimits(2,fit_gaus_tmp->GetParameter(2)*0.50,1.50*fit_gaus_tmp->GetParameter(2));
    std::vector<float>sigma2SFit=sigmaGaussianFits2Sigma(hist_vec_200_CT_wO_380[i]);
    fdscb_tmp->SetParameter(2,sigma2SFit[0]);
    fdscb_tmp->SetParLimits(2,sigma2SFit[0]*0.50,1.50*sigma2SFit[0]);
    //-a1: parameter, from when the gaussian core should count
    fdscb_tmp->SetParameter(2,fit_gaus_tmp->GetParameter(2));
    fdscb_tmp->SetParameter (3,3.0);
    fdscb_tmp->SetParLimits (3,0.0,10.0);
    //a2 parameter, up to when the gaussian core should count
    fdscb_tmp->SetParameter (5,3.0);
    fdscb_tmp->SetParLimits (5,0.0,10.0);
    fdscb_tmp->SetParameter(4,5.);
    fdscb_tmp->SetParLimits(4,0.,25.);
    fdscb_tmp->SetParameter(6,5.);
    fdscb_tmp->SetParLimits(6,0.,25.);
    int fitstatus(0); 
    fitstatus = hist_vec_200_CT_wO_380[i]->Fit(fdscb_tmp,"R");
    fdscb_tmp = hist_vec_200_CT_wO_380[i]->GetFunction("fdscb_tmp");
    h_200_CT_wO_380_DR10_E_SigmaCB_summary_histogram->SetBinContent(i-firstbin+1,fdscb_tmp->GetParameter(2)*100. );
    h_200_CT_wO_380_DR10_E_SigmaCB_summary_histogram->SetBinError(i-firstbin+1,fdscb_tmp->GetParError(2)*100. );
  }  

  //now 100 380 GeV conditions
  TH1F* h_100_CT_wO_380_genjet03_dphi_j1j2 =  new TH1F("h_100_CT_wO_380_genjet03_dphi_j1j2","", n_bins100, 0.5,TMath::Pi());
  TH1F* h_100_CT_wO_380_genjet03_E1_E2_over_E_True =  new TH1F("h_100_CT_wO_380_genjet03_E1_E2_over_E_True","", n_bins100, 0.5,1.00);
  TH1F* h_100_CT_wO_380_genjet03_Delta_E1_E2_over_E12 =  new TH1F("h_100_CT_wO_380_genjet03_Delta_E1_E2_over_E12","", n_bins100, -0.5,0.5);
  TH1F* h_100_CT_wO_380_genjet04_dphi_j1j2 =  new TH1F("h_100_CT_wO_380_genjet04_dphi_j1j2","", n_bins100, 0.5,TMath::Pi());
  TH1F* h_100_CT_wO_380_genjet04_E1_E2_over_E_True =  new TH1F("h_100_CT_wO_380_genjet04_E1_E2_over_E_True","", n_bins100, 0.5,1.00);
  TH1F* h_100_CT_wO_380_genjet04_Delta_E1_E2_over_E12 =  new TH1F("h_100_CT_wO_380_genjet04_Delta_E1_E2_over_E12","", n_bins100, -0.5,0.5);
  TH1F* h_100_CT_wO_380_genjet05_dphi_j1j2 =  new TH1F("h_100_CT_wO_380_genjet05_dphi_j1j2","", n_bins100, 0.5,TMath::Pi());
  TH1F* h_100_CT_wO_380_genjet05_E1_E2_over_E_True =  new TH1F("h_100_CT_wO_380_genjet05_E1_E2_over_E_True","", n_bins100, 0.5,1.00);
  TH1F* h_100_CT_wO_380_genjet05_Delta_E1_E2_over_E12 =  new TH1F("h_100_CT_wO_380_genjet05_Delta_E1_E2_over_E12","", n_bins100, -0.5,0.5);
  TH1F* h_100_CT_wO_380_genjet06_dphi_j1j2 =  new TH1F("h_100_CT_wO_380_genjet06_dphi_j1j2","", n_bins100, 0.5,TMath::Pi());
  TH1F* h_100_CT_wO_380_genjet06_E1_E2_over_E_True =  new TH1F("h_100_CT_wO_380_genjet06_E1_E2_over_E_True","", n_bins100, 0.5,1.00);
  TH1F* h_100_CT_wO_380_genjet06_Delta_E1_E2_over_E12 =  new TH1F("h_100_CT_wO_380_genjet06_Delta_E1_E2_over_E12","", n_bins100, -0.5,0.5);
  TH1F* h_100_CT_wO_380_genjet07_dphi_j1j2 =  new TH1F("h_100_CT_wO_380_genjet07_dphi_j1j2","", n_bins100, 0.5,TMath::Pi());
  TH1F* h_100_CT_wO_380_genjet07_E1_E2_over_E_True =  new TH1F("h_100_CT_wO_380_genjet07_E1_E2_over_E_True","", n_bins100, 0.5,1.00);
  TH1F* h_100_CT_wO_380_genjet07_Delta_E1_E2_over_E12 =  new TH1F("h_100_CT_wO_380_genjet07_Delta_E1_E2_over_E12","", n_bins100, -0.5,0.5);
  TH1F* h_100_CT_wO_380_genjet08_dphi_j1j2 =  new TH1F("h_100_CT_wO_380_genjet08_dphi_j1j2","", n_bins100, 0.5,TMath::Pi());
  TH1F* h_100_CT_wO_380_genjet08_E1_E2_over_E_True =  new TH1F("h_100_CT_wO_380_genjet08_E1_E2_over_E_True","", n_bins100, 0.5,1.00);
  TH1F* h_100_CT_wO_380_genjet08_Delta_E1_E2_over_E12 =  new TH1F("h_100_CT_wO_380_genjet08_Delta_E1_E2_over_E12","", n_bins100, -0.5,0.5);
  TH1F* h_100_CT_wO_380_genjet09_dphi_j1j2 =  new TH1F("h_100_CT_wO_380_genjet09_dphi_j1j2","", n_bins100, 0.5,TMath::Pi());
  TH1F* h_100_CT_wO_380_genjet09_E1_E2_over_E_True =  new TH1F("h_100_CT_wO_380_genjet09_E1_E2_over_E_True","", n_bins100, 0.5,1.00);
  TH1F* h_100_CT_wO_380_genjet09_Delta_E1_E2_over_E12 =  new TH1F("h_100_CT_wO_380_genjet09_Delta_E1_E2_over_E12","", n_bins100, -0.5,0.5);
  TH1F* h_100_CT_wO_380_genjet10_dphi_j1j2 =  new TH1F("h_100_CT_wO_380_genjet10_dphi_j1j2","", n_bins100, 0.5,TMath::Pi());
  TH1F* h_100_CT_wO_380_genjet10_E1_E2_over_E_True =  new TH1F("h_100_CT_wO_380_genjet10_E1_E2_over_E_True","", n_bins100, 0.5,1.00);
  TH1F* h_100_CT_wO_380_genjet10_Delta_E1_E2_over_E12 =  new TH1F("h_100_CT_wO_380_genjet10_Delta_E1_E2_over_E12","", n_bins100, -0.5,0.5);

  TH1F* h_100_CT_wO_380_recojet03_dphi_j1j2 =  new TH1F("h_100_CT_wO_380_recojet03_dphi_j1j2","", n_bins100, 0.5,TMath::Pi());
  TH1F* h_100_CT_wO_380_recojet03_E1_E2_over_E_True =  new TH1F("h_100_CT_wO_380_recojet03_E1_E2_over_E_True","", n_bins100, 0.5,1.00);
  TH1F* h_100_CT_wO_380_recojet03_Delta_E1_E2_over_E12 =  new TH1F("h_100_CT_wO_380_recojet03_Delta_E1_E2_over_E12","", n_bins100, -0.5,0.5);
  TH1F* h_100_CT_wO_380_recojet04_dphi_j1j2 =  new TH1F("h_100_CT_wO_380_recojet04_dphi_j1j2","", n_bins100, 0.5,TMath::Pi());
  TH1F* h_100_CT_wO_380_recojet04_E1_E2_over_E_True =  new TH1F("h_100_CT_wO_380_recojet04_E1_E2_over_E_True","", n_bins100, 0.5,1.00);
  TH1F* h_100_CT_wO_380_recojet04_Delta_E1_E2_over_E12 =  new TH1F("h_100_CT_wO_380_recojet04_Delta_E1_E2_over_E12","", n_bins100, -0.5,0.5);
  TH1F* h_100_CT_wO_380_recojet05_dphi_j1j2 =  new TH1F("h_100_CT_wO_380_recojet05_dphi_j1j2","", n_bins100, 0.5,TMath::Pi());
  TH1F* h_100_CT_wO_380_recojet05_E1_E2_over_E_True =  new TH1F("h_100_CT_wO_380_recojet05_E1_E2_over_E_True","", n_bins100, 0.5,1.00);
  TH1F* h_100_CT_wO_380_recojet05_Delta_E1_E2_over_E12 =  new TH1F("h_100_CT_wO_380_recojet05_Delta_E1_E2_over_E12","", n_bins100, -0.5,0.5);
  TH1F* h_100_CT_wO_380_recojet06_dphi_j1j2 =  new TH1F("h_100_CT_wO_380_recojet06_dphi_j1j2","", n_bins100, 0.5,TMath::Pi());
  TH1F* h_100_CT_wO_380_recojet06_E1_E2_over_E_True =  new TH1F("h_100_CT_wO_380_recojet06_E1_E2_over_E_True","", n_bins100, 0.5,1.00);
  TH1F* h_100_CT_wO_380_recojet06_Delta_E1_E2_over_E12 =  new TH1F("h_100_CT_wO_380_recojet06_Delta_E1_E2_over_E12","", n_bins100, -0.5,0.5);
  TH1F* h_100_CT_wO_380_recojet07_dphi_j1j2 =  new TH1F("h_100_CT_wO_380_recojet07_dphi_j1j2","", n_bins100, 0.5,TMath::Pi());
  TH1F* h_100_CT_wO_380_recojet07_E1_E2_over_E_True =  new TH1F("h_100_CT_wO_380_recojet07_E1_E2_over_E_True","", n_bins100, 0.5,1.00);
  TH1F* h_100_CT_wO_380_recojet07_Delta_E1_E2_over_E12 =  new TH1F("h_100_CT_wO_380_recojet07_Delta_E1_E2_over_E12","", n_bins100, -0.5,0.5);
  TH1F* h_100_CT_wO_380_recojet08_dphi_j1j2 =  new TH1F("h_100_CT_wO_380_recojet08_dphi_j1j2","", n_bins100, 0.5,TMath::Pi());
  TH1F* h_100_CT_wO_380_recojet08_E1_E2_over_E_True =  new TH1F("h_100_CT_wO_380_recojet08_E1_E2_over_E_True","", n_bins100, 0.5,1.00);
  TH1F* h_100_CT_wO_380_recojet08_Delta_E1_E2_over_E12 =  new TH1F("h_100_CT_wO_380_recojet08_Delta_E1_E2_over_E12","", n_bins100, -0.5,0.5);
  TH1F* h_100_CT_wO_380_recojet09_dphi_j1j2 =  new TH1F("h_100_CT_wO_380_recojet09_dphi_j1j2","", n_bins100, 0.5,TMath::Pi());
  TH1F* h_100_CT_wO_380_recojet09_E1_E2_over_E_True =  new TH1F("h_100_CT_wO_380_recojet09_E1_E2_over_E_True","", n_bins100, 0.5,1.00);
  TH1F* h_100_CT_wO_380_recojet09_Delta_E1_E2_over_E12 =  new TH1F("h_100_CT_wO_380_recojet09_Delta_E1_E2_over_E12","", n_bins100, -0.5,0.5);
  TH1F* h_100_CT_wO_380_recojet10_dphi_j1j2 =  new TH1F("h_100_CT_wO_380_recojet10_dphi_j1j2","", n_bins100, 0.5,TMath::Pi());
  TH1F* h_100_CT_wO_380_recojet10_E1_E2_over_E_True =  new TH1F("h_100_CT_wO_380_recojet10_E1_E2_over_E_True","", n_bins100, 0.5,1.00);
  TH1F* h_100_CT_wO_380_recojet10_Delta_E1_E2_over_E12 =  new TH1F("h_100_CT_wO_380_recojet10_Delta_E1_E2_over_E12","", n_bins100, -0.5,0.5);

  TH1F* h_100_CT_wO_380_recojetE_over_genjetE_DR03 =  new TH1F("h_100_CT_wO_380_recojetE_over_genjetE_DR03","", n_bins100, 0.5,1.5);
  TH1F* h_100_CT_wO_380_recojetE_over_genjetE_DR04 =  new TH1F("h_100_CT_wO_380_recojetE_over_genjetE_DR04","", n_bins100, 0.5,1.5);
  TH1F* h_100_CT_wO_380_recojetE_over_genjetE_DR05 =  new TH1F("h_100_CT_wO_380_recojetE_over_genjetE_DR05","", n_bins100, 0.5,1.5);
  TH1F* h_100_CT_wO_380_recojetE_over_genjetE_DR06 =  new TH1F("h_100_CT_wO_380_recojetE_over_genjetE_DR06","", n_bins100, 0.5,1.5);
  TH1F* h_100_CT_wO_380_recojetE_over_genjetE_DR07 =  new TH1F("h_100_CT_wO_380_recojetE_over_genjetE_DR07","", n_bins100, 0.5,1.5);
  TH1F* h_100_CT_wO_380_recojetE_over_genjetE_DR08 =  new TH1F("h_100_CT_wO_380_recojetE_over_genjetE_DR08","", n_bins100, 0.5,1.5);
  TH1F* h_100_CT_wO_380_recojetE_over_genjetE_DR09 =  new TH1F("h_100_CT_wO_380_recojetE_over_genjetE_DR09","", n_bins100, 0.5,1.5);
  TH1F* h_100_CT_wO_380_recojetE_over_genjetE_DR10 =  new TH1F("h_100_CT_wO_380_recojetE_over_genjetE_DR10","", n_bins100, 0.5,1.5);

  TH1F* h_100_CT_wO_380_dphi_gen_reco_DR05 =  new TH1F("h_100_CT_wO_380_dphi_gen_reco_DR05","", n_bins100, -0.1,9.9);
  TH1F* h_100_CT_wO_380_dphi_gen_reco_DR06 =  new TH1F("h_100_CT_wO_380_dphi_gen_reco_DR06","", n_bins100, -0.1,9.9);
  TH1F* h_100_CT_wO_380_dphi_gen_reco_DR07 =  new TH1F("h_100_CT_wO_380_dphi_gen_reco_DR07","", n_bins100, -0.1,9.9);

  TH1F* h_100_CT_wO_380_DR05_E_rel_totVis_RMS_d1_cosT_0_to_0_10 =  new TH1F("h_100_CT_wO_380_DR05_E_rel_totVis_RMS_d1_cosT_0_to_0_10","", n_binsJER, lim_E_rel_low,lim_E_rel_high);
  TH1F* h_100_CT_wO_380_DR05_E_rel_totVis_RMS_d1_cosT_0_10_to_0_20 =  new TH1F("h_100_CT_wO_380_DR05_E_rel_totVis_RMS_d1_cosT_0_10_to_0_20","", n_binsJER, lim_E_rel_low,lim_E_rel_high);
  TH1F* h_100_CT_wO_380_DR05_E_rel_totVis_RMS_d1_cosT_0_20_to_0_30 =  new TH1F("h_100_CT_wO_380_DR05_E_rel_totVis_RMS_d1_cosT_0_20_to_0_30","", n_binsJER, lim_E_rel_low,lim_E_rel_high);
  TH1F* h_100_CT_wO_380_DR05_E_rel_totVis_RMS_d1_cosT_0_30_to_0_40 =  new TH1F("h_100_CT_wO_380_DR05_E_rel_totVis_RMS_d1_cosT_0_30_to_0_40","", n_binsJER, lim_E_rel_low,lim_E_rel_high);
  TH1F* h_100_CT_wO_380_DR05_E_rel_totVis_RMS_d1_cosT_0_40_to_0_50 =  new TH1F("h_100_CT_wO_380_DR05_E_rel_totVis_RMS_d1_cosT_0_40_to_0_50","", n_binsJER, lim_E_rel_low,lim_E_rel_high);
  TH1F* h_100_CT_wO_380_DR05_E_rel_totVis_RMS_d1_cosT_0_50_to_0_60 =  new TH1F("h_100_CT_wO_380_DR05_E_rel_totVis_RMS_d1_cosT_0_50_to_0_60","", n_binsJER, lim_E_rel_low,lim_E_rel_high);
  TH1F* h_100_CT_wO_380_DR05_E_rel_totVis_RMS_d1_cosT_0_60_to_0_70 =  new TH1F("h_100_CT_wO_380_DR05_E_rel_totVis_RMS_d1_cosT_0_60_to_0_70","", n_binsJER, lim_E_rel_low,lim_E_rel_high);
  TH1F* h_100_CT_wO_380_DR05_E_rel_totVis_RMS_d1_cosT_0_70_to_0_80 =  new TH1F("h_100_CT_wO_380_DR05_E_rel_totVis_RMS_d1_cosT_0_70_to_0_80","", n_binsJER, lim_E_rel_low,lim_E_rel_high);
  TH1F* h_100_CT_wO_380_DR05_E_rel_totVis_RMS_d1_cosT_0_80_to_0_90 =  new TH1F("h_100_CT_wO_380_DR05_E_rel_totVis_RMS_d1_cosT_0_80_to_0_90","", n_binsJER, lim_E_rel_low,lim_E_rel_high);
  TH1F* h_100_CT_wO_380_DR05_E_rel_totVis_RMS_d1_cosT_0_900_to_0_925 =  new TH1F("h_100_CT_wO_380_DR05_E_rel_totVis_RMS_d1_cosT_0_900_to_0_925","", n_binsJER, lim_E_rel_low,lim_E_rel_high);
  TH1F* h_100_CT_wO_380_DR05_E_rel_totVis_RMS_d1_cosT_0_925_to_0_950 =  new TH1F("h_100_CT_wO_380_DR05_E_rel_totVis_RMS_d1_cosT_0_925_to_0_950","", n_binsJER, lim_E_rel_low,lim_E_rel_high);
  TH1F* h_100_CT_wO_380_DR05_E_rel_totVis_RMS_d1_cosT_0_950_to_0_975 =  new TH1F("h_100_CT_wO_380_DR05_E_rel_totVis_RMS_d1_cosT_0_950_to_0_975","", n_binsJER, lim_E_rel_low,lim_E_rel_high);
  TH1F* h_100_CT_wO_380_DR05_E_rel_totVis_RMS_d1_cosT_0_975_to_1_00 =  new TH1F("h_100_CT_wO_380_DR05_E_rel_totVis_RMS_d1_cosT_0_975_to_1_00","", n_binsJER, lim_E_rel_low,lim_E_rel_high);

  TH1F* h_100_CT_wO_380_DR06_E_rel_totVis_RMS_d1_cosT_0_to_0_10 =  new TH1F("h_100_CT_wO_380_DR06_E_rel_totVis_RMS_d1_cosT_0_to_0_10","", n_binsJER, lim_E_rel_low,lim_E_rel_high);
  TH1F* h_100_CT_wO_380_DR06_E_rel_totVis_RMS_d1_cosT_0_10_to_0_20 =  new TH1F("h_100_CT_wO_380_DR06_E_rel_totVis_RMS_d1_cosT_0_10_to_0_20","", n_binsJER, lim_E_rel_low,lim_E_rel_high);
  TH1F* h_100_CT_wO_380_DR06_E_rel_totVis_RMS_d1_cosT_0_20_to_0_30 =  new TH1F("h_100_CT_wO_380_DR06_E_rel_totVis_RMS_d1_cosT_0_20_to_0_30","", n_binsJER, lim_E_rel_low,lim_E_rel_high);
  TH1F* h_100_CT_wO_380_DR06_E_rel_totVis_RMS_d1_cosT_0_30_to_0_40 =  new TH1F("h_100_CT_wO_380_DR06_E_rel_totVis_RMS_d1_cosT_0_30_to_0_40","", n_binsJER, lim_E_rel_low,lim_E_rel_high);
  TH1F* h_100_CT_wO_380_DR06_E_rel_totVis_RMS_d1_cosT_0_40_to_0_50 =  new TH1F("h_100_CT_wO_380_DR06_E_rel_totVis_RMS_d1_cosT_0_40_to_0_50","", n_binsJER, lim_E_rel_low,lim_E_rel_high);
  TH1F* h_100_CT_wO_380_DR06_E_rel_totVis_RMS_d1_cosT_0_50_to_0_60 =  new TH1F("h_100_CT_wO_380_DR06_E_rel_totVis_RMS_d1_cosT_0_50_to_0_60","", n_binsJER, lim_E_rel_low,lim_E_rel_high);
  TH1F* h_100_CT_wO_380_DR06_E_rel_totVis_RMS_d1_cosT_0_60_to_0_70 =  new TH1F("h_100_CT_wO_380_DR06_E_rel_totVis_RMS_d1_cosT_0_60_to_0_70","", n_binsJER, lim_E_rel_low,lim_E_rel_high);
  TH1F* h_100_CT_wO_380_DR06_E_rel_totVis_RMS_d1_cosT_0_70_to_0_80 =  new TH1F("h_100_CT_wO_380_DR06_E_rel_totVis_RMS_d1_cosT_0_70_to_0_80","", n_binsJER, lim_E_rel_low,lim_E_rel_high);
  TH1F* h_100_CT_wO_380_DR06_E_rel_totVis_RMS_d1_cosT_0_80_to_0_90 =  new TH1F("h_100_CT_wO_380_DR06_E_rel_totVis_RMS_d1_cosT_0_80_to_0_90","", n_binsJER, lim_E_rel_low,lim_E_rel_high);
  TH1F* h_100_CT_wO_380_DR06_E_rel_totVis_RMS_d1_cosT_0_900_to_0_925 =  new TH1F("h_100_CT_wO_380_DR06_E_rel_totVis_RMS_d1_cosT_0_900_to_0_925","", n_binsJER, lim_E_rel_low,lim_E_rel_high);
  TH1F* h_100_CT_wO_380_DR06_E_rel_totVis_RMS_d1_cosT_0_925_to_0_950 =  new TH1F("h_100_CT_wO_380_DR06_E_rel_totVis_RMS_d1_cosT_0_925_to_0_950","", n_binsJER, lim_E_rel_low,lim_E_rel_high);
  TH1F* h_100_CT_wO_380_DR06_E_rel_totVis_RMS_d1_cosT_0_950_to_0_975 =  new TH1F("h_100_CT_wO_380_DR06_E_rel_totVis_RMS_d1_cosT_0_950_to_0_975","", n_binsJER, lim_E_rel_low,lim_E_rel_high);
  TH1F* h_100_CT_wO_380_DR06_E_rel_totVis_RMS_d1_cosT_0_975_to_1_00 =  new TH1F("h_100_CT_wO_380_DR06_E_rel_totVis_RMS_d1_cosT_0_975_to_1_00","", n_binsJER, lim_E_rel_low,lim_E_rel_high);

  TH1F* h_100_CT_wO_380_DR07_E_rel_totVis_RMS_d1_cosT_0_to_0_10 =  new TH1F("h_100_CT_wO_380_DR07_E_rel_totVis_RMS_d1_cosT_0_to_0_10","", n_binsJER, lim_E_rel_low,lim_E_rel_high);
  TH1F* h_100_CT_wO_380_DR07_E_rel_totVis_RMS_d1_cosT_0_10_to_0_20 =  new TH1F("h_100_CT_wO_380_DR07_E_rel_totVis_RMS_d1_cosT_0_10_to_0_20","", n_binsJER, lim_E_rel_low,lim_E_rel_high);
  TH1F* h_100_CT_wO_380_DR07_E_rel_totVis_RMS_d1_cosT_0_20_to_0_30 =  new TH1F("h_100_CT_wO_380_DR07_E_rel_totVis_RMS_d1_cosT_0_20_to_0_30","", n_binsJER, lim_E_rel_low,lim_E_rel_high);
  TH1F* h_100_CT_wO_380_DR07_E_rel_totVis_RMS_d1_cosT_0_30_to_0_40 =  new TH1F("h_100_CT_wO_380_DR07_E_rel_totVis_RMS_d1_cosT_0_30_to_0_40","", n_binsJER, lim_E_rel_low,lim_E_rel_high);
  TH1F* h_100_CT_wO_380_DR07_E_rel_totVis_RMS_d1_cosT_0_40_to_0_50 =  new TH1F("h_100_CT_wO_380_DR07_E_rel_totVis_RMS_d1_cosT_0_40_to_0_50","", n_binsJER, lim_E_rel_low,lim_E_rel_high);
  TH1F* h_100_CT_wO_380_DR07_E_rel_totVis_RMS_d1_cosT_0_50_to_0_60 =  new TH1F("h_100_CT_wO_380_DR07_E_rel_totVis_RMS_d1_cosT_0_50_to_0_60","", n_binsJER, lim_E_rel_low,lim_E_rel_high);
  TH1F* h_100_CT_wO_380_DR07_E_rel_totVis_RMS_d1_cosT_0_60_to_0_70 =  new TH1F("h_100_CT_wO_380_DR07_E_rel_totVis_RMS_d1_cosT_0_60_to_0_70","", n_binsJER, lim_E_rel_low,lim_E_rel_high);
  TH1F* h_100_CT_wO_380_DR07_E_rel_totVis_RMS_d1_cosT_0_70_to_0_80 =  new TH1F("h_100_CT_wO_380_DR07_E_rel_totVis_RMS_d1_cosT_0_70_to_0_80","", n_binsJER, lim_E_rel_low,lim_E_rel_high);
  TH1F* h_100_CT_wO_380_DR07_E_rel_totVis_RMS_d1_cosT_0_80_to_0_90 =  new TH1F("h_100_CT_wO_380_DR07_E_rel_totVis_RMS_d1_cosT_0_80_to_0_90","", n_binsJER, lim_E_rel_low,lim_E_rel_high);
  TH1F* h_100_CT_wO_380_DR07_E_rel_totVis_RMS_d1_cosT_0_900_to_0_925 =  new TH1F("h_100_CT_wO_380_DR07_E_rel_totVis_RMS_d1_cosT_0_900_to_0_925","", n_binsJER, lim_E_rel_low,lim_E_rel_high);
  TH1F* h_100_CT_wO_380_DR07_E_rel_totVis_RMS_d1_cosT_0_925_to_0_950 =  new TH1F("h_100_CT_wO_380_DR07_E_rel_totVis_RMS_d1_cosT_0_925_to_0_950","", n_binsJER, lim_E_rel_low,lim_E_rel_high);
  TH1F* h_100_CT_wO_380_DR07_E_rel_totVis_RMS_d1_cosT_0_950_to_0_975 =  new TH1F("h_100_CT_wO_380_DR07_E_rel_totVis_RMS_d1_cosT_0_950_to_0_975","", n_binsJER, lim_E_rel_low,lim_E_rel_high);
  TH1F* h_100_CT_wO_380_DR07_E_rel_totVis_RMS_d1_cosT_0_975_to_1_00 =  new TH1F("h_100_CT_wO_380_DR07_E_rel_totVis_RMS_d1_cosT_0_975_to_1_00","", n_binsJER, lim_E_rel_low,lim_E_rel_high);

  TH1F* h_100_CT_wO_380_DR08_E_rel_totVis_RMS_d1_cosT_0_to_0_10 =  new TH1F("h_100_CT_wO_380_DR08_E_rel_totVis_RMS_d1_cosT_0_to_0_10","", n_binsJER, lim_E_rel_low,lim_E_rel_high);
  TH1F* h_100_CT_wO_380_DR08_E_rel_totVis_RMS_d1_cosT_0_10_to_0_20 =  new TH1F("h_100_CT_wO_380_DR08_E_rel_totVis_RMS_d1_cosT_0_10_to_0_20","", n_binsJER, lim_E_rel_low,lim_E_rel_high);
  TH1F* h_100_CT_wO_380_DR08_E_rel_totVis_RMS_d1_cosT_0_20_to_0_30 =  new TH1F("h_100_CT_wO_380_DR08_E_rel_totVis_RMS_d1_cosT_0_20_to_0_30","", n_binsJER, lim_E_rel_low,lim_E_rel_high);
  TH1F* h_100_CT_wO_380_DR08_E_rel_totVis_RMS_d1_cosT_0_30_to_0_40 =  new TH1F("h_100_CT_wO_380_DR08_E_rel_totVis_RMS_d1_cosT_0_30_to_0_40","", n_binsJER, lim_E_rel_low,lim_E_rel_high);
  TH1F* h_100_CT_wO_380_DR08_E_rel_totVis_RMS_d1_cosT_0_40_to_0_50 =  new TH1F("h_100_CT_wO_380_DR08_E_rel_totVis_RMS_d1_cosT_0_40_to_0_50","", n_binsJER, lim_E_rel_low,lim_E_rel_high);
  TH1F* h_100_CT_wO_380_DR08_E_rel_totVis_RMS_d1_cosT_0_50_to_0_60 =  new TH1F("h_100_CT_wO_380_DR08_E_rel_totVis_RMS_d1_cosT_0_50_to_0_60","", n_binsJER, lim_E_rel_low,lim_E_rel_high);
  TH1F* h_100_CT_wO_380_DR08_E_rel_totVis_RMS_d1_cosT_0_60_to_0_70 =  new TH1F("h_100_CT_wO_380_DR08_E_rel_totVis_RMS_d1_cosT_0_60_to_0_70","", n_binsJER, lim_E_rel_low,lim_E_rel_high);
  TH1F* h_100_CT_wO_380_DR08_E_rel_totVis_RMS_d1_cosT_0_70_to_0_80 =  new TH1F("h_100_CT_wO_380_DR08_E_rel_totVis_RMS_d1_cosT_0_70_to_0_80","", n_binsJER, lim_E_rel_low,lim_E_rel_high);
  TH1F* h_100_CT_wO_380_DR08_E_rel_totVis_RMS_d1_cosT_0_80_to_0_90 =  new TH1F("h_100_CT_wO_380_DR08_E_rel_totVis_RMS_d1_cosT_0_80_to_0_90","", n_binsJER, lim_E_rel_low,lim_E_rel_high);
  TH1F* h_100_CT_wO_380_DR08_E_rel_totVis_RMS_d1_cosT_0_900_to_0_925 =  new TH1F("h_100_CT_wO_380_DR08_E_rel_totVis_RMS_d1_cosT_0_900_to_0_925","", n_binsJER, lim_E_rel_low,lim_E_rel_high);
  TH1F* h_100_CT_wO_380_DR08_E_rel_totVis_RMS_d1_cosT_0_925_to_0_950 =  new TH1F("h_100_CT_wO_380_DR08_E_rel_totVis_RMS_d1_cosT_0_925_to_0_950","", n_binsJER, lim_E_rel_low,lim_E_rel_high);
  TH1F* h_100_CT_wO_380_DR08_E_rel_totVis_RMS_d1_cosT_0_950_to_0_975 =  new TH1F("h_100_CT_wO_380_DR08_E_rel_totVis_RMS_d1_cosT_0_950_to_0_975","", n_binsJER, lim_E_rel_low,lim_E_rel_high);
  TH1F* h_100_CT_wO_380_DR08_E_rel_totVis_RMS_d1_cosT_0_975_to_1_00 =  new TH1F("h_100_CT_wO_380_DR08_E_rel_totVis_RMS_d1_cosT_0_975_to_1_00","", n_binsJER, lim_E_rel_low,lim_E_rel_high);

  TH1F* h_100_CT_wO_380_DR09_E_rel_totVis_RMS_d1_cosT_0_to_0_10 =  new TH1F("h_100_CT_wO_380_DR09_E_rel_totVis_RMS_d1_cosT_0_to_0_10","", n_binsJER, lim_E_rel_low,lim_E_rel_high);
  TH1F* h_100_CT_wO_380_DR09_E_rel_totVis_RMS_d1_cosT_0_10_to_0_20 =  new TH1F("h_100_CT_wO_380_DR09_E_rel_totVis_RMS_d1_cosT_0_10_to_0_20","", n_binsJER, lim_E_rel_low,lim_E_rel_high);
  TH1F* h_100_CT_wO_380_DR09_E_rel_totVis_RMS_d1_cosT_0_20_to_0_30 =  new TH1F("h_100_CT_wO_380_DR09_E_rel_totVis_RMS_d1_cosT_0_20_to_0_30","", n_binsJER, lim_E_rel_low,lim_E_rel_high);
  TH1F* h_100_CT_wO_380_DR09_E_rel_totVis_RMS_d1_cosT_0_30_to_0_40 =  new TH1F("h_100_CT_wO_380_DR09_E_rel_totVis_RMS_d1_cosT_0_30_to_0_40","", n_binsJER, lim_E_rel_low,lim_E_rel_high);
  TH1F* h_100_CT_wO_380_DR09_E_rel_totVis_RMS_d1_cosT_0_40_to_0_50 =  new TH1F("h_100_CT_wO_380_DR09_E_rel_totVis_RMS_d1_cosT_0_40_to_0_50","", n_binsJER, lim_E_rel_low,lim_E_rel_high);
  TH1F* h_100_CT_wO_380_DR09_E_rel_totVis_RMS_d1_cosT_0_50_to_0_60 =  new TH1F("h_100_CT_wO_380_DR09_E_rel_totVis_RMS_d1_cosT_0_50_to_0_60","", n_binsJER, lim_E_rel_low,lim_E_rel_high);
  TH1F* h_100_CT_wO_380_DR09_E_rel_totVis_RMS_d1_cosT_0_60_to_0_70 =  new TH1F("h_100_CT_wO_380_DR09_E_rel_totVis_RMS_d1_cosT_0_60_to_0_70","", n_binsJER, lim_E_rel_low,lim_E_rel_high);
  TH1F* h_100_CT_wO_380_DR09_E_rel_totVis_RMS_d1_cosT_0_70_to_0_80 =  new TH1F("h_100_CT_wO_380_DR09_E_rel_totVis_RMS_d1_cosT_0_70_to_0_80","", n_binsJER, lim_E_rel_low,lim_E_rel_high);
  TH1F* h_100_CT_wO_380_DR09_E_rel_totVis_RMS_d1_cosT_0_80_to_0_90 =  new TH1F("h_100_CT_wO_380_DR09_E_rel_totVis_RMS_d1_cosT_0_80_to_0_90","", n_binsJER, lim_E_rel_low,lim_E_rel_high);
  TH1F* h_100_CT_wO_380_DR09_E_rel_totVis_RMS_d1_cosT_0_900_to_0_925 =  new TH1F("h_100_CT_wO_380_DR09_E_rel_totVis_RMS_d1_cosT_0_900_to_0_925","", n_binsJER, lim_E_rel_low,lim_E_rel_high);
  TH1F* h_100_CT_wO_380_DR09_E_rel_totVis_RMS_d1_cosT_0_925_to_0_950 =  new TH1F("h_100_CT_wO_380_DR09_E_rel_totVis_RMS_d1_cosT_0_925_to_0_950","", n_binsJER, lim_E_rel_low,lim_E_rel_high);
  TH1F* h_100_CT_wO_380_DR09_E_rel_totVis_RMS_d1_cosT_0_950_to_0_975 =  new TH1F("h_100_CT_wO_380_DR09_E_rel_totVis_RMS_d1_cosT_0_950_to_0_975","", n_binsJER, lim_E_rel_low,lim_E_rel_high);
  TH1F* h_100_CT_wO_380_DR09_E_rel_totVis_RMS_d1_cosT_0_975_to_1_00 =  new TH1F("h_100_CT_wO_380_DR09_E_rel_totVis_RMS_d1_cosT_0_975_to_1_00","", n_binsJER, lim_E_rel_low,lim_E_rel_high);

  TH1F* h_100_CT_wO_380_DR10_E_rel_totVis_RMS_d1_cosT_0_to_0_10 =  new TH1F("h_100_CT_wO_380_DR10_E_rel_totVis_RMS_d1_cosT_0_to_0_10","", n_binsJER, lim_E_rel_low,lim_E_rel_high);
  TH1F* h_100_CT_wO_380_DR10_E_rel_totVis_RMS_d1_cosT_0_10_to_0_20 =  new TH1F("h_100_CT_wO_380_DR10_E_rel_totVis_RMS_d1_cosT_0_10_to_0_20","", n_binsJER, lim_E_rel_low,lim_E_rel_high);
  TH1F* h_100_CT_wO_380_DR10_E_rel_totVis_RMS_d1_cosT_0_20_to_0_30 =  new TH1F("h_100_CT_wO_380_DR10_E_rel_totVis_RMS_d1_cosT_0_20_to_0_30","", n_binsJER, lim_E_rel_low,lim_E_rel_high);
  TH1F* h_100_CT_wO_380_DR10_E_rel_totVis_RMS_d1_cosT_0_30_to_0_40 =  new TH1F("h_100_CT_wO_380_DR10_E_rel_totVis_RMS_d1_cosT_0_30_to_0_40","", n_binsJER, lim_E_rel_low,lim_E_rel_high);
  TH1F* h_100_CT_wO_380_DR10_E_rel_totVis_RMS_d1_cosT_0_40_to_0_50 =  new TH1F("h_100_CT_wO_380_DR10_E_rel_totVis_RMS_d1_cosT_0_40_to_0_50","", n_binsJER, lim_E_rel_low,lim_E_rel_high);
  TH1F* h_100_CT_wO_380_DR10_E_rel_totVis_RMS_d1_cosT_0_50_to_0_60 =  new TH1F("h_100_CT_wO_380_DR10_E_rel_totVis_RMS_d1_cosT_0_50_to_0_60","", n_binsJER, lim_E_rel_low,lim_E_rel_high);
  TH1F* h_100_CT_wO_380_DR10_E_rel_totVis_RMS_d1_cosT_0_60_to_0_70 =  new TH1F("h_100_CT_wO_380_DR10_E_rel_totVis_RMS_d1_cosT_0_60_to_0_70","", n_binsJER, lim_E_rel_low,lim_E_rel_high);
  TH1F* h_100_CT_wO_380_DR10_E_rel_totVis_RMS_d1_cosT_0_70_to_0_80 =  new TH1F("h_100_CT_wO_380_DR10_E_rel_totVis_RMS_d1_cosT_0_70_to_0_80","", n_binsJER, lim_E_rel_low,lim_E_rel_high);
  TH1F* h_100_CT_wO_380_DR10_E_rel_totVis_RMS_d1_cosT_0_80_to_0_90 =  new TH1F("h_100_CT_wO_380_DR10_E_rel_totVis_RMS_d1_cosT_0_80_to_0_90","", n_binsJER, lim_E_rel_low,lim_E_rel_high);
  TH1F* h_100_CT_wO_380_DR10_E_rel_totVis_RMS_d1_cosT_0_900_to_0_925 =  new TH1F("h_100_CT_wO_380_DR10_E_rel_totVis_RMS_d1_cosT_0_900_to_0_925","", n_binsJER, lim_E_rel_low,lim_E_rel_high);
  TH1F* h_100_CT_wO_380_DR10_E_rel_totVis_RMS_d1_cosT_0_925_to_0_950 =  new TH1F("h_100_CT_wO_380_DR10_E_rel_totVis_RMS_d1_cosT_0_925_to_0_950","", n_binsJER, lim_E_rel_low,lim_E_rel_high);
  TH1F* h_100_CT_wO_380_DR10_E_rel_totVis_RMS_d1_cosT_0_950_to_0_975 =  new TH1F("h_100_CT_wO_380_DR10_E_rel_totVis_RMS_d1_cosT_0_950_to_0_975","", n_binsJER, lim_E_rel_low,lim_E_rel_high);
  TH1F* h_100_CT_wO_380_DR10_E_rel_totVis_RMS_d1_cosT_0_975_to_1_00 =  new TH1F("h_100_CT_wO_380_DR10_E_rel_totVis_RMS_d1_cosT_0_975_to_1_00","", n_binsJER, lim_E_rel_low,lim_E_rel_high);

  TH1F* h_100_CT_wO_380_DR05_dphi_reco_gen_cosTheta_0_65 =  new TH1F("h_100_CT_wO_380_DR05_dphi_reco_gen_cosTheta_0_65","", n_bins100, -lim_angleDeg,lim_angleDeg);
  TH1F* h_100_CT_wO_380_DR05_dtheta_reco_gen_cosTheta_0_65 =  new TH1F("h_100_CT_wO_380_DR05_dtheta_reco_gen_cosTheta_0_65","", n_bins100, -lim_angleDeg,lim_angleDeg);
  TH1F* h_100_CT_wO_380_DR05_dphi_reco_gen_cosTheta_0_65_to_0_80 =  new TH1F("h_100_CT_wO_380_DR05_dphi_reco_gen_cosTheta_0_65_to_0_80","", n_bins100, -lim_angleDeg,lim_angleDeg);
  TH1F* h_100_CT_wO_380_DR05_dtheta_reco_gen_cosTheta_0_65_to_0_80 =  new TH1F("h_100_CT_wO_380_DR05_dtheta_reco_gen_cosTheta_0_65_to_0_80","", n_bins100, -lim_angleDeg,lim_angleDeg);
  TH1F* h_100_CT_wO_380_DR05_dphi_reco_gen_cosTheta_0_80_to_0_925 =  new TH1F("h_100_CT_wO_380_DR05_dphi_reco_gen_cosTheta_0_80_to_0_925","", n_bins100, -lim_angleDeg,lim_angleDeg);
  TH1F* h_100_CT_wO_380_DR05_dtheta_reco_gen_cosTheta_0_80_to_0_925 =  new TH1F("h_100_CT_wO_380_DR05_dtheta_reco_gen_cosTheta_0_80_to_0_925","", n_bins100, -lim_angleDeg,lim_angleDeg);
  TH1F* h_100_CT_wO_380_DR05_dphi_reco_gen_cosTheta_0_925_to_0_975 =  new TH1F("h_100_CT_wO_380_DR05_dphi_reco_gen_cosTheta_0_925_to_0_975","", n_bins100, -lim_angleDeg,lim_angleDeg);
  TH1F* h_100_CT_wO_380_DR05_dtheta_reco_gen_cosTheta_0_925_to_0_975 =  new TH1F("h_100_CT_wO_380_DR05_dtheta_reco_gen_cosTheta_0_925_to_0_975","", n_bins100, -lim_angleDeg,lim_angleDeg);

  TH1F* h_100_CT_wO_380_DR07_dphi_reco_gen_cosTheta_0_65 =  new TH1F("h_100_CT_wO_380_DR07_dphi_reco_gen_cosTheta_0_65","", n_bins100, -lim_angleDeg,lim_angleDeg);
  TH1F* h_100_CT_wO_380_DR07_dtheta_reco_gen_cosTheta_0_65 =  new TH1F("h_100_CT_wO_380_DR07_dtheta_reco_gen_cosTheta_0_65","", n_bins100, -lim_angleDeg,lim_angleDeg);
  TH1F* h_100_CT_wO_380_DR07_dphi_reco_gen_cosTheta_0_65_to_0_80 =  new TH1F("h_100_CT_wO_380_DR07_dphi_reco_gen_cosTheta_0_65_to_0_80","", n_bins100, -lim_angleDeg,lim_angleDeg);
  TH1F* h_100_CT_wO_380_DR07_dtheta_reco_gen_cosTheta_0_65_to_0_80 =  new TH1F("h_100_CT_wO_380_DR07_dtheta_reco_gen_cosTheta_0_65_to_0_80","", n_bins100, -lim_angleDeg,lim_angleDeg);
  TH1F* h_100_CT_wO_380_DR07_dphi_reco_gen_cosTheta_0_80_to_0_925 =  new TH1F("h_100_CT_wO_380_DR07_dphi_reco_gen_cosTheta_0_80_to_0_925","", n_bins100, -lim_angleDeg,lim_angleDeg);
  TH1F* h_100_CT_wO_380_DR07_dtheta_reco_gen_cosTheta_0_80_to_0_925 =  new TH1F("h_100_CT_wO_380_DR07_dtheta_reco_gen_cosTheta_0_80_to_0_925","", n_bins100, -lim_angleDeg,lim_angleDeg);
  TH1F* h_100_CT_wO_380_DR07_dphi_reco_gen_cosTheta_0_925_to_0_975 =  new TH1F("h_100_CT_wO_380_DR07_dphi_reco_gen_cosTheta_0_925_to_0_975","", n_bins100, -lim_angleDeg,lim_angleDeg);
  TH1F* h_100_CT_wO_380_DR07_dtheta_reco_gen_cosTheta_0_925_to_0_975 =  new TH1F("h_100_CT_wO_380_DR07_dtheta_reco_gen_cosTheta_0_925_to_0_975","", n_bins100, -lim_angleDeg,lim_angleDeg);

  TH1F* h_100_CT_wO_380_DR10_dphi_reco_gen_cosTheta_0_65 =  new TH1F("h_100_CT_wO_380_DR10_dphi_reco_gen_cosTheta_0_65","", n_bins100, -lim_angleDeg,lim_angleDeg);
  TH1F* h_100_CT_wO_380_DR10_dtheta_reco_gen_cosTheta_0_65 =  new TH1F("h_100_CT_wO_380_DR10_dtheta_reco_gen_cosTheta_0_65","", n_bins100, -lim_angleDeg,lim_angleDeg);
  TH1F* h_100_CT_wO_380_DR10_dphi_reco_gen_cosTheta_0_65_to_0_80 =  new TH1F("h_100_CT_wO_380_DR10_dphi_reco_gen_cosTheta_0_65_to_0_80","", n_bins100, -lim_angleDeg,lim_angleDeg);
  TH1F* h_100_CT_wO_380_DR10_dtheta_reco_gen_cosTheta_0_65_to_0_80 =  new TH1F("h_100_CT_wO_380_DR10_dtheta_reco_gen_cosTheta_0_65_to_0_80","", n_bins100, -lim_angleDeg,lim_angleDeg);
  TH1F* h_100_CT_wO_380_DR10_dphi_reco_gen_cosTheta_0_80_to_0_925 =  new TH1F("h_100_CT_wO_380_DR10_dphi_reco_gen_cosTheta_0_80_to_0_925","", n_bins100, -lim_angleDeg,lim_angleDeg);
  TH1F* h_100_CT_wO_380_DR10_dtheta_reco_gen_cosTheta_0_80_to_0_925 =  new TH1F("h_100_CT_wO_380_DR10_dtheta_reco_gen_cosTheta_0_80_to_0_925","", n_bins100, -lim_angleDeg,lim_angleDeg);
  TH1F* h_100_CT_wO_380_DR10_dphi_reco_gen_cosTheta_0_925_to_0_975 =  new TH1F("h_100_CT_wO_380_DR10_dphi_reco_gen_cosTheta_0_925_to_0_975","", n_bins100, -lim_angleDeg,lim_angleDeg);
  TH1F* h_100_CT_wO_380_DR10_dtheta_reco_gen_cosTheta_0_925_to_0_975 =  new TH1F("h_100_CT_wO_380_DR10_dtheta_reco_gen_cosTheta_0_925_to_0_975","", n_bins100, -lim_angleDeg,lim_angleDeg);

  std::vector<TH1F*> hist_vec_100_CT_wO_380;
  hist_vec_100_CT_wO_380.push_back(h_100_CT_wO_380_genjet03_dphi_j1j2);
  hist_vec_100_CT_wO_380.push_back(h_100_CT_wO_380_genjet03_E1_E2_over_E_True);
  hist_vec_100_CT_wO_380.push_back(h_100_CT_wO_380_genjet03_Delta_E1_E2_over_E12);
  hist_vec_100_CT_wO_380.push_back(h_100_CT_wO_380_genjet04_dphi_j1j2);
  hist_vec_100_CT_wO_380.push_back(h_100_CT_wO_380_genjet04_E1_E2_over_E_True);
  hist_vec_100_CT_wO_380.push_back(h_100_CT_wO_380_genjet04_Delta_E1_E2_over_E12);
  hist_vec_100_CT_wO_380.push_back(h_100_CT_wO_380_genjet05_dphi_j1j2);
  hist_vec_100_CT_wO_380.push_back(h_100_CT_wO_380_genjet05_E1_E2_over_E_True);
  hist_vec_100_CT_wO_380.push_back(h_100_CT_wO_380_genjet05_Delta_E1_E2_over_E12);
  hist_vec_100_CT_wO_380.push_back(h_100_CT_wO_380_genjet06_dphi_j1j2);
  hist_vec_100_CT_wO_380.push_back(h_100_CT_wO_380_genjet06_E1_E2_over_E_True);
  hist_vec_100_CT_wO_380.push_back(h_100_CT_wO_380_genjet06_Delta_E1_E2_over_E12);
  hist_vec_100_CT_wO_380.push_back(h_100_CT_wO_380_genjet07_dphi_j1j2);
  hist_vec_100_CT_wO_380.push_back(h_100_CT_wO_380_genjet07_E1_E2_over_E_True);
  hist_vec_100_CT_wO_380.push_back(h_100_CT_wO_380_genjet07_Delta_E1_E2_over_E12);
  hist_vec_100_CT_wO_380.push_back(h_100_CT_wO_380_genjet08_dphi_j1j2);
  hist_vec_100_CT_wO_380.push_back(h_100_CT_wO_380_genjet08_E1_E2_over_E_True);
  hist_vec_100_CT_wO_380.push_back(h_100_CT_wO_380_genjet08_Delta_E1_E2_over_E12);
  hist_vec_100_CT_wO_380.push_back(h_100_CT_wO_380_genjet09_dphi_j1j2);
  hist_vec_100_CT_wO_380.push_back(h_100_CT_wO_380_genjet09_E1_E2_over_E_True);
  hist_vec_100_CT_wO_380.push_back(h_100_CT_wO_380_genjet09_Delta_E1_E2_over_E12);
  hist_vec_100_CT_wO_380.push_back(h_100_CT_wO_380_genjet10_dphi_j1j2);
  hist_vec_100_CT_wO_380.push_back(h_100_CT_wO_380_genjet10_E1_E2_over_E_True);
  hist_vec_100_CT_wO_380.push_back(h_100_CT_wO_380_genjet10_Delta_E1_E2_over_E12);

  hist_vec_100_CT_wO_380.push_back(h_100_CT_wO_380_recojet03_dphi_j1j2);
  hist_vec_100_CT_wO_380.push_back(h_100_CT_wO_380_recojet03_E1_E2_over_E_True);
  hist_vec_100_CT_wO_380.push_back(h_100_CT_wO_380_recojet03_Delta_E1_E2_over_E12);
  hist_vec_100_CT_wO_380.push_back(h_100_CT_wO_380_recojet04_dphi_j1j2);
  hist_vec_100_CT_wO_380.push_back(h_100_CT_wO_380_recojet04_E1_E2_over_E_True);
  hist_vec_100_CT_wO_380.push_back(h_100_CT_wO_380_recojet04_Delta_E1_E2_over_E12);
  hist_vec_100_CT_wO_380.push_back(h_100_CT_wO_380_recojet05_dphi_j1j2);
  hist_vec_100_CT_wO_380.push_back(h_100_CT_wO_380_recojet05_E1_E2_over_E_True);
  hist_vec_100_CT_wO_380.push_back(h_100_CT_wO_380_recojet05_Delta_E1_E2_over_E12);
  hist_vec_100_CT_wO_380.push_back(h_100_CT_wO_380_recojet06_dphi_j1j2);
  hist_vec_100_CT_wO_380.push_back(h_100_CT_wO_380_recojet06_E1_E2_over_E_True);
  hist_vec_100_CT_wO_380.push_back(h_100_CT_wO_380_recojet06_Delta_E1_E2_over_E12);
  hist_vec_100_CT_wO_380.push_back(h_100_CT_wO_380_recojet07_dphi_j1j2);
  hist_vec_100_CT_wO_380.push_back(h_100_CT_wO_380_recojet07_E1_E2_over_E_True);
  hist_vec_100_CT_wO_380.push_back(h_100_CT_wO_380_recojet07_Delta_E1_E2_over_E12);
  hist_vec_100_CT_wO_380.push_back(h_100_CT_wO_380_recojet08_dphi_j1j2);
  hist_vec_100_CT_wO_380.push_back(h_100_CT_wO_380_recojet08_E1_E2_over_E_True);
  hist_vec_100_CT_wO_380.push_back(h_100_CT_wO_380_recojet08_Delta_E1_E2_over_E12);
  hist_vec_100_CT_wO_380.push_back(h_100_CT_wO_380_recojet09_dphi_j1j2);
  hist_vec_100_CT_wO_380.push_back(h_100_CT_wO_380_recojet09_E1_E2_over_E_True);
  hist_vec_100_CT_wO_380.push_back(h_100_CT_wO_380_recojet09_Delta_E1_E2_over_E12);
  hist_vec_100_CT_wO_380.push_back(h_100_CT_wO_380_recojet10_dphi_j1j2);
  hist_vec_100_CT_wO_380.push_back(h_100_CT_wO_380_recojet10_E1_E2_over_E_True);
  hist_vec_100_CT_wO_380.push_back(h_100_CT_wO_380_recojet10_Delta_E1_E2_over_E12);

  hist_vec_100_CT_wO_380.push_back(h_100_CT_wO_380_recojetE_over_genjetE_DR03);
  hist_vec_100_CT_wO_380.push_back(h_100_CT_wO_380_recojetE_over_genjetE_DR04);
  hist_vec_100_CT_wO_380.push_back(h_100_CT_wO_380_recojetE_over_genjetE_DR05);
  hist_vec_100_CT_wO_380.push_back(h_100_CT_wO_380_recojetE_over_genjetE_DR06);
  hist_vec_100_CT_wO_380.push_back(h_100_CT_wO_380_recojetE_over_genjetE_DR07);
  hist_vec_100_CT_wO_380.push_back(h_100_CT_wO_380_recojetE_over_genjetE_DR08);
  hist_vec_100_CT_wO_380.push_back(h_100_CT_wO_380_recojetE_over_genjetE_DR09);
  hist_vec_100_CT_wO_380.push_back(h_100_CT_wO_380_recojetE_over_genjetE_DR10);

  hist_vec_100_CT_wO_380.push_back(h_100_CT_wO_380_dphi_gen_reco_DR05);
  hist_vec_100_CT_wO_380.push_back(h_100_CT_wO_380_dphi_gen_reco_DR06);
  hist_vec_100_CT_wO_380.push_back(h_100_CT_wO_380_dphi_gen_reco_DR07);

  hist_vec_100_CT_wO_380.push_back(h_100_CT_wO_380_DR05_E_rel_totVis_RMS_d1_cosT_0_to_0_10);
  hist_vec_100_CT_wO_380.push_back(h_100_CT_wO_380_DR05_E_rel_totVis_RMS_d1_cosT_0_10_to_0_20);
  hist_vec_100_CT_wO_380.push_back(h_100_CT_wO_380_DR05_E_rel_totVis_RMS_d1_cosT_0_20_to_0_30);
  hist_vec_100_CT_wO_380.push_back(h_100_CT_wO_380_DR05_E_rel_totVis_RMS_d1_cosT_0_30_to_0_40);
  hist_vec_100_CT_wO_380.push_back(h_100_CT_wO_380_DR05_E_rel_totVis_RMS_d1_cosT_0_40_to_0_50);
  hist_vec_100_CT_wO_380.push_back(h_100_CT_wO_380_DR05_E_rel_totVis_RMS_d1_cosT_0_50_to_0_60);
  hist_vec_100_CT_wO_380.push_back(h_100_CT_wO_380_DR05_E_rel_totVis_RMS_d1_cosT_0_60_to_0_70);
  hist_vec_100_CT_wO_380.push_back(h_100_CT_wO_380_DR05_E_rel_totVis_RMS_d1_cosT_0_70_to_0_80);
  hist_vec_100_CT_wO_380.push_back(h_100_CT_wO_380_DR05_E_rel_totVis_RMS_d1_cosT_0_80_to_0_90);
  hist_vec_100_CT_wO_380.push_back(h_100_CT_wO_380_DR05_E_rel_totVis_RMS_d1_cosT_0_900_to_0_925);
  hist_vec_100_CT_wO_380.push_back(h_100_CT_wO_380_DR05_E_rel_totVis_RMS_d1_cosT_0_925_to_0_950);
  hist_vec_100_CT_wO_380.push_back(h_100_CT_wO_380_DR05_E_rel_totVis_RMS_d1_cosT_0_950_to_0_975);
  hist_vec_100_CT_wO_380.push_back(h_100_CT_wO_380_DR05_E_rel_totVis_RMS_d1_cosT_0_975_to_1_00);

  hist_vec_100_CT_wO_380.push_back(h_100_CT_wO_380_DR06_E_rel_totVis_RMS_d1_cosT_0_to_0_10);
  hist_vec_100_CT_wO_380.push_back(h_100_CT_wO_380_DR06_E_rel_totVis_RMS_d1_cosT_0_10_to_0_20);
  hist_vec_100_CT_wO_380.push_back(h_100_CT_wO_380_DR06_E_rel_totVis_RMS_d1_cosT_0_20_to_0_30);
  hist_vec_100_CT_wO_380.push_back(h_100_CT_wO_380_DR06_E_rel_totVis_RMS_d1_cosT_0_30_to_0_40);
  hist_vec_100_CT_wO_380.push_back(h_100_CT_wO_380_DR06_E_rel_totVis_RMS_d1_cosT_0_40_to_0_50);
  hist_vec_100_CT_wO_380.push_back(h_100_CT_wO_380_DR06_E_rel_totVis_RMS_d1_cosT_0_50_to_0_60);
  hist_vec_100_CT_wO_380.push_back(h_100_CT_wO_380_DR06_E_rel_totVis_RMS_d1_cosT_0_60_to_0_70);
  hist_vec_100_CT_wO_380.push_back(h_100_CT_wO_380_DR06_E_rel_totVis_RMS_d1_cosT_0_70_to_0_80);
  hist_vec_100_CT_wO_380.push_back(h_100_CT_wO_380_DR06_E_rel_totVis_RMS_d1_cosT_0_80_to_0_90);
  hist_vec_100_CT_wO_380.push_back(h_100_CT_wO_380_DR06_E_rel_totVis_RMS_d1_cosT_0_900_to_0_925);
  hist_vec_100_CT_wO_380.push_back(h_100_CT_wO_380_DR06_E_rel_totVis_RMS_d1_cosT_0_925_to_0_950);
  hist_vec_100_CT_wO_380.push_back(h_100_CT_wO_380_DR06_E_rel_totVis_RMS_d1_cosT_0_950_to_0_975);
  hist_vec_100_CT_wO_380.push_back(h_100_CT_wO_380_DR06_E_rel_totVis_RMS_d1_cosT_0_975_to_1_00); 

  hist_vec_100_CT_wO_380.push_back(h_100_CT_wO_380_DR07_E_rel_totVis_RMS_d1_cosT_0_to_0_10);
  hist_vec_100_CT_wO_380.push_back(h_100_CT_wO_380_DR07_E_rel_totVis_RMS_d1_cosT_0_10_to_0_20);
  hist_vec_100_CT_wO_380.push_back(h_100_CT_wO_380_DR07_E_rel_totVis_RMS_d1_cosT_0_20_to_0_30);
  hist_vec_100_CT_wO_380.push_back(h_100_CT_wO_380_DR07_E_rel_totVis_RMS_d1_cosT_0_30_to_0_40);
  hist_vec_100_CT_wO_380.push_back(h_100_CT_wO_380_DR07_E_rel_totVis_RMS_d1_cosT_0_40_to_0_50);
  hist_vec_100_CT_wO_380.push_back(h_100_CT_wO_380_DR07_E_rel_totVis_RMS_d1_cosT_0_50_to_0_60);
  hist_vec_100_CT_wO_380.push_back(h_100_CT_wO_380_DR07_E_rel_totVis_RMS_d1_cosT_0_60_to_0_70);
  hist_vec_100_CT_wO_380.push_back(h_100_CT_wO_380_DR07_E_rel_totVis_RMS_d1_cosT_0_70_to_0_80);
  hist_vec_100_CT_wO_380.push_back(h_100_CT_wO_380_DR07_E_rel_totVis_RMS_d1_cosT_0_80_to_0_90);
  hist_vec_100_CT_wO_380.push_back(h_100_CT_wO_380_DR07_E_rel_totVis_RMS_d1_cosT_0_900_to_0_925);
  hist_vec_100_CT_wO_380.push_back(h_100_CT_wO_380_DR07_E_rel_totVis_RMS_d1_cosT_0_925_to_0_950);
  hist_vec_100_CT_wO_380.push_back(h_100_CT_wO_380_DR07_E_rel_totVis_RMS_d1_cosT_0_950_to_0_975);
  hist_vec_100_CT_wO_380.push_back(h_100_CT_wO_380_DR07_E_rel_totVis_RMS_d1_cosT_0_975_to_1_00); 

  hist_vec_100_CT_wO_380.push_back(h_100_CT_wO_380_DR08_E_rel_totVis_RMS_d1_cosT_0_to_0_10);
  hist_vec_100_CT_wO_380.push_back(h_100_CT_wO_380_DR08_E_rel_totVis_RMS_d1_cosT_0_10_to_0_20);
  hist_vec_100_CT_wO_380.push_back(h_100_CT_wO_380_DR08_E_rel_totVis_RMS_d1_cosT_0_20_to_0_30);
  hist_vec_100_CT_wO_380.push_back(h_100_CT_wO_380_DR08_E_rel_totVis_RMS_d1_cosT_0_30_to_0_40);
  hist_vec_100_CT_wO_380.push_back(h_100_CT_wO_380_DR08_E_rel_totVis_RMS_d1_cosT_0_40_to_0_50);
  hist_vec_100_CT_wO_380.push_back(h_100_CT_wO_380_DR08_E_rel_totVis_RMS_d1_cosT_0_50_to_0_60);
  hist_vec_100_CT_wO_380.push_back(h_100_CT_wO_380_DR08_E_rel_totVis_RMS_d1_cosT_0_60_to_0_70);
  hist_vec_100_CT_wO_380.push_back(h_100_CT_wO_380_DR08_E_rel_totVis_RMS_d1_cosT_0_70_to_0_80);
  hist_vec_100_CT_wO_380.push_back(h_100_CT_wO_380_DR08_E_rel_totVis_RMS_d1_cosT_0_80_to_0_90);
  hist_vec_100_CT_wO_380.push_back(h_100_CT_wO_380_DR08_E_rel_totVis_RMS_d1_cosT_0_900_to_0_925);
  hist_vec_100_CT_wO_380.push_back(h_100_CT_wO_380_DR08_E_rel_totVis_RMS_d1_cosT_0_925_to_0_950);
  hist_vec_100_CT_wO_380.push_back(h_100_CT_wO_380_DR08_E_rel_totVis_RMS_d1_cosT_0_950_to_0_975);
  hist_vec_100_CT_wO_380.push_back(h_100_CT_wO_380_DR08_E_rel_totVis_RMS_d1_cosT_0_975_to_1_00); //110

  hist_vec_100_CT_wO_380.push_back(h_100_CT_wO_380_DR09_E_rel_totVis_RMS_d1_cosT_0_to_0_10);
  hist_vec_100_CT_wO_380.push_back(h_100_CT_wO_380_DR09_E_rel_totVis_RMS_d1_cosT_0_10_to_0_20);
  hist_vec_100_CT_wO_380.push_back(h_100_CT_wO_380_DR09_E_rel_totVis_RMS_d1_cosT_0_20_to_0_30);
  hist_vec_100_CT_wO_380.push_back(h_100_CT_wO_380_DR09_E_rel_totVis_RMS_d1_cosT_0_30_to_0_40);
  hist_vec_100_CT_wO_380.push_back(h_100_CT_wO_380_DR09_E_rel_totVis_RMS_d1_cosT_0_40_to_0_50);
  hist_vec_100_CT_wO_380.push_back(h_100_CT_wO_380_DR09_E_rel_totVis_RMS_d1_cosT_0_50_to_0_60);
  hist_vec_100_CT_wO_380.push_back(h_100_CT_wO_380_DR09_E_rel_totVis_RMS_d1_cosT_0_60_to_0_70);
  hist_vec_100_CT_wO_380.push_back(h_100_CT_wO_380_DR09_E_rel_totVis_RMS_d1_cosT_0_70_to_0_80);
  hist_vec_100_CT_wO_380.push_back(h_100_CT_wO_380_DR09_E_rel_totVis_RMS_d1_cosT_0_80_to_0_90);
  hist_vec_100_CT_wO_380.push_back(h_100_CT_wO_380_DR09_E_rel_totVis_RMS_d1_cosT_0_900_to_0_925);
  hist_vec_100_CT_wO_380.push_back(h_100_CT_wO_380_DR09_E_rel_totVis_RMS_d1_cosT_0_925_to_0_950);
  hist_vec_100_CT_wO_380.push_back(h_100_CT_wO_380_DR09_E_rel_totVis_RMS_d1_cosT_0_950_to_0_975);
  hist_vec_100_CT_wO_380.push_back(h_100_CT_wO_380_DR09_E_rel_totVis_RMS_d1_cosT_0_975_to_1_00); //123

  hist_vec_100_CT_wO_380.push_back(h_100_CT_wO_380_DR10_E_rel_totVis_RMS_d1_cosT_0_to_0_10);
  hist_vec_100_CT_wO_380.push_back(h_100_CT_wO_380_DR10_E_rel_totVis_RMS_d1_cosT_0_10_to_0_20);
  hist_vec_100_CT_wO_380.push_back(h_100_CT_wO_380_DR10_E_rel_totVis_RMS_d1_cosT_0_20_to_0_30);
  hist_vec_100_CT_wO_380.push_back(h_100_CT_wO_380_DR10_E_rel_totVis_RMS_d1_cosT_0_30_to_0_40);
  hist_vec_100_CT_wO_380.push_back(h_100_CT_wO_380_DR10_E_rel_totVis_RMS_d1_cosT_0_40_to_0_50);
  hist_vec_100_CT_wO_380.push_back(h_100_CT_wO_380_DR10_E_rel_totVis_RMS_d1_cosT_0_50_to_0_60);
  hist_vec_100_CT_wO_380.push_back(h_100_CT_wO_380_DR10_E_rel_totVis_RMS_d1_cosT_0_60_to_0_70);
  hist_vec_100_CT_wO_380.push_back(h_100_CT_wO_380_DR10_E_rel_totVis_RMS_d1_cosT_0_70_to_0_80);
  hist_vec_100_CT_wO_380.push_back(h_100_CT_wO_380_DR10_E_rel_totVis_RMS_d1_cosT_0_80_to_0_90);
  hist_vec_100_CT_wO_380.push_back(h_100_CT_wO_380_DR10_E_rel_totVis_RMS_d1_cosT_0_900_to_0_925);
  hist_vec_100_CT_wO_380.push_back(h_100_CT_wO_380_DR10_E_rel_totVis_RMS_d1_cosT_0_925_to_0_950);
  hist_vec_100_CT_wO_380.push_back(h_100_CT_wO_380_DR10_E_rel_totVis_RMS_d1_cosT_0_950_to_0_975);
  hist_vec_100_CT_wO_380.push_back(h_100_CT_wO_380_DR10_E_rel_totVis_RMS_d1_cosT_0_975_to_1_00); //136

  hist_vec_100_CT_wO_380.push_back(h_100_CT_wO_380_DR05_dphi_reco_gen_cosTheta_0_65);//137
  hist_vec_100_CT_wO_380.push_back(h_100_CT_wO_380_DR05_dphi_reco_gen_cosTheta_0_65_to_0_80);
  hist_vec_100_CT_wO_380.push_back(h_100_CT_wO_380_DR05_dphi_reco_gen_cosTheta_0_80_to_0_925);
  hist_vec_100_CT_wO_380.push_back(h_100_CT_wO_380_DR05_dphi_reco_gen_cosTheta_0_925_to_0_975);
  hist_vec_100_CT_wO_380.push_back(h_100_CT_wO_380_DR05_dtheta_reco_gen_cosTheta_0_65);
  hist_vec_100_CT_wO_380.push_back(h_100_CT_wO_380_DR05_dtheta_reco_gen_cosTheta_0_65_to_0_80);
  hist_vec_100_CT_wO_380.push_back(h_100_CT_wO_380_DR05_dtheta_reco_gen_cosTheta_0_80_to_0_925);
  hist_vec_100_CT_wO_380.push_back(h_100_CT_wO_380_DR05_dtheta_reco_gen_cosTheta_0_925_to_0_975);

  hist_vec_100_CT_wO_380.push_back(h_100_CT_wO_380_DR07_dphi_reco_gen_cosTheta_0_65);//145
  hist_vec_100_CT_wO_380.push_back(h_100_CT_wO_380_DR07_dphi_reco_gen_cosTheta_0_65_to_0_80);
  hist_vec_100_CT_wO_380.push_back(h_100_CT_wO_380_DR07_dphi_reco_gen_cosTheta_0_80_to_0_925);
  hist_vec_100_CT_wO_380.push_back(h_100_CT_wO_380_DR07_dphi_reco_gen_cosTheta_0_925_to_0_975);
  hist_vec_100_CT_wO_380.push_back(h_100_CT_wO_380_DR07_dtheta_reco_gen_cosTheta_0_65);
  hist_vec_100_CT_wO_380.push_back(h_100_CT_wO_380_DR07_dtheta_reco_gen_cosTheta_0_65_to_0_80);
  hist_vec_100_CT_wO_380.push_back(h_100_CT_wO_380_DR07_dtheta_reco_gen_cosTheta_0_80_to_0_925);
  hist_vec_100_CT_wO_380.push_back(h_100_CT_wO_380_DR07_dtheta_reco_gen_cosTheta_0_925_to_0_975);

  hist_vec_100_CT_wO_380.push_back(h_100_CT_wO_380_DR10_dphi_reco_gen_cosTheta_0_65);//153
  hist_vec_100_CT_wO_380.push_back(h_100_CT_wO_380_DR10_dphi_reco_gen_cosTheta_0_65_to_0_80);
  hist_vec_100_CT_wO_380.push_back(h_100_CT_wO_380_DR10_dphi_reco_gen_cosTheta_0_80_to_0_925);
  hist_vec_100_CT_wO_380.push_back(h_100_CT_wO_380_DR10_dphi_reco_gen_cosTheta_0_925_to_0_975);
  hist_vec_100_CT_wO_380.push_back(h_100_CT_wO_380_DR10_dtheta_reco_gen_cosTheta_0_65);
  hist_vec_100_CT_wO_380.push_back(h_100_CT_wO_380_DR10_dtheta_reco_gen_cosTheta_0_65_to_0_80);
  hist_vec_100_CT_wO_380.push_back(h_100_CT_wO_380_DR10_dtheta_reco_gen_cosTheta_0_80_to_0_925);
  hist_vec_100_CT_wO_380.push_back(h_100_CT_wO_380_DR10_dtheta_reco_gen_cosTheta_0_925_to_0_975);


  for(unsigned int i=0;i<hist_vec_100_CT.size();i++){
    hist_vec_100_CT_wO_380[i]->Sumw2();
  }
  fill_jet_histograms(file_CLIC_100_CT_wO_380,hist_vec_100_CT_wO_380);

  TH1F* h_100_CT_wO_380_DR05_dphi_SigmaCB_summary_histogram=new TH1F("dphiRes_SigmaCBVsCosTheta_CT_wO_380_DR05_100", "#sigma#Delta#phi(j_{reco},j_{true}) vs |cos#theta|", nRegionBinsAngles, pRegionBinEdgesAngles);
  h_100_CT_wO_380_DR05_dphi_SigmaCB_summary_histogram ->SetYTitle("#sigma#Delta#phi(j_{reco},j_{true})");
  h_100_CT_wO_380_DR05_dphi_SigmaCB_summary_histogram->SetXTitle("|cos#theta|");
  h_100_CT_wO_380_DR05_dphi_SigmaCB_summary_histogram->SetLineWidth(2);
  h_100_CT_wO_380_DR05_dphi_SigmaCB_summary_histogram->SetLineColor(kCyan+1);
  h_100_CT_wO_380_DR05_dphi_SigmaCB_summary_histogram->SetLineStyle(2);

  TH1F* h_100_CT_wO_380_DR05_dphi_RMS90_summary_histogram=new TH1F("dphiRes_RMS90VsCosTheta_CT_wO_380_DR05_100", "RMS_{90} #Delta#phi(j_{reco},j_{true}) vs |cos#theta|", nRegionBinsAngles, pRegionBinEdgesAngles);
  h_100_CT_wO_380_DR05_dphi_RMS90_summary_histogram ->SetYTitle("RMS_{90}#Delta#phi(j_{reco},j_{true})");
  h_100_CT_wO_380_DR05_dphi_RMS90_summary_histogram->SetXTitle("|cos#theta|");
  h_100_CT_wO_380_DR05_dphi_RMS90_summary_histogram->SetLineWidth(2);
  h_100_CT_wO_380_DR05_dphi_RMS90_summary_histogram->SetLineColor(kCyan+1);
  h_100_CT_wO_380_DR05_dphi_RMS90_summary_histogram->SetLineStyle(2);

  TH1F* h_100_CT_wO_380_DR07_dphi_SigmaCB_summary_histogram=new TH1F("dphiRes_SigmaCBVsCosTheta_CT_wO_380_DR07_100", "#sigma#Delta#phi(j_{reco},j_{true}) vs |cos#theta|", nRegionBinsAngles, pRegionBinEdgesAngles);
  h_100_CT_wO_380_DR07_dphi_SigmaCB_summary_histogram ->SetYTitle("#sigma#Delta#phi(j_{reco},j_{true})");
  h_100_CT_wO_380_DR07_dphi_SigmaCB_summary_histogram->SetXTitle("|cos#theta|");
  h_100_CT_wO_380_DR07_dphi_SigmaCB_summary_histogram->SetLineWidth(2);
  h_100_CT_wO_380_DR07_dphi_SigmaCB_summary_histogram->SetLineColor(kCyan+1);
  h_100_CT_wO_380_DR07_dphi_SigmaCB_summary_histogram->SetLineStyle(2);

  TH1F* h_100_CT_wO_380_DR07_dphi_RMS90_summary_histogram=new TH1F("dphiRes_RMS90VsCosTheta_CT_wO_380_DR07_100", "RMS_{90} #Delta#phi(j_{reco},j_{true}) vs |cos#theta|", nRegionBinsAngles, pRegionBinEdgesAngles);
  h_100_CT_wO_380_DR07_dphi_RMS90_summary_histogram ->SetYTitle("RMS_{90}#Delta#phi(j_{reco},j_{true})");
  h_100_CT_wO_380_DR07_dphi_RMS90_summary_histogram->SetXTitle("|cos#theta|");
  h_100_CT_wO_380_DR07_dphi_RMS90_summary_histogram->SetLineWidth(2);
  h_100_CT_wO_380_DR07_dphi_RMS90_summary_histogram->SetLineColor(kCyan+1);
  h_100_CT_wO_380_DR07_dphi_RMS90_summary_histogram->SetLineStyle(2);

  TH1F* h_100_CT_wO_380_DR10_dphi_SigmaCB_summary_histogram=new TH1F("dphiRes_SigmaCBVsCosTheta_CT_wO_380_DR10_100", "#sigma#Delta#phi(j_{reco},j_{true}) vs |cos#theta|", nRegionBinsAngles, pRegionBinEdgesAngles);
  h_100_CT_wO_380_DR10_dphi_SigmaCB_summary_histogram ->SetYTitle("#sigma#Delta#phi(j_{reco},j_{true})");
  h_100_CT_wO_380_DR10_dphi_SigmaCB_summary_histogram->SetXTitle("|cos#theta|");
  h_100_CT_wO_380_DR10_dphi_SigmaCB_summary_histogram->SetLineWidth(2);
  h_100_CT_wO_380_DR10_dphi_SigmaCB_summary_histogram->SetLineColor(kCyan+1);
  h_100_CT_wO_380_DR10_dphi_SigmaCB_summary_histogram->SetLineStyle(2);

  TH1F* h_100_CT_wO_380_DR10_dphi_RMS90_summary_histogram=new TH1F("dphiRes_RMS90VsCosTheta_CT_wO_380_DR10_100", "RMS_{90} #Delta#phi(j_{reco},j_{true}) vs |cos#theta|", nRegionBinsAngles, pRegionBinEdgesAngles);
  h_100_CT_wO_380_DR10_dphi_RMS90_summary_histogram ->SetYTitle("RMS_{90}#Delta#phi(j_{reco},j_{true})");
  h_100_CT_wO_380_DR10_dphi_RMS90_summary_histogram->SetXTitle("|cos#theta|");
  h_100_CT_wO_380_DR10_dphi_RMS90_summary_histogram->SetLineWidth(2);
  h_100_CT_wO_380_DR10_dphi_RMS90_summary_histogram->SetLineColor(kCyan+1);
  h_100_CT_wO_380_DR10_dphi_RMS90_summary_histogram->SetLineStyle(2);

  TH1F* h_100_CT_wO_380_DR05_dtheta_SigmaCB_summary_histogram=new TH1F("dthetaRes_SigmaCBVsCosTheta_CT_wO_380_DR05_100", "#sigma#Delta#theta(j_{reco},j_{true}) vs |cos#theta|", nRegionBinsAngles, pRegionBinEdgesAngles);
  h_100_CT_wO_380_DR05_dtheta_SigmaCB_summary_histogram ->SetYTitle("#sigma#Delta#theta(j_{reco},j_{true})");
  h_100_CT_wO_380_DR05_dtheta_SigmaCB_summary_histogram->SetXTitle("|cos#theta|");
  h_100_CT_wO_380_DR05_dtheta_SigmaCB_summary_histogram->SetLineWidth(2);
  h_100_CT_wO_380_DR05_dtheta_SigmaCB_summary_histogram->SetLineColor(kCyan+1);
  h_100_CT_wO_380_DR05_dtheta_SigmaCB_summary_histogram->SetLineStyle(2);

  TH1F* h_100_CT_wO_380_DR05_dtheta_RMS90_summary_histogram=new TH1F("dthetaRes_RMS90VsCosTheta_CT_wO_380_DR05_100", "RMS_{90} #Delta#theta(j_{reco},j_{true}) vs |cos#theta|", nRegionBinsAngles, pRegionBinEdgesAngles);
  h_100_CT_wO_380_DR05_dtheta_RMS90_summary_histogram ->SetYTitle("RMS_{90}#Delta#theta(j_{reco},j_{true})");
  h_100_CT_wO_380_DR05_dtheta_RMS90_summary_histogram->SetXTitle("|cos#theta|");
  h_100_CT_wO_380_DR05_dtheta_RMS90_summary_histogram->SetLineWidth(2);
  h_100_CT_wO_380_DR05_dtheta_RMS90_summary_histogram->SetLineColor(kCyan+1);
  h_100_CT_wO_380_DR05_dtheta_RMS90_summary_histogram->SetLineStyle(2);

  TH1F* h_100_CT_wO_380_DR07_dtheta_SigmaCB_summary_histogram=new TH1F("dthetaRes_SigmaCBVsCosTheta_CT_wO_380_DR07_100", "#sigma#Delta#theta(j_{reco},j_{true}) vs |cos#theta|", nRegionBinsAngles, pRegionBinEdgesAngles);
  h_100_CT_wO_380_DR07_dtheta_SigmaCB_summary_histogram ->SetYTitle("#sigma#Delta#theta(j_{reco},j_{true})");
  h_100_CT_wO_380_DR07_dtheta_SigmaCB_summary_histogram->SetXTitle("|cos#theta|");
  h_100_CT_wO_380_DR07_dtheta_SigmaCB_summary_histogram->SetLineWidth(2);
  h_100_CT_wO_380_DR07_dtheta_SigmaCB_summary_histogram->SetLineColor(kCyan+1);
  h_100_CT_wO_380_DR07_dtheta_SigmaCB_summary_histogram->SetLineStyle(2);

  TH1F* h_100_CT_wO_380_DR07_dtheta_RMS90_summary_histogram=new TH1F("dthetaRes_RMS90VsCosTheta_CT_wO_380_DR07_100", "RMS_{90} #Delta#theta(j_{reco},j_{true}) vs |cos#theta|", nRegionBinsAngles, pRegionBinEdgesAngles);
  h_100_CT_wO_380_DR07_dtheta_RMS90_summary_histogram ->SetYTitle("RMS_{90}#Delta#theta(j_{reco},j_{true})");
  h_100_CT_wO_380_DR07_dtheta_RMS90_summary_histogram->SetXTitle("|cos#theta|");
  h_100_CT_wO_380_DR07_dtheta_RMS90_summary_histogram->SetLineWidth(2);
  h_100_CT_wO_380_DR07_dtheta_RMS90_summary_histogram->SetLineColor(kCyan+1);
  h_100_CT_wO_380_DR07_dtheta_RMS90_summary_histogram->SetLineStyle(2);

  TH1F* h_100_CT_wO_380_DR10_dtheta_SigmaCB_summary_histogram=new TH1F("dthetaRes_SigmaCBVsCosTheta_CT_wO_380_DR10_100", "#sigma#Delta#theta(j_{reco},j_{true}) vs |cos#theta|", nRegionBinsAngles, pRegionBinEdgesAngles);
  h_100_CT_wO_380_DR10_dtheta_SigmaCB_summary_histogram ->SetYTitle("#sigma#Delta#theta(j_{reco},j_{true})");
  h_100_CT_wO_380_DR10_dtheta_SigmaCB_summary_histogram->SetXTitle("|cos#theta|");
  h_100_CT_wO_380_DR10_dtheta_SigmaCB_summary_histogram->SetLineWidth(2);
  h_100_CT_wO_380_DR10_dtheta_SigmaCB_summary_histogram->SetLineColor(kCyan+1);
  h_100_CT_wO_380_DR10_dtheta_SigmaCB_summary_histogram->SetLineStyle(2);

  TH1F* h_100_CT_wO_380_DR10_dtheta_RMS90_summary_histogram=new TH1F("dthetaRes_RMS90VsCosTheta_CT_wO_380_DR10_100", "RMS_{90} #Delta#theta(j_{reco},j_{true}) vs |cos#theta|", nRegionBinsAngles, pRegionBinEdgesAngles);
  h_100_CT_wO_380_DR10_dtheta_RMS90_summary_histogram ->SetYTitle("RMS_{90}#Delta#theta(j_{reco},j_{true})");
  h_100_CT_wO_380_DR10_dtheta_RMS90_summary_histogram->SetXTitle("|cos#theta|");
  h_100_CT_wO_380_DR10_dtheta_RMS90_summary_histogram->SetLineWidth(2);
  h_100_CT_wO_380_DR10_dtheta_RMS90_summary_histogram->SetLineColor(kCyan+1);
  h_100_CT_wO_380_DR10_dtheta_RMS90_summary_histogram->SetLineStyle(2);

  for(int i=137;i<161;i++){
    std::cout<<"ang histo 380 "<<i<<"]"<<std::endl;
   //double sided crystal ball
    TF1* fit_gaus_tmp = new TF1("fit_gaus_tmp", "gaus",-5.,5.);
    hist_vec_100_CT_wO_380[i]->Fit("fit_gaus_tmp","R");
    hist_vec_100_CT_wO_380[i]->GetFunction("fit_gaus_tmp");
    TF1* fdscb_tmp = new TF1("fdscb_tmp",fnc_dscb,-lim_angleDeg,lim_angleDeg,7);
   fdscb_tmp->SetNpx(2000);
    fdscb_tmp->SetParameter(0,fit_gaus_tmp->GetParameter(0));
    //norm
    fdscb_tmp->SetParLimits (0,0.5*fit_gaus_tmp->GetParameter(0),1.5*fit_gaus_tmp->GetParameter(0));
    fdscb_tmp->SetParameter(1,fit_gaus_tmp->GetParameter(1));
    //gaussian mean
    fdscb_tmp->SetParLimits (1,-2.,2.);
    fdscb_tmp->SetParameter(2,fit_gaus_tmp->GetParameter(2));
    fdscb_tmp->SetParLimits(2,fit_gaus_tmp->GetParameter(2)*0.50,1.50*fit_gaus_tmp->GetParameter(2));
    //std::vector<float>sigma2SFit=sigmaGaussianFits2Sigma(hist_vec_200_CT_wO[i]);
    //fdscb_tmp->SetParameter(2,sigma2SFit[0]);
    //fdscb_tmp->SetParLimits(2,sigma2SFit[0]*0.50,1.50*sigma2SFit[0]);
    //-a1: parameter, from when the gaussian core should count
    //fdscb_tmp->SetParameter(2,fit_gaus_tmp->GetParameter(2));
    fdscb_tmp->SetParameter (3,3.0);
    fdscb_tmp->SetParLimits (3,0.0,10.0);
    //a2 parameter, up to when the gaussian core should count
    fdscb_tmp->SetParameter (5,3.0);
    fdscb_tmp->SetParLimits (5,0.0,10.0);
    fdscb_tmp->SetParameter(4,5.);
    fdscb_tmp->SetParLimits(4,0.,25.);
    fdscb_tmp->SetParameter(6,5.);
    fdscb_tmp->SetParLimits(6,0.,25.);
    int fitstatus(0); 
    fitstatus = hist_vec_100_CT_wO_380[i]->Fit(fdscb_tmp,"R");
    fdscb_tmp = hist_vec_100_CT_wO_380[i]->GetFunction("fdscb_tmp");
    resolutionTH1=0; 
    resolutionErrorTH1=0;
    meanTH1=0;
    meanErrorTH1=0;
    CalculatePerformanceNoMean( hist_vec_100_CT_wO_380[i], resolutionTH1, resolutionErrorTH1,meanTH1,meanErrorTH1);
    int first_bin_ang=137;
    if(i<141){//dphi DR05
      first_bin_ang=137;
      h_100_CT_wO_380_DR05_dphi_SigmaCB_summary_histogram->SetBinContent(i-first_bin_ang+1,fdscb_tmp->GetParameter(2));
      h_100_CT_wO_380_DR05_dphi_SigmaCB_summary_histogram->SetBinError(i-first_bin_ang+1,fdscb_tmp->GetParError(2));
      h_100_CT_wO_380_DR05_dphi_RMS90_summary_histogram->SetBinContent(i-first_bin_ang+1,resolutionTH1);
      h_100_CT_wO_380_DR05_dphi_RMS90_summary_histogram->SetBinError(i-first_bin_ang+1, resolutionErrorTH1);
    }else if(i<145){//dtheta DR05
      first_bin_ang=141;
      h_100_CT_wO_380_DR05_dtheta_SigmaCB_summary_histogram->SetBinContent(i-first_bin_ang+1,fdscb_tmp->GetParameter(2));
      h_100_CT_wO_380_DR05_dtheta_SigmaCB_summary_histogram->SetBinError(i-first_bin_ang+1,fdscb_tmp->GetParError(2));
      h_100_CT_wO_380_DR05_dtheta_RMS90_summary_histogram->SetBinContent(i-first_bin_ang+1,resolutionTH1);
      h_100_CT_wO_380_DR05_dtheta_RMS90_summary_histogram->SetBinError(i-first_bin_ang+1, resolutionErrorTH1);
    }else if(i<149){//dphi DR07
      first_bin_ang=145;
      h_100_CT_wO_380_DR07_dphi_SigmaCB_summary_histogram->SetBinContent(i-first_bin_ang+1,fdscb_tmp->GetParameter(2));
      h_100_CT_wO_380_DR07_dphi_SigmaCB_summary_histogram->SetBinError(i-first_bin_ang+1,fdscb_tmp->GetParError(2));
      h_100_CT_wO_380_DR07_dphi_RMS90_summary_histogram->SetBinContent(i-first_bin_ang+1,resolutionTH1);
      h_100_CT_wO_380_DR07_dphi_RMS90_summary_histogram->SetBinError(i-first_bin_ang+1, resolutionErrorTH1);
    }else if(i<153){//dtheta DR07
      first_bin_ang=149;
      h_100_CT_wO_380_DR07_dtheta_SigmaCB_summary_histogram->SetBinContent(i-first_bin_ang+1,fdscb_tmp->GetParameter(2));
      h_100_CT_wO_380_DR07_dtheta_SigmaCB_summary_histogram->SetBinError(i-first_bin_ang+1,fdscb_tmp->GetParError(2));
      h_100_CT_wO_380_DR07_dtheta_RMS90_summary_histogram->SetBinContent(i-first_bin_ang+1,resolutionTH1);
      h_100_CT_wO_380_DR07_dtheta_RMS90_summary_histogram->SetBinError(i-first_bin_ang+1, resolutionErrorTH1);
    }else if(i<157){//dphi DR07
      first_bin_ang=153;
      h_100_CT_wO_380_DR10_dphi_SigmaCB_summary_histogram->SetBinContent(i-first_bin_ang+1,fdscb_tmp->GetParameter(2));
      h_100_CT_wO_380_DR10_dphi_SigmaCB_summary_histogram->SetBinError(i-first_bin_ang+1,fdscb_tmp->GetParError(2));
      h_100_CT_wO_380_DR10_dphi_RMS90_summary_histogram->SetBinContent(i-first_bin_ang+1,resolutionTH1);
      h_100_CT_wO_380_DR10_dphi_RMS90_summary_histogram->SetBinError(i-first_bin_ang+1, resolutionErrorTH1);
    }else if(i<161){//dtheta DR07
      first_bin_ang=157;
      h_100_CT_wO_380_DR10_dtheta_SigmaCB_summary_histogram->SetBinContent(i-first_bin_ang+1,fdscb_tmp->GetParameter(2));
      h_100_CT_wO_380_DR10_dtheta_SigmaCB_summary_histogram->SetBinError(i-first_bin_ang+1,fdscb_tmp->GetParError(2));
      h_100_CT_wO_380_DR10_dtheta_RMS90_summary_histogram->SetBinContent(i-first_bin_ang+1,resolutionTH1);
      h_100_CT_wO_380_DR10_dtheta_RMS90_summary_histogram->SetBinError(i-first_bin_ang+1, resolutionErrorTH1);
    }
  }

  TH1F* h_100_CT_wO_380_DR05_E_SigmaCB_summary_histogram=new TH1F("JER_SigmaCBVsCosTheta_CT_wO_380_DR05_100", "RMS_{90}(E_{j}^{reco}/E_{j}^{gen}) / Mean_{90}(E_{j}^{reco}/E_{j}^{gen}) vs |cos#theta|", nRegionBins, pRegionBinEdges);
  h_100_CT_wO_380_DR05_E_SigmaCB_summary_histogram ->SetYTitle("#sigma(E_{j}) / E_{j} [%]");
  h_100_CT_wO_380_DR05_E_SigmaCB_summary_histogram->SetXTitle("|cos#theta|");
  h_100_CT_wO_380_DR05_E_SigmaCB_summary_histogram->SetLineWidth(2);
  h_100_CT_wO_380_DR05_E_SigmaCB_summary_histogram->SetLineColor(kOrange);
  h_100_CT_wO_380_DR05_E_SigmaCB_summary_histogram->SetLineStyle(2);
  TH1F* h_100_CT_wO_380_DR05_E_RMS90_summary_histogram=new TH1F("JER_RMS90VsCosTheta_CT_wO_380_DR05_100", "RMS_{90}(E_{j}^{reco}/E_{j}^{gen}) / Mean_{90}(E_{j}^{reco}/E_{j}^{gen}) vs |cos#theta|", nRegionBins, pRegionBinEdges);
  h_100_CT_wO_380_DR05_E_RMS90_summary_histogram ->SetYTitle("RMS_{90}(E_{j}^{reco}/E_{j}^{gen}) / Mean_{90}(E_{j}^{reco}/E_{j}^{gen}) [%]");
  h_100_CT_wO_380_DR05_E_RMS90_summary_histogram->SetXTitle("|cos#theta|");
  h_100_CT_wO_380_DR05_E_RMS90_summary_histogram->SetLineWidth(2);
  h_100_CT_wO_380_DR05_E_RMS90_summary_histogram->SetLineColor(kRed);
  h_100_CT_wO_380_DR05_E_RMS90_summary_histogram->SetLineStyle(2);

  TH1F* h_100_CT_wO_380_DR05_E_RMS_summary_histogram=new TH1F("JER_RMSVsCosTheta_CT_wO_380_DR05_100", "RMS(E_{j}) / Mean(E_{j}) vs |cos#theta|", nRegionBins, pRegionBinEdges);
  h_100_CT_wO_380_DR05_E_RMS_summary_histogram ->SetYTitle("RMS(E_{j}) / Mean(E_{j}) [%]");
  h_100_CT_wO_380_DR05_E_RMS_summary_histogram->SetXTitle("|cos#theta|");
  h_100_CT_wO_380_DR05_E_RMS_summary_histogram->SetLineWidth(2);
  h_100_CT_wO_380_DR05_E_RMS_summary_histogram->SetLineColor(kRed);
  h_100_CT_wO_380_DR05_E_RMS_summary_histogram->SetLineStyle(2);

  TH1F* h_100_CT_wO_380_DR05_E_JER_Mean_summary_histogram=new TH1F("JER_MeanVsCosTheta_CT_wO_380_DR05_100", "Mean(E_{tot}^{RECO}/E_{tot}^{true}) vs |cos#theta|", nRegionBins, pRegionBinEdges);
  h_100_CT_wO_380_DR05_E_JER_Mean_summary_histogram->SetYTitle("Mean(E_{tot}^{RECO}/E_{tot}^{true})");
  h_100_CT_wO_380_DR05_E_JER_Mean_summary_histogram->SetXTitle("|cos#theta|");
  h_100_CT_wO_380_DR05_E_JER_Mean_summary_histogram->SetLineWidth(2);
  h_100_CT_wO_380_DR05_E_JER_Mean_summary_histogram->SetLineColor(kRed);
  h_100_CT_wO_380_DR05_E_JER_Mean_summary_histogram->SetLineStyle(2);

  firstbin=59;
  for(int i=firstbin;i<(firstbin+13);i++){
    resolutionTH1=0; 
    resolutionErrorTH1=0;
    meanTH1=0;
    meanErrorTH1=0;
    CalculatePerformance( hist_vec_100_CT_wO_380[i], resolutionTH1, resolutionErrorTH1,meanTH1,meanErrorTH1);
    h_100_CT_wO_380_DR05_E_RMS90_summary_histogram->SetBinContent(i-firstbin+1,resolutionTH1/sqrt(2.));
    h_100_CT_wO_380_DR05_E_RMS90_summary_histogram ->SetBinError(i-firstbin+1, resolutionErrorTH1/sqrt(2.));
    h_100_CT_wO_380_DR05_E_RMS_summary_histogram->SetBinContent(i-firstbin+1,hist_vec_100_CT_wO_380[i]->GetRMS()*100. );
    h_100_CT_wO_380_DR05_E_RMS_summary_histogram ->SetBinError(i-firstbin+1, hist_vec_100_CT_wO_380[i]->GetRMSError()*100.);
    h_100_CT_wO_380_DR05_E_JER_Mean_summary_histogram->SetBinContent(i-firstbin+1,hist_vec_100_CT_wO_380[i]->GetMean());
    h_100_CT_wO_380_DR05_E_JER_Mean_summary_histogram->SetBinError(i-firstbin+1,hist_vec_100_CT_wO_380[i]->GetMeanError());
    //double sided crystal ball
    TF1* fit_gaus_tmp = new TF1("fit_gaus_tmp", "gaus",0.50,1.50);
    hist_vec_100_CT_wO_380[i]->Fit("fit_gaus_tmp","R");
    hist_vec_100_CT_wO_380[i]->GetFunction("fit_gaus_tmp");

    TF1* fdscb_tmp = new TF1("fdscb_tmp",fnc_dscb,0.,3.,7);
   fdscb_tmp->SetNpx(1000);
    fdscb_tmp->SetParameter(0,fit_gaus_tmp->GetParameter(0));
    //norm
    fdscb_tmp->SetParLimits (0,0.5*fit_gaus_tmp->GetParameter(0),1.5*fit_gaus_tmp->GetParameter(0));
    fdscb_tmp->SetParameter(1,fit_gaus_tmp->GetParameter(1));
    //gaussian mean
    fdscb_tmp->SetParLimits (1,0.8,1.2);
    //fdscb_tmp->SetParameter(2,fit_gaus_tmp->GetParameter(2));
    //fdscb_tmp->SetParLimits(2,fit_gaus_tmp->GetParameter(2)*0.50,1.50*fit_gaus_tmp->GetParameter(2));
    std::vector<float>sigma2SFit=sigmaGaussianFits2Sigma(hist_vec_100_CT_wO_380[i]);
    fdscb_tmp->SetParameter(2,sigma2SFit[0]);
    fdscb_tmp->SetParLimits(2,sigma2SFit[0]*0.50,1.50*sigma2SFit[0]);
    //-a1: parameter, from when the gaussian core should count
    fdscb_tmp->SetParameter(2,fit_gaus_tmp->GetParameter(2));
    fdscb_tmp->SetParameter (3,3.0);
    fdscb_tmp->SetParLimits (3,0.0,10.0);
    //a2 parameter, up to when the gaussian core should count
    fdscb_tmp->SetParameter (5,3.0);
    fdscb_tmp->SetParLimits (5,0.0,10.0);
    fdscb_tmp->SetParameter(4,5.);
    fdscb_tmp->SetParLimits(4,0.,25.);
    fdscb_tmp->SetParameter(6,5.);
    fdscb_tmp->SetParLimits(6,0.,25.);
    int fitstatus(0); 
    fitstatus = hist_vec_100_CT_wO_380[i]->Fit(fdscb_tmp,"R");
    fdscb_tmp = hist_vec_100_CT_wO_380[i]->GetFunction("fdscb_tmp");
    h_100_CT_wO_380_DR05_E_SigmaCB_summary_histogram->SetBinContent(i-firstbin+1,fdscb_tmp->GetParameter(2)*100. );
    h_100_CT_wO_380_DR05_E_SigmaCB_summary_histogram->SetBinError(i-firstbin+1,fdscb_tmp->GetParError(2)*100. );
  }  
  TH1F* h_100_CT_wO_380_DR06_E_SigmaCB_summary_histogram=new TH1F("JER_SigmaCBVsCosTheta_CT_wO_380_DR06_100", "RMS_{90}(E_{j}^{reco}/E_{j}^{gen}) / Mean_{90}(E_{j}^{reco}/E_{j}^{gen}) vs |cos#theta|", nRegionBins, pRegionBinEdges);
  h_100_CT_wO_380_DR06_E_SigmaCB_summary_histogram ->SetYTitle("#sigma(E_{j}) / E_{j} [%]");
  h_100_CT_wO_380_DR06_E_SigmaCB_summary_histogram->SetXTitle("|cos#theta|");
  h_100_CT_wO_380_DR06_E_SigmaCB_summary_histogram->SetLineWidth(2);
  h_100_CT_wO_380_DR06_E_SigmaCB_summary_histogram->SetLineColor(kOrange);
  h_100_CT_wO_380_DR06_E_SigmaCB_summary_histogram->SetLineStyle(2);
  TH1F* h_100_CT_wO_380_DR06_E_RMS90_summary_histogram=new TH1F("JER_RMS90VsCosTheta_CT_wO_380_DR06_100", "RMS_{90}(E_{j}^{reco}/E_{j}^{gen}) / Mean_{90}(E_{j}^{reco}/E_{j}^{gen}) vs |cos#theta|", nRegionBins, pRegionBinEdges);
  h_100_CT_wO_380_DR06_E_RMS90_summary_histogram ->SetYTitle("RMS_{90}(E_{j}^{reco}/E_{j}^{gen}) / Mean_{90}(E_{j}^{reco}/E_{j}^{gen}) [%]");
  h_100_CT_wO_380_DR06_E_RMS90_summary_histogram->SetXTitle("|cos#theta|");
  h_100_CT_wO_380_DR06_E_RMS90_summary_histogram->SetLineWidth(2);
  h_100_CT_wO_380_DR06_E_RMS90_summary_histogram->SetLineColor(kRed);
  h_100_CT_wO_380_DR06_E_RMS90_summary_histogram->SetLineStyle(2);

  TH1F* h_100_CT_wO_380_DR06_E_RMS_summary_histogram=new TH1F("JER_RMSVsCosTheta_CT_wO_380_DR06_100", "RMS(E_{j}) / Mean(E_{j}) vs |cos#theta|", nRegionBins, pRegionBinEdges);
  h_100_CT_wO_380_DR06_E_RMS_summary_histogram ->SetYTitle("RMS(E_{j}) / Mean(E_{j}) [%]");
  h_100_CT_wO_380_DR06_E_RMS_summary_histogram->SetXTitle("|cos#theta|");
  h_100_CT_wO_380_DR06_E_RMS_summary_histogram->SetLineWidth(2);
  h_100_CT_wO_380_DR06_E_RMS_summary_histogram->SetLineColor(kRed);
  h_100_CT_wO_380_DR06_E_RMS_summary_histogram->SetLineStyle(2);

  TH1F* h_100_CT_wO_380_DR06_E_JER_Mean_summary_histogram=new TH1F("JER_MeanVsCosTheta_CT_wO_380_DR06_100", "Mean(E_{tot}^{RECO}/E_{tot}^{true}) vs |cos#theta|", nRegionBins, pRegionBinEdges);
  h_100_CT_wO_380_DR06_E_JER_Mean_summary_histogram->SetYTitle("Mean(E_{tot}^{RECO}/E_{tot}^{true})");
  h_100_CT_wO_380_DR06_E_JER_Mean_summary_histogram->SetXTitle("|cos#theta|");
  h_100_CT_wO_380_DR06_E_JER_Mean_summary_histogram->SetLineWidth(2);
  h_100_CT_wO_380_DR06_E_JER_Mean_summary_histogram->SetLineColor(kRed);
  h_100_CT_wO_380_DR06_E_JER_Mean_summary_histogram->SetLineStyle(2);
  firstbin=72;
  for(int i=firstbin;i<(firstbin+13);i++){
    resolutionTH1=0; 
    resolutionErrorTH1=0;
    meanTH1=0;
    meanErrorTH1=0;
    CalculatePerformance( hist_vec_100_CT_wO_380[i], resolutionTH1, resolutionErrorTH1,meanTH1,meanErrorTH1);
    h_100_CT_wO_380_DR06_E_RMS90_summary_histogram->SetBinContent(i-firstbin+1,resolutionTH1/sqrt(2.));
    h_100_CT_wO_380_DR06_E_RMS90_summary_histogram ->SetBinError(i-firstbin+1, resolutionErrorTH1/sqrt(2.));
    h_100_CT_wO_380_DR06_E_RMS_summary_histogram->SetBinContent(i-firstbin+1,hist_vec_100_CT_wO_380[i]->GetRMS()*100. );
    h_100_CT_wO_380_DR06_E_RMS_summary_histogram ->SetBinError(i-firstbin+1, hist_vec_100_CT_wO_380[i]->GetRMSError()*100.);
    h_100_CT_wO_380_DR06_E_JER_Mean_summary_histogram->SetBinContent(i-firstbin+1,hist_vec_100_CT_wO_380[i]->GetMean());
    h_100_CT_wO_380_DR06_E_JER_Mean_summary_histogram->SetBinError(i-firstbin+1,hist_vec_100_CT_wO_380[i]->GetMeanError());
    //double sided crystal ball
    TF1* fit_gaus_tmp = new TF1("fit_gaus_tmp", "gaus",0.50,1.50);
    hist_vec_100_CT_wO_380[i]->Fit("fit_gaus_tmp","R");
    hist_vec_100_CT_wO_380[i]->GetFunction("fit_gaus_tmp");

    TF1* fdscb_tmp = new TF1("fdscb_tmp",fnc_dscb,0.,3.,7);
   fdscb_tmp->SetNpx(1000);
    fdscb_tmp->SetParameter(0,fit_gaus_tmp->GetParameter(0));
    //norm
    fdscb_tmp->SetParLimits (0,0.5*fit_gaus_tmp->GetParameter(0),1.5*fit_gaus_tmp->GetParameter(0));
    fdscb_tmp->SetParameter(1,fit_gaus_tmp->GetParameter(1));
    //gaussian mean
    fdscb_tmp->SetParLimits (1,0.8,1.2);
    //fdscb_tmp->SetParameter(2,fit_gaus_tmp->GetParameter(2));
    //fdscb_tmp->SetParLimits(2,fit_gaus_tmp->GetParameter(2)*0.50,1.50*fit_gaus_tmp->GetParameter(2));
    std::vector<float>sigma2SFit=sigmaGaussianFits2Sigma(hist_vec_100_CT_wO_380[i]);
    fdscb_tmp->SetParameter(2,sigma2SFit[0]);
    fdscb_tmp->SetParLimits(2,sigma2SFit[0]*0.50,1.50*sigma2SFit[0]);
    //-a1: parameter, from when the gaussian core should count
    fdscb_tmp->SetParameter(2,fit_gaus_tmp->GetParameter(2));
    fdscb_tmp->SetParameter (3,3.0);
    fdscb_tmp->SetParLimits (3,0.0,10.0);
    //a2 parameter, up to when the gaussian core should count
    fdscb_tmp->SetParameter (5,3.0);
    fdscb_tmp->SetParLimits (5,0.0,10.0);
    fdscb_tmp->SetParameter(4,5.);
    fdscb_tmp->SetParLimits(4,0.,25.);
    fdscb_tmp->SetParameter(6,5.);
    fdscb_tmp->SetParLimits(6,0.,25.);
    int fitstatus(0); 
    fitstatus = hist_vec_100_CT_wO_380[i]->Fit(fdscb_tmp,"R");
    fdscb_tmp = hist_vec_100_CT_wO_380[i]->GetFunction("fdscb_tmp");
    h_100_CT_wO_380_DR06_E_SigmaCB_summary_histogram->SetBinContent(i-firstbin+1,fdscb_tmp->GetParameter(2)*100. );
    h_100_CT_wO_380_DR06_E_SigmaCB_summary_histogram->SetBinError(i-firstbin+1,fdscb_tmp->GetParError(2)*100. );
  }  
  TH1F* h_100_CT_wO_380_DR07_E_SigmaCB_summary_histogram=new TH1F("JER_SigmaCBVsCosTheta_CT_wO_380_DR07_100", "RMS_{90}(E_{j}^{reco}/E_{j}^{gen}) / Mean_{90}(E_{j}^{reco}/E_{j}^{gen}) vs |cos#theta|", nRegionBins, pRegionBinEdges);
  h_100_CT_wO_380_DR07_E_SigmaCB_summary_histogram ->SetYTitle("#sigma(E_{j}) / E_{j} [%]");
  h_100_CT_wO_380_DR07_E_SigmaCB_summary_histogram->SetXTitle("|cos#theta|");
  h_100_CT_wO_380_DR07_E_SigmaCB_summary_histogram->SetLineWidth(2);
  h_100_CT_wO_380_DR07_E_SigmaCB_summary_histogram->SetLineColor(kOrange);
  h_100_CT_wO_380_DR07_E_SigmaCB_summary_histogram->SetLineStyle(2);
  TH1F* h_100_CT_wO_380_DR07_E_RMS90_summary_histogram=new TH1F("JER_RMS90VsCosTheta_CT_wO_380_DR07_100", "RMS_{90}(E_{j}^{reco}/E_{j}^{gen}) / Mean_{90}(E_{j}^{reco}/E_{j}^{gen}) vs |cos#theta|", nRegionBins, pRegionBinEdges);
  h_100_CT_wO_380_DR07_E_RMS90_summary_histogram ->SetYTitle("RMS_{90}(E_{j}^{reco}/E_{j}^{gen}) / Mean_{90}(E_{j}^{reco}/E_{j}^{gen}) [%]");
  h_100_CT_wO_380_DR07_E_RMS90_summary_histogram->SetXTitle("|cos#theta|");
  h_100_CT_wO_380_DR07_E_RMS90_summary_histogram->SetLineWidth(2);
  h_100_CT_wO_380_DR07_E_RMS90_summary_histogram->SetLineColor(kRed);
  h_100_CT_wO_380_DR07_E_RMS90_summary_histogram->SetLineStyle(2);

  TH1F* h_100_CT_wO_380_DR07_E_RMS_summary_histogram=new TH1F("JER_RMSVsCosTheta_CT_wO_380_DR07_100", "RMS(E_{j}) / Mean(E_{j}) vs |cos#theta|", nRegionBins, pRegionBinEdges);
  h_100_CT_wO_380_DR07_E_RMS_summary_histogram ->SetYTitle("RMS(E_{j}) / Mean(E_{j}) [%]");
  h_100_CT_wO_380_DR07_E_RMS_summary_histogram->SetXTitle("|cos#theta|");
  h_100_CT_wO_380_DR07_E_RMS_summary_histogram->SetLineWidth(2);
  h_100_CT_wO_380_DR07_E_RMS_summary_histogram->SetLineColor(kRed);
  h_100_CT_wO_380_DR07_E_RMS_summary_histogram->SetLineStyle(2);

  TH1F* h_100_CT_wO_380_DR07_E_JER_Mean_summary_histogram=new TH1F("JER_MeanVsCosTheta_CT_wO_380_DR07_100", "Mean(E_{tot}^{RECO}/E_{tot}^{true}) vs |cos#theta|", nRegionBins, pRegionBinEdges);
  h_100_CT_wO_380_DR07_E_JER_Mean_summary_histogram->SetYTitle("Mean(E_{tot}^{RECO}/E_{tot}^{true})");
  h_100_CT_wO_380_DR07_E_JER_Mean_summary_histogram->SetXTitle("|cos#theta|");
  h_100_CT_wO_380_DR07_E_JER_Mean_summary_histogram->SetLineWidth(2);
  h_100_CT_wO_380_DR07_E_JER_Mean_summary_histogram->SetLineColor(kRed);
  h_100_CT_wO_380_DR07_E_JER_Mean_summary_histogram->SetLineStyle(2);
  firstbin=85;
  for(int i=firstbin;i<(firstbin+13);i++){
    resolutionTH1=0; 
    resolutionErrorTH1=0;
    meanTH1=0;
    meanErrorTH1=0;
    CalculatePerformance( hist_vec_100_CT_wO_380[i], resolutionTH1, resolutionErrorTH1,meanTH1,meanErrorTH1);
    h_100_CT_wO_380_DR07_E_RMS90_summary_histogram->SetBinContent(i-firstbin+1,resolutionTH1/sqrt(2.));
    h_100_CT_wO_380_DR07_E_RMS90_summary_histogram ->SetBinError(i-firstbin+1, resolutionErrorTH1/sqrt(2.));
    h_100_CT_wO_380_DR07_E_RMS_summary_histogram->SetBinContent(i-firstbin+1,hist_vec_100_CT_wO_380[i]->GetRMS()*100. );
    h_100_CT_wO_380_DR07_E_RMS_summary_histogram ->SetBinError(i-firstbin+1, hist_vec_100_CT_wO_380[i]->GetRMSError()*100.);
    h_100_CT_wO_380_DR07_E_JER_Mean_summary_histogram->SetBinContent(i-firstbin+1,hist_vec_100_CT_wO_380[i]->GetMean());
    h_100_CT_wO_380_DR07_E_JER_Mean_summary_histogram->SetBinError(i-firstbin+1,hist_vec_100_CT_wO_380[i]->GetMeanError());
    //double sided crystal ball
    TF1* fit_gaus_tmp = new TF1("fit_gaus_tmp", "gaus",0.50,1.50);
    hist_vec_100_CT_wO_380[i]->Fit("fit_gaus_tmp","R");
    hist_vec_100_CT_wO_380[i]->GetFunction("fit_gaus_tmp");

    TF1* fdscb_tmp = new TF1("fdscb_tmp",fnc_dscb,0.,3.,7);
   fdscb_tmp->SetNpx(1000);
    fdscb_tmp->SetParameter(0,fit_gaus_tmp->GetParameter(0));
    //norm
    fdscb_tmp->SetParLimits (0,0.5*fit_gaus_tmp->GetParameter(0),1.5*fit_gaus_tmp->GetParameter(0));
    fdscb_tmp->SetParameter(1,fit_gaus_tmp->GetParameter(1));
    //gaussian mean
    fdscb_tmp->SetParLimits (1,0.8,1.2);
    //fdscb_tmp->SetParameter(2,fit_gaus_tmp->GetParameter(2));
    //fdscb_tmp->SetParLimits(2,fit_gaus_tmp->GetParameter(2)*0.50,1.50*fit_gaus_tmp->GetParameter(2));
    std::vector<float>sigma2SFit=sigmaGaussianFits2Sigma(hist_vec_100_CT_wO_380[i]);
    fdscb_tmp->SetParameter(2,sigma2SFit[0]);
    fdscb_tmp->SetParLimits(2,sigma2SFit[0]*0.50,1.50*sigma2SFit[0]);
    //-a1: parameter, from when the gaussian core should count
    fdscb_tmp->SetParameter(2,fit_gaus_tmp->GetParameter(2));
    fdscb_tmp->SetParameter (3,3.0);
    fdscb_tmp->SetParLimits (3,0.0,10.0);
    //a2 parameter, up to when the gaussian core should count
    fdscb_tmp->SetParameter (5,3.0);
    fdscb_tmp->SetParLimits (5,0.0,10.0);
    fdscb_tmp->SetParameter(4,5.);
    fdscb_tmp->SetParLimits(4,0.,25.);
    fdscb_tmp->SetParameter(6,5.);
    fdscb_tmp->SetParLimits(6,0.,25.);
    int fitstatus(0); 
    fitstatus = hist_vec_100_CT_wO_380[i]->Fit(fdscb_tmp,"R");
    fdscb_tmp = hist_vec_100_CT_wO_380[i]->GetFunction("fdscb_tmp");
    h_100_CT_wO_380_DR07_E_SigmaCB_summary_histogram->SetBinContent(i-firstbin+1,fdscb_tmp->GetParameter(2)*100. );
    h_100_CT_wO_380_DR07_E_SigmaCB_summary_histogram->SetBinError(i-firstbin+1,fdscb_tmp->GetParError(2)*100. );
  }  

  TH1F* h_100_CT_wO_380_DR08_E_SigmaCB_summary_histogram=new TH1F("JER_SigmaCBVsCosTheta_CT_wO_380_DR08_100", "RMS_{90}(E_{j}^{reco}/E_{j}^{gen}) / Mean_{90}(E_{j}^{reco}/E_{j}^{gen}) vs |cos#theta|", nRegionBins, pRegionBinEdges);
  h_100_CT_wO_380_DR08_E_SigmaCB_summary_histogram ->SetYTitle("#sigma(E_{j}) / E_{j} [%]");
  h_100_CT_wO_380_DR08_E_SigmaCB_summary_histogram->SetXTitle("|cos#theta|");
  h_100_CT_wO_380_DR08_E_SigmaCB_summary_histogram->SetLineWidth(2);
  h_100_CT_wO_380_DR08_E_SigmaCB_summary_histogram->SetLineColor(kOrange);
  h_100_CT_wO_380_DR08_E_SigmaCB_summary_histogram->SetLineStyle(2);
  TH1F* h_100_CT_wO_380_DR08_E_RMS90_summary_histogram=new TH1F("JER_RMS90VsCosTheta_CT_wO_380_DR08_100", "RMS_{90}(E_{j}^{reco}/E_{j}^{gen}) / Mean_{90}(E_{j}^{reco}/E_{j}^{gen}) vs |cos#theta|", nRegionBins, pRegionBinEdges);
  h_100_CT_wO_380_DR08_E_RMS90_summary_histogram ->SetYTitle("RMS_{90}(E_{j}^{reco}/E_{j}^{gen}) / Mean_{90}(E_{j}^{reco}/E_{j}^{gen}) [%]");
  h_100_CT_wO_380_DR08_E_RMS90_summary_histogram->SetXTitle("|cos#theta|");
  h_100_CT_wO_380_DR08_E_RMS90_summary_histogram->SetLineWidth(2);
  h_100_CT_wO_380_DR08_E_RMS90_summary_histogram->SetLineColor(kRed);
  h_100_CT_wO_380_DR08_E_RMS90_summary_histogram->SetLineStyle(2);

  TH1F* h_100_CT_wO_380_DR08_E_RMS_summary_histogram=new TH1F("JER_RMSVsCosTheta_CT_wO_380_DR08_100", "RMS(E_{j}) / Mean(E_{j}) vs |cos#theta|", nRegionBins, pRegionBinEdges);
  h_100_CT_wO_380_DR08_E_RMS_summary_histogram ->SetYTitle("RMS(E_{j}) / Mean(E_{j}) [%]");
  h_100_CT_wO_380_DR08_E_RMS_summary_histogram->SetXTitle("|cos#theta|");
  h_100_CT_wO_380_DR08_E_RMS_summary_histogram->SetLineWidth(2);
  h_100_CT_wO_380_DR08_E_RMS_summary_histogram->SetLineColor(kRed);
  h_100_CT_wO_380_DR08_E_RMS_summary_histogram->SetLineStyle(2);

  TH1F* h_100_CT_wO_380_DR08_E_JER_Mean_summary_histogram=new TH1F("JER_MeanVsCosTheta_CT_wO_380_DR08_100", "Mean(E_{tot}^{RECO}/E_{tot}^{true}) vs |cos#theta|", nRegionBins, pRegionBinEdges);
  h_100_CT_wO_380_DR08_E_JER_Mean_summary_histogram->SetYTitle("Mean(E_{tot}^{RECO}/E_{tot}^{true})");
  h_100_CT_wO_380_DR08_E_JER_Mean_summary_histogram->SetXTitle("|cos#theta|");
  h_100_CT_wO_380_DR08_E_JER_Mean_summary_histogram->SetLineWidth(2);
  h_100_CT_wO_380_DR08_E_JER_Mean_summary_histogram->SetLineColor(kRed);
  h_100_CT_wO_380_DR08_E_JER_Mean_summary_histogram->SetLineStyle(2);
  firstbin=98;
  for(int i=firstbin;i<(firstbin+13);i++){
    resolutionTH1=0; 
    resolutionErrorTH1=0;
    meanTH1=0;
    meanErrorTH1=0;
    CalculatePerformance( hist_vec_100_CT_wO_380[i], resolutionTH1, resolutionErrorTH1,meanTH1,meanErrorTH1);
    h_100_CT_wO_380_DR08_E_RMS90_summary_histogram->SetBinContent(i-firstbin+1,resolutionTH1/sqrt(2.));
    h_100_CT_wO_380_DR08_E_RMS90_summary_histogram ->SetBinError(i-firstbin+1, resolutionErrorTH1/sqrt(2.));
    h_100_CT_wO_380_DR08_E_RMS_summary_histogram->SetBinContent(i-firstbin+1,hist_vec_100_CT_wO_380[i]->GetRMS()*100. );
    h_100_CT_wO_380_DR08_E_RMS_summary_histogram ->SetBinError(i-firstbin+1, hist_vec_100_CT_wO_380[i]->GetRMSError()*100.);
    h_100_CT_wO_380_DR08_E_JER_Mean_summary_histogram->SetBinContent(i-firstbin+1,hist_vec_100_CT_wO_380[i]->GetMean());
    h_100_CT_wO_380_DR08_E_JER_Mean_summary_histogram->SetBinError(i-firstbin+1,hist_vec_100_CT_wO_380[i]->GetMeanError());
    //double sided crystal ball
    TF1* fit_gaus_tmp = new TF1("fit_gaus_tmp", "gaus",0.50,1.50);
    hist_vec_100_CT_wO_380[i]->Fit("fit_gaus_tmp","R");
    hist_vec_100_CT_wO_380[i]->GetFunction("fit_gaus_tmp");

    TF1* fdscb_tmp = new TF1("fdscb_tmp",fnc_dscb,0.,3.,7);
   fdscb_tmp->SetNpx(1000);
    fdscb_tmp->SetParameter(0,fit_gaus_tmp->GetParameter(0));
    //norm
    fdscb_tmp->SetParLimits (0,0.5*fit_gaus_tmp->GetParameter(0),1.5*fit_gaus_tmp->GetParameter(0));
    fdscb_tmp->SetParameter(1,fit_gaus_tmp->GetParameter(1));
    //gaussian mean
    fdscb_tmp->SetParLimits (1,0.8,1.2);
    //fdscb_tmp->SetParameter(2,fit_gaus_tmp->GetParameter(2));
    //fdscb_tmp->SetParLimits(2,fit_gaus_tmp->GetParameter(2)*0.50,1.50*fit_gaus_tmp->GetParameter(2));
    std::vector<float>sigma2SFit=sigmaGaussianFits2Sigma(hist_vec_100_CT_wO_380[i]);
    fdscb_tmp->SetParameter(2,sigma2SFit[0]);
    fdscb_tmp->SetParLimits(2,sigma2SFit[0]*0.50,1.50*sigma2SFit[0]);
    //-a1: parameter, from when the gaussian core should count
    fdscb_tmp->SetParameter(2,fit_gaus_tmp->GetParameter(2));
    fdscb_tmp->SetParameter (3,3.0);
    fdscb_tmp->SetParLimits (3,0.0,10.0);
    //a2 parameter, up to when the gaussian core should count
    fdscb_tmp->SetParameter (5,3.0);
    fdscb_tmp->SetParLimits (5,0.0,10.0);
    fdscb_tmp->SetParameter(4,5.);
    fdscb_tmp->SetParLimits(4,0.,25.);
    fdscb_tmp->SetParameter(6,5.);
    fdscb_tmp->SetParLimits(6,0.,25.);
    int fitstatus(0); 
    fitstatus = hist_vec_100_CT_wO_380[i]->Fit(fdscb_tmp,"R");
    fdscb_tmp = hist_vec_100_CT_wO_380[i]->GetFunction("fdscb_tmp");
    h_100_CT_wO_380_DR08_E_SigmaCB_summary_histogram->SetBinContent(i-firstbin+1,fdscb_tmp->GetParameter(2)*100. );
    h_100_CT_wO_380_DR08_E_SigmaCB_summary_histogram->SetBinError(i-firstbin+1,fdscb_tmp->GetParError(2)*100. );
  }  
  TH1F* h_100_CT_wO_380_DR09_E_SigmaCB_summary_histogram=new TH1F("JER_SigmaCBVsCosTheta_CT_wO_380_DR09_100", "RMS_{90}(E_{j}^{reco}/E_{j}^{gen}) / Mean_{90}(E_{j}^{reco}/E_{j}^{gen}) vs |cos#theta|", nRegionBins, pRegionBinEdges);
  h_100_CT_wO_380_DR09_E_SigmaCB_summary_histogram ->SetYTitle("#sigma(E_{j}) / E_{j} [%]");
  h_100_CT_wO_380_DR09_E_SigmaCB_summary_histogram->SetXTitle("|cos#theta|");
  h_100_CT_wO_380_DR09_E_SigmaCB_summary_histogram->SetLineWidth(2);
  h_100_CT_wO_380_DR09_E_SigmaCB_summary_histogram->SetLineColor(kOrange);
  h_100_CT_wO_380_DR09_E_SigmaCB_summary_histogram->SetLineStyle(2);
  TH1F* h_100_CT_wO_380_DR09_E_RMS90_summary_histogram=new TH1F("JER_RMS90VsCosTheta_CT_wO_380_DR09_100", "RMS_{90}(E_{j}^{reco}/E_{j}^{gen}) / Mean_{90}(E_{j}^{reco}/E_{j}^{gen}) vs |cos#theta|", nRegionBins, pRegionBinEdges);
  h_100_CT_wO_380_DR09_E_RMS90_summary_histogram ->SetYTitle("RMS_{90}(E_{j}^{reco}/E_{j}^{gen}) / Mean_{90}(E_{j}^{reco}/E_{j}^{gen}) [%]");
  h_100_CT_wO_380_DR09_E_RMS90_summary_histogram->SetXTitle("|cos#theta|");
  h_100_CT_wO_380_DR09_E_RMS90_summary_histogram->SetLineWidth(2);
  h_100_CT_wO_380_DR09_E_RMS90_summary_histogram->SetLineColor(kRed);
  h_100_CT_wO_380_DR09_E_RMS90_summary_histogram->SetLineStyle(2);

  TH1F* h_100_CT_wO_380_DR09_E_RMS_summary_histogram=new TH1F("JER_RMSVsCosTheta_CT_wO_380_DR09_100", "RMS(E_{j}) / Mean(E_{j}) vs |cos#theta|", nRegionBins, pRegionBinEdges);
  h_100_CT_wO_380_DR09_E_RMS_summary_histogram ->SetYTitle("RMS(E_{j}) / Mean(E_{j}) [%]");
  h_100_CT_wO_380_DR09_E_RMS_summary_histogram->SetXTitle("|cos#theta|");
  h_100_CT_wO_380_DR09_E_RMS_summary_histogram->SetLineWidth(2);
  h_100_CT_wO_380_DR09_E_RMS_summary_histogram->SetLineColor(kRed);
  h_100_CT_wO_380_DR09_E_RMS_summary_histogram->SetLineStyle(2);

  TH1F* h_100_CT_wO_380_DR09_E_JER_Mean_summary_histogram=new TH1F("JER_MeanVsCosTheta_CT_wO_380_DR09_100", "Mean(E_{tot}^{RECO}/E_{tot}^{true}) vs |cos#theta|", nRegionBins, pRegionBinEdges);
  h_100_CT_wO_380_DR09_E_JER_Mean_summary_histogram->SetYTitle("Mean(E_{tot}^{RECO}/E_{tot}^{true})");
  h_100_CT_wO_380_DR09_E_JER_Mean_summary_histogram->SetXTitle("|cos#theta|");
  h_100_CT_wO_380_DR09_E_JER_Mean_summary_histogram->SetLineWidth(2);
  h_100_CT_wO_380_DR09_E_JER_Mean_summary_histogram->SetLineColor(kRed);
  h_100_CT_wO_380_DR09_E_JER_Mean_summary_histogram->SetLineStyle(2);
  firstbin=111;
  for(int i=firstbin;i<(firstbin+13);i++){
    resolutionTH1=0; 
    resolutionErrorTH1=0;
    meanTH1=0;
    meanErrorTH1=0;
    CalculatePerformance( hist_vec_100_CT_wO_380[i], resolutionTH1, resolutionErrorTH1,meanTH1,meanErrorTH1);
    h_100_CT_wO_380_DR09_E_RMS90_summary_histogram->SetBinContent(i-firstbin+1,resolutionTH1/sqrt(2.));
    h_100_CT_wO_380_DR09_E_RMS90_summary_histogram ->SetBinError(i-firstbin+1, resolutionErrorTH1/sqrt(2.));
    h_100_CT_wO_380_DR09_E_RMS_summary_histogram->SetBinContent(i-firstbin+1,hist_vec_100_CT_wO_380[i]->GetRMS()*100. );
    h_100_CT_wO_380_DR09_E_RMS_summary_histogram ->SetBinError(i-firstbin+1, hist_vec_100_CT_wO_380[i]->GetRMSError()*100.);
    h_100_CT_wO_380_DR09_E_JER_Mean_summary_histogram->SetBinContent(i-firstbin+1,hist_vec_100_CT_wO_380[i]->GetMean());
    h_100_CT_wO_380_DR09_E_JER_Mean_summary_histogram->SetBinError(i-firstbin+1,hist_vec_100_CT_wO_380[i]->GetMeanError());
    //double sided crystal ball
    TF1* fit_gaus_tmp = new TF1("fit_gaus_tmp", "gaus",0.50,1.50);
    hist_vec_100_CT_wO_380[i]->Fit("fit_gaus_tmp","R");
    hist_vec_100_CT_wO_380[i]->GetFunction("fit_gaus_tmp");

    TF1* fdscb_tmp = new TF1("fdscb_tmp",fnc_dscb,0.,3.,7);
   fdscb_tmp->SetNpx(1000);
    fdscb_tmp->SetParameter(0,fit_gaus_tmp->GetParameter(0));
    //norm
    fdscb_tmp->SetParLimits (0,0.5*fit_gaus_tmp->GetParameter(0),1.5*fit_gaus_tmp->GetParameter(0));
    fdscb_tmp->SetParameter(1,fit_gaus_tmp->GetParameter(1));
    //gaussian mean
    fdscb_tmp->SetParLimits (1,0.8,1.2);
    //fdscb_tmp->SetParameter(2,fit_gaus_tmp->GetParameter(2));
    //fdscb_tmp->SetParLimits(2,fit_gaus_tmp->GetParameter(2)*0.50,1.50*fit_gaus_tmp->GetParameter(2));
    std::vector<float>sigma2SFit=sigmaGaussianFits2Sigma(hist_vec_100_CT_wO_380[i]);
    fdscb_tmp->SetParameter(2,sigma2SFit[0]);
    fdscb_tmp->SetParLimits(2,sigma2SFit[0]*0.50,1.50*sigma2SFit[0]);
    //-a1: parameter, from when the gaussian core should count
    fdscb_tmp->SetParameter(2,fit_gaus_tmp->GetParameter(2));
    fdscb_tmp->SetParameter (3,3.0);
    fdscb_tmp->SetParLimits (3,0.0,10.0);
    //a2 parameter, up to when the gaussian core should count
    fdscb_tmp->SetParameter (5,3.0);
    fdscb_tmp->SetParLimits (5,0.0,10.0);
    fdscb_tmp->SetParameter(4,5.);
    fdscb_tmp->SetParLimits(4,0.,25.);
    fdscb_tmp->SetParameter(6,5.);
    fdscb_tmp->SetParLimits(6,0.,25.);
    int fitstatus(0); 
    fitstatus = hist_vec_100_CT_wO_380[i]->Fit(fdscb_tmp,"R");
    fdscb_tmp = hist_vec_100_CT_wO_380[i]->GetFunction("fdscb_tmp");
    h_100_CT_wO_380_DR09_E_SigmaCB_summary_histogram->SetBinContent(i-firstbin+1,fdscb_tmp->GetParameter(2)*100. );
    h_100_CT_wO_380_DR09_E_SigmaCB_summary_histogram->SetBinError(i-firstbin+1,fdscb_tmp->GetParError(2)*100. );
  }  
  TH1F* h_100_CT_wO_380_DR10_E_SigmaCB_summary_histogram=new TH1F("JER_SigmaCBVsCosTheta_CT_wO_380_DR10_100", "RMS_{90}(E_{j}^{reco}/E_{j}^{gen}) / Mean_{90}(E_{j}^{reco}/E_{j}^{gen}) vs |cos#theta|", nRegionBins, pRegionBinEdges);
  h_100_CT_wO_380_DR10_E_SigmaCB_summary_histogram ->SetYTitle("#sigma(E_{j}) / E_{j} [%]");
  h_100_CT_wO_380_DR10_E_SigmaCB_summary_histogram->SetXTitle("|cos#theta|");
  h_100_CT_wO_380_DR10_E_SigmaCB_summary_histogram->SetLineWidth(2);
  h_100_CT_wO_380_DR10_E_SigmaCB_summary_histogram->SetLineColor(kOrange);
  h_100_CT_wO_380_DR10_E_SigmaCB_summary_histogram->SetLineStyle(2);
  TH1F* h_100_CT_wO_380_DR10_E_RMS90_summary_histogram=new TH1F("JER_RMS90VsCosTheta_CT_wO_380_DR10_100", "RMS_{90}(E_{j}^{reco}/E_{j}^{gen}) / Mean_{90}(E_{j}^{reco}/E_{j}^{gen}) vs |cos#theta|", nRegionBins, pRegionBinEdges);
  h_100_CT_wO_380_DR10_E_RMS90_summary_histogram ->SetYTitle("RMS_{90}(E_{j}^{reco}/E_{j}^{gen}) / Mean_{90}(E_{j}^{reco}/E_{j}^{gen}) [%]");
  h_100_CT_wO_380_DR10_E_RMS90_summary_histogram->SetXTitle("|cos#theta|");
  h_100_CT_wO_380_DR10_E_RMS90_summary_histogram->SetLineWidth(2);
  h_100_CT_wO_380_DR10_E_RMS90_summary_histogram->SetLineColor(kRed);
  h_100_CT_wO_380_DR10_E_RMS90_summary_histogram->SetLineStyle(2);

  TH1F* h_100_CT_wO_380_DR10_E_RMS_summary_histogram=new TH1F("JER_RMSVsCosTheta_CT_wO_380_DR10_100", "RMS(E_{j}) / Mean(E_{j}) vs |cos#theta|", nRegionBins, pRegionBinEdges);
  h_100_CT_wO_380_DR10_E_RMS_summary_histogram ->SetYTitle("RMS(E_{j}) / Mean(E_{j}) [%]");
  h_100_CT_wO_380_DR10_E_RMS_summary_histogram->SetXTitle("|cos#theta|");
  h_100_CT_wO_380_DR10_E_RMS_summary_histogram->SetLineWidth(2);
  h_100_CT_wO_380_DR10_E_RMS_summary_histogram->SetLineColor(kRed);
  h_100_CT_wO_380_DR10_E_RMS_summary_histogram->SetLineStyle(2);

  TH1F* h_100_CT_wO_380_DR10_E_JER_Mean_summary_histogram=new TH1F("JER_MeanVsCosTheta_CT_wO_380_DR10_100", "Mean(E_{tot}^{RECO}/E_{tot}^{true}) vs |cos#theta|", nRegionBins, pRegionBinEdges);
  h_100_CT_wO_380_DR10_E_JER_Mean_summary_histogram->SetYTitle("Mean(E_{tot}^{RECO}/E_{tot}^{true})");
  h_100_CT_wO_380_DR10_E_JER_Mean_summary_histogram->SetXTitle("|cos#theta|");
  h_100_CT_wO_380_DR10_E_JER_Mean_summary_histogram->SetLineWidth(2);
  h_100_CT_wO_380_DR10_E_JER_Mean_summary_histogram->SetLineColor(kRed);
  h_100_CT_wO_380_DR10_E_JER_Mean_summary_histogram->SetLineStyle(2);
  firstbin=124;
  for(int i=firstbin;i<(firstbin+13);i++){
    resolutionTH1=0; 
    resolutionErrorTH1=0;
    meanTH1=0;
    meanErrorTH1=0;
    CalculatePerformance( hist_vec_100_CT_wO_380[i], resolutionTH1, resolutionErrorTH1,meanTH1,meanErrorTH1);
    h_100_CT_wO_380_DR10_E_RMS90_summary_histogram->SetBinContent(i-firstbin+1,resolutionTH1/sqrt(2.));
    h_100_CT_wO_380_DR10_E_RMS90_summary_histogram ->SetBinError(i-firstbin+1, resolutionErrorTH1/sqrt(2.));
    h_100_CT_wO_380_DR10_E_RMS_summary_histogram->SetBinContent(i-firstbin+1,hist_vec_100_CT_wO_380[i]->GetRMS()*100. );
    h_100_CT_wO_380_DR10_E_RMS_summary_histogram ->SetBinError(i-firstbin+1, hist_vec_100_CT_wO_380[i]->GetRMSError()*100.);
    h_100_CT_wO_380_DR10_E_JER_Mean_summary_histogram->SetBinContent(i-firstbin+1,hist_vec_100_CT_wO_380[i]->GetMean());
    h_100_CT_wO_380_DR10_E_JER_Mean_summary_histogram->SetBinError(i-firstbin+1,hist_vec_100_CT_wO_380[i]->GetMeanError());
    //double sided crystal ball
    TF1* fit_gaus_tmp = new TF1("fit_gaus_tmp", "gaus",0.50,1.50);
    hist_vec_100_CT_wO_380[i]->Fit("fit_gaus_tmp","R");
    hist_vec_100_CT_wO_380[i]->GetFunction("fit_gaus_tmp");

    TF1* fdscb_tmp = new TF1("fdscb_tmp",fnc_dscb,0.,3.,7);
   fdscb_tmp->SetNpx(1000);
    fdscb_tmp->SetParameter(0,fit_gaus_tmp->GetParameter(0));
    //norm
    fdscb_tmp->SetParLimits (0,0.5*fit_gaus_tmp->GetParameter(0),1.5*fit_gaus_tmp->GetParameter(0));
    fdscb_tmp->SetParameter(1,fit_gaus_tmp->GetParameter(1));
    //gaussian mean
    fdscb_tmp->SetParLimits (1,0.8,1.2);
    //fdscb_tmp->SetParameter(2,fit_gaus_tmp->GetParameter(2));
    //fdscb_tmp->SetParLimits(2,fit_gaus_tmp->GetParameter(2)*0.50,1.50*fit_gaus_tmp->GetParameter(2));
    std::vector<float>sigma2SFit=sigmaGaussianFits2Sigma(hist_vec_100_CT_wO_380[i]);
    fdscb_tmp->SetParameter(2,sigma2SFit[0]);
    fdscb_tmp->SetParLimits(2,sigma2SFit[0]*0.50,1.50*sigma2SFit[0]);
    //-a1: parameter, from when the gaussian core should count
    fdscb_tmp->SetParameter(2,fit_gaus_tmp->GetParameter(2));
    fdscb_tmp->SetParameter (3,3.0);
    fdscb_tmp->SetParLimits (3,0.0,10.0);
    //a2 parameter, up to when the gaussian core should count
    fdscb_tmp->SetParameter (5,3.0);
    fdscb_tmp->SetParLimits (5,0.0,10.0);
    fdscb_tmp->SetParameter(4,5.);
    fdscb_tmp->SetParLimits(4,0.,25.);
    fdscb_tmp->SetParameter(6,5.);
    fdscb_tmp->SetParLimits(6,0.,25.);
    int fitstatus(0); 
    fitstatus = hist_vec_100_CT_wO_380[i]->Fit(fdscb_tmp,"R");
    fdscb_tmp = hist_vec_100_CT_wO_380[i]->GetFunction("fdscb_tmp");
    h_100_CT_wO_380_DR10_E_SigmaCB_summary_histogram->SetBinContent(i-firstbin+1,fdscb_tmp->GetParameter(2)*100. );
    h_100_CT_wO_380_DR10_E_SigmaCB_summary_histogram->SetBinError(i-firstbin+1,fdscb_tmp->GetParError(2)*100. );
  }  
  std::cout<<"entries 100_CT_phi_DR07/overflow "<<h_100_CT_dphi_gen_reco_DR07->GetEntries()<<"/"<<h_100_CT_dphi_gen_reco_DR07->GetBinContent(h_100_CT_dphi_gen_reco_DR07->GetNbinsX()+1)<<" ratio "<<h_100_CT_dphi_gen_reco_DR07->GetBinContent(h_100_CT_dphi_gen_reco_DR07->GetNbinsX()+1)/h_100_CT_dphi_gen_reco_DR07->GetEntries()<<std::endl;
  std::cout<<"entries 100_CT_wO_phi_DR07/overflow "<<h_100_CT_wO_dphi_gen_reco_DR07->GetEntries()<<"/"<<h_100_CT_wO_dphi_gen_reco_DR07->GetBinContent(h_100_CT_wO_dphi_gen_reco_DR07->GetNbinsX()+1)<<" ratio "<<h_100_CT_wO_dphi_gen_reco_DR07->GetBinContent(h_100_CT_wO_dphi_gen_reco_DR07->GetNbinsX()+1)/h_100_CT_wO_dphi_gen_reco_DR07->GetEntries()<<std::endl;
  std::cout<<"entries 200_CT_phi_DR07/overflow "<<h_200_CT_dphi_gen_reco_DR07->GetEntries()<<"/"<<h_200_CT_dphi_gen_reco_DR07->GetBinContent(h_200_CT_dphi_gen_reco_DR07->GetNbinsX()+1)<<" ratio "<<h_200_CT_dphi_gen_reco_DR07->GetBinContent(h_200_CT_dphi_gen_reco_DR07->GetNbinsX()+1)/h_200_CT_dphi_gen_reco_DR07->GetEntries()<<std::endl;
  std::cout<<"entries 200_CT_wO_phi_DR07/overflow "<<h_200_CT_wO_dphi_gen_reco_DR07->GetEntries()<<"/"<<h_200_CT_wO_dphi_gen_reco_DR07->GetBinContent(h_200_CT_wO_dphi_gen_reco_DR07->GetNbinsX()+1)<<" ratio "<<h_200_CT_wO_dphi_gen_reco_DR07->GetBinContent(h_200_CT_wO_dphi_gen_reco_DR07->GetNbinsX()+1)/h_200_CT_wO_dphi_gen_reco_DR07->GetEntries()<<std::endl;
  std::cout<<"entries 380_CT_phi_DR07/overflow "<<h_380_CT_dphi_gen_reco_DR07->GetEntries()<<"/"<<h_380_CT_dphi_gen_reco_DR07->GetBinContent(h_380_CT_dphi_gen_reco_DR07->GetNbinsX()+1)<<" ratio "<<h_380_CT_dphi_gen_reco_DR07->GetBinContent(h_380_CT_dphi_gen_reco_DR07->GetNbinsX()+1)/h_380_CT_dphi_gen_reco_DR07->GetEntries()<<std::endl;
  std::cout<<"entries 380_CT_wO_phi_DR07/overflow "<<h_380_CT_wO_dphi_gen_reco_DR07->GetEntries()<<"/"<<h_380_CT_wO_dphi_gen_reco_DR07->GetBinContent(h_380_CT_wO_dphi_gen_reco_DR07->GetNbinsX()+1)<<" ratio "<<h_380_CT_wO_dphi_gen_reco_DR07->GetBinContent(h_380_CT_wO_dphi_gen_reco_DR07->GetNbinsX()+1)/h_380_CT_wO_dphi_gen_reco_DR07->GetEntries()<<std::endl;
  std::cout<<"entries 500_CT_phi_DR07/overflow "<<h_500_CT_dphi_gen_reco_DR07->GetEntries()<<"/"<<h_500_CT_dphi_gen_reco_DR07->GetBinContent(h_500_CT_dphi_gen_reco_DR07->GetNbinsX()+1)<<" ratio "<<h_500_CT_dphi_gen_reco_DR07->GetBinContent(h_500_CT_dphi_gen_reco_DR07->GetNbinsX()+1)/h_500_CT_dphi_gen_reco_DR07->GetEntries()<<std::endl;
  std::cout<<"entries 500_CT_wO_phi_DR07/overflow "<<h_500_CT_wO_dphi_gen_reco_DR07->GetEntries()<<"/"<<h_500_CT_wO_dphi_gen_reco_DR07->GetBinContent(h_500_CT_wO_dphi_gen_reco_DR07->GetNbinsX()+1)<<" ratio "<<h_500_CT_wO_dphi_gen_reco_DR07->GetBinContent(h_500_CT_wO_dphi_gen_reco_DR07->GetNbinsX()+1)/h_500_CT_wO_dphi_gen_reco_DR07->GetEntries()<<std::endl;
  std::cout<<"entries 1500_CT_phi_DR07/overflow "<<h_1500_CT_dphi_gen_reco_DR07->GetEntries()<<"/"<<h_1500_CT_dphi_gen_reco_DR07->GetBinContent(h_1500_CT_dphi_gen_reco_DR07->GetNbinsX()+1)<<" ratio "<<h_1500_CT_dphi_gen_reco_DR07->GetBinContent(h_1500_CT_dphi_gen_reco_DR07->GetNbinsX()+1)/h_1500_CT_dphi_gen_reco_DR07->GetEntries()<<std::endl;
  std::cout<<"entries 1500_CT_wO_phi_DR07/overflow "<<h_1500_CT_wO_dphi_gen_reco_DR07->GetEntries()<<"/"<<h_1500_CT_wO_dphi_gen_reco_DR07->GetBinContent(h_1500_CT_wO_dphi_gen_reco_DR07->GetNbinsX()+1)<<" ratio "<<h_1500_CT_wO_dphi_gen_reco_DR07->GetBinContent(h_1500_CT_wO_dphi_gen_reco_DR07->GetNbinsX()+1)/h_1500_CT_wO_dphi_gen_reco_DR07->GetEntries()<<std::endl;
  std::cout<<"entries 3000_CT_phi_DR07/overflow "<<h_3000_CT_dphi_gen_reco_DR07->GetEntries()<<"/"<<h_3000_CT_dphi_gen_reco_DR07->GetBinContent(h_3000_CT_dphi_gen_reco_DR07->GetNbinsX()+1)<<" ratio "<<h_3000_CT_dphi_gen_reco_DR07->GetBinContent(h_3000_CT_dphi_gen_reco_DR07->GetNbinsX()+1)/h_3000_CT_dphi_gen_reco_DR07->GetEntries()<<std::endl;
  std::cout<<"entries 3000_CT_wO_phi_DR07/overflow "<<h_3000_CT_wO_dphi_gen_reco_DR07->GetEntries()<<"/"<<h_3000_CT_wO_dphi_gen_reco_DR07->GetBinContent(h_3000_CT_wO_dphi_gen_reco_DR07->GetNbinsX()+1)<<" ratio "<<h_3000_CT_wO_dphi_gen_reco_DR07->GetBinContent(h_3000_CT_wO_dphi_gen_reco_DR07->GetNbinsX()+1)/h_3000_CT_wO_dphi_gen_reco_DR07->GetEntries()<<std::endl;

  TGraphErrors *gre_DR07_RMS90_JER_0_65_wSC = new TGraphErrors(6);
  gre_DR07_RMS90_JER_0_65_wSC ->SetName("gre_DR07_RMS90_JER_0_65_wSC");
  gre_DR07_RMS90_JER_0_65_wSC ->SetTitle("");
  gre_DR07_RMS90_JER_0_65_wSC ->SetFillColor(1);
  gre_DR07_RMS90_JER_0_65_wSC ->SetLineColor(kBlack);
  gre_DR07_RMS90_JER_0_65_wSC ->SetMarkerColor(kBlack);
  gre_DR07_RMS90_JER_0_65_wSC ->SetMarkerStyle(kFullCircle);

  TGraphErrors *gre_DR07_RMS90_JER_0_65_to_0_80_wSC = new TGraphErrors(6);
  gre_DR07_RMS90_JER_0_65_to_0_80_wSC ->SetName("gre_DR07_RMS90_JER_0_65_to_0_80_wSC");
  gre_DR07_RMS90_JER_0_65_to_0_80_wSC ->SetTitle("");
  gre_DR07_RMS90_JER_0_65_to_0_80_wSC ->SetFillColor(1);
  gre_DR07_RMS90_JER_0_65_to_0_80_wSC ->SetLineColor(kBlack);
  gre_DR07_RMS90_JER_0_65_to_0_80_wSC ->SetMarkerColor(kBlack);
  gre_DR07_RMS90_JER_0_65_to_0_80_wSC ->SetMarkerStyle(kFullCircle);

  TGraphErrors *gre_DR07_RMS90_JER_0_80_to_0_925_wSC = new TGraphErrors(6);
  gre_DR07_RMS90_JER_0_80_to_0_925_wSC ->SetName("gre_DR07_RMS90_JER_0_80_to_0_925_wSC");
  gre_DR07_RMS90_JER_0_80_to_0_925_wSC ->SetTitle("");
  gre_DR07_RMS90_JER_0_80_to_0_925_wSC ->SetFillColor(1);
  gre_DR07_RMS90_JER_0_80_to_0_925_wSC ->SetLineColor(kBlack);
  gre_DR07_RMS90_JER_0_80_to_0_925_wSC ->SetMarkerColor(kBlack);
  gre_DR07_RMS90_JER_0_80_to_0_925_wSC ->SetMarkerStyle(kFullCircle);

  TGraphErrors *gre_DR07_RMS90_JER_0_925_to_1_00_wSC = new TGraphErrors(6);
  gre_DR07_RMS90_JER_0_925_to_1_00_wSC ->SetName("gre_DR07_RMS90_JER_0_925_to_1_00_wSC");
  gre_DR07_RMS90_JER_0_925_to_1_00_wSC ->SetTitle("");
  gre_DR07_RMS90_JER_0_925_to_1_00_wSC ->SetFillColor(1);
  gre_DR07_RMS90_JER_0_925_to_1_00_wSC ->SetLineColor(kBlack);
  gre_DR07_RMS90_JER_0_925_to_1_00_wSC ->SetMarkerColor(kBlack);
  gre_DR07_RMS90_JER_0_925_to_1_00_wSC ->SetMarkerStyle(kFullCircle);

  TGraphErrors *gre_DR07_RMS90_JER_0_65_noSC = new TGraphErrors(6);
  gre_DR07_RMS90_JER_0_65_noSC ->SetName("gre_DR07_RMS90_JER_0_65_noSC");
  gre_DR07_RMS90_JER_0_65_noSC ->SetTitle("");
  gre_DR07_RMS90_JER_0_65_noSC ->SetFillColor(1);
  gre_DR07_RMS90_JER_0_65_noSC ->SetLineColor(kRed);
  gre_DR07_RMS90_JER_0_65_noSC ->SetMarkerColor(kRed);
  gre_DR07_RMS90_JER_0_65_noSC ->SetMarkerStyle(kFullSquare);

  TGraphErrors *gre_DR07_RMS90_JER_0_65_to_0_80_noSC = new TGraphErrors(6);
  gre_DR07_RMS90_JER_0_65_to_0_80_noSC ->SetName("gre_DR07_RMS90_JER_0_65_to_0_80_noSC");
  gre_DR07_RMS90_JER_0_65_to_0_80_noSC ->SetTitle("");
  gre_DR07_RMS90_JER_0_65_to_0_80_noSC ->SetFillColor(1);
  gre_DR07_RMS90_JER_0_65_to_0_80_noSC ->SetLineColor(kRed);
  gre_DR07_RMS90_JER_0_65_to_0_80_noSC ->SetMarkerColor(kRed);
  gre_DR07_RMS90_JER_0_65_to_0_80_noSC ->SetMarkerStyle(kFullSquare);

  TGraphErrors *gre_DR07_RMS90_JER_0_80_to_0_925_noSC = new TGraphErrors(6);
  gre_DR07_RMS90_JER_0_80_to_0_925_noSC ->SetName("gre_DR07_RMS90_JER_0_80_to_0_925_noSC");
  gre_DR07_RMS90_JER_0_80_to_0_925_noSC ->SetTitle("");
  gre_DR07_RMS90_JER_0_80_to_0_925_noSC ->SetFillColor(1);
  gre_DR07_RMS90_JER_0_80_to_0_925_noSC ->SetLineColor(kRed);
  gre_DR07_RMS90_JER_0_80_to_0_925_noSC ->SetMarkerColor(kRed);
  gre_DR07_RMS90_JER_0_80_to_0_925_noSC ->SetMarkerStyle(kFullSquare);

  TGraphErrors *gre_DR07_RMS90_JER_0_925_to_1_00_noSC = new TGraphErrors(6);
  gre_DR07_RMS90_JER_0_925_to_1_00_noSC ->SetName("gre_DR07_RMS90_JER_0_925_to_1_00_noSC");
  gre_DR07_RMS90_JER_0_925_to_1_00_noSC ->SetTitle("");
  gre_DR07_RMS90_JER_0_925_to_1_00_noSC ->SetFillColor(1);
  gre_DR07_RMS90_JER_0_925_to_1_00_noSC ->SetLineColor(kRed);
  gre_DR07_RMS90_JER_0_925_to_1_00_noSC ->SetMarkerColor(kRed);
  gre_DR07_RMS90_JER_0_925_to_1_00_noSC ->SetMarkerStyle(kFullSquare);

  TGraphErrors *gre_DR07_RMS90_JER_0_65_wO_wSC = new TGraphErrors(6);
  gre_DR07_RMS90_JER_0_65_wO_wSC ->SetName("gre_DR07_RMS90_JER_0_65_wO_wSC");
  gre_DR07_RMS90_JER_0_65_wO_wSC ->SetTitle("");
  gre_DR07_RMS90_JER_0_65_wO_wSC ->SetFillColor(1);
  gre_DR07_RMS90_JER_0_65_wO_wSC ->SetLineColor(kBlue);
  gre_DR07_RMS90_JER_0_65_wO_wSC ->SetMarkerColor(kBlue);
  gre_DR07_RMS90_JER_0_65_wO_wSC ->SetMarkerStyle(kFullTriangleUp);

  TGraphErrors *gre_DR07_RMS90_JER_0_65_to_0_80_wO_wSC = new TGraphErrors(6);
  gre_DR07_RMS90_JER_0_65_to_0_80_wO_wSC ->SetName("gre_DR07_RMS90_JER_0_65_to_0_80_wO_wSC");
  gre_DR07_RMS90_JER_0_65_to_0_80_wO_wSC ->SetTitle("");
  gre_DR07_RMS90_JER_0_65_to_0_80_wO_wSC ->SetFillColor(1);
  gre_DR07_RMS90_JER_0_65_to_0_80_wO_wSC ->SetLineColor(kBlue);
  gre_DR07_RMS90_JER_0_65_to_0_80_wO_wSC ->SetMarkerColor(kBlue);
  gre_DR07_RMS90_JER_0_65_to_0_80_wO_wSC ->SetMarkerStyle(kFullTriangleUp);

  TGraphErrors *gre_DR07_RMS90_JER_0_80_to_0_925_wO_wSC = new TGraphErrors(6);
  gre_DR07_RMS90_JER_0_80_to_0_925_wO_wSC ->SetName("gre_DR07_RMS90_JER_0_80_to_0_925_wO_wSC");
  gre_DR07_RMS90_JER_0_80_to_0_925_wO_wSC ->SetTitle("");
  gre_DR07_RMS90_JER_0_80_to_0_925_wO_wSC ->SetFillColor(1);
  gre_DR07_RMS90_JER_0_80_to_0_925_wO_wSC ->SetLineColor(kBlue);
  gre_DR07_RMS90_JER_0_80_to_0_925_wO_wSC ->SetMarkerColor(kBlue);
  gre_DR07_RMS90_JER_0_80_to_0_925_wO_wSC ->SetMarkerStyle(kFullTriangleUp);

  TGraphErrors *gre_DR07_RMS90_JER_0_925_to_1_00_wO_wSC = new TGraphErrors(6);
  gre_DR07_RMS90_JER_0_925_to_1_00_wO_wSC ->SetName("gre_DR07_RMS90_JER_0_925_to_1_00_wO_wSC");
  gre_DR07_RMS90_JER_0_925_to_1_00_wO_wSC ->SetTitle("");
  gre_DR07_RMS90_JER_0_925_to_1_00_wO_wSC ->SetFillColor(1);
  gre_DR07_RMS90_JER_0_925_to_1_00_wO_wSC ->SetLineColor(kBlue);
  gre_DR07_RMS90_JER_0_925_to_1_00_wO_wSC ->SetMarkerColor(kBlue);
  gre_DR07_RMS90_JER_0_925_to_1_00_wO_wSC ->SetMarkerStyle(kFullTriangleUp);

  TGraphErrors *gre_DR07_RMS90_JER_0_65_wO_noSC = new TGraphErrors(6);
  gre_DR07_RMS90_JER_0_65_wO_noSC ->SetName("gre_DR07_RMS90_JER_0_65_wO_noSC");
  gre_DR07_RMS90_JER_0_65_wO_noSC ->SetTitle("");
  gre_DR07_RMS90_JER_0_65_wO_noSC ->SetFillColor(1);
  gre_DR07_RMS90_JER_0_65_wO_noSC ->SetLineColor(kMagenta);
  gre_DR07_RMS90_JER_0_65_wO_noSC ->SetMarkerColor(kMagenta);
  gre_DR07_RMS90_JER_0_65_wO_noSC ->SetMarkerStyle(kFullTriangleDown);

  TGraphErrors *gre_DR07_RMS90_JER_0_65_to_0_80_wO_noSC = new TGraphErrors(6);
  gre_DR07_RMS90_JER_0_65_to_0_80_wO_noSC ->SetName("gre_DR07_RMS90_JER_0_65_to_0_80_wO_noSC");
  gre_DR07_RMS90_JER_0_65_to_0_80_wO_noSC ->SetTitle("");
  gre_DR07_RMS90_JER_0_65_to_0_80_wO_noSC ->SetFillColor(1);
  gre_DR07_RMS90_JER_0_65_to_0_80_wO_noSC ->SetLineColor(kMagenta);
  gre_DR07_RMS90_JER_0_65_to_0_80_wO_noSC ->SetMarkerColor(kMagenta);
  gre_DR07_RMS90_JER_0_65_to_0_80_wO_noSC ->SetMarkerStyle(kFullTriangleDown);

  TGraphErrors *gre_DR07_RMS90_JER_0_80_to_0_925_wO_noSC = new TGraphErrors(6);
  gre_DR07_RMS90_JER_0_80_to_0_925_wO_noSC ->SetName("gre_DR07_RMS90_JER_0_80_to_0_925_wO_noSC");
  gre_DR07_RMS90_JER_0_80_to_0_925_wO_noSC ->SetTitle("");
  gre_DR07_RMS90_JER_0_80_to_0_925_wO_noSC ->SetFillColor(1);
  gre_DR07_RMS90_JER_0_80_to_0_925_wO_noSC ->SetLineColor(kMagenta);
  gre_DR07_RMS90_JER_0_80_to_0_925_wO_noSC ->SetMarkerColor(kMagenta);
  gre_DR07_RMS90_JER_0_80_to_0_925_wO_noSC ->SetMarkerStyle(kFullTriangleDown);

  TGraphErrors *gre_DR07_RMS90_JER_0_925_to_1_00_wO_noSC = new TGraphErrors(6);
  gre_DR07_RMS90_JER_0_925_to_1_00_wO_noSC ->SetName("gre_DR07_RMS90_JER_0_925_to_1_00_wO_noSC");
  gre_DR07_RMS90_JER_0_925_to_1_00_wO_noSC ->SetTitle("");
  gre_DR07_RMS90_JER_0_925_to_1_00_wO_noSC ->SetFillColor(1);
  gre_DR07_RMS90_JER_0_925_to_1_00_wO_noSC ->SetLineColor(kMagenta);
  gre_DR07_RMS90_JER_0_925_to_1_00_wO_noSC ->SetMarkerColor(kMagenta);
  gre_DR07_RMS90_JER_0_925_to_1_00_wO_noSC ->SetMarkerStyle(kFullTriangleDown);

  std::cout<<"before 100 CT_wSC"<<std::endl;

  TH1F* h_100_CT_wSC_DR07_E_rel_totVis_RMS_d1_cosT_0_to_0_65 =  new TH1F("h_100_CT_wSC_DR07_E_rel_totVis_RMS_d1_cosT_0_to_0_65","", n_binsJER, lim_E_rel_low,lim_E_rel_high);
  TH1F* h_100_CT_wSC_DR07_E_rel_totVis_RMS_d1_cosT_0_65_to_0_80 =  new TH1F("h_100_CT_wSC_DR07_E_rel_totVis_RMS_d1_cosT_0_65_to_0_80","", n_binsJER, lim_E_rel_low,lim_E_rel_high);
  TH1F* h_100_CT_wSC_DR07_E_rel_totVis_RMS_d1_cosT_0_80_to_0_925 =  new TH1F("h_100_CT_wSC_DR07_E_rel_totVis_RMS_d1_cosT_0_80_to_0_925","", n_binsJER, lim_E_rel_low,lim_E_rel_high);
  TH1F* h_100_CT_wSC_DR07_E_rel_totVis_RMS_d1_cosT_0_925_to_1_00 =  new TH1F("h_100_CT_wSC_DR07_E_rel_totVis_RMS_d1_cosT_0_925_to_1_00","", n_binsJER, lim_E_rel_low,lim_E_rel_high);

  std::vector<TH1F*> hist_vec_100_CT_wSC;
  hist_vec_100_CT_wSC.push_back(h_100_CT_wSC_DR07_E_rel_totVis_RMS_d1_cosT_0_to_0_65);
  hist_vec_100_CT_wSC.push_back(h_100_CT_wSC_DR07_E_rel_totVis_RMS_d1_cosT_0_65_to_0_80);
  hist_vec_100_CT_wSC.push_back(h_100_CT_wSC_DR07_E_rel_totVis_RMS_d1_cosT_0_80_to_0_925);
  hist_vec_100_CT_wSC.push_back(h_100_CT_wSC_DR07_E_rel_totVis_RMS_d1_cosT_0_925_to_1_00);


  for(unsigned int i=0;i<hist_vec_100_CT_wSC.size();i++){
    hist_vec_100_CT_wSC[i]->Sumw2();
  }
  fill_SC_jet_histograms(file_CLIC_100_CT,hist_vec_100_CT_wSC);

  TH1F* h_100_CT_wSC_DR07_E_RMS90_summary_histogram=new TH1F("JER_RMS90VsCosTheta_CT_wSC_DR07_100", "RMS_{90}(E_{j}^{reco}/E_{j}^{gen}) / Mean_{90}(E_{j}^{reco}/E_{j}^{gen}) vs |cos#theta|", nRegionBinsAngles, pRegionBinEdgesAngles);
  h_100_CT_wSC_DR07_E_RMS90_summary_histogram ->SetYTitle("RMS_{90}(E_{j}^{reco}/E_{j}^{gen}) / Mean_{90}(E_{j}^{reco}/E_{j}^{gen}) [%]");
  h_100_CT_wSC_DR07_E_RMS90_summary_histogram->SetXTitle("|cos#theta|");
  h_100_CT_wSC_DR07_E_RMS90_summary_histogram->SetLineWidth(2);
  h_100_CT_wSC_DR07_E_RMS90_summary_histogram->SetLineColor(kRed);
  h_100_CT_wSC_DR07_E_RMS90_summary_histogram->SetLineStyle(2);
  //for energies still keep sqrt(2) from original total energy calculation
  for(int i=0;i<4;i++){
    resolutionTH1=0; 
    resolutionErrorTH1=0;
    meanTH1=0;
    meanErrorTH1=0;
    CalculatePerformance( hist_vec_100_CT_wSC[i], resolutionTH1, resolutionErrorTH1,meanTH1,meanErrorTH1);
    h_100_CT_wSC_DR07_E_RMS90_summary_histogram->SetBinContent(i+1,resolutionTH1/sqrt(2.));
    h_100_CT_wSC_DR07_E_RMS90_summary_histogram ->SetBinError(i+1, resolutionErrorTH1/sqrt(2.));
  }
  gre_DR07_RMS90_JER_0_65_wSC->SetPoint(0,50,h_100_CT_wSC_DR07_E_RMS90_summary_histogram->GetBinContent(1));
  gre_DR07_RMS90_JER_0_65_wSC->SetPointError(0,0,h_100_CT_wSC_DR07_E_RMS90_summary_histogram->GetBinError(1));

  gre_DR07_RMS90_JER_0_65_to_0_80_wSC->SetPoint(0,50,h_100_CT_wSC_DR07_E_RMS90_summary_histogram->GetBinContent(2));
  gre_DR07_RMS90_JER_0_65_to_0_80_wSC->SetPointError(0,0,h_100_CT_wSC_DR07_E_RMS90_summary_histogram->GetBinError(2));

  gre_DR07_RMS90_JER_0_80_to_0_925_wSC->SetPoint(0,50,h_100_CT_wSC_DR07_E_RMS90_summary_histogram->GetBinContent(3));
  gre_DR07_RMS90_JER_0_80_to_0_925_wSC->SetPointError(0,0,h_100_CT_wSC_DR07_E_RMS90_summary_histogram->GetBinError(3));

  gre_DR07_RMS90_JER_0_925_to_1_00_wSC->SetPoint(0,50,h_100_CT_wSC_DR07_E_RMS90_summary_histogram->GetBinContent(4));
  gre_DR07_RMS90_JER_0_925_to_1_00_wSC->SetPointError(0,0,h_100_CT_wSC_DR07_E_RMS90_summary_histogram->GetBinError(4));

  std::cout<<"before 100 CT_wO_wSC"<<std::endl;

  TH1F* h_100_CT_wO_wSC_DR07_E_rel_totVis_RMS_d1_cosT_0_to_0_65 =  new TH1F("h_100_CT_wO_wSC_DR07_E_rel_totVis_RMS_d1_cosT_0_to_0_65","", n_binsJER, lim_E_rel_low,lim_E_rel_high);
  TH1F* h_100_CT_wO_wSC_DR07_E_rel_totVis_RMS_d1_cosT_0_65_to_0_80 =  new TH1F("h_100_CT_wO_wSC_DR07_E_rel_totVis_RMS_d1_cosT_0_65_to_0_80","", n_binsJER, lim_E_rel_low,lim_E_rel_high);
  TH1F* h_100_CT_wO_wSC_DR07_E_rel_totVis_RMS_d1_cosT_0_80_to_0_925 =  new TH1F("h_100_CT_wO_wSC_DR07_E_rel_totVis_RMS_d1_cosT_0_80_to_0_925","", n_binsJER, lim_E_rel_low,lim_E_rel_high);
  TH1F* h_100_CT_wO_wSC_DR07_E_rel_totVis_RMS_d1_cosT_0_925_to_1_00 =  new TH1F("h_100_CT_wO_wSC_DR07_E_rel_totVis_RMS_d1_cosT_0_925_to_1_00","", n_binsJER, lim_E_rel_low,lim_E_rel_high);

  std::vector<TH1F*> hist_vec_100_CT_wO_wSC;
  hist_vec_100_CT_wO_wSC.push_back(h_100_CT_wO_wSC_DR07_E_rel_totVis_RMS_d1_cosT_0_to_0_65);
  hist_vec_100_CT_wO_wSC.push_back(h_100_CT_wO_wSC_DR07_E_rel_totVis_RMS_d1_cosT_0_65_to_0_80);
  hist_vec_100_CT_wO_wSC.push_back(h_100_CT_wO_wSC_DR07_E_rel_totVis_RMS_d1_cosT_0_80_to_0_925);
  hist_vec_100_CT_wO_wSC.push_back(h_100_CT_wO_wSC_DR07_E_rel_totVis_RMS_d1_cosT_0_925_to_1_00);


  for(unsigned int i=0;i<hist_vec_100_CT_wO_wSC.size();i++){
    hist_vec_100_CT_wO_wSC[i]->Sumw2();
  }
  fill_SC_jet_histograms(file_CLIC_100_CT_wO,hist_vec_100_CT_wO_wSC);

  TH1F* h_100_CT_wO_wSC_DR07_E_RMS90_summary_histogram=new TH1F("JER_RMS90VsCosTheta_CT_wO_wSC_DR07_100", "RMS_{90}(E_{j}^{reco}/E_{j}^{gen}) / Mean_{90}(E_{j}^{reco}/E_{j}^{gen}) vs |cos#theta|", nRegionBinsAngles, pRegionBinEdgesAngles);
  h_100_CT_wO_wSC_DR07_E_RMS90_summary_histogram ->SetYTitle("RMS_{90}(E_{j}^{reco}/E_{j}^{gen}) / Mean_{90}(E_{j}^{reco}/E_{j}^{gen}) [%]");
  h_100_CT_wO_wSC_DR07_E_RMS90_summary_histogram->SetXTitle("|cos#theta|");
  h_100_CT_wO_wSC_DR07_E_RMS90_summary_histogram->SetLineWidth(2);
  h_100_CT_wO_wSC_DR07_E_RMS90_summary_histogram->SetLineColor(kRed);
  h_100_CT_wO_wSC_DR07_E_RMS90_summary_histogram->SetLineStyle(2);
  //for energies still keep sqrt(2) from original total energy calculation
  for(int i=0;i<4;i++){
    resolutionTH1=0; 
    resolutionErrorTH1=0;
    meanTH1=0;
    meanErrorTH1=0;
    CalculatePerformance( hist_vec_100_CT_wO_wSC[i], resolutionTH1, resolutionErrorTH1,meanTH1,meanErrorTH1);
    h_100_CT_wO_wSC_DR07_E_RMS90_summary_histogram->SetBinContent(i+1,resolutionTH1/sqrt(2.));
    h_100_CT_wO_wSC_DR07_E_RMS90_summary_histogram ->SetBinError(i+1, resolutionErrorTH1/sqrt(2.));
  }
  gre_DR07_RMS90_JER_0_65_wO_wSC->SetPoint(0,50,h_100_CT_wO_wSC_DR07_E_RMS90_summary_histogram->GetBinContent(1));
  gre_DR07_RMS90_JER_0_65_wO_wSC->SetPointError(0,0,h_100_CT_wO_wSC_DR07_E_RMS90_summary_histogram->GetBinError(1));

  gre_DR07_RMS90_JER_0_65_to_0_80_wO_wSC->SetPoint(0,50,h_100_CT_wO_wSC_DR07_E_RMS90_summary_histogram->GetBinContent(2));
  gre_DR07_RMS90_JER_0_65_to_0_80_wO_wSC->SetPointError(0,0,h_100_CT_wO_wSC_DR07_E_RMS90_summary_histogram->GetBinError(2));

  gre_DR07_RMS90_JER_0_80_to_0_925_wO_wSC->SetPoint(0,50,h_100_CT_wO_wSC_DR07_E_RMS90_summary_histogram->GetBinContent(3));
  gre_DR07_RMS90_JER_0_80_to_0_925_wO_wSC->SetPointError(0,0,h_100_CT_wO_wSC_DR07_E_RMS90_summary_histogram->GetBinError(3));

  gre_DR07_RMS90_JER_0_925_to_1_00_wO_wSC->SetPoint(0,50,h_100_CT_wO_wSC_DR07_E_RMS90_summary_histogram->GetBinContent(4));
  gre_DR07_RMS90_JER_0_925_to_1_00_wO_wSC->SetPointError(0,0,h_100_CT_wO_wSC_DR07_E_RMS90_summary_histogram->GetBinError(4));


  std::cout<<"before 100 CT_noSC"<<std::endl;

  TH1F* h_100_CT_noSC_DR07_E_rel_totVis_RMS_d1_cosT_0_to_0_65 =  new TH1F("h_100_CT_noSC_DR07_E_rel_totVis_RMS_d1_cosT_0_to_0_65","", n_binsJER, lim_E_rel_low,lim_E_rel_high);
  TH1F* h_100_CT_noSC_DR07_E_rel_totVis_RMS_d1_cosT_0_65_to_0_80 =  new TH1F("h_100_CT_noSC_DR07_E_rel_totVis_RMS_d1_cosT_0_65_to_0_80","", n_binsJER, lim_E_rel_low,lim_E_rel_high);
  TH1F* h_100_CT_noSC_DR07_E_rel_totVis_RMS_d1_cosT_0_80_to_0_925 =  new TH1F("h_100_CT_noSC_DR07_E_rel_totVis_RMS_d1_cosT_0_80_to_0_925","", n_binsJER, lim_E_rel_low,lim_E_rel_high);
  TH1F* h_100_CT_noSC_DR07_E_rel_totVis_RMS_d1_cosT_0_925_to_1_00 =  new TH1F("h_100_CT_noSC_DR07_E_rel_totVis_RMS_d1_cosT_0_925_to_1_00","", n_binsJER, lim_E_rel_low,lim_E_rel_high);

  std::vector<TH1F*> hist_vec_100_CT_noSC;
  hist_vec_100_CT_noSC.push_back(h_100_CT_noSC_DR07_E_rel_totVis_RMS_d1_cosT_0_to_0_65);
  hist_vec_100_CT_noSC.push_back(h_100_CT_noSC_DR07_E_rel_totVis_RMS_d1_cosT_0_65_to_0_80);
  hist_vec_100_CT_noSC.push_back(h_100_CT_noSC_DR07_E_rel_totVis_RMS_d1_cosT_0_80_to_0_925);
  hist_vec_100_CT_noSC.push_back(h_100_CT_noSC_DR07_E_rel_totVis_RMS_d1_cosT_0_925_to_1_00);


  for(unsigned int i=0;i<hist_vec_100_CT_noSC.size();i++){
    hist_vec_100_CT_noSC[i]->Sumw2();
  }

  fill_SC_jet_histograms(file_CLIC_100_CT_noSC,hist_vec_100_CT_noSC);

  TH1F* h_100_CT_noSC_DR07_E_RMS90_summary_histogram=new TH1F("JER_RMS90VsCosTheta_CT_noSC_DR07_100", "RMS_{90}(E_{j}^{reco}/E_{j}^{gen}) / Mean_{90}(E_{j}^{reco}/E_{j}^{gen}) vs |cos#theta|", nRegionBinsAngles, pRegionBinEdgesAngles);
  h_100_CT_noSC_DR07_E_RMS90_summary_histogram ->SetYTitle("RMS_{90}(E_{j}^{reco}/E_{j}^{gen}) / Mean_{90}(E_{j}^{reco}/E_{j}^{gen}) [%]");
  h_100_CT_noSC_DR07_E_RMS90_summary_histogram->SetXTitle("|cos#theta|");
  h_100_CT_noSC_DR07_E_RMS90_summary_histogram->SetLineWidth(2);
  h_100_CT_noSC_DR07_E_RMS90_summary_histogram->SetLineColor(kRed);
  h_100_CT_noSC_DR07_E_RMS90_summary_histogram->SetLineStyle(2);
  //for energies still keep sqrt(2) from original total energy calculation
  for(int i=0;i<4;i++){
    resolutionTH1=0; 
    resolutionErrorTH1=0;
    meanTH1=0;
    meanErrorTH1=0;
    CalculatePerformance( hist_vec_100_CT_noSC[i], resolutionTH1, resolutionErrorTH1,meanTH1,meanErrorTH1);
    h_100_CT_noSC_DR07_E_RMS90_summary_histogram->SetBinContent(i+1,resolutionTH1/sqrt(2.));
    h_100_CT_noSC_DR07_E_RMS90_summary_histogram ->SetBinError(i+1, resolutionErrorTH1/sqrt(2.));
  }
  gre_DR07_RMS90_JER_0_65_noSC->SetPoint(0,50,h_100_CT_noSC_DR07_E_RMS90_summary_histogram->GetBinContent(1));
  gre_DR07_RMS90_JER_0_65_noSC->SetPointError(0,0,h_100_CT_noSC_DR07_E_RMS90_summary_histogram->GetBinError(1));

  gre_DR07_RMS90_JER_0_65_to_0_80_noSC->SetPoint(0,50,h_100_CT_noSC_DR07_E_RMS90_summary_histogram->GetBinContent(2));
  gre_DR07_RMS90_JER_0_65_to_0_80_noSC->SetPointError(0,0,h_100_CT_noSC_DR07_E_RMS90_summary_histogram->GetBinError(2));

  gre_DR07_RMS90_JER_0_80_to_0_925_noSC->SetPoint(0,50,h_100_CT_noSC_DR07_E_RMS90_summary_histogram->GetBinContent(3));
  gre_DR07_RMS90_JER_0_80_to_0_925_noSC->SetPointError(0,0,h_100_CT_noSC_DR07_E_RMS90_summary_histogram->GetBinError(3));

  gre_DR07_RMS90_JER_0_925_to_1_00_noSC->SetPoint(0,50,h_100_CT_noSC_DR07_E_RMS90_summary_histogram->GetBinContent(4));
  gre_DR07_RMS90_JER_0_925_to_1_00_noSC->SetPointError(0,0,h_100_CT_noSC_DR07_E_RMS90_summary_histogram->GetBinError(4));

  std::cout<<"before 100 CT_wO_noSC"<<std::endl;

  TH1F* h_100_CT_wO_noSC_DR07_E_rel_totVis_RMS_d1_cosT_0_to_0_65 =  new TH1F("h_100_CT_wO_noSC_DR07_E_rel_totVis_RMS_d1_cosT_0_to_0_65","", n_binsJER, lim_E_rel_low,lim_E_rel_high);
  TH1F* h_100_CT_wO_noSC_DR07_E_rel_totVis_RMS_d1_cosT_0_65_to_0_80 =  new TH1F("h_100_CT_wO_noSC_DR07_E_rel_totVis_RMS_d1_cosT_0_65_to_0_80","", n_binsJER, lim_E_rel_low,lim_E_rel_high);
  TH1F* h_100_CT_wO_noSC_DR07_E_rel_totVis_RMS_d1_cosT_0_80_to_0_925 =  new TH1F("h_100_CT_wO_noSC_DR07_E_rel_totVis_RMS_d1_cosT_0_80_to_0_925","", n_binsJER, lim_E_rel_low,lim_E_rel_high);
  TH1F* h_100_CT_wO_noSC_DR07_E_rel_totVis_RMS_d1_cosT_0_925_to_1_00 =  new TH1F("h_100_CT_wO_noSC_DR07_E_rel_totVis_RMS_d1_cosT_0_925_to_1_00","", n_binsJER, lim_E_rel_low,lim_E_rel_high);

  std::vector<TH1F*> hist_vec_100_CT_wO_noSC;
  hist_vec_100_CT_wO_noSC.push_back(h_100_CT_wO_noSC_DR07_E_rel_totVis_RMS_d1_cosT_0_to_0_65);
  hist_vec_100_CT_wO_noSC.push_back(h_100_CT_wO_noSC_DR07_E_rel_totVis_RMS_d1_cosT_0_65_to_0_80);
  hist_vec_100_CT_wO_noSC.push_back(h_100_CT_wO_noSC_DR07_E_rel_totVis_RMS_d1_cosT_0_80_to_0_925);
  hist_vec_100_CT_wO_noSC.push_back(h_100_CT_wO_noSC_DR07_E_rel_totVis_RMS_d1_cosT_0_925_to_1_00);


  for(unsigned int i=0;i<hist_vec_100_CT_wO_noSC.size();i++){
    hist_vec_100_CT_wO_noSC[i]->Sumw2();
  }

  fill_SC_jet_histograms(file_CLIC_100_CT_noSC_wO,hist_vec_100_CT_wO_noSC);

  TH1F* h_100_CT_wO_noSC_DR07_E_RMS90_summary_histogram=new TH1F("JER_RMS90VsCosTheta_CT_wO_noSC_DR07_100", "RMS_{90}(E_{j}^{reco}/E_{j}^{gen}) / Mean_{90}(E_{j}^{reco}/E_{j}^{gen}) vs |cos#theta|", nRegionBinsAngles, pRegionBinEdgesAngles);
  h_100_CT_wO_noSC_DR07_E_RMS90_summary_histogram ->SetYTitle("RMS_{90}(E_{j}^{reco}/E_{j}^{gen}) / Mean_{90}(E_{j}^{reco}/E_{j}^{gen}) [%]");
  h_100_CT_wO_noSC_DR07_E_RMS90_summary_histogram->SetXTitle("|cos#theta|");
  h_100_CT_wO_noSC_DR07_E_RMS90_summary_histogram->SetLineWidth(2);
  h_100_CT_wO_noSC_DR07_E_RMS90_summary_histogram->SetLineColor(kRed);
  h_100_CT_wO_noSC_DR07_E_RMS90_summary_histogram->SetLineStyle(2);
  //for energies still keep sqrt(2) from original total energy calculation
  for(int i=0;i<4;i++){
    resolutionTH1=0; 
    resolutionErrorTH1=0;
    meanTH1=0;
    meanErrorTH1=0;
    CalculatePerformance( hist_vec_100_CT_wO_noSC[i], resolutionTH1, resolutionErrorTH1,meanTH1,meanErrorTH1);
    h_100_CT_wO_noSC_DR07_E_RMS90_summary_histogram->SetBinContent(i+1,resolutionTH1/sqrt(2.));
    h_100_CT_wO_noSC_DR07_E_RMS90_summary_histogram ->SetBinError(i+1, resolutionErrorTH1/sqrt(2.));
  }
  gre_DR07_RMS90_JER_0_65_wO_noSC->SetPoint(0,50,h_100_CT_wO_noSC_DR07_E_RMS90_summary_histogram->GetBinContent(1));
  gre_DR07_RMS90_JER_0_65_wO_noSC->SetPointError(0,0,h_100_CT_wO_noSC_DR07_E_RMS90_summary_histogram->GetBinError(1));

  gre_DR07_RMS90_JER_0_65_to_0_80_wO_noSC->SetPoint(0,50,h_100_CT_wO_noSC_DR07_E_RMS90_summary_histogram->GetBinContent(2));
  gre_DR07_RMS90_JER_0_65_to_0_80_wO_noSC->SetPointError(0,0,h_100_CT_wO_noSC_DR07_E_RMS90_summary_histogram->GetBinError(2));

  gre_DR07_RMS90_JER_0_80_to_0_925_wO_noSC->SetPoint(0,50,h_100_CT_wO_noSC_DR07_E_RMS90_summary_histogram->GetBinContent(3));
  gre_DR07_RMS90_JER_0_80_to_0_925_wO_noSC->SetPointError(0,0,h_100_CT_wO_noSC_DR07_E_RMS90_summary_histogram->GetBinError(3));

  gre_DR07_RMS90_JER_0_925_to_1_00_wO_noSC->SetPoint(0,50,h_100_CT_wO_noSC_DR07_E_RMS90_summary_histogram->GetBinContent(4));
  gre_DR07_RMS90_JER_0_925_to_1_00_wO_noSC->SetPointError(0,0,h_100_CT_wO_noSC_DR07_E_RMS90_summary_histogram->GetBinError(4));

  std::cout<<"before 200 CT_wSC"<<std::endl;

  TH1F* h_200_CT_wSC_DR07_E_rel_totVis_RMS_d1_cosT_0_to_0_65 =  new TH1F("h_200_CT_wSC_DR07_E_rel_totVis_RMS_d1_cosT_0_to_0_65","", n_binsJER, lim_E_rel_low,lim_E_rel_high);
  TH1F* h_200_CT_wSC_DR07_E_rel_totVis_RMS_d1_cosT_0_65_to_0_80 =  new TH1F("h_200_CT_wSC_DR07_E_rel_totVis_RMS_d1_cosT_0_65_to_0_80","", n_binsJER, lim_E_rel_low,lim_E_rel_high);
  TH1F* h_200_CT_wSC_DR07_E_rel_totVis_RMS_d1_cosT_0_80_to_0_925 =  new TH1F("h_200_CT_wSC_DR07_E_rel_totVis_RMS_d1_cosT_0_80_to_0_925","", n_binsJER, lim_E_rel_low,lim_E_rel_high);
  TH1F* h_200_CT_wSC_DR07_E_rel_totVis_RMS_d1_cosT_0_925_to_1_00 =  new TH1F("h_200_CT_wSC_DR07_E_rel_totVis_RMS_d1_cosT_0_925_to_1_00","", n_binsJER, lim_E_rel_low,lim_E_rel_high);

  std::vector<TH1F*> hist_vec_200_CT_wSC;
  hist_vec_200_CT_wSC.push_back(h_200_CT_wSC_DR07_E_rel_totVis_RMS_d1_cosT_0_to_0_65);
  hist_vec_200_CT_wSC.push_back(h_200_CT_wSC_DR07_E_rel_totVis_RMS_d1_cosT_0_65_to_0_80);
  hist_vec_200_CT_wSC.push_back(h_200_CT_wSC_DR07_E_rel_totVis_RMS_d1_cosT_0_80_to_0_925);
  hist_vec_200_CT_wSC.push_back(h_200_CT_wSC_DR07_E_rel_totVis_RMS_d1_cosT_0_925_to_1_00);


  for(unsigned int i=0;i<hist_vec_200_CT_wSC.size();i++){
    hist_vec_200_CT_wSC[i]->Sumw2();
  }
  fill_SC_jet_histograms(file_CLIC_200_CT,hist_vec_200_CT_wSC);

  TH1F* h_200_CT_wSC_DR07_E_RMS90_summary_histogram=new TH1F("JER_RMS90VsCosTheta_CT_wSC_DR07_200", "RMS_{90}(E_{j}^{reco}/E_{j}^{gen}) / Mean_{90}(E_{j}^{reco}/E_{j}^{gen}) vs |cos#theta|", nRegionBinsAngles, pRegionBinEdgesAngles);
  h_200_CT_wSC_DR07_E_RMS90_summary_histogram ->SetYTitle("RMS_{90}(E_{j}^{reco}/E_{j}^{gen}) / Mean_{90}(E_{j}^{reco}/E_{j}^{gen}) [%]");
  h_200_CT_wSC_DR07_E_RMS90_summary_histogram->SetXTitle("|cos#theta|");
  h_200_CT_wSC_DR07_E_RMS90_summary_histogram->SetLineWidth(2);
  h_200_CT_wSC_DR07_E_RMS90_summary_histogram->SetLineColor(kRed);
  h_200_CT_wSC_DR07_E_RMS90_summary_histogram->SetLineStyle(2);
  //for energies still keep sqrt(2) from original total energy calculation
  for(int i=0;i<4;i++){
    resolutionTH1=0; 
    resolutionErrorTH1=0;
    meanTH1=0;
    meanErrorTH1=0;
    CalculatePerformance( hist_vec_200_CT_wSC[i], resolutionTH1, resolutionErrorTH1,meanTH1,meanErrorTH1);
    h_200_CT_wSC_DR07_E_RMS90_summary_histogram->SetBinContent(i+1,resolutionTH1/sqrt(2.));
    h_200_CT_wSC_DR07_E_RMS90_summary_histogram ->SetBinError(i+1, resolutionErrorTH1/sqrt(2.));
  }
  gre_DR07_RMS90_JER_0_65_wSC->SetPoint(1,100,h_200_CT_wSC_DR07_E_RMS90_summary_histogram->GetBinContent(1));
  gre_DR07_RMS90_JER_0_65_wSC->SetPointError(1,0,h_200_CT_wSC_DR07_E_RMS90_summary_histogram->GetBinError(1));

  gre_DR07_RMS90_JER_0_65_to_0_80_wSC->SetPoint(1,100,h_200_CT_wSC_DR07_E_RMS90_summary_histogram->GetBinContent(2));
  gre_DR07_RMS90_JER_0_65_to_0_80_wSC->SetPointError(1,0,h_200_CT_wSC_DR07_E_RMS90_summary_histogram->GetBinError(2));

  gre_DR07_RMS90_JER_0_80_to_0_925_wSC->SetPoint(1,100,h_200_CT_wSC_DR07_E_RMS90_summary_histogram->GetBinContent(3));
  gre_DR07_RMS90_JER_0_80_to_0_925_wSC->SetPointError(1,0,h_200_CT_wSC_DR07_E_RMS90_summary_histogram->GetBinError(3));

  gre_DR07_RMS90_JER_0_925_to_1_00_wSC->SetPoint(1,100,h_200_CT_wSC_DR07_E_RMS90_summary_histogram->GetBinContent(4));
  gre_DR07_RMS90_JER_0_925_to_1_00_wSC->SetPointError(1,0,h_200_CT_wSC_DR07_E_RMS90_summary_histogram->GetBinError(4));

  std::cout<<"before 200 CT_wO_wSC"<<std::endl;

  TH1F* h_200_CT_wO_wSC_DR07_E_rel_totVis_RMS_d1_cosT_0_to_0_65 =  new TH1F("h_200_CT_wO_wSC_DR07_E_rel_totVis_RMS_d1_cosT_0_to_0_65","", n_binsJER, lim_E_rel_low,lim_E_rel_high);
  TH1F* h_200_CT_wO_wSC_DR07_E_rel_totVis_RMS_d1_cosT_0_65_to_0_80 =  new TH1F("h_200_CT_wO_wSC_DR07_E_rel_totVis_RMS_d1_cosT_0_65_to_0_80","", n_binsJER, lim_E_rel_low,lim_E_rel_high);
  TH1F* h_200_CT_wO_wSC_DR07_E_rel_totVis_RMS_d1_cosT_0_80_to_0_925 =  new TH1F("h_200_CT_wO_wSC_DR07_E_rel_totVis_RMS_d1_cosT_0_80_to_0_925","", n_binsJER, lim_E_rel_low,lim_E_rel_high);
  TH1F* h_200_CT_wO_wSC_DR07_E_rel_totVis_RMS_d1_cosT_0_925_to_1_00 =  new TH1F("h_200_CT_wO_wSC_DR07_E_rel_totVis_RMS_d1_cosT_0_925_to_1_00","", n_binsJER, lim_E_rel_low,lim_E_rel_high);

  std::vector<TH1F*> hist_vec_200_CT_wO_wSC;
  hist_vec_200_CT_wO_wSC.push_back(h_200_CT_wO_wSC_DR07_E_rel_totVis_RMS_d1_cosT_0_to_0_65);
  hist_vec_200_CT_wO_wSC.push_back(h_200_CT_wO_wSC_DR07_E_rel_totVis_RMS_d1_cosT_0_65_to_0_80);
  hist_vec_200_CT_wO_wSC.push_back(h_200_CT_wO_wSC_DR07_E_rel_totVis_RMS_d1_cosT_0_80_to_0_925);
  hist_vec_200_CT_wO_wSC.push_back(h_200_CT_wO_wSC_DR07_E_rel_totVis_RMS_d1_cosT_0_925_to_1_00);


  for(unsigned int i=0;i<hist_vec_200_CT_wO_wSC.size();i++){
    hist_vec_200_CT_wO_wSC[i]->Sumw2();
  }
  fill_SC_jet_histograms(file_CLIC_200_CT_wO,hist_vec_200_CT_wO_wSC);

  TH1F* h_200_CT_wO_wSC_DR07_E_RMS90_summary_histogram=new TH1F("JER_RMS90VsCosTheta_CT_wO_wSC_DR07_200", "RMS_{90}(E_{j}^{reco}/E_{j}^{gen}) / Mean_{90}(E_{j}^{reco}/E_{j}^{gen}) vs |cos#theta|", nRegionBinsAngles, pRegionBinEdgesAngles);
  h_200_CT_wO_wSC_DR07_E_RMS90_summary_histogram ->SetYTitle("RMS_{90}(E_{j}^{reco}/E_{j}^{gen}) / Mean_{90}(E_{j}^{reco}/E_{j}^{gen}) [%]");
  h_200_CT_wO_wSC_DR07_E_RMS90_summary_histogram->SetXTitle("|cos#theta|");
  h_200_CT_wO_wSC_DR07_E_RMS90_summary_histogram->SetLineWidth(2);
  h_200_CT_wO_wSC_DR07_E_RMS90_summary_histogram->SetLineColor(kRed);
  h_200_CT_wO_wSC_DR07_E_RMS90_summary_histogram->SetLineStyle(2);
  //for energies still keep sqrt(2) from original total energy calculation
  for(int i=0;i<4;i++){
    resolutionTH1=0; 
    resolutionErrorTH1=0;
    meanTH1=0;
    meanErrorTH1=0;
    CalculatePerformance( hist_vec_200_CT_wO_wSC[i], resolutionTH1, resolutionErrorTH1,meanTH1,meanErrorTH1);
    h_200_CT_wO_wSC_DR07_E_RMS90_summary_histogram->SetBinContent(i+1,resolutionTH1/sqrt(2.));
    h_200_CT_wO_wSC_DR07_E_RMS90_summary_histogram ->SetBinError(i+1, resolutionErrorTH1/sqrt(2.));
  }
  gre_DR07_RMS90_JER_0_65_wO_wSC->SetPoint(1,100,h_200_CT_wO_wSC_DR07_E_RMS90_summary_histogram->GetBinContent(1));
  gre_DR07_RMS90_JER_0_65_wO_wSC->SetPointError(1,0,h_200_CT_wO_wSC_DR07_E_RMS90_summary_histogram->GetBinError(1));

  gre_DR07_RMS90_JER_0_65_to_0_80_wO_wSC->SetPoint(1,100,h_200_CT_wO_wSC_DR07_E_RMS90_summary_histogram->GetBinContent(2));
  gre_DR07_RMS90_JER_0_65_to_0_80_wO_wSC->SetPointError(1,0,h_200_CT_wO_wSC_DR07_E_RMS90_summary_histogram->GetBinError(2));

  gre_DR07_RMS90_JER_0_80_to_0_925_wO_wSC->SetPoint(1,100,h_200_CT_wO_wSC_DR07_E_RMS90_summary_histogram->GetBinContent(3));
  gre_DR07_RMS90_JER_0_80_to_0_925_wO_wSC->SetPointError(1,0,h_200_CT_wO_wSC_DR07_E_RMS90_summary_histogram->GetBinError(3));

  gre_DR07_RMS90_JER_0_925_to_1_00_wO_wSC->SetPoint(1,100,h_200_CT_wO_wSC_DR07_E_RMS90_summary_histogram->GetBinContent(4));
  gre_DR07_RMS90_JER_0_925_to_1_00_wO_wSC->SetPointError(1,0,h_200_CT_wO_wSC_DR07_E_RMS90_summary_histogram->GetBinError(4));


  std::cout<<"before 200 CT_noSC"<<std::endl;

  TH1F* h_200_CT_noSC_DR07_E_rel_totVis_RMS_d1_cosT_0_to_0_65 =  new TH1F("h_200_CT_noSC_DR07_E_rel_totVis_RMS_d1_cosT_0_to_0_65","", n_binsJER, lim_E_rel_low,lim_E_rel_high);
  TH1F* h_200_CT_noSC_DR07_E_rel_totVis_RMS_d1_cosT_0_65_to_0_80 =  new TH1F("h_200_CT_noSC_DR07_E_rel_totVis_RMS_d1_cosT_0_65_to_0_80","", n_binsJER, lim_E_rel_low,lim_E_rel_high);
  TH1F* h_200_CT_noSC_DR07_E_rel_totVis_RMS_d1_cosT_0_80_to_0_925 =  new TH1F("h_200_CT_noSC_DR07_E_rel_totVis_RMS_d1_cosT_0_80_to_0_925","", n_binsJER, lim_E_rel_low,lim_E_rel_high);
  TH1F* h_200_CT_noSC_DR07_E_rel_totVis_RMS_d1_cosT_0_925_to_1_00 =  new TH1F("h_200_CT_noSC_DR07_E_rel_totVis_RMS_d1_cosT_0_925_to_1_00","", n_binsJER, lim_E_rel_low,lim_E_rel_high);

  std::vector<TH1F*> hist_vec_200_CT_noSC;
  hist_vec_200_CT_noSC.push_back(h_200_CT_noSC_DR07_E_rel_totVis_RMS_d1_cosT_0_to_0_65);
  hist_vec_200_CT_noSC.push_back(h_200_CT_noSC_DR07_E_rel_totVis_RMS_d1_cosT_0_65_to_0_80);
  hist_vec_200_CT_noSC.push_back(h_200_CT_noSC_DR07_E_rel_totVis_RMS_d1_cosT_0_80_to_0_925);
  hist_vec_200_CT_noSC.push_back(h_200_CT_noSC_DR07_E_rel_totVis_RMS_d1_cosT_0_925_to_1_00);


  for(unsigned int i=0;i<hist_vec_200_CT_noSC.size();i++){
    hist_vec_200_CT_noSC[i]->Sumw2();
  }

  fill_SC_jet_histograms(file_CLIC_200_CT_noSC,hist_vec_200_CT_noSC);

  TH1F* h_200_CT_noSC_DR07_E_RMS90_summary_histogram=new TH1F("JER_RMS90VsCosTheta_CT_noSC_DR07_200", "RMS_{90}(E_{j}^{reco}/E_{j}^{gen}) / Mean_{90}(E_{j}^{reco}/E_{j}^{gen}) vs |cos#theta|", nRegionBinsAngles, pRegionBinEdgesAngles);
  h_200_CT_noSC_DR07_E_RMS90_summary_histogram ->SetYTitle("RMS_{90}(E_{j}^{reco}/E_{j}^{gen}) / Mean_{90}(E_{j}^{reco}/E_{j}^{gen}) [%]");
  h_200_CT_noSC_DR07_E_RMS90_summary_histogram->SetXTitle("|cos#theta|");
  h_200_CT_noSC_DR07_E_RMS90_summary_histogram->SetLineWidth(2);
  h_200_CT_noSC_DR07_E_RMS90_summary_histogram->SetLineColor(kRed);
  h_200_CT_noSC_DR07_E_RMS90_summary_histogram->SetLineStyle(2);
  //for energies still keep sqrt(2) from original total energy calculation
  for(int i=0;i<4;i++){
    resolutionTH1=0; 
    resolutionErrorTH1=0;
    meanTH1=0;
    meanErrorTH1=0;
    CalculatePerformance( hist_vec_200_CT_noSC[i], resolutionTH1, resolutionErrorTH1,meanTH1,meanErrorTH1);
    h_200_CT_noSC_DR07_E_RMS90_summary_histogram->SetBinContent(i+1,resolutionTH1/sqrt(2.));
    h_200_CT_noSC_DR07_E_RMS90_summary_histogram ->SetBinError(i+1, resolutionErrorTH1/sqrt(2.));
  }
  gre_DR07_RMS90_JER_0_65_noSC->SetPoint(1,100,h_200_CT_noSC_DR07_E_RMS90_summary_histogram->GetBinContent(1));
  gre_DR07_RMS90_JER_0_65_noSC->SetPointError(1,0,h_200_CT_noSC_DR07_E_RMS90_summary_histogram->GetBinError(1));

  gre_DR07_RMS90_JER_0_65_to_0_80_noSC->SetPoint(1,100,h_200_CT_noSC_DR07_E_RMS90_summary_histogram->GetBinContent(2));
  gre_DR07_RMS90_JER_0_65_to_0_80_noSC->SetPointError(1,0,h_200_CT_noSC_DR07_E_RMS90_summary_histogram->GetBinError(2));

  gre_DR07_RMS90_JER_0_80_to_0_925_noSC->SetPoint(1,100,h_200_CT_noSC_DR07_E_RMS90_summary_histogram->GetBinContent(3));
  gre_DR07_RMS90_JER_0_80_to_0_925_noSC->SetPointError(1,0,h_200_CT_noSC_DR07_E_RMS90_summary_histogram->GetBinError(3));

  gre_DR07_RMS90_JER_0_925_to_1_00_noSC->SetPoint(1,100,h_200_CT_noSC_DR07_E_RMS90_summary_histogram->GetBinContent(4));
  gre_DR07_RMS90_JER_0_925_to_1_00_noSC->SetPointError(1,0,h_200_CT_noSC_DR07_E_RMS90_summary_histogram->GetBinError(4));

  std::cout<<"before 200 CT_wO_noSC"<<std::endl;

  TH1F* h_200_CT_wO_noSC_DR07_E_rel_totVis_RMS_d1_cosT_0_to_0_65 =  new TH1F("h_200_CT_wO_noSC_DR07_E_rel_totVis_RMS_d1_cosT_0_to_0_65","", n_binsJER, lim_E_rel_low,lim_E_rel_high);
  TH1F* h_200_CT_wO_noSC_DR07_E_rel_totVis_RMS_d1_cosT_0_65_to_0_80 =  new TH1F("h_200_CT_wO_noSC_DR07_E_rel_totVis_RMS_d1_cosT_0_65_to_0_80","", n_binsJER, lim_E_rel_low,lim_E_rel_high);
  TH1F* h_200_CT_wO_noSC_DR07_E_rel_totVis_RMS_d1_cosT_0_80_to_0_925 =  new TH1F("h_200_CT_wO_noSC_DR07_E_rel_totVis_RMS_d1_cosT_0_80_to_0_925","", n_binsJER, lim_E_rel_low,lim_E_rel_high);
  TH1F* h_200_CT_wO_noSC_DR07_E_rel_totVis_RMS_d1_cosT_0_925_to_1_00 =  new TH1F("h_200_CT_wO_noSC_DR07_E_rel_totVis_RMS_d1_cosT_0_925_to_1_00","", n_binsJER, lim_E_rel_low,lim_E_rel_high);

  std::vector<TH1F*> hist_vec_200_CT_wO_noSC;
  hist_vec_200_CT_wO_noSC.push_back(h_200_CT_wO_noSC_DR07_E_rel_totVis_RMS_d1_cosT_0_to_0_65);
  hist_vec_200_CT_wO_noSC.push_back(h_200_CT_wO_noSC_DR07_E_rel_totVis_RMS_d1_cosT_0_65_to_0_80);
  hist_vec_200_CT_wO_noSC.push_back(h_200_CT_wO_noSC_DR07_E_rel_totVis_RMS_d1_cosT_0_80_to_0_925);
  hist_vec_200_CT_wO_noSC.push_back(h_200_CT_wO_noSC_DR07_E_rel_totVis_RMS_d1_cosT_0_925_to_1_00);


  for(unsigned int i=0;i<hist_vec_200_CT_wO_noSC.size();i++){
    hist_vec_200_CT_wO_noSC[i]->Sumw2();
  }

  fill_SC_jet_histograms(file_CLIC_200_CT_noSC_wO,hist_vec_200_CT_wO_noSC);

  TH1F* h_200_CT_wO_noSC_DR07_E_RMS90_summary_histogram=new TH1F("JER_RMS90VsCosTheta_CT_wO_noSC_DR07_200", "RMS_{90}(E_{j}^{reco}/E_{j}^{gen}) / Mean_{90}(E_{j}^{reco}/E_{j}^{gen}) vs |cos#theta|", nRegionBinsAngles, pRegionBinEdgesAngles);
  h_200_CT_wO_noSC_DR07_E_RMS90_summary_histogram ->SetYTitle("RMS_{90}(E_{j}^{reco}/E_{j}^{gen}) / Mean_{90}(E_{j}^{reco}/E_{j}^{gen}) [%]");
  h_200_CT_wO_noSC_DR07_E_RMS90_summary_histogram->SetXTitle("|cos#theta|");
  h_200_CT_wO_noSC_DR07_E_RMS90_summary_histogram->SetLineWidth(2);
  h_200_CT_wO_noSC_DR07_E_RMS90_summary_histogram->SetLineColor(kRed);
  h_200_CT_wO_noSC_DR07_E_RMS90_summary_histogram->SetLineStyle(2);
  //for energies still keep sqrt(2) from original total energy calculation
  for(int i=0;i<4;i++){
    resolutionTH1=0; 
    resolutionErrorTH1=0;
    meanTH1=0;
    meanErrorTH1=0;
    CalculatePerformance( hist_vec_200_CT_wO_noSC[i], resolutionTH1, resolutionErrorTH1,meanTH1,meanErrorTH1);
    h_200_CT_wO_noSC_DR07_E_RMS90_summary_histogram->SetBinContent(i+1,resolutionTH1/sqrt(2.));
    h_200_CT_wO_noSC_DR07_E_RMS90_summary_histogram ->SetBinError(i+1, resolutionErrorTH1/sqrt(2.));
  }
  gre_DR07_RMS90_JER_0_65_wO_noSC->SetPoint(1,100,h_200_CT_wO_noSC_DR07_E_RMS90_summary_histogram->GetBinContent(1));
  gre_DR07_RMS90_JER_0_65_wO_noSC->SetPointError(1,0,h_200_CT_wO_noSC_DR07_E_RMS90_summary_histogram->GetBinError(1));

  gre_DR07_RMS90_JER_0_65_to_0_80_wO_noSC->SetPoint(1,100,h_200_CT_wO_noSC_DR07_E_RMS90_summary_histogram->GetBinContent(2));
  gre_DR07_RMS90_JER_0_65_to_0_80_wO_noSC->SetPointError(1,0,h_200_CT_wO_noSC_DR07_E_RMS90_summary_histogram->GetBinError(2));

  gre_DR07_RMS90_JER_0_80_to_0_925_wO_noSC->SetPoint(1,100,h_200_CT_wO_noSC_DR07_E_RMS90_summary_histogram->GetBinContent(3));
  gre_DR07_RMS90_JER_0_80_to_0_925_wO_noSC->SetPointError(1,0,h_200_CT_wO_noSC_DR07_E_RMS90_summary_histogram->GetBinError(3));

  gre_DR07_RMS90_JER_0_925_to_1_00_wO_noSC->SetPoint(1,100,h_200_CT_wO_noSC_DR07_E_RMS90_summary_histogram->GetBinContent(4));
  gre_DR07_RMS90_JER_0_925_to_1_00_wO_noSC->SetPointError(1,0,h_200_CT_wO_noSC_DR07_E_RMS90_summary_histogram->GetBinError(4));


  std::cout<<"before 380 CT_wSC"<<std::endl;

  TH1F* h_380_CT_wSC_DR07_E_rel_totVis_RMS_d1_cosT_0_to_0_65 =  new TH1F("h_380_CT_wSC_DR07_E_rel_totVis_RMS_d1_cosT_0_to_0_65","", n_binsJER, lim_E_rel_low,lim_E_rel_high);
  TH1F* h_380_CT_wSC_DR07_E_rel_totVis_RMS_d1_cosT_0_65_to_0_80 =  new TH1F("h_380_CT_wSC_DR07_E_rel_totVis_RMS_d1_cosT_0_65_to_0_80","", n_binsJER, lim_E_rel_low,lim_E_rel_high);
  TH1F* h_380_CT_wSC_DR07_E_rel_totVis_RMS_d1_cosT_0_80_to_0_925 =  new TH1F("h_380_CT_wSC_DR07_E_rel_totVis_RMS_d1_cosT_0_80_to_0_925","", n_binsJER, lim_E_rel_low,lim_E_rel_high);
  TH1F* h_380_CT_wSC_DR07_E_rel_totVis_RMS_d1_cosT_0_925_to_1_00 =  new TH1F("h_380_CT_wSC_DR07_E_rel_totVis_RMS_d1_cosT_0_925_to_1_00","", n_binsJER, lim_E_rel_low,lim_E_rel_high);

  std::vector<TH1F*> hist_vec_380_CT_wSC;
  hist_vec_380_CT_wSC.push_back(h_380_CT_wSC_DR07_E_rel_totVis_RMS_d1_cosT_0_to_0_65);
  hist_vec_380_CT_wSC.push_back(h_380_CT_wSC_DR07_E_rel_totVis_RMS_d1_cosT_0_65_to_0_80);
  hist_vec_380_CT_wSC.push_back(h_380_CT_wSC_DR07_E_rel_totVis_RMS_d1_cosT_0_80_to_0_925);
  hist_vec_380_CT_wSC.push_back(h_380_CT_wSC_DR07_E_rel_totVis_RMS_d1_cosT_0_925_to_1_00);


  for(unsigned int i=0;i<hist_vec_380_CT_wSC.size();i++){
    hist_vec_380_CT_wSC[i]->Sumw2();
  }
  fill_SC_jet_histograms(file_CLIC_380_CT,hist_vec_380_CT_wSC);

  TH1F* h_380_CT_wSC_DR07_E_RMS90_summary_histogram=new TH1F("JER_RMS90VsCosTheta_CT_wSC_DR07_380", "RMS_{90}(E_{j}^{reco}/E_{j}^{gen}) / Mean_{90}(E_{j}^{reco}/E_{j}^{gen}) vs |cos#theta|", nRegionBinsAngles, pRegionBinEdgesAngles);
  h_380_CT_wSC_DR07_E_RMS90_summary_histogram ->SetYTitle("RMS_{90}(E_{j}^{reco}/E_{j}^{gen}) / Mean_{90}(E_{j}^{reco}/E_{j}^{gen}) [%]");
  h_380_CT_wSC_DR07_E_RMS90_summary_histogram->SetXTitle("|cos#theta|");
  h_380_CT_wSC_DR07_E_RMS90_summary_histogram->SetLineWidth(2);
  h_380_CT_wSC_DR07_E_RMS90_summary_histogram->SetLineColor(kRed);
  h_380_CT_wSC_DR07_E_RMS90_summary_histogram->SetLineStyle(2);
  //for energies still keep sqrt(2) from original total energy calculation
  for(int i=0;i<4;i++){
    resolutionTH1=0; 
    resolutionErrorTH1=0;
    meanTH1=0;
    meanErrorTH1=0;
    CalculatePerformance( hist_vec_380_CT_wSC[i], resolutionTH1, resolutionErrorTH1,meanTH1,meanErrorTH1);
    h_380_CT_wSC_DR07_E_RMS90_summary_histogram->SetBinContent(i+1,resolutionTH1/sqrt(2.));
    h_380_CT_wSC_DR07_E_RMS90_summary_histogram ->SetBinError(i+1, resolutionErrorTH1/sqrt(2.));
  }
  
  gre_DR07_RMS90_JER_0_65_wSC->SetPoint(2,190,h_380_CT_wSC_DR07_E_RMS90_summary_histogram->GetBinContent(1));
  gre_DR07_RMS90_JER_0_65_wSC->SetPointError(2,0,h_380_CT_wSC_DR07_E_RMS90_summary_histogram->GetBinError(1));

  gre_DR07_RMS90_JER_0_65_to_0_80_wSC->SetPoint(2,190,h_380_CT_wSC_DR07_E_RMS90_summary_histogram->GetBinContent(2));
  gre_DR07_RMS90_JER_0_65_to_0_80_wSC->SetPointError(2,0,h_380_CT_wSC_DR07_E_RMS90_summary_histogram->GetBinError(2));

  gre_DR07_RMS90_JER_0_80_to_0_925_wSC->SetPoint(2,190,h_380_CT_wSC_DR07_E_RMS90_summary_histogram->GetBinContent(3));
  gre_DR07_RMS90_JER_0_80_to_0_925_wSC->SetPointError(2,0,h_380_CT_wSC_DR07_E_RMS90_summary_histogram->GetBinError(3));

  gre_DR07_RMS90_JER_0_925_to_1_00_wSC->SetPoint(2,190,h_380_CT_wSC_DR07_E_RMS90_summary_histogram->GetBinContent(4));
  gre_DR07_RMS90_JER_0_925_to_1_00_wSC->SetPointError(2,0,h_380_CT_wSC_DR07_E_RMS90_summary_histogram->GetBinError(4));
  
  std::cout<<"before 380 CT_wO_wSC"<<std::endl;

  TH1F* h_380_CT_wO_wSC_DR07_E_rel_totVis_RMS_d1_cosT_0_to_0_65 =  new TH1F("h_380_CT_wO_wSC_DR07_E_rel_totVis_RMS_d1_cosT_0_to_0_65","", n_binsJER, lim_E_rel_low,lim_E_rel_high);
  TH1F* h_380_CT_wO_wSC_DR07_E_rel_totVis_RMS_d1_cosT_0_65_to_0_80 =  new TH1F("h_380_CT_wO_wSC_DR07_E_rel_totVis_RMS_d1_cosT_0_65_to_0_80","", n_binsJER, lim_E_rel_low,lim_E_rel_high);
  TH1F* h_380_CT_wO_wSC_DR07_E_rel_totVis_RMS_d1_cosT_0_80_to_0_925 =  new TH1F("h_380_CT_wO_wSC_DR07_E_rel_totVis_RMS_d1_cosT_0_80_to_0_925","", n_binsJER, lim_E_rel_low,lim_E_rel_high);
  TH1F* h_380_CT_wO_wSC_DR07_E_rel_totVis_RMS_d1_cosT_0_925_to_1_00 =  new TH1F("h_380_CT_wO_wSC_DR07_E_rel_totVis_RMS_d1_cosT_0_925_to_1_00","", n_binsJER, lim_E_rel_low,lim_E_rel_high);

  std::vector<TH1F*> hist_vec_380_CT_wO_wSC;
  hist_vec_380_CT_wO_wSC.push_back(h_380_CT_wO_wSC_DR07_E_rel_totVis_RMS_d1_cosT_0_to_0_65);
  hist_vec_380_CT_wO_wSC.push_back(h_380_CT_wO_wSC_DR07_E_rel_totVis_RMS_d1_cosT_0_65_to_0_80);
  hist_vec_380_CT_wO_wSC.push_back(h_380_CT_wO_wSC_DR07_E_rel_totVis_RMS_d1_cosT_0_80_to_0_925);
  hist_vec_380_CT_wO_wSC.push_back(h_380_CT_wO_wSC_DR07_E_rel_totVis_RMS_d1_cosT_0_925_to_1_00);


  for(unsigned int i=0;i<hist_vec_380_CT_wO_wSC.size();i++){
    hist_vec_380_CT_wO_wSC[i]->Sumw2();
  }
  fill_SC_jet_histograms(file_CLIC_380_CT_wO,hist_vec_380_CT_wO_wSC);

  TH1F* h_380_CT_wO_wSC_DR07_E_RMS90_summary_histogram=new TH1F("JER_RMS90VsCosTheta_CT_wO_wSC_DR07_380", "RMS_{90}(E_{j}^{reco}/E_{j}^{gen}) / Mean_{90}(E_{j}^{reco}/E_{j}^{gen}) vs |cos#theta|", nRegionBinsAngles, pRegionBinEdgesAngles);
  h_380_CT_wO_wSC_DR07_E_RMS90_summary_histogram ->SetYTitle("RMS_{90}(E_{j}^{reco}/E_{j}^{gen}) / Mean_{90}(E_{j}^{reco}/E_{j}^{gen}) [%]");
  h_380_CT_wO_wSC_DR07_E_RMS90_summary_histogram->SetXTitle("|cos#theta|");
  h_380_CT_wO_wSC_DR07_E_RMS90_summary_histogram->SetLineWidth(2);
  h_380_CT_wO_wSC_DR07_E_RMS90_summary_histogram->SetLineColor(kRed);
  h_380_CT_wO_wSC_DR07_E_RMS90_summary_histogram->SetLineStyle(2);
  //for energies still keep sqrt(2) from original total energy calculation
  for(int i=0;i<4;i++){
    resolutionTH1=0; 
    resolutionErrorTH1=0;
    meanTH1=0;
    meanErrorTH1=0;
    CalculatePerformance( hist_vec_380_CT_wO_wSC[i], resolutionTH1, resolutionErrorTH1,meanTH1,meanErrorTH1);
    h_380_CT_wO_wSC_DR07_E_RMS90_summary_histogram->SetBinContent(i+1,resolutionTH1/sqrt(2.));
    h_380_CT_wO_wSC_DR07_E_RMS90_summary_histogram ->SetBinError(i+1, resolutionErrorTH1/sqrt(2.));
  }
  
  gre_DR07_RMS90_JER_0_65_wO_wSC->SetPoint(2,190,h_380_CT_wO_wSC_DR07_E_RMS90_summary_histogram->GetBinContent(1));
  gre_DR07_RMS90_JER_0_65_wO_wSC->SetPointError(2,0,h_380_CT_wO_wSC_DR07_E_RMS90_summary_histogram->GetBinError(1));

  gre_DR07_RMS90_JER_0_65_to_0_80_wO_wSC->SetPoint(2,190,h_380_CT_wO_wSC_DR07_E_RMS90_summary_histogram->GetBinContent(2));
  gre_DR07_RMS90_JER_0_65_to_0_80_wO_wSC->SetPointError(2,0,h_380_CT_wO_wSC_DR07_E_RMS90_summary_histogram->GetBinError(2));

  gre_DR07_RMS90_JER_0_80_to_0_925_wO_wSC->SetPoint(2,190,h_380_CT_wO_wSC_DR07_E_RMS90_summary_histogram->GetBinContent(3));
  gre_DR07_RMS90_JER_0_80_to_0_925_wO_wSC->SetPointError(2,0,h_380_CT_wO_wSC_DR07_E_RMS90_summary_histogram->GetBinError(3));

  gre_DR07_RMS90_JER_0_925_to_1_00_wO_wSC->SetPoint(2,190,h_380_CT_wO_wSC_DR07_E_RMS90_summary_histogram->GetBinContent(4));
  gre_DR07_RMS90_JER_0_925_to_1_00_wO_wSC->SetPointError(2,0,h_380_CT_wO_wSC_DR07_E_RMS90_summary_histogram->GetBinError(4));
  

  std::cout<<"before 380 CT_noSC"<<std::endl;

  TH1F* h_380_CT_noSC_DR07_E_rel_totVis_RMS_d1_cosT_0_to_0_65 =  new TH1F("h_380_CT_noSC_DR07_E_rel_totVis_RMS_d1_cosT_0_to_0_65","", n_binsJER, lim_E_rel_low,lim_E_rel_high);
  TH1F* h_380_CT_noSC_DR07_E_rel_totVis_RMS_d1_cosT_0_65_to_0_80 =  new TH1F("h_380_CT_noSC_DR07_E_rel_totVis_RMS_d1_cosT_0_65_to_0_80","", n_binsJER, lim_E_rel_low,lim_E_rel_high);
  TH1F* h_380_CT_noSC_DR07_E_rel_totVis_RMS_d1_cosT_0_80_to_0_925 =  new TH1F("h_380_CT_noSC_DR07_E_rel_totVis_RMS_d1_cosT_0_80_to_0_925","", n_binsJER, lim_E_rel_low,lim_E_rel_high);
  TH1F* h_380_CT_noSC_DR07_E_rel_totVis_RMS_d1_cosT_0_925_to_1_00 =  new TH1F("h_380_CT_noSC_DR07_E_rel_totVis_RMS_d1_cosT_0_925_to_1_00","", n_binsJER, lim_E_rel_low,lim_E_rel_high);

  std::vector<TH1F*> hist_vec_380_CT_noSC;
  hist_vec_380_CT_noSC.push_back(h_380_CT_noSC_DR07_E_rel_totVis_RMS_d1_cosT_0_to_0_65);
  hist_vec_380_CT_noSC.push_back(h_380_CT_noSC_DR07_E_rel_totVis_RMS_d1_cosT_0_65_to_0_80);
  hist_vec_380_CT_noSC.push_back(h_380_CT_noSC_DR07_E_rel_totVis_RMS_d1_cosT_0_80_to_0_925);
  hist_vec_380_CT_noSC.push_back(h_380_CT_noSC_DR07_E_rel_totVis_RMS_d1_cosT_0_925_to_1_00);


  for(unsigned int i=0;i<hist_vec_380_CT_noSC.size();i++){
    hist_vec_380_CT_noSC[i]->Sumw2();
  }

  fill_SC_jet_histograms(file_CLIC_380_CT_noSC,hist_vec_380_CT_noSC);

  TH1F* h_380_CT_noSC_DR07_E_RMS90_summary_histogram=new TH1F("JER_RMS90VsCosTheta_CT_noSC_DR07_380", "RMS_{90}(E_{j}^{reco}/E_{j}^{gen}) / Mean_{90}(E_{j}^{reco}/E_{j}^{gen}) vs |cos#theta|", nRegionBinsAngles, pRegionBinEdgesAngles);
  h_380_CT_noSC_DR07_E_RMS90_summary_histogram ->SetYTitle("RMS_{90}(E_{j}^{reco}/E_{j}^{gen}) / Mean_{90}(E_{j}^{reco}/E_{j}^{gen}) [%]");
  h_380_CT_noSC_DR07_E_RMS90_summary_histogram->SetXTitle("|cos#theta|");
  h_380_CT_noSC_DR07_E_RMS90_summary_histogram->SetLineWidth(2);
  h_380_CT_noSC_DR07_E_RMS90_summary_histogram->SetLineColor(kRed);
  h_380_CT_noSC_DR07_E_RMS90_summary_histogram->SetLineStyle(2);
  //for energies still keep sqrt(2) from original total energy calculation
  for(int i=0;i<4;i++){
    resolutionTH1=0; 
    resolutionErrorTH1=0;
    meanTH1=0;
    meanErrorTH1=0;
    CalculatePerformance( hist_vec_380_CT_noSC[i], resolutionTH1, resolutionErrorTH1,meanTH1,meanErrorTH1);
    h_380_CT_noSC_DR07_E_RMS90_summary_histogram->SetBinContent(i+1,resolutionTH1/sqrt(2.));
    h_380_CT_noSC_DR07_E_RMS90_summary_histogram ->SetBinError(i+1, resolutionErrorTH1/sqrt(2.));
  }
  
  gre_DR07_RMS90_JER_0_65_noSC->SetPoint(2,190,h_380_CT_noSC_DR07_E_RMS90_summary_histogram->GetBinContent(1));
  gre_DR07_RMS90_JER_0_65_noSC->SetPointError(2,0,h_380_CT_noSC_DR07_E_RMS90_summary_histogram->GetBinError(1));

  gre_DR07_RMS90_JER_0_65_to_0_80_noSC->SetPoint(2,190,h_380_CT_noSC_DR07_E_RMS90_summary_histogram->GetBinContent(2));
  gre_DR07_RMS90_JER_0_65_to_0_80_noSC->SetPointError(2,0,h_380_CT_noSC_DR07_E_RMS90_summary_histogram->GetBinError(2));

  gre_DR07_RMS90_JER_0_80_to_0_925_noSC->SetPoint(2,190,h_380_CT_noSC_DR07_E_RMS90_summary_histogram->GetBinContent(3));
  gre_DR07_RMS90_JER_0_80_to_0_925_noSC->SetPointError(2,0,h_380_CT_noSC_DR07_E_RMS90_summary_histogram->GetBinError(3));

  gre_DR07_RMS90_JER_0_925_to_1_00_noSC->SetPoint(2,190,h_380_CT_noSC_DR07_E_RMS90_summary_histogram->GetBinContent(4));
  gre_DR07_RMS90_JER_0_925_to_1_00_noSC->SetPointError(2,0,h_380_CT_noSC_DR07_E_RMS90_summary_histogram->GetBinError(4));
  
  std::cout<<"before 380 CT_wO_noSC"<<std::endl;

  TH1F* h_380_CT_wO_noSC_DR07_E_rel_totVis_RMS_d1_cosT_0_to_0_65 =  new TH1F("h_380_CT_wO_noSC_DR07_E_rel_totVis_RMS_d1_cosT_0_to_0_65","", n_binsJER, lim_E_rel_low,lim_E_rel_high);
  TH1F* h_380_CT_wO_noSC_DR07_E_rel_totVis_RMS_d1_cosT_0_65_to_0_80 =  new TH1F("h_380_CT_wO_noSC_DR07_E_rel_totVis_RMS_d1_cosT_0_65_to_0_80","", n_binsJER, lim_E_rel_low,lim_E_rel_high);
  TH1F* h_380_CT_wO_noSC_DR07_E_rel_totVis_RMS_d1_cosT_0_80_to_0_925 =  new TH1F("h_380_CT_wO_noSC_DR07_E_rel_totVis_RMS_d1_cosT_0_80_to_0_925","", n_binsJER, lim_E_rel_low,lim_E_rel_high);
  TH1F* h_380_CT_wO_noSC_DR07_E_rel_totVis_RMS_d1_cosT_0_925_to_1_00 =  new TH1F("h_380_CT_wO_noSC_DR07_E_rel_totVis_RMS_d1_cosT_0_925_to_1_00","", n_binsJER, lim_E_rel_low,lim_E_rel_high);

  std::vector<TH1F*> hist_vec_380_CT_wO_noSC;
  hist_vec_380_CT_wO_noSC.push_back(h_380_CT_wO_noSC_DR07_E_rel_totVis_RMS_d1_cosT_0_to_0_65);
  hist_vec_380_CT_wO_noSC.push_back(h_380_CT_wO_noSC_DR07_E_rel_totVis_RMS_d1_cosT_0_65_to_0_80);
  hist_vec_380_CT_wO_noSC.push_back(h_380_CT_wO_noSC_DR07_E_rel_totVis_RMS_d1_cosT_0_80_to_0_925);
  hist_vec_380_CT_wO_noSC.push_back(h_380_CT_wO_noSC_DR07_E_rel_totVis_RMS_d1_cosT_0_925_to_1_00);


  for(unsigned int i=0;i<hist_vec_380_CT_wO_noSC.size();i++){
    hist_vec_380_CT_wO_noSC[i]->Sumw2();
  }

  fill_SC_jet_histograms(file_CLIC_380_CT_noSC_wO,hist_vec_380_CT_wO_noSC);

  TH1F* h_380_CT_wO_noSC_DR07_E_RMS90_summary_histogram=new TH1F("JER_RMS90VsCosTheta_CT_wO_noSC_DR07_380", "RMS_{90}(E_{j}^{reco}/E_{j}^{gen}) / Mean_{90}(E_{j}^{reco}/E_{j}^{gen}) vs |cos#theta|", nRegionBinsAngles, pRegionBinEdgesAngles);
  h_380_CT_wO_noSC_DR07_E_RMS90_summary_histogram ->SetYTitle("RMS_{90}(E_{j}^{reco}/E_{j}^{gen}) / Mean_{90}(E_{j}^{reco}/E_{j}^{gen}) [%]");
  h_380_CT_wO_noSC_DR07_E_RMS90_summary_histogram->SetXTitle("|cos#theta|");
  h_380_CT_wO_noSC_DR07_E_RMS90_summary_histogram->SetLineWidth(2);
  h_380_CT_wO_noSC_DR07_E_RMS90_summary_histogram->SetLineColor(kRed);
  h_380_CT_wO_noSC_DR07_E_RMS90_summary_histogram->SetLineStyle(2);
  //for energies still keep sqrt(2) from original total energy calculation
  for(int i=0;i<4;i++){
    resolutionTH1=0; 
    resolutionErrorTH1=0;
    meanTH1=0;
    meanErrorTH1=0;
    CalculatePerformance( hist_vec_380_CT_wO_noSC[i], resolutionTH1, resolutionErrorTH1,meanTH1,meanErrorTH1);
    h_380_CT_wO_noSC_DR07_E_RMS90_summary_histogram->SetBinContent(i+1,resolutionTH1/sqrt(2.));
    h_380_CT_wO_noSC_DR07_E_RMS90_summary_histogram ->SetBinError(i+1, resolutionErrorTH1/sqrt(2.));
  }
  
  gre_DR07_RMS90_JER_0_65_wO_noSC->SetPoint(2,190,h_380_CT_wO_noSC_DR07_E_RMS90_summary_histogram->GetBinContent(1));
  gre_DR07_RMS90_JER_0_65_wO_noSC->SetPointError(2,0,h_380_CT_wO_noSC_DR07_E_RMS90_summary_histogram->GetBinError(1));

  gre_DR07_RMS90_JER_0_65_to_0_80_wO_noSC->SetPoint(2,190,h_380_CT_wO_noSC_DR07_E_RMS90_summary_histogram->GetBinContent(2));
  gre_DR07_RMS90_JER_0_65_to_0_80_wO_noSC->SetPointError(2,0,h_380_CT_wO_noSC_DR07_E_RMS90_summary_histogram->GetBinError(2));

  gre_DR07_RMS90_JER_0_80_to_0_925_wO_noSC->SetPoint(2,190,h_380_CT_wO_noSC_DR07_E_RMS90_summary_histogram->GetBinContent(3));
  gre_DR07_RMS90_JER_0_80_to_0_925_wO_noSC->SetPointError(2,0,h_380_CT_wO_noSC_DR07_E_RMS90_summary_histogram->GetBinError(3));

  gre_DR07_RMS90_JER_0_925_to_1_00_wO_noSC->SetPoint(2,190,h_380_CT_wO_noSC_DR07_E_RMS90_summary_histogram->GetBinContent(4));
  gre_DR07_RMS90_JER_0_925_to_1_00_wO_noSC->SetPointError(2,0,h_380_CT_wO_noSC_DR07_E_RMS90_summary_histogram->GetBinError(4));
  


  std::cout<<"before 500 CT_wSC"<<std::endl;

  TH1F* h_500_CT_wSC_DR07_E_rel_totVis_RMS_d1_cosT_0_to_0_65 =  new TH1F("h_500_CT_wSC_DR07_E_rel_totVis_RMS_d1_cosT_0_to_0_65","", n_binsJER, lim_E_rel_low,lim_E_rel_high);
  TH1F* h_500_CT_wSC_DR07_E_rel_totVis_RMS_d1_cosT_0_65_to_0_80 =  new TH1F("h_500_CT_wSC_DR07_E_rel_totVis_RMS_d1_cosT_0_65_to_0_80","", n_binsJER, lim_E_rel_low,lim_E_rel_high);
  TH1F* h_500_CT_wSC_DR07_E_rel_totVis_RMS_d1_cosT_0_80_to_0_925 =  new TH1F("h_500_CT_wSC_DR07_E_rel_totVis_RMS_d1_cosT_0_80_to_0_925","", n_binsJER, lim_E_rel_low,lim_E_rel_high);
  TH1F* h_500_CT_wSC_DR07_E_rel_totVis_RMS_d1_cosT_0_925_to_1_00 =  new TH1F("h_500_CT_wSC_DR07_E_rel_totVis_RMS_d1_cosT_0_925_to_1_00","", n_binsJER, lim_E_rel_low,lim_E_rel_high);

  std::vector<TH1F*> hist_vec_500_CT_wSC;
  hist_vec_500_CT_wSC.push_back(h_500_CT_wSC_DR07_E_rel_totVis_RMS_d1_cosT_0_to_0_65);
  hist_vec_500_CT_wSC.push_back(h_500_CT_wSC_DR07_E_rel_totVis_RMS_d1_cosT_0_65_to_0_80);
  hist_vec_500_CT_wSC.push_back(h_500_CT_wSC_DR07_E_rel_totVis_RMS_d1_cosT_0_80_to_0_925);
  hist_vec_500_CT_wSC.push_back(h_500_CT_wSC_DR07_E_rel_totVis_RMS_d1_cosT_0_925_to_1_00);


  for(unsigned int i=0;i<hist_vec_500_CT_wSC.size();i++){
    hist_vec_500_CT_wSC[i]->Sumw2();
  }
  fill_SC_jet_histograms(file_CLIC_500_CT,hist_vec_500_CT_wSC);

  TH1F* h_500_CT_wSC_DR07_E_RMS90_summary_histogram=new TH1F("JER_RMS90VsCosTheta_CT_wSC_DR07_500", "RMS_{90}(E_{j}^{reco}/E_{j}^{gen}) / Mean_{90}(E_{j}^{reco}/E_{j}^{gen}) vs |cos#theta|", nRegionBinsAngles, pRegionBinEdgesAngles);
  h_500_CT_wSC_DR07_E_RMS90_summary_histogram ->SetYTitle("RMS_{90}(E_{j}^{reco}/E_{j}^{gen}) / Mean_{90}(E_{j}^{reco}/E_{j}^{gen}) [%]");
  h_500_CT_wSC_DR07_E_RMS90_summary_histogram->SetXTitle("|cos#theta|");
  h_500_CT_wSC_DR07_E_RMS90_summary_histogram->SetLineWidth(2);
  h_500_CT_wSC_DR07_E_RMS90_summary_histogram->SetLineColor(kRed);
  h_500_CT_wSC_DR07_E_RMS90_summary_histogram->SetLineStyle(2);
  //for energies still keep sqrt(2) from original total energy calculation
  for(int i=0;i<4;i++){
    resolutionTH1=0; 
    resolutionErrorTH1=0;
    meanTH1=0;
    meanErrorTH1=0;
    CalculatePerformance( hist_vec_500_CT_wSC[i], resolutionTH1, resolutionErrorTH1,meanTH1,meanErrorTH1);
    h_500_CT_wSC_DR07_E_RMS90_summary_histogram->SetBinContent(i+1,resolutionTH1/sqrt(2.));
    h_500_CT_wSC_DR07_E_RMS90_summary_histogram ->SetBinError(i+1, resolutionErrorTH1/sqrt(2.));
  }
  /*
  gre_DR07_RMS90_JER_0_65_wSC->SetPoint(2,250,h_500_CT_wSC_DR07_E_RMS90_summary_histogram->GetBinContent(1));
  gre_DR07_RMS90_JER_0_65_wSC->SetPointError(2,0,h_500_CT_wSC_DR07_E_RMS90_summary_histogram->GetBinError(1));

  gre_DR07_RMS90_JER_0_65_to_0_80_wSC->SetPoint(2,250,h_500_CT_wSC_DR07_E_RMS90_summary_histogram->GetBinContent(2));
  gre_DR07_RMS90_JER_0_65_to_0_80_wSC->SetPointError(2,0,h_500_CT_wSC_DR07_E_RMS90_summary_histogram->GetBinError(2));

  gre_DR07_RMS90_JER_0_80_to_0_925_wSC->SetPoint(2,250,h_500_CT_wSC_DR07_E_RMS90_summary_histogram->GetBinContent(3));
  gre_DR07_RMS90_JER_0_80_to_0_925_wSC->SetPointError(2,0,h_500_CT_wSC_DR07_E_RMS90_summary_histogram->GetBinError(3));

  gre_DR07_RMS90_JER_0_925_to_1_00_wSC->SetPoint(2,250,h_500_CT_wSC_DR07_E_RMS90_summary_histogram->GetBinContent(4));
  gre_DR07_RMS90_JER_0_925_to_1_00_wSC->SetPointError(2,0,h_500_CT_wSC_DR07_E_RMS90_summary_histogram->GetBinError(4));
  */
  gre_DR07_RMS90_JER_0_65_wSC->SetPoint(3,250,h_500_CT_wSC_DR07_E_RMS90_summary_histogram->GetBinContent(1));
  gre_DR07_RMS90_JER_0_65_wSC->SetPointError(3,0,h_500_CT_wSC_DR07_E_RMS90_summary_histogram->GetBinError(1));

  gre_DR07_RMS90_JER_0_65_to_0_80_wSC->SetPoint(3,250,h_500_CT_wSC_DR07_E_RMS90_summary_histogram->GetBinContent(2));
  gre_DR07_RMS90_JER_0_65_to_0_80_wSC->SetPointError(3,0,h_500_CT_wSC_DR07_E_RMS90_summary_histogram->GetBinError(2));

  gre_DR07_RMS90_JER_0_80_to_0_925_wSC->SetPoint(3,250,h_500_CT_wSC_DR07_E_RMS90_summary_histogram->GetBinContent(3));
  gre_DR07_RMS90_JER_0_80_to_0_925_wSC->SetPointError(3,0,h_500_CT_wSC_DR07_E_RMS90_summary_histogram->GetBinError(3));

  gre_DR07_RMS90_JER_0_925_to_1_00_wSC->SetPoint(3,250,h_500_CT_wSC_DR07_E_RMS90_summary_histogram->GetBinContent(4));
  gre_DR07_RMS90_JER_0_925_to_1_00_wSC->SetPointError(3,0,h_500_CT_wSC_DR07_E_RMS90_summary_histogram->GetBinError(4));
  
  std::cout<<"before 500 CT_wO_wSC"<<std::endl;

  TH1F* h_500_CT_wO_wSC_DR07_E_rel_totVis_RMS_d1_cosT_0_to_0_65 =  new TH1F("h_500_CT_wO_wSC_DR07_E_rel_totVis_RMS_d1_cosT_0_to_0_65","", n_binsJER, lim_E_rel_low,lim_E_rel_high);
  TH1F* h_500_CT_wO_wSC_DR07_E_rel_totVis_RMS_d1_cosT_0_65_to_0_80 =  new TH1F("h_500_CT_wO_wSC_DR07_E_rel_totVis_RMS_d1_cosT_0_65_to_0_80","", n_binsJER, lim_E_rel_low,lim_E_rel_high);
  TH1F* h_500_CT_wO_wSC_DR07_E_rel_totVis_RMS_d1_cosT_0_80_to_0_925 =  new TH1F("h_500_CT_wO_wSC_DR07_E_rel_totVis_RMS_d1_cosT_0_80_to_0_925","", n_binsJER, lim_E_rel_low,lim_E_rel_high);
  TH1F* h_500_CT_wO_wSC_DR07_E_rel_totVis_RMS_d1_cosT_0_925_to_1_00 =  new TH1F("h_500_CT_wO_wSC_DR07_E_rel_totVis_RMS_d1_cosT_0_925_to_1_00","", n_binsJER, lim_E_rel_low,lim_E_rel_high);

  std::vector<TH1F*> hist_vec_500_CT_wO_wSC;
  hist_vec_500_CT_wO_wSC.push_back(h_500_CT_wO_wSC_DR07_E_rel_totVis_RMS_d1_cosT_0_to_0_65);
  hist_vec_500_CT_wO_wSC.push_back(h_500_CT_wO_wSC_DR07_E_rel_totVis_RMS_d1_cosT_0_65_to_0_80);
  hist_vec_500_CT_wO_wSC.push_back(h_500_CT_wO_wSC_DR07_E_rel_totVis_RMS_d1_cosT_0_80_to_0_925);
  hist_vec_500_CT_wO_wSC.push_back(h_500_CT_wO_wSC_DR07_E_rel_totVis_RMS_d1_cosT_0_925_to_1_00);


  for(unsigned int i=0;i<hist_vec_500_CT_wO_wSC.size();i++){
    hist_vec_500_CT_wO_wSC[i]->Sumw2();
  }
  fill_SC_jet_histograms(file_CLIC_500_CT_wO,hist_vec_500_CT_wO_wSC);

  TH1F* h_500_CT_wO_wSC_DR07_E_RMS90_summary_histogram=new TH1F("JER_RMS90VsCosTheta_CT_wO_wSC_DR07_500", "RMS_{90}(E_{j}^{reco}/E_{j}^{gen}) / Mean_{90}(E_{j}^{reco}/E_{j}^{gen}) vs |cos#theta|", nRegionBinsAngles, pRegionBinEdgesAngles);
  h_500_CT_wO_wSC_DR07_E_RMS90_summary_histogram ->SetYTitle("RMS_{90}(E_{j}^{reco}/E_{j}^{gen}) / Mean_{90}(E_{j}^{reco}/E_{j}^{gen}) [%]");
  h_500_CT_wO_wSC_DR07_E_RMS90_summary_histogram->SetXTitle("|cos#theta|");
  h_500_CT_wO_wSC_DR07_E_RMS90_summary_histogram->SetLineWidth(2);
  h_500_CT_wO_wSC_DR07_E_RMS90_summary_histogram->SetLineColor(kRed);
  h_500_CT_wO_wSC_DR07_E_RMS90_summary_histogram->SetLineStyle(2);
  //for energies still keep sqrt(2) from original total energy calculation
  for(int i=0;i<4;i++){
    resolutionTH1=0; 
    resolutionErrorTH1=0;
    meanTH1=0;
    meanErrorTH1=0;
    CalculatePerformance( hist_vec_500_CT_wO_wSC[i], resolutionTH1, resolutionErrorTH1,meanTH1,meanErrorTH1);
    h_500_CT_wO_wSC_DR07_E_RMS90_summary_histogram->SetBinContent(i+1,resolutionTH1/sqrt(2.));
    h_500_CT_wO_wSC_DR07_E_RMS90_summary_histogram ->SetBinError(i+1, resolutionErrorTH1/sqrt(2.));
  }
  gre_DR07_RMS90_JER_0_65_wO_wSC->SetPoint(3,250,h_500_CT_wO_wSC_DR07_E_RMS90_summary_histogram->GetBinContent(1));
  gre_DR07_RMS90_JER_0_65_wO_wSC->SetPointError(3,0,h_500_CT_wO_wSC_DR07_E_RMS90_summary_histogram->GetBinError(1));

  gre_DR07_RMS90_JER_0_65_to_0_80_wO_wSC->SetPoint(3,250,h_500_CT_wO_wSC_DR07_E_RMS90_summary_histogram->GetBinContent(2));
  gre_DR07_RMS90_JER_0_65_to_0_80_wO_wSC->SetPointError(3,0,h_500_CT_wO_wSC_DR07_E_RMS90_summary_histogram->GetBinError(2));

  gre_DR07_RMS90_JER_0_80_to_0_925_wO_wSC->SetPoint(3,250,h_500_CT_wO_wSC_DR07_E_RMS90_summary_histogram->GetBinContent(3));
  gre_DR07_RMS90_JER_0_80_to_0_925_wO_wSC->SetPointError(3,0,h_500_CT_wO_wSC_DR07_E_RMS90_summary_histogram->GetBinError(3));

  gre_DR07_RMS90_JER_0_925_to_1_00_wO_wSC->SetPoint(3,250,h_500_CT_wO_wSC_DR07_E_RMS90_summary_histogram->GetBinContent(4));
  gre_DR07_RMS90_JER_0_925_to_1_00_wO_wSC->SetPointError(3,0,h_500_CT_wO_wSC_DR07_E_RMS90_summary_histogram->GetBinError(4));


  std::cout<<"before 500 CT_noSC"<<std::endl;

  TH1F* h_500_CT_noSC_DR07_E_rel_totVis_RMS_d1_cosT_0_to_0_65 =  new TH1F("h_500_CT_noSC_DR07_E_rel_totVis_RMS_d1_cosT_0_to_0_65","", n_binsJER, lim_E_rel_low,lim_E_rel_high);
  TH1F* h_500_CT_noSC_DR07_E_rel_totVis_RMS_d1_cosT_0_65_to_0_80 =  new TH1F("h_500_CT_noSC_DR07_E_rel_totVis_RMS_d1_cosT_0_65_to_0_80","", n_binsJER, lim_E_rel_low,lim_E_rel_high);
  TH1F* h_500_CT_noSC_DR07_E_rel_totVis_RMS_d1_cosT_0_80_to_0_925 =  new TH1F("h_500_CT_noSC_DR07_E_rel_totVis_RMS_d1_cosT_0_80_to_0_925","", n_binsJER, lim_E_rel_low,lim_E_rel_high);
  TH1F* h_500_CT_noSC_DR07_E_rel_totVis_RMS_d1_cosT_0_925_to_1_00 =  new TH1F("h_500_CT_noSC_DR07_E_rel_totVis_RMS_d1_cosT_0_925_to_1_00","", n_binsJER, lim_E_rel_low,lim_E_rel_high);

  std::vector<TH1F*> hist_vec_500_CT_noSC;
  hist_vec_500_CT_noSC.push_back(h_500_CT_noSC_DR07_E_rel_totVis_RMS_d1_cosT_0_to_0_65);
  hist_vec_500_CT_noSC.push_back(h_500_CT_noSC_DR07_E_rel_totVis_RMS_d1_cosT_0_65_to_0_80);
  hist_vec_500_CT_noSC.push_back(h_500_CT_noSC_DR07_E_rel_totVis_RMS_d1_cosT_0_80_to_0_925);
  hist_vec_500_CT_noSC.push_back(h_500_CT_noSC_DR07_E_rel_totVis_RMS_d1_cosT_0_925_to_1_00);


  for(unsigned int i=0;i<hist_vec_500_CT_noSC.size();i++){
    hist_vec_500_CT_noSC[i]->Sumw2();
  }

  fill_SC_jet_histograms(file_CLIC_500_CT_noSC,hist_vec_500_CT_noSC);

  TH1F* h_500_CT_noSC_DR07_E_RMS90_summary_histogram=new TH1F("JER_RMS90VsCosTheta_CT_noSC_DR07_500", "RMS_{90}(E_{j}^{reco}/E_{j}^{gen}) / Mean_{90}(E_{j}^{reco}/E_{j}^{gen}) vs |cos#theta|", nRegionBinsAngles, pRegionBinEdgesAngles);
  h_500_CT_noSC_DR07_E_RMS90_summary_histogram ->SetYTitle("RMS_{90}(E_{j}^{reco}/E_{j}^{gen}) / Mean_{90}(E_{j}^{reco}/E_{j}^{gen}) [%]");
  h_500_CT_noSC_DR07_E_RMS90_summary_histogram->SetXTitle("|cos#theta|");
  h_500_CT_noSC_DR07_E_RMS90_summary_histogram->SetLineWidth(2);
  h_500_CT_noSC_DR07_E_RMS90_summary_histogram->SetLineColor(kRed);
  h_500_CT_noSC_DR07_E_RMS90_summary_histogram->SetLineStyle(2);
  //for energies still keep sqrt(2) from original total energy calculation
  for(int i=0;i<4;i++){
    resolutionTH1=0; 
    resolutionErrorTH1=0;
    meanTH1=0;
    meanErrorTH1=0;
    CalculatePerformance( hist_vec_500_CT_noSC[i], resolutionTH1, resolutionErrorTH1,meanTH1,meanErrorTH1);
    h_500_CT_noSC_DR07_E_RMS90_summary_histogram->SetBinContent(i+1,resolutionTH1/sqrt(2.));
    h_500_CT_noSC_DR07_E_RMS90_summary_histogram ->SetBinError(i+1, resolutionErrorTH1/sqrt(2.));
  }
  gre_DR07_RMS90_JER_0_65_noSC->SetPoint(3,250,h_500_CT_noSC_DR07_E_RMS90_summary_histogram->GetBinContent(1));
  gre_DR07_RMS90_JER_0_65_noSC->SetPointError(3,0,h_500_CT_noSC_DR07_E_RMS90_summary_histogram->GetBinError(1));

  gre_DR07_RMS90_JER_0_65_to_0_80_noSC->SetPoint(3,250,h_500_CT_noSC_DR07_E_RMS90_summary_histogram->GetBinContent(2));
  gre_DR07_RMS90_JER_0_65_to_0_80_noSC->SetPointError(3,0,h_500_CT_noSC_DR07_E_RMS90_summary_histogram->GetBinError(2));

  gre_DR07_RMS90_JER_0_80_to_0_925_noSC->SetPoint(3,250,h_500_CT_noSC_DR07_E_RMS90_summary_histogram->GetBinContent(3));
  gre_DR07_RMS90_JER_0_80_to_0_925_noSC->SetPointError(3,0,h_500_CT_noSC_DR07_E_RMS90_summary_histogram->GetBinError(3));

  gre_DR07_RMS90_JER_0_925_to_1_00_noSC->SetPoint(3,250,h_500_CT_noSC_DR07_E_RMS90_summary_histogram->GetBinContent(4));
  gre_DR07_RMS90_JER_0_925_to_1_00_noSC->SetPointError(3,0,h_500_CT_noSC_DR07_E_RMS90_summary_histogram->GetBinError(4));

  std::cout<<"before 500 CT_wO_noSC"<<std::endl;

  TH1F* h_500_CT_wO_noSC_DR07_E_rel_totVis_RMS_d1_cosT_0_to_0_65 =  new TH1F("h_500_CT_wO_noSC_DR07_E_rel_totVis_RMS_d1_cosT_0_to_0_65","", n_binsJER, lim_E_rel_low,lim_E_rel_high);
  TH1F* h_500_CT_wO_noSC_DR07_E_rel_totVis_RMS_d1_cosT_0_65_to_0_80 =  new TH1F("h_500_CT_wO_noSC_DR07_E_rel_totVis_RMS_d1_cosT_0_65_to_0_80","", n_binsJER, lim_E_rel_low,lim_E_rel_high);
  TH1F* h_500_CT_wO_noSC_DR07_E_rel_totVis_RMS_d1_cosT_0_80_to_0_925 =  new TH1F("h_500_CT_wO_noSC_DR07_E_rel_totVis_RMS_d1_cosT_0_80_to_0_925","", n_binsJER, lim_E_rel_low,lim_E_rel_high);
  TH1F* h_500_CT_wO_noSC_DR07_E_rel_totVis_RMS_d1_cosT_0_925_to_1_00 =  new TH1F("h_500_CT_wO_noSC_DR07_E_rel_totVis_RMS_d1_cosT_0_925_to_1_00","", n_binsJER, lim_E_rel_low,lim_E_rel_high);

  std::vector<TH1F*> hist_vec_500_CT_wO_noSC;
  hist_vec_500_CT_wO_noSC.push_back(h_500_CT_wO_noSC_DR07_E_rel_totVis_RMS_d1_cosT_0_to_0_65);
  hist_vec_500_CT_wO_noSC.push_back(h_500_CT_wO_noSC_DR07_E_rel_totVis_RMS_d1_cosT_0_65_to_0_80);
  hist_vec_500_CT_wO_noSC.push_back(h_500_CT_wO_noSC_DR07_E_rel_totVis_RMS_d1_cosT_0_80_to_0_925);
  hist_vec_500_CT_wO_noSC.push_back(h_500_CT_wO_noSC_DR07_E_rel_totVis_RMS_d1_cosT_0_925_to_1_00);


  for(unsigned int i=0;i<hist_vec_500_CT_wO_noSC.size();i++){
    hist_vec_500_CT_wO_noSC[i]->Sumw2();
  }

  fill_SC_jet_histograms(file_CLIC_500_CT_noSC_wO,hist_vec_500_CT_wO_noSC);

  TH1F* h_500_CT_wO_noSC_DR07_E_RMS90_summary_histogram=new TH1F("JER_RMS90VsCosTheta_CT_wO_noSC_DR07_500", "RMS_{90}(E_{j}^{reco}/E_{j}^{gen}) / Mean_{90}(E_{j}^{reco}/E_{j}^{gen}) vs |cos#theta|", nRegionBinsAngles, pRegionBinEdgesAngles);
  h_500_CT_wO_noSC_DR07_E_RMS90_summary_histogram ->SetYTitle("RMS_{90}(E_{j}^{reco}/E_{j}^{gen}) / Mean_{90}(E_{j}^{reco}/E_{j}^{gen}) [%]");
  h_500_CT_wO_noSC_DR07_E_RMS90_summary_histogram->SetXTitle("|cos#theta|");
  h_500_CT_wO_noSC_DR07_E_RMS90_summary_histogram->SetLineWidth(2);
  h_500_CT_wO_noSC_DR07_E_RMS90_summary_histogram->SetLineColor(kRed);
  h_500_CT_wO_noSC_DR07_E_RMS90_summary_histogram->SetLineStyle(2);
  //for energies still keep sqrt(2) from original total energy calculation
  for(int i=0;i<4;i++){
    resolutionTH1=0; 
    resolutionErrorTH1=0;
    meanTH1=0;
    meanErrorTH1=0;
    CalculatePerformance( hist_vec_500_CT_wO_noSC[i], resolutionTH1, resolutionErrorTH1,meanTH1,meanErrorTH1);
    h_500_CT_wO_noSC_DR07_E_RMS90_summary_histogram->SetBinContent(i+1,resolutionTH1/sqrt(2.));
    h_500_CT_wO_noSC_DR07_E_RMS90_summary_histogram ->SetBinError(i+1, resolutionErrorTH1/sqrt(2.));
  }
  gre_DR07_RMS90_JER_0_65_wO_noSC->SetPoint(3,250,h_500_CT_wO_noSC_DR07_E_RMS90_summary_histogram->GetBinContent(1));
  gre_DR07_RMS90_JER_0_65_wO_noSC->SetPointError(3,0,h_500_CT_wO_noSC_DR07_E_RMS90_summary_histogram->GetBinError(1));

  gre_DR07_RMS90_JER_0_65_to_0_80_wO_noSC->SetPoint(3,250,h_500_CT_wO_noSC_DR07_E_RMS90_summary_histogram->GetBinContent(2));
  gre_DR07_RMS90_JER_0_65_to_0_80_wO_noSC->SetPointError(3,0,h_500_CT_wO_noSC_DR07_E_RMS90_summary_histogram->GetBinError(2));

  gre_DR07_RMS90_JER_0_80_to_0_925_wO_noSC->SetPoint(3,250,h_500_CT_wO_noSC_DR07_E_RMS90_summary_histogram->GetBinContent(3));
  gre_DR07_RMS90_JER_0_80_to_0_925_wO_noSC->SetPointError(3,0,h_500_CT_wO_noSC_DR07_E_RMS90_summary_histogram->GetBinError(3));

  gre_DR07_RMS90_JER_0_925_to_1_00_wO_noSC->SetPoint(3,250,h_500_CT_wO_noSC_DR07_E_RMS90_summary_histogram->GetBinContent(4));
  gre_DR07_RMS90_JER_0_925_to_1_00_wO_noSC->SetPointError(3,0,h_500_CT_wO_noSC_DR07_E_RMS90_summary_histogram->GetBinError(4));



  std::cout<<"before 1500 CT_wSC"<<std::endl;

  TH1F* h_1500_CT_wSC_DR07_E_rel_totVis_RMS_d1_cosT_0_to_0_65 =  new TH1F("h_1500_CT_wSC_DR07_E_rel_totVis_RMS_d1_cosT_0_to_0_65","", n_binsJER, lim_E_rel_low,lim_E_rel_high);
  TH1F* h_1500_CT_wSC_DR07_E_rel_totVis_RMS_d1_cosT_0_65_to_0_80 =  new TH1F("h_1500_CT_wSC_DR07_E_rel_totVis_RMS_d1_cosT_0_65_to_0_80","", n_binsJER, lim_E_rel_low,lim_E_rel_high);
  TH1F* h_1500_CT_wSC_DR07_E_rel_totVis_RMS_d1_cosT_0_80_to_0_925 =  new TH1F("h_1500_CT_wSC_DR07_E_rel_totVis_RMS_d1_cosT_0_80_to_0_925","", n_binsJER, lim_E_rel_low,lim_E_rel_high);
  TH1F* h_1500_CT_wSC_DR07_E_rel_totVis_RMS_d1_cosT_0_925_to_1_00 =  new TH1F("h_1500_CT_wSC_DR07_E_rel_totVis_RMS_d1_cosT_0_925_to_1_00","", n_binsJER, lim_E_rel_low,lim_E_rel_high);

  std::vector<TH1F*> hist_vec_1500_CT_wSC;
  hist_vec_1500_CT_wSC.push_back(h_1500_CT_wSC_DR07_E_rel_totVis_RMS_d1_cosT_0_to_0_65);
  hist_vec_1500_CT_wSC.push_back(h_1500_CT_wSC_DR07_E_rel_totVis_RMS_d1_cosT_0_65_to_0_80);
  hist_vec_1500_CT_wSC.push_back(h_1500_CT_wSC_DR07_E_rel_totVis_RMS_d1_cosT_0_80_to_0_925);
  hist_vec_1500_CT_wSC.push_back(h_1500_CT_wSC_DR07_E_rel_totVis_RMS_d1_cosT_0_925_to_1_00);


  for(unsigned int i=0;i<hist_vec_1500_CT_wSC.size();i++){
    hist_vec_1500_CT_wSC[i]->Sumw2();
  }
  fill_SC_jet_histograms(file_CLIC_1500_CT,hist_vec_1500_CT_wSC);

  TH1F* h_1500_CT_wSC_DR07_E_RMS90_summary_histogram=new TH1F("JER_RMS90VsCosTheta_CT_wSC_DR07_1500", "RMS_{90}(E_{j}^{reco}/E_{j}^{gen}) / Mean_{90}(E_{j}^{reco}/E_{j}^{gen}) vs |cos#theta|", nRegionBinsAngles, pRegionBinEdgesAngles);
  h_1500_CT_wSC_DR07_E_RMS90_summary_histogram ->SetYTitle("RMS_{90}(E_{j}^{reco}/E_{j}^{gen}) / Mean_{90}(E_{j}^{reco}/E_{j}^{gen}) [%]");
  h_1500_CT_wSC_DR07_E_RMS90_summary_histogram->SetXTitle("|cos#theta|");
  h_1500_CT_wSC_DR07_E_RMS90_summary_histogram->SetLineWidth(2);
  h_1500_CT_wSC_DR07_E_RMS90_summary_histogram->SetLineColor(kRed);
  h_1500_CT_wSC_DR07_E_RMS90_summary_histogram->SetLineStyle(2);
  //for energies still keep sqrt(2) from original total energy calculation
  for(int i=0;i<4;i++){
    resolutionTH1=0; 
    resolutionErrorTH1=0;
    meanTH1=0;
    meanErrorTH1=0;
    CalculatePerformance( hist_vec_1500_CT_wSC[i], resolutionTH1, resolutionErrorTH1,meanTH1,meanErrorTH1);
    h_1500_CT_wSC_DR07_E_RMS90_summary_histogram->SetBinContent(i+1,resolutionTH1/sqrt(2.));
    h_1500_CT_wSC_DR07_E_RMS90_summary_histogram ->SetBinError(i+1, resolutionErrorTH1/sqrt(2.));
  }
  gre_DR07_RMS90_JER_0_65_wSC->SetPoint(4,750,h_1500_CT_wSC_DR07_E_RMS90_summary_histogram->GetBinContent(1));
  gre_DR07_RMS90_JER_0_65_wSC->SetPointError(4,0,h_1500_CT_wSC_DR07_E_RMS90_summary_histogram->GetBinError(1));

  gre_DR07_RMS90_JER_0_65_to_0_80_wSC->SetPoint(4,750,h_1500_CT_wSC_DR07_E_RMS90_summary_histogram->GetBinContent(2));
  gre_DR07_RMS90_JER_0_65_to_0_80_wSC->SetPointError(4,0,h_1500_CT_wSC_DR07_E_RMS90_summary_histogram->GetBinError(2));

  gre_DR07_RMS90_JER_0_80_to_0_925_wSC->SetPoint(4,750,h_1500_CT_wSC_DR07_E_RMS90_summary_histogram->GetBinContent(3));
  gre_DR07_RMS90_JER_0_80_to_0_925_wSC->SetPointError(4,0,h_1500_CT_wSC_DR07_E_RMS90_summary_histogram->GetBinError(3));

  gre_DR07_RMS90_JER_0_925_to_1_00_wSC->SetPoint(4,750,h_1500_CT_wSC_DR07_E_RMS90_summary_histogram->GetBinContent(4));
  gre_DR07_RMS90_JER_0_925_to_1_00_wSC->SetPointError(4,0,h_1500_CT_wSC_DR07_E_RMS90_summary_histogram->GetBinError(4));

  std::cout<<"before 1500 CT_wO_wSC"<<std::endl;

  TH1F* h_1500_CT_wO_wSC_DR07_E_rel_totVis_RMS_d1_cosT_0_to_0_65 =  new TH1F("h_1500_CT_wO_wSC_DR07_E_rel_totVis_RMS_d1_cosT_0_to_0_65","", n_binsJER, lim_E_rel_low,lim_E_rel_high);
  TH1F* h_1500_CT_wO_wSC_DR07_E_rel_totVis_RMS_d1_cosT_0_65_to_0_80 =  new TH1F("h_1500_CT_wO_wSC_DR07_E_rel_totVis_RMS_d1_cosT_0_65_to_0_80","", n_binsJER, lim_E_rel_low,lim_E_rel_high);
  TH1F* h_1500_CT_wO_wSC_DR07_E_rel_totVis_RMS_d1_cosT_0_80_to_0_925 =  new TH1F("h_1500_CT_wO_wSC_DR07_E_rel_totVis_RMS_d1_cosT_0_80_to_0_925","", n_binsJER, lim_E_rel_low,lim_E_rel_high);
  TH1F* h_1500_CT_wO_wSC_DR07_E_rel_totVis_RMS_d1_cosT_0_925_to_1_00 =  new TH1F("h_1500_CT_wO_wSC_DR07_E_rel_totVis_RMS_d1_cosT_0_925_to_1_00","", n_binsJER, lim_E_rel_low,lim_E_rel_high);

  std::vector<TH1F*> hist_vec_1500_CT_wO_wSC;
  hist_vec_1500_CT_wO_wSC.push_back(h_1500_CT_wO_wSC_DR07_E_rel_totVis_RMS_d1_cosT_0_to_0_65);
  hist_vec_1500_CT_wO_wSC.push_back(h_1500_CT_wO_wSC_DR07_E_rel_totVis_RMS_d1_cosT_0_65_to_0_80);
  hist_vec_1500_CT_wO_wSC.push_back(h_1500_CT_wO_wSC_DR07_E_rel_totVis_RMS_d1_cosT_0_80_to_0_925);
  hist_vec_1500_CT_wO_wSC.push_back(h_1500_CT_wO_wSC_DR07_E_rel_totVis_RMS_d1_cosT_0_925_to_1_00);


  for(unsigned int i=0;i<hist_vec_1500_CT_wO_wSC.size();i++){
    hist_vec_1500_CT_wO_wSC[i]->Sumw2();
  }
  fill_SC_jet_histograms(file_CLIC_1500_CT_wO,hist_vec_1500_CT_wO_wSC);

  TH1F* h_1500_CT_wO_wSC_DR07_E_RMS90_summary_histogram=new TH1F("JER_RMS90VsCosTheta_CT_wO_wSC_DR07_1500", "RMS_{90}(E_{j}^{reco}/E_{j}^{gen}) / Mean_{90}(E_{j}^{reco}/E_{j}^{gen}) vs |cos#theta|", nRegionBinsAngles, pRegionBinEdgesAngles);
  h_1500_CT_wO_wSC_DR07_E_RMS90_summary_histogram ->SetYTitle("RMS_{90}(E_{j}^{reco}/E_{j}^{gen}) / Mean_{90}(E_{j}^{reco}/E_{j}^{gen}) [%]");
  h_1500_CT_wO_wSC_DR07_E_RMS90_summary_histogram->SetXTitle("|cos#theta|");
  h_1500_CT_wO_wSC_DR07_E_RMS90_summary_histogram->SetLineWidth(2);
  h_1500_CT_wO_wSC_DR07_E_RMS90_summary_histogram->SetLineColor(kRed);
  h_1500_CT_wO_wSC_DR07_E_RMS90_summary_histogram->SetLineStyle(2);
  //for energies still keep sqrt(2) from original total energy calculation
  for(int i=0;i<4;i++){
    resolutionTH1=0; 
    resolutionErrorTH1=0;
    meanTH1=0;
    meanErrorTH1=0;
    CalculatePerformance( hist_vec_1500_CT_wO_wSC[i], resolutionTH1, resolutionErrorTH1,meanTH1,meanErrorTH1);
    h_1500_CT_wO_wSC_DR07_E_RMS90_summary_histogram->SetBinContent(i+1,resolutionTH1/sqrt(2.));
    h_1500_CT_wO_wSC_DR07_E_RMS90_summary_histogram ->SetBinError(i+1, resolutionErrorTH1/sqrt(2.));
  }
  gre_DR07_RMS90_JER_0_65_wO_wSC->SetPoint(4,750,h_1500_CT_wO_wSC_DR07_E_RMS90_summary_histogram->GetBinContent(1));
  gre_DR07_RMS90_JER_0_65_wO_wSC->SetPointError(4,0,h_1500_CT_wO_wSC_DR07_E_RMS90_summary_histogram->GetBinError(1));

  gre_DR07_RMS90_JER_0_65_to_0_80_wO_wSC->SetPoint(4,750,h_1500_CT_wO_wSC_DR07_E_RMS90_summary_histogram->GetBinContent(2));
  gre_DR07_RMS90_JER_0_65_to_0_80_wO_wSC->SetPointError(4,0,h_1500_CT_wO_wSC_DR07_E_RMS90_summary_histogram->GetBinError(2));

  gre_DR07_RMS90_JER_0_80_to_0_925_wO_wSC->SetPoint(4,750,h_1500_CT_wO_wSC_DR07_E_RMS90_summary_histogram->GetBinContent(3));
  gre_DR07_RMS90_JER_0_80_to_0_925_wO_wSC->SetPointError(4,0,h_1500_CT_wO_wSC_DR07_E_RMS90_summary_histogram->GetBinError(3));

  gre_DR07_RMS90_JER_0_925_to_1_00_wO_wSC->SetPoint(4,750,h_1500_CT_wO_wSC_DR07_E_RMS90_summary_histogram->GetBinContent(4));
  gre_DR07_RMS90_JER_0_925_to_1_00_wO_wSC->SetPointError(4,0,h_1500_CT_wO_wSC_DR07_E_RMS90_summary_histogram->GetBinError(4));


  std::cout<<"before 1500 CT_noSC"<<std::endl;

  TH1F* h_1500_CT_noSC_DR07_E_rel_totVis_RMS_d1_cosT_0_to_0_65 =  new TH1F("h_1500_CT_noSC_DR07_E_rel_totVis_RMS_d1_cosT_0_to_0_65","", n_binsJER, lim_E_rel_low,lim_E_rel_high);
  TH1F* h_1500_CT_noSC_DR07_E_rel_totVis_RMS_d1_cosT_0_65_to_0_80 =  new TH1F("h_1500_CT_noSC_DR07_E_rel_totVis_RMS_d1_cosT_0_65_to_0_80","", n_binsJER, lim_E_rel_low,lim_E_rel_high);
  TH1F* h_1500_CT_noSC_DR07_E_rel_totVis_RMS_d1_cosT_0_80_to_0_925 =  new TH1F("h_1500_CT_noSC_DR07_E_rel_totVis_RMS_d1_cosT_0_80_to_0_925","", n_binsJER, lim_E_rel_low,lim_E_rel_high);
  TH1F* h_1500_CT_noSC_DR07_E_rel_totVis_RMS_d1_cosT_0_925_to_1_00 =  new TH1F("h_1500_CT_noSC_DR07_E_rel_totVis_RMS_d1_cosT_0_925_to_1_00","", n_binsJER, lim_E_rel_low,lim_E_rel_high);

  std::vector<TH1F*> hist_vec_1500_CT_noSC;
  hist_vec_1500_CT_noSC.push_back(h_1500_CT_noSC_DR07_E_rel_totVis_RMS_d1_cosT_0_to_0_65);
  hist_vec_1500_CT_noSC.push_back(h_1500_CT_noSC_DR07_E_rel_totVis_RMS_d1_cosT_0_65_to_0_80);
  hist_vec_1500_CT_noSC.push_back(h_1500_CT_noSC_DR07_E_rel_totVis_RMS_d1_cosT_0_80_to_0_925);
  hist_vec_1500_CT_noSC.push_back(h_1500_CT_noSC_DR07_E_rel_totVis_RMS_d1_cosT_0_925_to_1_00);


  for(unsigned int i=0;i<hist_vec_1500_CT_noSC.size();i++){
    hist_vec_1500_CT_noSC[i]->Sumw2();
  }

  fill_SC_jet_histograms(file_CLIC_1500_CT_noSC,hist_vec_1500_CT_noSC);

  TH1F* h_1500_CT_noSC_DR07_E_RMS90_summary_histogram=new TH1F("JER_RMS90VsCosTheta_CT_noSC_DR07_1500", "RMS_{90}(E_{j}^{reco}/E_{j}^{gen}) / Mean_{90}(E_{j}^{reco}/E_{j}^{gen}) vs |cos#theta|", nRegionBinsAngles, pRegionBinEdgesAngles);
  h_1500_CT_noSC_DR07_E_RMS90_summary_histogram ->SetYTitle("RMS_{90}(E_{j}^{reco}/E_{j}^{gen}) / Mean_{90}(E_{j}^{reco}/E_{j}^{gen}) [%]");
  h_1500_CT_noSC_DR07_E_RMS90_summary_histogram->SetXTitle("|cos#theta|");
  h_1500_CT_noSC_DR07_E_RMS90_summary_histogram->SetLineWidth(2);
  h_1500_CT_noSC_DR07_E_RMS90_summary_histogram->SetLineColor(kRed);
  h_1500_CT_noSC_DR07_E_RMS90_summary_histogram->SetLineStyle(2);
  //for energies still keep sqrt(2) from original total energy calculation
  for(int i=0;i<4;i++){
    resolutionTH1=0; 
    resolutionErrorTH1=0;
    meanTH1=0;
    meanErrorTH1=0;
    CalculatePerformance( hist_vec_1500_CT_noSC[i], resolutionTH1, resolutionErrorTH1,meanTH1,meanErrorTH1);
    h_1500_CT_noSC_DR07_E_RMS90_summary_histogram->SetBinContent(i+1,resolutionTH1/sqrt(2.));
    h_1500_CT_noSC_DR07_E_RMS90_summary_histogram ->SetBinError(i+1, resolutionErrorTH1/sqrt(2.));
  }
  gre_DR07_RMS90_JER_0_65_noSC->SetPoint(4,750,h_1500_CT_noSC_DR07_E_RMS90_summary_histogram->GetBinContent(1));
  gre_DR07_RMS90_JER_0_65_noSC->SetPointError(4,0,h_1500_CT_noSC_DR07_E_RMS90_summary_histogram->GetBinError(1));

  gre_DR07_RMS90_JER_0_65_to_0_80_noSC->SetPoint(4,750,h_1500_CT_noSC_DR07_E_RMS90_summary_histogram->GetBinContent(2));
  gre_DR07_RMS90_JER_0_65_to_0_80_noSC->SetPointError(4,0,h_1500_CT_noSC_DR07_E_RMS90_summary_histogram->GetBinError(2));

  gre_DR07_RMS90_JER_0_80_to_0_925_noSC->SetPoint(4,750,h_1500_CT_noSC_DR07_E_RMS90_summary_histogram->GetBinContent(3));
  gre_DR07_RMS90_JER_0_80_to_0_925_noSC->SetPointError(4,0,h_1500_CT_noSC_DR07_E_RMS90_summary_histogram->GetBinError(3));

  gre_DR07_RMS90_JER_0_925_to_1_00_noSC->SetPoint(4,750,h_1500_CT_noSC_DR07_E_RMS90_summary_histogram->GetBinContent(4));
  gre_DR07_RMS90_JER_0_925_to_1_00_noSC->SetPointError(4,0,h_1500_CT_noSC_DR07_E_RMS90_summary_histogram->GetBinError(4));

  std::cout<<"before 1500 CT_wO_noSC"<<std::endl;

  TH1F* h_1500_CT_wO_noSC_DR07_E_rel_totVis_RMS_d1_cosT_0_to_0_65 =  new TH1F("h_1500_CT_wO_noSC_DR07_E_rel_totVis_RMS_d1_cosT_0_to_0_65","", n_binsJER, lim_E_rel_low,lim_E_rel_high);
  TH1F* h_1500_CT_wO_noSC_DR07_E_rel_totVis_RMS_d1_cosT_0_65_to_0_80 =  new TH1F("h_1500_CT_wO_noSC_DR07_E_rel_totVis_RMS_d1_cosT_0_65_to_0_80","", n_binsJER, lim_E_rel_low,lim_E_rel_high);
  TH1F* h_1500_CT_wO_noSC_DR07_E_rel_totVis_RMS_d1_cosT_0_80_to_0_925 =  new TH1F("h_1500_CT_wO_noSC_DR07_E_rel_totVis_RMS_d1_cosT_0_80_to_0_925","", n_binsJER, lim_E_rel_low,lim_E_rel_high);
  TH1F* h_1500_CT_wO_noSC_DR07_E_rel_totVis_RMS_d1_cosT_0_925_to_1_00 =  new TH1F("h_1500_CT_wO_noSC_DR07_E_rel_totVis_RMS_d1_cosT_0_925_to_1_00","", n_binsJER, lim_E_rel_low,lim_E_rel_high);

  std::vector<TH1F*> hist_vec_1500_CT_wO_noSC;
  hist_vec_1500_CT_wO_noSC.push_back(h_1500_CT_wO_noSC_DR07_E_rel_totVis_RMS_d1_cosT_0_to_0_65);
  hist_vec_1500_CT_wO_noSC.push_back(h_1500_CT_wO_noSC_DR07_E_rel_totVis_RMS_d1_cosT_0_65_to_0_80);
  hist_vec_1500_CT_wO_noSC.push_back(h_1500_CT_wO_noSC_DR07_E_rel_totVis_RMS_d1_cosT_0_80_to_0_925);
  hist_vec_1500_CT_wO_noSC.push_back(h_1500_CT_wO_noSC_DR07_E_rel_totVis_RMS_d1_cosT_0_925_to_1_00);


  for(unsigned int i=0;i<hist_vec_1500_CT_wO_noSC.size();i++){
    hist_vec_1500_CT_wO_noSC[i]->Sumw2();
  }

  fill_SC_jet_histograms(file_CLIC_1500_CT_noSC_wO,hist_vec_1500_CT_wO_noSC);

  TH1F* h_1500_CT_wO_noSC_DR07_E_RMS90_summary_histogram=new TH1F("JER_RMS90VsCosTheta_CT_wO_noSC_DR07_1500", "RMS_{90}(E_{j}^{reco}/E_{j}^{gen}) / Mean_{90}(E_{j}^{reco}/E_{j}^{gen}) vs |cos#theta|", nRegionBinsAngles, pRegionBinEdgesAngles);
  h_1500_CT_wO_noSC_DR07_E_RMS90_summary_histogram ->SetYTitle("RMS_{90}(E_{j}^{reco}/E_{j}^{gen}) / Mean_{90}(E_{j}^{reco}/E_{j}^{gen}) [%]");
  h_1500_CT_wO_noSC_DR07_E_RMS90_summary_histogram->SetXTitle("|cos#theta|");
  h_1500_CT_wO_noSC_DR07_E_RMS90_summary_histogram->SetLineWidth(2);
  h_1500_CT_wO_noSC_DR07_E_RMS90_summary_histogram->SetLineColor(kRed);
  h_1500_CT_wO_noSC_DR07_E_RMS90_summary_histogram->SetLineStyle(2);
  //for energies still keep sqrt(2) from original total energy calculation
  for(int i=0;i<4;i++){
    resolutionTH1=0; 
    resolutionErrorTH1=0;
    meanTH1=0;
    meanErrorTH1=0;
    CalculatePerformance( hist_vec_1500_CT_wO_noSC[i], resolutionTH1, resolutionErrorTH1,meanTH1,meanErrorTH1);
    h_1500_CT_wO_noSC_DR07_E_RMS90_summary_histogram->SetBinContent(i+1,resolutionTH1/sqrt(2.));
    h_1500_CT_wO_noSC_DR07_E_RMS90_summary_histogram ->SetBinError(i+1, resolutionErrorTH1/sqrt(2.));
  }
  gre_DR07_RMS90_JER_0_65_wO_noSC->SetPoint(4,750,h_1500_CT_wO_noSC_DR07_E_RMS90_summary_histogram->GetBinContent(1));
  gre_DR07_RMS90_JER_0_65_wO_noSC->SetPointError(4,0,h_1500_CT_wO_noSC_DR07_E_RMS90_summary_histogram->GetBinError(1));

  gre_DR07_RMS90_JER_0_65_to_0_80_wO_noSC->SetPoint(4,750,h_1500_CT_wO_noSC_DR07_E_RMS90_summary_histogram->GetBinContent(2));
  gre_DR07_RMS90_JER_0_65_to_0_80_wO_noSC->SetPointError(4,0,h_1500_CT_wO_noSC_DR07_E_RMS90_summary_histogram->GetBinError(2));

  gre_DR07_RMS90_JER_0_80_to_0_925_wO_noSC->SetPoint(4,750,h_1500_CT_wO_noSC_DR07_E_RMS90_summary_histogram->GetBinContent(3));
  gre_DR07_RMS90_JER_0_80_to_0_925_wO_noSC->SetPointError(4,0,h_1500_CT_wO_noSC_DR07_E_RMS90_summary_histogram->GetBinError(3));

  gre_DR07_RMS90_JER_0_925_to_1_00_wO_noSC->SetPoint(4,750,h_1500_CT_wO_noSC_DR07_E_RMS90_summary_histogram->GetBinContent(4));
  gre_DR07_RMS90_JER_0_925_to_1_00_wO_noSC->SetPointError(4,0,h_1500_CT_wO_noSC_DR07_E_RMS90_summary_histogram->GetBinError(4));


  std::cout<<"before 3000 CT_wSC"<<std::endl;

  TH1F* h_3000_CT_wSC_DR07_E_rel_totVis_RMS_d1_cosT_0_to_0_65 =  new TH1F("h_3000_CT_wSC_DR07_E_rel_totVis_RMS_d1_cosT_0_to_0_65","", n_binsJER, lim_E_rel_low,lim_E_rel_high);
  TH1F* h_3000_CT_wSC_DR07_E_rel_totVis_RMS_d1_cosT_0_65_to_0_80 =  new TH1F("h_3000_CT_wSC_DR07_E_rel_totVis_RMS_d1_cosT_0_65_to_0_80","", n_binsJER, lim_E_rel_low,lim_E_rel_high);
  TH1F* h_3000_CT_wSC_DR07_E_rel_totVis_RMS_d1_cosT_0_80_to_0_925 =  new TH1F("h_3000_CT_wSC_DR07_E_rel_totVis_RMS_d1_cosT_0_80_to_0_925","", n_binsJER, lim_E_rel_low,lim_E_rel_high);
  TH1F* h_3000_CT_wSC_DR07_E_rel_totVis_RMS_d1_cosT_0_925_to_1_00 =  new TH1F("h_3000_CT_wSC_DR07_E_rel_totVis_RMS_d1_cosT_0_925_to_1_00","", n_binsJER, lim_E_rel_low,lim_E_rel_high);

  std::vector<TH1F*> hist_vec_3000_CT_wSC;
  hist_vec_3000_CT_wSC.push_back(h_3000_CT_wSC_DR07_E_rel_totVis_RMS_d1_cosT_0_to_0_65);
  hist_vec_3000_CT_wSC.push_back(h_3000_CT_wSC_DR07_E_rel_totVis_RMS_d1_cosT_0_65_to_0_80);
  hist_vec_3000_CT_wSC.push_back(h_3000_CT_wSC_DR07_E_rel_totVis_RMS_d1_cosT_0_80_to_0_925);
  hist_vec_3000_CT_wSC.push_back(h_3000_CT_wSC_DR07_E_rel_totVis_RMS_d1_cosT_0_925_to_1_00);


  for(unsigned int i=0;i<hist_vec_3000_CT_wSC.size();i++){
    hist_vec_3000_CT_wSC[i]->Sumw2();
  }
  fill_SC_jet_histograms(file_CLIC_3000_CT,hist_vec_3000_CT_wSC);

  TH1F* h_3000_CT_wSC_DR07_E_RMS90_summary_histogram=new TH1F("JER_RMS90VsCosTheta_CT_wSC_DR07_3000", "RMS_{90}(E_{j}^{reco}/E_{j}^{gen}) / Mean_{90}(E_{j}^{reco}/E_{j}^{gen}) vs |cos#theta|", nRegionBinsAngles, pRegionBinEdgesAngles);
  h_3000_CT_wSC_DR07_E_RMS90_summary_histogram ->SetYTitle("RMS_{90}(E_{j}^{reco}/E_{j}^{gen}) / Mean_{90}(E_{j}^{reco}/E_{j}^{gen}) [%]");
  h_3000_CT_wSC_DR07_E_RMS90_summary_histogram->SetXTitle("|cos#theta|");
  h_3000_CT_wSC_DR07_E_RMS90_summary_histogram->SetLineWidth(2);
  h_3000_CT_wSC_DR07_E_RMS90_summary_histogram->SetLineColor(kRed);
  h_3000_CT_wSC_DR07_E_RMS90_summary_histogram->SetLineStyle(2);
  //for energies still keep sqrt(2) from original total energy calculation
  for(int i=0;i<4;i++){
    resolutionTH1=0; 
    resolutionErrorTH1=0;
    meanTH1=0;
    meanErrorTH1=0;
    CalculatePerformance( hist_vec_3000_CT_wSC[i], resolutionTH1, resolutionErrorTH1,meanTH1,meanErrorTH1);
    h_3000_CT_wSC_DR07_E_RMS90_summary_histogram->SetBinContent(i+1,resolutionTH1/sqrt(2.));
    h_3000_CT_wSC_DR07_E_RMS90_summary_histogram ->SetBinError(i+1, resolutionErrorTH1/sqrt(2.));
  }
  gre_DR07_RMS90_JER_0_65_wSC->SetPoint(5,1500,h_3000_CT_wSC_DR07_E_RMS90_summary_histogram->GetBinContent(1));
  gre_DR07_RMS90_JER_0_65_wSC->SetPointError(5,0,h_3000_CT_wSC_DR07_E_RMS90_summary_histogram->GetBinError(1));

  gre_DR07_RMS90_JER_0_65_to_0_80_wSC->SetPoint(5,1500,h_3000_CT_wSC_DR07_E_RMS90_summary_histogram->GetBinContent(2));
  gre_DR07_RMS90_JER_0_65_to_0_80_wSC->SetPointError(5,0,h_3000_CT_wSC_DR07_E_RMS90_summary_histogram->GetBinError(2));

  gre_DR07_RMS90_JER_0_80_to_0_925_wSC->SetPoint(5,1500,h_3000_CT_wSC_DR07_E_RMS90_summary_histogram->GetBinContent(3));
  gre_DR07_RMS90_JER_0_80_to_0_925_wSC->SetPointError(5,0,h_3000_CT_wSC_DR07_E_RMS90_summary_histogram->GetBinError(3));

  gre_DR07_RMS90_JER_0_925_to_1_00_wSC->SetPoint(5,1500,h_3000_CT_wSC_DR07_E_RMS90_summary_histogram->GetBinContent(4));
  gre_DR07_RMS90_JER_0_925_to_1_00_wSC->SetPointError(5,0,h_3000_CT_wSC_DR07_E_RMS90_summary_histogram->GetBinError(4));

  std::cout<<"before 3000 CT_wO_wSC"<<std::endl;

  TH1F* h_3000_CT_wO_wSC_DR07_E_rel_totVis_RMS_d1_cosT_0_to_0_65 =  new TH1F("h_3000_CT_wO_wSC_DR07_E_rel_totVis_RMS_d1_cosT_0_to_0_65","", n_binsJER, lim_E_rel_low,lim_E_rel_high);
  TH1F* h_3000_CT_wO_wSC_DR07_E_rel_totVis_RMS_d1_cosT_0_65_to_0_80 =  new TH1F("h_3000_CT_wO_wSC_DR07_E_rel_totVis_RMS_d1_cosT_0_65_to_0_80","", n_binsJER, lim_E_rel_low,lim_E_rel_high);
  TH1F* h_3000_CT_wO_wSC_DR07_E_rel_totVis_RMS_d1_cosT_0_80_to_0_925 =  new TH1F("h_3000_CT_wO_wSC_DR07_E_rel_totVis_RMS_d1_cosT_0_80_to_0_925","", n_binsJER, lim_E_rel_low,lim_E_rel_high);
  TH1F* h_3000_CT_wO_wSC_DR07_E_rel_totVis_RMS_d1_cosT_0_925_to_1_00 =  new TH1F("h_3000_CT_wO_wSC_DR07_E_rel_totVis_RMS_d1_cosT_0_925_to_1_00","", n_binsJER, lim_E_rel_low,lim_E_rel_high);

  std::vector<TH1F*> hist_vec_3000_CT_wO_wSC;
  hist_vec_3000_CT_wO_wSC.push_back(h_3000_CT_wO_wSC_DR07_E_rel_totVis_RMS_d1_cosT_0_to_0_65);
  hist_vec_3000_CT_wO_wSC.push_back(h_3000_CT_wO_wSC_DR07_E_rel_totVis_RMS_d1_cosT_0_65_to_0_80);
  hist_vec_3000_CT_wO_wSC.push_back(h_3000_CT_wO_wSC_DR07_E_rel_totVis_RMS_d1_cosT_0_80_to_0_925);
  hist_vec_3000_CT_wO_wSC.push_back(h_3000_CT_wO_wSC_DR07_E_rel_totVis_RMS_d1_cosT_0_925_to_1_00);


  for(unsigned int i=0;i<hist_vec_3000_CT_wO_wSC.size();i++){
    hist_vec_3000_CT_wO_wSC[i]->Sumw2();
  }
  fill_SC_jet_histograms(file_CLIC_3000_CT_wO,hist_vec_3000_CT_wO_wSC);

  TH1F* h_3000_CT_wO_wSC_DR07_E_RMS90_summary_histogram=new TH1F("JER_RMS90VsCosTheta_CT_wO_wSC_DR07_3000", "RMS_{90}(E_{j}^{reco}/E_{j}^{gen}) / Mean_{90}(E_{j}^{reco}/E_{j}^{gen}) vs |cos#theta|", nRegionBinsAngles, pRegionBinEdgesAngles);
  h_3000_CT_wO_wSC_DR07_E_RMS90_summary_histogram ->SetYTitle("RMS_{90}(E_{j}^{reco}/E_{j}^{gen}) / Mean_{90}(E_{j}^{reco}/E_{j}^{gen}) [%]");
  h_3000_CT_wO_wSC_DR07_E_RMS90_summary_histogram->SetXTitle("|cos#theta|");
  h_3000_CT_wO_wSC_DR07_E_RMS90_summary_histogram->SetLineWidth(2);
  h_3000_CT_wO_wSC_DR07_E_RMS90_summary_histogram->SetLineColor(kRed);
  h_3000_CT_wO_wSC_DR07_E_RMS90_summary_histogram->SetLineStyle(2);
  //for energies still keep sqrt(2) from original total energy calculation
  for(int i=0;i<4;i++){
    resolutionTH1=0; 
    resolutionErrorTH1=0;
    meanTH1=0;
    meanErrorTH1=0;
    CalculatePerformance( hist_vec_3000_CT_wO_wSC[i], resolutionTH1, resolutionErrorTH1,meanTH1,meanErrorTH1);
    h_3000_CT_wO_wSC_DR07_E_RMS90_summary_histogram->SetBinContent(i+1,resolutionTH1/sqrt(2.));
    h_3000_CT_wO_wSC_DR07_E_RMS90_summary_histogram ->SetBinError(i+1, resolutionErrorTH1/sqrt(2.));
  }
  gre_DR07_RMS90_JER_0_65_wO_wSC->SetPoint(5,1500,h_3000_CT_wO_wSC_DR07_E_RMS90_summary_histogram->GetBinContent(1));
  gre_DR07_RMS90_JER_0_65_wO_wSC->SetPointError(5,0,h_3000_CT_wO_wSC_DR07_E_RMS90_summary_histogram->GetBinError(1));

  gre_DR07_RMS90_JER_0_65_to_0_80_wO_wSC->SetPoint(5,1500,h_3000_CT_wO_wSC_DR07_E_RMS90_summary_histogram->GetBinContent(2));
  gre_DR07_RMS90_JER_0_65_to_0_80_wO_wSC->SetPointError(5,0,h_3000_CT_wO_wSC_DR07_E_RMS90_summary_histogram->GetBinError(2));

  gre_DR07_RMS90_JER_0_80_to_0_925_wO_wSC->SetPoint(5,1500,h_3000_CT_wO_wSC_DR07_E_RMS90_summary_histogram->GetBinContent(3));
  gre_DR07_RMS90_JER_0_80_to_0_925_wO_wSC->SetPointError(5,0,h_3000_CT_wO_wSC_DR07_E_RMS90_summary_histogram->GetBinError(3));

  gre_DR07_RMS90_JER_0_925_to_1_00_wO_wSC->SetPoint(5,1500,h_3000_CT_wO_wSC_DR07_E_RMS90_summary_histogram->GetBinContent(4));
  gre_DR07_RMS90_JER_0_925_to_1_00_wO_wSC->SetPointError(5,0,h_3000_CT_wO_wSC_DR07_E_RMS90_summary_histogram->GetBinError(4));


  std::cout<<"before 3000 CT_noSC"<<std::endl;

  TH1F* h_3000_CT_noSC_DR07_E_rel_totVis_RMS_d1_cosT_0_to_0_65 =  new TH1F("h_3000_CT_noSC_DR07_E_rel_totVis_RMS_d1_cosT_0_to_0_65","", n_binsJER, lim_E_rel_low,lim_E_rel_high);
  TH1F* h_3000_CT_noSC_DR07_E_rel_totVis_RMS_d1_cosT_0_65_to_0_80 =  new TH1F("h_3000_CT_noSC_DR07_E_rel_totVis_RMS_d1_cosT_0_65_to_0_80","", n_binsJER, lim_E_rel_low,lim_E_rel_high);
  TH1F* h_3000_CT_noSC_DR07_E_rel_totVis_RMS_d1_cosT_0_80_to_0_925 =  new TH1F("h_3000_CT_noSC_DR07_E_rel_totVis_RMS_d1_cosT_0_80_to_0_925","", n_binsJER, lim_E_rel_low,lim_E_rel_high);
  TH1F* h_3000_CT_noSC_DR07_E_rel_totVis_RMS_d1_cosT_0_925_to_1_00 =  new TH1F("h_3000_CT_noSC_DR07_E_rel_totVis_RMS_d1_cosT_0_925_to_1_00","", n_binsJER, lim_E_rel_low,lim_E_rel_high);

  std::vector<TH1F*> hist_vec_3000_CT_noSC;
  hist_vec_3000_CT_noSC.push_back(h_3000_CT_noSC_DR07_E_rel_totVis_RMS_d1_cosT_0_to_0_65);
  hist_vec_3000_CT_noSC.push_back(h_3000_CT_noSC_DR07_E_rel_totVis_RMS_d1_cosT_0_65_to_0_80);
  hist_vec_3000_CT_noSC.push_back(h_3000_CT_noSC_DR07_E_rel_totVis_RMS_d1_cosT_0_80_to_0_925);
  hist_vec_3000_CT_noSC.push_back(h_3000_CT_noSC_DR07_E_rel_totVis_RMS_d1_cosT_0_925_to_1_00);


  for(unsigned int i=0;i<hist_vec_3000_CT_noSC.size();i++){
    hist_vec_3000_CT_noSC[i]->Sumw2();
  }

  fill_SC_jet_histograms(file_CLIC_3000_CT_noSC,hist_vec_3000_CT_noSC);

  TH1F* h_3000_CT_noSC_DR07_E_RMS90_summary_histogram=new TH1F("JER_RMS90VsCosTheta_CT_noSC_DR07_3000", "RMS_{90}(E_{j}^{reco}/E_{j}^{gen}) / Mean_{90}(E_{j}^{reco}/E_{j}^{gen}) vs |cos#theta|", nRegionBinsAngles, pRegionBinEdgesAngles);
  h_3000_CT_noSC_DR07_E_RMS90_summary_histogram ->SetYTitle("RMS_{90}(E_{j}^{reco}/E_{j}^{gen}) / Mean_{90}(E_{j}^{reco}/E_{j}^{gen}) [%]");
  h_3000_CT_noSC_DR07_E_RMS90_summary_histogram->SetXTitle("|cos#theta|");
  h_3000_CT_noSC_DR07_E_RMS90_summary_histogram->SetLineWidth(2);
  h_3000_CT_noSC_DR07_E_RMS90_summary_histogram->SetLineColor(kRed);
  h_3000_CT_noSC_DR07_E_RMS90_summary_histogram->SetLineStyle(2);
  //for energies still keep sqrt(2) from original total energy calculation
  for(int i=0;i<4;i++){
    resolutionTH1=0; 
    resolutionErrorTH1=0;
    meanTH1=0;
    meanErrorTH1=0;
    CalculatePerformance( hist_vec_3000_CT_noSC[i], resolutionTH1, resolutionErrorTH1,meanTH1,meanErrorTH1);
    h_3000_CT_noSC_DR07_E_RMS90_summary_histogram->SetBinContent(i+1,resolutionTH1/sqrt(2.));
    h_3000_CT_noSC_DR07_E_RMS90_summary_histogram ->SetBinError(i+1, resolutionErrorTH1/sqrt(2.));
  }
  gre_DR07_RMS90_JER_0_65_noSC->SetPoint(5,1500,h_3000_CT_noSC_DR07_E_RMS90_summary_histogram->GetBinContent(1));
  gre_DR07_RMS90_JER_0_65_noSC->SetPointError(5,0,h_3000_CT_noSC_DR07_E_RMS90_summary_histogram->GetBinError(1));

  gre_DR07_RMS90_JER_0_65_to_0_80_noSC->SetPoint(5,1500,h_3000_CT_noSC_DR07_E_RMS90_summary_histogram->GetBinContent(2));
  gre_DR07_RMS90_JER_0_65_to_0_80_noSC->SetPointError(5,0,h_3000_CT_noSC_DR07_E_RMS90_summary_histogram->GetBinError(2));

  gre_DR07_RMS90_JER_0_80_to_0_925_noSC->SetPoint(5,1500,h_3000_CT_noSC_DR07_E_RMS90_summary_histogram->GetBinContent(3));
  gre_DR07_RMS90_JER_0_80_to_0_925_noSC->SetPointError(5,0,h_3000_CT_noSC_DR07_E_RMS90_summary_histogram->GetBinError(3));

  gre_DR07_RMS90_JER_0_925_to_1_00_noSC->SetPoint(5,1500,h_3000_CT_noSC_DR07_E_RMS90_summary_histogram->GetBinContent(4));
  gre_DR07_RMS90_JER_0_925_to_1_00_noSC->SetPointError(5,0,h_3000_CT_noSC_DR07_E_RMS90_summary_histogram->GetBinError(4));

  std::cout<<"before 3000 CT_wO_noSC"<<std::endl;

  TH1F* h_3000_CT_wO_noSC_DR07_E_rel_totVis_RMS_d1_cosT_0_to_0_65 =  new TH1F("h_3000_CT_wO_noSC_DR07_E_rel_totVis_RMS_d1_cosT_0_to_0_65","", n_binsJER, lim_E_rel_low,lim_E_rel_high);
  TH1F* h_3000_CT_wO_noSC_DR07_E_rel_totVis_RMS_d1_cosT_0_65_to_0_80 =  new TH1F("h_3000_CT_wO_noSC_DR07_E_rel_totVis_RMS_d1_cosT_0_65_to_0_80","", n_binsJER, lim_E_rel_low,lim_E_rel_high);
  TH1F* h_3000_CT_wO_noSC_DR07_E_rel_totVis_RMS_d1_cosT_0_80_to_0_925 =  new TH1F("h_3000_CT_wO_noSC_DR07_E_rel_totVis_RMS_d1_cosT_0_80_to_0_925","", n_binsJER, lim_E_rel_low,lim_E_rel_high);
  TH1F* h_3000_CT_wO_noSC_DR07_E_rel_totVis_RMS_d1_cosT_0_925_to_1_00 =  new TH1F("h_3000_CT_wO_noSC_DR07_E_rel_totVis_RMS_d1_cosT_0_925_to_1_00","", n_binsJER, lim_E_rel_low,lim_E_rel_high);

  std::vector<TH1F*> hist_vec_3000_CT_wO_noSC;
  hist_vec_3000_CT_wO_noSC.push_back(h_3000_CT_wO_noSC_DR07_E_rel_totVis_RMS_d1_cosT_0_to_0_65);
  hist_vec_3000_CT_wO_noSC.push_back(h_3000_CT_wO_noSC_DR07_E_rel_totVis_RMS_d1_cosT_0_65_to_0_80);
  hist_vec_3000_CT_wO_noSC.push_back(h_3000_CT_wO_noSC_DR07_E_rel_totVis_RMS_d1_cosT_0_80_to_0_925);
  hist_vec_3000_CT_wO_noSC.push_back(h_3000_CT_wO_noSC_DR07_E_rel_totVis_RMS_d1_cosT_0_925_to_1_00);


  for(unsigned int i=0;i<hist_vec_3000_CT_wO_noSC.size();i++){
    hist_vec_3000_CT_wO_noSC[i]->Sumw2();
  }

  fill_SC_jet_histograms(file_CLIC_3000_CT_noSC_wO,hist_vec_3000_CT_wO_noSC);

  TH1F* h_3000_CT_wO_noSC_DR07_E_RMS90_summary_histogram=new TH1F("JER_RMS90VsCosTheta_CT_wO_noSC_DR07_3000", "RMS_{90}(E_{j}^{reco}/E_{j}^{gen}) / Mean_{90}(E_{j}^{reco}/E_{j}^{gen}) vs |cos#theta|", nRegionBinsAngles, pRegionBinEdgesAngles);
  h_3000_CT_wO_noSC_DR07_E_RMS90_summary_histogram ->SetYTitle("RMS_{90}(E_{j}^{reco}/E_{j}^{gen}) / Mean_{90}(E_{j}^{reco}/E_{j}^{gen}) [%]");
  h_3000_CT_wO_noSC_DR07_E_RMS90_summary_histogram->SetXTitle("|cos#theta|");
  h_3000_CT_wO_noSC_DR07_E_RMS90_summary_histogram->SetLineWidth(2);
  h_3000_CT_wO_noSC_DR07_E_RMS90_summary_histogram->SetLineColor(kRed);
  h_3000_CT_wO_noSC_DR07_E_RMS90_summary_histogram->SetLineStyle(2);
  //for energies still keep sqrt(2) from original total energy calculation
  for(int i=0;i<4;i++){
    resolutionTH1=0; 
    resolutionErrorTH1=0;
    meanTH1=0;
    meanErrorTH1=0;
    CalculatePerformance( hist_vec_3000_CT_wO_noSC[i], resolutionTH1, resolutionErrorTH1,meanTH1,meanErrorTH1);
    h_3000_CT_wO_noSC_DR07_E_RMS90_summary_histogram->SetBinContent(i+1,resolutionTH1/sqrt(2.));
    h_3000_CT_wO_noSC_DR07_E_RMS90_summary_histogram ->SetBinError(i+1, resolutionErrorTH1/sqrt(2.));
  }
  gre_DR07_RMS90_JER_0_65_wO_noSC->SetPoint(5,1500,h_3000_CT_wO_noSC_DR07_E_RMS90_summary_histogram->GetBinContent(1));
  gre_DR07_RMS90_JER_0_65_wO_noSC->SetPointError(5,0,h_3000_CT_wO_noSC_DR07_E_RMS90_summary_histogram->GetBinError(1));

  gre_DR07_RMS90_JER_0_65_to_0_80_wO_noSC->SetPoint(5,1500,h_3000_CT_wO_noSC_DR07_E_RMS90_summary_histogram->GetBinContent(2));
  gre_DR07_RMS90_JER_0_65_to_0_80_wO_noSC->SetPointError(5,0,h_3000_CT_wO_noSC_DR07_E_RMS90_summary_histogram->GetBinError(2));

  gre_DR07_RMS90_JER_0_80_to_0_925_wO_noSC->SetPoint(5,1500,h_3000_CT_wO_noSC_DR07_E_RMS90_summary_histogram->GetBinContent(3));
  gre_DR07_RMS90_JER_0_80_to_0_925_wO_noSC->SetPointError(5,0,h_3000_CT_wO_noSC_DR07_E_RMS90_summary_histogram->GetBinError(3));

  gre_DR07_RMS90_JER_0_925_to_1_00_wO_noSC->SetPoint(5,1500,h_3000_CT_wO_noSC_DR07_E_RMS90_summary_histogram->GetBinContent(4));
  gre_DR07_RMS90_JER_0_925_to_1_00_wO_noSC->SetPointError(5,0,h_3000_CT_wO_noSC_DR07_E_RMS90_summary_histogram->GetBinError(4));


  /*
  int n_bins100_MET=75;
  int n_bins1000_MET=1000;

  float lim_E_low=2500;
  float lim_E_low_jets=2000;
  float lim_E_high_jets=4000;
  float lim_E_high=6000;
  float lim_MET_rel_low=-5.0;
  float lim_MET_rel_high=5.00;



  TH1F* h_OverlayLoose_px_miss_totPFO =  new TH1F("h_OverlayLoose_px_miss_totPFO","", n_bins100_MET, -250.,250.);
  TH1F* h_OverlayLoose_delta_MET_totPFO_MET_true =  new TH1F("h_OverlayLoose_delta_MET_totPFO","", n_bins100_MET, -250,250);
  TH1F* h_OverlayLoose_MET_totPFO =  new TH1F("h_OverlayLoose_MET_totPFO","", n_bins100_MET, 0,1000);
  TH1F* h_OverlayLoose_E_totPFO =  new TH1F("h_OverlayLoose_E_totPFO","", n_bins100_MET, lim_E_low,lim_E_high);
  TH1F* h_OverlayLoose_METPhi_totPFO =  new TH1F("h_OverlayLoose_METPhi_totPFO","", n_bins100_MET, -180.0,180.);
  TH1F* h_OverlayLoose_MET_true =  new TH1F("h_OverlayLoose_MET_true","", n_bins100_MET, 0,1000);
  TH1F* h_OverlayLoose_METPhi_true =  new TH1F("h_OverlayLoose_METPhi_true","", n_bins100_MET, -180,180);
  TH1F* h_OverlayLoose_dphi_MET_true_reco =  new TH1F("h_OverlayLoose_dphi_MET_true_reco","", n_bins100_MET, -90.,90.);
  TH1F* h_OverlayLoose_deltaMET_over_trueMET_0_25 =  new TH1F("h_OverlayLoose_deltaMET_over_trueMET_0_25","", n_bins1000_MET, lim_MET_rel_low,lim_MET_rel_high);
  TH1F* h_OverlayLoose_dphi_recoMET_trueMET_0_25 =  new TH1F("h_OverlayLoose_dphi_recoMET_trueMET_0_25","", n_bins1000_MET, -90.,90.);
  TH1F* h_OverlayLoose_deltaMET_over_trueMET_25_50 =  new TH1F("h_OverlayLoose_deltaMET_over_trueMET_25_50","", n_bins1000_MET, lim_MET_rel_low,lim_MET_rel_high);
  TH1F* h_OverlayLoose_dphi_recoMET_trueMET_25_50 =  new TH1F("h_OverlayLoose_dphi_recoMET_trueMET_25_50","", n_bins1000_MET, -90.,90.);
  TH1F* h_OverlayLoose_deltaMET_over_trueMET_50_75 =  new TH1F("h_OverlayLoose_deltaMET_over_trueMET_50_75","", n_bins1000_MET, lim_MET_rel_low,lim_MET_rel_high);
  TH1F* h_OverlayLoose_dphi_recoMET_trueMET_50_75 =  new TH1F("h_OverlayLoose_dphi_recoMET_trueMET_50_75","", n_bins1000_MET, -90.,90.);
  TH1F* h_OverlayLoose_deltaMET_over_trueMET_75_100 =  new TH1F("h_OverlayLoose_deltaMET_over_trueMET_75_100","", n_bins1000_MET, lim_MET_rel_low,lim_MET_rel_high);
  TH1F* h_OverlayLoose_dphi_recoMET_trueMET_75_100 =  new TH1F("h_OverlayLoose_dphi_recoMET_trueMET_75_100","", n_bins1000_MET, -90.,90.);
  TH1F* h_OverlayLoose_deltaMET_over_trueMET_100_140 =  new TH1F("h_OverlayLoose_deltaMET_over_trueMET_100_140","", n_bins1000_MET, lim_MET_rel_low,lim_MET_rel_high);
  TH1F* h_OverlayLoose_dphi_recoMET_trueMET_100_140 =  new TH1F("h_OverlayLoose_dphi_recoMET_trueMET_100_140","", n_bins1000_MET, -90.,90.);
  TH1F* h_OverlayLoose_deltaMET_over_trueMET_140_180 =  new TH1F("h_OverlayLoose_deltaMET_over_trueMET_140_180","", n_bins1000_MET, lim_MET_rel_low,lim_MET_rel_high);
  TH1F* h_OverlayLoose_dphi_recoMET_trueMET_140_180 =  new TH1F("h_OverlayLoose_dphi_recoMET_trueMET_140_180","", n_bins1000_MET, -90.,90.);
  TH1F* h_OverlayLoose_deltaMET_over_trueMET_180_220 =  new TH1F("h_OverlayLoose_deltaMET_over_trueMET_180_220","", n_bins1000_MET, lim_MET_rel_low,lim_MET_rel_high);
  TH1F* h_OverlayLoose_dphi_recoMET_trueMET_180_220 =  new TH1F("h_OverlayLoose_dphi_recoMET_trueMET_180_220","", n_bins1000_MET, -90.,90.);
  TH1F* h_OverlayLoose_deltaMET_over_trueMET_220_260 =  new TH1F("h_OverlayLoose_deltaMET_over_trueMET_220_260","", n_bins1000_MET, lim_MET_rel_low,lim_MET_rel_high);
  TH1F* h_OverlayLoose_dphi_recoMET_trueMET_220_260 =  new TH1F("h_OverlayLoose_dphi_recoMET_trueMET_220_260","", n_bins1000_MET, -90.,90.);
  TH1F* h_OverlayLoose_deltaMET_over_trueMET_260_340 =  new TH1F("h_OverlayLoose_deltaMET_over_trueMET_260_340","", n_bins1000_MET, lim_MET_rel_low,lim_MET_rel_high);
  TH1F* h_OverlayLoose_dphi_recoMET_trueMET_260_340 =  new TH1F("h_OverlayLoose_dphi_recoMET_trueMET_260_340","", n_bins1000_MET, -90.,90.);
  TH1F* h_OverlayLoose_deltaMET_over_trueMET_340_420 =  new TH1F("h_OverlayLoose_deltaMET_over_trueMET_340_420","", n_bins1000_MET, lim_MET_rel_low,lim_MET_rel_high);
  TH1F* h_OverlayLoose_dphi_recoMET_trueMET_340_420 =  new TH1F("h_OverlayLoose_dphi_recoMET_trueMET_340_420","", n_bins1000_MET, -90.,90.);
  TH1F* h_OverlayLoose_deltaMET_over_trueMET_420_500 =  new TH1F("h_OverlayLoose_deltaMET_over_trueMET_420_500","", n_bins1000_MET, lim_MET_rel_low,lim_MET_rel_high);
  TH1F* h_OverlayLoose_dphi_recoMET_trueMET_420_500 =  new TH1F("h_OverlayLoose_dphi_recoMET_trueMET_420_500","", n_bins1000_MET, -90.,90.);
  TH1F* h_OverlayLoose_deltaMET_over_trueMET_500_750 =  new TH1F("h_OverlayLoose_deltaMET_over_trueMET_500_750","", n_bins1000_MET, lim_MET_rel_low,lim_MET_rel_high);
  TH1F* h_OverlayLoose_dphi_recoMET_trueMET_500_750 =  new TH1F("h_OverlayLoose_dphi_recoMET_trueMET_500_750","", n_bins1000_MET, -90.,90.);
  TH1F* h_OverlayLoose_deltaMET_over_trueMET_750_Inf =  new TH1F("h_OverlayLoose_deltaMET_over_trueMET_750_Inf","", n_bins1000_MET, lim_MET_rel_low,lim_MET_rel_high);
  TH1F* h_OverlayLoose_dphi_recoMET_trueMET_750_Inf =  new TH1F("h_OverlayLoose_dphi_recoMET_trueMET_750_Inf","", n_bins1000_MET, -90.,90.);

  std::vector<TH1F*>h_vec_OverlayLoose;
  h_vec_OverlayLoose.push_back(h_OverlayLoose_px_miss_totPFO);
  h_vec_OverlayLoose.push_back(h_OverlayLoose_delta_MET_totPFO_MET_true);
  h_vec_OverlayLoose.push_back(h_OverlayLoose_MET_totPFO);
  h_vec_OverlayLoose.push_back(h_OverlayLoose_E_totPFO);
  h_vec_OverlayLoose.push_back(h_OverlayLoose_METPhi_totPFO);
  h_vec_OverlayLoose.push_back(h_OverlayLoose_MET_true);
  h_vec_OverlayLoose.push_back(h_OverlayLoose_METPhi_true);
  h_vec_OverlayLoose.push_back(h_OverlayLoose_dphi_MET_true_reco);
  h_vec_OverlayLoose.push_back(h_OverlayLoose_deltaMET_over_trueMET_0_25);
  h_vec_OverlayLoose.push_back(h_OverlayLoose_dphi_recoMET_trueMET_0_25);
  h_vec_OverlayLoose.push_back(h_OverlayLoose_deltaMET_over_trueMET_25_50);
  h_vec_OverlayLoose.push_back(h_OverlayLoose_dphi_recoMET_trueMET_25_50);
  h_vec_OverlayLoose.push_back(h_OverlayLoose_deltaMET_over_trueMET_50_75);
  h_vec_OverlayLoose.push_back(h_OverlayLoose_dphi_recoMET_trueMET_50_75);
  h_vec_OverlayLoose.push_back(h_OverlayLoose_deltaMET_over_trueMET_75_100);
  h_vec_OverlayLoose.push_back(h_OverlayLoose_dphi_recoMET_trueMET_75_100);
  h_vec_OverlayLoose.push_back(h_OverlayLoose_deltaMET_over_trueMET_100_140);
  h_vec_OverlayLoose.push_back(h_OverlayLoose_dphi_recoMET_trueMET_100_140);
  h_vec_OverlayLoose.push_back(h_OverlayLoose_deltaMET_over_trueMET_140_180);
  h_vec_OverlayLoose.push_back(h_OverlayLoose_dphi_recoMET_trueMET_140_180);
  h_vec_OverlayLoose.push_back(h_OverlayLoose_deltaMET_over_trueMET_180_220);
  h_vec_OverlayLoose.push_back(h_OverlayLoose_dphi_recoMET_trueMET_180_220);
  h_vec_OverlayLoose.push_back(h_OverlayLoose_deltaMET_over_trueMET_220_260);
  h_vec_OverlayLoose.push_back(h_OverlayLoose_dphi_recoMET_trueMET_220_260);
  h_vec_OverlayLoose.push_back(h_OverlayLoose_deltaMET_over_trueMET_260_340);
  h_vec_OverlayLoose.push_back(h_OverlayLoose_dphi_recoMET_trueMET_260_340);
  h_vec_OverlayLoose.push_back(h_OverlayLoose_deltaMET_over_trueMET_340_420);
  h_vec_OverlayLoose.push_back(h_OverlayLoose_dphi_recoMET_trueMET_340_420);
  h_vec_OverlayLoose.push_back(h_OverlayLoose_deltaMET_over_trueMET_420_500);
  h_vec_OverlayLoose.push_back(h_OverlayLoose_dphi_recoMET_trueMET_420_500);
  h_vec_OverlayLoose.push_back(h_OverlayLoose_deltaMET_over_trueMET_500_750);
  h_vec_OverlayLoose.push_back(h_OverlayLoose_dphi_recoMET_trueMET_500_750);
  h_vec_OverlayLoose.push_back(h_OverlayLoose_deltaMET_over_trueMET_750_Inf);
  h_vec_OverlayLoose.push_back(h_OverlayLoose_dphi_recoMET_trueMET_750_Inf);

  for(unsigned int i=0;i<h_vec_OverlayLoose.size();i++){
    h_vec_OverlayLoose[i]->SetLineWidth(3);
    h_vec_OverlayLoose[i]->SetLineColor(kBlue);
    h_vec_OverlayLoose[i]->Sumw2();
  }

  fill_background_missingPT_histograms(file_OverlayLoose,h_vec_OverlayLoose,m_top_CosTheta);

  const unsigned int nRegionBins_MET(13);
  //float pRegionBinEdges_MET[nRegionBins_MET + 1] = {0, 25., 50., 75., 100., 140., 180., 220., 260., 340., 420., 500., 750., 1500.};
  float pRegionBinEdges_MET[nRegionBins_MET + 1] = {0, 25., 50., 75., 100., 140., 180., 220., 260., 340., 420., 500., 750., 1010.};

  TH1F* h_OverlayLoose_METRes_RMS90VsMET_0_1500_summary_histogram=new TH1F("h_OverlayLoose_METRes_RMS90VsMET_0_1500_summary_histogram", "RMS_{90}(E_{j}) / Mean_{90}(E_{j}) vs |cos(#theta)|", nRegionBins_MET, pRegionBinEdges_MET);
  h_OverlayLoose_METRes_RMS90VsMET_0_1500_summary_histogram->SetYTitle("RMS_{90}(#Delta#slash{p}_{T}/#slash{p}_{T,true}) [%]");
  h_OverlayLoose_METRes_RMS90VsMET_0_1500_summary_histogram->SetXTitle("#slash{p}_{T,true} [GeV]");
  h_OverlayLoose_METRes_RMS90VsMET_0_1500_summary_histogram->SetLineWidth(3);
  h_OverlayLoose_METRes_RMS90VsMET_0_1500_summary_histogram->SetLineColor(kBlue);
  h_OverlayLoose_METRes_RMS90VsMET_0_1500_summary_histogram->SetLineStyle(1);

  TH1F* h_OverlayLoose_PhiRes_RMS90VsMET_0_1500_summary_histogram=new TH1F("h_OverlayLoose_PhiRes_RMS90VsMET_0_1500_summary_histogram", "RMS_{90}(E_{j}) / Mean_{90}(E_{j}) vs |cos(#theta)|", nRegionBins_MET, pRegionBinEdges_MET);
  h_OverlayLoose_PhiRes_RMS90VsMET_0_1500_summary_histogram->SetYTitle("RMS_{90}#Delta#phi(#vec{#slash{p}}_{T,reco},#vec{#slash{p}}_{T,true}) [#circ]");
  h_OverlayLoose_PhiRes_RMS90VsMET_0_1500_summary_histogram->SetXTitle("#slash{p}_{T,true} [GeV]");
  h_OverlayLoose_PhiRes_RMS90VsMET_0_1500_summary_histogram->SetLineWidth(3);
  h_OverlayLoose_PhiRes_RMS90VsMET_0_1500_summary_histogram->SetLineColor(kBlue);
  h_OverlayLoose_PhiRes_RMS90VsMET_0_1500_summary_histogram->SetLineStyle(1);

  int ibin=1;
  
  for(unsigned int i=8;i<h_vec_OverlayLoose.size();i++){
    resolutionTH1=0; 
    resolutionErrorTH1=0;
    meanTH1=0;
    meanErrorTH1=0;
    CalculatePerformanceNoMean( h_vec_OverlayLoose[i], resolutionTH1, resolutionErrorTH1,meanTH1,meanErrorTH1);
    std::cout<<"loose bin "<<i<<" res/error"<<resolutionTH1<<"/"<<resolutionErrorTH1<<" fill "<<ibin<<std::endl;
    CalculatePerformanceNoMean( h_vec_OverlayLoose[i+1], resolutionTH1, resolutionErrorTH1,meanTH1,meanErrorTH1);
    //RMS is calculated without %, to get the real RMS in % multiply by 100
    h_OverlayLoose_METRes_RMS90VsMET_0_1500_summary_histogram->SetBinContent(ibin,resolutionTH1*100.);
    h_OverlayLoose_METRes_RMS90VsMET_0_1500_summary_histogram ->SetBinError(ibin,resolutionErrorTH1*100.);
    resolutionTH1=0; 
    resolutionErrorTH1=0;
    meanTH1=0;
    meanErrorTH1=0;
    CalculatePerformanceNoMean( h_vec_OverlayLoose[i+1], resolutionTH1, resolutionErrorTH1,meanTH1,meanErrorTH1);
    std::cout<<"loose bin "<<i+1<<" res/error"<<resolutionTH1<<"/"<<resolutionErrorTH1<<" fill "<<ibin<<std::endl;
    h_OverlayLoose_PhiRes_RMS90VsMET_0_1500_summary_histogram->SetBinContent(ibin,resolutionTH1);
    h_OverlayLoose_PhiRes_RMS90VsMET_0_1500_summary_histogram->SetBinError(ibin,resolutionErrorTH1);
    i++;
    //effectively we always consider a pair of histograms
    ibin+=1;
  }
  

  TH1F* h_OverlaySelected_px_miss_totPFO =  new TH1F("h_OverlaySelected_px_miss_totPFO","", n_bins100_MET, -250.,250.);
  TH1F* h_OverlaySelected_delta_MET_totPFO_MET_true =  new TH1F("h_OverlaySelected_delta_MET_totPFO","", n_bins100_MET, -250,250);
  TH1F* h_OverlaySelected_MET_totPFO =  new TH1F("h_OverlaySelected_MET_totPFO","", n_bins100_MET, 0,1000);
  TH1F* h_OverlaySelected_E_totPFO =  new TH1F("h_OverlaySelected_E_totPFO","", n_bins100_MET, lim_E_low,lim_E_high);
  TH1F* h_OverlaySelected_METPhi_totPFO =  new TH1F("h_OverlaySelected_METPhi_totPFO","", n_bins100_MET, -180.0,180.);
  TH1F* h_OverlaySelected_MET_true =  new TH1F("h_OverlaySelected_MET_true","", n_bins100_MET, 0,1000);
  TH1F* h_OverlaySelected_METPhi_true =  new TH1F("h_OverlaySelected_METPhi_true","", n_bins100_MET, -180,180);
  TH1F* h_OverlaySelected_dphi_MET_true_reco =  new TH1F("h_OverlaySelected_dphi_MET_true_reco","", n_bins100_MET, -90.,90.);
  TH1F* h_OverlaySelected_deltaMET_over_trueMET_0_25 =  new TH1F("h_OverlaySelected_deltaMET_over_trueMET_0_25","", n_bins1000_MET, lim_MET_rel_low,lim_MET_rel_high);
  TH1F* h_OverlaySelected_dphi_recoMET_trueMET_0_25 =  new TH1F("h_OverlaySelected_dphi_recoMET_trueMET_0_25","", n_bins1000_MET, -90.,90.);
  TH1F* h_OverlaySelected_deltaMET_over_trueMET_25_50 =  new TH1F("h_OverlaySelected_deltaMET_over_trueMET_25_50","", n_bins1000_MET, lim_MET_rel_low,lim_MET_rel_high);
  TH1F* h_OverlaySelected_dphi_recoMET_trueMET_25_50 =  new TH1F("h_OverlaySelected_dphi_recoMET_trueMET_25_50","", n_bins1000_MET, -90.,90.);
  TH1F* h_OverlaySelected_deltaMET_over_trueMET_50_75 =  new TH1F("h_OverlaySelected_deltaMET_over_trueMET_50_75","", n_bins1000_MET, lim_MET_rel_low,lim_MET_rel_high);
  TH1F* h_OverlaySelected_dphi_recoMET_trueMET_50_75 =  new TH1F("h_OverlaySelected_dphi_recoMET_trueMET_50_75","", n_bins1000_MET, -90.,90.);
  TH1F* h_OverlaySelected_deltaMET_over_trueMET_75_100 =  new TH1F("h_OverlaySelected_deltaMET_over_trueMET_75_100","", n_bins1000_MET, lim_MET_rel_low,lim_MET_rel_high);
  TH1F* h_OverlaySelected_dphi_recoMET_trueMET_75_100 =  new TH1F("h_OverlaySelected_dphi_recoMET_trueMET_75_100","", n_bins1000_MET, -90.,90.);
  TH1F* h_OverlaySelected_deltaMET_over_trueMET_100_140 =  new TH1F("h_OverlaySelected_deltaMET_over_trueMET_100_140","", n_bins1000_MET, lim_MET_rel_low,lim_MET_rel_high);
  TH1F* h_OverlaySelected_dphi_recoMET_trueMET_100_140 =  new TH1F("h_OverlaySelected_dphi_recoMET_trueMET_100_140","", n_bins1000_MET, -90.,90.);
  TH1F* h_OverlaySelected_deltaMET_over_trueMET_140_180 =  new TH1F("h_OverlaySelected_deltaMET_over_trueMET_140_180","", n_bins1000_MET, lim_MET_rel_low,lim_MET_rel_high);
  TH1F* h_OverlaySelected_dphi_recoMET_trueMET_140_180 =  new TH1F("h_OverlaySelected_dphi_recoMET_trueMET_140_180","", n_bins1000_MET, -90.,90.);
  TH1F* h_OverlaySelected_deltaMET_over_trueMET_180_220 =  new TH1F("h_OverlaySelected_deltaMET_over_trueMET_180_220","", n_bins1000_MET, lim_MET_rel_low,lim_MET_rel_high);
  TH1F* h_OverlaySelected_dphi_recoMET_trueMET_180_220 =  new TH1F("h_OverlaySelected_dphi_recoMET_trueMET_180_220","", n_bins1000_MET, -90.,90.);
  TH1F* h_OverlaySelected_deltaMET_over_trueMET_220_260 =  new TH1F("h_OverlaySelected_deltaMET_over_trueMET_220_260","", n_bins1000_MET, lim_MET_rel_low,lim_MET_rel_high);
  TH1F* h_OverlaySelected_dphi_recoMET_trueMET_220_260 =  new TH1F("h_OverlaySelected_dphi_recoMET_trueMET_220_260","", n_bins1000_MET, -90.,90.);
  TH1F* h_OverlaySelected_deltaMET_over_trueMET_260_340 =  new TH1F("h_OverlaySelected_deltaMET_over_trueMET_260_340","", n_bins1000_MET, lim_MET_rel_low,lim_MET_rel_high);
  TH1F* h_OverlaySelected_dphi_recoMET_trueMET_260_340 =  new TH1F("h_OverlaySelected_dphi_recoMET_trueMET_260_340","", n_bins1000_MET, -90.,90.);
  TH1F* h_OverlaySelected_deltaMET_over_trueMET_340_420 =  new TH1F("h_OverlaySelected_deltaMET_over_trueMET_340_420","", n_bins1000_MET, lim_MET_rel_low,lim_MET_rel_high);
  TH1F* h_OverlaySelected_dphi_recoMET_trueMET_340_420 =  new TH1F("h_OverlaySelected_dphi_recoMET_trueMET_340_420","", n_bins1000_MET, -90.,90.);
  TH1F* h_OverlaySelected_deltaMET_over_trueMET_420_500 =  new TH1F("h_OverlaySelected_deltaMET_over_trueMET_420_500","", n_bins1000_MET, lim_MET_rel_low,lim_MET_rel_high);
  TH1F* h_OverlaySelected_dphi_recoMET_trueMET_420_500 =  new TH1F("h_OverlaySelected_dphi_recoMET_trueMET_420_500","", n_bins1000_MET, -90.,90.);
  TH1F* h_OverlaySelected_deltaMET_over_trueMET_500_750 =  new TH1F("h_OverlaySelected_deltaMET_over_trueMET_500_750","", n_bins1000_MET, lim_MET_rel_low,lim_MET_rel_high);
  TH1F* h_OverlaySelected_dphi_recoMET_trueMET_500_750 =  new TH1F("h_OverlaySelected_dphi_recoMET_trueMET_500_750","", n_bins1000_MET, -90.,90.);
  TH1F* h_OverlaySelected_deltaMET_over_trueMET_750_Inf =  new TH1F("h_OverlaySelected_deltaMET_over_trueMET_750_Inf","", n_bins1000_MET, lim_MET_rel_low,lim_MET_rel_high);
  TH1F* h_OverlaySelected_dphi_recoMET_trueMET_750_Inf =  new TH1F("h_OverlaySelected_dphi_recoMET_trueMET_750_Inf","", n_bins1000_MET, -90.,90.);

  std::vector<TH1F*>h_vec_OverlaySelected;
  h_vec_OverlaySelected.push_back(h_OverlaySelected_px_miss_totPFO);
  h_vec_OverlaySelected.push_back(h_OverlaySelected_delta_MET_totPFO_MET_true);
  h_vec_OverlaySelected.push_back(h_OverlaySelected_MET_totPFO);
  h_vec_OverlaySelected.push_back(h_OverlaySelected_E_totPFO);
  h_vec_OverlaySelected.push_back(h_OverlaySelected_METPhi_totPFO);
  h_vec_OverlaySelected.push_back(h_OverlaySelected_MET_true);
  h_vec_OverlaySelected.push_back(h_OverlaySelected_METPhi_true);
  h_vec_OverlaySelected.push_back(h_OverlaySelected_dphi_MET_true_reco);
  h_vec_OverlaySelected.push_back(h_OverlaySelected_deltaMET_over_trueMET_0_25);
  h_vec_OverlaySelected.push_back(h_OverlaySelected_dphi_recoMET_trueMET_0_25);
  h_vec_OverlaySelected.push_back(h_OverlaySelected_deltaMET_over_trueMET_25_50);
  h_vec_OverlaySelected.push_back(h_OverlaySelected_dphi_recoMET_trueMET_25_50);
  h_vec_OverlaySelected.push_back(h_OverlaySelected_deltaMET_over_trueMET_50_75);
  h_vec_OverlaySelected.push_back(h_OverlaySelected_dphi_recoMET_trueMET_50_75);
  h_vec_OverlaySelected.push_back(h_OverlaySelected_deltaMET_over_trueMET_75_100);
  h_vec_OverlaySelected.push_back(h_OverlaySelected_dphi_recoMET_trueMET_75_100);
  h_vec_OverlaySelected.push_back(h_OverlaySelected_deltaMET_over_trueMET_100_140);
  h_vec_OverlaySelected.push_back(h_OverlaySelected_dphi_recoMET_trueMET_100_140);
  h_vec_OverlaySelected.push_back(h_OverlaySelected_deltaMET_over_trueMET_140_180);
  h_vec_OverlaySelected.push_back(h_OverlaySelected_dphi_recoMET_trueMET_140_180);
  h_vec_OverlaySelected.push_back(h_OverlaySelected_deltaMET_over_trueMET_180_220);
  h_vec_OverlaySelected.push_back(h_OverlaySelected_dphi_recoMET_trueMET_180_220);
  h_vec_OverlaySelected.push_back(h_OverlaySelected_deltaMET_over_trueMET_220_260);
  h_vec_OverlaySelected.push_back(h_OverlaySelected_dphi_recoMET_trueMET_220_260);
  h_vec_OverlaySelected.push_back(h_OverlaySelected_deltaMET_over_trueMET_260_340);
  h_vec_OverlaySelected.push_back(h_OverlaySelected_dphi_recoMET_trueMET_260_340);
  h_vec_OverlaySelected.push_back(h_OverlaySelected_deltaMET_over_trueMET_340_420);
  h_vec_OverlaySelected.push_back(h_OverlaySelected_dphi_recoMET_trueMET_340_420);
  h_vec_OverlaySelected.push_back(h_OverlaySelected_deltaMET_over_trueMET_420_500);
  h_vec_OverlaySelected.push_back(h_OverlaySelected_dphi_recoMET_trueMET_420_500);
  h_vec_OverlaySelected.push_back(h_OverlaySelected_deltaMET_over_trueMET_500_750);
  h_vec_OverlaySelected.push_back(h_OverlaySelected_dphi_recoMET_trueMET_500_750);
  h_vec_OverlaySelected.push_back(h_OverlaySelected_deltaMET_over_trueMET_750_Inf);
  h_vec_OverlaySelected.push_back(h_OverlaySelected_dphi_recoMET_trueMET_750_Inf);

  for(unsigned int i=0;i<h_vec_OverlaySelected.size();i++){
    h_vec_OverlaySelected[i]->SetLineWidth(3);
    h_vec_OverlaySelected[i]->SetLineColor(kRed-7);
    h_vec_OverlaySelected[i]->Sumw2();
  }

  fill_background_missingPT_histograms(file_OverlaySelected,h_vec_OverlaySelected,m_top_CosTheta);

  TH1F* h_OverlaySelected_METRes_RMS90VsMET_0_1500_summary_histogram=new TH1F("h_OverlaySelected_METRes_RMS90VsMET_0_1500_summary_histogram", "RMS_{90}(E_{j}) / Mean_{90}(E_{j}) vs |cos(#theta)|", nRegionBins_MET, pRegionBinEdges_MET);
  h_OverlaySelected_METRes_RMS90VsMET_0_1500_summary_histogram->SetYTitle("RMS_{90}(#Delta#slash{p}_{T}/#slash{p}_{T,true}) [%]");
  h_OverlaySelected_METRes_RMS90VsMET_0_1500_summary_histogram->SetXTitle("#slash{p}_{T,true} [GeV]");
  h_OverlaySelected_METRes_RMS90VsMET_0_1500_summary_histogram->SetLineWidth(3);
  h_OverlaySelected_METRes_RMS90VsMET_0_1500_summary_histogram->SetLineColor(kRed-7);
  h_OverlaySelected_METRes_RMS90VsMET_0_1500_summary_histogram->SetLineStyle(1);

  TH1F* h_OverlaySelected_PhiRes_RMS90VsMET_0_1500_summary_histogram=new TH1F("h_OverlaySelected_PhiRes_RMS90VsMET_0_1500_summary_histogram", "RMS_{90}(E_{j}) / Mean_{90}(E_{j}) vs |cos(#theta)|", nRegionBins_MET, pRegionBinEdges_MET);
  h_OverlaySelected_PhiRes_RMS90VsMET_0_1500_summary_histogram->SetYTitle("RMS_{90}#Delta#phi(#vec{#slash{p}}_{T,reco},#vec{#slash{p}}_{T,true}) [#circ]");
  h_OverlaySelected_PhiRes_RMS90VsMET_0_1500_summary_histogram->SetXTitle("#slash{p}_{T,true} [GeV]");
  h_OverlaySelected_PhiRes_RMS90VsMET_0_1500_summary_histogram->SetLineWidth(3);
  h_OverlaySelected_PhiRes_RMS90VsMET_0_1500_summary_histogram->SetLineColor(kRed-7);
  h_OverlaySelected_PhiRes_RMS90VsMET_0_1500_summary_histogram->SetLineStyle(1);

  ibin=1;
  for(unsigned int i=8;i<h_vec_OverlaySelected.size();i++){
    resolutionTH1=0; 
    resolutionErrorTH1=0;
    meanTH1=0;
    meanErrorTH1=0;
    CalculatePerformanceNoMean( h_vec_OverlaySelected[i], resolutionTH1, resolutionErrorTH1,meanTH1,meanErrorTH1);
    std::cout<<"bin "<<i<<" res/error"<<resolutionTH1<<"/"<<resolutionErrorTH1<<" fill "<<ibin<<std::endl;
    //RMS is not calculated in %, to get the real RMSin % out multiply by 100
    h_OverlaySelected_METRes_RMS90VsMET_0_1500_summary_histogram->SetBinContent(ibin,resolutionTH1*100.);
    h_OverlaySelected_METRes_RMS90VsMET_0_1500_summary_histogram ->SetBinError(ibin,resolutionErrorTH1*100.);
    resolutionTH1=0; 
    resolutionErrorTH1=0;
    meanTH1=0;
    meanErrorTH1=0;
    CalculatePerformanceNoMean( h_vec_OverlaySelected[i+1], resolutionTH1, resolutionErrorTH1,meanTH1,meanErrorTH1);
    std::cout<<"bin "<<i+1<<" res/error"<<resolutionTH1<<"/"<<resolutionErrorTH1<<" fill "<<ibin<<std::endl;
    h_OverlaySelected_PhiRes_RMS90VsMET_0_1500_summary_histogram->SetBinContent(ibin,resolutionTH1);
    h_OverlaySelected_PhiRes_RMS90VsMET_0_1500_summary_histogram->SetBinError(ibin,resolutionErrorTH1);
    i++;
    //effectively we always consider a pair of histograms
    ibin+=1;
  }

  TH1F* h_OverlayTight_px_miss_totPFO =  new TH1F("h_OverlayTight_px_miss_totPFO","", n_bins100_MET, -250.,250.);
  TH1F* h_OverlayTight_delta_MET_totPFO_MET_true =  new TH1F("h_OverlayTight_delta_MET_totPFO","", n_bins100_MET, -250,250);
  TH1F* h_OverlayTight_MET_totPFO =  new TH1F("h_OverlayTight_MET_totPFO","", n_bins100_MET, 0,1000);
  TH1F* h_OverlayTight_E_totPFO =  new TH1F("h_OverlayTight_E_totPFO","", n_bins100_MET, lim_E_low,lim_E_high);
  TH1F* h_OverlayTight_METPhi_totPFO =  new TH1F("h_OverlayTight_METPhi_totPFO","", n_bins100_MET, -180.0,180.);
  TH1F* h_OverlayTight_MET_true =  new TH1F("h_OverlayTight_MET_true","", n_bins100_MET, 0,1000);
  TH1F* h_OverlayTight_METPhi_true =  new TH1F("h_OverlayTight_METPhi_true","", n_bins100_MET, -180,180);
  TH1F* h_OverlayTight_dphi_MET_true_reco =  new TH1F("h_OverlayTight_dphi_MET_true_reco","", n_bins100_MET, -90.,90.);
  TH1F* h_OverlayTight_deltaMET_over_trueMET_0_25 =  new TH1F("h_OverlayTight_deltaMET_over_trueMET_0_25","", n_bins1000_MET, lim_MET_rel_low,lim_MET_rel_high);
  TH1F* h_OverlayTight_dphi_recoMET_trueMET_0_25 =  new TH1F("h_OverlayTight_dphi_recoMET_trueMET_0_25","", n_bins1000_MET, -90.,90.);
  TH1F* h_OverlayTight_deltaMET_over_trueMET_25_50 =  new TH1F("h_OverlayTight_deltaMET_over_trueMET_25_50","", n_bins1000_MET, lim_MET_rel_low,lim_MET_rel_high);
  TH1F* h_OverlayTight_dphi_recoMET_trueMET_25_50 =  new TH1F("h_OverlayTight_dphi_recoMET_trueMET_25_50","", n_bins1000_MET, -90.,90.);
  TH1F* h_OverlayTight_deltaMET_over_trueMET_50_75 =  new TH1F("h_OverlayTight_deltaMET_over_trueMET_50_75","", n_bins1000_MET, lim_MET_rel_low,lim_MET_rel_high);
  TH1F* h_OverlayTight_dphi_recoMET_trueMET_50_75 =  new TH1F("h_OverlayTight_dphi_recoMET_trueMET_50_75","", n_bins1000_MET, -90.,90.);
  TH1F* h_OverlayTight_deltaMET_over_trueMET_75_100 =  new TH1F("h_OverlayTight_deltaMET_over_trueMET_75_100","", n_bins1000_MET, lim_MET_rel_low,lim_MET_rel_high);
  TH1F* h_OverlayTight_dphi_recoMET_trueMET_75_100 =  new TH1F("h_OverlayTight_dphi_recoMET_trueMET_75_100","", n_bins1000_MET, -90.,90.);
  TH1F* h_OverlayTight_deltaMET_over_trueMET_100_140 =  new TH1F("h_OverlayTight_deltaMET_over_trueMET_100_140","", n_bins1000_MET, lim_MET_rel_low,lim_MET_rel_high);
  TH1F* h_OverlayTight_dphi_recoMET_trueMET_100_140 =  new TH1F("h_OverlayTight_dphi_recoMET_trueMET_100_140","", n_bins1000_MET, -90.,90.);
  TH1F* h_OverlayTight_deltaMET_over_trueMET_140_180 =  new TH1F("h_OverlayTight_deltaMET_over_trueMET_140_180","", n_bins1000_MET, lim_MET_rel_low,lim_MET_rel_high);
  TH1F* h_OverlayTight_dphi_recoMET_trueMET_140_180 =  new TH1F("h_OverlayTight_dphi_recoMET_trueMET_140_180","", n_bins1000_MET, -90.,90.);
  TH1F* h_OverlayTight_deltaMET_over_trueMET_180_220 =  new TH1F("h_OverlayTight_deltaMET_over_trueMET_180_220","", n_bins1000_MET, lim_MET_rel_low,lim_MET_rel_high);
  TH1F* h_OverlayTight_dphi_recoMET_trueMET_180_220 =  new TH1F("h_OverlayTight_dphi_recoMET_trueMET_180_220","", n_bins1000_MET, -90.,90.);
  TH1F* h_OverlayTight_deltaMET_over_trueMET_220_260 =  new TH1F("h_OverlayTight_deltaMET_over_trueMET_220_260","", n_bins1000_MET, lim_MET_rel_low,lim_MET_rel_high);
  TH1F* h_OverlayTight_dphi_recoMET_trueMET_220_260 =  new TH1F("h_OverlayTight_dphi_recoMET_trueMET_220_260","", n_bins1000_MET, -90.,90.);
  TH1F* h_OverlayTight_deltaMET_over_trueMET_260_340 =  new TH1F("h_OverlayTight_deltaMET_over_trueMET_260_340","", n_bins1000_MET, lim_MET_rel_low,lim_MET_rel_high);
  TH1F* h_OverlayTight_dphi_recoMET_trueMET_260_340 =  new TH1F("h_OverlayTight_dphi_recoMET_trueMET_260_340","", n_bins1000_MET, -90.,90.);
  TH1F* h_OverlayTight_deltaMET_over_trueMET_340_420 =  new TH1F("h_OverlayTight_deltaMET_over_trueMET_340_420","", n_bins1000_MET, lim_MET_rel_low,lim_MET_rel_high);
  TH1F* h_OverlayTight_dphi_recoMET_trueMET_340_420 =  new TH1F("h_OverlayTight_dphi_recoMET_trueMET_340_420","", n_bins1000_MET, -90.,90.);
  TH1F* h_OverlayTight_deltaMET_over_trueMET_420_500 =  new TH1F("h_OverlayTight_deltaMET_over_trueMET_420_500","", n_bins1000_MET, lim_MET_rel_low,lim_MET_rel_high);
  TH1F* h_OverlayTight_dphi_recoMET_trueMET_420_500 =  new TH1F("h_OverlayTight_dphi_recoMET_trueMET_420_500","", n_bins1000_MET, -90.,90.);
  TH1F* h_OverlayTight_deltaMET_over_trueMET_500_750 =  new TH1F("h_OverlayTight_deltaMET_over_trueMET_500_750","", n_bins1000_MET, lim_MET_rel_low,lim_MET_rel_high);
  TH1F* h_OverlayTight_dphi_recoMET_trueMET_500_750 =  new TH1F("h_OverlayTight_dphi_recoMET_trueMET_500_750","", n_bins1000_MET, -90.,90.);
  TH1F* h_OverlayTight_deltaMET_over_trueMET_750_Inf =  new TH1F("h_OverlayTight_deltaMET_over_trueMET_750_Inf","", n_bins1000_MET, lim_MET_rel_low,lim_MET_rel_high);
  TH1F* h_OverlayTight_dphi_recoMET_trueMET_750_Inf =  new TH1F("h_OverlayTight_dphi_recoMET_trueMET_750_Inf","", n_bins1000_MET, -90.,90.);

  std::vector<TH1F*>h_vec_OverlayTight;
  h_vec_OverlayTight.push_back(h_OverlayTight_px_miss_totPFO);
  h_vec_OverlayTight.push_back(h_OverlayTight_delta_MET_totPFO_MET_true);
  h_vec_OverlayTight.push_back(h_OverlayTight_MET_totPFO);
  h_vec_OverlayTight.push_back(h_OverlayTight_E_totPFO);
  h_vec_OverlayTight.push_back(h_OverlayTight_METPhi_totPFO);
  h_vec_OverlayTight.push_back(h_OverlayTight_MET_true);
  h_vec_OverlayTight.push_back(h_OverlayTight_METPhi_true);
  h_vec_OverlayTight.push_back(h_OverlayTight_dphi_MET_true_reco);
  h_vec_OverlayTight.push_back(h_OverlayTight_deltaMET_over_trueMET_0_25);
  h_vec_OverlayTight.push_back(h_OverlayTight_dphi_recoMET_trueMET_0_25);
  h_vec_OverlayTight.push_back(h_OverlayTight_deltaMET_over_trueMET_25_50);
  h_vec_OverlayTight.push_back(h_OverlayTight_dphi_recoMET_trueMET_25_50);
  h_vec_OverlayTight.push_back(h_OverlayTight_deltaMET_over_trueMET_50_75);
  h_vec_OverlayTight.push_back(h_OverlayTight_dphi_recoMET_trueMET_50_75);
  h_vec_OverlayTight.push_back(h_OverlayTight_deltaMET_over_trueMET_75_100);
  h_vec_OverlayTight.push_back(h_OverlayTight_dphi_recoMET_trueMET_75_100);
  h_vec_OverlayTight.push_back(h_OverlayTight_deltaMET_over_trueMET_100_140);
  h_vec_OverlayTight.push_back(h_OverlayTight_dphi_recoMET_trueMET_100_140);
  h_vec_OverlayTight.push_back(h_OverlayTight_deltaMET_over_trueMET_140_180);
  h_vec_OverlayTight.push_back(h_OverlayTight_dphi_recoMET_trueMET_140_180);
  h_vec_OverlayTight.push_back(h_OverlayTight_deltaMET_over_trueMET_180_220);
  h_vec_OverlayTight.push_back(h_OverlayTight_dphi_recoMET_trueMET_180_220);
  h_vec_OverlayTight.push_back(h_OverlayTight_deltaMET_over_trueMET_220_260);
  h_vec_OverlayTight.push_back(h_OverlayTight_dphi_recoMET_trueMET_220_260);
  h_vec_OverlayTight.push_back(h_OverlayTight_deltaMET_over_trueMET_260_340);
  h_vec_OverlayTight.push_back(h_OverlayTight_dphi_recoMET_trueMET_260_340);
  h_vec_OverlayTight.push_back(h_OverlayTight_deltaMET_over_trueMET_340_420);
  h_vec_OverlayTight.push_back(h_OverlayTight_dphi_recoMET_trueMET_340_420);
  h_vec_OverlayTight.push_back(h_OverlayTight_deltaMET_over_trueMET_420_500);
  h_vec_OverlayTight.push_back(h_OverlayTight_dphi_recoMET_trueMET_420_500);
  h_vec_OverlayTight.push_back(h_OverlayTight_deltaMET_over_trueMET_500_750);
  h_vec_OverlayTight.push_back(h_OverlayTight_dphi_recoMET_trueMET_500_750);
  h_vec_OverlayTight.push_back(h_OverlayTight_deltaMET_over_trueMET_750_Inf);
  h_vec_OverlayTight.push_back(h_OverlayTight_dphi_recoMET_trueMET_750_Inf);

  for(unsigned int i=0;i<h_vec_OverlayTight.size();i++){
    h_vec_OverlayTight[i]->SetLineWidth(3);
    h_vec_OverlayTight[i]->SetLineColor(kGreen+2);
    h_vec_OverlayTight[i]->Sumw2();
  }

  fill_background_missingPT_histograms(file_OverlayTight,h_vec_OverlayTight,m_top_CosTheta);

  TH1F* h_OverlayTight_METRes_RMS90VsMET_0_1500_summary_histogram=new TH1F("h_OverlayTight_METRes_RMS90VsMET_0_1500_summary_histogram", "RMS_{90}(E_{j}) / Mean_{90}(E_{j}) vs |cos(#theta)|", nRegionBins_MET, pRegionBinEdges_MET);
  h_OverlayTight_METRes_RMS90VsMET_0_1500_summary_histogram->SetYTitle("RMS_{90}(#Delta#slash{p}_{T}/#slash{p}_{T,true}) [%]");
  h_OverlayTight_METRes_RMS90VsMET_0_1500_summary_histogram->SetXTitle("#slash{p}_{T,true} [GeV]");
  h_OverlayTight_METRes_RMS90VsMET_0_1500_summary_histogram->SetLineWidth(3);
  h_OverlayTight_METRes_RMS90VsMET_0_1500_summary_histogram->SetLineColor(kGreen+2);
  h_OverlayTight_METRes_RMS90VsMET_0_1500_summary_histogram->SetLineStyle(1);

  TH1F* h_OverlayTight_PhiRes_RMS90VsMET_0_1500_summary_histogram=new TH1F("h_OverlayTight_PhiRes_RMS90VsMET_0_1500_summary_histogram", "RMS_{90}(E_{j}) / Mean_{90}(E_{j}) vs |cos(#theta)|", nRegionBins_MET, pRegionBinEdges_MET);
  h_OverlayTight_PhiRes_RMS90VsMET_0_1500_summary_histogram->SetYTitle("RMS_{90}#Delta#phi(#vec{#slash{p}}_{T,reco},#vec{#slash{p}}_{T,true}) [#circ]");
  h_OverlayTight_PhiRes_RMS90VsMET_0_1500_summary_histogram->SetXTitle("#slash{p}_{T,true} [GeV]");
  h_OverlayTight_PhiRes_RMS90VsMET_0_1500_summary_histogram->SetLineWidth(3);
  h_OverlayTight_PhiRes_RMS90VsMET_0_1500_summary_histogram->SetLineColor(kGreen+2);
  h_OverlayTight_PhiRes_RMS90VsMET_0_1500_summary_histogram->SetLineStyle(1);

  ibin=1;
  for(unsigned int i=8;i<h_vec_OverlayTight.size();i++){
    resolutionTH1=0; 
    resolutionErrorTH1=0;
    meanTH1=0;
    meanErrorTH1=0;
    CalculatePerformanceNoMean( h_vec_OverlayTight[i], resolutionTH1, resolutionErrorTH1,meanTH1,meanErrorTH1);
    std::cout<<"bin "<<i<<" res/error"<<resolutionTH1<<"/"<<resolutionErrorTH1<<" fill "<<ibin<<std::endl;
   //RMS is not calculated in %, to get the real RMS in % out multiply by 100
    h_OverlayTight_METRes_RMS90VsMET_0_1500_summary_histogram->SetBinContent(ibin,resolutionTH1*100.);
    h_OverlayTight_METRes_RMS90VsMET_0_1500_summary_histogram ->SetBinError(ibin,resolutionErrorTH1*100.);
    resolutionTH1=0; 
    resolutionErrorTH1=0;
    meanTH1=0;
    meanErrorTH1=0;
    CalculatePerformanceNoMean( h_vec_OverlayTight[i+1], resolutionTH1, resolutionErrorTH1,meanTH1,meanErrorTH1);
    std::cout<<"bin "<<i+1<<" res/error"<<resolutionTH1<<"/"<<resolutionErrorTH1<<" fill "<<ibin<<std::endl;
    h_OverlayTight_PhiRes_RMS90VsMET_0_1500_summary_histogram->SetBinContent(ibin,resolutionTH1);
    h_OverlayTight_PhiRes_RMS90VsMET_0_1500_summary_histogram->SetBinError(ibin,resolutionErrorTH1);
    i++;
    //effectively we always consider a pair of histograms
    ibin+=1;
  }


  TH1F* h_noOverlay_px_miss_totPFO =  new TH1F("h_noOverlay_px_miss_totPFO","", n_bins100_MET, -250.,250.);
  TH1F* h_noOverlay_delta_MET_totPFO_MET_true =  new TH1F("h_noOverlay_delta_MET_totPFO","", n_bins100_MET, -250,250);
  TH1F* h_noOverlay_MET_totPFO =  new TH1F("h_noOverlay_MET_totPFO","", n_bins100_MET, 0,1000);
  TH1F* h_noOverlay_E_totPFO =  new TH1F("h_noOverlay_E_totPFO","", n_bins100_MET, lim_E_low,lim_E_high);
  TH1F* h_noOverlay_METPhi_totPFO =  new TH1F("h_noOverlay_METPhi_totPFO","", n_bins100_MET, -180.0,180.);
  TH1F* h_noOverlay_MET_true =  new TH1F("h_noOverlay_MET_true","", n_bins100_MET, 0,1000);
  TH1F* h_noOverlay_METPhi_true =  new TH1F("h_noOverlay_METPhi_true","", n_bins100_MET, -180,180);
  TH1F* h_noOverlay_dphi_MET_true_reco =  new TH1F("h_noOverlay_dphi_MET_true_reco","", n_bins100_MET, -90.,90.);
  TH1F* h_noOverlay_deltaMET_over_trueMET_0_25 =  new TH1F("h_noOverlay_deltaMET_over_trueMET_0_25","", n_bins1000_MET, lim_MET_rel_low,lim_MET_rel_high);
  TH1F* h_noOverlay_dphi_recoMET_trueMET_0_25 =  new TH1F("h_noOverlay_dphi_recoMET_trueMET_0_25","", n_bins1000_MET, -90.,90.);
  TH1F* h_noOverlay_deltaMET_over_trueMET_25_50 =  new TH1F("h_noOverlay_deltaMET_over_trueMET_25_50","", n_bins1000_MET, lim_MET_rel_low,lim_MET_rel_high);
  TH1F* h_noOverlay_dphi_recoMET_trueMET_25_50 =  new TH1F("h_noOverlay_dphi_recoMET_trueMET_25_50","", n_bins1000_MET, -90.,90.);
  TH1F* h_noOverlay_deltaMET_over_trueMET_50_75 =  new TH1F("h_noOverlay_deltaMET_over_trueMET_50_75","", n_bins1000_MET, lim_MET_rel_low,lim_MET_rel_high);
  TH1F* h_noOverlay_dphi_recoMET_trueMET_50_75 =  new TH1F("h_noOverlay_dphi_recoMET_trueMET_50_75","", n_bins1000_MET, -90.,90.);
  TH1F* h_noOverlay_deltaMET_over_trueMET_75_100 =  new TH1F("h_noOverlay_deltaMET_over_trueMET_75_100","", n_bins1000_MET, lim_MET_rel_low,lim_MET_rel_high);
  TH1F* h_noOverlay_dphi_recoMET_trueMET_75_100 =  new TH1F("h_noOverlay_dphi_recoMET_trueMET_75_100","", n_bins1000_MET, -90.,90.);
  TH1F* h_noOverlay_deltaMET_over_trueMET_100_140 =  new TH1F("h_noOverlay_deltaMET_over_trueMET_100_140","", n_bins1000_MET, lim_MET_rel_low,lim_MET_rel_high);
  TH1F* h_noOverlay_dphi_recoMET_trueMET_100_140 =  new TH1F("h_noOverlay_dphi_recoMET_trueMET_100_140","", n_bins1000_MET, -90.,90.);
  TH1F* h_noOverlay_deltaMET_over_trueMET_140_180 =  new TH1F("h_noOverlay_deltaMET_over_trueMET_140_180","", n_bins1000_MET, lim_MET_rel_low,lim_MET_rel_high);
  TH1F* h_noOverlay_dphi_recoMET_trueMET_140_180 =  new TH1F("h_noOverlay_dphi_recoMET_trueMET_140_180","", n_bins1000_MET, -90.,90.);
  TH1F* h_noOverlay_deltaMET_over_trueMET_180_220 =  new TH1F("h_noOverlay_deltaMET_over_trueMET_180_220","", n_bins1000_MET, lim_MET_rel_low,lim_MET_rel_high);
  TH1F* h_noOverlay_dphi_recoMET_trueMET_180_220 =  new TH1F("h_noOverlay_dphi_recoMET_trueMET_180_220","", n_bins1000_MET, -90.,90.);
  TH1F* h_noOverlay_deltaMET_over_trueMET_220_260 =  new TH1F("h_noOverlay_deltaMET_over_trueMET_220_260","", n_bins1000_MET, lim_MET_rel_low,lim_MET_rel_high);
  TH1F* h_noOverlay_dphi_recoMET_trueMET_220_260 =  new TH1F("h_noOverlay_dphi_recoMET_trueMET_220_260","", n_bins1000_MET, -90.,90.);
  TH1F* h_noOverlay_deltaMET_over_trueMET_260_340 =  new TH1F("h_noOverlay_deltaMET_over_trueMET_260_340","", n_bins1000_MET, lim_MET_rel_low,lim_MET_rel_high);
  TH1F* h_noOverlay_dphi_recoMET_trueMET_260_340 =  new TH1F("h_noOverlay_dphi_recoMET_trueMET_260_340","", n_bins1000_MET, -90.,90.);
  TH1F* h_noOverlay_deltaMET_over_trueMET_340_420 =  new TH1F("h_noOverlay_deltaMET_over_trueMET_340_420","", n_bins1000_MET, lim_MET_rel_low,lim_MET_rel_high);
  TH1F* h_noOverlay_dphi_recoMET_trueMET_340_420 =  new TH1F("h_noOverlay_dphi_recoMET_trueMET_340_420","", n_bins1000_MET, -90.,90.);
  TH1F* h_noOverlay_deltaMET_over_trueMET_420_500 =  new TH1F("h_noOverlay_deltaMET_over_trueMET_420_500","", n_bins1000_MET, lim_MET_rel_low,lim_MET_rel_high);
  TH1F* h_noOverlay_dphi_recoMET_trueMET_420_500 =  new TH1F("h_noOverlay_dphi_recoMET_trueMET_420_500","", n_bins1000_MET, -90.,90.);
  TH1F* h_noOverlay_deltaMET_over_trueMET_500_750 =  new TH1F("h_noOverlay_deltaMET_over_trueMET_500_750","", n_bins1000_MET, lim_MET_rel_low,lim_MET_rel_high);
  TH1F* h_noOverlay_dphi_recoMET_trueMET_500_750 =  new TH1F("h_noOverlay_dphi_recoMET_trueMET_500_750","", n_bins1000_MET, -90.,90.);
  TH1F* h_noOverlay_deltaMET_over_trueMET_750_Inf =  new TH1F("h_noOverlay_deltaMET_over_trueMET_750_Inf","", n_bins1000_MET, lim_MET_rel_low,lim_MET_rel_high);
  TH1F* h_noOverlay_dphi_recoMET_trueMET_750_Inf =  new TH1F("h_noOverlay_dphi_recoMET_trueMET_750_Inf","", n_bins1000_MET, -90.,90.);

  std::vector<TH1F*>h_vec_noOverlay;
  h_vec_noOverlay.push_back(h_noOverlay_px_miss_totPFO);
  h_vec_noOverlay.push_back(h_noOverlay_delta_MET_totPFO_MET_true);
  h_vec_noOverlay.push_back(h_noOverlay_MET_totPFO);
  h_vec_noOverlay.push_back(h_noOverlay_E_totPFO);
  h_vec_noOverlay.push_back(h_noOverlay_METPhi_totPFO);
  h_vec_noOverlay.push_back(h_noOverlay_MET_true);
  h_vec_noOverlay.push_back(h_noOverlay_METPhi_true);
  h_vec_noOverlay.push_back(h_noOverlay_dphi_MET_true_reco);
  h_vec_noOverlay.push_back(h_noOverlay_deltaMET_over_trueMET_0_25);
  h_vec_noOverlay.push_back(h_noOverlay_dphi_recoMET_trueMET_0_25);
  h_vec_noOverlay.push_back(h_noOverlay_deltaMET_over_trueMET_25_50);
  h_vec_noOverlay.push_back(h_noOverlay_dphi_recoMET_trueMET_25_50);
  h_vec_noOverlay.push_back(h_noOverlay_deltaMET_over_trueMET_50_75);
  h_vec_noOverlay.push_back(h_noOverlay_dphi_recoMET_trueMET_50_75);
  h_vec_noOverlay.push_back(h_noOverlay_deltaMET_over_trueMET_75_100);
  h_vec_noOverlay.push_back(h_noOverlay_dphi_recoMET_trueMET_75_100);
  h_vec_noOverlay.push_back(h_noOverlay_deltaMET_over_trueMET_100_140);
  h_vec_noOverlay.push_back(h_noOverlay_dphi_recoMET_trueMET_100_140);
  h_vec_noOverlay.push_back(h_noOverlay_deltaMET_over_trueMET_140_180);
  h_vec_noOverlay.push_back(h_noOverlay_dphi_recoMET_trueMET_140_180);
  h_vec_noOverlay.push_back(h_noOverlay_deltaMET_over_trueMET_180_220);
  h_vec_noOverlay.push_back(h_noOverlay_dphi_recoMET_trueMET_180_220);
  h_vec_noOverlay.push_back(h_noOverlay_deltaMET_over_trueMET_220_260);
  h_vec_noOverlay.push_back(h_noOverlay_dphi_recoMET_trueMET_220_260);
  h_vec_noOverlay.push_back(h_noOverlay_deltaMET_over_trueMET_260_340);
  h_vec_noOverlay.push_back(h_noOverlay_dphi_recoMET_trueMET_260_340);
  h_vec_noOverlay.push_back(h_noOverlay_deltaMET_over_trueMET_340_420);
  h_vec_noOverlay.push_back(h_noOverlay_dphi_recoMET_trueMET_340_420);
  h_vec_noOverlay.push_back(h_noOverlay_deltaMET_over_trueMET_420_500);
  h_vec_noOverlay.push_back(h_noOverlay_dphi_recoMET_trueMET_420_500);
  h_vec_noOverlay.push_back(h_noOverlay_deltaMET_over_trueMET_500_750);
  h_vec_noOverlay.push_back(h_noOverlay_dphi_recoMET_trueMET_500_750);
  h_vec_noOverlay.push_back(h_noOverlay_deltaMET_over_trueMET_750_Inf);
  h_vec_noOverlay.push_back(h_noOverlay_dphi_recoMET_trueMET_750_Inf);

  for(unsigned int i=0;i<h_vec_noOverlay.size();i++){
    h_vec_noOverlay[i]->SetLineWidth(3);
    h_vec_noOverlay[i]->SetLineColor(kBlack);
    h_vec_noOverlay[i]->Sumw2();
  }

  fill_background_missingPT_histograms(file_noOverlay,h_vec_noOverlay,m_top_CosTheta);

  TH1F* h_noOverlay_METRes_RMS90VsMET_0_1500_summary_histogram=new TH1F("h_noOverlay_METRes_RMS90VsMET_0_1500_summary_histogram", "RMS_{90}(E_{j}) / Mean_{90}(E_{j}) vs |cos(#theta)|", nRegionBins_MET, pRegionBinEdges_MET);
  h_noOverlay_METRes_RMS90VsMET_0_1500_summary_histogram->SetYTitle("RMS_{90}(#Delta#slash{p}_{T}/#slash{p}_{T,true}) [%]");
  h_noOverlay_METRes_RMS90VsMET_0_1500_summary_histogram->SetXTitle("#slash{p}_{T,true} [GeV]");
  h_noOverlay_METRes_RMS90VsMET_0_1500_summary_histogram->SetLineWidth(3);
  h_noOverlay_METRes_RMS90VsMET_0_1500_summary_histogram->SetLineColor(kBlack);
  h_noOverlay_METRes_RMS90VsMET_0_1500_summary_histogram->SetLineStyle(1);

  TH1F* h_noOverlay_PhiRes_RMS90VsMET_0_1500_summary_histogram=new TH1F("h_noOverlay_PhiRes_RMS90VsMET_0_1500_summary_histogram", "RMS_{90}(E_{j}) / Mean_{90}(E_{j}) vs |cos(#theta)|", nRegionBins_MET, pRegionBinEdges_MET);
  h_noOverlay_PhiRes_RMS90VsMET_0_1500_summary_histogram->SetYTitle("RMS_{90}#Delta#phi(#vec{#slash{p}}_{T,reco},#vec{#slash{p}}_{T,true}) [#circ]");
  h_noOverlay_PhiRes_RMS90VsMET_0_1500_summary_histogram->SetXTitle("#slash{p}_{T,true} [GeV]");
  h_noOverlay_PhiRes_RMS90VsMET_0_1500_summary_histogram->SetLineWidth(3);
  h_noOverlay_PhiRes_RMS90VsMET_0_1500_summary_histogram->SetLineColor(kBlack);
  h_noOverlay_PhiRes_RMS90VsMET_0_1500_summary_histogram->SetLineStyle(1);

  ibin=1;
  for(unsigned int i=8;i<h_vec_noOverlay.size();i++){
    resolutionTH1=0; 
    resolutionErrorTH1=0;
    meanTH1=0;
    meanErrorTH1=0;
    CalculatePerformanceNoMean( h_vec_noOverlay[i], resolutionTH1, resolutionErrorTH1,meanTH1,meanErrorTH1);
    std::cout<<"bin "<<i<<" res/error"<<resolutionTH1<<"/"<<resolutionErrorTH1<<" fill "<<ibin<<std::endl;
    //RMS is not calculated in %, to get the real RMS out in %, multiply by 100
    h_noOverlay_METRes_RMS90VsMET_0_1500_summary_histogram->SetBinContent(ibin,resolutionTH1*100.);
    h_noOverlay_METRes_RMS90VsMET_0_1500_summary_histogram ->SetBinError(ibin,resolutionErrorTH1*100.);
    resolutionTH1=0; 
    resolutionErrorTH1=0;
    meanTH1=0;
    meanErrorTH1=0;
    CalculatePerformanceNoMean( h_vec_noOverlay[i+1], resolutionTH1, resolutionErrorTH1,meanTH1,meanErrorTH1);
    std::cout<<"bin "<<i+1<<" res/error"<<resolutionTH1<<"/"<<resolutionErrorTH1<<" fill "<<ibin<<std::endl;
    h_noOverlay_PhiRes_RMS90VsMET_0_1500_summary_histogram->SetBinContent(ibin,resolutionTH1);
    h_noOverlay_PhiRes_RMS90VsMET_0_1500_summary_histogram->SetBinError(ibin,resolutionErrorTH1);
    i++;
    //effectively we always consider a pair of histograms
    ibin+=1;
  }



  TH1F* h_OverlayAll_px_miss_totPFO =  new TH1F("h_OverlayAll_px_miss_totPFO","", n_bins100_MET, -250.,250.);
  TH1F* h_OverlayAll_delta_MET_totPFO_MET_true =  new TH1F("h_OverlayAll_delta_MET_totPFO","", n_bins100_MET, -250,250);
  TH1F* h_OverlayAll_MET_totPFO =  new TH1F("h_OverlayAll_MET_totPFO","", n_bins100_MET, 0,1000);
  TH1F* h_OverlayAll_E_totPFO =  new TH1F("h_OverlayAll_E_totPFO","", n_bins100_MET, lim_E_low,lim_E_high);
  TH1F* h_OverlayAll_METPhi_totPFO =  new TH1F("h_OverlayAll_METPhi_totPFO","", n_bins100_MET, -180.0,180.);
  TH1F* h_OverlayAll_MET_true =  new TH1F("h_OverlayAll_MET_true","", n_bins100_MET, 0,1000);
  TH1F* h_OverlayAll_METPhi_true =  new TH1F("h_OverlayAll_METPhi_true","", n_bins100_MET, -180,180);
  TH1F* h_OverlayAll_dphi_MET_true_reco =  new TH1F("h_OverlayAll_dphi_MET_true_reco","", n_bins100_MET, -90.,90.);
  TH1F* h_OverlayAll_deltaMET_over_trueMET_0_25 =  new TH1F("h_OverlayAll_deltaMET_over_trueMET_0_25","", n_bins1000_MET, lim_MET_rel_low,lim_MET_rel_high);
  TH1F* h_OverlayAll_dphi_recoMET_trueMET_0_25 =  new TH1F("h_OverlayAll_dphi_recoMET_trueMET_0_25","", n_bins1000_MET, -90.,90.);
  TH1F* h_OverlayAll_deltaMET_over_trueMET_25_50 =  new TH1F("h_OverlayAll_deltaMET_over_trueMET_25_50","", n_bins1000_MET, lim_MET_rel_low,lim_MET_rel_high);
  TH1F* h_OverlayAll_dphi_recoMET_trueMET_25_50 =  new TH1F("h_OverlayAll_dphi_recoMET_trueMET_25_50","", n_bins1000_MET, -90.,90.);
  TH1F* h_OverlayAll_deltaMET_over_trueMET_50_75 =  new TH1F("h_OverlayAll_deltaMET_over_trueMET_50_75","", n_bins1000_MET, lim_MET_rel_low,lim_MET_rel_high);
  TH1F* h_OverlayAll_dphi_recoMET_trueMET_50_75 =  new TH1F("h_OverlayAll_dphi_recoMET_trueMET_50_75","", n_bins1000_MET, -90.,90.);
  TH1F* h_OverlayAll_deltaMET_over_trueMET_75_100 =  new TH1F("h_OverlayAll_deltaMET_over_trueMET_75_100","", n_bins1000_MET, lim_MET_rel_low,lim_MET_rel_high);
  TH1F* h_OverlayAll_dphi_recoMET_trueMET_75_100 =  new TH1F("h_OverlayAll_dphi_recoMET_trueMET_75_100","", n_bins1000_MET, -90.,90.);
  TH1F* h_OverlayAll_deltaMET_over_trueMET_100_140 =  new TH1F("h_OverlayAll_deltaMET_over_trueMET_100_140","", n_bins1000_MET, lim_MET_rel_low,lim_MET_rel_high);
  TH1F* h_OverlayAll_dphi_recoMET_trueMET_100_140 =  new TH1F("h_OverlayAll_dphi_recoMET_trueMET_100_140","", n_bins1000_MET, -90.,90.);
  TH1F* h_OverlayAll_deltaMET_over_trueMET_140_180 =  new TH1F("h_OverlayAll_deltaMET_over_trueMET_140_180","", n_bins1000_MET, lim_MET_rel_low,lim_MET_rel_high);
  TH1F* h_OverlayAll_dphi_recoMET_trueMET_140_180 =  new TH1F("h_OverlayAll_dphi_recoMET_trueMET_140_180","", n_bins1000_MET, -90.,90.);
  TH1F* h_OverlayAll_deltaMET_over_trueMET_180_220 =  new TH1F("h_OverlayAll_deltaMET_over_trueMET_180_220","", n_bins1000_MET, lim_MET_rel_low,lim_MET_rel_high);
  TH1F* h_OverlayAll_dphi_recoMET_trueMET_180_220 =  new TH1F("h_OverlayAll_dphi_recoMET_trueMET_180_220","", n_bins1000_MET, -90.,90.);
  TH1F* h_OverlayAll_deltaMET_over_trueMET_220_260 =  new TH1F("h_OverlayAll_deltaMET_over_trueMET_220_260","", n_bins1000_MET, lim_MET_rel_low,lim_MET_rel_high);
  TH1F* h_OverlayAll_dphi_recoMET_trueMET_220_260 =  new TH1F("h_OverlayAll_dphi_recoMET_trueMET_220_260","", n_bins1000_MET, -90.,90.);
  TH1F* h_OverlayAll_deltaMET_over_trueMET_260_340 =  new TH1F("h_OverlayAll_deltaMET_over_trueMET_260_340","", n_bins1000_MET, lim_MET_rel_low,lim_MET_rel_high);
  TH1F* h_OverlayAll_dphi_recoMET_trueMET_260_340 =  new TH1F("h_OverlayAll_dphi_recoMET_trueMET_260_340","", n_bins1000_MET, -90.,90.);
  TH1F* h_OverlayAll_deltaMET_over_trueMET_340_420 =  new TH1F("h_OverlayAll_deltaMET_over_trueMET_340_420","", n_bins1000_MET, lim_MET_rel_low,lim_MET_rel_high);
  TH1F* h_OverlayAll_dphi_recoMET_trueMET_340_420 =  new TH1F("h_OverlayAll_dphi_recoMET_trueMET_340_420","", n_bins1000_MET, -90.,90.);
  TH1F* h_OverlayAll_deltaMET_over_trueMET_420_500 =  new TH1F("h_OverlayAll_deltaMET_over_trueMET_420_500","", n_bins1000_MET, lim_MET_rel_low,lim_MET_rel_high);
  TH1F* h_OverlayAll_dphi_recoMET_trueMET_420_500 =  new TH1F("h_OverlayAll_dphi_recoMET_trueMET_420_500","", n_bins1000_MET, -90.,90.);
  TH1F* h_OverlayAll_deltaMET_over_trueMET_500_750 =  new TH1F("h_OverlayAll_deltaMET_over_trueMET_500_750","", n_bins1000_MET, lim_MET_rel_low,lim_MET_rel_high);
  TH1F* h_OverlayAll_dphi_recoMET_trueMET_500_750 =  new TH1F("h_OverlayAll_dphi_recoMET_trueMET_500_750","", n_bins1000_MET, -90.,90.);
  TH1F* h_OverlayAll_deltaMET_over_trueMET_750_Inf =  new TH1F("h_OverlayAll_deltaMET_over_trueMET_750_Inf","", n_bins1000_MET, lim_MET_rel_low,lim_MET_rel_high);
  TH1F* h_OverlayAll_dphi_recoMET_trueMET_750_Inf =  new TH1F("h_OverlayAll_dphi_recoMET_trueMET_750_Inf","", n_bins1000_MET, -90.,90.);

  std::vector<TH1F*>h_vec_OverlayAll;
  h_vec_OverlayAll.push_back(h_OverlayAll_px_miss_totPFO);
  h_vec_OverlayAll.push_back(h_OverlayAll_delta_MET_totPFO_MET_true);
  h_vec_OverlayAll.push_back(h_OverlayAll_MET_totPFO);
  h_vec_OverlayAll.push_back(h_OverlayAll_E_totPFO);
  h_vec_OverlayAll.push_back(h_OverlayAll_METPhi_totPFO);
  h_vec_OverlayAll.push_back(h_OverlayAll_MET_true);
  h_vec_OverlayAll.push_back(h_OverlayAll_METPhi_true);
  h_vec_OverlayAll.push_back(h_OverlayAll_dphi_MET_true_reco);
  h_vec_OverlayAll.push_back(h_OverlayAll_deltaMET_over_trueMET_0_25);
  h_vec_OverlayAll.push_back(h_OverlayAll_dphi_recoMET_trueMET_0_25);
  h_vec_OverlayAll.push_back(h_OverlayAll_deltaMET_over_trueMET_25_50);
  h_vec_OverlayAll.push_back(h_OverlayAll_dphi_recoMET_trueMET_25_50);
  h_vec_OverlayAll.push_back(h_OverlayAll_deltaMET_over_trueMET_50_75);
  h_vec_OverlayAll.push_back(h_OverlayAll_dphi_recoMET_trueMET_50_75);
  h_vec_OverlayAll.push_back(h_OverlayAll_deltaMET_over_trueMET_75_100);
  h_vec_OverlayAll.push_back(h_OverlayAll_dphi_recoMET_trueMET_75_100);
  h_vec_OverlayAll.push_back(h_OverlayAll_deltaMET_over_trueMET_100_140);
  h_vec_OverlayAll.push_back(h_OverlayAll_dphi_recoMET_trueMET_100_140);
  h_vec_OverlayAll.push_back(h_OverlayAll_deltaMET_over_trueMET_140_180);
  h_vec_OverlayAll.push_back(h_OverlayAll_dphi_recoMET_trueMET_140_180);
  h_vec_OverlayAll.push_back(h_OverlayAll_deltaMET_over_trueMET_180_220);
  h_vec_OverlayAll.push_back(h_OverlayAll_dphi_recoMET_trueMET_180_220);
  h_vec_OverlayAll.push_back(h_OverlayAll_deltaMET_over_trueMET_220_260);
  h_vec_OverlayAll.push_back(h_OverlayAll_dphi_recoMET_trueMET_220_260);
  h_vec_OverlayAll.push_back(h_OverlayAll_deltaMET_over_trueMET_260_340);
  h_vec_OverlayAll.push_back(h_OverlayAll_dphi_recoMET_trueMET_260_340);
  h_vec_OverlayAll.push_back(h_OverlayAll_deltaMET_over_trueMET_340_420);
  h_vec_OverlayAll.push_back(h_OverlayAll_dphi_recoMET_trueMET_340_420);
  h_vec_OverlayAll.push_back(h_OverlayAll_deltaMET_over_trueMET_420_500);
  h_vec_OverlayAll.push_back(h_OverlayAll_dphi_recoMET_trueMET_420_500);
  h_vec_OverlayAll.push_back(h_OverlayAll_deltaMET_over_trueMET_500_750);
  h_vec_OverlayAll.push_back(h_OverlayAll_dphi_recoMET_trueMET_500_750);
  h_vec_OverlayAll.push_back(h_OverlayAll_deltaMET_over_trueMET_750_Inf);
  h_vec_OverlayAll.push_back(h_OverlayAll_dphi_recoMET_trueMET_750_Inf);

  for(unsigned int i=0;i<h_vec_OverlayAll.size();i++){
    h_vec_OverlayAll[i]->SetLineWidth(3);
    h_vec_OverlayAll[i]->SetLineColor(kMagenta);
    h_vec_OverlayAll[i]->Sumw2();
  }

  fill_background_missingPT_histograms(file_OverlayAll,h_vec_OverlayAll,m_top_CosTheta);

  TH1F* h_OverlayAll_METRes_RMS90VsMET_0_1500_summary_histogram=new TH1F("h_OverlayAll_METRes_RMS90VsMET_0_1500_summary_histogram", "RMS_{90}(E_{j}) / Mean_{90}(E_{j}) vs |cos(#theta)|", nRegionBins_MET, pRegionBinEdges_MET);
  h_OverlayAll_METRes_RMS90VsMET_0_1500_summary_histogram->SetYTitle("RMS_{90}(#Delta#slash{p}_{T}/#slash{p}_{T,true}) [%]");
  h_OverlayAll_METRes_RMS90VsMET_0_1500_summary_histogram->SetXTitle("#slash{p}_{T,true} [GeV]");
  h_OverlayAll_METRes_RMS90VsMET_0_1500_summary_histogram->SetLineWidth(3);
  h_OverlayAll_METRes_RMS90VsMET_0_1500_summary_histogram->SetLineColor(kMagenta);
  h_OverlayAll_METRes_RMS90VsMET_0_1500_summary_histogram->SetLineStyle(1);

  TH1F* h_OverlayAll_PhiRes_RMS90VsMET_0_1500_summary_histogram=new TH1F("h_OverlayAll_PhiRes_RMS90VsMET_0_1500_summary_histogram", "RMS_{90}(E_{j}) / Mean_{90}(E_{j}) vs |cos(#theta)|", nRegionBins_MET, pRegionBinEdges_MET);
  h_OverlayAll_PhiRes_RMS90VsMET_0_1500_summary_histogram->SetYTitle("RMS_{90}#Delta#phi(#vec{#slash{p}}_{T,reco},#vec{#slash{p}}_{T,true}) [#circ]");
  h_OverlayAll_PhiRes_RMS90VsMET_0_1500_summary_histogram->SetXTitle("#slash{p}_{T,true} [GeV]");
  h_OverlayAll_PhiRes_RMS90VsMET_0_1500_summary_histogram->SetLineWidth(3);
  h_OverlayAll_PhiRes_RMS90VsMET_0_1500_summary_histogram->SetLineColor(kMagenta);
  h_OverlayAll_PhiRes_RMS90VsMET_0_1500_summary_histogram->SetLineStyle(1);

  ibin=1;
  
  for(unsigned int i=8;i<h_vec_OverlayAll.size();i++){
    resolutionTH1=0; 
    resolutionErrorTH1=0;
    meanTH1=0;
    meanErrorTH1=0;
    CalculatePerformanceNoMean( h_vec_OverlayAll[i], resolutionTH1, resolutionErrorTH1,meanTH1,meanErrorTH1);
    std::cout<<"bin "<<i<<" res/error"<<resolutionTH1<<"/"<<resolutionErrorTH1<<" fill "<<ibin<<std::endl;
    //RMS is not calculated in %, to get the real RMS out in % multiply by 100
    h_OverlayAll_METRes_RMS90VsMET_0_1500_summary_histogram->SetBinContent(ibin,resolutionTH1*100.);
    h_OverlayAll_METRes_RMS90VsMET_0_1500_summary_histogram ->SetBinError(ibin,resolutionErrorTH1*100.);
    resolutionTH1=0; 
    resolutionErrorTH1=0;
    meanTH1=0;
    meanErrorTH1=0;
    CalculatePerformanceNoMean( h_vec_OverlayAll[i+1], resolutionTH1, resolutionErrorTH1,meanTH1,meanErrorTH1);
    std::cout<<"bin "<<i+1<<" res/error"<<resolutionTH1<<"/"<<resolutionErrorTH1<<" fill "<<ibin<<std::endl;
    h_OverlayAll_PhiRes_RMS90VsMET_0_1500_summary_histogram->SetBinContent(ibin,resolutionTH1);
    h_OverlayAll_PhiRes_RMS90VsMET_0_1500_summary_histogram->SetBinError(ibin,resolutionErrorTH1);
    i++;
    //effectively we always consider a pair of histograms
    ibin+=1;
  }


  */

  TGraphErrors *gre_DR07_RMS90_JER_0_65_EC_Erat99_allSamples_SC = new TGraphErrors(5);
  gre_DR07_RMS90_JER_0_65_EC_Erat99_allSamples_SC ->SetName("gre_DR07_RMS90_JER_0_65_EC_Erat99_allSamples_SC");
  gre_DR07_RMS90_JER_0_65_EC_Erat99_allSamples_SC ->SetTitle("");
  gre_DR07_RMS90_JER_0_65_EC_Erat99_allSamples_SC ->SetFillColor(1);
  gre_DR07_RMS90_JER_0_65_EC_Erat99_allSamples_SC ->SetLineColor(kBlack);
  gre_DR07_RMS90_JER_0_65_EC_Erat99_allSamples_SC ->SetMarkerColor(kBlack);
  gre_DR07_RMS90_JER_0_65_EC_Erat99_allSamples_SC ->SetMarkerStyle(kFullCircle);

  TGraphErrors *gre_DR07_RMS90_JER_0_65_to_0_80_EC_Erat99_allSamples_SC = new TGraphErrors(5);
  gre_DR07_RMS90_JER_0_65_to_0_80_EC_Erat99_allSamples_SC ->SetName("gre_DR07_RMS90_JER_0_65_to_0_80_EC_Erat99_allSamples_SC");
  gre_DR07_RMS90_JER_0_65_to_0_80_EC_Erat99_allSamples_SC ->SetTitle("");
  gre_DR07_RMS90_JER_0_65_to_0_80_EC_Erat99_allSamples_SC ->SetFillColor(1);
  gre_DR07_RMS90_JER_0_65_to_0_80_EC_Erat99_allSamples_SC ->SetLineColor(kBlack);
  gre_DR07_RMS90_JER_0_65_to_0_80_EC_Erat99_allSamples_SC ->SetMarkerColor(kBlack);
  gre_DR07_RMS90_JER_0_65_to_0_80_EC_Erat99_allSamples_SC ->SetMarkerStyle(kFullCircle);

  TGraphErrors *gre_DR07_RMS90_JER_0_80_to_0_925_EC_Erat99_allSamples_SC = new TGraphErrors(5);
  gre_DR07_RMS90_JER_0_80_to_0_925_EC_Erat99_allSamples_SC ->SetName("gre_DR07_RMS90_JER_0_80_to_0_925_EC_Erat99_allSamples_SC");
  gre_DR07_RMS90_JER_0_80_to_0_925_EC_Erat99_allSamples_SC ->SetTitle("");
  gre_DR07_RMS90_JER_0_80_to_0_925_EC_Erat99_allSamples_SC ->SetFillColor(1);
  gre_DR07_RMS90_JER_0_80_to_0_925_EC_Erat99_allSamples_SC ->SetLineColor(kBlack);
  gre_DR07_RMS90_JER_0_80_to_0_925_EC_Erat99_allSamples_SC ->SetMarkerColor(kBlack);
  gre_DR07_RMS90_JER_0_80_to_0_925_EC_Erat99_allSamples_SC ->SetMarkerStyle(kFullCircle);

  TGraphErrors *gre_DR07_RMS90_JER_0_925_to_1_00_EC_Erat99_allSamples_SC = new TGraphErrors(5);
  gre_DR07_RMS90_JER_0_925_to_1_00_EC_Erat99_allSamples_SC ->SetName("gre_DR07_RMS90_JER_0_925_to_1_00_EC_Erat99_allSamples_SC");
  gre_DR07_RMS90_JER_0_925_to_1_00_EC_Erat99_allSamples_SC ->SetTitle("");
  gre_DR07_RMS90_JER_0_925_to_1_00_EC_Erat99_allSamples_SC ->SetFillColor(1);
  gre_DR07_RMS90_JER_0_925_to_1_00_EC_Erat99_allSamples_SC ->SetLineColor(kBlack);
  gre_DR07_RMS90_JER_0_925_to_1_00_EC_Erat99_allSamples_SC ->SetMarkerColor(kBlack);
  gre_DR07_RMS90_JER_0_925_to_1_00_EC_Erat99_allSamples_SC ->SetMarkerStyle(kFullCircle);

  TH1F* h_100_CT_EC_Erat99_allSamples_SC_DR07_E_rel_totVis_RMS_d1_cosT_0_to_0_65 =  new TH1F("h_100_CT_EC_Erat99_allSamples_SC_DR07_E_rel_totVis_RMS_d1_cosT_0_to_0_65","", n_binsJER, lim_E_rel_low,lim_E_rel_high);
  TH1F* h_100_CT_EC_Erat99_allSamples_SC_DR07_E_rel_totVis_RMS_d1_cosT_0_65_to_0_80 =  new TH1F("h_100_CT_EC_Erat99_allSamples_SC_DR07_E_rel_totVis_RMS_d1_cosT_0_65_to_0_80","", n_binsJER, lim_E_rel_low,lim_E_rel_high);
  TH1F* h_100_CT_EC_Erat99_allSamples_SC_DR07_E_rel_totVis_RMS_d1_cosT_0_80_to_0_925 =  new TH1F("h_100_CT_EC_Erat99_allSamples_SC_DR07_E_rel_totVis_RMS_d1_cosT_0_80_to_0_925","", n_binsJER, lim_E_rel_low,lim_E_rel_high);
  TH1F* h_100_CT_EC_Erat99_allSamples_SC_DR07_E_rel_totVis_RMS_d1_cosT_0_925_to_1_00 =  new TH1F("h_100_CT_EC_Erat99_allSamples_SC_DR07_E_rel_totVis_RMS_d1_cosT_0_925_to_1_00","", n_binsJER, lim_E_rel_low,lim_E_rel_high);

  std::vector<TH1F*> hist_vec_100_CT_EC_Erat99_allSamples_SC;
  hist_vec_100_CT_EC_Erat99_allSamples_SC.push_back(h_100_CT_EC_Erat99_allSamples_SC_DR07_E_rel_totVis_RMS_d1_cosT_0_to_0_65);
  hist_vec_100_CT_EC_Erat99_allSamples_SC.push_back(h_100_CT_EC_Erat99_allSamples_SC_DR07_E_rel_totVis_RMS_d1_cosT_0_65_to_0_80);
  hist_vec_100_CT_EC_Erat99_allSamples_SC.push_back(h_100_CT_EC_Erat99_allSamples_SC_DR07_E_rel_totVis_RMS_d1_cosT_0_80_to_0_925);
  hist_vec_100_CT_EC_Erat99_allSamples_SC.push_back(h_100_CT_EC_Erat99_allSamples_SC_DR07_E_rel_totVis_RMS_d1_cosT_0_925_to_1_00);


  for(unsigned int i=0;i<hist_vec_100_CT_EC_Erat99_allSamples_SC.size();i++){
    hist_vec_100_CT_EC_Erat99_allSamples_SC[i]->Sumw2();
  }

  fill_SC_jet_histograms(file_CLIC_100_CT_EC_Erat99_allSamples_SC,hist_vec_100_CT_EC_Erat99_allSamples_SC);

  TH1F* h_100_CT_EC_Erat99_allSamples_SC_DR07_E_RMS90_summary_histogram=new TH1F("JER_RMS90VsCosTheta_CT_EC_Erat99_allSamples_SC_DR07_100", "RMS_{90}(E_{j}^{reco}/E_{j}^{gen}) / Mean_{90}(E_{j}^{reco}/E_{j}^{gen}) vs |cos#theta|", nRegionBinsAngles, pRegionBinEdgesAngles);
  h_100_CT_EC_Erat99_allSamples_SC_DR07_E_RMS90_summary_histogram ->SetYTitle("RMS_{90}(E_{j}^{reco}/E_{j}^{gen}) / Mean_{90}(E_{j}^{reco}/E_{j}^{gen}) [%]");
  h_100_CT_EC_Erat99_allSamples_SC_DR07_E_RMS90_summary_histogram->SetXTitle("|cos#theta|");
  h_100_CT_EC_Erat99_allSamples_SC_DR07_E_RMS90_summary_histogram->SetLineWidth(2);
  h_100_CT_EC_Erat99_allSamples_SC_DR07_E_RMS90_summary_histogram->SetLineColor(kRed);
  h_100_CT_EC_Erat99_allSamples_SC_DR07_E_RMS90_summary_histogram->SetLineStyle(2);
  //for energies still keep sqrt(2) from original total energy calculation
  for(int i=0;i<4;i++){
    resolutionTH1=0; 
    resolutionErrorTH1=0;
    meanTH1=0;
    meanErrorTH1=0;
    CalculatePerformance( hist_vec_100_CT_EC_Erat99_allSamples_SC[i], resolutionTH1, resolutionErrorTH1,meanTH1,meanErrorTH1);
    h_100_CT_EC_Erat99_allSamples_SC_DR07_E_RMS90_summary_histogram->SetBinContent(i+1,resolutionTH1/sqrt(2.));
    h_100_CT_EC_Erat99_allSamples_SC_DR07_E_RMS90_summary_histogram->SetBinError(i+1, resolutionErrorTH1/sqrt(2.));
  }
  gre_DR07_RMS90_JER_0_65_EC_Erat99_allSamples_SC->SetPoint(0,50,h_100_CT_EC_Erat99_allSamples_SC_DR07_E_RMS90_summary_histogram->GetBinContent(1));
  gre_DR07_RMS90_JER_0_65_EC_Erat99_allSamples_SC->SetPointError(0,0,h_100_CT_EC_Erat99_allSamples_SC_DR07_E_RMS90_summary_histogram->GetBinError(1));

  gre_DR07_RMS90_JER_0_65_to_0_80_EC_Erat99_allSamples_SC->SetPoint(0,50,h_100_CT_EC_Erat99_allSamples_SC_DR07_E_RMS90_summary_histogram->GetBinContent(2));
  gre_DR07_RMS90_JER_0_65_to_0_80_EC_Erat99_allSamples_SC->SetPointError(0,0,h_100_CT_EC_Erat99_allSamples_SC_DR07_E_RMS90_summary_histogram->GetBinError(2));

  gre_DR07_RMS90_JER_0_80_to_0_925_EC_Erat99_allSamples_SC->SetPoint(0,50,h_100_CT_EC_Erat99_allSamples_SC_DR07_E_RMS90_summary_histogram->GetBinContent(3));
  gre_DR07_RMS90_JER_0_80_to_0_925_EC_Erat99_allSamples_SC->SetPointError(0,0,h_100_CT_EC_Erat99_allSamples_SC_DR07_E_RMS90_summary_histogram->GetBinError(3));

  gre_DR07_RMS90_JER_0_925_to_1_00_EC_Erat99_allSamples_SC->SetPoint(0,50,h_100_CT_EC_Erat99_allSamples_SC_DR07_E_RMS90_summary_histogram->GetBinContent(4));
  gre_DR07_RMS90_JER_0_925_to_1_00_EC_Erat99_allSamples_SC->SetPointError(0,0,h_100_CT_EC_Erat99_allSamples_SC_DR07_E_RMS90_summary_histogram->GetBinError(4));

  TH1F* h_200_CT_EC_Erat99_allSamples_SC_DR07_E_rel_totVis_RMS_d1_cosT_0_to_0_65 =  new TH1F("h_200_CT_EC_Erat99_allSamples_SC_DR07_E_rel_totVis_RMS_d1_cosT_0_to_0_65","", n_binsJER, lim_E_rel_low,lim_E_rel_high);
  TH1F* h_200_CT_EC_Erat99_allSamples_SC_DR07_E_rel_totVis_RMS_d1_cosT_0_65_to_0_80 =  new TH1F("h_200_CT_EC_Erat99_allSamples_SC_DR07_E_rel_totVis_RMS_d1_cosT_0_65_to_0_80","", n_binsJER, lim_E_rel_low,lim_E_rel_high);
  TH1F* h_200_CT_EC_Erat99_allSamples_SC_DR07_E_rel_totVis_RMS_d1_cosT_0_80_to_0_925 =  new TH1F("h_200_CT_EC_Erat99_allSamples_SC_DR07_E_rel_totVis_RMS_d1_cosT_0_80_to_0_925","", n_binsJER, lim_E_rel_low,lim_E_rel_high);
  TH1F* h_200_CT_EC_Erat99_allSamples_SC_DR07_E_rel_totVis_RMS_d1_cosT_0_925_to_1_00 =  new TH1F("h_200_CT_EC_Erat99_allSamples_SC_DR07_E_rel_totVis_RMS_d1_cosT_0_925_to_1_00","", n_binsJER, lim_E_rel_low,lim_E_rel_high);

  std::vector<TH1F*> hist_vec_200_CT_EC_Erat99_allSamples_SC;
  hist_vec_200_CT_EC_Erat99_allSamples_SC.push_back(h_200_CT_EC_Erat99_allSamples_SC_DR07_E_rel_totVis_RMS_d1_cosT_0_to_0_65);
  hist_vec_200_CT_EC_Erat99_allSamples_SC.push_back(h_200_CT_EC_Erat99_allSamples_SC_DR07_E_rel_totVis_RMS_d1_cosT_0_65_to_0_80);
  hist_vec_200_CT_EC_Erat99_allSamples_SC.push_back(h_200_CT_EC_Erat99_allSamples_SC_DR07_E_rel_totVis_RMS_d1_cosT_0_80_to_0_925);
  hist_vec_200_CT_EC_Erat99_allSamples_SC.push_back(h_200_CT_EC_Erat99_allSamples_SC_DR07_E_rel_totVis_RMS_d1_cosT_0_925_to_1_00);


  for(unsigned int i=0;i<hist_vec_200_CT_EC_Erat99_allSamples_SC.size();i++){
    hist_vec_200_CT_EC_Erat99_allSamples_SC[i]->Sumw2();
  }

  fill_SC_jet_histograms(file_CLIC_200_CT_EC_Erat99_allSamples_SC,hist_vec_200_CT_EC_Erat99_allSamples_SC);

  TH1F* h_200_CT_EC_Erat99_allSamples_SC_DR07_E_RMS90_summary_histogram=new TH1F("JER_RMS90VsCosTheta_CT_EC_Erat99_allSamples_SC_DR07_200", "RMS_{90}(E_{j}^{reco}/E_{j}^{gen}) / Mean_{90}(E_{j}^{reco}/E_{j}^{gen}) vs |cos#theta|", nRegionBinsAngles, pRegionBinEdgesAngles);
  h_200_CT_EC_Erat99_allSamples_SC_DR07_E_RMS90_summary_histogram ->SetYTitle("RMS_{90}(E_{j}^{reco}/E_{j}^{gen}) / Mean_{90}(E_{j}^{reco}/E_{j}^{gen}) [%]");
  h_200_CT_EC_Erat99_allSamples_SC_DR07_E_RMS90_summary_histogram->SetXTitle("|cos#theta|");
  h_200_CT_EC_Erat99_allSamples_SC_DR07_E_RMS90_summary_histogram->SetLineWidth(2);
  h_200_CT_EC_Erat99_allSamples_SC_DR07_E_RMS90_summary_histogram->SetLineColor(kRed);
  h_200_CT_EC_Erat99_allSamples_SC_DR07_E_RMS90_summary_histogram->SetLineStyle(2);
  //for energies still keep sqrt(2) from original total energy calculation
  for(int i=0;i<4;i++){
    resolutionTH1=0; 
    resolutionErrorTH1=0;
    meanTH1=0;
    meanErrorTH1=0;
    CalculatePerformance( hist_vec_200_CT_EC_Erat99_allSamples_SC[i], resolutionTH1, resolutionErrorTH1,meanTH1,meanErrorTH1);
    h_200_CT_EC_Erat99_allSamples_SC_DR07_E_RMS90_summary_histogram->SetBinContent(i+1,resolutionTH1/sqrt(2.));
    h_200_CT_EC_Erat99_allSamples_SC_DR07_E_RMS90_summary_histogram->SetBinError(i+1, resolutionErrorTH1/sqrt(2.));
  }
  gre_DR07_RMS90_JER_0_65_EC_Erat99_allSamples_SC->SetPoint(1,100,h_200_CT_EC_Erat99_allSamples_SC_DR07_E_RMS90_summary_histogram->GetBinContent(1));
  gre_DR07_RMS90_JER_0_65_EC_Erat99_allSamples_SC->SetPointError(1,0,h_200_CT_EC_Erat99_allSamples_SC_DR07_E_RMS90_summary_histogram->GetBinError(1));

  gre_DR07_RMS90_JER_0_65_to_0_80_EC_Erat99_allSamples_SC->SetPoint(1,100,h_200_CT_EC_Erat99_allSamples_SC_DR07_E_RMS90_summary_histogram->GetBinContent(2));
  gre_DR07_RMS90_JER_0_65_to_0_80_EC_Erat99_allSamples_SC->SetPointError(1,0,h_200_CT_EC_Erat99_allSamples_SC_DR07_E_RMS90_summary_histogram->GetBinError(2));

  gre_DR07_RMS90_JER_0_80_to_0_925_EC_Erat99_allSamples_SC->SetPoint(1,100,h_200_CT_EC_Erat99_allSamples_SC_DR07_E_RMS90_summary_histogram->GetBinContent(3));
  gre_DR07_RMS90_JER_0_80_to_0_925_EC_Erat99_allSamples_SC->SetPointError(1,0,h_200_CT_EC_Erat99_allSamples_SC_DR07_E_RMS90_summary_histogram->GetBinError(3));

  gre_DR07_RMS90_JER_0_925_to_1_00_EC_Erat99_allSamples_SC->SetPoint(1,100,h_200_CT_EC_Erat99_allSamples_SC_DR07_E_RMS90_summary_histogram->GetBinContent(4));
  gre_DR07_RMS90_JER_0_925_to_1_00_EC_Erat99_allSamples_SC->SetPointError(1,0,h_200_CT_EC_Erat99_allSamples_SC_DR07_E_RMS90_summary_histogram->GetBinError(4));

  TH1F* h_500_CT_EC_Erat99_allSamples_SC_DR07_E_rel_totVis_RMS_d1_cosT_0_to_0_65 =  new TH1F("h_500_CT_EC_Erat99_allSamples_SC_DR07_E_rel_totVis_RMS_d1_cosT_0_to_0_65","", n_binsJER, lim_E_rel_low,lim_E_rel_high);
  TH1F* h_500_CT_EC_Erat99_allSamples_SC_DR07_E_rel_totVis_RMS_d1_cosT_0_65_to_0_80 =  new TH1F("h_500_CT_EC_Erat99_allSamples_SC_DR07_E_rel_totVis_RMS_d1_cosT_0_65_to_0_80","", n_binsJER, lim_E_rel_low,lim_E_rel_high);
  TH1F* h_500_CT_EC_Erat99_allSamples_SC_DR07_E_rel_totVis_RMS_d1_cosT_0_80_to_0_925 =  new TH1F("h_500_CT_EC_Erat99_allSamples_SC_DR07_E_rel_totVis_RMS_d1_cosT_0_80_to_0_925","", n_binsJER, lim_E_rel_low,lim_E_rel_high);
  TH1F* h_500_CT_EC_Erat99_allSamples_SC_DR07_E_rel_totVis_RMS_d1_cosT_0_925_to_1_00 =  new TH1F("h_500_CT_EC_Erat99_allSamples_SC_DR07_E_rel_totVis_RMS_d1_cosT_0_925_to_1_00","", n_binsJER, lim_E_rel_low,lim_E_rel_high);

  std::vector<TH1F*> hist_vec_500_CT_EC_Erat99_allSamples_SC;
  hist_vec_500_CT_EC_Erat99_allSamples_SC.push_back(h_500_CT_EC_Erat99_allSamples_SC_DR07_E_rel_totVis_RMS_d1_cosT_0_to_0_65);
  hist_vec_500_CT_EC_Erat99_allSamples_SC.push_back(h_500_CT_EC_Erat99_allSamples_SC_DR07_E_rel_totVis_RMS_d1_cosT_0_65_to_0_80);
  hist_vec_500_CT_EC_Erat99_allSamples_SC.push_back(h_500_CT_EC_Erat99_allSamples_SC_DR07_E_rel_totVis_RMS_d1_cosT_0_80_to_0_925);
  hist_vec_500_CT_EC_Erat99_allSamples_SC.push_back(h_500_CT_EC_Erat99_allSamples_SC_DR07_E_rel_totVis_RMS_d1_cosT_0_925_to_1_00);


  for(unsigned int i=0;i<hist_vec_500_CT_EC_Erat99_allSamples_SC.size();i++){
    hist_vec_500_CT_EC_Erat99_allSamples_SC[i]->Sumw2();
  }

  fill_SC_jet_histograms(file_CLIC_500_CT_EC_Erat99_allSamples_SC,hist_vec_500_CT_EC_Erat99_allSamples_SC);

  TH1F* h_500_CT_EC_Erat99_allSamples_SC_DR07_E_RMS90_summary_histogram=new TH1F("JER_RMS90VsCosTheta_CT_EC_Erat99_allSamples_SC_DR07_500", "RMS_{90}(E_{j}^{reco}/E_{j}^{gen}) / Mean_{90}(E_{j}^{reco}/E_{j}^{gen}) vs |cos#theta|", nRegionBinsAngles, pRegionBinEdgesAngles);
  h_500_CT_EC_Erat99_allSamples_SC_DR07_E_RMS90_summary_histogram ->SetYTitle("RMS_{90}(E_{j}^{reco}/E_{j}^{gen}) / Mean_{90}(E_{j}^{reco}/E_{j}^{gen}) [%]");
  h_500_CT_EC_Erat99_allSamples_SC_DR07_E_RMS90_summary_histogram->SetXTitle("|cos#theta|");
  h_500_CT_EC_Erat99_allSamples_SC_DR07_E_RMS90_summary_histogram->SetLineWidth(2);
  h_500_CT_EC_Erat99_allSamples_SC_DR07_E_RMS90_summary_histogram->SetLineColor(kRed);
  h_500_CT_EC_Erat99_allSamples_SC_DR07_E_RMS90_summary_histogram->SetLineStyle(2);
  //for energies still keep sqrt(2) from original total energy calculation
  for(int i=0;i<4;i++){
    resolutionTH1=0; 
    resolutionErrorTH1=0;
    meanTH1=0;
    meanErrorTH1=0;
    CalculatePerformance( hist_vec_500_CT_EC_Erat99_allSamples_SC[i], resolutionTH1, resolutionErrorTH1,meanTH1,meanErrorTH1);
    h_500_CT_EC_Erat99_allSamples_SC_DR07_E_RMS90_summary_histogram->SetBinContent(i+1,resolutionTH1/sqrt(2.));
    h_500_CT_EC_Erat99_allSamples_SC_DR07_E_RMS90_summary_histogram->SetBinError(i+1, resolutionErrorTH1/sqrt(2.));
  }
  gre_DR07_RMS90_JER_0_65_EC_Erat99_allSamples_SC->SetPoint(2,250,h_500_CT_EC_Erat99_allSamples_SC_DR07_E_RMS90_summary_histogram->GetBinContent(1));
  gre_DR07_RMS90_JER_0_65_EC_Erat99_allSamples_SC->SetPointError(2,0,h_500_CT_EC_Erat99_allSamples_SC_DR07_E_RMS90_summary_histogram->GetBinError(1));

  gre_DR07_RMS90_JER_0_65_to_0_80_EC_Erat99_allSamples_SC->SetPoint(2,250,h_500_CT_EC_Erat99_allSamples_SC_DR07_E_RMS90_summary_histogram->GetBinContent(2));
  gre_DR07_RMS90_JER_0_65_to_0_80_EC_Erat99_allSamples_SC->SetPointError(2,0,h_500_CT_EC_Erat99_allSamples_SC_DR07_E_RMS90_summary_histogram->GetBinError(2));

  gre_DR07_RMS90_JER_0_80_to_0_925_EC_Erat99_allSamples_SC->SetPoint(2,250,h_500_CT_EC_Erat99_allSamples_SC_DR07_E_RMS90_summary_histogram->GetBinContent(3));
  gre_DR07_RMS90_JER_0_80_to_0_925_EC_Erat99_allSamples_SC->SetPointError(2,0,h_500_CT_EC_Erat99_allSamples_SC_DR07_E_RMS90_summary_histogram->GetBinError(3));

  gre_DR07_RMS90_JER_0_925_to_1_00_EC_Erat99_allSamples_SC->SetPoint(2,250,h_500_CT_EC_Erat99_allSamples_SC_DR07_E_RMS90_summary_histogram->GetBinContent(4));
  gre_DR07_RMS90_JER_0_925_to_1_00_EC_Erat99_allSamples_SC->SetPointError(2,0,h_500_CT_EC_Erat99_allSamples_SC_DR07_E_RMS90_summary_histogram->GetBinError(4));


  TH1F* h_1500_CT_EC_Erat99_allSamples_SC_DR07_E_rel_totVis_RMS_d1_cosT_0_to_0_65 =  new TH1F("h_1500_CT_EC_Erat99_allSamples_SC_DR07_E_rel_totVis_RMS_d1_cosT_0_to_0_65","", n_binsJER, lim_E_rel_low,lim_E_rel_high);
  TH1F* h_1500_CT_EC_Erat99_allSamples_SC_DR07_E_rel_totVis_RMS_d1_cosT_0_65_to_0_80 =  new TH1F("h_1500_CT_EC_Erat99_allSamples_SC_DR07_E_rel_totVis_RMS_d1_cosT_0_65_to_0_80","", n_binsJER, lim_E_rel_low,lim_E_rel_high);
  TH1F* h_1500_CT_EC_Erat99_allSamples_SC_DR07_E_rel_totVis_RMS_d1_cosT_0_80_to_0_925 =  new TH1F("h_1500_CT_EC_Erat99_allSamples_SC_DR07_E_rel_totVis_RMS_d1_cosT_0_80_to_0_925","", n_binsJER, lim_E_rel_low,lim_E_rel_high);
  TH1F* h_1500_CT_EC_Erat99_allSamples_SC_DR07_E_rel_totVis_RMS_d1_cosT_0_925_to_1_00 =  new TH1F("h_1500_CT_EC_Erat99_allSamples_SC_DR07_E_rel_totVis_RMS_d1_cosT_0_925_to_1_00","", n_binsJER, lim_E_rel_low,lim_E_rel_high);

  std::vector<TH1F*> hist_vec_1500_CT_EC_Erat99_allSamples_SC;
  hist_vec_1500_CT_EC_Erat99_allSamples_SC.push_back(h_1500_CT_EC_Erat99_allSamples_SC_DR07_E_rel_totVis_RMS_d1_cosT_0_to_0_65);
  hist_vec_1500_CT_EC_Erat99_allSamples_SC.push_back(h_1500_CT_EC_Erat99_allSamples_SC_DR07_E_rel_totVis_RMS_d1_cosT_0_65_to_0_80);
  hist_vec_1500_CT_EC_Erat99_allSamples_SC.push_back(h_1500_CT_EC_Erat99_allSamples_SC_DR07_E_rel_totVis_RMS_d1_cosT_0_80_to_0_925);
  hist_vec_1500_CT_EC_Erat99_allSamples_SC.push_back(h_1500_CT_EC_Erat99_allSamples_SC_DR07_E_rel_totVis_RMS_d1_cosT_0_925_to_1_00);


  for(unsigned int i=0;i<hist_vec_1500_CT_EC_Erat99_allSamples_SC.size();i++){
    hist_vec_1500_CT_EC_Erat99_allSamples_SC[i]->Sumw2();
  }

  fill_SC_jet_histograms(file_CLIC_1500_CT_EC_Erat99_allSamples_SC,hist_vec_1500_CT_EC_Erat99_allSamples_SC);

  TH1F* h_1500_CT_EC_Erat99_allSamples_SC_DR07_E_RMS90_summary_histogram=new TH1F("JER_RMS90VsCosTheta_CT_EC_Erat99_allSamples_SC_DR07_1500", "RMS_{90}(E_{j}^{reco}/E_{j}^{gen}) / Mean_{90}(E_{j}^{reco}/E_{j}^{gen}) vs |cos#theta|", nRegionBinsAngles, pRegionBinEdgesAngles);
  h_1500_CT_EC_Erat99_allSamples_SC_DR07_E_RMS90_summary_histogram ->SetYTitle("RMS_{90}(E_{j}^{reco}/E_{j}^{gen}) / Mean_{90}(E_{j}^{reco}/E_{j}^{gen}) [%]");
  h_1500_CT_EC_Erat99_allSamples_SC_DR07_E_RMS90_summary_histogram->SetXTitle("|cos#theta|");
  h_1500_CT_EC_Erat99_allSamples_SC_DR07_E_RMS90_summary_histogram->SetLineWidth(2);
  h_1500_CT_EC_Erat99_allSamples_SC_DR07_E_RMS90_summary_histogram->SetLineColor(kRed);
  h_1500_CT_EC_Erat99_allSamples_SC_DR07_E_RMS90_summary_histogram->SetLineStyle(2);
  //for energies still keep sqrt(2) from original total energy calculation
  for(int i=0;i<4;i++){
    resolutionTH1=0; 
    resolutionErrorTH1=0;
    meanTH1=0;
    meanErrorTH1=0;
    CalculatePerformance( hist_vec_1500_CT_EC_Erat99_allSamples_SC[i], resolutionTH1, resolutionErrorTH1,meanTH1,meanErrorTH1);
    h_1500_CT_EC_Erat99_allSamples_SC_DR07_E_RMS90_summary_histogram->SetBinContent(i+1,resolutionTH1/sqrt(2.));
    h_1500_CT_EC_Erat99_allSamples_SC_DR07_E_RMS90_summary_histogram->SetBinError(i+1, resolutionErrorTH1/sqrt(2.));
  }
  gre_DR07_RMS90_JER_0_65_EC_Erat99_allSamples_SC->SetPoint(3,750,h_1500_CT_EC_Erat99_allSamples_SC_DR07_E_RMS90_summary_histogram->GetBinContent(1));
  gre_DR07_RMS90_JER_0_65_EC_Erat99_allSamples_SC->SetPointError(3,0,h_1500_CT_EC_Erat99_allSamples_SC_DR07_E_RMS90_summary_histogram->GetBinError(1));

  gre_DR07_RMS90_JER_0_65_to_0_80_EC_Erat99_allSamples_SC->SetPoint(3,750,h_1500_CT_EC_Erat99_allSamples_SC_DR07_E_RMS90_summary_histogram->GetBinContent(2));
  gre_DR07_RMS90_JER_0_65_to_0_80_EC_Erat99_allSamples_SC->SetPointError(3,0,h_1500_CT_EC_Erat99_allSamples_SC_DR07_E_RMS90_summary_histogram->GetBinError(2));

  gre_DR07_RMS90_JER_0_80_to_0_925_EC_Erat99_allSamples_SC->SetPoint(3,750,h_1500_CT_EC_Erat99_allSamples_SC_DR07_E_RMS90_summary_histogram->GetBinContent(3));
  gre_DR07_RMS90_JER_0_80_to_0_925_EC_Erat99_allSamples_SC->SetPointError(3,0,h_1500_CT_EC_Erat99_allSamples_SC_DR07_E_RMS90_summary_histogram->GetBinError(3));

  gre_DR07_RMS90_JER_0_925_to_1_00_EC_Erat99_allSamples_SC->SetPoint(3,750,h_1500_CT_EC_Erat99_allSamples_SC_DR07_E_RMS90_summary_histogram->GetBinContent(4));
  gre_DR07_RMS90_JER_0_925_to_1_00_EC_Erat99_allSamples_SC->SetPointError(3,0,h_1500_CT_EC_Erat99_allSamples_SC_DR07_E_RMS90_summary_histogram->GetBinError(4));


  TH1F* h_3000_CT_EC_Erat99_allSamples_SC_DR07_E_rel_totVis_RMS_d1_cosT_0_to_0_65 =  new TH1F("h_3000_CT_EC_Erat99_allSamples_SC_DR07_E_rel_totVis_RMS_d1_cosT_0_to_0_65","", n_binsJER, lim_E_rel_low,lim_E_rel_high);
  TH1F* h_3000_CT_EC_Erat99_allSamples_SC_DR07_E_rel_totVis_RMS_d1_cosT_0_65_to_0_80 =  new TH1F("h_3000_CT_EC_Erat99_allSamples_SC_DR07_E_rel_totVis_RMS_d1_cosT_0_65_to_0_80","", n_binsJER, lim_E_rel_low,lim_E_rel_high);
  TH1F* h_3000_CT_EC_Erat99_allSamples_SC_DR07_E_rel_totVis_RMS_d1_cosT_0_80_to_0_925 =  new TH1F("h_3000_CT_EC_Erat99_allSamples_SC_DR07_E_rel_totVis_RMS_d1_cosT_0_80_to_0_925","", n_binsJER, lim_E_rel_low,lim_E_rel_high);
  TH1F* h_3000_CT_EC_Erat99_allSamples_SC_DR07_E_rel_totVis_RMS_d1_cosT_0_925_to_1_00 =  new TH1F("h_3000_CT_EC_Erat99_allSamples_SC_DR07_E_rel_totVis_RMS_d1_cosT_0_925_to_1_00","", n_binsJER, lim_E_rel_low,lim_E_rel_high);

  std::vector<TH1F*> hist_vec_3000_CT_EC_Erat99_allSamples_SC;
  hist_vec_3000_CT_EC_Erat99_allSamples_SC.push_back(h_3000_CT_EC_Erat99_allSamples_SC_DR07_E_rel_totVis_RMS_d1_cosT_0_to_0_65);
  hist_vec_3000_CT_EC_Erat99_allSamples_SC.push_back(h_3000_CT_EC_Erat99_allSamples_SC_DR07_E_rel_totVis_RMS_d1_cosT_0_65_to_0_80);
  hist_vec_3000_CT_EC_Erat99_allSamples_SC.push_back(h_3000_CT_EC_Erat99_allSamples_SC_DR07_E_rel_totVis_RMS_d1_cosT_0_80_to_0_925);
  hist_vec_3000_CT_EC_Erat99_allSamples_SC.push_back(h_3000_CT_EC_Erat99_allSamples_SC_DR07_E_rel_totVis_RMS_d1_cosT_0_925_to_1_00);

  for(unsigned int i=0;i<hist_vec_3000_CT_EC_Erat99_allSamples_SC.size();i++){
    hist_vec_3000_CT_EC_Erat99_allSamples_SC[i]->Sumw2();
  }

  fill_SC_jet_histograms(file_CLIC_3000_CT_EC_Erat99_allSamples_SC,hist_vec_3000_CT_EC_Erat99_allSamples_SC);

  TH1F* h_3000_CT_EC_Erat99_allSamples_SC_DR07_E_RMS90_summary_histogram=new TH1F("JER_RMS90VsCosTheta_CT_EC_Erat99_allSamples_SC_DR07_3000", "RMS_{90}(E_{j}^{reco}/E_{j}^{gen}) / Mean_{90}(E_{j}^{reco}/E_{j}^{gen}) vs |cos#theta|", nRegionBinsAngles, pRegionBinEdgesAngles);
  h_3000_CT_EC_Erat99_allSamples_SC_DR07_E_RMS90_summary_histogram ->SetYTitle("RMS_{90}(E_{j}^{reco}/E_{j}^{gen}) / Mean_{90}(E_{j}^{reco}/E_{j}^{gen}) [%]");
  h_3000_CT_EC_Erat99_allSamples_SC_DR07_E_RMS90_summary_histogram->SetXTitle("|cos#theta|");
  h_3000_CT_EC_Erat99_allSamples_SC_DR07_E_RMS90_summary_histogram->SetLineWidth(2);
  h_3000_CT_EC_Erat99_allSamples_SC_DR07_E_RMS90_summary_histogram->SetLineColor(kRed);
  h_3000_CT_EC_Erat99_allSamples_SC_DR07_E_RMS90_summary_histogram->SetLineStyle(2);
  //for energies still keep sqrt(2) from original total energy calculation
  for(int i=0;i<4;i++){
    resolutionTH1=0; 
    resolutionErrorTH1=0;
    meanTH1=0;
    meanErrorTH1=0;
    CalculatePerformance( hist_vec_3000_CT_EC_Erat99_allSamples_SC[i], resolutionTH1, resolutionErrorTH1,meanTH1,meanErrorTH1);
    h_3000_CT_EC_Erat99_allSamples_SC_DR07_E_RMS90_summary_histogram->SetBinContent(i+1,resolutionTH1/sqrt(2.));
    h_3000_CT_EC_Erat99_allSamples_SC_DR07_E_RMS90_summary_histogram->SetBinError(i+1, resolutionErrorTH1/sqrt(2.));
  }
  gre_DR07_RMS90_JER_0_65_EC_Erat99_allSamples_SC->SetPoint(4,1500,h_3000_CT_EC_Erat99_allSamples_SC_DR07_E_RMS90_summary_histogram->GetBinContent(1));
  gre_DR07_RMS90_JER_0_65_EC_Erat99_allSamples_SC->SetPointError(4,0,h_3000_CT_EC_Erat99_allSamples_SC_DR07_E_RMS90_summary_histogram->GetBinError(1));

  gre_DR07_RMS90_JER_0_65_to_0_80_EC_Erat99_allSamples_SC->SetPoint(4,1500,h_3000_CT_EC_Erat99_allSamples_SC_DR07_E_RMS90_summary_histogram->GetBinContent(2));
  gre_DR07_RMS90_JER_0_65_to_0_80_EC_Erat99_allSamples_SC->SetPointError(4,0,h_3000_CT_EC_Erat99_allSamples_SC_DR07_E_RMS90_summary_histogram->GetBinError(2));

  gre_DR07_RMS90_JER_0_80_to_0_925_EC_Erat99_allSamples_SC->SetPoint(4,1500,h_3000_CT_EC_Erat99_allSamples_SC_DR07_E_RMS90_summary_histogram->GetBinContent(3));
  gre_DR07_RMS90_JER_0_80_to_0_925_EC_Erat99_allSamples_SC->SetPointError(4,0,h_3000_CT_EC_Erat99_allSamples_SC_DR07_E_RMS90_summary_histogram->GetBinError(3));

  gre_DR07_RMS90_JER_0_925_to_1_00_EC_Erat99_allSamples_SC->SetPoint(4,1500,h_3000_CT_EC_Erat99_allSamples_SC_DR07_E_RMS90_summary_histogram->GetBinContent(4));
  gre_DR07_RMS90_JER_0_925_to_1_00_EC_Erat99_allSamples_SC->SetPointError(4,0,h_3000_CT_EC_Erat99_allSamples_SC_DR07_E_RMS90_summary_histogram->GetBinError(4));

  file_histogram->cd();
  gre_DR07_RMS90_JER_0_65_wSC->Write();
  gre_DR07_RMS90_JER_0_65_to_0_80_wSC->Write();
  gre_DR07_RMS90_JER_0_80_to_0_925_wSC->Write();
  gre_DR07_RMS90_JER_0_925_to_1_00_wSC->Write();

  gre_DR07_RMS90_JER_0_65_noSC->Write();
  gre_DR07_RMS90_JER_0_65_to_0_80_noSC->Write();
  gre_DR07_RMS90_JER_0_80_to_0_925_noSC->Write();
  gre_DR07_RMS90_JER_0_925_to_1_00_noSC->Write();

  gre_DR07_RMS90_JER_0_65_wO_wSC->Write();
  gre_DR07_RMS90_JER_0_65_to_0_80_wO_wSC->Write();
  gre_DR07_RMS90_JER_0_80_to_0_925_wO_wSC->Write();
  gre_DR07_RMS90_JER_0_925_to_1_00_wO_wSC->Write();

  gre_DR07_RMS90_JER_0_65_wO_noSC->Write();
  gre_DR07_RMS90_JER_0_65_to_0_80_wO_noSC->Write();
  gre_DR07_RMS90_JER_0_80_to_0_925_wO_noSC->Write();
  gre_DR07_RMS90_JER_0_925_to_1_00_wO_noSC->Write();

  gre_DR07_RMS90_JER_0_65_EC_Erat99_allSamples_SC->Write();
  gre_DR07_RMS90_JER_0_65_to_0_80_EC_Erat99_allSamples_SC->Write();
  gre_DR07_RMS90_JER_0_80_to_0_925_EC_Erat99_allSamples_SC->Write();
  gre_DR07_RMS90_JER_0_925_to_1_00_EC_Erat99_allSamples_SC->Write();


  file_histogram->Write();
  file_histogram->Close();

}
